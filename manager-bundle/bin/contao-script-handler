#!/usr/bin/env php
<?php

declare(strict_types=1);

/*
 * This file is part of Contao.
 *
 * (c) Leo Feyer
 *
 * @license LGPL-3.0-or-later
 */

use Contao\ManagerBundle\Console\ContaoApplication;
use Contao\ManagerBundle\HttpKernel\ContaoKernel;
use Symfony\Component\Console\Input\ArrayInput;
use Symfony\Component\Filesystem\Filesystem;

$projectDir = require(__DIR__ . '/bootstrap.php');

$kernel = ContaoKernel::fromInput($projectDir, new ArrayInput(['--env' => 'prod']));

// Purge cache in case it's corrupted
(new Filesystem())->remove($kernel->getCacheDir());

$application = new ContaoApplication($kernel);
$application->setDefaultCommand('contao:initialize-application');
$application->run();
