/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./core-bundle/assets/controllers sync recursive \\.js$":
/*!****************************************************!*\
  !*** ./core-bundle/assets/controllers/ sync \.js$ ***!
  \****************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var map = {
	"./ace-controller.js": "./core-bundle/assets/controllers/ace-controller.js",
	"./chosen-controller.js": "./core-bundle/assets/controllers/chosen-controller.js",
	"./clipboard-controller.js": "./core-bundle/assets/controllers/clipboard-controller.js",
	"./color-scheme-controller.js": "./core-bundle/assets/controllers/color-scheme-controller.js",
	"./image-size-controller.js": "./core-bundle/assets/controllers/image-size-controller.js",
	"./jump-targets-controller.js": "./core-bundle/assets/controllers/jump-targets-controller.js",
	"./limit-height-controller.js": "./core-bundle/assets/controllers/limit-height-controller.js",
	"./metawizard-controller.js": "./core-bundle/assets/controllers/metawizard-controller.js",
	"./scroll-offset-controller.js": "./core-bundle/assets/controllers/scroll-offset-controller.js",
	"./tinymce-controller.js": "./core-bundle/assets/controllers/tinymce-controller.js",
	"./toggle-fieldset-controller.js": "./core-bundle/assets/controllers/toggle-fieldset-controller.js",
	"./toggle-navigation-controller.js": "./core-bundle/assets/controllers/toggle-navigation-controller.js",
	"./toggle-nodes-controller.js": "./core-bundle/assets/controllers/toggle-nodes-controller.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./core-bundle/assets/controllers sync recursive \\.js$";

/***/ }),

/***/ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   definitionForModuleAndIdentifier: () => (/* binding */ definitionForModuleAndIdentifier),
/* harmony export */   definitionForModuleWithContextAndKey: () => (/* binding */ definitionForModuleWithContextAndKey),
/* harmony export */   definitionsFromContext: () => (/* binding */ definitionsFromContext),
/* harmony export */   identifierForContextKey: () => (/* binding */ identifierForContextKey)
/* harmony export */ });
/*
Stimulus Webpack Helpers 1.0.0
Copyright © 2021 Basecamp, LLC
 */
function definitionsFromContext(context) {
    return context.keys()
        .map((key) => definitionForModuleWithContextAndKey(context, key))
        .filter((value) => value);
}
function definitionForModuleWithContextAndKey(context, key) {
    const identifier = identifierForContextKey(key);
    if (identifier) {
        return definitionForModuleAndIdentifier(context(key), identifier);
    }
}
function definitionForModuleAndIdentifier(module, identifier) {
    const controllerConstructor = module.default;
    if (typeof controllerConstructor == "function") {
        return { identifier, controllerConstructor };
    }
}
function identifierForContextKey(key) {
    const logicalName = (key.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/) || [])[1];
    if (logicalName) {
        return logicalName.replace(/_/g, "-").replace(/\//g, "--");
    }
}




/***/ }),

/***/ "./node_modules/@hotwired/stimulus/dist/stimulus.js":
/*!**********************************************************!*\
  !*** ./node_modules/@hotwired/stimulus/dist/stimulus.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Application: () => (/* binding */ Application),
/* harmony export */   AttributeObserver: () => (/* binding */ AttributeObserver),
/* harmony export */   Context: () => (/* binding */ Context),
/* harmony export */   Controller: () => (/* binding */ Controller),
/* harmony export */   ElementObserver: () => (/* binding */ ElementObserver),
/* harmony export */   IndexedMultimap: () => (/* binding */ IndexedMultimap),
/* harmony export */   Multimap: () => (/* binding */ Multimap),
/* harmony export */   SelectorObserver: () => (/* binding */ SelectorObserver),
/* harmony export */   StringMapObserver: () => (/* binding */ StringMapObserver),
/* harmony export */   TokenListObserver: () => (/* binding */ TokenListObserver),
/* harmony export */   ValueListObserver: () => (/* binding */ ValueListObserver),
/* harmony export */   add: () => (/* binding */ add),
/* harmony export */   defaultSchema: () => (/* binding */ defaultSchema),
/* harmony export */   del: () => (/* binding */ del),
/* harmony export */   fetch: () => (/* binding */ fetch),
/* harmony export */   prune: () => (/* binding */ prune)
/* harmony export */ });
/*
Stimulus 3.2.1
Copyright © 2023 Basecamp, LLC
 */
class EventListener {
    constructor(eventTarget, eventName, eventOptions) {
        this.eventTarget = eventTarget;
        this.eventName = eventName;
        this.eventOptions = eventOptions;
        this.unorderedBindings = new Set();
    }
    connect() {
        this.eventTarget.addEventListener(this.eventName, this, this.eventOptions);
    }
    disconnect() {
        this.eventTarget.removeEventListener(this.eventName, this, this.eventOptions);
    }
    bindingConnected(binding) {
        this.unorderedBindings.add(binding);
    }
    bindingDisconnected(binding) {
        this.unorderedBindings.delete(binding);
    }
    handleEvent(event) {
        const extendedEvent = extendEvent(event);
        for (const binding of this.bindings) {
            if (extendedEvent.immediatePropagationStopped) {
                break;
            }
            else {
                binding.handleEvent(extendedEvent);
            }
        }
    }
    hasBindings() {
        return this.unorderedBindings.size > 0;
    }
    get bindings() {
        return Array.from(this.unorderedBindings).sort((left, right) => {
            const leftIndex = left.index, rightIndex = right.index;
            return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0;
        });
    }
}
function extendEvent(event) {
    if ("immediatePropagationStopped" in event) {
        return event;
    }
    else {
        const { stopImmediatePropagation } = event;
        return Object.assign(event, {
            immediatePropagationStopped: false,
            stopImmediatePropagation() {
                this.immediatePropagationStopped = true;
                stopImmediatePropagation.call(this);
            },
        });
    }
}

class Dispatcher {
    constructor(application) {
        this.application = application;
        this.eventListenerMaps = new Map();
        this.started = false;
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.eventListeners.forEach((eventListener) => eventListener.connect());
        }
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.eventListeners.forEach((eventListener) => eventListener.disconnect());
        }
    }
    get eventListeners() {
        return Array.from(this.eventListenerMaps.values()).reduce((listeners, map) => listeners.concat(Array.from(map.values())), []);
    }
    bindingConnected(binding) {
        this.fetchEventListenerForBinding(binding).bindingConnected(binding);
    }
    bindingDisconnected(binding, clearEventListeners = false) {
        this.fetchEventListenerForBinding(binding).bindingDisconnected(binding);
        if (clearEventListeners)
            this.clearEventListenersForBinding(binding);
    }
    handleError(error, message, detail = {}) {
        this.application.handleError(error, `Error ${message}`, detail);
    }
    clearEventListenersForBinding(binding) {
        const eventListener = this.fetchEventListenerForBinding(binding);
        if (!eventListener.hasBindings()) {
            eventListener.disconnect();
            this.removeMappedEventListenerFor(binding);
        }
    }
    removeMappedEventListenerFor(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        eventListenerMap.delete(cacheKey);
        if (eventListenerMap.size == 0)
            this.eventListenerMaps.delete(eventTarget);
    }
    fetchEventListenerForBinding(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        return this.fetchEventListener(eventTarget, eventName, eventOptions);
    }
    fetchEventListener(eventTarget, eventName, eventOptions) {
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        let eventListener = eventListenerMap.get(cacheKey);
        if (!eventListener) {
            eventListener = this.createEventListener(eventTarget, eventName, eventOptions);
            eventListenerMap.set(cacheKey, eventListener);
        }
        return eventListener;
    }
    createEventListener(eventTarget, eventName, eventOptions) {
        const eventListener = new EventListener(eventTarget, eventName, eventOptions);
        if (this.started) {
            eventListener.connect();
        }
        return eventListener;
    }
    fetchEventListenerMapForEventTarget(eventTarget) {
        let eventListenerMap = this.eventListenerMaps.get(eventTarget);
        if (!eventListenerMap) {
            eventListenerMap = new Map();
            this.eventListenerMaps.set(eventTarget, eventListenerMap);
        }
        return eventListenerMap;
    }
    cacheKey(eventName, eventOptions) {
        const parts = [eventName];
        Object.keys(eventOptions)
            .sort()
            .forEach((key) => {
            parts.push(`${eventOptions[key] ? "" : "!"}${key}`);
        });
        return parts.join(":");
    }
}

const defaultActionDescriptorFilters = {
    stop({ event, value }) {
        if (value)
            event.stopPropagation();
        return true;
    },
    prevent({ event, value }) {
        if (value)
            event.preventDefault();
        return true;
    },
    self({ event, value, element }) {
        if (value) {
            return element === event.target;
        }
        else {
            return true;
        }
    },
};
const descriptorPattern = /^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;
function parseActionDescriptorString(descriptorString) {
    const source = descriptorString.trim();
    const matches = source.match(descriptorPattern) || [];
    let eventName = matches[2];
    let keyFilter = matches[3];
    if (keyFilter && !["keydown", "keyup", "keypress"].includes(eventName)) {
        eventName += `.${keyFilter}`;
        keyFilter = "";
    }
    return {
        eventTarget: parseEventTarget(matches[4]),
        eventName,
        eventOptions: matches[7] ? parseEventOptions(matches[7]) : {},
        identifier: matches[5],
        methodName: matches[6],
        keyFilter: matches[1] || keyFilter,
    };
}
function parseEventTarget(eventTargetName) {
    if (eventTargetName == "window") {
        return window;
    }
    else if (eventTargetName == "document") {
        return document;
    }
}
function parseEventOptions(eventOptions) {
    return eventOptions
        .split(":")
        .reduce((options, token) => Object.assign(options, { [token.replace(/^!/, "")]: !/^!/.test(token) }), {});
}
function stringifyEventTarget(eventTarget) {
    if (eventTarget == window) {
        return "window";
    }
    else if (eventTarget == document) {
        return "document";
    }
}

function camelize(value) {
    return value.replace(/(?:[_-])([a-z0-9])/g, (_, char) => char.toUpperCase());
}
function namespaceCamelize(value) {
    return camelize(value.replace(/--/g, "-").replace(/__/g, "_"));
}
function capitalize(value) {
    return value.charAt(0).toUpperCase() + value.slice(1);
}
function dasherize(value) {
    return value.replace(/([A-Z])/g, (_, char) => `-${char.toLowerCase()}`);
}
function tokenize(value) {
    return value.match(/[^\s]+/g) || [];
}

function isSomething(object) {
    return object !== null && object !== undefined;
}
function hasProperty(object, property) {
    return Object.prototype.hasOwnProperty.call(object, property);
}

const allModifiers = ["meta", "ctrl", "alt", "shift"];
class Action {
    constructor(element, index, descriptor, schema) {
        this.element = element;
        this.index = index;
        this.eventTarget = descriptor.eventTarget || element;
        this.eventName = descriptor.eventName || getDefaultEventNameForElement(element) || error("missing event name");
        this.eventOptions = descriptor.eventOptions || {};
        this.identifier = descriptor.identifier || error("missing identifier");
        this.methodName = descriptor.methodName || error("missing method name");
        this.keyFilter = descriptor.keyFilter || "";
        this.schema = schema;
    }
    static forToken(token, schema) {
        return new this(token.element, token.index, parseActionDescriptorString(token.content), schema);
    }
    toString() {
        const eventFilter = this.keyFilter ? `.${this.keyFilter}` : "";
        const eventTarget = this.eventTargetName ? `@${this.eventTargetName}` : "";
        return `${this.eventName}${eventFilter}${eventTarget}->${this.identifier}#${this.methodName}`;
    }
    shouldIgnoreKeyboardEvent(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filters = this.keyFilter.split("+");
        if (this.keyFilterDissatisfied(event, filters)) {
            return true;
        }
        const standardFilter = filters.filter((key) => !allModifiers.includes(key))[0];
        if (!standardFilter) {
            return false;
        }
        if (!hasProperty(this.keyMappings, standardFilter)) {
            error(`contains unknown key filter: ${this.keyFilter}`);
        }
        return this.keyMappings[standardFilter].toLowerCase() !== event.key.toLowerCase();
    }
    shouldIgnoreMouseEvent(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filters = [this.keyFilter];
        if (this.keyFilterDissatisfied(event, filters)) {
            return true;
        }
        return false;
    }
    get params() {
        const params = {};
        const pattern = new RegExp(`^data-${this.identifier}-(.+)-param$`, "i");
        for (const { name, value } of Array.from(this.element.attributes)) {
            const match = name.match(pattern);
            const key = match && match[1];
            if (key) {
                params[camelize(key)] = typecast(value);
            }
        }
        return params;
    }
    get eventTargetName() {
        return stringifyEventTarget(this.eventTarget);
    }
    get keyMappings() {
        return this.schema.keyMappings;
    }
    keyFilterDissatisfied(event, filters) {
        const [meta, ctrl, alt, shift] = allModifiers.map((modifier) => filters.includes(modifier));
        return event.metaKey !== meta || event.ctrlKey !== ctrl || event.altKey !== alt || event.shiftKey !== shift;
    }
}
const defaultEventNames = {
    a: () => "click",
    button: () => "click",
    form: () => "submit",
    details: () => "toggle",
    input: (e) => (e.getAttribute("type") == "submit" ? "click" : "input"),
    select: () => "change",
    textarea: () => "input",
};
function getDefaultEventNameForElement(element) {
    const tagName = element.tagName.toLowerCase();
    if (tagName in defaultEventNames) {
        return defaultEventNames[tagName](element);
    }
}
function error(message) {
    throw new Error(message);
}
function typecast(value) {
    try {
        return JSON.parse(value);
    }
    catch (o_O) {
        return value;
    }
}

class Binding {
    constructor(context, action) {
        this.context = context;
        this.action = action;
    }
    get index() {
        return this.action.index;
    }
    get eventTarget() {
        return this.action.eventTarget;
    }
    get eventOptions() {
        return this.action.eventOptions;
    }
    get identifier() {
        return this.context.identifier;
    }
    handleEvent(event) {
        const actionEvent = this.prepareActionEvent(event);
        if (this.willBeInvokedByEvent(event) && this.applyEventModifiers(actionEvent)) {
            this.invokeWithEvent(actionEvent);
        }
    }
    get eventName() {
        return this.action.eventName;
    }
    get method() {
        const method = this.controller[this.methodName];
        if (typeof method == "function") {
            return method;
        }
        throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`);
    }
    applyEventModifiers(event) {
        const { element } = this.action;
        const { actionDescriptorFilters } = this.context.application;
        const { controller } = this.context;
        let passes = true;
        for (const [name, value] of Object.entries(this.eventOptions)) {
            if (name in actionDescriptorFilters) {
                const filter = actionDescriptorFilters[name];
                passes = passes && filter({ name, value, event, element, controller });
            }
            else {
                continue;
            }
        }
        return passes;
    }
    prepareActionEvent(event) {
        return Object.assign(event, { params: this.action.params });
    }
    invokeWithEvent(event) {
        const { target, currentTarget } = event;
        try {
            this.method.call(this.controller, event);
            this.context.logDebugActivity(this.methodName, { event, target, currentTarget, action: this.methodName });
        }
        catch (error) {
            const { identifier, controller, element, index } = this;
            const detail = { identifier, controller, element, index, event };
            this.context.handleError(error, `invoking action "${this.action}"`, detail);
        }
    }
    willBeInvokedByEvent(event) {
        const eventTarget = event.target;
        if (event instanceof KeyboardEvent && this.action.shouldIgnoreKeyboardEvent(event)) {
            return false;
        }
        if (event instanceof MouseEvent && this.action.shouldIgnoreMouseEvent(event)) {
            return false;
        }
        if (this.element === eventTarget) {
            return true;
        }
        else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {
            return this.scope.containsElement(eventTarget);
        }
        else {
            return this.scope.containsElement(this.action.element);
        }
    }
    get controller() {
        return this.context.controller;
    }
    get methodName() {
        return this.action.methodName;
    }
    get element() {
        return this.scope.element;
    }
    get scope() {
        return this.context.scope;
    }
}

class ElementObserver {
    constructor(element, delegate) {
        this.mutationObserverInit = { attributes: true, childList: true, subtree: true };
        this.element = element;
        this.started = false;
        this.delegate = delegate;
        this.elements = new Set();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.refresh();
        }
    }
    pause(callback) {
        if (this.started) {
            this.mutationObserver.disconnect();
            this.started = false;
        }
        callback();
        if (!this.started) {
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.started = true;
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            const matches = new Set(this.matchElementsInTree());
            for (const element of Array.from(this.elements)) {
                if (!matches.has(element)) {
                    this.removeElement(element);
                }
            }
            for (const element of Array.from(matches)) {
                this.addElement(element);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        if (mutation.type == "attributes") {
            this.processAttributeChange(mutation.target, mutation.attributeName);
        }
        else if (mutation.type == "childList") {
            this.processRemovedNodes(mutation.removedNodes);
            this.processAddedNodes(mutation.addedNodes);
        }
    }
    processAttributeChange(element, attributeName) {
        if (this.elements.has(element)) {
            if (this.delegate.elementAttributeChanged && this.matchElement(element)) {
                this.delegate.elementAttributeChanged(element, attributeName);
            }
            else {
                this.removeElement(element);
            }
        }
        else if (this.matchElement(element)) {
            this.addElement(element);
        }
    }
    processRemovedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element) {
                this.processTree(element, this.removeElement);
            }
        }
    }
    processAddedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element && this.elementIsActive(element)) {
                this.processTree(element, this.addElement);
            }
        }
    }
    matchElement(element) {
        return this.delegate.matchElement(element);
    }
    matchElementsInTree(tree = this.element) {
        return this.delegate.matchElementsInTree(tree);
    }
    processTree(tree, processor) {
        for (const element of this.matchElementsInTree(tree)) {
            processor.call(this, element);
        }
    }
    elementFromNode(node) {
        if (node.nodeType == Node.ELEMENT_NODE) {
            return node;
        }
    }
    elementIsActive(element) {
        if (element.isConnected != this.element.isConnected) {
            return false;
        }
        else {
            return this.element.contains(element);
        }
    }
    addElement(element) {
        if (!this.elements.has(element)) {
            if (this.elementIsActive(element)) {
                this.elements.add(element);
                if (this.delegate.elementMatched) {
                    this.delegate.elementMatched(element);
                }
            }
        }
    }
    removeElement(element) {
        if (this.elements.has(element)) {
            this.elements.delete(element);
            if (this.delegate.elementUnmatched) {
                this.delegate.elementUnmatched(element);
            }
        }
    }
}

class AttributeObserver {
    constructor(element, attributeName, delegate) {
        this.attributeName = attributeName;
        this.delegate = delegate;
        this.elementObserver = new ElementObserver(element, this);
    }
    get element() {
        return this.elementObserver.element;
    }
    get selector() {
        return `[${this.attributeName}]`;
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get started() {
        return this.elementObserver.started;
    }
    matchElement(element) {
        return element.hasAttribute(this.attributeName);
    }
    matchElementsInTree(tree) {
        const match = this.matchElement(tree) ? [tree] : [];
        const matches = Array.from(tree.querySelectorAll(this.selector));
        return match.concat(matches);
    }
    elementMatched(element) {
        if (this.delegate.elementMatchedAttribute) {
            this.delegate.elementMatchedAttribute(element, this.attributeName);
        }
    }
    elementUnmatched(element) {
        if (this.delegate.elementUnmatchedAttribute) {
            this.delegate.elementUnmatchedAttribute(element, this.attributeName);
        }
    }
    elementAttributeChanged(element, attributeName) {
        if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {
            this.delegate.elementAttributeValueChanged(element, attributeName);
        }
    }
}

function add(map, key, value) {
    fetch(map, key).add(value);
}
function del(map, key, value) {
    fetch(map, key).delete(value);
    prune(map, key);
}
function fetch(map, key) {
    let values = map.get(key);
    if (!values) {
        values = new Set();
        map.set(key, values);
    }
    return values;
}
function prune(map, key) {
    const values = map.get(key);
    if (values != null && values.size == 0) {
        map.delete(key);
    }
}

class Multimap {
    constructor() {
        this.valuesByKey = new Map();
    }
    get keys() {
        return Array.from(this.valuesByKey.keys());
    }
    get values() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((values, set) => values.concat(Array.from(set)), []);
    }
    get size() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((size, set) => size + set.size, 0);
    }
    add(key, value) {
        add(this.valuesByKey, key, value);
    }
    delete(key, value) {
        del(this.valuesByKey, key, value);
    }
    has(key, value) {
        const values = this.valuesByKey.get(key);
        return values != null && values.has(value);
    }
    hasKey(key) {
        return this.valuesByKey.has(key);
    }
    hasValue(value) {
        const sets = Array.from(this.valuesByKey.values());
        return sets.some((set) => set.has(value));
    }
    getValuesForKey(key) {
        const values = this.valuesByKey.get(key);
        return values ? Array.from(values) : [];
    }
    getKeysForValue(value) {
        return Array.from(this.valuesByKey)
            .filter(([_key, values]) => values.has(value))
            .map(([key, _values]) => key);
    }
}

class IndexedMultimap extends Multimap {
    constructor() {
        super();
        this.keysByValue = new Map();
    }
    get values() {
        return Array.from(this.keysByValue.keys());
    }
    add(key, value) {
        super.add(key, value);
        add(this.keysByValue, value, key);
    }
    delete(key, value) {
        super.delete(key, value);
        del(this.keysByValue, value, key);
    }
    hasValue(value) {
        return this.keysByValue.has(value);
    }
    getKeysForValue(value) {
        const set = this.keysByValue.get(value);
        return set ? Array.from(set) : [];
    }
}

class SelectorObserver {
    constructor(element, selector, delegate, details) {
        this._selector = selector;
        this.details = details;
        this.elementObserver = new ElementObserver(element, this);
        this.delegate = delegate;
        this.matchesByElement = new Multimap();
    }
    get started() {
        return this.elementObserver.started;
    }
    get selector() {
        return this._selector;
    }
    set selector(selector) {
        this._selector = selector;
        this.refresh();
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get element() {
        return this.elementObserver.element;
    }
    matchElement(element) {
        const { selector } = this;
        if (selector) {
            const matches = element.matches(selector);
            if (this.delegate.selectorMatchElement) {
                return matches && this.delegate.selectorMatchElement(element, this.details);
            }
            return matches;
        }
        else {
            return false;
        }
    }
    matchElementsInTree(tree) {
        const { selector } = this;
        if (selector) {
            const match = this.matchElement(tree) ? [tree] : [];
            const matches = Array.from(tree.querySelectorAll(selector)).filter((match) => this.matchElement(match));
            return match.concat(matches);
        }
        else {
            return [];
        }
    }
    elementMatched(element) {
        const { selector } = this;
        if (selector) {
            this.selectorMatched(element, selector);
        }
    }
    elementUnmatched(element) {
        const selectors = this.matchesByElement.getKeysForValue(element);
        for (const selector of selectors) {
            this.selectorUnmatched(element, selector);
        }
    }
    elementAttributeChanged(element, _attributeName) {
        const { selector } = this;
        if (selector) {
            const matches = this.matchElement(element);
            const matchedBefore = this.matchesByElement.has(selector, element);
            if (matches && !matchedBefore) {
                this.selectorMatched(element, selector);
            }
            else if (!matches && matchedBefore) {
                this.selectorUnmatched(element, selector);
            }
        }
    }
    selectorMatched(element, selector) {
        this.delegate.selectorMatched(element, selector, this.details);
        this.matchesByElement.add(selector, element);
    }
    selectorUnmatched(element, selector) {
        this.delegate.selectorUnmatched(element, selector, this.details);
        this.matchesByElement.delete(selector, element);
    }
}

class StringMapObserver {
    constructor(element, delegate) {
        this.element = element;
        this.delegate = delegate;
        this.started = false;
        this.stringMap = new Map();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, { attributes: true, attributeOldValue: true });
            this.refresh();
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            for (const attributeName of this.knownAttributeNames) {
                this.refreshAttribute(attributeName, null);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        const attributeName = mutation.attributeName;
        if (attributeName) {
            this.refreshAttribute(attributeName, mutation.oldValue);
        }
    }
    refreshAttribute(attributeName, oldValue) {
        const key = this.delegate.getStringMapKeyForAttribute(attributeName);
        if (key != null) {
            if (!this.stringMap.has(attributeName)) {
                this.stringMapKeyAdded(key, attributeName);
            }
            const value = this.element.getAttribute(attributeName);
            if (this.stringMap.get(attributeName) != value) {
                this.stringMapValueChanged(value, key, oldValue);
            }
            if (value == null) {
                const oldValue = this.stringMap.get(attributeName);
                this.stringMap.delete(attributeName);
                if (oldValue)
                    this.stringMapKeyRemoved(key, attributeName, oldValue);
            }
            else {
                this.stringMap.set(attributeName, value);
            }
        }
    }
    stringMapKeyAdded(key, attributeName) {
        if (this.delegate.stringMapKeyAdded) {
            this.delegate.stringMapKeyAdded(key, attributeName);
        }
    }
    stringMapValueChanged(value, key, oldValue) {
        if (this.delegate.stringMapValueChanged) {
            this.delegate.stringMapValueChanged(value, key, oldValue);
        }
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        if (this.delegate.stringMapKeyRemoved) {
            this.delegate.stringMapKeyRemoved(key, attributeName, oldValue);
        }
    }
    get knownAttributeNames() {
        return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)));
    }
    get currentAttributeNames() {
        return Array.from(this.element.attributes).map((attribute) => attribute.name);
    }
    get recordedAttributeNames() {
        return Array.from(this.stringMap.keys());
    }
}

class TokenListObserver {
    constructor(element, attributeName, delegate) {
        this.attributeObserver = new AttributeObserver(element, attributeName, this);
        this.delegate = delegate;
        this.tokensByElement = new Multimap();
    }
    get started() {
        return this.attributeObserver.started;
    }
    start() {
        this.attributeObserver.start();
    }
    pause(callback) {
        this.attributeObserver.pause(callback);
    }
    stop() {
        this.attributeObserver.stop();
    }
    refresh() {
        this.attributeObserver.refresh();
    }
    get element() {
        return this.attributeObserver.element;
    }
    get attributeName() {
        return this.attributeObserver.attributeName;
    }
    elementMatchedAttribute(element) {
        this.tokensMatched(this.readTokensForElement(element));
    }
    elementAttributeValueChanged(element) {
        const [unmatchedTokens, matchedTokens] = this.refreshTokensForElement(element);
        this.tokensUnmatched(unmatchedTokens);
        this.tokensMatched(matchedTokens);
    }
    elementUnmatchedAttribute(element) {
        this.tokensUnmatched(this.tokensByElement.getValuesForKey(element));
    }
    tokensMatched(tokens) {
        tokens.forEach((token) => this.tokenMatched(token));
    }
    tokensUnmatched(tokens) {
        tokens.forEach((token) => this.tokenUnmatched(token));
    }
    tokenMatched(token) {
        this.delegate.tokenMatched(token);
        this.tokensByElement.add(token.element, token);
    }
    tokenUnmatched(token) {
        this.delegate.tokenUnmatched(token);
        this.tokensByElement.delete(token.element, token);
    }
    refreshTokensForElement(element) {
        const previousTokens = this.tokensByElement.getValuesForKey(element);
        const currentTokens = this.readTokensForElement(element);
        const firstDifferingIndex = zip(previousTokens, currentTokens).findIndex(([previousToken, currentToken]) => !tokensAreEqual(previousToken, currentToken));
        if (firstDifferingIndex == -1) {
            return [[], []];
        }
        else {
            return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)];
        }
    }
    readTokensForElement(element) {
        const attributeName = this.attributeName;
        const tokenString = element.getAttribute(attributeName) || "";
        return parseTokenString(tokenString, element, attributeName);
    }
}
function parseTokenString(tokenString, element, attributeName) {
    return tokenString
        .trim()
        .split(/\s+/)
        .filter((content) => content.length)
        .map((content, index) => ({ element, attributeName, content, index }));
}
function zip(left, right) {
    const length = Math.max(left.length, right.length);
    return Array.from({ length }, (_, index) => [left[index], right[index]]);
}
function tokensAreEqual(left, right) {
    return left && right && left.index == right.index && left.content == right.content;
}

class ValueListObserver {
    constructor(element, attributeName, delegate) {
        this.tokenListObserver = new TokenListObserver(element, attributeName, this);
        this.delegate = delegate;
        this.parseResultsByToken = new WeakMap();
        this.valuesByTokenByElement = new WeakMap();
    }
    get started() {
        return this.tokenListObserver.started;
    }
    start() {
        this.tokenListObserver.start();
    }
    stop() {
        this.tokenListObserver.stop();
    }
    refresh() {
        this.tokenListObserver.refresh();
    }
    get element() {
        return this.tokenListObserver.element;
    }
    get attributeName() {
        return this.tokenListObserver.attributeName;
    }
    tokenMatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).set(token, value);
            this.delegate.elementMatchedValue(element, value);
        }
    }
    tokenUnmatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).delete(token);
            this.delegate.elementUnmatchedValue(element, value);
        }
    }
    fetchParseResultForToken(token) {
        let parseResult = this.parseResultsByToken.get(token);
        if (!parseResult) {
            parseResult = this.parseToken(token);
            this.parseResultsByToken.set(token, parseResult);
        }
        return parseResult;
    }
    fetchValuesByTokenForElement(element) {
        let valuesByToken = this.valuesByTokenByElement.get(element);
        if (!valuesByToken) {
            valuesByToken = new Map();
            this.valuesByTokenByElement.set(element, valuesByToken);
        }
        return valuesByToken;
    }
    parseToken(token) {
        try {
            const value = this.delegate.parseValueForToken(token);
            return { value };
        }
        catch (error) {
            return { error };
        }
    }
}

class BindingObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.bindingsByAction = new Map();
    }
    start() {
        if (!this.valueListObserver) {
            this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this);
            this.valueListObserver.start();
        }
    }
    stop() {
        if (this.valueListObserver) {
            this.valueListObserver.stop();
            delete this.valueListObserver;
            this.disconnectAllActions();
        }
    }
    get element() {
        return this.context.element;
    }
    get identifier() {
        return this.context.identifier;
    }
    get actionAttribute() {
        return this.schema.actionAttribute;
    }
    get schema() {
        return this.context.schema;
    }
    get bindings() {
        return Array.from(this.bindingsByAction.values());
    }
    connectAction(action) {
        const binding = new Binding(this.context, action);
        this.bindingsByAction.set(action, binding);
        this.delegate.bindingConnected(binding);
    }
    disconnectAction(action) {
        const binding = this.bindingsByAction.get(action);
        if (binding) {
            this.bindingsByAction.delete(action);
            this.delegate.bindingDisconnected(binding);
        }
    }
    disconnectAllActions() {
        this.bindings.forEach((binding) => this.delegate.bindingDisconnected(binding, true));
        this.bindingsByAction.clear();
    }
    parseValueForToken(token) {
        const action = Action.forToken(token, this.schema);
        if (action.identifier == this.identifier) {
            return action;
        }
    }
    elementMatchedValue(element, action) {
        this.connectAction(action);
    }
    elementUnmatchedValue(element, action) {
        this.disconnectAction(action);
    }
}

class ValueObserver {
    constructor(context, receiver) {
        this.context = context;
        this.receiver = receiver;
        this.stringMapObserver = new StringMapObserver(this.element, this);
        this.valueDescriptorMap = this.controller.valueDescriptorMap;
    }
    start() {
        this.stringMapObserver.start();
        this.invokeChangedCallbacksForDefaultValues();
    }
    stop() {
        this.stringMapObserver.stop();
    }
    get element() {
        return this.context.element;
    }
    get controller() {
        return this.context.controller;
    }
    getStringMapKeyForAttribute(attributeName) {
        if (attributeName in this.valueDescriptorMap) {
            return this.valueDescriptorMap[attributeName].name;
        }
    }
    stringMapKeyAdded(key, attributeName) {
        const descriptor = this.valueDescriptorMap[attributeName];
        if (!this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), descriptor.writer(descriptor.defaultValue));
        }
    }
    stringMapValueChanged(value, name, oldValue) {
        const descriptor = this.valueDescriptorNameMap[name];
        if (value === null)
            return;
        if (oldValue === null) {
            oldValue = descriptor.writer(descriptor.defaultValue);
        }
        this.invokeChangedCallback(name, value, oldValue);
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        const descriptor = this.valueDescriptorNameMap[key];
        if (this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), oldValue);
        }
        else {
            this.invokeChangedCallback(key, descriptor.writer(descriptor.defaultValue), oldValue);
        }
    }
    invokeChangedCallbacksForDefaultValues() {
        for (const { key, name, defaultValue, writer } of this.valueDescriptors) {
            if (defaultValue != undefined && !this.controller.data.has(key)) {
                this.invokeChangedCallback(name, writer(defaultValue), undefined);
            }
        }
    }
    invokeChangedCallback(name, rawValue, rawOldValue) {
        const changedMethodName = `${name}Changed`;
        const changedMethod = this.receiver[changedMethodName];
        if (typeof changedMethod == "function") {
            const descriptor = this.valueDescriptorNameMap[name];
            try {
                const value = descriptor.reader(rawValue);
                let oldValue = rawOldValue;
                if (rawOldValue) {
                    oldValue = descriptor.reader(rawOldValue);
                }
                changedMethod.call(this.receiver, value, oldValue);
            }
            catch (error) {
                if (error instanceof TypeError) {
                    error.message = `Stimulus Value "${this.context.identifier}.${descriptor.name}" - ${error.message}`;
                }
                throw error;
            }
        }
    }
    get valueDescriptors() {
        const { valueDescriptorMap } = this;
        return Object.keys(valueDescriptorMap).map((key) => valueDescriptorMap[key]);
    }
    get valueDescriptorNameMap() {
        const descriptors = {};
        Object.keys(this.valueDescriptorMap).forEach((key) => {
            const descriptor = this.valueDescriptorMap[key];
            descriptors[descriptor.name] = descriptor;
        });
        return descriptors;
    }
    hasValue(attributeName) {
        const descriptor = this.valueDescriptorNameMap[attributeName];
        const hasMethodName = `has${capitalize(descriptor.name)}`;
        return this.receiver[hasMethodName];
    }
}

class TargetObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.targetsByName = new Multimap();
    }
    start() {
        if (!this.tokenListObserver) {
            this.tokenListObserver = new TokenListObserver(this.element, this.attributeName, this);
            this.tokenListObserver.start();
        }
    }
    stop() {
        if (this.tokenListObserver) {
            this.disconnectAllTargets();
            this.tokenListObserver.stop();
            delete this.tokenListObserver;
        }
    }
    tokenMatched({ element, content: name }) {
        if (this.scope.containsElement(element)) {
            this.connectTarget(element, name);
        }
    }
    tokenUnmatched({ element, content: name }) {
        this.disconnectTarget(element, name);
    }
    connectTarget(element, name) {
        var _a;
        if (!this.targetsByName.has(name, element)) {
            this.targetsByName.add(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetConnected(element, name));
        }
    }
    disconnectTarget(element, name) {
        var _a;
        if (this.targetsByName.has(name, element)) {
            this.targetsByName.delete(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetDisconnected(element, name));
        }
    }
    disconnectAllTargets() {
        for (const name of this.targetsByName.keys) {
            for (const element of this.targetsByName.getValuesForKey(name)) {
                this.disconnectTarget(element, name);
            }
        }
    }
    get attributeName() {
        return `data-${this.context.identifier}-target`;
    }
    get element() {
        return this.context.element;
    }
    get scope() {
        return this.context.scope;
    }
}

function readInheritableStaticArrayValues(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return Array.from(ancestors.reduce((values, constructor) => {
        getOwnStaticArrayValues(constructor, propertyName).forEach((name) => values.add(name));
        return values;
    }, new Set()));
}
function readInheritableStaticObjectPairs(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return ancestors.reduce((pairs, constructor) => {
        pairs.push(...getOwnStaticObjectPairs(constructor, propertyName));
        return pairs;
    }, []);
}
function getAncestorsForConstructor(constructor) {
    const ancestors = [];
    while (constructor) {
        ancestors.push(constructor);
        constructor = Object.getPrototypeOf(constructor);
    }
    return ancestors.reverse();
}
function getOwnStaticArrayValues(constructor, propertyName) {
    const definition = constructor[propertyName];
    return Array.isArray(definition) ? definition : [];
}
function getOwnStaticObjectPairs(constructor, propertyName) {
    const definition = constructor[propertyName];
    return definition ? Object.keys(definition).map((key) => [key, definition[key]]) : [];
}

class OutletObserver {
    constructor(context, delegate) {
        this.started = false;
        this.context = context;
        this.delegate = delegate;
        this.outletsByName = new Multimap();
        this.outletElementsByName = new Multimap();
        this.selectorObserverMap = new Map();
        this.attributeObserverMap = new Map();
    }
    start() {
        if (!this.started) {
            this.outletDefinitions.forEach((outletName) => {
                this.setupSelectorObserverForOutlet(outletName);
                this.setupAttributeObserverForOutlet(outletName);
            });
            this.started = true;
            this.dependentContexts.forEach((context) => context.refresh());
        }
    }
    refresh() {
        this.selectorObserverMap.forEach((observer) => observer.refresh());
        this.attributeObserverMap.forEach((observer) => observer.refresh());
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.disconnectAllOutlets();
            this.stopSelectorObservers();
            this.stopAttributeObservers();
        }
    }
    stopSelectorObservers() {
        if (this.selectorObserverMap.size > 0) {
            this.selectorObserverMap.forEach((observer) => observer.stop());
            this.selectorObserverMap.clear();
        }
    }
    stopAttributeObservers() {
        if (this.attributeObserverMap.size > 0) {
            this.attributeObserverMap.forEach((observer) => observer.stop());
            this.attributeObserverMap.clear();
        }
    }
    selectorMatched(element, _selector, { outletName }) {
        const outlet = this.getOutlet(element, outletName);
        if (outlet) {
            this.connectOutlet(outlet, element, outletName);
        }
    }
    selectorUnmatched(element, _selector, { outletName }) {
        const outlet = this.getOutletFromMap(element, outletName);
        if (outlet) {
            this.disconnectOutlet(outlet, element, outletName);
        }
    }
    selectorMatchElement(element, { outletName }) {
        const selector = this.selector(outletName);
        const hasOutlet = this.hasOutlet(element, outletName);
        const hasOutletController = element.matches(`[${this.schema.controllerAttribute}~=${outletName}]`);
        if (selector) {
            return hasOutlet && hasOutletController && element.matches(selector);
        }
        else {
            return false;
        }
    }
    elementMatchedAttribute(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    elementAttributeValueChanged(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    elementUnmatchedAttribute(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    connectOutlet(outlet, element, outletName) {
        var _a;
        if (!this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.add(outletName, outlet);
            this.outletElementsByName.add(outletName, element);
            (_a = this.selectorObserverMap.get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletConnected(outlet, element, outletName));
        }
    }
    disconnectOutlet(outlet, element, outletName) {
        var _a;
        if (this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.delete(outletName, outlet);
            this.outletElementsByName.delete(outletName, element);
            (_a = this.selectorObserverMap
                .get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletDisconnected(outlet, element, outletName));
        }
    }
    disconnectAllOutlets() {
        for (const outletName of this.outletElementsByName.keys) {
            for (const element of this.outletElementsByName.getValuesForKey(outletName)) {
                for (const outlet of this.outletsByName.getValuesForKey(outletName)) {
                    this.disconnectOutlet(outlet, element, outletName);
                }
            }
        }
    }
    updateSelectorObserverForOutlet(outletName) {
        const observer = this.selectorObserverMap.get(outletName);
        if (observer) {
            observer.selector = this.selector(outletName);
        }
    }
    setupSelectorObserverForOutlet(outletName) {
        const selector = this.selector(outletName);
        const selectorObserver = new SelectorObserver(document.body, selector, this, { outletName });
        this.selectorObserverMap.set(outletName, selectorObserver);
        selectorObserver.start();
    }
    setupAttributeObserverForOutlet(outletName) {
        const attributeName = this.attributeNameForOutletName(outletName);
        const attributeObserver = new AttributeObserver(this.scope.element, attributeName, this);
        this.attributeObserverMap.set(outletName, attributeObserver);
        attributeObserver.start();
    }
    selector(outletName) {
        return this.scope.outlets.getSelectorForOutletName(outletName);
    }
    attributeNameForOutletName(outletName) {
        return this.scope.schema.outletAttributeForScope(this.identifier, outletName);
    }
    getOutletNameFromOutletAttributeName(attributeName) {
        return this.outletDefinitions.find((outletName) => this.attributeNameForOutletName(outletName) === attributeName);
    }
    get outletDependencies() {
        const dependencies = new Multimap();
        this.router.modules.forEach((module) => {
            const constructor = module.definition.controllerConstructor;
            const outlets = readInheritableStaticArrayValues(constructor, "outlets");
            outlets.forEach((outlet) => dependencies.add(outlet, module.identifier));
        });
        return dependencies;
    }
    get outletDefinitions() {
        return this.outletDependencies.getKeysForValue(this.identifier);
    }
    get dependentControllerIdentifiers() {
        return this.outletDependencies.getValuesForKey(this.identifier);
    }
    get dependentContexts() {
        const identifiers = this.dependentControllerIdentifiers;
        return this.router.contexts.filter((context) => identifiers.includes(context.identifier));
    }
    hasOutlet(element, outletName) {
        return !!this.getOutlet(element, outletName) || !!this.getOutletFromMap(element, outletName);
    }
    getOutlet(element, outletName) {
        return this.application.getControllerForElementAndIdentifier(element, outletName);
    }
    getOutletFromMap(element, outletName) {
        return this.outletsByName.getValuesForKey(outletName).find((outlet) => outlet.element === element);
    }
    get scope() {
        return this.context.scope;
    }
    get schema() {
        return this.context.schema;
    }
    get identifier() {
        return this.context.identifier;
    }
    get application() {
        return this.context.application;
    }
    get router() {
        return this.application.router;
    }
}

class Context {
    constructor(module, scope) {
        this.logDebugActivity = (functionName, detail = {}) => {
            const { identifier, controller, element } = this;
            detail = Object.assign({ identifier, controller, element }, detail);
            this.application.logDebugActivity(this.identifier, functionName, detail);
        };
        this.module = module;
        this.scope = scope;
        this.controller = new module.controllerConstructor(this);
        this.bindingObserver = new BindingObserver(this, this.dispatcher);
        this.valueObserver = new ValueObserver(this, this.controller);
        this.targetObserver = new TargetObserver(this, this);
        this.outletObserver = new OutletObserver(this, this);
        try {
            this.controller.initialize();
            this.logDebugActivity("initialize");
        }
        catch (error) {
            this.handleError(error, "initializing controller");
        }
    }
    connect() {
        this.bindingObserver.start();
        this.valueObserver.start();
        this.targetObserver.start();
        this.outletObserver.start();
        try {
            this.controller.connect();
            this.logDebugActivity("connect");
        }
        catch (error) {
            this.handleError(error, "connecting controller");
        }
    }
    refresh() {
        this.outletObserver.refresh();
    }
    disconnect() {
        try {
            this.controller.disconnect();
            this.logDebugActivity("disconnect");
        }
        catch (error) {
            this.handleError(error, "disconnecting controller");
        }
        this.outletObserver.stop();
        this.targetObserver.stop();
        this.valueObserver.stop();
        this.bindingObserver.stop();
    }
    get application() {
        return this.module.application;
    }
    get identifier() {
        return this.module.identifier;
    }
    get schema() {
        return this.application.schema;
    }
    get dispatcher() {
        return this.application.dispatcher;
    }
    get element() {
        return this.scope.element;
    }
    get parentElement() {
        return this.element.parentElement;
    }
    handleError(error, message, detail = {}) {
        const { identifier, controller, element } = this;
        detail = Object.assign({ identifier, controller, element }, detail);
        this.application.handleError(error, `Error ${message}`, detail);
    }
    targetConnected(element, name) {
        this.invokeControllerMethod(`${name}TargetConnected`, element);
    }
    targetDisconnected(element, name) {
        this.invokeControllerMethod(`${name}TargetDisconnected`, element);
    }
    outletConnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletConnected`, outlet, element);
    }
    outletDisconnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletDisconnected`, outlet, element);
    }
    invokeControllerMethod(methodName, ...args) {
        const controller = this.controller;
        if (typeof controller[methodName] == "function") {
            controller[methodName](...args);
        }
    }
}

function bless(constructor) {
    return shadow(constructor, getBlessedProperties(constructor));
}
function shadow(constructor, properties) {
    const shadowConstructor = extend(constructor);
    const shadowProperties = getShadowProperties(constructor.prototype, properties);
    Object.defineProperties(shadowConstructor.prototype, shadowProperties);
    return shadowConstructor;
}
function getBlessedProperties(constructor) {
    const blessings = readInheritableStaticArrayValues(constructor, "blessings");
    return blessings.reduce((blessedProperties, blessing) => {
        const properties = blessing(constructor);
        for (const key in properties) {
            const descriptor = blessedProperties[key] || {};
            blessedProperties[key] = Object.assign(descriptor, properties[key]);
        }
        return blessedProperties;
    }, {});
}
function getShadowProperties(prototype, properties) {
    return getOwnKeys(properties).reduce((shadowProperties, key) => {
        const descriptor = getShadowedDescriptor(prototype, properties, key);
        if (descriptor) {
            Object.assign(shadowProperties, { [key]: descriptor });
        }
        return shadowProperties;
    }, {});
}
function getShadowedDescriptor(prototype, properties, key) {
    const shadowingDescriptor = Object.getOwnPropertyDescriptor(prototype, key);
    const shadowedByValue = shadowingDescriptor && "value" in shadowingDescriptor;
    if (!shadowedByValue) {
        const descriptor = Object.getOwnPropertyDescriptor(properties, key).value;
        if (shadowingDescriptor) {
            descriptor.get = shadowingDescriptor.get || descriptor.get;
            descriptor.set = shadowingDescriptor.set || descriptor.set;
        }
        return descriptor;
    }
}
const getOwnKeys = (() => {
    if (typeof Object.getOwnPropertySymbols == "function") {
        return (object) => [...Object.getOwnPropertyNames(object), ...Object.getOwnPropertySymbols(object)];
    }
    else {
        return Object.getOwnPropertyNames;
    }
})();
const extend = (() => {
    function extendWithReflect(constructor) {
        function extended() {
            return Reflect.construct(constructor, arguments, new.target);
        }
        extended.prototype = Object.create(constructor.prototype, {
            constructor: { value: extended },
        });
        Reflect.setPrototypeOf(extended, constructor);
        return extended;
    }
    function testReflectExtension() {
        const a = function () {
            this.a.call(this);
        };
        const b = extendWithReflect(a);
        b.prototype.a = function () { };
        return new b();
    }
    try {
        testReflectExtension();
        return extendWithReflect;
    }
    catch (error) {
        return (constructor) => class extended extends constructor {
        };
    }
})();

function blessDefinition(definition) {
    return {
        identifier: definition.identifier,
        controllerConstructor: bless(definition.controllerConstructor),
    };
}

class Module {
    constructor(application, definition) {
        this.application = application;
        this.definition = blessDefinition(definition);
        this.contextsByScope = new WeakMap();
        this.connectedContexts = new Set();
    }
    get identifier() {
        return this.definition.identifier;
    }
    get controllerConstructor() {
        return this.definition.controllerConstructor;
    }
    get contexts() {
        return Array.from(this.connectedContexts);
    }
    connectContextForScope(scope) {
        const context = this.fetchContextForScope(scope);
        this.connectedContexts.add(context);
        context.connect();
    }
    disconnectContextForScope(scope) {
        const context = this.contextsByScope.get(scope);
        if (context) {
            this.connectedContexts.delete(context);
            context.disconnect();
        }
    }
    fetchContextForScope(scope) {
        let context = this.contextsByScope.get(scope);
        if (!context) {
            context = new Context(this, scope);
            this.contextsByScope.set(scope, context);
        }
        return context;
    }
}

class ClassMap {
    constructor(scope) {
        this.scope = scope;
    }
    has(name) {
        return this.data.has(this.getDataKey(name));
    }
    get(name) {
        return this.getAll(name)[0];
    }
    getAll(name) {
        const tokenString = this.data.get(this.getDataKey(name)) || "";
        return tokenize(tokenString);
    }
    getAttributeName(name) {
        return this.data.getAttributeNameForKey(this.getDataKey(name));
    }
    getDataKey(name) {
        return `${name}-class`;
    }
    get data() {
        return this.scope.data;
    }
}

class DataMap {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.getAttribute(name);
    }
    set(key, value) {
        const name = this.getAttributeNameForKey(key);
        this.element.setAttribute(name, value);
        return this.get(key);
    }
    has(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.hasAttribute(name);
    }
    delete(key) {
        if (this.has(key)) {
            const name = this.getAttributeNameForKey(key);
            this.element.removeAttribute(name);
            return true;
        }
        else {
            return false;
        }
    }
    getAttributeNameForKey(key) {
        return `data-${this.identifier}-${dasherize(key)}`;
    }
}

class Guide {
    constructor(logger) {
        this.warnedKeysByObject = new WeakMap();
        this.logger = logger;
    }
    warn(object, key, message) {
        let warnedKeys = this.warnedKeysByObject.get(object);
        if (!warnedKeys) {
            warnedKeys = new Set();
            this.warnedKeysByObject.set(object, warnedKeys);
        }
        if (!warnedKeys.has(key)) {
            warnedKeys.add(key);
            this.logger.warn(message, object);
        }
    }
}

function attributeValueContainsToken(attributeName, token) {
    return `[${attributeName}~="${token}"]`;
}

class TargetSet {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(targetName) {
        return this.find(targetName) != null;
    }
    find(...targetNames) {
        return targetNames.reduce((target, targetName) => target || this.findTarget(targetName) || this.findLegacyTarget(targetName), undefined);
    }
    findAll(...targetNames) {
        return targetNames.reduce((targets, targetName) => [
            ...targets,
            ...this.findAllTargets(targetName),
            ...this.findAllLegacyTargets(targetName),
        ], []);
    }
    findTarget(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findElement(selector);
    }
    findAllTargets(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findAllElements(selector);
    }
    getSelectorForTargetName(targetName) {
        const attributeName = this.schema.targetAttributeForScope(this.identifier);
        return attributeValueContainsToken(attributeName, targetName);
    }
    findLegacyTarget(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.deprecate(this.scope.findElement(selector), targetName);
    }
    findAllLegacyTargets(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.scope.findAllElements(selector).map((element) => this.deprecate(element, targetName));
    }
    getLegacySelectorForTargetName(targetName) {
        const targetDescriptor = `${this.identifier}.${targetName}`;
        return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor);
    }
    deprecate(element, targetName) {
        if (element) {
            const { identifier } = this;
            const attributeName = this.schema.targetAttribute;
            const revisedAttributeName = this.schema.targetAttributeForScope(identifier);
            this.guide.warn(element, `target:${targetName}`, `Please replace ${attributeName}="${identifier}.${targetName}" with ${revisedAttributeName}="${targetName}". ` +
                `The ${attributeName} attribute is deprecated and will be removed in a future version of Stimulus.`);
        }
        return element;
    }
    get guide() {
        return this.scope.guide;
    }
}

class OutletSet {
    constructor(scope, controllerElement) {
        this.scope = scope;
        this.controllerElement = controllerElement;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(outletName) {
        return this.find(outletName) != null;
    }
    find(...outletNames) {
        return outletNames.reduce((outlet, outletName) => outlet || this.findOutlet(outletName), undefined);
    }
    findAll(...outletNames) {
        return outletNames.reduce((outlets, outletName) => [...outlets, ...this.findAllOutlets(outletName)], []);
    }
    getSelectorForOutletName(outletName) {
        const attributeName = this.schema.outletAttributeForScope(this.identifier, outletName);
        return this.controllerElement.getAttribute(attributeName);
    }
    findOutlet(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        if (selector)
            return this.findElement(selector, outletName);
    }
    findAllOutlets(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        return selector ? this.findAllElements(selector, outletName) : [];
    }
    findElement(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName))[0];
    }
    findAllElements(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName));
    }
    matchesElement(element, selector, outletName) {
        const controllerAttribute = element.getAttribute(this.scope.schema.controllerAttribute) || "";
        return element.matches(selector) && controllerAttribute.split(" ").includes(outletName);
    }
}

class Scope {
    constructor(schema, element, identifier, logger) {
        this.targets = new TargetSet(this);
        this.classes = new ClassMap(this);
        this.data = new DataMap(this);
        this.containsElement = (element) => {
            return element.closest(this.controllerSelector) === this.element;
        };
        this.schema = schema;
        this.element = element;
        this.identifier = identifier;
        this.guide = new Guide(logger);
        this.outlets = new OutletSet(this.documentScope, element);
    }
    findElement(selector) {
        return this.element.matches(selector) ? this.element : this.queryElements(selector).find(this.containsElement);
    }
    findAllElements(selector) {
        return [
            ...(this.element.matches(selector) ? [this.element] : []),
            ...this.queryElements(selector).filter(this.containsElement),
        ];
    }
    queryElements(selector) {
        return Array.from(this.element.querySelectorAll(selector));
    }
    get controllerSelector() {
        return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier);
    }
    get isDocumentScope() {
        return this.element === document.documentElement;
    }
    get documentScope() {
        return this.isDocumentScope
            ? this
            : new Scope(this.schema, document.documentElement, this.identifier, this.guide.logger);
    }
}

class ScopeObserver {
    constructor(element, schema, delegate) {
        this.element = element;
        this.schema = schema;
        this.delegate = delegate;
        this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this);
        this.scopesByIdentifierByElement = new WeakMap();
        this.scopeReferenceCounts = new WeakMap();
    }
    start() {
        this.valueListObserver.start();
    }
    stop() {
        this.valueListObserver.stop();
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    parseValueForToken(token) {
        const { element, content: identifier } = token;
        return this.parseValueForElementAndIdentifier(element, identifier);
    }
    parseValueForElementAndIdentifier(element, identifier) {
        const scopesByIdentifier = this.fetchScopesByIdentifierForElement(element);
        let scope = scopesByIdentifier.get(identifier);
        if (!scope) {
            scope = this.delegate.createScopeForElementAndIdentifier(element, identifier);
            scopesByIdentifier.set(identifier, scope);
        }
        return scope;
    }
    elementMatchedValue(element, value) {
        const referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1;
        this.scopeReferenceCounts.set(value, referenceCount);
        if (referenceCount == 1) {
            this.delegate.scopeConnected(value);
        }
    }
    elementUnmatchedValue(element, value) {
        const referenceCount = this.scopeReferenceCounts.get(value);
        if (referenceCount) {
            this.scopeReferenceCounts.set(value, referenceCount - 1);
            if (referenceCount == 1) {
                this.delegate.scopeDisconnected(value);
            }
        }
    }
    fetchScopesByIdentifierForElement(element) {
        let scopesByIdentifier = this.scopesByIdentifierByElement.get(element);
        if (!scopesByIdentifier) {
            scopesByIdentifier = new Map();
            this.scopesByIdentifierByElement.set(element, scopesByIdentifier);
        }
        return scopesByIdentifier;
    }
}

class Router {
    constructor(application) {
        this.application = application;
        this.scopeObserver = new ScopeObserver(this.element, this.schema, this);
        this.scopesByIdentifier = new Multimap();
        this.modulesByIdentifier = new Map();
    }
    get element() {
        return this.application.element;
    }
    get schema() {
        return this.application.schema;
    }
    get logger() {
        return this.application.logger;
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    get modules() {
        return Array.from(this.modulesByIdentifier.values());
    }
    get contexts() {
        return this.modules.reduce((contexts, module) => contexts.concat(module.contexts), []);
    }
    start() {
        this.scopeObserver.start();
    }
    stop() {
        this.scopeObserver.stop();
    }
    loadDefinition(definition) {
        this.unloadIdentifier(definition.identifier);
        const module = new Module(this.application, definition);
        this.connectModule(module);
        const afterLoad = definition.controllerConstructor.afterLoad;
        if (afterLoad) {
            afterLoad.call(definition.controllerConstructor, definition.identifier, this.application);
        }
    }
    unloadIdentifier(identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            this.disconnectModule(module);
        }
    }
    getContextForElementAndIdentifier(element, identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            return module.contexts.find((context) => context.element == element);
        }
    }
    proposeToConnectScopeForElementAndIdentifier(element, identifier) {
        const scope = this.scopeObserver.parseValueForElementAndIdentifier(element, identifier);
        if (scope) {
            this.scopeObserver.elementMatchedValue(scope.element, scope);
        }
        else {
            console.error(`Couldn't find or create scope for identifier: "${identifier}" and element:`, element);
        }
    }
    handleError(error, message, detail) {
        this.application.handleError(error, message, detail);
    }
    createScopeForElementAndIdentifier(element, identifier) {
        return new Scope(this.schema, element, identifier, this.logger);
    }
    scopeConnected(scope) {
        this.scopesByIdentifier.add(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.connectContextForScope(scope);
        }
    }
    scopeDisconnected(scope) {
        this.scopesByIdentifier.delete(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.disconnectContextForScope(scope);
        }
    }
    connectModule(module) {
        this.modulesByIdentifier.set(module.identifier, module);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.connectContextForScope(scope));
    }
    disconnectModule(module) {
        this.modulesByIdentifier.delete(module.identifier);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.disconnectContextForScope(scope));
    }
}

const defaultSchema = {
    controllerAttribute: "data-controller",
    actionAttribute: "data-action",
    targetAttribute: "data-target",
    targetAttributeForScope: (identifier) => `data-${identifier}-target`,
    outletAttributeForScope: (identifier, outlet) => `data-${identifier}-${outlet}-outlet`,
    keyMappings: Object.assign(Object.assign({ enter: "Enter", tab: "Tab", esc: "Escape", space: " ", up: "ArrowUp", down: "ArrowDown", left: "ArrowLeft", right: "ArrowRight", home: "Home", end: "End", page_up: "PageUp", page_down: "PageDown" }, objectFromEntries("abcdefghijklmnopqrstuvwxyz".split("").map((c) => [c, c]))), objectFromEntries("0123456789".split("").map((n) => [n, n]))),
};
function objectFromEntries(array) {
    return array.reduce((memo, [k, v]) => (Object.assign(Object.assign({}, memo), { [k]: v })), {});
}

class Application {
    constructor(element = document.documentElement, schema = defaultSchema) {
        this.logger = console;
        this.debug = false;
        this.logDebugActivity = (identifier, functionName, detail = {}) => {
            if (this.debug) {
                this.logFormattedMessage(identifier, functionName, detail);
            }
        };
        this.element = element;
        this.schema = schema;
        this.dispatcher = new Dispatcher(this);
        this.router = new Router(this);
        this.actionDescriptorFilters = Object.assign({}, defaultActionDescriptorFilters);
    }
    static start(element, schema) {
        const application = new this(element, schema);
        application.start();
        return application;
    }
    async start() {
        await domReady();
        this.logDebugActivity("application", "starting");
        this.dispatcher.start();
        this.router.start();
        this.logDebugActivity("application", "start");
    }
    stop() {
        this.logDebugActivity("application", "stopping");
        this.dispatcher.stop();
        this.router.stop();
        this.logDebugActivity("application", "stop");
    }
    register(identifier, controllerConstructor) {
        this.load({ identifier, controllerConstructor });
    }
    registerActionOption(name, filter) {
        this.actionDescriptorFilters[name] = filter;
    }
    load(head, ...rest) {
        const definitions = Array.isArray(head) ? head : [head, ...rest];
        definitions.forEach((definition) => {
            if (definition.controllerConstructor.shouldLoad) {
                this.router.loadDefinition(definition);
            }
        });
    }
    unload(head, ...rest) {
        const identifiers = Array.isArray(head) ? head : [head, ...rest];
        identifiers.forEach((identifier) => this.router.unloadIdentifier(identifier));
    }
    get controllers() {
        return this.router.contexts.map((context) => context.controller);
    }
    getControllerForElementAndIdentifier(element, identifier) {
        const context = this.router.getContextForElementAndIdentifier(element, identifier);
        return context ? context.controller : null;
    }
    handleError(error, message, detail) {
        var _a;
        this.logger.error(`%s\n\n%o\n\n%o`, message, error, detail);
        (_a = window.onerror) === null || _a === void 0 ? void 0 : _a.call(window, message, "", 0, 0, error);
    }
    logFormattedMessage(identifier, functionName, detail = {}) {
        detail = Object.assign({ application: this }, detail);
        this.logger.groupCollapsed(`${identifier} #${functionName}`);
        this.logger.log("details:", Object.assign({}, detail));
        this.logger.groupEnd();
    }
}
function domReady() {
    return new Promise((resolve) => {
        if (document.readyState == "loading") {
            document.addEventListener("DOMContentLoaded", () => resolve());
        }
        else {
            resolve();
        }
    });
}

function ClassPropertiesBlessing(constructor) {
    const classes = readInheritableStaticArrayValues(constructor, "classes");
    return classes.reduce((properties, classDefinition) => {
        return Object.assign(properties, propertiesForClassDefinition(classDefinition));
    }, {});
}
function propertiesForClassDefinition(key) {
    return {
        [`${key}Class`]: {
            get() {
                const { classes } = this;
                if (classes.has(key)) {
                    return classes.get(key);
                }
                else {
                    const attribute = classes.getAttributeName(key);
                    throw new Error(`Missing attribute "${attribute}"`);
                }
            },
        },
        [`${key}Classes`]: {
            get() {
                return this.classes.getAll(key);
            },
        },
        [`has${capitalize(key)}Class`]: {
            get() {
                return this.classes.has(key);
            },
        },
    };
}

function OutletPropertiesBlessing(constructor) {
    const outlets = readInheritableStaticArrayValues(constructor, "outlets");
    return outlets.reduce((properties, outletDefinition) => {
        return Object.assign(properties, propertiesForOutletDefinition(outletDefinition));
    }, {});
}
function getOutletController(controller, element, identifier) {
    return controller.application.getControllerForElementAndIdentifier(element, identifier);
}
function getControllerAndEnsureConnectedScope(controller, element, outletName) {
    let outletController = getOutletController(controller, element, outletName);
    if (outletController)
        return outletController;
    controller.application.router.proposeToConnectScopeForElementAndIdentifier(element, outletName);
    outletController = getOutletController(controller, element, outletName);
    if (outletController)
        return outletController;
}
function propertiesForOutletDefinition(name) {
    const camelizedName = namespaceCamelize(name);
    return {
        [`${camelizedName}Outlet`]: {
            get() {
                const outletElement = this.outlets.find(name);
                const selector = this.outlets.getSelectorForOutletName(name);
                if (outletElement) {
                    const outletController = getControllerAndEnsureConnectedScope(this, outletElement, name);
                    if (outletController)
                        return outletController;
                    throw new Error(`The provided outlet element is missing an outlet controller "${name}" instance for host controller "${this.identifier}"`);
                }
                throw new Error(`Missing outlet element "${name}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${selector}".`);
            },
        },
        [`${camelizedName}Outlets`]: {
            get() {
                const outlets = this.outlets.findAll(name);
                if (outlets.length > 0) {
                    return outlets
                        .map((outletElement) => {
                        const outletController = getControllerAndEnsureConnectedScope(this, outletElement, name);
                        if (outletController)
                            return outletController;
                        console.warn(`The provided outlet element is missing an outlet controller "${name}" instance for host controller "${this.identifier}"`, outletElement);
                    })
                        .filter((controller) => controller);
                }
                return [];
            },
        },
        [`${camelizedName}OutletElement`]: {
            get() {
                const outletElement = this.outlets.find(name);
                const selector = this.outlets.getSelectorForOutletName(name);
                if (outletElement) {
                    return outletElement;
                }
                else {
                    throw new Error(`Missing outlet element "${name}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${selector}".`);
                }
            },
        },
        [`${camelizedName}OutletElements`]: {
            get() {
                return this.outlets.findAll(name);
            },
        },
        [`has${capitalize(camelizedName)}Outlet`]: {
            get() {
                return this.outlets.has(name);
            },
        },
    };
}

function TargetPropertiesBlessing(constructor) {
    const targets = readInheritableStaticArrayValues(constructor, "targets");
    return targets.reduce((properties, targetDefinition) => {
        return Object.assign(properties, propertiesForTargetDefinition(targetDefinition));
    }, {});
}
function propertiesForTargetDefinition(name) {
    return {
        [`${name}Target`]: {
            get() {
                const target = this.targets.find(name);
                if (target) {
                    return target;
                }
                else {
                    throw new Error(`Missing target element "${name}" for "${this.identifier}" controller`);
                }
            },
        },
        [`${name}Targets`]: {
            get() {
                return this.targets.findAll(name);
            },
        },
        [`has${capitalize(name)}Target`]: {
            get() {
                return this.targets.has(name);
            },
        },
    };
}

function ValuePropertiesBlessing(constructor) {
    const valueDefinitionPairs = readInheritableStaticObjectPairs(constructor, "values");
    const propertyDescriptorMap = {
        valueDescriptorMap: {
            get() {
                return valueDefinitionPairs.reduce((result, valueDefinitionPair) => {
                    const valueDescriptor = parseValueDefinitionPair(valueDefinitionPair, this.identifier);
                    const attributeName = this.data.getAttributeNameForKey(valueDescriptor.key);
                    return Object.assign(result, { [attributeName]: valueDescriptor });
                }, {});
            },
        },
    };
    return valueDefinitionPairs.reduce((properties, valueDefinitionPair) => {
        return Object.assign(properties, propertiesForValueDefinitionPair(valueDefinitionPair));
    }, propertyDescriptorMap);
}
function propertiesForValueDefinitionPair(valueDefinitionPair, controller) {
    const definition = parseValueDefinitionPair(valueDefinitionPair, controller);
    const { key, name, reader: read, writer: write } = definition;
    return {
        [name]: {
            get() {
                const value = this.data.get(key);
                if (value !== null) {
                    return read(value);
                }
                else {
                    return definition.defaultValue;
                }
            },
            set(value) {
                if (value === undefined) {
                    this.data.delete(key);
                }
                else {
                    this.data.set(key, write(value));
                }
            },
        },
        [`has${capitalize(name)}`]: {
            get() {
                return this.data.has(key) || definition.hasCustomDefaultValue;
            },
        },
    };
}
function parseValueDefinitionPair([token, typeDefinition], controller) {
    return valueDescriptorForTokenAndTypeDefinition({
        controller,
        token,
        typeDefinition,
    });
}
function parseValueTypeConstant(constant) {
    switch (constant) {
        case Array:
            return "array";
        case Boolean:
            return "boolean";
        case Number:
            return "number";
        case Object:
            return "object";
        case String:
            return "string";
    }
}
function parseValueTypeDefault(defaultValue) {
    switch (typeof defaultValue) {
        case "boolean":
            return "boolean";
        case "number":
            return "number";
        case "string":
            return "string";
    }
    if (Array.isArray(defaultValue))
        return "array";
    if (Object.prototype.toString.call(defaultValue) === "[object Object]")
        return "object";
}
function parseValueTypeObject(payload) {
    const { controller, token, typeObject } = payload;
    const hasType = isSomething(typeObject.type);
    const hasDefault = isSomething(typeObject.default);
    const fullObject = hasType && hasDefault;
    const onlyType = hasType && !hasDefault;
    const onlyDefault = !hasType && hasDefault;
    const typeFromObject = parseValueTypeConstant(typeObject.type);
    const typeFromDefaultValue = parseValueTypeDefault(payload.typeObject.default);
    if (onlyType)
        return typeFromObject;
    if (onlyDefault)
        return typeFromDefaultValue;
    if (typeFromObject !== typeFromDefaultValue) {
        const propertyPath = controller ? `${controller}.${token}` : token;
        throw new Error(`The specified default value for the Stimulus Value "${propertyPath}" must match the defined type "${typeFromObject}". The provided default value of "${typeObject.default}" is of type "${typeFromDefaultValue}".`);
    }
    if (fullObject)
        return typeFromObject;
}
function parseValueTypeDefinition(payload) {
    const { controller, token, typeDefinition } = payload;
    const typeObject = { controller, token, typeObject: typeDefinition };
    const typeFromObject = parseValueTypeObject(typeObject);
    const typeFromDefaultValue = parseValueTypeDefault(typeDefinition);
    const typeFromConstant = parseValueTypeConstant(typeDefinition);
    const type = typeFromObject || typeFromDefaultValue || typeFromConstant;
    if (type)
        return type;
    const propertyPath = controller ? `${controller}.${typeDefinition}` : token;
    throw new Error(`Unknown value type "${propertyPath}" for "${token}" value`);
}
function defaultValueForDefinition(typeDefinition) {
    const constant = parseValueTypeConstant(typeDefinition);
    if (constant)
        return defaultValuesByType[constant];
    const hasDefault = hasProperty(typeDefinition, "default");
    const hasType = hasProperty(typeDefinition, "type");
    const typeObject = typeDefinition;
    if (hasDefault)
        return typeObject.default;
    if (hasType) {
        const { type } = typeObject;
        const constantFromType = parseValueTypeConstant(type);
        if (constantFromType)
            return defaultValuesByType[constantFromType];
    }
    return typeDefinition;
}
function valueDescriptorForTokenAndTypeDefinition(payload) {
    const { token, typeDefinition } = payload;
    const key = `${dasherize(token)}-value`;
    const type = parseValueTypeDefinition(payload);
    return {
        type,
        key,
        name: camelize(key),
        get defaultValue() {
            return defaultValueForDefinition(typeDefinition);
        },
        get hasCustomDefaultValue() {
            return parseValueTypeDefault(typeDefinition) !== undefined;
        },
        reader: readers[type],
        writer: writers[type] || writers.default,
    };
}
const defaultValuesByType = {
    get array() {
        return [];
    },
    boolean: false,
    number: 0,
    get object() {
        return {};
    },
    string: "",
};
const readers = {
    array(value) {
        const array = JSON.parse(value);
        if (!Array.isArray(array)) {
            throw new TypeError(`expected value of type "array" but instead got value "${value}" of type "${parseValueTypeDefault(array)}"`);
        }
        return array;
    },
    boolean(value) {
        return !(value == "0" || String(value).toLowerCase() == "false");
    },
    number(value) {
        return Number(value.replace(/_/g, ""));
    },
    object(value) {
        const object = JSON.parse(value);
        if (object === null || typeof object != "object" || Array.isArray(object)) {
            throw new TypeError(`expected value of type "object" but instead got value "${value}" of type "${parseValueTypeDefault(object)}"`);
        }
        return object;
    },
    string(value) {
        return value;
    },
};
const writers = {
    default: writeString,
    array: writeJSON,
    object: writeJSON,
};
function writeJSON(value) {
    return JSON.stringify(value);
}
function writeString(value) {
    return `${value}`;
}

class Controller {
    constructor(context) {
        this.context = context;
    }
    static get shouldLoad() {
        return true;
    }
    static afterLoad(_identifier, _application) {
        return;
    }
    get application() {
        return this.context.application;
    }
    get scope() {
        return this.context.scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get targets() {
        return this.scope.targets;
    }
    get outlets() {
        return this.scope.outlets;
    }
    get classes() {
        return this.scope.classes;
    }
    get data() {
        return this.scope.data;
    }
    initialize() {
    }
    connect() {
    }
    disconnect() {
    }
    dispatch(eventName, { target = this.element, detail = {}, prefix = this.identifier, bubbles = true, cancelable = true, } = {}) {
        const type = prefix ? `${prefix}:${eventName}` : eventName;
        const event = new CustomEvent(type, { detail, bubbles, cancelable });
        target.dispatchEvent(event);
        return event;
    }
}
Controller.blessings = [
    ClassPropertiesBlessing,
    TargetPropertiesBlessing,
    ValuePropertiesBlessing,
    OutletPropertiesBlessing,
];
Controller.targets = [];
Controller.outlets = [];
Controller.values = {};




/***/ }),

/***/ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js":
/*!***************************************************************!*\
  !*** ./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FetchEnctype: () => (/* binding */ FetchEnctype),
/* harmony export */   FetchMethod: () => (/* binding */ FetchMethod),
/* harmony export */   FetchRequest: () => (/* binding */ FetchRequest),
/* harmony export */   FetchResponse: () => (/* binding */ FetchResponse),
/* harmony export */   FrameElement: () => (/* binding */ FrameElement),
/* harmony export */   FrameLoadingStyle: () => (/* binding */ FrameLoadingStyle),
/* harmony export */   FrameRenderer: () => (/* binding */ FrameRenderer),
/* harmony export */   PageRenderer: () => (/* binding */ PageRenderer),
/* harmony export */   PageSnapshot: () => (/* binding */ PageSnapshot),
/* harmony export */   StreamActions: () => (/* binding */ StreamActions),
/* harmony export */   StreamElement: () => (/* binding */ StreamElement),
/* harmony export */   StreamSourceElement: () => (/* binding */ StreamSourceElement),
/* harmony export */   cache: () => (/* binding */ cache),
/* harmony export */   clearCache: () => (/* binding */ clearCache),
/* harmony export */   connectStreamSource: () => (/* binding */ connectStreamSource),
/* harmony export */   disconnectStreamSource: () => (/* binding */ disconnectStreamSource),
/* harmony export */   fetch: () => (/* binding */ fetchWithTurboHeaders),
/* harmony export */   fetchEnctypeFromString: () => (/* binding */ fetchEnctypeFromString),
/* harmony export */   fetchMethodFromString: () => (/* binding */ fetchMethodFromString),
/* harmony export */   isSafe: () => (/* binding */ isSafe),
/* harmony export */   navigator: () => (/* binding */ navigator$1),
/* harmony export */   registerAdapter: () => (/* binding */ registerAdapter),
/* harmony export */   renderStreamMessage: () => (/* binding */ renderStreamMessage),
/* harmony export */   session: () => (/* binding */ session),
/* harmony export */   setConfirmMethod: () => (/* binding */ setConfirmMethod),
/* harmony export */   setFormMode: () => (/* binding */ setFormMode),
/* harmony export */   setProgressBarDelay: () => (/* binding */ setProgressBarDelay),
/* harmony export */   start: () => (/* binding */ start),
/* harmony export */   visit: () => (/* binding */ visit)
/* harmony export */ });
/*!
Turbo 8.0.5
Copyright © 2024 37signals LLC
 */
/**
 * The MIT License (MIT)
 *
 * Copyright (c) 2019 Javan Makhmali
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

(function (prototype) {
  if (typeof prototype.requestSubmit == "function") return

  prototype.requestSubmit = function (submitter) {
    if (submitter) {
      validateSubmitter(submitter, this);
      submitter.click();
    } else {
      submitter = document.createElement("input");
      submitter.type = "submit";
      submitter.hidden = true;
      this.appendChild(submitter);
      submitter.click();
      this.removeChild(submitter);
    }
  };

  function validateSubmitter(submitter, form) {
    submitter instanceof HTMLElement || raise(TypeError, "parameter 1 is not of type 'HTMLElement'");
    submitter.type == "submit" || raise(TypeError, "The specified element is not a submit button");
    submitter.form == form ||
      raise(DOMException, "The specified element is not owned by this form element", "NotFoundError");
  }

  function raise(errorConstructor, message, name) {
    throw new errorConstructor("Failed to execute 'requestSubmit' on 'HTMLFormElement': " + message + ".", name)
  }
})(HTMLFormElement.prototype);

const submittersByForm = new WeakMap();

function findSubmitterFromClickTarget(target) {
  const element = target instanceof Element ? target : target instanceof Node ? target.parentElement : null;
  const candidate = element ? element.closest("input, button") : null;
  return candidate?.type == "submit" ? candidate : null
}

function clickCaptured(event) {
  const submitter = findSubmitterFromClickTarget(event.target);

  if (submitter && submitter.form) {
    submittersByForm.set(submitter.form, submitter);
  }
}

(function () {
  if ("submitter" in Event.prototype) return

  let prototype = window.Event.prototype;
  // Certain versions of Safari 15 have a bug where they won't
  // populate the submitter. This hurts TurboDrive's enable/disable detection.
  // See https://bugs.webkit.org/show_bug.cgi?id=229660
  if ("SubmitEvent" in window) {
    const prototypeOfSubmitEvent = window.SubmitEvent.prototype;

    if (/Apple Computer/.test(navigator.vendor) && !("submitter" in prototypeOfSubmitEvent)) {
      prototype = prototypeOfSubmitEvent;
    } else {
      return // polyfill not needed
    }
  }

  addEventListener("click", clickCaptured, true);

  Object.defineProperty(prototype, "submitter", {
    get() {
      if (this.type == "submit" && this.target instanceof HTMLFormElement) {
        return submittersByForm.get(this.target)
      }
    }
  });
})();

const FrameLoadingStyle = {
  eager: "eager",
  lazy: "lazy"
};

/**
 * Contains a fragment of HTML which is updated based on navigation within
 * it (e.g. via links or form submissions).
 *
 * @customElement turbo-frame
 * @example
 *   <turbo-frame id="messages">
 *     <a href="/messages/expanded">
 *       Show all expanded messages in this frame.
 *     </a>
 *
 *     <form action="/messages">
 *       Show response from this form within this frame.
 *     </form>
 *   </turbo-frame>
 */
class FrameElement extends HTMLElement {
  static delegateConstructor = undefined

  loaded = Promise.resolve()

  static get observedAttributes() {
    return ["disabled", "loading", "src"]
  }

  constructor() {
    super();
    this.delegate = new FrameElement.delegateConstructor(this);
  }

  connectedCallback() {
    this.delegate.connect();
  }

  disconnectedCallback() {
    this.delegate.disconnect();
  }

  reload() {
    return this.delegate.sourceURLReloaded()
  }

  attributeChangedCallback(name) {
    if (name == "loading") {
      this.delegate.loadingStyleChanged();
    } else if (name == "src") {
      this.delegate.sourceURLChanged();
    } else if (name == "disabled") {
      this.delegate.disabledChanged();
    }
  }

  /**
   * Gets the URL to lazily load source HTML from
   */
  get src() {
    return this.getAttribute("src")
  }

  /**
   * Sets the URL to lazily load source HTML from
   */
  set src(value) {
    if (value) {
      this.setAttribute("src", value);
    } else {
      this.removeAttribute("src");
    }
  }

  /**
   * Gets the refresh mode for the frame.
   */
  get refresh() {
    return this.getAttribute("refresh")
  }

  /**
   * Sets the refresh mode for the frame.
   */
  set refresh(value) {
    if (value) {
      this.setAttribute("refresh", value);
    } else {
      this.removeAttribute("refresh");
    }
  }

  /**
   * Determines if the element is loading
   */
  get loading() {
    return frameLoadingStyleFromString(this.getAttribute("loading") || "")
  }

  /**
   * Sets the value of if the element is loading
   */
  set loading(value) {
    if (value) {
      this.setAttribute("loading", value);
    } else {
      this.removeAttribute("loading");
    }
  }

  /**
   * Gets the disabled state of the frame.
   *
   * If disabled, no requests will be intercepted by the frame.
   */
  get disabled() {
    return this.hasAttribute("disabled")
  }

  /**
   * Sets the disabled state of the frame.
   *
   * If disabled, no requests will be intercepted by the frame.
   */
  set disabled(value) {
    if (value) {
      this.setAttribute("disabled", "");
    } else {
      this.removeAttribute("disabled");
    }
  }

  /**
   * Gets the autoscroll state of the frame.
   *
   * If true, the frame will be scrolled into view automatically on update.
   */
  get autoscroll() {
    return this.hasAttribute("autoscroll")
  }

  /**
   * Sets the autoscroll state of the frame.
   *
   * If true, the frame will be scrolled into view automatically on update.
   */
  set autoscroll(value) {
    if (value) {
      this.setAttribute("autoscroll", "");
    } else {
      this.removeAttribute("autoscroll");
    }
  }

  /**
   * Determines if the element has finished loading
   */
  get complete() {
    return !this.delegate.isLoading
  }

  /**
   * Gets the active state of the frame.
   *
   * If inactive, source changes will not be observed.
   */
  get isActive() {
    return this.ownerDocument === document && !this.isPreview
  }

  /**
   * Sets the active state of the frame.
   *
   * If inactive, source changes will not be observed.
   */
  get isPreview() {
    return this.ownerDocument?.documentElement?.hasAttribute("data-turbo-preview")
  }
}

function frameLoadingStyleFromString(style) {
  switch (style.toLowerCase()) {
    case "lazy":
      return FrameLoadingStyle.lazy
    default:
      return FrameLoadingStyle.eager
  }
}

function expandURL(locatable) {
  return new URL(locatable.toString(), document.baseURI)
}

function getAnchor(url) {
  let anchorMatch;
  if (url.hash) {
    return url.hash.slice(1)
    // eslint-disable-next-line no-cond-assign
  } else if ((anchorMatch = url.href.match(/#(.*)$/))) {
    return anchorMatch[1]
  }
}

function getAction$1(form, submitter) {
  const action = submitter?.getAttribute("formaction") || form.getAttribute("action") || form.action;

  return expandURL(action)
}

function getExtension(url) {
  return (getLastPathComponent(url).match(/\.[^.]*$/) || [])[0] || ""
}

function isHTML(url) {
  return !!getExtension(url).match(/^(?:|\.(?:htm|html|xhtml|php))$/)
}

function isPrefixedBy(baseURL, url) {
  const prefix = getPrefix(url);
  return baseURL.href === expandURL(prefix).href || baseURL.href.startsWith(prefix)
}

function locationIsVisitable(location, rootLocation) {
  return isPrefixedBy(location, rootLocation) && isHTML(location)
}

function getRequestURL(url) {
  const anchor = getAnchor(url);
  return anchor != null ? url.href.slice(0, -(anchor.length + 1)) : url.href
}

function toCacheKey(url) {
  return getRequestURL(url)
}

function urlsAreEqual(left, right) {
  return expandURL(left).href == expandURL(right).href
}

function getPathComponents(url) {
  return url.pathname.split("/").slice(1)
}

function getLastPathComponent(url) {
  return getPathComponents(url).slice(-1)[0]
}

function getPrefix(url) {
  return addTrailingSlash(url.origin + url.pathname)
}

function addTrailingSlash(value) {
  return value.endsWith("/") ? value : value + "/"
}

class FetchResponse {
  constructor(response) {
    this.response = response;
  }

  get succeeded() {
    return this.response.ok
  }

  get failed() {
    return !this.succeeded
  }

  get clientError() {
    return this.statusCode >= 400 && this.statusCode <= 499
  }

  get serverError() {
    return this.statusCode >= 500 && this.statusCode <= 599
  }

  get redirected() {
    return this.response.redirected
  }

  get location() {
    return expandURL(this.response.url)
  }

  get isHTML() {
    return this.contentType && this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)
  }

  get statusCode() {
    return this.response.status
  }

  get contentType() {
    return this.header("Content-Type")
  }

  get responseText() {
    return this.response.clone().text()
  }

  get responseHTML() {
    if (this.isHTML) {
      return this.response.clone().text()
    } else {
      return Promise.resolve(undefined)
    }
  }

  header(name) {
    return this.response.headers.get(name)
  }
}

function activateScriptElement(element) {
  if (element.getAttribute("data-turbo-eval") == "false") {
    return element
  } else {
    const createdScriptElement = document.createElement("script");
    const cspNonce = getMetaContent("csp-nonce");
    if (cspNonce) {
      createdScriptElement.nonce = cspNonce;
    }
    createdScriptElement.textContent = element.textContent;
    createdScriptElement.async = false;
    copyElementAttributes(createdScriptElement, element);
    return createdScriptElement
  }
}

function copyElementAttributes(destinationElement, sourceElement) {
  for (const { name, value } of sourceElement.attributes) {
    destinationElement.setAttribute(name, value);
  }
}

function createDocumentFragment(html) {
  const template = document.createElement("template");
  template.innerHTML = html;
  return template.content
}

function dispatch(eventName, { target, cancelable, detail } = {}) {
  const event = new CustomEvent(eventName, {
    cancelable,
    bubbles: true,
    composed: true,
    detail
  });

  if (target && target.isConnected) {
    target.dispatchEvent(event);
  } else {
    document.documentElement.dispatchEvent(event);
  }

  return event
}

function nextRepaint() {
  if (document.visibilityState === "hidden") {
    return nextEventLoopTick()
  } else {
    return nextAnimationFrame()
  }
}

function nextAnimationFrame() {
  return new Promise((resolve) => requestAnimationFrame(() => resolve()))
}

function nextEventLoopTick() {
  return new Promise((resolve) => setTimeout(() => resolve(), 0))
}

function nextMicrotask() {
  return Promise.resolve()
}

function parseHTMLDocument(html = "") {
  return new DOMParser().parseFromString(html, "text/html")
}

function unindent(strings, ...values) {
  const lines = interpolate(strings, values).replace(/^\n/, "").split("\n");
  const match = lines[0].match(/^\s+/);
  const indent = match ? match[0].length : 0;
  return lines.map((line) => line.slice(indent)).join("\n")
}

function interpolate(strings, values) {
  return strings.reduce((result, string, i) => {
    const value = values[i] == undefined ? "" : values[i];
    return result + string + value
  }, "")
}

function uuid() {
  return Array.from({ length: 36 })
    .map((_, i) => {
      if (i == 8 || i == 13 || i == 18 || i == 23) {
        return "-"
      } else if (i == 14) {
        return "4"
      } else if (i == 19) {
        return (Math.floor(Math.random() * 4) + 8).toString(16)
      } else {
        return Math.floor(Math.random() * 15).toString(16)
      }
    })
    .join("")
}

function getAttribute(attributeName, ...elements) {
  for (const value of elements.map((element) => element?.getAttribute(attributeName))) {
    if (typeof value == "string") return value
  }

  return null
}

function hasAttribute(attributeName, ...elements) {
  return elements.some((element) => element && element.hasAttribute(attributeName))
}

function markAsBusy(...elements) {
  for (const element of elements) {
    if (element.localName == "turbo-frame") {
      element.setAttribute("busy", "");
    }
    element.setAttribute("aria-busy", "true");
  }
}

function clearBusyState(...elements) {
  for (const element of elements) {
    if (element.localName == "turbo-frame") {
      element.removeAttribute("busy");
    }

    element.removeAttribute("aria-busy");
  }
}

function waitForLoad(element, timeoutInMilliseconds = 2000) {
  return new Promise((resolve) => {
    const onComplete = () => {
      element.removeEventListener("error", onComplete);
      element.removeEventListener("load", onComplete);
      resolve();
    };

    element.addEventListener("load", onComplete, { once: true });
    element.addEventListener("error", onComplete, { once: true });
    setTimeout(resolve, timeoutInMilliseconds);
  })
}

function getHistoryMethodForAction(action) {
  switch (action) {
    case "replace":
      return history.replaceState
    case "advance":
    case "restore":
      return history.pushState
  }
}

function isAction(action) {
  return action == "advance" || action == "replace" || action == "restore"
}

function getVisitAction(...elements) {
  const action = getAttribute("data-turbo-action", ...elements);

  return isAction(action) ? action : null
}

function getMetaElement(name) {
  return document.querySelector(`meta[name="${name}"]`)
}

function getMetaContent(name) {
  const element = getMetaElement(name);
  return element && element.content
}

function setMetaContent(name, content) {
  let element = getMetaElement(name);

  if (!element) {
    element = document.createElement("meta");
    element.setAttribute("name", name);

    document.head.appendChild(element);
  }

  element.setAttribute("content", content);

  return element
}

function findClosestRecursively(element, selector) {
  if (element instanceof Element) {
    return (
      element.closest(selector) || findClosestRecursively(element.assignedSlot || element.getRootNode()?.host, selector)
    )
  }
}

function elementIsFocusable(element) {
  const inertDisabledOrHidden = "[inert], :disabled, [hidden], details:not([open]), dialog:not([open])";

  return !!element && element.closest(inertDisabledOrHidden) == null && typeof element.focus == "function"
}

function queryAutofocusableElement(elementOrDocumentFragment) {
  return Array.from(elementOrDocumentFragment.querySelectorAll("[autofocus]")).find(elementIsFocusable)
}

async function around(callback, reader) {
  const before = reader();

  callback();

  await nextAnimationFrame();

  const after = reader();

  return [before, after]
}

function doesNotTargetIFrame(name) {
  if (name === "_blank") {
    return false
  } else if (name) {
    for (const element of document.getElementsByName(name)) {
      if (element instanceof HTMLIFrameElement) return false
    }

    return true
  } else {
    return true
  }
}

function findLinkFromClickTarget(target) {
  return findClosestRecursively(target, "a[href]:not([target^=_]):not([download])")
}

function getLocationForLink(link) {
  return expandURL(link.getAttribute("href") || "")
}

function debounce(fn, delay) {
  let timeoutId = null;

  return (...args) => {
    const callback = () => fn.apply(this, args);
    clearTimeout(timeoutId);
    timeoutId = setTimeout(callback, delay);
  }
}

class LimitedSet extends Set {
  constructor(maxSize) {
    super();
    this.maxSize = maxSize;
  }

  add(value) {
    if (this.size >= this.maxSize) {
      const iterator = this.values();
      const oldestValue = iterator.next().value;
      this.delete(oldestValue);
    }
    super.add(value);
  }
}

const recentRequests = new LimitedSet(20);

const nativeFetch = window.fetch;

function fetchWithTurboHeaders(url, options = {}) {
  const modifiedHeaders = new Headers(options.headers || {});
  const requestUID = uuid();
  recentRequests.add(requestUID);
  modifiedHeaders.append("X-Turbo-Request-Id", requestUID);

  return nativeFetch(url, {
    ...options,
    headers: modifiedHeaders
  })
}

function fetchMethodFromString(method) {
  switch (method.toLowerCase()) {
    case "get":
      return FetchMethod.get
    case "post":
      return FetchMethod.post
    case "put":
      return FetchMethod.put
    case "patch":
      return FetchMethod.patch
    case "delete":
      return FetchMethod.delete
  }
}

const FetchMethod = {
  get: "get",
  post: "post",
  put: "put",
  patch: "patch",
  delete: "delete"
};

function fetchEnctypeFromString(encoding) {
  switch (encoding.toLowerCase()) {
    case FetchEnctype.multipart:
      return FetchEnctype.multipart
    case FetchEnctype.plain:
      return FetchEnctype.plain
    default:
      return FetchEnctype.urlEncoded
  }
}

const FetchEnctype = {
  urlEncoded: "application/x-www-form-urlencoded",
  multipart: "multipart/form-data",
  plain: "text/plain"
};

class FetchRequest {
  abortController = new AbortController()
  #resolveRequestPromise = (_value) => {}

  constructor(delegate, method, location, requestBody = new URLSearchParams(), target = null, enctype = FetchEnctype.urlEncoded) {
    const [url, body] = buildResourceAndBody(expandURL(location), method, requestBody, enctype);

    this.delegate = delegate;
    this.url = url;
    this.target = target;
    this.fetchOptions = {
      credentials: "same-origin",
      redirect: "follow",
      method: method.toUpperCase(),
      headers: { ...this.defaultHeaders },
      body: body,
      signal: this.abortSignal,
      referrer: this.delegate.referrer?.href
    };
    this.enctype = enctype;
  }

  get method() {
    return this.fetchOptions.method
  }

  set method(value) {
    const fetchBody = this.isSafe ? this.url.searchParams : this.fetchOptions.body || new FormData();
    const fetchMethod = fetchMethodFromString(value) || FetchMethod.get;

    this.url.search = "";

    const [url, body] = buildResourceAndBody(this.url, fetchMethod, fetchBody, this.enctype);

    this.url = url;
    this.fetchOptions.body = body;
    this.fetchOptions.method = fetchMethod.toUpperCase();
  }

  get headers() {
    return this.fetchOptions.headers
  }

  set headers(value) {
    this.fetchOptions.headers = value;
  }

  get body() {
    if (this.isSafe) {
      return this.url.searchParams
    } else {
      return this.fetchOptions.body
    }
  }

  set body(value) {
    this.fetchOptions.body = value;
  }

  get location() {
    return this.url
  }

  get params() {
    return this.url.searchParams
  }

  get entries() {
    return this.body ? Array.from(this.body.entries()) : []
  }

  cancel() {
    this.abortController.abort();
  }

  async perform() {
    const { fetchOptions } = this;
    this.delegate.prepareRequest(this);
    const event = await this.#allowRequestToBeIntercepted(fetchOptions);
    try {
      this.delegate.requestStarted(this);

      if (event.detail.fetchRequest) {
        this.response = event.detail.fetchRequest.response;
      } else {
        this.response = fetchWithTurboHeaders(this.url.href, fetchOptions);
      }

      const response = await this.response;
      return await this.receive(response)
    } catch (error) {
      if (error.name !== "AbortError") {
        if (this.#willDelegateErrorHandling(error)) {
          this.delegate.requestErrored(this, error);
        }
        throw error
      }
    } finally {
      this.delegate.requestFinished(this);
    }
  }

  async receive(response) {
    const fetchResponse = new FetchResponse(response);
    const event = dispatch("turbo:before-fetch-response", {
      cancelable: true,
      detail: { fetchResponse },
      target: this.target
    });
    if (event.defaultPrevented) {
      this.delegate.requestPreventedHandlingResponse(this, fetchResponse);
    } else if (fetchResponse.succeeded) {
      this.delegate.requestSucceededWithResponse(this, fetchResponse);
    } else {
      this.delegate.requestFailedWithResponse(this, fetchResponse);
    }
    return fetchResponse
  }

  get defaultHeaders() {
    return {
      Accept: "text/html, application/xhtml+xml"
    }
  }

  get isSafe() {
    return isSafe(this.method)
  }

  get abortSignal() {
    return this.abortController.signal
  }

  acceptResponseType(mimeType) {
    this.headers["Accept"] = [mimeType, this.headers["Accept"]].join(", ");
  }

  async #allowRequestToBeIntercepted(fetchOptions) {
    const requestInterception = new Promise((resolve) => (this.#resolveRequestPromise = resolve));
    const event = dispatch("turbo:before-fetch-request", {
      cancelable: true,
      detail: {
        fetchOptions,
        url: this.url,
        resume: this.#resolveRequestPromise
      },
      target: this.target
    });
    this.url = event.detail.url;
    if (event.defaultPrevented) await requestInterception;

    return event
  }

  #willDelegateErrorHandling(error) {
    const event = dispatch("turbo:fetch-request-error", {
      target: this.target,
      cancelable: true,
      detail: { request: this, error: error }
    });

    return !event.defaultPrevented
  }
}

function isSafe(fetchMethod) {
  return fetchMethodFromString(fetchMethod) == FetchMethod.get
}

function buildResourceAndBody(resource, method, requestBody, enctype) {
  const searchParams =
    Array.from(requestBody).length > 0 ? new URLSearchParams(entriesExcludingFiles(requestBody)) : resource.searchParams;

  if (isSafe(method)) {
    return [mergeIntoURLSearchParams(resource, searchParams), null]
  } else if (enctype == FetchEnctype.urlEncoded) {
    return [resource, searchParams]
  } else {
    return [resource, requestBody]
  }
}

function entriesExcludingFiles(requestBody) {
  const entries = [];

  for (const [name, value] of requestBody) {
    if (value instanceof File) continue
    else entries.push([name, value]);
  }

  return entries
}

function mergeIntoURLSearchParams(url, requestBody) {
  const searchParams = new URLSearchParams(entriesExcludingFiles(requestBody));

  url.search = searchParams.toString();

  return url
}

class AppearanceObserver {
  started = false

  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
    this.intersectionObserver = new IntersectionObserver(this.intersect);
  }

  start() {
    if (!this.started) {
      this.started = true;
      this.intersectionObserver.observe(this.element);
    }
  }

  stop() {
    if (this.started) {
      this.started = false;
      this.intersectionObserver.unobserve(this.element);
    }
  }

  intersect = (entries) => {
    const lastEntry = entries.slice(-1)[0];
    if (lastEntry?.isIntersecting) {
      this.delegate.elementAppearedInViewport(this.element);
    }
  }
}

class StreamMessage {
  static contentType = "text/vnd.turbo-stream.html"

  static wrap(message) {
    if (typeof message == "string") {
      return new this(createDocumentFragment(message))
    } else {
      return message
    }
  }

  constructor(fragment) {
    this.fragment = importStreamElements(fragment);
  }
}

function importStreamElements(fragment) {
  for (const element of fragment.querySelectorAll("turbo-stream")) {
    const streamElement = document.importNode(element, true);

    for (const inertScriptElement of streamElement.templateElement.content.querySelectorAll("script")) {
      inertScriptElement.replaceWith(activateScriptElement(inertScriptElement));
    }

    element.replaceWith(streamElement);
  }

  return fragment
}

const PREFETCH_DELAY = 100;

class PrefetchCache {
  #prefetchTimeout = null
  #prefetched = null

  get(url) {
    if (this.#prefetched && this.#prefetched.url === url && this.#prefetched.expire > Date.now()) {
      return this.#prefetched.request
    }
  }

  setLater(url, request, ttl) {
    this.clear();

    this.#prefetchTimeout = setTimeout(() => {
      request.perform();
      this.set(url, request, ttl);
      this.#prefetchTimeout = null;
    }, PREFETCH_DELAY);
  }

  set(url, request, ttl) {
    this.#prefetched = { url, request, expire: new Date(new Date().getTime() + ttl) };
  }

  clear() {
    if (this.#prefetchTimeout) clearTimeout(this.#prefetchTimeout);
    this.#prefetched = null;
  }
}

const cacheTtl = 10 * 1000;
const prefetchCache = new PrefetchCache();

const FormSubmissionState = {
  initialized: "initialized",
  requesting: "requesting",
  waiting: "waiting",
  receiving: "receiving",
  stopping: "stopping",
  stopped: "stopped"
};

class FormSubmission {
  state = FormSubmissionState.initialized

  static confirmMethod(message, _element, _submitter) {
    return Promise.resolve(confirm(message))
  }

  constructor(delegate, formElement, submitter, mustRedirect = false) {
    const method = getMethod(formElement, submitter);
    const action = getAction(getFormAction(formElement, submitter), method);
    const body = buildFormData(formElement, submitter);
    const enctype = getEnctype(formElement, submitter);

    this.delegate = delegate;
    this.formElement = formElement;
    this.submitter = submitter;
    this.fetchRequest = new FetchRequest(this, method, action, body, formElement, enctype);
    this.mustRedirect = mustRedirect;
  }

  get method() {
    return this.fetchRequest.method
  }

  set method(value) {
    this.fetchRequest.method = value;
  }

  get action() {
    return this.fetchRequest.url.toString()
  }

  set action(value) {
    this.fetchRequest.url = expandURL(value);
  }

  get body() {
    return this.fetchRequest.body
  }

  get enctype() {
    return this.fetchRequest.enctype
  }

  get isSafe() {
    return this.fetchRequest.isSafe
  }

  get location() {
    return this.fetchRequest.url
  }

  // The submission process

  async start() {
    const { initialized, requesting } = FormSubmissionState;
    const confirmationMessage = getAttribute("data-turbo-confirm", this.submitter, this.formElement);

    if (typeof confirmationMessage === "string") {
      const answer = await FormSubmission.confirmMethod(confirmationMessage, this.formElement, this.submitter);
      if (!answer) {
        return
      }
    }

    if (this.state == initialized) {
      this.state = requesting;
      return this.fetchRequest.perform()
    }
  }

  stop() {
    const { stopping, stopped } = FormSubmissionState;
    if (this.state != stopping && this.state != stopped) {
      this.state = stopping;
      this.fetchRequest.cancel();
      return true
    }
  }

  // Fetch request delegate

  prepareRequest(request) {
    if (!request.isSafe) {
      const token = getCookieValue(getMetaContent("csrf-param")) || getMetaContent("csrf-token");
      if (token) {
        request.headers["X-CSRF-Token"] = token;
      }
    }

    if (this.requestAcceptsTurboStreamResponse(request)) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted(_request) {
    this.state = FormSubmissionState.waiting;
    this.submitter?.setAttribute("disabled", "");
    this.setSubmitsWith();
    markAsBusy(this.formElement);
    dispatch("turbo:submit-start", {
      target: this.formElement,
      detail: { formSubmission: this }
    });
    this.delegate.formSubmissionStarted(this);
  }

  requestPreventedHandlingResponse(request, response) {
    prefetchCache.clear();

    this.result = { success: response.succeeded, fetchResponse: response };
  }

  requestSucceededWithResponse(request, response) {
    if (response.clientError || response.serverError) {
      this.delegate.formSubmissionFailedWithResponse(this, response);
      return
    }

    prefetchCache.clear();

    if (this.requestMustRedirect(request) && responseSucceededWithoutRedirect(response)) {
      const error = new Error("Form responses must redirect to another location");
      this.delegate.formSubmissionErrored(this, error);
    } else {
      this.state = FormSubmissionState.receiving;
      this.result = { success: true, fetchResponse: response };
      this.delegate.formSubmissionSucceededWithResponse(this, response);
    }
  }

  requestFailedWithResponse(request, response) {
    this.result = { success: false, fetchResponse: response };
    this.delegate.formSubmissionFailedWithResponse(this, response);
  }

  requestErrored(request, error) {
    this.result = { success: false, error };
    this.delegate.formSubmissionErrored(this, error);
  }

  requestFinished(_request) {
    this.state = FormSubmissionState.stopped;
    this.submitter?.removeAttribute("disabled");
    this.resetSubmitterText();
    clearBusyState(this.formElement);
    dispatch("turbo:submit-end", {
      target: this.formElement,
      detail: { formSubmission: this, ...this.result }
    });
    this.delegate.formSubmissionFinished(this);
  }

  // Private

  setSubmitsWith() {
    if (!this.submitter || !this.submitsWith) return

    if (this.submitter.matches("button")) {
      this.originalSubmitText = this.submitter.innerHTML;
      this.submitter.innerHTML = this.submitsWith;
    } else if (this.submitter.matches("input")) {
      const input = this.submitter;
      this.originalSubmitText = input.value;
      input.value = this.submitsWith;
    }
  }

  resetSubmitterText() {
    if (!this.submitter || !this.originalSubmitText) return

    if (this.submitter.matches("button")) {
      this.submitter.innerHTML = this.originalSubmitText;
    } else if (this.submitter.matches("input")) {
      const input = this.submitter;
      input.value = this.originalSubmitText;
    }
  }

  requestMustRedirect(request) {
    return !request.isSafe && this.mustRedirect
  }

  requestAcceptsTurboStreamResponse(request) {
    return !request.isSafe || hasAttribute("data-turbo-stream", this.submitter, this.formElement)
  }

  get submitsWith() {
    return this.submitter?.getAttribute("data-turbo-submits-with")
  }
}

function buildFormData(formElement, submitter) {
  const formData = new FormData(formElement);
  const name = submitter?.getAttribute("name");
  const value = submitter?.getAttribute("value");

  if (name) {
    formData.append(name, value || "");
  }

  return formData
}

function getCookieValue(cookieName) {
  if (cookieName != null) {
    const cookies = document.cookie ? document.cookie.split("; ") : [];
    const cookie = cookies.find((cookie) => cookie.startsWith(cookieName));
    if (cookie) {
      const value = cookie.split("=").slice(1).join("=");
      return value ? decodeURIComponent(value) : undefined
    }
  }
}

function responseSucceededWithoutRedirect(response) {
  return response.statusCode == 200 && !response.redirected
}

function getFormAction(formElement, submitter) {
  const formElementAction = typeof formElement.action === "string" ? formElement.action : null;

  if (submitter?.hasAttribute("formaction")) {
    return submitter.getAttribute("formaction") || ""
  } else {
    return formElement.getAttribute("action") || formElementAction || ""
  }
}

function getAction(formAction, fetchMethod) {
  const action = expandURL(formAction);

  if (isSafe(fetchMethod)) {
    action.search = "";
  }

  return action
}

function getMethod(formElement, submitter) {
  const method = submitter?.getAttribute("formmethod") || formElement.getAttribute("method") || "";
  return fetchMethodFromString(method.toLowerCase()) || FetchMethod.get
}

function getEnctype(formElement, submitter) {
  return fetchEnctypeFromString(submitter?.getAttribute("formenctype") || formElement.enctype)
}

class Snapshot {
  constructor(element) {
    this.element = element;
  }

  get activeElement() {
    return this.element.ownerDocument.activeElement
  }

  get children() {
    return [...this.element.children]
  }

  hasAnchor(anchor) {
    return this.getElementForAnchor(anchor) != null
  }

  getElementForAnchor(anchor) {
    return anchor ? this.element.querySelector(`[id='${anchor}'], a[name='${anchor}']`) : null
  }

  get isConnected() {
    return this.element.isConnected
  }

  get firstAutofocusableElement() {
    return queryAutofocusableElement(this.element)
  }

  get permanentElements() {
    return queryPermanentElementsAll(this.element)
  }

  getPermanentElementById(id) {
    return getPermanentElementById(this.element, id)
  }

  getPermanentElementMapForSnapshot(snapshot) {
    const permanentElementMap = {};

    for (const currentPermanentElement of this.permanentElements) {
      const { id } = currentPermanentElement;
      const newPermanentElement = snapshot.getPermanentElementById(id);
      if (newPermanentElement) {
        permanentElementMap[id] = [currentPermanentElement, newPermanentElement];
      }
    }

    return permanentElementMap
  }
}

function getPermanentElementById(node, id) {
  return node.querySelector(`#${id}[data-turbo-permanent]`)
}

function queryPermanentElementsAll(node) {
  return node.querySelectorAll("[id][data-turbo-permanent]")
}

class FormSubmitObserver {
  started = false

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (!this.started) {
      this.eventTarget.addEventListener("submit", this.submitCaptured, true);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      this.eventTarget.removeEventListener("submit", this.submitCaptured, true);
      this.started = false;
    }
  }

  submitCaptured = () => {
    this.eventTarget.removeEventListener("submit", this.submitBubbled, false);
    this.eventTarget.addEventListener("submit", this.submitBubbled, false);
  }

  submitBubbled = (event) => {
    if (!event.defaultPrevented) {
      const form = event.target instanceof HTMLFormElement ? event.target : undefined;
      const submitter = event.submitter || undefined;

      if (
        form &&
        submissionDoesNotDismissDialog(form, submitter) &&
        submissionDoesNotTargetIFrame(form, submitter) &&
        this.delegate.willSubmitForm(form, submitter)
      ) {
        event.preventDefault();
        event.stopImmediatePropagation();
        this.delegate.formSubmitted(form, submitter);
      }
    }
  }
}

function submissionDoesNotDismissDialog(form, submitter) {
  const method = submitter?.getAttribute("formmethod") || form.getAttribute("method");

  return method != "dialog"
}

function submissionDoesNotTargetIFrame(form, submitter) {
  const target = submitter?.getAttribute("formtarget") || form.getAttribute("target");

  return doesNotTargetIFrame(target)
}

class View {
  #resolveRenderPromise = (_value) => {}
  #resolveInterceptionPromise = (_value) => {}

  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
  }

  // Scrolling

  scrollToAnchor(anchor) {
    const element = this.snapshot.getElementForAnchor(anchor);
    if (element) {
      this.scrollToElement(element);
      this.focusElement(element);
    } else {
      this.scrollToPosition({ x: 0, y: 0 });
    }
  }

  scrollToAnchorFromLocation(location) {
    this.scrollToAnchor(getAnchor(location));
  }

  scrollToElement(element) {
    element.scrollIntoView();
  }

  focusElement(element) {
    if (element instanceof HTMLElement) {
      if (element.hasAttribute("tabindex")) {
        element.focus();
      } else {
        element.setAttribute("tabindex", "-1");
        element.focus();
        element.removeAttribute("tabindex");
      }
    }
  }

  scrollToPosition({ x, y }) {
    this.scrollRoot.scrollTo(x, y);
  }

  scrollToTop() {
    this.scrollToPosition({ x: 0, y: 0 });
  }

  get scrollRoot() {
    return window
  }

  // Rendering

  async render(renderer) {
    const { isPreview, shouldRender, willRender, newSnapshot: snapshot } = renderer;

    // A workaround to ignore tracked element mismatch reloads when performing
    // a promoted Visit from a frame navigation
    const shouldInvalidate = willRender;

    if (shouldRender) {
      try {
        this.renderPromise = new Promise((resolve) => (this.#resolveRenderPromise = resolve));
        this.renderer = renderer;
        await this.prepareToRenderSnapshot(renderer);

        const renderInterception = new Promise((resolve) => (this.#resolveInterceptionPromise = resolve));
        const options = { resume: this.#resolveInterceptionPromise, render: this.renderer.renderElement, renderMethod: this.renderer.renderMethod };
        const immediateRender = this.delegate.allowsImmediateRender(snapshot, options);
        if (!immediateRender) await renderInterception;

        await this.renderSnapshot(renderer);
        this.delegate.viewRenderedSnapshot(snapshot, isPreview, this.renderer.renderMethod);
        this.delegate.preloadOnLoadLinksForView(this.element);
        this.finishRenderingSnapshot(renderer);
      } finally {
        delete this.renderer;
        this.#resolveRenderPromise(undefined);
        delete this.renderPromise;
      }
    } else if (shouldInvalidate) {
      this.invalidate(renderer.reloadReason);
    }
  }

  invalidate(reason) {
    this.delegate.viewInvalidated(reason);
  }

  async prepareToRenderSnapshot(renderer) {
    this.markAsPreview(renderer.isPreview);
    await renderer.prepareToRender();
  }

  markAsPreview(isPreview) {
    if (isPreview) {
      this.element.setAttribute("data-turbo-preview", "");
    } else {
      this.element.removeAttribute("data-turbo-preview");
    }
  }

  markVisitDirection(direction) {
    this.element.setAttribute("data-turbo-visit-direction", direction);
  }

  unmarkVisitDirection() {
    this.element.removeAttribute("data-turbo-visit-direction");
  }

  async renderSnapshot(renderer) {
    await renderer.render();
  }

  finishRenderingSnapshot(renderer) {
    renderer.finishRendering();
  }
}

class FrameView extends View {
  missing() {
    this.element.innerHTML = `<strong class="turbo-frame-error">Content missing</strong>`;
  }

  get snapshot() {
    return new Snapshot(this.element)
  }
}

class LinkInterceptor {
  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
  }

  start() {
    this.element.addEventListener("click", this.clickBubbled);
    document.addEventListener("turbo:click", this.linkClicked);
    document.addEventListener("turbo:before-visit", this.willVisit);
  }

  stop() {
    this.element.removeEventListener("click", this.clickBubbled);
    document.removeEventListener("turbo:click", this.linkClicked);
    document.removeEventListener("turbo:before-visit", this.willVisit);
  }

  clickBubbled = (event) => {
    if (this.clickEventIsSignificant(event)) {
      this.clickEvent = event;
    } else {
      delete this.clickEvent;
    }
  }

  linkClicked = (event) => {
    if (this.clickEvent && this.clickEventIsSignificant(event)) {
      if (this.delegate.shouldInterceptLinkClick(event.target, event.detail.url, event.detail.originalEvent)) {
        this.clickEvent.preventDefault();
        event.preventDefault();
        this.delegate.linkClickIntercepted(event.target, event.detail.url, event.detail.originalEvent);
      }
    }
    delete this.clickEvent;
  }

  willVisit = (_event) => {
    delete this.clickEvent;
  }

  clickEventIsSignificant(event) {
    const target = event.composed ? event.target?.parentElement : event.target;
    const element = findLinkFromClickTarget(target) || target;

    return element instanceof Element && element.closest("turbo-frame, html") == this.element
  }
}

class LinkClickObserver {
  started = false

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (!this.started) {
      this.eventTarget.addEventListener("click", this.clickCaptured, true);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      this.eventTarget.removeEventListener("click", this.clickCaptured, true);
      this.started = false;
    }
  }

  clickCaptured = () => {
    this.eventTarget.removeEventListener("click", this.clickBubbled, false);
    this.eventTarget.addEventListener("click", this.clickBubbled, false);
  }

  clickBubbled = (event) => {
    if (event instanceof MouseEvent && this.clickEventIsSignificant(event)) {
      const target = (event.composedPath && event.composedPath()[0]) || event.target;
      const link = findLinkFromClickTarget(target);
      if (link && doesNotTargetIFrame(link.target)) {
        const location = getLocationForLink(link);
        if (this.delegate.willFollowLinkToLocation(link, location, event)) {
          event.preventDefault();
          this.delegate.followedLinkToLocation(link, location);
        }
      }
    }
  }

  clickEventIsSignificant(event) {
    return !(
      (event.target && event.target.isContentEditable) ||
      event.defaultPrevented ||
      event.which > 1 ||
      event.altKey ||
      event.ctrlKey ||
      event.metaKey ||
      event.shiftKey
    )
  }
}

class FormLinkClickObserver {
  constructor(delegate, element) {
    this.delegate = delegate;
    this.linkInterceptor = new LinkClickObserver(this, element);
  }

  start() {
    this.linkInterceptor.start();
  }

  stop() {
    this.linkInterceptor.stop();
  }

  // Link hover observer delegate

  canPrefetchRequestToLocation(link, location) {
    return false
  }

  prefetchAndCacheRequestToLocation(link, location) {
    return
  }

  // Link click observer delegate

  willFollowLinkToLocation(link, location, originalEvent) {
    return (
      this.delegate.willSubmitFormLinkToLocation(link, location, originalEvent) &&
      (link.hasAttribute("data-turbo-method") || link.hasAttribute("data-turbo-stream"))
    )
  }

  followedLinkToLocation(link, location) {
    const form = document.createElement("form");

    const type = "hidden";
    for (const [name, value] of location.searchParams) {
      form.append(Object.assign(document.createElement("input"), { type, name, value }));
    }

    const action = Object.assign(location, { search: "" });
    form.setAttribute("data-turbo", "true");
    form.setAttribute("action", action.href);
    form.setAttribute("hidden", "");

    const method = link.getAttribute("data-turbo-method");
    if (method) form.setAttribute("method", method);

    const turboFrame = link.getAttribute("data-turbo-frame");
    if (turboFrame) form.setAttribute("data-turbo-frame", turboFrame);

    const turboAction = getVisitAction(link);
    if (turboAction) form.setAttribute("data-turbo-action", turboAction);

    const turboConfirm = link.getAttribute("data-turbo-confirm");
    if (turboConfirm) form.setAttribute("data-turbo-confirm", turboConfirm);

    const turboStream = link.hasAttribute("data-turbo-stream");
    if (turboStream) form.setAttribute("data-turbo-stream", "");

    this.delegate.submittedFormLinkToLocation(link, location, form);

    document.body.appendChild(form);
    form.addEventListener("turbo:submit-end", () => form.remove(), { once: true });
    requestAnimationFrame(() => form.requestSubmit());
  }
}

class Bardo {
  static async preservingPermanentElements(delegate, permanentElementMap, callback) {
    const bardo = new this(delegate, permanentElementMap);
    bardo.enter();
    await callback();
    bardo.leave();
  }

  constructor(delegate, permanentElementMap) {
    this.delegate = delegate;
    this.permanentElementMap = permanentElementMap;
  }

  enter() {
    for (const id in this.permanentElementMap) {
      const [currentPermanentElement, newPermanentElement] = this.permanentElementMap[id];
      this.delegate.enteringBardo(currentPermanentElement, newPermanentElement);
      this.replaceNewPermanentElementWithPlaceholder(newPermanentElement);
    }
  }

  leave() {
    for (const id in this.permanentElementMap) {
      const [currentPermanentElement] = this.permanentElementMap[id];
      this.replaceCurrentPermanentElementWithClone(currentPermanentElement);
      this.replacePlaceholderWithPermanentElement(currentPermanentElement);
      this.delegate.leavingBardo(currentPermanentElement);
    }
  }

  replaceNewPermanentElementWithPlaceholder(permanentElement) {
    const placeholder = createPlaceholderForPermanentElement(permanentElement);
    permanentElement.replaceWith(placeholder);
  }

  replaceCurrentPermanentElementWithClone(permanentElement) {
    const clone = permanentElement.cloneNode(true);
    permanentElement.replaceWith(clone);
  }

  replacePlaceholderWithPermanentElement(permanentElement) {
    const placeholder = this.getPlaceholderById(permanentElement.id);
    placeholder?.replaceWith(permanentElement);
  }

  getPlaceholderById(id) {
    return this.placeholders.find((element) => element.content == id)
  }

  get placeholders() {
    return [...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]
  }
}

function createPlaceholderForPermanentElement(permanentElement) {
  const element = document.createElement("meta");
  element.setAttribute("name", "turbo-permanent-placeholder");
  element.setAttribute("content", permanentElement.id);
  return element
}

class Renderer {
  #activeElement = null

  constructor(currentSnapshot, newSnapshot, renderElement, isPreview, willRender = true) {
    this.currentSnapshot = currentSnapshot;
    this.newSnapshot = newSnapshot;
    this.isPreview = isPreview;
    this.willRender = willRender;
    this.renderElement = renderElement;
    this.promise = new Promise((resolve, reject) => (this.resolvingFunctions = { resolve, reject }));
  }

  get shouldRender() {
    return true
  }

  get shouldAutofocus() {
    return true
  }

  get reloadReason() {
    return
  }

  prepareToRender() {
    return
  }

  render() {
    // Abstract method
  }

  finishRendering() {
    if (this.resolvingFunctions) {
      this.resolvingFunctions.resolve();
      delete this.resolvingFunctions;
    }
  }

  async preservingPermanentElements(callback) {
    await Bardo.preservingPermanentElements(this, this.permanentElementMap, callback);
  }

  focusFirstAutofocusableElement() {
    if (this.shouldAutofocus) {
      const element = this.connectedSnapshot.firstAutofocusableElement;
      if (element) {
        element.focus();
      }
    }
  }

  // Bardo delegate

  enteringBardo(currentPermanentElement) {
    if (this.#activeElement) return

    if (currentPermanentElement.contains(this.currentSnapshot.activeElement)) {
      this.#activeElement = this.currentSnapshot.activeElement;
    }
  }

  leavingBardo(currentPermanentElement) {
    if (currentPermanentElement.contains(this.#activeElement) && this.#activeElement instanceof HTMLElement) {
      this.#activeElement.focus();

      this.#activeElement = null;
    }
  }

  get connectedSnapshot() {
    return this.newSnapshot.isConnected ? this.newSnapshot : this.currentSnapshot
  }

  get currentElement() {
    return this.currentSnapshot.element
  }

  get newElement() {
    return this.newSnapshot.element
  }

  get permanentElementMap() {
    return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)
  }

  get renderMethod() {
    return "replace"
  }
}

class FrameRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    const destinationRange = document.createRange();
    destinationRange.selectNodeContents(currentElement);
    destinationRange.deleteContents();

    const frameElement = newElement;
    const sourceRange = frameElement.ownerDocument?.createRange();
    if (sourceRange) {
      sourceRange.selectNodeContents(frameElement);
      currentElement.appendChild(sourceRange.extractContents());
    }
  }

  constructor(delegate, currentSnapshot, newSnapshot, renderElement, isPreview, willRender = true) {
    super(currentSnapshot, newSnapshot, renderElement, isPreview, willRender);
    this.delegate = delegate;
  }

  get shouldRender() {
    return true
  }

  async render() {
    await nextRepaint();
    this.preservingPermanentElements(() => {
      this.loadFrameElement();
    });
    this.scrollFrameIntoView();
    await nextRepaint();
    this.focusFirstAutofocusableElement();
    await nextRepaint();
    this.activateScriptElements();
  }

  loadFrameElement() {
    this.delegate.willRenderFrame(this.currentElement, this.newElement);
    this.renderElement(this.currentElement, this.newElement);
  }

  scrollFrameIntoView() {
    if (this.currentElement.autoscroll || this.newElement.autoscroll) {
      const element = this.currentElement.firstElementChild;
      const block = readScrollLogicalPosition(this.currentElement.getAttribute("data-autoscroll-block"), "end");
      const behavior = readScrollBehavior(this.currentElement.getAttribute("data-autoscroll-behavior"), "auto");

      if (element) {
        element.scrollIntoView({ block, behavior });
        return true
      }
    }
    return false
  }

  activateScriptElements() {
    for (const inertScriptElement of this.newScriptElements) {
      const activatedScriptElement = activateScriptElement(inertScriptElement);
      inertScriptElement.replaceWith(activatedScriptElement);
    }
  }

  get newScriptElements() {
    return this.currentElement.querySelectorAll("script")
  }
}

function readScrollLogicalPosition(value, defaultValue) {
  if (value == "end" || value == "start" || value == "center" || value == "nearest") {
    return value
  } else {
    return defaultValue
  }
}

function readScrollBehavior(value, defaultValue) {
  if (value == "auto" || value == "smooth") {
    return value
  } else {
    return defaultValue
  }
}

class ProgressBar {
  static animationDuration = 300 /*ms*/

  static get defaultCSS() {
    return unindent`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${ProgressBar.animationDuration}ms ease-out,
          opacity ${ProgressBar.animationDuration / 2}ms ${ProgressBar.animationDuration / 2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `
  }

  hiding = false
  value = 0
  visible = false

  constructor() {
    this.stylesheetElement = this.createStylesheetElement();
    this.progressElement = this.createProgressElement();
    this.installStylesheetElement();
    this.setValue(0);
  }

  show() {
    if (!this.visible) {
      this.visible = true;
      this.installProgressElement();
      this.startTrickling();
    }
  }

  hide() {
    if (this.visible && !this.hiding) {
      this.hiding = true;
      this.fadeProgressElement(() => {
        this.uninstallProgressElement();
        this.stopTrickling();
        this.visible = false;
        this.hiding = false;
      });
    }
  }

  setValue(value) {
    this.value = value;
    this.refresh();
  }

  // Private

  installStylesheetElement() {
    document.head.insertBefore(this.stylesheetElement, document.head.firstChild);
  }

  installProgressElement() {
    this.progressElement.style.width = "0";
    this.progressElement.style.opacity = "1";
    document.documentElement.insertBefore(this.progressElement, document.body);
    this.refresh();
  }

  fadeProgressElement(callback) {
    this.progressElement.style.opacity = "0";
    setTimeout(callback, ProgressBar.animationDuration * 1.5);
  }

  uninstallProgressElement() {
    if (this.progressElement.parentNode) {
      document.documentElement.removeChild(this.progressElement);
    }
  }

  startTrickling() {
    if (!this.trickleInterval) {
      this.trickleInterval = window.setInterval(this.trickle, ProgressBar.animationDuration);
    }
  }

  stopTrickling() {
    window.clearInterval(this.trickleInterval);
    delete this.trickleInterval;
  }

  trickle = () => {
    this.setValue(this.value + Math.random() / 100);
  }

  refresh() {
    requestAnimationFrame(() => {
      this.progressElement.style.width = `${10 + this.value * 90}%`;
    });
  }

  createStylesheetElement() {
    const element = document.createElement("style");
    element.type = "text/css";
    element.textContent = ProgressBar.defaultCSS;
    if (this.cspNonce) {
      element.nonce = this.cspNonce;
    }
    return element
  }

  createProgressElement() {
    const element = document.createElement("div");
    element.className = "turbo-progress-bar";
    return element
  }

  get cspNonce() {
    return getMetaContent("csp-nonce")
  }
}

class HeadSnapshot extends Snapshot {
  detailsByOuterHTML = this.children
    .filter((element) => !elementIsNoscript(element))
    .map((element) => elementWithoutNonce(element))
    .reduce((result, element) => {
      const { outerHTML } = element;
      const details =
        outerHTML in result
          ? result[outerHTML]
          : {
              type: elementType(element),
              tracked: elementIsTracked(element),
              elements: []
            };
      return {
        ...result,
        [outerHTML]: {
          ...details,
          elements: [...details.elements, element]
        }
      }
    }, {})

  get trackedElementSignature() {
    return Object.keys(this.detailsByOuterHTML)
      .filter((outerHTML) => this.detailsByOuterHTML[outerHTML].tracked)
      .join("")
  }

  getScriptElementsNotInSnapshot(snapshot) {
    return this.getElementsMatchingTypeNotInSnapshot("script", snapshot)
  }

  getStylesheetElementsNotInSnapshot(snapshot) {
    return this.getElementsMatchingTypeNotInSnapshot("stylesheet", snapshot)
  }

  getElementsMatchingTypeNotInSnapshot(matchedType, snapshot) {
    return Object.keys(this.detailsByOuterHTML)
      .filter((outerHTML) => !(outerHTML in snapshot.detailsByOuterHTML))
      .map((outerHTML) => this.detailsByOuterHTML[outerHTML])
      .filter(({ type }) => type == matchedType)
      .map(({ elements: [element] }) => element)
  }

  get provisionalElements() {
    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {
      const { type, tracked, elements } = this.detailsByOuterHTML[outerHTML];
      if (type == null && !tracked) {
        return [...result, ...elements]
      } else if (elements.length > 1) {
        return [...result, ...elements.slice(1)]
      } else {
        return result
      }
    }, [])
  }

  getMetaValue(name) {
    const element = this.findMetaElementByName(name);
    return element ? element.getAttribute("content") : null
  }

  findMetaElementByName(name) {
    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {
      const {
        elements: [element]
      } = this.detailsByOuterHTML[outerHTML];
      return elementIsMetaElementWithName(element, name) ? element : result
    }, undefined | undefined)
  }
}

function elementType(element) {
  if (elementIsScript(element)) {
    return "script"
  } else if (elementIsStylesheet(element)) {
    return "stylesheet"
  }
}

function elementIsTracked(element) {
  return element.getAttribute("data-turbo-track") == "reload"
}

function elementIsScript(element) {
  const tagName = element.localName;
  return tagName == "script"
}

function elementIsNoscript(element) {
  const tagName = element.localName;
  return tagName == "noscript"
}

function elementIsStylesheet(element) {
  const tagName = element.localName;
  return tagName == "style" || (tagName == "link" && element.getAttribute("rel") == "stylesheet")
}

function elementIsMetaElementWithName(element, name) {
  const tagName = element.localName;
  return tagName == "meta" && element.getAttribute("name") == name
}

function elementWithoutNonce(element) {
  if (element.hasAttribute("nonce")) {
    element.setAttribute("nonce", "");
  }

  return element
}

class PageSnapshot extends Snapshot {
  static fromHTMLString(html = "") {
    return this.fromDocument(parseHTMLDocument(html))
  }

  static fromElement(element) {
    return this.fromDocument(element.ownerDocument)
  }

  static fromDocument({ documentElement, body, head }) {
    return new this(documentElement, body, new HeadSnapshot(head))
  }

  constructor(documentElement, body, headSnapshot) {
    super(body);
    this.documentElement = documentElement;
    this.headSnapshot = headSnapshot;
  }

  clone() {
    const clonedElement = this.element.cloneNode(true);

    const selectElements = this.element.querySelectorAll("select");
    const clonedSelectElements = clonedElement.querySelectorAll("select");

    for (const [index, source] of selectElements.entries()) {
      const clone = clonedSelectElements[index];
      for (const option of clone.selectedOptions) option.selected = false;
      for (const option of source.selectedOptions) clone.options[option.index].selected = true;
    }

    for (const clonedPasswordInput of clonedElement.querySelectorAll('input[type="password"]')) {
      clonedPasswordInput.value = "";
    }

    return new PageSnapshot(this.documentElement, clonedElement, this.headSnapshot)
  }

  get lang() {
    return this.documentElement.getAttribute("lang")
  }

  get headElement() {
    return this.headSnapshot.element
  }

  get rootLocation() {
    const root = this.getSetting("root") ?? "/";
    return expandURL(root)
  }

  get cacheControlValue() {
    return this.getSetting("cache-control")
  }

  get isPreviewable() {
    return this.cacheControlValue != "no-preview"
  }

  get isCacheable() {
    return this.cacheControlValue != "no-cache"
  }

  get isVisitable() {
    return this.getSetting("visit-control") != "reload"
  }

  get prefersViewTransitions() {
    return this.headSnapshot.getMetaValue("view-transition") === "same-origin"
  }

  get shouldMorphPage() {
    return this.getSetting("refresh-method") === "morph"
  }

  get shouldPreserveScrollPosition() {
    return this.getSetting("refresh-scroll") === "preserve"
  }

  // Private

  getSetting(name) {
    return this.headSnapshot.getMetaValue(`turbo-${name}`)
  }
}

class ViewTransitioner {
  #viewTransitionStarted = false
  #lastOperation = Promise.resolve()

  renderChange(useViewTransition, render) {
    if (useViewTransition && this.viewTransitionsAvailable && !this.#viewTransitionStarted) {
      this.#viewTransitionStarted = true;
      this.#lastOperation = this.#lastOperation.then(async () => {
        await document.startViewTransition(render).finished;
      });
    } else {
      this.#lastOperation = this.#lastOperation.then(render);
    }

    return this.#lastOperation
  }

  get viewTransitionsAvailable() {
    return document.startViewTransition
  }
}

const defaultOptions = {
  action: "advance",
  historyChanged: false,
  visitCachedSnapshot: () => {},
  willRender: true,
  updateHistory: true,
  shouldCacheSnapshot: true,
  acceptsStreamResponse: false
};

const TimingMetric = {
  visitStart: "visitStart",
  requestStart: "requestStart",
  requestEnd: "requestEnd",
  visitEnd: "visitEnd"
};

const VisitState = {
  initialized: "initialized",
  started: "started",
  canceled: "canceled",
  failed: "failed",
  completed: "completed"
};

const SystemStatusCode = {
  networkFailure: 0,
  timeoutFailure: -1,
  contentTypeMismatch: -2
};

const Direction = {
  advance: "forward",
  restore: "back",
  replace: "none"
};

class Visit {
  identifier = uuid() // Required by turbo-ios
  timingMetrics = {}

  followedRedirect = false
  historyChanged = false
  scrolled = false
  shouldCacheSnapshot = true
  acceptsStreamResponse = false
  snapshotCached = false
  state = VisitState.initialized
  viewTransitioner = new ViewTransitioner()

  constructor(delegate, location, restorationIdentifier, options = {}) {
    this.delegate = delegate;
    this.location = location;
    this.restorationIdentifier = restorationIdentifier || uuid();

    const {
      action,
      historyChanged,
      referrer,
      snapshot,
      snapshotHTML,
      response,
      visitCachedSnapshot,
      willRender,
      updateHistory,
      shouldCacheSnapshot,
      acceptsStreamResponse,
      direction
    } = {
      ...defaultOptions,
      ...options
    };
    this.action = action;
    this.historyChanged = historyChanged;
    this.referrer = referrer;
    this.snapshot = snapshot;
    this.snapshotHTML = snapshotHTML;
    this.response = response;
    this.isSamePage = this.delegate.locationWithActionIsSamePage(this.location, this.action);
    this.isPageRefresh = this.view.isPageRefresh(this);
    this.visitCachedSnapshot = visitCachedSnapshot;
    this.willRender = willRender;
    this.updateHistory = updateHistory;
    this.scrolled = !willRender;
    this.shouldCacheSnapshot = shouldCacheSnapshot;
    this.acceptsStreamResponse = acceptsStreamResponse;
    this.direction = direction || Direction[action];
  }

  get adapter() {
    return this.delegate.adapter
  }

  get view() {
    return this.delegate.view
  }

  get history() {
    return this.delegate.history
  }

  get restorationData() {
    return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)
  }

  get silent() {
    return this.isSamePage
  }

  start() {
    if (this.state == VisitState.initialized) {
      this.recordTimingMetric(TimingMetric.visitStart);
      this.state = VisitState.started;
      this.adapter.visitStarted(this);
      this.delegate.visitStarted(this);
    }
  }

  cancel() {
    if (this.state == VisitState.started) {
      if (this.request) {
        this.request.cancel();
      }
      this.cancelRender();
      this.state = VisitState.canceled;
    }
  }

  complete() {
    if (this.state == VisitState.started) {
      this.recordTimingMetric(TimingMetric.visitEnd);
      this.adapter.visitCompleted(this);
      this.state = VisitState.completed;
      this.followRedirect();

      if (!this.followedRedirect) {
        this.delegate.visitCompleted(this);
      }
    }
  }

  fail() {
    if (this.state == VisitState.started) {
      this.state = VisitState.failed;
      this.adapter.visitFailed(this);
      this.delegate.visitCompleted(this);
    }
  }

  changeHistory() {
    if (!this.historyChanged && this.updateHistory) {
      const actionForHistory = this.location.href === this.referrer?.href ? "replace" : this.action;
      const method = getHistoryMethodForAction(actionForHistory);
      this.history.update(method, this.location, this.restorationIdentifier);
      this.historyChanged = true;
    }
  }

  issueRequest() {
    if (this.hasPreloadedResponse()) {
      this.simulateRequest();
    } else if (this.shouldIssueRequest() && !this.request) {
      this.request = new FetchRequest(this, FetchMethod.get, this.location);
      this.request.perform();
    }
  }

  simulateRequest() {
    if (this.response) {
      this.startRequest();
      this.recordResponse();
      this.finishRequest();
    }
  }

  startRequest() {
    this.recordTimingMetric(TimingMetric.requestStart);
    this.adapter.visitRequestStarted(this);
  }

  recordResponse(response = this.response) {
    this.response = response;
    if (response) {
      const { statusCode } = response;
      if (isSuccessful(statusCode)) {
        this.adapter.visitRequestCompleted(this);
      } else {
        this.adapter.visitRequestFailedWithStatusCode(this, statusCode);
      }
    }
  }

  finishRequest() {
    this.recordTimingMetric(TimingMetric.requestEnd);
    this.adapter.visitRequestFinished(this);
  }

  loadResponse() {
    if (this.response) {
      const { statusCode, responseHTML } = this.response;
      this.render(async () => {
        if (this.shouldCacheSnapshot) this.cacheSnapshot();
        if (this.view.renderPromise) await this.view.renderPromise;

        if (isSuccessful(statusCode) && responseHTML != null) {
          const snapshot = PageSnapshot.fromHTMLString(responseHTML);
          await this.renderPageSnapshot(snapshot, false);

          this.adapter.visitRendered(this);
          this.complete();
        } else {
          await this.view.renderError(PageSnapshot.fromHTMLString(responseHTML), this);
          this.adapter.visitRendered(this);
          this.fail();
        }
      });
    }
  }

  getCachedSnapshot() {
    const snapshot = this.view.getCachedSnapshotForLocation(this.location) || this.getPreloadedSnapshot();

    if (snapshot && (!getAnchor(this.location) || snapshot.hasAnchor(getAnchor(this.location)))) {
      if (this.action == "restore" || snapshot.isPreviewable) {
        return snapshot
      }
    }
  }

  getPreloadedSnapshot() {
    if (this.snapshotHTML) {
      return PageSnapshot.fromHTMLString(this.snapshotHTML)
    }
  }

  hasCachedSnapshot() {
    return this.getCachedSnapshot() != null
  }

  loadCachedSnapshot() {
    const snapshot = this.getCachedSnapshot();
    if (snapshot) {
      const isPreview = this.shouldIssueRequest();
      this.render(async () => {
        this.cacheSnapshot();
        if (this.isSamePage || this.isPageRefresh) {
          this.adapter.visitRendered(this);
        } else {
          if (this.view.renderPromise) await this.view.renderPromise;

          await this.renderPageSnapshot(snapshot, isPreview);

          this.adapter.visitRendered(this);
          if (!isPreview) {
            this.complete();
          }
        }
      });
    }
  }

  followRedirect() {
    if (this.redirectedToLocation && !this.followedRedirect && this.response?.redirected) {
      this.adapter.visitProposedToLocation(this.redirectedToLocation, {
        action: "replace",
        response: this.response,
        shouldCacheSnapshot: false,
        willRender: false
      });
      this.followedRedirect = true;
    }
  }

  goToSamePageAnchor() {
    if (this.isSamePage) {
      this.render(async () => {
        this.cacheSnapshot();
        this.performScroll();
        this.changeHistory();
        this.adapter.visitRendered(this);
      });
    }
  }

  // Fetch request delegate

  prepareRequest(request) {
    if (this.acceptsStreamResponse) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted() {
    this.startRequest();
  }

  requestPreventedHandlingResponse(_request, _response) {}

  async requestSucceededWithResponse(request, response) {
    const responseHTML = await response.responseHTML;
    const { redirected, statusCode } = response;
    if (responseHTML == undefined) {
      this.recordResponse({
        statusCode: SystemStatusCode.contentTypeMismatch,
        redirected
      });
    } else {
      this.redirectedToLocation = response.redirected ? response.location : undefined;
      this.recordResponse({ statusCode: statusCode, responseHTML, redirected });
    }
  }

  async requestFailedWithResponse(request, response) {
    const responseHTML = await response.responseHTML;
    const { redirected, statusCode } = response;
    if (responseHTML == undefined) {
      this.recordResponse({
        statusCode: SystemStatusCode.contentTypeMismatch,
        redirected
      });
    } else {
      this.recordResponse({ statusCode: statusCode, responseHTML, redirected });
    }
  }

  requestErrored(_request, _error) {
    this.recordResponse({
      statusCode: SystemStatusCode.networkFailure,
      redirected: false
    });
  }

  requestFinished() {
    this.finishRequest();
  }

  // Scrolling

  performScroll() {
    if (!this.scrolled && !this.view.forceReloaded && !this.view.shouldPreserveScrollPosition(this)) {
      if (this.action == "restore") {
        this.scrollToRestoredPosition() || this.scrollToAnchor() || this.view.scrollToTop();
      } else {
        this.scrollToAnchor() || this.view.scrollToTop();
      }
      if (this.isSamePage) {
        this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation, this.location);
      }

      this.scrolled = true;
    }
  }

  scrollToRestoredPosition() {
    const { scrollPosition } = this.restorationData;
    if (scrollPosition) {
      this.view.scrollToPosition(scrollPosition);
      return true
    }
  }

  scrollToAnchor() {
    const anchor = getAnchor(this.location);
    if (anchor != null) {
      this.view.scrollToAnchor(anchor);
      return true
    }
  }

  // Instrumentation

  recordTimingMetric(metric) {
    this.timingMetrics[metric] = new Date().getTime();
  }

  getTimingMetrics() {
    return { ...this.timingMetrics }
  }

  // Private

  getHistoryMethodForAction(action) {
    switch (action) {
      case "replace":
        return history.replaceState
      case "advance":
      case "restore":
        return history.pushState
    }
  }

  hasPreloadedResponse() {
    return typeof this.response == "object"
  }

  shouldIssueRequest() {
    if (this.isSamePage) {
      return false
    } else if (this.action == "restore") {
      return !this.hasCachedSnapshot()
    } else {
      return this.willRender
    }
  }

  cacheSnapshot() {
    if (!this.snapshotCached) {
      this.view.cacheSnapshot(this.snapshot).then((snapshot) => snapshot && this.visitCachedSnapshot(snapshot));
      this.snapshotCached = true;
    }
  }

  async render(callback) {
    this.cancelRender();
    this.frame = await nextRepaint();
    await callback();
    delete this.frame;
  }

  async renderPageSnapshot(snapshot, isPreview) {
    await this.viewTransitioner.renderChange(this.view.shouldTransitionTo(snapshot), async () => {
      await this.view.renderPage(snapshot, isPreview, this.willRender, this);
      this.performScroll();
    });
  }

  cancelRender() {
    if (this.frame) {
      cancelAnimationFrame(this.frame);
      delete this.frame;
    }
  }
}

function isSuccessful(statusCode) {
  return statusCode >= 200 && statusCode < 300
}

class BrowserAdapter {
  progressBar = new ProgressBar()

  constructor(session) {
    this.session = session;
  }

  visitProposedToLocation(location, options) {
    if (locationIsVisitable(location, this.navigator.rootLocation)) {
      this.navigator.startVisit(location, options?.restorationIdentifier || uuid(), options);
    } else {
      window.location.href = location.toString();
    }
  }

  visitStarted(visit) {
    this.location = visit.location;
    visit.loadCachedSnapshot();
    visit.issueRequest();
    visit.goToSamePageAnchor();
  }

  visitRequestStarted(visit) {
    this.progressBar.setValue(0);
    if (visit.hasCachedSnapshot() || visit.action != "restore") {
      this.showVisitProgressBarAfterDelay();
    } else {
      this.showProgressBar();
    }
  }

  visitRequestCompleted(visit) {
    visit.loadResponse();
  }

  visitRequestFailedWithStatusCode(visit, statusCode) {
    switch (statusCode) {
      case SystemStatusCode.networkFailure:
      case SystemStatusCode.timeoutFailure:
      case SystemStatusCode.contentTypeMismatch:
        return this.reload({
          reason: "request_failed",
          context: {
            statusCode
          }
        })
      default:
        return visit.loadResponse()
    }
  }

  visitRequestFinished(_visit) {}

  visitCompleted(_visit) {
    this.progressBar.setValue(1);
    this.hideVisitProgressBar();
  }

  pageInvalidated(reason) {
    this.reload(reason);
  }

  visitFailed(_visit) {
    this.progressBar.setValue(1);
    this.hideVisitProgressBar();
  }

  visitRendered(_visit) {}

  // Form Submission Delegate

  formSubmissionStarted(_formSubmission) {
    this.progressBar.setValue(0);
    this.showFormProgressBarAfterDelay();
  }

  formSubmissionFinished(_formSubmission) {
    this.progressBar.setValue(1);
    this.hideFormProgressBar();
  }

  // Private

  showVisitProgressBarAfterDelay() {
    this.visitProgressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay);
  }

  hideVisitProgressBar() {
    this.progressBar.hide();
    if (this.visitProgressBarTimeout != null) {
      window.clearTimeout(this.visitProgressBarTimeout);
      delete this.visitProgressBarTimeout;
    }
  }

  showFormProgressBarAfterDelay() {
    if (this.formProgressBarTimeout == null) {
      this.formProgressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay);
    }
  }

  hideFormProgressBar() {
    this.progressBar.hide();
    if (this.formProgressBarTimeout != null) {
      window.clearTimeout(this.formProgressBarTimeout);
      delete this.formProgressBarTimeout;
    }
  }

  showProgressBar = () => {
    this.progressBar.show();
  }

  reload(reason) {
    dispatch("turbo:reload", { detail: reason });

    window.location.href = this.location?.toString() || window.location.href;
  }

  get navigator() {
    return this.session.navigator
  }
}

class CacheObserver {
  selector = "[data-turbo-temporary]"
  deprecatedSelector = "[data-turbo-cache=false]"

  started = false

  start() {
    if (!this.started) {
      this.started = true;
      addEventListener("turbo:before-cache", this.removeTemporaryElements, false);
    }
  }

  stop() {
    if (this.started) {
      this.started = false;
      removeEventListener("turbo:before-cache", this.removeTemporaryElements, false);
    }
  }

  removeTemporaryElements = (_event) => {
    for (const element of this.temporaryElements) {
      element.remove();
    }
  }

  get temporaryElements() {
    return [...document.querySelectorAll(this.selector), ...this.temporaryElementsWithDeprecation]
  }

  get temporaryElementsWithDeprecation() {
    const elements = document.querySelectorAll(this.deprecatedSelector);

    if (elements.length) {
      console.warn(
        `The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`
      );
    }

    return [...elements]
  }
}

class FrameRedirector {
  constructor(session, element) {
    this.session = session;
    this.element = element;
    this.linkInterceptor = new LinkInterceptor(this, element);
    this.formSubmitObserver = new FormSubmitObserver(this, element);
  }

  start() {
    this.linkInterceptor.start();
    this.formSubmitObserver.start();
  }

  stop() {
    this.linkInterceptor.stop();
    this.formSubmitObserver.stop();
  }

  // Link interceptor delegate

  shouldInterceptLinkClick(element, _location, _event) {
    return this.#shouldRedirect(element)
  }

  linkClickIntercepted(element, url, event) {
    const frame = this.#findFrameElement(element);
    if (frame) {
      frame.delegate.linkClickIntercepted(element, url, event);
    }
  }

  // Form submit observer delegate

  willSubmitForm(element, submitter) {
    return (
      element.closest("turbo-frame") == null &&
      this.#shouldSubmit(element, submitter) &&
      this.#shouldRedirect(element, submitter)
    )
  }

  formSubmitted(element, submitter) {
    const frame = this.#findFrameElement(element, submitter);
    if (frame) {
      frame.delegate.formSubmitted(element, submitter);
    }
  }

  #shouldSubmit(form, submitter) {
    const action = getAction$1(form, submitter);
    const meta = this.element.ownerDocument.querySelector(`meta[name="turbo-root"]`);
    const rootLocation = expandURL(meta?.content ?? "/");

    return this.#shouldRedirect(form, submitter) && locationIsVisitable(action, rootLocation)
  }

  #shouldRedirect(element, submitter) {
    const isNavigatable =
      element instanceof HTMLFormElement
        ? this.session.submissionIsNavigatable(element, submitter)
        : this.session.elementIsNavigatable(element);

    if (isNavigatable) {
      const frame = this.#findFrameElement(element, submitter);
      return frame ? frame != element.closest("turbo-frame") : false
    } else {
      return false
    }
  }

  #findFrameElement(element, submitter) {
    const id = submitter?.getAttribute("data-turbo-frame") || element.getAttribute("data-turbo-frame");
    if (id && id != "_top") {
      const frame = this.element.querySelector(`#${id}:not([disabled])`);
      if (frame instanceof FrameElement) {
        return frame
      }
    }
  }
}

class History {
  location
  restorationIdentifier = uuid()
  restorationData = {}
  started = false
  pageLoaded = false
  currentIndex = 0

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      addEventListener("popstate", this.onPopState, false);
      addEventListener("load", this.onPageLoad, false);
      this.currentIndex = history.state?.turbo?.restorationIndex || 0;
      this.started = true;
      this.replace(new URL(window.location.href));
    }
  }

  stop() {
    if (this.started) {
      removeEventListener("popstate", this.onPopState, false);
      removeEventListener("load", this.onPageLoad, false);
      this.started = false;
    }
  }

  push(location, restorationIdentifier) {
    this.update(history.pushState, location, restorationIdentifier);
  }

  replace(location, restorationIdentifier) {
    this.update(history.replaceState, location, restorationIdentifier);
  }

  update(method, location, restorationIdentifier = uuid()) {
    if (method === history.pushState) ++this.currentIndex;

    const state = { turbo: { restorationIdentifier, restorationIndex: this.currentIndex } };
    method.call(history, state, "", location.href);
    this.location = location;
    this.restorationIdentifier = restorationIdentifier;
  }

  // Restoration data

  getRestorationDataForIdentifier(restorationIdentifier) {
    return this.restorationData[restorationIdentifier] || {}
  }

  updateRestorationData(additionalData) {
    const { restorationIdentifier } = this;
    const restorationData = this.restorationData[restorationIdentifier];
    this.restorationData[restorationIdentifier] = {
      ...restorationData,
      ...additionalData
    };
  }

  // Scroll restoration

  assumeControlOfScrollRestoration() {
    if (!this.previousScrollRestoration) {
      this.previousScrollRestoration = history.scrollRestoration ?? "auto";
      history.scrollRestoration = "manual";
    }
  }

  relinquishControlOfScrollRestoration() {
    if (this.previousScrollRestoration) {
      history.scrollRestoration = this.previousScrollRestoration;
      delete this.previousScrollRestoration;
    }
  }

  // Event handlers

  onPopState = (event) => {
    if (this.shouldHandlePopState()) {
      const { turbo } = event.state || {};
      if (turbo) {
        this.location = new URL(window.location.href);
        const { restorationIdentifier, restorationIndex } = turbo;
        this.restorationIdentifier = restorationIdentifier;
        const direction = restorationIndex > this.currentIndex ? "forward" : "back";
        this.delegate.historyPoppedToLocationWithRestorationIdentifierAndDirection(this.location, restorationIdentifier, direction);
        this.currentIndex = restorationIndex;
      }
    }
  }

  onPageLoad = async (_event) => {
    await nextMicrotask();
    this.pageLoaded = true;
  }

  // Private

  shouldHandlePopState() {
    // Safari dispatches a popstate event after window's load event, ignore it
    return this.pageIsLoaded()
  }

  pageIsLoaded() {
    return this.pageLoaded || document.readyState == "complete"
  }
}

class LinkPrefetchObserver {
  started = false
  #prefetchedLink = null

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (this.started) return

    if (this.eventTarget.readyState === "loading") {
      this.eventTarget.addEventListener("DOMContentLoaded", this.#enable, { once: true });
    } else {
      this.#enable();
    }
  }

  stop() {
    if (!this.started) return

    this.eventTarget.removeEventListener("mouseenter", this.#tryToPrefetchRequest, {
      capture: true,
      passive: true
    });
    this.eventTarget.removeEventListener("mouseleave", this.#cancelRequestIfObsolete, {
      capture: true,
      passive: true
    });

    this.eventTarget.removeEventListener("turbo:before-fetch-request", this.#tryToUsePrefetchedRequest, true);
    this.started = false;
  }

  #enable = () => {
    this.eventTarget.addEventListener("mouseenter", this.#tryToPrefetchRequest, {
      capture: true,
      passive: true
    });
    this.eventTarget.addEventListener("mouseleave", this.#cancelRequestIfObsolete, {
      capture: true,
      passive: true
    });

    this.eventTarget.addEventListener("turbo:before-fetch-request", this.#tryToUsePrefetchedRequest, true);
    this.started = true;
  }

  #tryToPrefetchRequest = (event) => {
    if (getMetaContent("turbo-prefetch") === "false") return

    const target = event.target;
    const isLink = target.matches && target.matches("a[href]:not([target^=_]):not([download])");

    if (isLink && this.#isPrefetchable(target)) {
      const link = target;
      const location = getLocationForLink(link);

      if (this.delegate.canPrefetchRequestToLocation(link, location)) {
        this.#prefetchedLink = link;

        const fetchRequest = new FetchRequest(
          this,
          FetchMethod.get,
          location,
          new URLSearchParams(),
          target
        );

        prefetchCache.setLater(location.toString(), fetchRequest, this.#cacheTtl);
      }
    }
  }

  #cancelRequestIfObsolete = (event) => {
    if (event.target === this.#prefetchedLink) this.#cancelPrefetchRequest();
  }

  #cancelPrefetchRequest = () => {
    prefetchCache.clear();
    this.#prefetchedLink = null;
  }

  #tryToUsePrefetchedRequest = (event) => {
    if (event.target.tagName !== "FORM" && event.detail.fetchOptions.method === "GET") {
      const cached = prefetchCache.get(event.detail.url.toString());

      if (cached) {
        // User clicked link, use cache response
        event.detail.fetchRequest = cached;
      }

      prefetchCache.clear();
    }
  }

  prepareRequest(request) {
    const link = request.target;

    request.headers["X-Sec-Purpose"] = "prefetch";

    const turboFrame = link.closest("turbo-frame");
    const turboFrameTarget = link.getAttribute("data-turbo-frame") || turboFrame?.getAttribute("target") || turboFrame?.id;

    if (turboFrameTarget && turboFrameTarget !== "_top") {
      request.headers["Turbo-Frame"] = turboFrameTarget;
    }
  }

  // Fetch request interface

  requestSucceededWithResponse() {}

  requestStarted(fetchRequest) {}

  requestErrored(fetchRequest) {}

  requestFinished(fetchRequest) {}

  requestPreventedHandlingResponse(fetchRequest, fetchResponse) {}

  requestFailedWithResponse(fetchRequest, fetchResponse) {}

  get #cacheTtl() {
    return Number(getMetaContent("turbo-prefetch-cache-time")) || cacheTtl
  }

  #isPrefetchable(link) {
    const href = link.getAttribute("href");

    if (!href) return false

    if (unfetchableLink(link)) return false
    if (linkToTheSamePage(link)) return false
    if (linkOptsOut(link)) return false
    if (nonSafeLink(link)) return false
    if (eventPrevented(link)) return false

    return true
  }
}

const unfetchableLink = (link) => {
  return link.origin !== document.location.origin || !["http:", "https:"].includes(link.protocol) || link.hasAttribute("target")
};

const linkToTheSamePage = (link) => {
  return (link.pathname + link.search === document.location.pathname + document.location.search) || link.href.startsWith("#")
};

const linkOptsOut = (link) => {
  if (link.getAttribute("data-turbo-prefetch") === "false") return true
  if (link.getAttribute("data-turbo") === "false") return true

  const turboPrefetchParent = findClosestRecursively(link, "[data-turbo-prefetch]");
  if (turboPrefetchParent && turboPrefetchParent.getAttribute("data-turbo-prefetch") === "false") return true

  return false
};

const nonSafeLink = (link) => {
  const turboMethod = link.getAttribute("data-turbo-method");
  if (turboMethod && turboMethod.toLowerCase() !== "get") return true

  if (isUJS(link)) return true
  if (link.hasAttribute("data-turbo-confirm")) return true
  if (link.hasAttribute("data-turbo-stream")) return true

  return false
};

const isUJS = (link) => {
  return link.hasAttribute("data-remote") || link.hasAttribute("data-behavior") || link.hasAttribute("data-confirm") || link.hasAttribute("data-method")
};

const eventPrevented = (link) => {
  const event = dispatch("turbo:before-prefetch", { target: link, cancelable: true });
  return event.defaultPrevented
};

class Navigator {
  constructor(delegate) {
    this.delegate = delegate;
  }

  proposeVisit(location, options = {}) {
    if (this.delegate.allowsVisitingLocationWithAction(location, options.action)) {
      this.delegate.visitProposedToLocation(location, options);
    }
  }

  startVisit(locatable, restorationIdentifier, options = {}) {
    this.stop();
    this.currentVisit = new Visit(this, expandURL(locatable), restorationIdentifier, {
      referrer: this.location,
      ...options
    });
    this.currentVisit.start();
  }

  submitForm(form, submitter) {
    this.stop();
    this.formSubmission = new FormSubmission(this, form, submitter, true);

    this.formSubmission.start();
  }

  stop() {
    if (this.formSubmission) {
      this.formSubmission.stop();
      delete this.formSubmission;
    }

    if (this.currentVisit) {
      this.currentVisit.cancel();
      delete this.currentVisit;
    }
  }

  get adapter() {
    return this.delegate.adapter
  }

  get view() {
    return this.delegate.view
  }

  get rootLocation() {
    return this.view.snapshot.rootLocation
  }

  get history() {
    return this.delegate.history
  }

  // Form submission delegate

  formSubmissionStarted(formSubmission) {
    // Not all adapters implement formSubmissionStarted
    if (typeof this.adapter.formSubmissionStarted === "function") {
      this.adapter.formSubmissionStarted(formSubmission);
    }
  }

  async formSubmissionSucceededWithResponse(formSubmission, fetchResponse) {
    if (formSubmission == this.formSubmission) {
      const responseHTML = await fetchResponse.responseHTML;
      if (responseHTML) {
        const shouldCacheSnapshot = formSubmission.isSafe;
        if (!shouldCacheSnapshot) {
          this.view.clearSnapshotCache();
        }

        const { statusCode, redirected } = fetchResponse;
        const action = this.#getActionForFormSubmission(formSubmission, fetchResponse);
        const visitOptions = {
          action,
          shouldCacheSnapshot,
          response: { statusCode, responseHTML, redirected }
        };
        this.proposeVisit(fetchResponse.location, visitOptions);
      }
    }
  }

  async formSubmissionFailedWithResponse(formSubmission, fetchResponse) {
    const responseHTML = await fetchResponse.responseHTML;

    if (responseHTML) {
      const snapshot = PageSnapshot.fromHTMLString(responseHTML);
      if (fetchResponse.serverError) {
        await this.view.renderError(snapshot, this.currentVisit);
      } else {
        await this.view.renderPage(snapshot, false, true, this.currentVisit);
      }
      if(!snapshot.shouldPreserveScrollPosition) {
        this.view.scrollToTop();
      }
      this.view.clearSnapshotCache();
    }
  }

  formSubmissionErrored(formSubmission, error) {
    console.error(error);
  }

  formSubmissionFinished(formSubmission) {
    // Not all adapters implement formSubmissionFinished
    if (typeof this.adapter.formSubmissionFinished === "function") {
      this.adapter.formSubmissionFinished(formSubmission);
    }
  }

  // Visit delegate

  visitStarted(visit) {
    this.delegate.visitStarted(visit);
  }

  visitCompleted(visit) {
    this.delegate.visitCompleted(visit);
    delete this.currentVisit;
  }

  locationWithActionIsSamePage(location, action) {
    const anchor = getAnchor(location);
    const currentAnchor = getAnchor(this.view.lastRenderedLocation);
    const isRestorationToTop = action === "restore" && typeof anchor === "undefined";

    return (
      action !== "replace" &&
      getRequestURL(location) === getRequestURL(this.view.lastRenderedLocation) &&
      (isRestorationToTop || (anchor != null && anchor !== currentAnchor))
    )
  }

  visitScrolledToSamePageLocation(oldURL, newURL) {
    this.delegate.visitScrolledToSamePageLocation(oldURL, newURL);
  }

  // Visits

  get location() {
    return this.history.location
  }

  get restorationIdentifier() {
    return this.history.restorationIdentifier
  }

  #getActionForFormSubmission(formSubmission, fetchResponse) {
    const { submitter, formElement } = formSubmission;
    return getVisitAction(submitter, formElement) || this.#getDefaultAction(fetchResponse)
  }

  #getDefaultAction(fetchResponse) {
    const sameLocationRedirect = fetchResponse.redirected && fetchResponse.location.href === this.location?.href;
    return sameLocationRedirect ? "replace" : "advance"
  }
}

const PageStage = {
  initial: 0,
  loading: 1,
  interactive: 2,
  complete: 3
};

class PageObserver {
  stage = PageStage.initial
  started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      if (this.stage == PageStage.initial) {
        this.stage = PageStage.loading;
      }
      document.addEventListener("readystatechange", this.interpretReadyState, false);
      addEventListener("pagehide", this.pageWillUnload, false);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      document.removeEventListener("readystatechange", this.interpretReadyState, false);
      removeEventListener("pagehide", this.pageWillUnload, false);
      this.started = false;
    }
  }

  interpretReadyState = () => {
    const { readyState } = this;
    if (readyState == "interactive") {
      this.pageIsInteractive();
    } else if (readyState == "complete") {
      this.pageIsComplete();
    }
  }

  pageIsInteractive() {
    if (this.stage == PageStage.loading) {
      this.stage = PageStage.interactive;
      this.delegate.pageBecameInteractive();
    }
  }

  pageIsComplete() {
    this.pageIsInteractive();
    if (this.stage == PageStage.interactive) {
      this.stage = PageStage.complete;
      this.delegate.pageLoaded();
    }
  }

  pageWillUnload = () => {
    this.delegate.pageWillUnload();
  }

  get readyState() {
    return document.readyState
  }
}

class ScrollObserver {
  started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      addEventListener("scroll", this.onScroll, false);
      this.onScroll();
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      removeEventListener("scroll", this.onScroll, false);
      this.started = false;
    }
  }

  onScroll = () => {
    this.updatePosition({ x: window.pageXOffset, y: window.pageYOffset });
  }

  // Private

  updatePosition(position) {
    this.delegate.scrollPositionChanged(position);
  }
}

class StreamMessageRenderer {
  render({ fragment }) {
    Bardo.preservingPermanentElements(this, getPermanentElementMapForFragment(fragment), () => {
      withAutofocusFromFragment(fragment, () => {
        withPreservedFocus(() => {
          document.documentElement.appendChild(fragment);
        });
      });
    });
  }

  // Bardo delegate

  enteringBardo(currentPermanentElement, newPermanentElement) {
    newPermanentElement.replaceWith(currentPermanentElement.cloneNode(true));
  }

  leavingBardo() {}
}

function getPermanentElementMapForFragment(fragment) {
  const permanentElementsInDocument = queryPermanentElementsAll(document.documentElement);
  const permanentElementMap = {};
  for (const permanentElementInDocument of permanentElementsInDocument) {
    const { id } = permanentElementInDocument;

    for (const streamElement of fragment.querySelectorAll("turbo-stream")) {
      const elementInStream = getPermanentElementById(streamElement.templateElement.content, id);

      if (elementInStream) {
        permanentElementMap[id] = [permanentElementInDocument, elementInStream];
      }
    }
  }

  return permanentElementMap
}

async function withAutofocusFromFragment(fragment, callback) {
  const generatedID = `turbo-stream-autofocus-${uuid()}`;
  const turboStreams = fragment.querySelectorAll("turbo-stream");
  const elementWithAutofocus = firstAutofocusableElementInStreams(turboStreams);
  let willAutofocusId = null;

  if (elementWithAutofocus) {
    if (elementWithAutofocus.id) {
      willAutofocusId = elementWithAutofocus.id;
    } else {
      willAutofocusId = generatedID;
    }

    elementWithAutofocus.id = willAutofocusId;
  }

  callback();
  await nextRepaint();

  const hasNoActiveElement = document.activeElement == null || document.activeElement == document.body;

  if (hasNoActiveElement && willAutofocusId) {
    const elementToAutofocus = document.getElementById(willAutofocusId);

    if (elementIsFocusable(elementToAutofocus)) {
      elementToAutofocus.focus();
    }
    if (elementToAutofocus && elementToAutofocus.id == generatedID) {
      elementToAutofocus.removeAttribute("id");
    }
  }
}

async function withPreservedFocus(callback) {
  const [activeElementBeforeRender, activeElementAfterRender] = await around(callback, () => document.activeElement);

  const restoreFocusTo = activeElementBeforeRender && activeElementBeforeRender.id;

  if (restoreFocusTo) {
    const elementToFocus = document.getElementById(restoreFocusTo);

    if (elementIsFocusable(elementToFocus) && elementToFocus != activeElementAfterRender) {
      elementToFocus.focus();
    }
  }
}

function firstAutofocusableElementInStreams(nodeListOfStreamElements) {
  for (const streamElement of nodeListOfStreamElements) {
    const elementWithAutofocus = queryAutofocusableElement(streamElement.templateElement.content);

    if (elementWithAutofocus) return elementWithAutofocus
  }

  return null
}

class StreamObserver {
  sources = new Set()
  #started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.#started) {
      this.#started = true;
      addEventListener("turbo:before-fetch-response", this.inspectFetchResponse, false);
    }
  }

  stop() {
    if (this.#started) {
      this.#started = false;
      removeEventListener("turbo:before-fetch-response", this.inspectFetchResponse, false);
    }
  }

  connectStreamSource(source) {
    if (!this.streamSourceIsConnected(source)) {
      this.sources.add(source);
      source.addEventListener("message", this.receiveMessageEvent, false);
    }
  }

  disconnectStreamSource(source) {
    if (this.streamSourceIsConnected(source)) {
      this.sources.delete(source);
      source.removeEventListener("message", this.receiveMessageEvent, false);
    }
  }

  streamSourceIsConnected(source) {
    return this.sources.has(source)
  }

  inspectFetchResponse = (event) => {
    const response = fetchResponseFromEvent(event);
    if (response && fetchResponseIsStream(response)) {
      event.preventDefault();
      this.receiveMessageResponse(response);
    }
  }

  receiveMessageEvent = (event) => {
    if (this.#started && typeof event.data == "string") {
      this.receiveMessageHTML(event.data);
    }
  }

  async receiveMessageResponse(response) {
    const html = await response.responseHTML;
    if (html) {
      this.receiveMessageHTML(html);
    }
  }

  receiveMessageHTML(html) {
    this.delegate.receivedMessageFromStream(StreamMessage.wrap(html));
  }
}

function fetchResponseFromEvent(event) {
  const fetchResponse = event.detail?.fetchResponse;
  if (fetchResponse instanceof FetchResponse) {
    return fetchResponse
  }
}

function fetchResponseIsStream(response) {
  const contentType = response.contentType ?? "";
  return contentType.startsWith(StreamMessage.contentType)
}

class ErrorRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    const { documentElement, body } = document;

    documentElement.replaceChild(newElement, body);
  }

  async render() {
    this.replaceHeadAndBody();
    this.activateScriptElements();
  }

  replaceHeadAndBody() {
    const { documentElement, head } = document;
    documentElement.replaceChild(this.newHead, head);
    this.renderElement(this.currentElement, this.newElement);
  }

  activateScriptElements() {
    for (const replaceableElement of this.scriptElements) {
      const parentNode = replaceableElement.parentNode;
      if (parentNode) {
        const element = activateScriptElement(replaceableElement);
        parentNode.replaceChild(element, replaceableElement);
      }
    }
  }

  get newHead() {
    return this.newSnapshot.headSnapshot.element
  }

  get scriptElements() {
    return document.documentElement.querySelectorAll("script")
  }
}

// base IIFE to define idiomorph
var Idiomorph = (function () {

        //=============================================================================
        // AND NOW IT BEGINS...
        //=============================================================================
        let EMPTY_SET = new Set();

        // default configuration values, updatable by users now
        let defaults = {
            morphStyle: "outerHTML",
            callbacks : {
                beforeNodeAdded: noOp,
                afterNodeAdded: noOp,
                beforeNodeMorphed: noOp,
                afterNodeMorphed: noOp,
                beforeNodeRemoved: noOp,
                afterNodeRemoved: noOp,
                beforeAttributeUpdated: noOp,

            },
            head: {
                style: 'merge',
                shouldPreserve: function (elt) {
                    return elt.getAttribute("im-preserve") === "true";
                },
                shouldReAppend: function (elt) {
                    return elt.getAttribute("im-re-append") === "true";
                },
                shouldRemove: noOp,
                afterHeadMorphed: noOp,
            }
        };

        //=============================================================================
        // Core Morphing Algorithm - morph, morphNormalizedContent, morphOldNodeTo, morphChildren
        //=============================================================================
        function morph(oldNode, newContent, config = {}) {

            if (oldNode instanceof Document) {
                oldNode = oldNode.documentElement;
            }

            if (typeof newContent === 'string') {
                newContent = parseContent(newContent);
            }

            let normalizedContent = normalizeContent(newContent);

            let ctx = createMorphContext(oldNode, normalizedContent, config);

            return morphNormalizedContent(oldNode, normalizedContent, ctx);
        }

        function morphNormalizedContent(oldNode, normalizedNewContent, ctx) {
            if (ctx.head.block) {
                let oldHead = oldNode.querySelector('head');
                let newHead = normalizedNewContent.querySelector('head');
                if (oldHead && newHead) {
                    let promises = handleHeadElement(newHead, oldHead, ctx);
                    // when head promises resolve, call morph again, ignoring the head tag
                    Promise.all(promises).then(function () {
                        morphNormalizedContent(oldNode, normalizedNewContent, Object.assign(ctx, {
                            head: {
                                block: false,
                                ignore: true
                            }
                        }));
                    });
                    return;
                }
            }

            if (ctx.morphStyle === "innerHTML") {

                // innerHTML, so we are only updating the children
                morphChildren(normalizedNewContent, oldNode, ctx);
                return oldNode.children;

            } else if (ctx.morphStyle === "outerHTML" || ctx.morphStyle == null) {
                // otherwise find the best element match in the new content, morph that, and merge its siblings
                // into either side of the best match
                let bestMatch = findBestNodeMatch(normalizedNewContent, oldNode, ctx);

                // stash the siblings that will need to be inserted on either side of the best match
                let previousSibling = bestMatch?.previousSibling;
                let nextSibling = bestMatch?.nextSibling;

                // morph it
                let morphedNode = morphOldNodeTo(oldNode, bestMatch, ctx);

                if (bestMatch) {
                    // if there was a best match, merge the siblings in too and return the
                    // whole bunch
                    return insertSiblings(previousSibling, morphedNode, nextSibling);
                } else {
                    // otherwise nothing was added to the DOM
                    return []
                }
            } else {
                throw "Do not understand how to morph style " + ctx.morphStyle;
            }
        }


        /**
         * @param possibleActiveElement
         * @param ctx
         * @returns {boolean}
         */
        function ignoreValueOfActiveElement(possibleActiveElement, ctx) {
            return ctx.ignoreActiveValue && possibleActiveElement === document.activeElement && possibleActiveElement !== document.body;
        }

        /**
         * @param oldNode root node to merge content into
         * @param newContent new content to merge
         * @param ctx the merge context
         * @returns {Element} the element that ended up in the DOM
         */
        function morphOldNodeTo(oldNode, newContent, ctx) {
            if (ctx.ignoreActive && oldNode === document.activeElement) ; else if (newContent == null) {
                if (ctx.callbacks.beforeNodeRemoved(oldNode) === false) return oldNode;

                oldNode.remove();
                ctx.callbacks.afterNodeRemoved(oldNode);
                return null;
            } else if (!isSoftMatch(oldNode, newContent)) {
                if (ctx.callbacks.beforeNodeRemoved(oldNode) === false) return oldNode;
                if (ctx.callbacks.beforeNodeAdded(newContent) === false) return oldNode;

                oldNode.parentElement.replaceChild(newContent, oldNode);
                ctx.callbacks.afterNodeAdded(newContent);
                ctx.callbacks.afterNodeRemoved(oldNode);
                return newContent;
            } else {
                if (ctx.callbacks.beforeNodeMorphed(oldNode, newContent) === false) return oldNode;

                if (oldNode instanceof HTMLHeadElement && ctx.head.ignore) ; else if (oldNode instanceof HTMLHeadElement && ctx.head.style !== "morph") {
                    handleHeadElement(newContent, oldNode, ctx);
                } else {
                    syncNodeFrom(newContent, oldNode, ctx);
                    if (!ignoreValueOfActiveElement(oldNode, ctx)) {
                        morphChildren(newContent, oldNode, ctx);
                    }
                }
                ctx.callbacks.afterNodeMorphed(oldNode, newContent);
                return oldNode;
            }
        }

        /**
         * This is the core algorithm for matching up children.  The idea is to use id sets to try to match up
         * nodes as faithfully as possible.  We greedily match, which allows us to keep the algorithm fast, but
         * by using id sets, we are able to better match up with content deeper in the DOM.
         *
         * Basic algorithm is, for each node in the new content:
         *
         * - if we have reached the end of the old parent, append the new content
         * - if the new content has an id set match with the current insertion point, morph
         * - search for an id set match
         * - if id set match found, morph
         * - otherwise search for a "soft" match
         * - if a soft match is found, morph
         * - otherwise, prepend the new node before the current insertion point
         *
         * The two search algorithms terminate if competing node matches appear to outweigh what can be achieved
         * with the current node.  See findIdSetMatch() and findSoftMatch() for details.
         *
         * @param {Element} newParent the parent element of the new content
         * @param {Element } oldParent the old content that we are merging the new content into
         * @param ctx the merge context
         */
        function morphChildren(newParent, oldParent, ctx) {

            let nextNewChild = newParent.firstChild;
            let insertionPoint = oldParent.firstChild;
            let newChild;

            // run through all the new content
            while (nextNewChild) {

                newChild = nextNewChild;
                nextNewChild = newChild.nextSibling;

                // if we are at the end of the exiting parent's children, just append
                if (insertionPoint == null) {
                    if (ctx.callbacks.beforeNodeAdded(newChild) === false) return;

                    oldParent.appendChild(newChild);
                    ctx.callbacks.afterNodeAdded(newChild);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // if the current node has an id set match then morph
                if (isIdSetMatch(newChild, insertionPoint, ctx)) {
                    morphOldNodeTo(insertionPoint, newChild, ctx);
                    insertionPoint = insertionPoint.nextSibling;
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // otherwise search forward in the existing old children for an id set match
                let idSetMatch = findIdSetMatch(newParent, oldParent, newChild, insertionPoint, ctx);

                // if we found a potential match, remove the nodes until that point and morph
                if (idSetMatch) {
                    insertionPoint = removeNodesBetween(insertionPoint, idSetMatch, ctx);
                    morphOldNodeTo(idSetMatch, newChild, ctx);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // no id set match found, so scan forward for a soft match for the current node
                let softMatch = findSoftMatch(newParent, oldParent, newChild, insertionPoint, ctx);

                // if we found a soft match for the current node, morph
                if (softMatch) {
                    insertionPoint = removeNodesBetween(insertionPoint, softMatch, ctx);
                    morphOldNodeTo(softMatch, newChild, ctx);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // abandon all hope of morphing, just insert the new child before the insertion point
                // and move on
                if (ctx.callbacks.beforeNodeAdded(newChild) === false) return;

                oldParent.insertBefore(newChild, insertionPoint);
                ctx.callbacks.afterNodeAdded(newChild);
                removeIdsFromConsideration(ctx, newChild);
            }

            // remove any remaining old nodes that didn't match up with new content
            while (insertionPoint !== null) {

                let tempNode = insertionPoint;
                insertionPoint = insertionPoint.nextSibling;
                removeNode(tempNode, ctx);
            }
        }

        //=============================================================================
        // Attribute Syncing Code
        //=============================================================================

        /**
         * @param attr {String} the attribute to be mutated
         * @param to {Element} the element that is going to be updated
         * @param updateType {("update"|"remove")}
         * @param ctx the merge context
         * @returns {boolean} true if the attribute should be ignored, false otherwise
         */
        function ignoreAttribute(attr, to, updateType, ctx) {
            if(attr === 'value' && ctx.ignoreActiveValue && to === document.activeElement){
                return true;
            }
            return ctx.callbacks.beforeAttributeUpdated(attr, to, updateType) === false;
        }

        /**
         * syncs a given node with another node, copying over all attributes and
         * inner element state from the 'from' node to the 'to' node
         *
         * @param {Element} from the element to copy attributes & state from
         * @param {Element} to the element to copy attributes & state to
         * @param ctx the merge context
         */
        function syncNodeFrom(from, to, ctx) {
            let type = from.nodeType;

            // if is an element type, sync the attributes from the
            // new node into the new node
            if (type === 1 /* element type */) {
                const fromAttributes = from.attributes;
                const toAttributes = to.attributes;
                for (const fromAttribute of fromAttributes) {
                    if (ignoreAttribute(fromAttribute.name, to, 'update', ctx)) {
                        continue;
                    }
                    if (to.getAttribute(fromAttribute.name) !== fromAttribute.value) {
                        to.setAttribute(fromAttribute.name, fromAttribute.value);
                    }
                }
                // iterate backwards to avoid skipping over items when a delete occurs
                for (let i = toAttributes.length - 1; 0 <= i; i--) {
                    const toAttribute = toAttributes[i];
                    if (ignoreAttribute(toAttribute.name, to, 'remove', ctx)) {
                        continue;
                    }
                    if (!from.hasAttribute(toAttribute.name)) {
                        to.removeAttribute(toAttribute.name);
                    }
                }
            }

            // sync text nodes
            if (type === 8 /* comment */ || type === 3 /* text */) {
                if (to.nodeValue !== from.nodeValue) {
                    to.nodeValue = from.nodeValue;
                }
            }

            if (!ignoreValueOfActiveElement(to, ctx)) {
                // sync input values
                syncInputValue(from, to, ctx);
            }
        }

        /**
         * @param from {Element} element to sync the value from
         * @param to {Element} element to sync the value to
         * @param attributeName {String} the attribute name
         * @param ctx the merge context
         */
        function syncBooleanAttribute(from, to, attributeName, ctx) {
            if (from[attributeName] !== to[attributeName]) {
                let ignoreUpdate = ignoreAttribute(attributeName, to, 'update', ctx);
                if (!ignoreUpdate) {
                    to[attributeName] = from[attributeName];
                }
                if (from[attributeName]) {
                    if (!ignoreUpdate) {
                        to.setAttribute(attributeName, from[attributeName]);
                    }
                } else {
                    if (!ignoreAttribute(attributeName, to, 'remove', ctx)) {
                        to.removeAttribute(attributeName);
                    }
                }
            }
        }

        /**
         * NB: many bothans died to bring us information:
         *
         *  https://github.com/patrick-steele-idem/morphdom/blob/master/src/specialElHandlers.js
         *  https://github.com/choojs/nanomorph/blob/master/lib/morph.jsL113
         *
         * @param from {Element} the element to sync the input value from
         * @param to {Element} the element to sync the input value to
         * @param ctx the merge context
         */
        function syncInputValue(from, to, ctx) {
            if (from instanceof HTMLInputElement &&
                to instanceof HTMLInputElement &&
                from.type !== 'file') {

                let fromValue = from.value;
                let toValue = to.value;

                // sync boolean attributes
                syncBooleanAttribute(from, to, 'checked', ctx);
                syncBooleanAttribute(from, to, 'disabled', ctx);

                if (!from.hasAttribute('value')) {
                    if (!ignoreAttribute('value', to, 'remove', ctx)) {
                        to.value = '';
                        to.removeAttribute('value');
                    }
                } else if (fromValue !== toValue) {
                    if (!ignoreAttribute('value', to, 'update', ctx)) {
                        to.setAttribute('value', fromValue);
                        to.value = fromValue;
                    }
                }
            } else if (from instanceof HTMLOptionElement) {
                syncBooleanAttribute(from, to, 'selected', ctx);
            } else if (from instanceof HTMLTextAreaElement && to instanceof HTMLTextAreaElement) {
                let fromValue = from.value;
                let toValue = to.value;
                if (ignoreAttribute('value', to, 'update', ctx)) {
                    return;
                }
                if (fromValue !== toValue) {
                    to.value = fromValue;
                }
                if (to.firstChild && to.firstChild.nodeValue !== fromValue) {
                    to.firstChild.nodeValue = fromValue;
                }
            }
        }

        //=============================================================================
        // the HEAD tag can be handled specially, either w/ a 'merge' or 'append' style
        //=============================================================================
        function handleHeadElement(newHeadTag, currentHead, ctx) {

            let added = [];
            let removed = [];
            let preserved = [];
            let nodesToAppend = [];

            let headMergeStyle = ctx.head.style;

            // put all new head elements into a Map, by their outerHTML
            let srcToNewHeadNodes = new Map();
            for (const newHeadChild of newHeadTag.children) {
                srcToNewHeadNodes.set(newHeadChild.outerHTML, newHeadChild);
            }

            // for each elt in the current head
            for (const currentHeadElt of currentHead.children) {

                // If the current head element is in the map
                let inNewContent = srcToNewHeadNodes.has(currentHeadElt.outerHTML);
                let isReAppended = ctx.head.shouldReAppend(currentHeadElt);
                let isPreserved = ctx.head.shouldPreserve(currentHeadElt);
                if (inNewContent || isPreserved) {
                    if (isReAppended) {
                        // remove the current version and let the new version replace it and re-execute
                        removed.push(currentHeadElt);
                    } else {
                        // this element already exists and should not be re-appended, so remove it from
                        // the new content map, preserving it in the DOM
                        srcToNewHeadNodes.delete(currentHeadElt.outerHTML);
                        preserved.push(currentHeadElt);
                    }
                } else {
                    if (headMergeStyle === "append") {
                        // we are appending and this existing element is not new content
                        // so if and only if it is marked for re-append do we do anything
                        if (isReAppended) {
                            removed.push(currentHeadElt);
                            nodesToAppend.push(currentHeadElt);
                        }
                    } else {
                        // if this is a merge, we remove this content since it is not in the new head
                        if (ctx.head.shouldRemove(currentHeadElt) !== false) {
                            removed.push(currentHeadElt);
                        }
                    }
                }
            }

            // Push the remaining new head elements in the Map into the
            // nodes to append to the head tag
            nodesToAppend.push(...srcToNewHeadNodes.values());

            let promises = [];
            for (const newNode of nodesToAppend) {
                let newElt = document.createRange().createContextualFragment(newNode.outerHTML).firstChild;
                if (ctx.callbacks.beforeNodeAdded(newElt) !== false) {
                    if (newElt.href || newElt.src) {
                        let resolve = null;
                        let promise = new Promise(function (_resolve) {
                            resolve = _resolve;
                        });
                        newElt.addEventListener('load', function () {
                            resolve();
                        });
                        promises.push(promise);
                    }
                    currentHead.appendChild(newElt);
                    ctx.callbacks.afterNodeAdded(newElt);
                    added.push(newElt);
                }
            }

            // remove all removed elements, after we have appended the new elements to avoid
            // additional network requests for things like style sheets
            for (const removedElement of removed) {
                if (ctx.callbacks.beforeNodeRemoved(removedElement) !== false) {
                    currentHead.removeChild(removedElement);
                    ctx.callbacks.afterNodeRemoved(removedElement);
                }
            }

            ctx.head.afterHeadMorphed(currentHead, {added: added, kept: preserved, removed: removed});
            return promises;
        }

        function noOp() {
        }

        /*
          Deep merges the config object and the Idiomoroph.defaults object to
          produce a final configuration object
         */
        function mergeDefaults(config) {
            let finalConfig = {};
            // copy top level stuff into final config
            Object.assign(finalConfig, defaults);
            Object.assign(finalConfig, config);

            // copy callbacks into final config (do this to deep merge the callbacks)
            finalConfig.callbacks = {};
            Object.assign(finalConfig.callbacks, defaults.callbacks);
            Object.assign(finalConfig.callbacks, config.callbacks);

            // copy head config into final config  (do this to deep merge the head)
            finalConfig.head = {};
            Object.assign(finalConfig.head, defaults.head);
            Object.assign(finalConfig.head, config.head);
            return finalConfig;
        }

        function createMorphContext(oldNode, newContent, config) {
            config = mergeDefaults(config);
            return {
                target: oldNode,
                newContent: newContent,
                config: config,
                morphStyle: config.morphStyle,
                ignoreActive: config.ignoreActive,
                ignoreActiveValue: config.ignoreActiveValue,
                idMap: createIdMap(oldNode, newContent),
                deadIds: new Set(),
                callbacks: config.callbacks,
                head: config.head
            }
        }

        function isIdSetMatch(node1, node2, ctx) {
            if (node1 == null || node2 == null) {
                return false;
            }
            if (node1.nodeType === node2.nodeType && node1.tagName === node2.tagName) {
                if (node1.id !== "" && node1.id === node2.id) {
                    return true;
                } else {
                    return getIdIntersectionCount(ctx, node1, node2) > 0;
                }
            }
            return false;
        }

        function isSoftMatch(node1, node2) {
            if (node1 == null || node2 == null) {
                return false;
            }
            return node1.nodeType === node2.nodeType && node1.tagName === node2.tagName
        }

        function removeNodesBetween(startInclusive, endExclusive, ctx) {
            while (startInclusive !== endExclusive) {
                let tempNode = startInclusive;
                startInclusive = startInclusive.nextSibling;
                removeNode(tempNode, ctx);
            }
            removeIdsFromConsideration(ctx, endExclusive);
            return endExclusive.nextSibling;
        }

        //=============================================================================
        // Scans forward from the insertionPoint in the old parent looking for a potential id match
        // for the newChild.  We stop if we find a potential id match for the new child OR
        // if the number of potential id matches we are discarding is greater than the
        // potential id matches for the new child
        //=============================================================================
        function findIdSetMatch(newContent, oldParent, newChild, insertionPoint, ctx) {

            // max id matches we are willing to discard in our search
            let newChildPotentialIdCount = getIdIntersectionCount(ctx, newChild, oldParent);

            let potentialMatch = null;

            // only search forward if there is a possibility of an id match
            if (newChildPotentialIdCount > 0) {
                let potentialMatch = insertionPoint;
                // if there is a possibility of an id match, scan forward
                // keep track of the potential id match count we are discarding (the
                // newChildPotentialIdCount must be greater than this to make it likely
                // worth it)
                let otherMatchCount = 0;
                while (potentialMatch != null) {

                    // If we have an id match, return the current potential match
                    if (isIdSetMatch(newChild, potentialMatch, ctx)) {
                        return potentialMatch;
                    }

                    // computer the other potential matches of this new content
                    otherMatchCount += getIdIntersectionCount(ctx, potentialMatch, newContent);
                    if (otherMatchCount > newChildPotentialIdCount) {
                        // if we have more potential id matches in _other_ content, we
                        // do not have a good candidate for an id match, so return null
                        return null;
                    }

                    // advanced to the next old content child
                    potentialMatch = potentialMatch.nextSibling;
                }
            }
            return potentialMatch;
        }

        //=============================================================================
        // Scans forward from the insertionPoint in the old parent looking for a potential soft match
        // for the newChild.  We stop if we find a potential soft match for the new child OR
        // if we find a potential id match in the old parents children OR if we find two
        // potential soft matches for the next two pieces of new content
        //=============================================================================
        function findSoftMatch(newContent, oldParent, newChild, insertionPoint, ctx) {

            let potentialSoftMatch = insertionPoint;
            let nextSibling = newChild.nextSibling;
            let siblingSoftMatchCount = 0;

            while (potentialSoftMatch != null) {

                if (getIdIntersectionCount(ctx, potentialSoftMatch, newContent) > 0) {
                    // the current potential soft match has a potential id set match with the remaining new
                    // content so bail out of looking
                    return null;
                }

                // if we have a soft match with the current node, return it
                if (isSoftMatch(newChild, potentialSoftMatch)) {
                    return potentialSoftMatch;
                }

                if (isSoftMatch(nextSibling, potentialSoftMatch)) {
                    // the next new node has a soft match with this node, so
                    // increment the count of future soft matches
                    siblingSoftMatchCount++;
                    nextSibling = nextSibling.nextSibling;

                    // If there are two future soft matches, bail to allow the siblings to soft match
                    // so that we don't consume future soft matches for the sake of the current node
                    if (siblingSoftMatchCount >= 2) {
                        return null;
                    }
                }

                // advanced to the next old content child
                potentialSoftMatch = potentialSoftMatch.nextSibling;
            }

            return potentialSoftMatch;
        }

        function parseContent(newContent) {
            let parser = new DOMParser();

            // remove svgs to avoid false-positive matches on head, etc.
            let contentWithSvgsRemoved = newContent.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim, '');

            // if the newContent contains a html, head or body tag, we can simply parse it w/o wrapping
            if (contentWithSvgsRemoved.match(/<\/html>/) || contentWithSvgsRemoved.match(/<\/head>/) || contentWithSvgsRemoved.match(/<\/body>/)) {
                let content = parser.parseFromString(newContent, "text/html");
                // if it is a full HTML document, return the document itself as the parent container
                if (contentWithSvgsRemoved.match(/<\/html>/)) {
                    content.generatedByIdiomorph = true;
                    return content;
                } else {
                    // otherwise return the html element as the parent container
                    let htmlElement = content.firstChild;
                    if (htmlElement) {
                        htmlElement.generatedByIdiomorph = true;
                        return htmlElement;
                    } else {
                        return null;
                    }
                }
            } else {
                // if it is partial HTML, wrap it in a template tag to provide a parent element and also to help
                // deal with touchy tags like tr, tbody, etc.
                let responseDoc = parser.parseFromString("<body><template>" + newContent + "</template></body>", "text/html");
                let content = responseDoc.body.querySelector('template').content;
                content.generatedByIdiomorph = true;
                return content
            }
        }

        function normalizeContent(newContent) {
            if (newContent == null) {
                // noinspection UnnecessaryLocalVariableJS
                const dummyParent = document.createElement('div');
                return dummyParent;
            } else if (newContent.generatedByIdiomorph) {
                // the template tag created by idiomorph parsing can serve as a dummy parent
                return newContent;
            } else if (newContent instanceof Node) {
                // a single node is added as a child to a dummy parent
                const dummyParent = document.createElement('div');
                dummyParent.append(newContent);
                return dummyParent;
            } else {
                // all nodes in the array or HTMLElement collection are consolidated under
                // a single dummy parent element
                const dummyParent = document.createElement('div');
                for (const elt of [...newContent]) {
                    dummyParent.append(elt);
                }
                return dummyParent;
            }
        }

        function insertSiblings(previousSibling, morphedNode, nextSibling) {
            let stack = [];
            let added = [];
            while (previousSibling != null) {
                stack.push(previousSibling);
                previousSibling = previousSibling.previousSibling;
            }
            while (stack.length > 0) {
                let node = stack.pop();
                added.push(node); // push added preceding siblings on in order and insert
                morphedNode.parentElement.insertBefore(node, morphedNode);
            }
            added.push(morphedNode);
            while (nextSibling != null) {
                stack.push(nextSibling);
                added.push(nextSibling); // here we are going in order, so push on as we scan, rather than add
                nextSibling = nextSibling.nextSibling;
            }
            while (stack.length > 0) {
                morphedNode.parentElement.insertBefore(stack.pop(), morphedNode.nextSibling);
            }
            return added;
        }

        function findBestNodeMatch(newContent, oldNode, ctx) {
            let currentElement;
            currentElement = newContent.firstChild;
            let bestElement = currentElement;
            let score = 0;
            while (currentElement) {
                let newScore = scoreElement(currentElement, oldNode, ctx);
                if (newScore > score) {
                    bestElement = currentElement;
                    score = newScore;
                }
                currentElement = currentElement.nextSibling;
            }
            return bestElement;
        }

        function scoreElement(node1, node2, ctx) {
            if (isSoftMatch(node1, node2)) {
                return .5 + getIdIntersectionCount(ctx, node1, node2);
            }
            return 0;
        }

        function removeNode(tempNode, ctx) {
            removeIdsFromConsideration(ctx, tempNode);
            if (ctx.callbacks.beforeNodeRemoved(tempNode) === false) return;

            tempNode.remove();
            ctx.callbacks.afterNodeRemoved(tempNode);
        }

        //=============================================================================
        // ID Set Functions
        //=============================================================================

        function isIdInConsideration(ctx, id) {
            return !ctx.deadIds.has(id);
        }

        function idIsWithinNode(ctx, id, targetNode) {
            let idSet = ctx.idMap.get(targetNode) || EMPTY_SET;
            return idSet.has(id);
        }

        function removeIdsFromConsideration(ctx, node) {
            let idSet = ctx.idMap.get(node) || EMPTY_SET;
            for (const id of idSet) {
                ctx.deadIds.add(id);
            }
        }

        function getIdIntersectionCount(ctx, node1, node2) {
            let sourceSet = ctx.idMap.get(node1) || EMPTY_SET;
            let matchCount = 0;
            for (const id of sourceSet) {
                // a potential match is an id in the source and potentialIdsSet, but
                // that has not already been merged into the DOM
                if (isIdInConsideration(ctx, id) && idIsWithinNode(ctx, id, node2)) {
                    ++matchCount;
                }
            }
            return matchCount;
        }

        /**
         * A bottom up algorithm that finds all elements with ids inside of the node
         * argument and populates id sets for those nodes and all their parents, generating
         * a set of ids contained within all nodes for the entire hierarchy in the DOM
         *
         * @param node {Element}
         * @param {Map<Node, Set<String>>} idMap
         */
        function populateIdMapForNode(node, idMap) {
            let nodeParent = node.parentElement;
            // find all elements with an id property
            let idElements = node.querySelectorAll('[id]');
            for (const elt of idElements) {
                let current = elt;
                // walk up the parent hierarchy of that element, adding the id
                // of element to the parent's id set
                while (current !== nodeParent && current != null) {
                    let idSet = idMap.get(current);
                    // if the id set doesn't exist, create it and insert it in the  map
                    if (idSet == null) {
                        idSet = new Set();
                        idMap.set(current, idSet);
                    }
                    idSet.add(elt.id);
                    current = current.parentElement;
                }
            }
        }

        /**
         * This function computes a map of nodes to all ids contained within that node (inclusive of the
         * node).  This map can be used to ask if two nodes have intersecting sets of ids, which allows
         * for a looser definition of "matching" than tradition id matching, and allows child nodes
         * to contribute to a parent nodes matching.
         *
         * @param {Element} oldContent  the old content that will be morphed
         * @param {Element} newContent  the new content to morph to
         * @returns {Map<Node, Set<String>>} a map of nodes to id sets for the
         */
        function createIdMap(oldContent, newContent) {
            let idMap = new Map();
            populateIdMapForNode(oldContent, idMap);
            populateIdMapForNode(newContent, idMap);
            return idMap;
        }

        //=============================================================================
        // This is what ends up becoming the Idiomorph global object
        //=============================================================================
        return {
            morph,
            defaults
        }
    })();

function morphElements(currentElement, newElement, { callbacks, ...options } = {}) {
  Idiomorph.morph(currentElement, newElement, {
    ...options,
    callbacks: new DefaultIdiomorphCallbacks(callbacks)
  });
}

function morphChildren(currentElement, newElement) {
  morphElements(currentElement, newElement.children, {
    morphStyle: "innerHTML"
  });
}

class DefaultIdiomorphCallbacks {
  #beforeNodeMorphed

  constructor({ beforeNodeMorphed } = {}) {
    this.#beforeNodeMorphed = beforeNodeMorphed || (() => true);
  }

  beforeNodeAdded = (node) => {
    return !(node.id && node.hasAttribute("data-turbo-permanent") && document.getElementById(node.id))
  }

  beforeNodeMorphed = (currentElement, newElement) => {
    if (currentElement instanceof Element) {
      if (!currentElement.hasAttribute("data-turbo-permanent") && this.#beforeNodeMorphed(currentElement, newElement)) {
        const event = dispatch("turbo:before-morph-element", {
          cancelable: true,
          target: currentElement,
          detail: { currentElement, newElement }
        });

        return !event.defaultPrevented
      } else {
        return false
      }
    }
  }

  beforeAttributeUpdated = (attributeName, target, mutationType) => {
    const event = dispatch("turbo:before-morph-attribute", {
      cancelable: true,
      target,
      detail: { attributeName, mutationType }
    });

    return !event.defaultPrevented
  }

  beforeNodeRemoved = (node) => {
    return this.beforeNodeMorphed(node)
  }

  afterNodeMorphed = (currentElement, newElement) => {
    if (currentElement instanceof Element) {
      dispatch("turbo:morph-element", {
        target: currentElement,
        detail: { currentElement, newElement }
      });
    }
  }
}

class MorphingFrameRenderer extends FrameRenderer {
  static renderElement(currentElement, newElement) {
    dispatch("turbo:before-frame-morph", {
      target: currentElement,
      detail: { currentElement, newElement }
    });

    morphChildren(currentElement, newElement);
  }
}

class PageRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    if (document.body && newElement instanceof HTMLBodyElement) {
      document.body.replaceWith(newElement);
    } else {
      document.documentElement.appendChild(newElement);
    }
  }

  get shouldRender() {
    return this.newSnapshot.isVisitable && this.trackedElementsAreIdentical
  }

  get reloadReason() {
    if (!this.newSnapshot.isVisitable) {
      return {
        reason: "turbo_visit_control_is_reload"
      }
    }

    if (!this.trackedElementsAreIdentical) {
      return {
        reason: "tracked_element_mismatch"
      }
    }
  }

  async prepareToRender() {
    this.#setLanguage();
    await this.mergeHead();
  }

  async render() {
    if (this.willRender) {
      await this.replaceBody();
    }
  }

  finishRendering() {
    super.finishRendering();
    if (!this.isPreview) {
      this.focusFirstAutofocusableElement();
    }
  }

  get currentHeadSnapshot() {
    return this.currentSnapshot.headSnapshot
  }

  get newHeadSnapshot() {
    return this.newSnapshot.headSnapshot
  }

  get newElement() {
    return this.newSnapshot.element
  }

  #setLanguage() {
    const { documentElement } = this.currentSnapshot;
    const { lang } = this.newSnapshot;

    if (lang) {
      documentElement.setAttribute("lang", lang);
    } else {
      documentElement.removeAttribute("lang");
    }
  }

  async mergeHead() {
    const mergedHeadElements = this.mergeProvisionalElements();
    const newStylesheetElements = this.copyNewHeadStylesheetElements();
    this.copyNewHeadScriptElements();

    await mergedHeadElements;
    await newStylesheetElements;

    if (this.willRender) {
      this.removeUnusedDynamicStylesheetElements();
    }
  }

  async replaceBody() {
    await this.preservingPermanentElements(async () => {
      this.activateNewBody();
      await this.assignNewBody();
    });
  }

  get trackedElementsAreIdentical() {
    return this.currentHeadSnapshot.trackedElementSignature == this.newHeadSnapshot.trackedElementSignature
  }

  async copyNewHeadStylesheetElements() {
    const loadingElements = [];

    for (const element of this.newHeadStylesheetElements) {
      loadingElements.push(waitForLoad(element));

      document.head.appendChild(element);
    }

    await Promise.all(loadingElements);
  }

  copyNewHeadScriptElements() {
    for (const element of this.newHeadScriptElements) {
      document.head.appendChild(activateScriptElement(element));
    }
  }

  removeUnusedDynamicStylesheetElements() {
    for (const element of this.unusedDynamicStylesheetElements) {
      document.head.removeChild(element);
    }
  }

  async mergeProvisionalElements() {
    const newHeadElements = [...this.newHeadProvisionalElements];

    for (const element of this.currentHeadProvisionalElements) {
      if (!this.isCurrentElementInElementList(element, newHeadElements)) {
        document.head.removeChild(element);
      }
    }

    for (const element of newHeadElements) {
      document.head.appendChild(element);
    }
  }

  isCurrentElementInElementList(element, elementList) {
    for (const [index, newElement] of elementList.entries()) {
      // if title element...
      if (element.tagName == "TITLE") {
        if (newElement.tagName != "TITLE") {
          continue
        }
        if (element.innerHTML == newElement.innerHTML) {
          elementList.splice(index, 1);
          return true
        }
      }

      // if any other element...
      if (newElement.isEqualNode(element)) {
        elementList.splice(index, 1);
        return true
      }
    }

    return false
  }

  removeCurrentHeadProvisionalElements() {
    for (const element of this.currentHeadProvisionalElements) {
      document.head.removeChild(element);
    }
  }

  copyNewHeadProvisionalElements() {
    for (const element of this.newHeadProvisionalElements) {
      document.head.appendChild(element);
    }
  }

  activateNewBody() {
    document.adoptNode(this.newElement);
    this.activateNewBodyScriptElements();
  }

  activateNewBodyScriptElements() {
    for (const inertScriptElement of this.newBodyScriptElements) {
      const activatedScriptElement = activateScriptElement(inertScriptElement);
      inertScriptElement.replaceWith(activatedScriptElement);
    }
  }

  async assignNewBody() {
    await this.renderElement(this.currentElement, this.newElement);
  }

  get unusedDynamicStylesheetElements() {
    return this.oldHeadStylesheetElements.filter((element) => {
      return element.getAttribute("data-turbo-track") === "dynamic"
    })
  }

  get oldHeadStylesheetElements() {
    return this.currentHeadSnapshot.getStylesheetElementsNotInSnapshot(this.newHeadSnapshot)
  }

  get newHeadStylesheetElements() {
    return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)
  }

  get newHeadScriptElements() {
    return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)
  }

  get currentHeadProvisionalElements() {
    return this.currentHeadSnapshot.provisionalElements
  }

  get newHeadProvisionalElements() {
    return this.newHeadSnapshot.provisionalElements
  }

  get newBodyScriptElements() {
    return this.newElement.querySelectorAll("script")
  }
}

class MorphingPageRenderer extends PageRenderer {
  static renderElement(currentElement, newElement) {
    morphElements(currentElement, newElement, {
      callbacks: {
        beforeNodeMorphed: element => !canRefreshFrame(element)
      }
    });

    for (const frame of currentElement.querySelectorAll("turbo-frame")) {
      if (canRefreshFrame(frame)) refreshFrame(frame);
    }

    dispatch("turbo:morph", { detail: { currentElement, newElement } });
  }

  async preservingPermanentElements(callback) {
    return await callback()
  }

  get renderMethod() {
    return "morph"
  }

  get shouldAutofocus() {
    return false
  }
}

function canRefreshFrame(frame) {
  return frame instanceof FrameElement &&
    frame.src &&
    frame.refresh === "morph" &&
    !frame.closest("[data-turbo-permanent]")
}

function refreshFrame(frame) {
  frame.addEventListener("turbo:before-frame-render", ({ detail }) => {
    detail.render = MorphingFrameRenderer.renderElement;
  }, { once: true });

  frame.reload();
}

class SnapshotCache {
  keys = []
  snapshots = {}

  constructor(size) {
    this.size = size;
  }

  has(location) {
    return toCacheKey(location) in this.snapshots
  }

  get(location) {
    if (this.has(location)) {
      const snapshot = this.read(location);
      this.touch(location);
      return snapshot
    }
  }

  put(location, snapshot) {
    this.write(location, snapshot);
    this.touch(location);
    return snapshot
  }

  clear() {
    this.snapshots = {};
  }

  // Private

  read(location) {
    return this.snapshots[toCacheKey(location)]
  }

  write(location, snapshot) {
    this.snapshots[toCacheKey(location)] = snapshot;
  }

  touch(location) {
    const key = toCacheKey(location);
    const index = this.keys.indexOf(key);
    if (index > -1) this.keys.splice(index, 1);
    this.keys.unshift(key);
    this.trim();
  }

  trim() {
    for (const key of this.keys.splice(this.size)) {
      delete this.snapshots[key];
    }
  }
}

class PageView extends View {
  snapshotCache = new SnapshotCache(10)
  lastRenderedLocation = new URL(location.href)
  forceReloaded = false

  shouldTransitionTo(newSnapshot) {
    return this.snapshot.prefersViewTransitions && newSnapshot.prefersViewTransitions
  }

  renderPage(snapshot, isPreview = false, willRender = true, visit) {
    const shouldMorphPage = this.isPageRefresh(visit) && this.snapshot.shouldMorphPage;
    const rendererClass = shouldMorphPage ? MorphingPageRenderer : PageRenderer;

    const renderer = new rendererClass(this.snapshot, snapshot, rendererClass.renderElement, isPreview, willRender);

    if (!renderer.shouldRender) {
      this.forceReloaded = true;
    } else {
      visit?.changeHistory();
    }

    return this.render(renderer)
  }

  renderError(snapshot, visit) {
    visit?.changeHistory();
    const renderer = new ErrorRenderer(this.snapshot, snapshot, ErrorRenderer.renderElement, false);
    return this.render(renderer)
  }

  clearSnapshotCache() {
    this.snapshotCache.clear();
  }

  async cacheSnapshot(snapshot = this.snapshot) {
    if (snapshot.isCacheable) {
      this.delegate.viewWillCacheSnapshot();
      const { lastRenderedLocation: location } = this;
      await nextEventLoopTick();
      const cachedSnapshot = snapshot.clone();
      this.snapshotCache.put(location, cachedSnapshot);
      return cachedSnapshot
    }
  }

  getCachedSnapshotForLocation(location) {
    return this.snapshotCache.get(location)
  }

  isPageRefresh(visit) {
    return !visit || (this.lastRenderedLocation.pathname === visit.location.pathname && visit.action === "replace")
  }

  shouldPreserveScrollPosition(visit) {
    return this.isPageRefresh(visit) && this.snapshot.shouldPreserveScrollPosition
  }

  get snapshot() {
    return PageSnapshot.fromElement(this.element)
  }
}

class Preloader {
  selector = "a[data-turbo-preload]"

  constructor(delegate, snapshotCache) {
    this.delegate = delegate;
    this.snapshotCache = snapshotCache;
  }

  start() {
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", this.#preloadAll);
    } else {
      this.preloadOnLoadLinksForView(document.body);
    }
  }

  stop() {
    document.removeEventListener("DOMContentLoaded", this.#preloadAll);
  }

  preloadOnLoadLinksForView(element) {
    for (const link of element.querySelectorAll(this.selector)) {
      if (this.delegate.shouldPreloadLink(link)) {
        this.preloadURL(link);
      }
    }
  }

  async preloadURL(link) {
    const location = new URL(link.href);

    if (this.snapshotCache.has(location)) {
      return
    }

    const fetchRequest = new FetchRequest(this, FetchMethod.get, location, new URLSearchParams(), link);
    await fetchRequest.perform();
  }

  // Fetch request delegate

  prepareRequest(fetchRequest) {
    fetchRequest.headers["X-Sec-Purpose"] = "prefetch";
  }

  async requestSucceededWithResponse(fetchRequest, fetchResponse) {
    try {
      const responseHTML = await fetchResponse.responseHTML;
      const snapshot = PageSnapshot.fromHTMLString(responseHTML);

      this.snapshotCache.put(fetchRequest.url, snapshot);
    } catch (_) {
      // If we cannot preload that is ok!
    }
  }

  requestStarted(fetchRequest) {}

  requestErrored(fetchRequest) {}

  requestFinished(fetchRequest) {}

  requestPreventedHandlingResponse(fetchRequest, fetchResponse) {}

  requestFailedWithResponse(fetchRequest, fetchResponse) {}

  #preloadAll = () => {
    this.preloadOnLoadLinksForView(document.body);
  }
}

class Cache {
  constructor(session) {
    this.session = session;
  }

  clear() {
    this.session.clearCache();
  }

  resetCacheControl() {
    this.#setCacheControl("");
  }

  exemptPageFromCache() {
    this.#setCacheControl("no-cache");
  }

  exemptPageFromPreview() {
    this.#setCacheControl("no-preview");
  }

  #setCacheControl(value) {
    setMetaContent("turbo-cache-control", value);
  }
}

class Session {
  navigator = new Navigator(this)
  history = new History(this)
  view = new PageView(this, document.documentElement)
  adapter = new BrowserAdapter(this)

  pageObserver = new PageObserver(this)
  cacheObserver = new CacheObserver()
  linkPrefetchObserver = new LinkPrefetchObserver(this, document)
  linkClickObserver = new LinkClickObserver(this, window)
  formSubmitObserver = new FormSubmitObserver(this, document)
  scrollObserver = new ScrollObserver(this)
  streamObserver = new StreamObserver(this)
  formLinkClickObserver = new FormLinkClickObserver(this, document.documentElement)
  frameRedirector = new FrameRedirector(this, document.documentElement)
  streamMessageRenderer = new StreamMessageRenderer()
  cache = new Cache(this)

  drive = true
  enabled = true
  progressBarDelay = 500
  started = false
  formMode = "on"
  #pageRefreshDebouncePeriod = 150

  constructor(recentRequests) {
    this.recentRequests = recentRequests;
    this.preloader = new Preloader(this, this.view.snapshotCache);
    this.debouncedRefresh = this.refresh;
    this.pageRefreshDebouncePeriod = this.pageRefreshDebouncePeriod;
  }

  start() {
    if (!this.started) {
      this.pageObserver.start();
      this.cacheObserver.start();
      this.linkPrefetchObserver.start();
      this.formLinkClickObserver.start();
      this.linkClickObserver.start();
      this.formSubmitObserver.start();
      this.scrollObserver.start();
      this.streamObserver.start();
      this.frameRedirector.start();
      this.history.start();
      this.preloader.start();
      this.started = true;
      this.enabled = true;
    }
  }

  disable() {
    this.enabled = false;
  }

  stop() {
    if (this.started) {
      this.pageObserver.stop();
      this.cacheObserver.stop();
      this.linkPrefetchObserver.stop();
      this.formLinkClickObserver.stop();
      this.linkClickObserver.stop();
      this.formSubmitObserver.stop();
      this.scrollObserver.stop();
      this.streamObserver.stop();
      this.frameRedirector.stop();
      this.history.stop();
      this.preloader.stop();
      this.started = false;
    }
  }

  registerAdapter(adapter) {
    this.adapter = adapter;
  }

  visit(location, options = {}) {
    const frameElement = options.frame ? document.getElementById(options.frame) : null;

    if (frameElement instanceof FrameElement) {
      const action = options.action || getVisitAction(frameElement);

      frameElement.delegate.proposeVisitIfNavigatedWithAction(frameElement, action);
      frameElement.src = location.toString();
    } else {
      this.navigator.proposeVisit(expandURL(location), options);
    }
  }

  refresh(url, requestId) {
    const isRecentRequest = requestId && this.recentRequests.has(requestId);
    if (!isRecentRequest && !this.navigator.currentVisit) {
      this.visit(url, { action: "replace", shouldCacheSnapshot: false });
    }
  }

  connectStreamSource(source) {
    this.streamObserver.connectStreamSource(source);
  }

  disconnectStreamSource(source) {
    this.streamObserver.disconnectStreamSource(source);
  }

  renderStreamMessage(message) {
    this.streamMessageRenderer.render(StreamMessage.wrap(message));
  }

  clearCache() {
    this.view.clearSnapshotCache();
  }

  setProgressBarDelay(delay) {
    this.progressBarDelay = delay;
  }

  setFormMode(mode) {
    this.formMode = mode;
  }

  get location() {
    return this.history.location
  }

  get restorationIdentifier() {
    return this.history.restorationIdentifier
  }

  get pageRefreshDebouncePeriod() {
    return this.#pageRefreshDebouncePeriod
  }

  set pageRefreshDebouncePeriod(value) {
    this.refresh = debounce(this.debouncedRefresh.bind(this), value);
    this.#pageRefreshDebouncePeriod = value;
  }

  // Preloader delegate

  shouldPreloadLink(element) {
    const isUnsafe = element.hasAttribute("data-turbo-method");
    const isStream = element.hasAttribute("data-turbo-stream");
    const frameTarget = element.getAttribute("data-turbo-frame");
    const frame = frameTarget == "_top" ?
      null :
      document.getElementById(frameTarget) || findClosestRecursively(element, "turbo-frame:not([disabled])");

    if (isUnsafe || isStream || frame instanceof FrameElement) {
      return false
    } else {
      const location = new URL(element.href);

      return this.elementIsNavigatable(element) && locationIsVisitable(location, this.snapshot.rootLocation)
    }
  }

  // History delegate

  historyPoppedToLocationWithRestorationIdentifierAndDirection(location, restorationIdentifier, direction) {
    if (this.enabled) {
      this.navigator.startVisit(location, restorationIdentifier, {
        action: "restore",
        historyChanged: true,
        direction
      });
    } else {
      this.adapter.pageInvalidated({
        reason: "turbo_disabled"
      });
    }
  }

  // Scroll observer delegate

  scrollPositionChanged(position) {
    this.history.updateRestorationData({ scrollPosition: position });
  }

  // Form click observer delegate

  willSubmitFormLinkToLocation(link, location) {
    return this.elementIsNavigatable(link) && locationIsVisitable(location, this.snapshot.rootLocation)
  }

  submittedFormLinkToLocation() {}

  // Link hover observer delegate

  canPrefetchRequestToLocation(link, location) {
    return (
      this.elementIsNavigatable(link) &&
        locationIsVisitable(location, this.snapshot.rootLocation)
    )
  }

  // Link click observer delegate

  willFollowLinkToLocation(link, location, event) {
    return (
      this.elementIsNavigatable(link) &&
      locationIsVisitable(location, this.snapshot.rootLocation) &&
      this.applicationAllowsFollowingLinkToLocation(link, location, event)
    )
  }

  followedLinkToLocation(link, location) {
    const action = this.getActionForLink(link);
    const acceptsStreamResponse = link.hasAttribute("data-turbo-stream");

    this.visit(location.href, { action, acceptsStreamResponse });
  }

  // Navigator delegate

  allowsVisitingLocationWithAction(location, action) {
    return this.locationWithActionIsSamePage(location, action) || this.applicationAllowsVisitingLocation(location)
  }

  visitProposedToLocation(location, options) {
    extendURLWithDeprecatedProperties(location);
    this.adapter.visitProposedToLocation(location, options);
  }

  // Visit delegate

  visitStarted(visit) {
    if (!visit.acceptsStreamResponse) {
      markAsBusy(document.documentElement);
      this.view.markVisitDirection(visit.direction);
    }
    extendURLWithDeprecatedProperties(visit.location);
    if (!visit.silent) {
      this.notifyApplicationAfterVisitingLocation(visit.location, visit.action);
    }
  }

  visitCompleted(visit) {
    this.view.unmarkVisitDirection();
    clearBusyState(document.documentElement);
    this.notifyApplicationAfterPageLoad(visit.getTimingMetrics());
  }

  locationWithActionIsSamePage(location, action) {
    return this.navigator.locationWithActionIsSamePage(location, action)
  }

  visitScrolledToSamePageLocation(oldURL, newURL) {
    this.notifyApplicationAfterVisitingSamePageLocation(oldURL, newURL);
  }

  // Form submit observer delegate

  willSubmitForm(form, submitter) {
    const action = getAction$1(form, submitter);

    return (
      this.submissionIsNavigatable(form, submitter) &&
      locationIsVisitable(expandURL(action), this.snapshot.rootLocation)
    )
  }

  formSubmitted(form, submitter) {
    this.navigator.submitForm(form, submitter);
  }

  // Page observer delegate

  pageBecameInteractive() {
    this.view.lastRenderedLocation = this.location;
    this.notifyApplicationAfterPageLoad();
  }

  pageLoaded() {
    this.history.assumeControlOfScrollRestoration();
  }

  pageWillUnload() {
    this.history.relinquishControlOfScrollRestoration();
  }

  // Stream observer delegate

  receivedMessageFromStream(message) {
    this.renderStreamMessage(message);
  }

  // Page view delegate

  viewWillCacheSnapshot() {
    if (!this.navigator.currentVisit?.silent) {
      this.notifyApplicationBeforeCachingSnapshot();
    }
  }

  allowsImmediateRender({ element }, options) {
    const event = this.notifyApplicationBeforeRender(element, options);
    const {
      defaultPrevented,
      detail: { render }
    } = event;

    if (this.view.renderer && render) {
      this.view.renderer.renderElement = render;
    }

    return !defaultPrevented
  }

  viewRenderedSnapshot(_snapshot, _isPreview, renderMethod) {
    this.view.lastRenderedLocation = this.history.location;
    this.notifyApplicationAfterRender(renderMethod);
  }

  preloadOnLoadLinksForView(element) {
    this.preloader.preloadOnLoadLinksForView(element);
  }

  viewInvalidated(reason) {
    this.adapter.pageInvalidated(reason);
  }

  // Frame element

  frameLoaded(frame) {
    this.notifyApplicationAfterFrameLoad(frame);
  }

  frameRendered(fetchResponse, frame) {
    this.notifyApplicationAfterFrameRender(fetchResponse, frame);
  }

  // Application events

  applicationAllowsFollowingLinkToLocation(link, location, ev) {
    const event = this.notifyApplicationAfterClickingLinkToLocation(link, location, ev);
    return !event.defaultPrevented
  }

  applicationAllowsVisitingLocation(location) {
    const event = this.notifyApplicationBeforeVisitingLocation(location);
    return !event.defaultPrevented
  }

  notifyApplicationAfterClickingLinkToLocation(link, location, event) {
    return dispatch("turbo:click", {
      target: link,
      detail: { url: location.href, originalEvent: event },
      cancelable: true
    })
  }

  notifyApplicationBeforeVisitingLocation(location) {
    return dispatch("turbo:before-visit", {
      detail: { url: location.href },
      cancelable: true
    })
  }

  notifyApplicationAfterVisitingLocation(location, action) {
    return dispatch("turbo:visit", { detail: { url: location.href, action } })
  }

  notifyApplicationBeforeCachingSnapshot() {
    return dispatch("turbo:before-cache")
  }

  notifyApplicationBeforeRender(newBody, options) {
    return dispatch("turbo:before-render", {
      detail: { newBody, ...options },
      cancelable: true
    })
  }

  notifyApplicationAfterRender(renderMethod) {
    return dispatch("turbo:render", { detail: { renderMethod } })
  }

  notifyApplicationAfterPageLoad(timing = {}) {
    return dispatch("turbo:load", {
      detail: { url: this.location.href, timing }
    })
  }

  notifyApplicationAfterVisitingSamePageLocation(oldURL, newURL) {
    dispatchEvent(
      new HashChangeEvent("hashchange", {
        oldURL: oldURL.toString(),
        newURL: newURL.toString()
      })
    );
  }

  notifyApplicationAfterFrameLoad(frame) {
    return dispatch("turbo:frame-load", { target: frame })
  }

  notifyApplicationAfterFrameRender(fetchResponse, frame) {
    return dispatch("turbo:frame-render", {
      detail: { fetchResponse },
      target: frame,
      cancelable: true
    })
  }

  // Helpers

  submissionIsNavigatable(form, submitter) {
    if (this.formMode == "off") {
      return false
    } else {
      const submitterIsNavigatable = submitter ? this.elementIsNavigatable(submitter) : true;

      if (this.formMode == "optin") {
        return submitterIsNavigatable && form.closest('[data-turbo="true"]') != null
      } else {
        return submitterIsNavigatable && this.elementIsNavigatable(form)
      }
    }
  }

  elementIsNavigatable(element) {
    const container = findClosestRecursively(element, "[data-turbo]");
    const withinFrame = findClosestRecursively(element, "turbo-frame");

    // Check if Drive is enabled on the session or we're within a Frame.
    if (this.drive || withinFrame) {
      // Element is navigatable by default, unless `data-turbo="false"`.
      if (container) {
        return container.getAttribute("data-turbo") != "false"
      } else {
        return true
      }
    } else {
      // Element isn't navigatable by default, unless `data-turbo="true"`.
      if (container) {
        return container.getAttribute("data-turbo") == "true"
      } else {
        return false
      }
    }
  }

  // Private

  getActionForLink(link) {
    return getVisitAction(link) || "advance"
  }

  get snapshot() {
    return this.view.snapshot
  }
}

// Older versions of the Turbo Native adapters referenced the
// `Location#absoluteURL` property in their implementations of
// the `Adapter#visitProposedToLocation()` and `#visitStarted()`
// methods. The Location class has since been removed in favor
// of the DOM URL API, and accordingly all Adapter methods now
// receive URL objects.
//
// We alias #absoluteURL to #toString() here to avoid crashing
// older adapters which do not expect URL objects. We should
// consider removing this support at some point in the future.

function extendURLWithDeprecatedProperties(url) {
  Object.defineProperties(url, deprecatedLocationPropertyDescriptors);
}

const deprecatedLocationPropertyDescriptors = {
  absoluteURL: {
    get() {
      return this.toString()
    }
  }
};

const session = new Session(recentRequests);
const { cache, navigator: navigator$1 } = session;

/**
 * Starts the main session.
 * This initialises any necessary observers such as those to monitor
 * link interactions.
 */
function start() {
  session.start();
}

/**
 * Registers an adapter for the main session.
 *
 * @param adapter Adapter to register
 */
function registerAdapter(adapter) {
  session.registerAdapter(adapter);
}

/**
 * Performs an application visit to the given location.
 *
 * @param location Location to visit (a URL or path)
 * @param options Options to apply
 * @param options.action Type of history navigation to apply ("restore",
 * "replace" or "advance")
 * @param options.historyChanged Specifies whether the browser history has
 * already been changed for this visit or not
 * @param options.referrer Specifies the referrer of this visit such that
 * navigations to the same page will not result in a new history entry.
 * @param options.snapshotHTML Cached snapshot to render
 * @param options.response Response of the specified location
 */
function visit(location, options) {
  session.visit(location, options);
}

/**
 * Connects a stream source to the main session.
 *
 * @param source Stream source to connect
 */
function connectStreamSource(source) {
  session.connectStreamSource(source);
}

/**
 * Disconnects a stream source from the main session.
 *
 * @param source Stream source to disconnect
 */
function disconnectStreamSource(source) {
  session.disconnectStreamSource(source);
}

/**
 * Renders a stream message to the main session by appending it to the
 * current document.
 *
 * @param message Message to render
 */
function renderStreamMessage(message) {
  session.renderStreamMessage(message);
}

/**
 * Removes all entries from the Turbo Drive page cache.
 * Call this when state has changed on the server that may affect cached pages.
 *
 * @deprecated since version 7.2.0 in favor of `Turbo.cache.clear()`
 */
function clearCache() {
  console.warn(
    "Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  session.clearCache();
}

/**
 * Sets the delay after which the progress bar will appear during navigation.
 *
 * The progress bar appears after 500ms by default.
 *
 * Note that this method has no effect when used with the iOS or Android
 * adapters.
 *
 * @param delay Time to delay in milliseconds
 */
function setProgressBarDelay(delay) {
  session.setProgressBarDelay(delay);
}

function setConfirmMethod(confirmMethod) {
  FormSubmission.confirmMethod = confirmMethod;
}

function setFormMode(mode) {
  session.setFormMode(mode);
}

var Turbo = /*#__PURE__*/Object.freeze({
  __proto__: null,
  navigator: navigator$1,
  session: session,
  cache: cache,
  PageRenderer: PageRenderer,
  PageSnapshot: PageSnapshot,
  FrameRenderer: FrameRenderer,
  fetch: fetchWithTurboHeaders,
  start: start,
  registerAdapter: registerAdapter,
  visit: visit,
  connectStreamSource: connectStreamSource,
  disconnectStreamSource: disconnectStreamSource,
  renderStreamMessage: renderStreamMessage,
  clearCache: clearCache,
  setProgressBarDelay: setProgressBarDelay,
  setConfirmMethod: setConfirmMethod,
  setFormMode: setFormMode
});

class TurboFrameMissingError extends Error {}

class FrameController {
  fetchResponseLoaded = (_fetchResponse) => Promise.resolve()
  #currentFetchRequest = null
  #resolveVisitPromise = () => {}
  #connected = false
  #hasBeenLoaded = false
  #ignoredAttributes = new Set()
  action = null

  constructor(element) {
    this.element = element;
    this.view = new FrameView(this, this.element);
    this.appearanceObserver = new AppearanceObserver(this, this.element);
    this.formLinkClickObserver = new FormLinkClickObserver(this, this.element);
    this.linkInterceptor = new LinkInterceptor(this, this.element);
    this.restorationIdentifier = uuid();
    this.formSubmitObserver = new FormSubmitObserver(this, this.element);
  }

  // Frame delegate

  connect() {
    if (!this.#connected) {
      this.#connected = true;
      if (this.loadingStyle == FrameLoadingStyle.lazy) {
        this.appearanceObserver.start();
      } else {
        this.#loadSourceURL();
      }
      this.formLinkClickObserver.start();
      this.linkInterceptor.start();
      this.formSubmitObserver.start();
    }
  }

  disconnect() {
    if (this.#connected) {
      this.#connected = false;
      this.appearanceObserver.stop();
      this.formLinkClickObserver.stop();
      this.linkInterceptor.stop();
      this.formSubmitObserver.stop();
    }
  }

  disabledChanged() {
    if (this.loadingStyle == FrameLoadingStyle.eager) {
      this.#loadSourceURL();
    }
  }

  sourceURLChanged() {
    if (this.#isIgnoringChangesTo("src")) return

    if (this.element.isConnected) {
      this.complete = false;
    }

    if (this.loadingStyle == FrameLoadingStyle.eager || this.#hasBeenLoaded) {
      this.#loadSourceURL();
    }
  }

  sourceURLReloaded() {
    const { src } = this.element;
    this.element.removeAttribute("complete");
    this.element.src = null;
    this.element.src = src;
    return this.element.loaded
  }

  loadingStyleChanged() {
    if (this.loadingStyle == FrameLoadingStyle.lazy) {
      this.appearanceObserver.start();
    } else {
      this.appearanceObserver.stop();
      this.#loadSourceURL();
    }
  }

  async #loadSourceURL() {
    if (this.enabled && this.isActive && !this.complete && this.sourceURL) {
      this.element.loaded = this.#visit(expandURL(this.sourceURL));
      this.appearanceObserver.stop();
      await this.element.loaded;
      this.#hasBeenLoaded = true;
    }
  }

  async loadResponse(fetchResponse) {
    if (fetchResponse.redirected || (fetchResponse.succeeded && fetchResponse.isHTML)) {
      this.sourceURL = fetchResponse.response.url;
    }

    try {
      const html = await fetchResponse.responseHTML;
      if (html) {
        const document = parseHTMLDocument(html);
        const pageSnapshot = PageSnapshot.fromDocument(document);

        if (pageSnapshot.isVisitable) {
          await this.#loadFrameResponse(fetchResponse, document);
        } else {
          await this.#handleUnvisitableFrameResponse(fetchResponse);
        }
      }
    } finally {
      this.fetchResponseLoaded = () => Promise.resolve();
    }
  }

  // Appearance observer delegate

  elementAppearedInViewport(element) {
    this.proposeVisitIfNavigatedWithAction(element, getVisitAction(element));
    this.#loadSourceURL();
  }

  // Form link click observer delegate

  willSubmitFormLinkToLocation(link) {
    return this.#shouldInterceptNavigation(link)
  }

  submittedFormLinkToLocation(link, _location, form) {
    const frame = this.#findFrameElement(link);
    if (frame) form.setAttribute("data-turbo-frame", frame.id);
  }

  // Link interceptor delegate

  shouldInterceptLinkClick(element, _location, _event) {
    return this.#shouldInterceptNavigation(element)
  }

  linkClickIntercepted(element, location) {
    this.#navigateFrame(element, location);
  }

  // Form submit observer delegate

  willSubmitForm(element, submitter) {
    return element.closest("turbo-frame") == this.element && this.#shouldInterceptNavigation(element, submitter)
  }

  formSubmitted(element, submitter) {
    if (this.formSubmission) {
      this.formSubmission.stop();
    }

    this.formSubmission = new FormSubmission(this, element, submitter);
    const { fetchRequest } = this.formSubmission;
    this.prepareRequest(fetchRequest);
    this.formSubmission.start();
  }

  // Fetch request delegate

  prepareRequest(request) {
    request.headers["Turbo-Frame"] = this.id;

    if (this.currentNavigationElement?.hasAttribute("data-turbo-stream")) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted(_request) {
    markAsBusy(this.element);
  }

  requestPreventedHandlingResponse(_request, _response) {
    this.#resolveVisitPromise();
  }

  async requestSucceededWithResponse(request, response) {
    await this.loadResponse(response);
    this.#resolveVisitPromise();
  }

  async requestFailedWithResponse(request, response) {
    await this.loadResponse(response);
    this.#resolveVisitPromise();
  }

  requestErrored(request, error) {
    console.error(error);
    this.#resolveVisitPromise();
  }

  requestFinished(_request) {
    clearBusyState(this.element);
  }

  // Form submission delegate

  formSubmissionStarted({ formElement }) {
    markAsBusy(formElement, this.#findFrameElement(formElement));
  }

  formSubmissionSucceededWithResponse(formSubmission, response) {
    const frame = this.#findFrameElement(formSubmission.formElement, formSubmission.submitter);

    frame.delegate.proposeVisitIfNavigatedWithAction(frame, getVisitAction(formSubmission.submitter, formSubmission.formElement, frame));
    frame.delegate.loadResponse(response);

    if (!formSubmission.isSafe) {
      session.clearCache();
    }
  }

  formSubmissionFailedWithResponse(formSubmission, fetchResponse) {
    this.element.delegate.loadResponse(fetchResponse);
    session.clearCache();
  }

  formSubmissionErrored(formSubmission, error) {
    console.error(error);
  }

  formSubmissionFinished({ formElement }) {
    clearBusyState(formElement, this.#findFrameElement(formElement));
  }

  // View delegate

  allowsImmediateRender({ element: newFrame }, options) {
    const event = dispatch("turbo:before-frame-render", {
      target: this.element,
      detail: { newFrame, ...options },
      cancelable: true
    });
    const {
      defaultPrevented,
      detail: { render }
    } = event;

    if (this.view.renderer && render) {
      this.view.renderer.renderElement = render;
    }

    return !defaultPrevented
  }

  viewRenderedSnapshot(_snapshot, _isPreview, _renderMethod) {}

  preloadOnLoadLinksForView(element) {
    session.preloadOnLoadLinksForView(element);
  }

  viewInvalidated() {}

  // Frame renderer delegate

  willRenderFrame(currentElement, _newElement) {
    this.previousFrameElement = currentElement.cloneNode(true);
  }

  visitCachedSnapshot = ({ element }) => {
    const frame = element.querySelector("#" + this.element.id);

    if (frame && this.previousFrameElement) {
      frame.replaceChildren(...this.previousFrameElement.children);
    }

    delete this.previousFrameElement;
  }

  // Private

  async #loadFrameResponse(fetchResponse, document) {
    const newFrameElement = await this.extractForeignFrameElement(document.body);

    if (newFrameElement) {
      const snapshot = new Snapshot(newFrameElement);
      const renderer = new FrameRenderer(this, this.view.snapshot, snapshot, FrameRenderer.renderElement, false, false);
      if (this.view.renderPromise) await this.view.renderPromise;
      this.changeHistory();

      await this.view.render(renderer);
      this.complete = true;
      session.frameRendered(fetchResponse, this.element);
      session.frameLoaded(this.element);
      await this.fetchResponseLoaded(fetchResponse);
    } else if (this.#willHandleFrameMissingFromResponse(fetchResponse)) {
      this.#handleFrameMissingFromResponse(fetchResponse);
    }
  }

  async #visit(url) {
    const request = new FetchRequest(this, FetchMethod.get, url, new URLSearchParams(), this.element);

    this.#currentFetchRequest?.cancel();
    this.#currentFetchRequest = request;

    return new Promise((resolve) => {
      this.#resolveVisitPromise = () => {
        this.#resolveVisitPromise = () => {};
        this.#currentFetchRequest = null;
        resolve();
      };
      request.perform();
    })
  }

  #navigateFrame(element, url, submitter) {
    const frame = this.#findFrameElement(element, submitter);

    frame.delegate.proposeVisitIfNavigatedWithAction(frame, getVisitAction(submitter, element, frame));

    this.#withCurrentNavigationElement(element, () => {
      frame.src = url;
    });
  }

  proposeVisitIfNavigatedWithAction(frame, action = null) {
    this.action = action;

    if (this.action) {
      const pageSnapshot = PageSnapshot.fromElement(frame).clone();
      const { visitCachedSnapshot } = frame.delegate;

      frame.delegate.fetchResponseLoaded = async (fetchResponse) => {
        if (frame.src) {
          const { statusCode, redirected } = fetchResponse;
          const responseHTML = await fetchResponse.responseHTML;
          const response = { statusCode, redirected, responseHTML };
          const options = {
            response,
            visitCachedSnapshot,
            willRender: false,
            updateHistory: false,
            restorationIdentifier: this.restorationIdentifier,
            snapshot: pageSnapshot
          };

          if (this.action) options.action = this.action;

          session.visit(frame.src, options);
        }
      };
    }
  }

  changeHistory() {
    if (this.action) {
      const method = getHistoryMethodForAction(this.action);
      session.history.update(method, expandURL(this.element.src || ""), this.restorationIdentifier);
    }
  }

  async #handleUnvisitableFrameResponse(fetchResponse) {
    console.warn(
      `The response (${fetchResponse.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`
    );

    await this.#visitResponse(fetchResponse.response);
  }

  #willHandleFrameMissingFromResponse(fetchResponse) {
    this.element.setAttribute("complete", "");

    const response = fetchResponse.response;
    const visit = async (url, options) => {
      if (url instanceof Response) {
        this.#visitResponse(url);
      } else {
        session.visit(url, options);
      }
    };

    const event = dispatch("turbo:frame-missing", {
      target: this.element,
      detail: { response, visit },
      cancelable: true
    });

    return !event.defaultPrevented
  }

  #handleFrameMissingFromResponse(fetchResponse) {
    this.view.missing();
    this.#throwFrameMissingError(fetchResponse);
  }

  #throwFrameMissingError(fetchResponse) {
    const message = `The response (${fetchResponse.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;
    throw new TurboFrameMissingError(message)
  }

  async #visitResponse(response) {
    const wrapped = new FetchResponse(response);
    const responseHTML = await wrapped.responseHTML;
    const { location, redirected, statusCode } = wrapped;

    return session.visit(location, { response: { redirected, statusCode, responseHTML } })
  }

  #findFrameElement(element, submitter) {
    const id = getAttribute("data-turbo-frame", submitter, element) || this.element.getAttribute("target");
    return getFrameElementById(id) ?? this.element
  }

  async extractForeignFrameElement(container) {
    let element;
    const id = CSS.escape(this.id);

    try {
      element = activateElement(container.querySelector(`turbo-frame#${id}`), this.sourceURL);
      if (element) {
        return element
      }

      element = activateElement(container.querySelector(`turbo-frame[src][recurse~=${id}]`), this.sourceURL);
      if (element) {
        await element.loaded;
        return await this.extractForeignFrameElement(element)
      }
    } catch (error) {
      console.error(error);
      return new FrameElement()
    }

    return null
  }

  #formActionIsVisitable(form, submitter) {
    const action = getAction$1(form, submitter);

    return locationIsVisitable(expandURL(action), this.rootLocation)
  }

  #shouldInterceptNavigation(element, submitter) {
    const id = getAttribute("data-turbo-frame", submitter, element) || this.element.getAttribute("target");

    if (element instanceof HTMLFormElement && !this.#formActionIsVisitable(element, submitter)) {
      return false
    }

    if (!this.enabled || id == "_top") {
      return false
    }

    if (id) {
      const frameElement = getFrameElementById(id);
      if (frameElement) {
        return !frameElement.disabled
      }
    }

    if (!session.elementIsNavigatable(element)) {
      return false
    }

    if (submitter && !session.elementIsNavigatable(submitter)) {
      return false
    }

    return true
  }

  // Computed properties

  get id() {
    return this.element.id
  }

  get enabled() {
    return !this.element.disabled
  }

  get sourceURL() {
    if (this.element.src) {
      return this.element.src
    }
  }

  set sourceURL(sourceURL) {
    this.#ignoringChangesToAttribute("src", () => {
      this.element.src = sourceURL ?? null;
    });
  }

  get loadingStyle() {
    return this.element.loading
  }

  get isLoading() {
    return this.formSubmission !== undefined || this.#resolveVisitPromise() !== undefined
  }

  get complete() {
    return this.element.hasAttribute("complete")
  }

  set complete(value) {
    if (value) {
      this.element.setAttribute("complete", "");
    } else {
      this.element.removeAttribute("complete");
    }
  }

  get isActive() {
    return this.element.isActive && this.#connected
  }

  get rootLocation() {
    const meta = this.element.ownerDocument.querySelector(`meta[name="turbo-root"]`);
    const root = meta?.content ?? "/";
    return expandURL(root)
  }

  #isIgnoringChangesTo(attributeName) {
    return this.#ignoredAttributes.has(attributeName)
  }

  #ignoringChangesToAttribute(attributeName, callback) {
    this.#ignoredAttributes.add(attributeName);
    callback();
    this.#ignoredAttributes.delete(attributeName);
  }

  #withCurrentNavigationElement(element, callback) {
    this.currentNavigationElement = element;
    callback();
    delete this.currentNavigationElement;
  }
}

function getFrameElementById(id) {
  if (id != null) {
    const element = document.getElementById(id);
    if (element instanceof FrameElement) {
      return element
    }
  }
}

function activateElement(element, currentURL) {
  if (element) {
    const src = element.getAttribute("src");
    if (src != null && currentURL != null && urlsAreEqual(src, currentURL)) {
      throw new Error(`Matching <turbo-frame id="${element.id}"> element has a source URL which references itself`)
    }
    if (element.ownerDocument !== document) {
      element = document.importNode(element, true);
    }

    if (element instanceof FrameElement) {
      element.connectedCallback();
      element.disconnectedCallback();
      return element
    }
  }
}

const StreamActions = {
  after() {
    this.targetElements.forEach((e) => e.parentElement?.insertBefore(this.templateContent, e.nextSibling));
  },

  append() {
    this.removeDuplicateTargetChildren();
    this.targetElements.forEach((e) => e.append(this.templateContent));
  },

  before() {
    this.targetElements.forEach((e) => e.parentElement?.insertBefore(this.templateContent, e));
  },

  prepend() {
    this.removeDuplicateTargetChildren();
    this.targetElements.forEach((e) => e.prepend(this.templateContent));
  },

  remove() {
    this.targetElements.forEach((e) => e.remove());
  },

  replace() {
    const method = this.getAttribute("method");

    this.targetElements.forEach((targetElement) => {
      if (method === "morph") {
        morphElements(targetElement, this.templateContent);
      } else {
        targetElement.replaceWith(this.templateContent);
      }
    });
  },

  update() {
    const method = this.getAttribute("method");

    this.targetElements.forEach((targetElement) => {
      if (method === "morph") {
        morphChildren(targetElement, this.templateContent);
      } else {
        targetElement.innerHTML = "";
        targetElement.append(this.templateContent);
      }
    });
  },

  refresh() {
    session.refresh(this.baseURI, this.requestId);
  }
};

// <turbo-stream action=replace target=id><template>...

/**
 * Renders updates to the page from a stream of messages.
 *
 * Using the `action` attribute, this can be configured one of eight ways:
 *
 * - `after` - inserts the result after the target
 * - `append` - appends the result to the target
 * - `before` - inserts the result before the target
 * - `prepend` - prepends the result to the target
 * - `refresh` - initiates a page refresh
 * - `remove` - removes the target
 * - `replace` - replaces the outer HTML of the target
 * - `update` - replaces the inner HTML of the target
 *
 * @customElement turbo-stream
 * @example
 *   <turbo-stream action="append" target="dom_id">
 *     <template>
 *       Content to append to target designated with the dom_id.
 *     </template>
 *   </turbo-stream>
 */
class StreamElement extends HTMLElement {
  static async renderElement(newElement) {
    await newElement.performAction();
  }

  async connectedCallback() {
    try {
      await this.render();
    } catch (error) {
      console.error(error);
    } finally {
      this.disconnect();
    }
  }

  async render() {
    return (this.renderPromise ??= (async () => {
      const event = this.beforeRenderEvent;

      if (this.dispatchEvent(event)) {
        await nextRepaint();
        await event.detail.render(this);
      }
    })())
  }

  disconnect() {
    try {
      this.remove();
      // eslint-disable-next-line no-empty
    } catch {}
  }

  /**
   * Removes duplicate children (by ID)
   */
  removeDuplicateTargetChildren() {
    this.duplicateChildren.forEach((c) => c.remove());
  }

  /**
   * Gets the list of duplicate children (i.e. those with the same ID)
   */
  get duplicateChildren() {
    const existingChildren = this.targetElements.flatMap((e) => [...e.children]).filter((c) => !!c.id);
    const newChildrenIds = [...(this.templateContent?.children || [])].filter((c) => !!c.id).map((c) => c.id);

    return existingChildren.filter((c) => newChildrenIds.includes(c.id))
  }

  /**
   * Gets the action function to be performed.
   */
  get performAction() {
    if (this.action) {
      const actionFunction = StreamActions[this.action];
      if (actionFunction) {
        return actionFunction
      }
      this.#raise("unknown action");
    }
    this.#raise("action attribute is missing");
  }

  /**
   * Gets the target elements which the template will be rendered to.
   */
  get targetElements() {
    if (this.target) {
      return this.targetElementsById
    } else if (this.targets) {
      return this.targetElementsByQuery
    } else {
      this.#raise("target or targets attribute is missing");
    }
  }

  /**
   * Gets the contents of the main `<template>`.
   */
  get templateContent() {
    return this.templateElement.content.cloneNode(true)
  }

  /**
   * Gets the main `<template>` used for rendering
   */
  get templateElement() {
    if (this.firstElementChild === null) {
      const template = this.ownerDocument.createElement("template");
      this.appendChild(template);
      return template
    } else if (this.firstElementChild instanceof HTMLTemplateElement) {
      return this.firstElementChild
    }
    this.#raise("first child element must be a <template> element");
  }

  /**
   * Gets the current action.
   */
  get action() {
    return this.getAttribute("action")
  }

  /**
   * Gets the current target (an element ID) to which the result will
   * be rendered.
   */
  get target() {
    return this.getAttribute("target")
  }

  /**
   * Gets the current "targets" selector (a CSS selector)
   */
  get targets() {
    return this.getAttribute("targets")
  }

  /**
   * Reads the request-id attribute
   */
  get requestId() {
    return this.getAttribute("request-id")
  }

  #raise(message) {
    throw new Error(`${this.description}: ${message}`)
  }

  get description() {
    return (this.outerHTML.match(/<[^>]+>/) ?? [])[0] ?? "<turbo-stream>"
  }

  get beforeRenderEvent() {
    return new CustomEvent("turbo:before-stream-render", {
      bubbles: true,
      cancelable: true,
      detail: { newStream: this, render: StreamElement.renderElement }
    })
  }

  get targetElementsById() {
    const element = this.ownerDocument?.getElementById(this.target);

    if (element !== null) {
      return [element]
    } else {
      return []
    }
  }

  get targetElementsByQuery() {
    const elements = this.ownerDocument?.querySelectorAll(this.targets);

    if (elements.length !== 0) {
      return Array.prototype.slice.call(elements)
    } else {
      return []
    }
  }
}

class StreamSourceElement extends HTMLElement {
  streamSource = null

  connectedCallback() {
    this.streamSource = this.src.match(/^ws{1,2}:/) ? new WebSocket(this.src) : new EventSource(this.src);

    connectStreamSource(this.streamSource);
  }

  disconnectedCallback() {
    if (this.streamSource) {
      this.streamSource.close();

      disconnectStreamSource(this.streamSource);
    }
  }

  get src() {
    return this.getAttribute("src") || ""
  }
}

FrameElement.delegateConstructor = FrameController;

if (customElements.get("turbo-frame") === undefined) {
  customElements.define("turbo-frame", FrameElement);
}

if (customElements.get("turbo-stream") === undefined) {
  customElements.define("turbo-stream", StreamElement);
}

if (customElements.get("turbo-stream-source") === undefined) {
  customElements.define("turbo-stream-source", StreamSourceElement);
}

(() => {
  let element = document.currentScript;
  if (!element) return
  if (element.hasAttribute("data-turbo-suppress-warning")) return

  element = element.parentElement;
  while (element) {
    if (element == document.body) {
      return console.warn(
        unindent`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,
        element.outerHTML
      )
    }

    element = element.parentElement;
  }
})();

window.Turbo = { ...Turbo, StreamActions };
start();




/***/ }),

/***/ "./core-bundle/assets/controllers/ace-controller.js":
/*!**********************************************************!*\
  !*** ./core-bundle/assets/controllers/ace-controller.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "connect",
    value: function connect() {
      var _this = this,
        _this$element;
      // Create a div to apply the editor to
      this.container = document.createElement('div');
      this.container.id = this.element.id + '_div';
      this.container.className = this.element.className;
      this.element.parentNode.insertBefore(this.container, this.element.nextSibling);

      // Hide the textarea
      this.element.style['display'] = 'none';

      // Instantiate the editor
      this.editor = ace.edit(this.container, {
        maxLines: Infinity
      });
      this.editor.getSession().setValue(this.element.value);
      this.editor.on('focus', function () {
        window.dispatchEvent(new Event('store-scroll-offset'));
      });
      this.editor.getSession().on('change', function () {
        _this.element.value = _this.editor.getValue();
      });

      // Disable command conflicts with AltGr (see #5792)
      this.editor.commands.bindKey('Ctrl-alt-a|Ctrl-alt-e|Ctrl-alt-h|Ctrl-alt-l|Ctrl-alt-s', null);

      // Execute the config callback
      (_this$element = this.element) === null || _this$element === void 0 || _this$element.configCallback(this.editor);
    }
  }, {
    key: "disconnect",
    value: function disconnect() {
      this.editor.destroy();
      this.container.remove();
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "values", {
  type: String,
  readOnly: Boolean
});


/***/ }),

/***/ "./core-bundle/assets/controllers/chosen-controller.js":
/*!*************************************************************!*\
  !*** ./core-bundle/assets/controllers/chosen-controller.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "connect",
    value: function connect() {
      this.chosen = new Chosen(this.element);
    }
  }, {
    key: "disconnect",
    value: function disconnect() {
      this.chosen.container.remove();
      this.chosen = null;
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);


/***/ }),

/***/ "./core-bundle/assets/controllers/clipboard-controller.js":
/*!****************************************************************!*\
  !*** ./core-bundle/assets/controllers/clipboard-controller.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "write",
    value: function write() {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(this.contentValue)["catch"](this.clipboardFallback.bind(this));
      } else {
        this.clipboardFallback();
      }
    }
  }, {
    key: "clipboardFallback",
    value: function clipboardFallback() {
      var input = document.createElement('input');
      input.value = this.contentValue;
      document.body.appendChild(input);
      input.select();
      input.setSelectionRange(0, 99999);
      document.execCommand('copy');
      document.body.removeChild(input);
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "values", {
  content: String
});


/***/ }),

/***/ "./core-bundle/assets/controllers/color-scheme-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/color-scheme-controller.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var prefersDark = function prefersDark() {
  var prefersDark = localStorage.getItem('contao--prefers-dark');
  if (null === prefersDark) {
    return !!window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return prefersDark === 'true';
};
var setColorScheme = function setColorScheme() {
  document.documentElement.dataset.colorScheme = prefersDark() ? 'dark' : 'light';
};
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setColorScheme);
setColorScheme();
var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "initialize",
    value: function initialize() {
      this.toggle = this.toggle.bind(this);
      this.setLabel = this.setLabel.bind(this);
    }
  }, {
    key: "connect",
    value: function connect() {
      this.element.addEventListener('click', this.toggle);
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', this.setLabel);
      this.setLabel();
    }
  }, {
    key: "disconnect",
    value: function disconnect() {
      this.element.removeEventListener('click', this.toggle);
    }
  }, {
    key: "toggle",
    value: function toggle(e) {
      e.preventDefault();
      var isDark = !prefersDark();
      if (isDark === window.matchMedia('(prefers-color-scheme: dark)').matches) {
        localStorage.removeItem('contao--prefers-dark');
      } else {
        localStorage.setItem('contao--prefers-dark', String(isDark));
      }
      setColorScheme();

      // Change the label after the dropdown is hidden
      setTimeout(this.setLabel, 300);
    }
  }, {
    key: "setLabel",
    value: function setLabel() {
      if (!this.hasLabelTarget) {
        return;
      }
      var label = this.i18nValue[prefersDark() ? 'light' : 'dark'];
      this.labelTarget.title = label;
      this.labelTarget.innerText = label;
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "targets", ['label']);
_defineProperty(_default, "values", {
  i18n: {
    type: Object,
    "default": {
      light: 'Disable dark mode',
      dark: 'Enable dark mode'
    }
  }
});


/***/ }),

/***/ "./core-bundle/assets/controllers/image-size-controller.js":
/*!*****************************************************************!*\
  !*** ./core-bundle/assets/controllers/image-size-controller.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "initialize",
    value: function initialize() {
      this.updateWizard = this.updateWizard.bind(this);
      this.openModal = this.openModal.bind(this);
    }
  }, {
    key: "connect",
    value: function connect() {
      this.select = this.element.querySelector('select');
      this.button = document.createElement('button');
      this.button.type = 'button';
      this.button.title = '';
      this.buttonImage = document.createElement('img');
      this.button.append(this.buttonImage);
      this.element.parentNode.classList.add('wizard');
      this.element.after(this.button);
      this.select.addEventListener('change', this.updateWizard);
      this.button.addEventListener('click', this.openModal);
      this.updateWizard();
    }
  }, {
    key: "disconnect",
    value: function disconnect() {
      this.element.parentNode.classList.remove('wizard');
      this.select.removeEventListener('change', this.updateWizard);
      this.buttonImage.remove();
      this.button.remove();
    }
  }, {
    key: "updateWizard",
    value: function updateWizard() {
      if (this.canEdit()) {
        this.button.title = this.configValue.title;
        this.button.disabled = false;
        this.buttonImage.src = this.configValue.icon;
      } else {
        this.button.title = '';
        this.button.disabled = true;
        this.buttonImage.src = this.configValue.iconDisabled;
      }
    }
  }, {
    key: "openModal",
    value: function openModal() {
      Backend.openModalIframe({
        title: this.configValue.title,
        url: "".concat(this.configValue.href, "&id=").concat(this.select.value)
      });
    }
  }, {
    key: "canEdit",
    value: function canEdit() {
      return this.configValue.ids.includes(Number(this.select.value));
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "values", {
  config: Object
});


/***/ }),

/***/ "./core-bundle/assets/controllers/jump-targets-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/jump-targets-controller.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "connect",
    value: function connect() {
      this.rebuildNavigation();
      this.connected = true;
    }
  }, {
    key: "sectionTargetConnected",
    value: function sectionTargetConnected() {
      if (!this.connected) {
        return;
      }
      this.rebuildNavigation();
    }
  }, {
    key: "rebuildNavigation",
    value: function rebuildNavigation() {
      var _this = this;
      if (!this.hasNavigationTarget) {
        return;
      }
      var links = document.createElement('ul');
      this.sectionTargets.forEach(function (el) {
        var action = document.createElement('button');
        action.innerText = el.getAttribute("data-".concat(_this.identifier, "-label-value"));
        action.addEventListener('click', function (event) {
          event.preventDefault();
          _this.dispatch('scrollto', {
            target: el
          });
          el.scrollIntoView();
        });
        var li = document.createElement('li');
        li.append(action);
        links.append(li);
      });
      this.navigationTarget.replaceChildren(links);
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "targets", ['navigation', 'section']);


/***/ }),

/***/ "./core-bundle/assets/controllers/limit-height-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/limit-height-controller.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _superPropGet(t, e, r, o) { var p = _get(_getPrototypeOf(1 & o ? t.prototype : t), e, r); return 2 & o ? function (t) { return p.apply(r, t); } : p; }
function _get() { return _get = "undefined" != typeof Reflect && Reflect.get ? Reflect.get.bind() : function (e, t, r) { var p = _superPropBase(e, t); if (p) { var n = Object.getOwnPropertyDescriptor(p, t); return n.get ? n.get.call(arguments.length < 3 ? e : r) : n.value; } }, _get.apply(null, arguments); }
function _superPropBase(t, o) { for (; !{}.hasOwnProperty.call(t, o) && null !== (t = _getPrototypeOf(t));); return t; }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "initialize",
    value: function initialize() {
      _superPropGet(_default, "initialize", this, 3)([]);
      this.togglerMap = new WeakMap();
      this.nextId = 1;
    }
  }, {
    key: "operationTargetConnected",
    value: function operationTargetConnected() {
      this.updateOperation();
    }
  }, {
    key: "nodeTargetConnected",
    value: function nodeTargetConnected(node) {
      var _this = this;
      var style = window.getComputedStyle(node, null);
      var padding = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);
      var height = node.clientHeight - padding;

      // Resize the element if it is higher than the maximum height
      if (this.maxValue > height) {
        return;
      }
      if (!node.id) {
        node.id = "limit-height-".concat(this.nextId++);
      }
      node.style.overflow = 'hidden';
      node.style.maxHeight = "".concat(this.maxValue, "px");
      var button = document.createElement('button');
      button.setAttribute('type', 'button');
      button.title = this.expandValue;
      button.innerHTML = '<span>...</span>';
      button.classList.add('unselectable');
      button.setAttribute('aria-expanded', 'false');
      button.setAttribute('aria-controls', node.id);
      button.addEventListener('click', function (event) {
        event.preventDefault();
        _this.toggle(node);
        _this.updateOperation(event);
      });
      var toggler = document.createElement('div');
      toggler.classList.add('limit_toggler');
      toggler.append(button);
      this.togglerMap.set(node, toggler);
      node.append(toggler);
      this.updateOperation();
    }
  }, {
    key: "nodeTargetDisconnected",
    value: function nodeTargetDisconnected(node) {
      if (!this.togglerMap.has(node)) {
        return;
      }
      this.togglerMap.get(node).remove();
      this.togglerMap["delete"](node);
      node.style.overflow = '';
      node.style.maxHeight = '';
    }
  }, {
    key: "toggle",
    value: function toggle(node) {
      if (node.style.maxHeight === '') {
        this.collapse(node);
      } else {
        this.expand(node);
      }
    }
  }, {
    key: "expand",
    value: function expand(node) {
      if (!this.togglerMap.has(node)) {
        return;
      }
      node.style.maxHeight = '';
      var button = this.togglerMap.get(node).querySelector('button');
      button.title = this.collapseValue;
      button.setAttribute('aria-expanded', 'true');
    }
  }, {
    key: "collapse",
    value: function collapse(node) {
      if (!this.togglerMap.has(node)) {
        return;
      }
      node.style.maxHeight = "".concat(this.maxValue, "px");
      var button = this.togglerMap.get(node).querySelector('button');
      button.title = this.expandValue;
      button.setAttribute('aria-expanded', 'false');
    }
  }, {
    key: "toggleAll",
    value: function toggleAll(event) {
      var _this2 = this;
      event.preventDefault();
      var isExpanded = this.hasExpanded() ^ event.altKey;
      this.nodeTargets.forEach(function (node) {
        if (isExpanded) {
          _this2.collapse(node);
        } else {
          _this2.expand(node);
        }
      });
      this.updateOperation(event);
    }
  }, {
    key: "keypress",
    value: function keypress(event) {
      this.updateOperation(event);
    }
  }, {
    key: "updateOperation",
    value: function updateOperation(event) {
      var _this3 = this;
      if (!this.hasOperationTarget) {
        return;
      }
      var hasTogglers = !!this.nodeTargets.find(function (el) {
        return _this3.togglerMap.has(el);
      });
      var expanded = this.hasExpanded();
      this.operationTarget.style.display = hasTogglers ? '' : 'none';
      this.operationTarget.setAttribute('aria-controls', this.nodeTargets.map(function (el) {
        return el.id;
      }).join(' '));
      this.operationTarget.setAttribute('aria-expanded', expanded ? 'true' : 'false');
      if (expanded ^ (event ? event.altKey : false)) {
        this.operationTarget.innerText = this.collapseAllValue;
        this.operationTarget.title = this.collapseAllTitleValue;
      } else {
        this.operationTarget.innerText = this.expandAllValue;
        this.operationTarget.title = this.expandAllTitleValue;
      }
    }
  }, {
    key: "hasExpanded",
    value: function hasExpanded() {
      var _this4 = this;
      return !!this.nodeTargets.find(function (el) {
        return _this4.togglerMap.has(el) && el.style.maxHeight === '';
      });
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "values", {
  max: Number,
  expand: String,
  collapse: String,
  expandAll: String,
  expandAllTitle: String,
  collapseAll: String,
  collapseAllTitle: String
});
_defineProperty(_default, "targets", ['operation', 'node']);


/***/ }),

/***/ "./core-bundle/assets/controllers/metawizard-controller.js":
/*!*****************************************************************!*\
  !*** ./core-bundle/assets/controllers/metawizard-controller.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "delete",
    value: function _delete() {
      this.inputTargets.forEach(function (input) {
        input.value = '';
      });
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "targets", ['input']);


/***/ }),

/***/ "./core-bundle/assets/controllers/scroll-offset-controller.js":
/*!********************************************************************!*\
  !*** ./core-bundle/assets/controllers/scroll-offset-controller.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "initialize",
    value: function initialize() {
      this.store = this.store.bind(this);
    }
  }, {
    key: "connect",
    value: function connect() {
      if (!this.offset) return;
      window.scrollTo({
        top: this.offset,
        behavior: this.behaviorValue,
        block: this.blockValue
      });
      this.offset = null;
    }
  }, {
    key: "scrollToTargetConnected",
    value: function scrollToTargetConnected() {
      this.scrollToTarget.scrollIntoView({
        behavior: this.behaviorValue,
        block: this.blockValue
      });
    }
  }, {
    key: "autoFocusTargetConnected",
    value: function autoFocusTargetConnected() {
      if (this.offset || this.autoFocus) return;
      var input = this.autoFocusTarget;
      if (input.disabled || input.readonly || !input.offsetWidth || !input.offsetHeight || input.closest('.chzn-search') || input.autocomplete && input.autocomplete !== 'off') {
        return;
      }
      this.autoFocus = true;
      input.focus();
    }
  }, {
    key: "widgetErrorTargetConnected",
    value: function widgetErrorTargetConnected() {
      this.widgetErrorTarget.scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    }
  }, {
    key: "store",
    value: function store() {
      this.offset = this.element.scrollTop;
    }
  }, {
    key: "discard",
    value: function discard() {
      this.offset = null;
    }
  }, {
    key: "scrollToWidgetError",
    value: function scrollToWidgetError() {
      if (this.hasWidgetErrorTarget) {
        this.widgetErrorTargetConnected();
      }
    }
  }, {
    key: "offset",
    get: function get() {
      var value = window.sessionStorage.getItem(this.sessionKeyValue);
      return value ? parseInt(value) : null;
    },
    set: function set(value) {
      if (value === null || value === undefined) {
        window.sessionStorage.removeItem(this.sessionKeyValue);
      } else {
        window.sessionStorage.setItem(this.sessionKeyValue, String(value));
      }
    }
  }], [{
    key: "afterLoad",
    value:
    // Backwards compatibility: automatically register the Stimulus controller if the legacy methods are used
    function afterLoad(identifier, application) {
      var loadFallback = function loadFallback() {
        return new Promise(function (resolve, reject) {
          var controller = application.getControllerForElementAndIdentifier(document.documentElement, identifier);
          if (controller) {
            resolve(controller);
            return;
          }
          var controllerAttribute = application.schema.controllerAttribute;
          document.documentElement.setAttribute(controllerAttribute, "".concat(document.documentElement.getAttribute(controllerAttribute) || '', " ").concat(identifier));
          setTimeout(function () {
            var controller = application.getControllerForElementAndIdentifier(document.documentElement, identifier);
            controller && resolve(controller) || reject(controller);
          }, 100);
        });
      };
      if (window.Backend && !window.Backend.initScrollOffset) {
        window.Backend.initScrollOffset = function () {
          console.warn('Backend.initScrollOffset() is deprecated. Please use the Stimulus controller instead.');
          loadFallback();
        };
      }
      if (window.Backend && !window.Backend.getScrollOffset) {
        window.Backend.getScrollOffset = function () {
          console.warn('Backend.getScrollOffset() is deprecated. Please use the Stimulus controller instead.');
          loadFallback().then(function (controller) {
            return controller.discard();
          });
        };
      }
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "targets", ['scrollTo', 'autoFocus', 'widgetError']);
_defineProperty(_default, "values", {
  sessionKey: {
    type: String,
    "default": 'contao_backend_offset'
  },
  behavior: {
    type: String,
    "default": 'instant'
  },
  block: {
    type: String,
    "default": 'center'
  }
});


/***/ }),

/***/ "./core-bundle/assets/controllers/tinymce-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/tinymce-controller.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "initialize",
    value: function initialize() {
      Turbo.cache.exemptPageFromCache();
    }
  }, {
    key: "connect",
    value: function connect() {
      var _tinymce,
        _this = this;
      if (!this.element.tinymceConfig) {
        console.error('No TinyMCE config was attached to the DOM element, expected an expando property called "tinymceConfig".', this.element);
        return;
      }
      var config = this.element.tinymceConfig;
      config.target = this.element;

      // TinyMCE creates the editor ID based on the target element's ID (if set).
      // This leads to a problem if an editor with the same ID is still around,
      // which would be the case if the disconnect event cleaning up the resource
      // has not run yet. We therefore remove the ID and re-add it after
      // initializing the editor.
      var elementId = this.element.id;
      this.element.removeAttribute('id');
      (_tinymce = tinymce) === null || _tinymce === void 0 || _tinymce.init(config).then(function (editors) {
        var _editors$, _editors$2;
        _this.editorId = (_editors$ = editors[0]) === null || _editors$ === void 0 ? void 0 : _editors$.id;

        // Fire a custom event when the editor finished intializing.
        _this.dispatch('editor-loaded', {
          detail: {
            content: (_editors$2 = editors[0]) !== null && _editors$2 !== void 0 ? _editors$2 : null
          }
        });
      });
      this.element.setAttribute('id', elementId);
    }
  }, {
    key: "disconnect",
    value: function disconnect() {
      var _tinymce2;
      (_tinymce2 = tinymce) === null || _tinymce2 === void 0 || (_tinymce2 = _tinymce2.get(this.editorId)) === null || _tinymce2 === void 0 || _tinymce2.remove();
    }
  }, {
    key: "leave",
    value: function leave(event) {
      var _tinymce3;
      var editor = (_tinymce3 = tinymce) === null || _tinymce3 === void 0 ? void 0 : _tinymce3.get(this.editorId);
      if (!editor || !editor.plugins.hasOwnProperty('autosave') || editor.isNotDirty) {
        return;
      }

      // Trigger a beforeunload event like when navigating away to capture the TinyMCE autosave message
      var delegate = document.createEvent('BeforeUnloadEvent');
      delegate.initEvent('beforeunload', false, true);
      if (!window.dispatchEvent(delegate) && !confirm(delegate.returnValue)) {
        event.preventDefault();
      }
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);


/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-fieldset-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-fieldset-controller.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "connect",
    value: function connect() {
      if (this.element.querySelectorAll('label.error, label.mandatory').length) {
        this.element.classList.remove(this.collapsedClass);
      } else if (this.element.classList.contains('hide')) {
        if (window.console) {
          console.warn("Using class \"hide\" on a fieldset is deprecated and will be removed in Contao 6. Use class \"".concat(this.collapsedClass, "\" instead."));
        }
        this.element.classList.add(this.collapsedClass);
      }
    }
  }, {
    key: "toggle",
    value: function toggle() {
      if (this.element.classList.contains(this.collapsedClass)) {
        this.open();
      } else {
        this.close();
      }
    }
  }, {
    key: "open",
    value: function open() {
      if (!this.element.classList.contains(this.collapsedClass)) {
        return;
      }
      this.element.classList.remove(this.collapsedClass);
      this.storeState(1);
    }
  }, {
    key: "close",
    value: function close() {
      if (this.element.classList.contains(this.collapsedClass)) {
        return;
      }
      var form = this.element.closest('form');
      var input = this.element.querySelectorAll('[required]');
      var collapse = true;
      for (var i = 0; i < input.length; i++) {
        if (!input[i].value) {
          collapse = false;
          break;
        }
      }
      if (!collapse) {
        if (typeof form.checkValidity == 'function') {
          form.querySelector('button[type="submit"]').click();
        }
      } else {
        this.element.classList.add(this.collapsedClass);
        this.storeState(0);
      }
    }
  }, {
    key: "storeState",
    value: function storeState(state) {
      if (!this.hasIdValue || !this.hasTableValue) {
        return;
      }
      fetch(window.location.href, {
        method: 'POST',
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        body: new URLSearchParams({
          action: 'toggleFieldset',
          id: this.idValue,
          table: this.tableValue,
          state: state
        })
      });
    }
  }], [{
    key: "afterLoad",
    value: function afterLoad(identifier, application) {
      var addController = function addController(el, id, table) {
        var fs = el.parentNode;
        fs.dataset.controller = "".concat(fs.dataset.controller || '', " ").concat(identifier);
        fs.setAttribute("data-".concat(identifier, "-id-value"), id);
        fs.setAttribute("data-".concat(identifier, "-table-value"), table);
        fs.setAttribute("data-".concat(identifier, "-collapsed-class"), 'collapsed');
        el.setAttribute('data-action', "click->".concat(identifier, "#toggle"));
      };
      var migrateLegacy = function migrateLegacy() {
        document.querySelectorAll('legend[data-toggle-fieldset]').forEach(function (el) {
          if (window.console) {
            console.warn("Using the \"data-toggle-fieldset\" attribute on fieldset legends is deprecated and will be removed in Contao 6. Apply the \"".concat(identifier, "\" Stimulus controller instead."));
          }
          var _JSON$parse = JSON.parse(el.getAttribute('data-toggle-fieldset')),
            id = _JSON$parse.id,
            table = _JSON$parse.table;
          addController(el, id, table);
        });
        AjaxRequest.toggleFieldset = function (el, id, table) {
          var fs = el.parentNode;

          // Already clicked, Stimulus controller was added dynamically
          if (application.getControllerForElementAndIdentifier(fs, identifier)) {
            return;
          }
          if (window.console) {
            console.warn('Using AjaxRequest.toggleFieldset() is deprecated and will be removed in Contao 6. Apply the Stimulus actions instead.');
          }
          addController(el, id, table);

          // Optimistically wait until Stimulus has registered the new controller
          setTimeout(function () {
            application.getControllerForElementAndIdentifier(fs, identifier).toggle();
          }, 100);
        };
      };

      // Called as soon as registered, so DOM may not have been loaded yet
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", migrateLegacy);
      } else {
        migrateLegacy();
      }
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "values", {
  id: String,
  table: String
});
_defineProperty(_default, "classes", ['collapsed']);


/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-navigation-controller.js":
/*!************************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-navigation-controller.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "toggle",
    value: function toggle(_ref) {
      var currentTarget = _ref.currentTarget,
        category = _ref.params.category;
      var el = currentTarget.parentNode;
      var collapsed = el.classList.toggle(this.collapsedClass);
      currentTarget.setAttribute('aria-expanded', collapsed ? 'false' : 'true');
      currentTarget.setAttribute('title', collapsed ? this.expandTitleValue : this.collapseTitleValue);
      this.sendRequest(category, collapsed);
    }
  }, {
    key: "sendRequest",
    value: function sendRequest(category, collapsed) {
      fetch(this.urlValue, {
        method: 'POST',
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        body: new URLSearchParams({
          action: 'toggleNavigation',
          id: category,
          state: collapsed ? 0 : 1,
          REQUEST_TOKEN: this.requestTokenValue
        })
      });
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "classes", ['collapsed']);
_defineProperty(_default, "values", {
  url: String,
  requestToken: String,
  expandTitle: String,
  collapseTitle: String
});


/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-nodes-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-nodes-controller.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _default)
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function _regeneratorRuntime() { "use strict"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = "function" == typeof Symbol ? Symbol : {}, a = i.iterator || "@@iterator", c = i.asyncIterator || "@@asyncIterator", u = i.toStringTag || "@@toStringTag"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, ""); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, "_invoke", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: "normal", arg: t.call(e, r) }; } catch (t) { return { type: "throw", arg: t }; } } e.wrap = wrap; var h = "suspendedStart", l = "suspendedYield", f = "executing", s = "completed", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { ["next", "throw", "return"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if ("throw" !== c.type) { var u = c.arg, h = u.value; return h && "object" == _typeof(h) && n.call(h, "__await") ? e.resolve(h.__await).then(function (t) { invoke("next", t, i, a); }, function (t) { invoke("throw", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke("throw", t, i, a); }); } a(c.arg); } var r; o(this, "_invoke", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error("Generator is already running"); if (o === s) { if ("throw" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if ("next" === n.method) n.sent = n._sent = n.arg;else if ("throw" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else "return" === n.method && n.abrupt("return", n.arg); o = f; var p = tryCatch(e, r, n); if ("normal" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } "throw" === p.type && (o = s, n.method = "throw", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, "throw" === n && e.iterator["return"] && (r.method = "return", r.arg = t, maybeInvokeDelegate(e, r), "throw" === r.method) || "return" !== n && (r.method = "throw", r.arg = new TypeError("The iterator does not provide a '" + n + "' method")), y; var i = tryCatch(o, e.iterator, r.arg); if ("throw" === i.type) return r.method = "throw", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, "return" !== r.method && (r.method = "next", r.arg = t), r.delegate = null, y) : a : (r.method = "throw", r.arg = new TypeError("iterator result is not an object"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = "normal", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: "root" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || "" === e) { var r = e[a]; if (r) return r.call(e); if ("function" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + " is not iterable"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, "constructor", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, "constructor", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, "GeneratorFunction"), e.isGeneratorFunction = function (t) { var e = "function" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || "GeneratorFunction" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, "GeneratorFunction")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, "Generator"), define(g, a, function () { return this; }), define(g, "toString", function () { return "[object Generator]"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = "next", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) "t" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if ("throw" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = "throw", a.arg = e, r.next = n, o && (r.method = "next", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if ("root" === i.tryLoc) return handle("end"); if (i.tryLoc <= this.prev) { var c = n.call(i, "catchLoc"), u = n.call(i, "finallyLoc"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error("try statement without catch or finally"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, "finallyLoc") && this.prev < o.finallyLoc) { var i = o; break; } } i && ("break" === t || "continue" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = "next", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if ("throw" === t.type) throw t.arg; return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, "catch": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if ("throw" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error("illegal catch attempt"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, "next" === this.method && (this.arg = t), y; } }, e; }
function asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }
function _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, "next", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, "throw", n); } _next(void 0); }); }; }
function _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function"); }
function _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }
function _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", { writable: !1 }), e; }
function _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }
function _possibleConstructorReturn(t, e) { if (e && ("object" == _typeof(e) || "function" == typeof e)) return e; if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined"); return _assertThisInitialized(t); }
function _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e; }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }
function _inherits(t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, "prototype", { writable: !1 }), e && _setPrototypeOf(t, e); }
function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }

var _default = /*#__PURE__*/function (_Controller) {
  function _default() {
    _classCallCheck(this, _default);
    return _callSuper(this, _default, arguments);
  }
  _inherits(_default, _Controller);
  return _createClass(_default, [{
    key: "operationTargetConnected",
    value: function operationTargetConnected() {
      this.updateOperation();
    }
  }, {
    key: "childTargetConnected",
    value: function childTargetConnected() {
      this.updateOperation();
    }
  }, {
    key: "toggle",
    value: function toggle(event) {
      event.preventDefault();
      var el = event.currentTarget;
      el.blur();
      this.toggleToggler(el, event.params.id, event.params.level, event.params.folder);
    }
  }, {
    key: "toggleToggler",
    value: function toggleToggler(el, id, level, folder) {
      var item = document.id(id);
      if (item && item.style.display === 'none') {
        this.showChild(item);
        this.expandToggler(el);
        this.updateState(el, id, 1);
      } else if (item) {
        this.hideChild(item);
        this.collapseToggler(el);
        this.updateState(el, id, 0);
      } else {
        this.fetchChild(el, id, level, folder);
      }
      this.updateOperation();
    }
  }, {
    key: "expandToggler",
    value: function expandToggler(el) {
      el.classList.add('foldable--open');
      el.title = this.collapseValue;
    }
  }, {
    key: "collapseToggler",
    value: function collapseToggler(el) {
      el.classList.remove('foldable--open');
      el.title = this.expandValue;
    }
  }, {
    key: "loadToggler",
    value: function loadToggler(el, enabled) {
      el.classList[enabled ? 'add' : 'remove']('foldable--loading');
    }
  }, {
    key: "showChild",
    value: function showChild(item) {
      item.style.display = '';
    }
  }, {
    key: "hideChild",
    value: function hideChild(item) {
      item.style.display = 'none';
    }
  }, {
    key: "fetchChild",
    value: function () {
      var _fetchChild = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(el, id, level, folder) {
        var url, search, response, txt, li, ul, isFolder, parent, next;
        return _regeneratorRuntime().wrap(function _callee$(_context) {
          while (1) switch (_context.prev = _context.next) {
            case 0:
              this.loadToggler(el, true);
              url = new URL(location.href);
              search = url.searchParams;
              search.set('ref', this.refererIdValue);
              url.search = search.toString();
              _context.next = 7;
              return fetch(url, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/x-www-form-urlencoded',
                  'X-Requested-With': 'XMLHttpRequest'
                },
                body: new URLSearchParams({
                  'action': this.loadActionValue,
                  'id': id,
                  'level': level,
                  'folder': folder,
                  'state': 1,
                  'REQUEST_TOKEN': this.requestTokenValue
                })
              });
            case 7:
              response = _context.sent;
              if (!response.ok) {
                _context.next = 37;
                break;
              }
              _context.next = 11;
              return response.text();
            case 11:
              txt = _context.sent;
              li = document.createElement('li');
              li.id = id;
              li.classList.add('parent');
              li.style.display = 'inline';
              li.setAttribute("data-".concat(this.identifier, "-target"), level === 0 ? 'child rootChild' : 'child');
              ul = document.createElement('ul');
              ul.classList.add('level_' + level);
              ul.innerHTML = txt;
              li.append(ul);
              if (!(this.modeValue === 5)) {
                _context.next = 25;
                break;
              }
              el.closest('li').after(li);
              _context.next = 34;
              break;
            case 25:
              isFolder = false, parent = el.closest('li');
            case 26:
              if (!(typeOf(parent) === 'element' && parent.tagName === 'LI' && (next = parent.nextElementSibling))) {
                _context.next = 33;
                break;
              }
              parent = next;
              if (!parent.classList.contains('tl_folder')) {
                _context.next = 31;
                break;
              }
              isFolder = true;
              return _context.abrupt("break", 33);
            case 31:
              _context.next = 26;
              break;
            case 33:
              if (isFolder) {
                parent.before(li);
              } else {
                parent.after(li);
              }
            case 34:
              window.dispatchEvent(new CustomEvent('structure'));
              this.expandToggler(el);

              // HOOK (see #6752)
              window.fireEvent('ajax_change');
            case 37:
              this.loadToggler(el, false);
            case 38:
            case "end":
              return _context.stop();
          }
        }, _callee, this);
      }));
      function fetchChild(_x, _x2, _x3, _x4) {
        return _fetchChild.apply(this, arguments);
      }
      return fetchChild;
    }()
  }, {
    key: "toggleAll",
    value: function () {
      var _toggleAll = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event) {
        var _this = this;
        var href, promises;
        return _regeneratorRuntime().wrap(function _callee2$(_context2) {
          while (1) switch (_context2.prev = _context2.next) {
            case 0:
              event.preventDefault();
              href = event.currentTarget.href;
              if (!(this.hasExpandedRoot() ^ (event ? event.altKey : false))) {
                _context2.next = 8;
                break;
              }
              this.updateAllState(href, 0);
              this.toggleTargets.forEach(function (el) {
                return _this.collapseToggler(el);
              });
              this.childTargets.forEach(function (item) {
                return item.style.display = 'none';
              });
              _context2.next = 16;
              break;
            case 8:
              this.childTargets.forEach(function (el) {
                return el.remove();
              });
              this.toggleTargets.forEach(function (el) {
                return _this.loadToggler(el, true);
              });
              _context2.next = 12;
              return this.updateAllState(href, 1);
            case 12:
              promises = [];
              this.toggleTargets.forEach(function (el) {
                promises.push(_this.fetchChild(el, el.getAttribute("data-".concat(_this.identifier, "-id-param")), 0, el.getAttribute("data-".concat(_this.identifier, "-folder-param"))));
              });
              _context2.next = 16;
              return Promise.all(promises);
            case 16:
              this.updateOperation();
            case 17:
            case "end":
              return _context2.stop();
          }
        }, _callee2, this);
      }));
      function toggleAll(_x5) {
        return _toggleAll.apply(this, arguments);
      }
      return toggleAll;
    }()
  }, {
    key: "keypress",
    value: function keypress(event) {
      this.updateOperation(event);
    }
  }, {
    key: "updateState",
    value: function () {
      var _updateState = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(el, id, state) {
        return _regeneratorRuntime().wrap(function _callee3$(_context3) {
          while (1) switch (_context3.prev = _context3.next) {
            case 0:
              _context3.next = 2;
              return fetch(location.href, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/x-www-form-urlencoded',
                  'X-Requested-With': 'XMLHttpRequest'
                },
                body: new URLSearchParams({
                  'action': this.toggleActionValue,
                  'id': id,
                  'state': state,
                  'REQUEST_TOKEN': this.requestTokenValue
                })
              });
            case 2:
            case "end":
              return _context3.stop();
          }
        }, _callee3, this);
      }));
      function updateState(_x6, _x7, _x8) {
        return _updateState.apply(this, arguments);
      }
      return updateState;
    }()
  }, {
    key: "updateAllState",
    value: function () {
      var _updateAllState = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(href, state) {
        return _regeneratorRuntime().wrap(function _callee4$(_context4) {
          while (1) switch (_context4.prev = _context4.next) {
            case 0:
              _context4.next = 2;
              return fetch("".concat(href, "&state=").concat(state));
            case 2:
            case "end":
              return _context4.stop();
          }
        }, _callee4);
      }));
      function updateAllState(_x9, _x10) {
        return _updateAllState.apply(this, arguments);
      }
      return updateAllState;
    }()
  }, {
    key: "updateOperation",
    value: function updateOperation(event) {
      if (!this.hasOperationTarget) {
        return;
      }
      if (this.hasExpandedRoot() ^ (event ? event.altKey : false)) {
        this.operationTarget.innerText = this.collapseAllValue;
        this.operationTarget.title = this.collapseAllTitleValue;
      } else {
        this.operationTarget.innerText = this.expandAllValue;
        this.operationTarget.title = this.expandAllTitleValue;
      }
    }
  }, {
    key: "hasExpandedRoot",
    value: function hasExpandedRoot() {
      return !!this.rootChildTargets.find(function (el) {
        return el.style.display !== 'none';
      });
    }
  }]);
}(_hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller);
_defineProperty(_default, "values", {
  mode: {
    type: Number,
    "default": 5
  },
  toggleAction: String,
  loadAction: String,
  requestToken: String,
  refererId: String,
  expand: String,
  collapse: String,
  expandAll: String,
  expandAllTitle: String,
  collapseAll: String,
  collapseAllTitle: String
});
_defineProperty(_default, "targets", ['operation', 'node', 'toggle', 'child', 'rootChild']);


/***/ }),

/***/ "./core-bundle/assets/scripts/core.js":
/*!********************************************!*\
  !*** ./core-bundle/assets/scripts/core.js ***!
  \********************************************/
/***/ (() => {

/**
 * Provide methods to handle Ajax requests.
 *
 * @author Leo Feyer <https://github.com/leofeyer>
 */
window.AjaxRequest = {
  /**
   * Toggle the navigation menu
   *
   * @param {object} el  The DOM element
   * @param {string} id  The ID of the menu item
   * @param {string} url The Ajax URL
   *
   * @returns {boolean}
   */
  toggleNavigation: function toggleNavigation(el, id, url) {
    if (window.console) {
      console.warn('AjaxRequest.toggleNavigation() is deprecated. Please use the stimulus controller instead.');
    }
    var item = $(id),
      parent = $(el).getParent('li');
    if (item) {
      if (parent.hasClass('collapsed')) {
        parent.removeClass('collapsed');
        $(el).setAttribute('aria-expanded', 'true');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          url: url
        }).post({
          'action': 'toggleNavigation',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        parent.addClass('collapsed');
        $(el).setAttribute('aria-expanded', 'false');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          url: url
        }).post({
          'action': 'toggleNavigation',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    return false;
  },
  /**
   * Toggle the page tree
   *
   * @param {object} el    The DOM element
   * @param {string} id    The ID of the target element
   * @param {int}    level The indentation level
   * @param {int}    mode  The insert mode
   *
   * @returns {boolean}
   */
  toggleStructure: function toggleStructure(el, id, level, mode) {
    if (window.console) {
      console.warn('AjaxRequest.toggleStructure() is deprecated. Please use the stimulus controller instead.');
    }
    el.blur();
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleStructure',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleStructure',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    new Request.Contao({
      field: el,
      evalScripts: true,
      onRequest: function onRequest() {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function onSuccess(txt) {
        var li = new Element('li', {
          'id': id,
          'class': 'parent',
          'styles': {
            'display': 'inline'
          }
        });
        new Element('ul', {
          'class': 'level_' + level,
          'html': txt
        }).inject(li, 'bottom');
        if (mode == 5) {
          li.inject($(el).getParent('li'), 'after');
        } else {
          var folder = false,
            parent = $(el).getParent('li'),
            next;
          while (typeOf(parent) == 'element' && (next = parent.getNext('li'))) {
            parent = next;
            if (parent.hasClass('tl_folder')) {
              folder = true;
              break;
            }
          }
          if (folder) {
            li.inject(parent, 'before');
          } else {
            li.inject(parent, 'after');
          }
        }

        // Update the referer ID
        li.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        window.fireEvent('structure');
        AjaxRequest.hideBox();

        // HOOK
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'loadStructure',
      'id': id,
      'level': level,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    return false;
  },
  /**
   * Toggle the file tree
   *
   * @param {object} el     The DOM element
   * @param {string} id     The ID of the target element
   * @param {string} folder The folder's path
   * @param {int}    level  The indentation level
   *
   * @returns {boolean}
   */
  toggleFileManager: function toggleFileManager(el, id, folder, level) {
    if (window.console) {
      console.warn('AjaxRequest.toggleFileManager() is deprecated. Please use the stimulus controller instead.');
    }
    el.blur();
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleFileManager',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleFileManager',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    new Request.Contao({
      field: el,
      evalScripts: true,
      onRequest: function onRequest() {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function onSuccess(txt) {
        var li = new Element('li', {
          'id': id,
          'class': 'parent',
          'styles': {
            'display': 'inline'
          }
        });
        new Element('ul', {
          'class': 'level_' + level,
          'html': txt
        }).inject(li, 'bottom');
        li.inject($(el).getParent('li'), 'after');

        // Update the referer ID
        li.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        AjaxRequest.hideBox();

        // HOOK
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'loadFileManager',
      'id': id,
      'level': level,
      'folder': folder,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    return false;
  },
  /**
   * Toggle sub-palettes in edit mode
   *
   * @param {object} el    The DOM element
   * @param {string} id    The ID of the target element
   * @param {string} field The field name
   */
  toggleSubpalette: function toggleSubpalette(el, id, field) {
    el.blur();
    var item = $(id);
    if (item) {
      if (!el.value) {
        el.value = 1;
        el.checked = 'checked';
        item.setStyle('display', null);
        item.getElements('[data-required]').each(function (el) {
          el.set('required', '').set('data-required', null);
        });
        new Request.Contao({
          field: el,
          onSuccess: updateVersionNumber
        }).post({
          'action': 'toggleSubpalette',
          'id': id,
          'field': field,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        el.value = '';
        el.checked = '';
        item.setStyle('display', 'none');
        item.getElements('[required]').each(function (el) {
          el.set('required', null).set('data-required', '');
        });
        new Request.Contao({
          field: el,
          onSuccess: updateVersionNumber
        }).post({
          'action': 'toggleSubpalette',
          'id': id,
          'field': field,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return;
    }
    new Request.Contao({
      field: el,
      evalScripts: false,
      onRequest: function onRequest() {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function onSuccess(txt, json) {
        var div = new Element('div', {
          'id': id,
          'class': 'subpal cf',
          'html': txt,
          'styles': {
            'display': 'block'
          }
        }).inject($(el).getParent('div').getParent('div'), 'after');

        // Execute scripts after the DOM has been updated
        if (json.javascript) {
          // Use Asset.javascript() instead of document.write() to load a
          // JavaScript file and re-execute the code after it has been loaded
          document.write = function (str) {
            var src = '';
            str.replace(/<script src="([^"]+)"/i, function (all, match) {
              src = match;
            });
            src && Asset.javascript(src, {
              onLoad: function onLoad() {
                Browser.exec(json.javascript);
              }
            });
          };
          Browser.exec(json.javascript);
        }
        el.value = 1;
        el.checked = 'checked';

        // Update the referer ID
        div.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        updateVersionNumber(txt);
        AjaxRequest.hideBox();
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'toggleSubpalette',
      'id': id,
      'field': field,
      'load': 1,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    function updateVersionNumber(html) {
      var fields = el.form.elements.VERSION_NUMBER || [];
      if (!fields.forEach) {
        fields = [fields];
      }
      fields.forEach(function (field) {
        field.value = /<input\s+[^>]*?name="VERSION_NUMBER"\s+[^>]*?value="([^"]*)"/i.exec(html)[1];
      });
    }
  },
  /**
   * Toggle the state of a checkbox field
   *
   * @param {object}  el      The DOM element
   * @param {boolean} rowIcon Whether the row icon should be toggled as well
   *
   * @returns {boolean}
   */
  toggleField: function toggleField(el, rowIcon) {
    el.blur();
    var img = null,
      images = $(el).getElements('img'),
      published = images[0].get('data-state') == 1,
      div = el.getParent('div'),
      next,
      pa;
    if (rowIcon) {
      // Find the icon depending on the view (tree view, list view, parent view)
      if (div.hasClass('tl_right')) {
        img = div.getPrevious('div').getElements('img');
      } else if (div.hasClass('tl_listing_container')) {
        img = el.getParent('td').getPrevious('td').getFirst('div.list_icon');
        if (img === null) {
          // comments
          img = el.getParent('td').getPrevious('td').getElement('div.cte_type');
        }
        if (img === null) {
          // showColumns
          img = el.getParent('tr').getFirst('td').getElement('div.list_icon_new');
        }
      } else if (next = div.getNext('div')) {
        if (next.hasClass('cte_type')) {
          img = next;
        }
        if (img === null) {
          // newsletter recipients
          img = next.getFirst('div.list_icon');
        }
      }

      // Change the row icon
      if (img !== null) {
        // Tree view
        if (!(img instanceof HTMLElement) && img.forEach) {
          img.forEach(function (img) {
            if (img.nodeName.toLowerCase() == 'img') {
              if (!img.getParent('ul.tl_listing').hasClass('tl_tree_xtnd')) {
                pa = img.getParent('a');
                if (pa && pa.href.indexOf('contao/preview') == -1) {
                  if (next = pa.getNext('a')) {
                    img = next.getElement('img');
                  } else {
                    img = new Element('img'); // no icons used (see #2286)
                  }
                }
              }
              var newSrc = !published ? img.get('data-icon') : img.get('data-icon-disabled');
              img.src = img.src.includes('/') && !newSrc.includes('/') ? img.src.slice(0, img.src.lastIndexOf('/') + 1) + newSrc : newSrc;
            }
          });
        }
        // Parent view
        else if (img.hasClass('cte_type')) {
          if (!published) {
            img.addClass('published');
            img.removeClass('unpublished');
          } else {
            img.addClass('unpublished');
            img.removeClass('published');
          }
        }
        // List view
        else {
          img.setStyle('background-image', 'url(' + (!published ? img.get('data-icon') : img.get('data-icon-disabled')) + ')');
        }
      }
    }

    // Send request
    images.forEach(function (image) {
      var newSrc = !published ? image.get('data-icon') : image.get('data-icon-disabled');
      image.src = image.src.includes('/') && !newSrc.includes('/') ? image.src.slice(0, image.src.lastIndexOf('/') + 1) + newSrc : newSrc;
      image.set('data-state', !published ? 1 : 0);
    });
    if (!published && $(el).get('data-title')) {
      el.title = $(el).get('data-title');
    } else if (published && $(el).get('data-title-disabled')) {
      el.title = $(el).get('data-title-disabled');
    }
    new Request.Contao({
      'url': el.href,
      'followRedirects': false
    }).get();

    // Return false to stop the click event on link
    return false;
  },
  /**
   * Toggle a group of a multi-checkbox field
   *
   * @param {object} el The DOM element
   * @param {string} id The ID of the target element
   *
   * @returns {boolean}
   */
  toggleCheckboxGroup: function toggleCheckboxGroup(el, id) {
    el.blur();
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        new Request.Contao().post({
          'action': 'toggleCheckboxGroup',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        new Request.Contao().post({
          'action': 'toggleCheckboxGroup',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return true;
    }
    return false;
  },
  /**
   * Display the "loading data" message
   *
   * @param {string} message The message text
   */
  displayBox: function displayBox(message) {
    var box = $('tl_ajaxBox'),
      overlay = $('tl_ajaxOverlay'),
      scroll = window.getScroll();
    if (overlay === null) {
      overlay = new Element('div', {
        'id': 'tl_ajaxOverlay'
      }).inject($(document.body), 'bottom');
    }
    overlay.set({
      'styles': {
        'display': 'block',
        'top': scroll.y + 'px'
      }
    });
    if (box === null) {
      box = new Element('div', {
        'id': 'tl_ajaxBox'
      }).inject($(document.body), 'bottom');
    }
    box.set({
      'html': message,
      'styles': {
        'display': 'block',
        'top': scroll.y + 100 + 'px'
      }
    });
  },
  /**
   * Hide the "loading data" message
   */
  hideBox: function hideBox() {
    var box = $('tl_ajaxBox'),
      overlay = $('tl_ajaxOverlay');
    if (overlay) {
      overlay.setStyle('display', 'none');
    }
    if (box) {
      box.setStyle('display', 'none');
    }
  }
};

/**
 * Provide methods to handle back end tasks.
 *
 * @author Leo Feyer <https://github.com/leofeyer>
 */
window.Backend = {
  /**
   * The current ID
   * @member {(string|null)}
   */
  currentId: null,
  /**
   * The popup window
   * @member {object}
   */
  popupWindow: null,
  /**
   * The theme path
   * @member {string}
   */
  themePath: Contao.script_url + 'system/themes/' + Contao.theme + '/',
  /**
   * Open a modal window
   *
   * @param {int}    width   The width in pixels
   * @param {string} title   The window's title
   * @param {string} content The window's content
   */
  openModalWindow: function openModalWindow(width, title, content) {
    new SimpleModal({
      'width': width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'onShow': function onShow() {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function onHide() {
        document.body.setStyle('overflow', 'auto');
      }
    }).show({
      'title': title,
      'contents': content
    });
  },
  /**
   * Open an image in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalImage: function openModalImage(options) {
    var _opt$title;
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt();
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    var M = new SimpleModal({
      'width': opt.width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'onShow': function onShow() {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function onHide() {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.show({
      'title': (_opt$title = opt.title) === null || _opt$title === void 0 ? void 0 : _opt$title.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<img src="' + opt.url + '" alt="">'
    });
  },
  /**
   * Open an iframe in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalIframe: function openModalIframe(options) {
    var _opt$title2;
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt(),
      maxHeight = (window.getSize().y - 137).toInt();
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    if (!opt.height || opt.height > maxHeight) opt.height = maxHeight;
    var M = new SimpleModal({
      'width': opt.width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'onShow': function onShow() {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function onHide() {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.show({
      'title': (_opt$title2 = opt.title) === null || _opt$title2 === void 0 ? void 0 : _opt$title2.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<iframe src="' + opt.url + '" width="100%" height="' + opt.height + '" frameborder="0"></iframe>',
      'model': 'modal'
    });
  },
  /**
   * Open a selector page in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalSelector: function openModalSelector(options) {
    var _opt$title3;
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt(),
      maxHeight = (window.getSize().y - 192).toInt();
    if (!opt.id) opt.id = 'tl_select';
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    if (!opt.height || opt.height > maxHeight) opt.height = maxHeight;
    var M = new SimpleModal({
      'width': opt.width,
      'draggable': false,
      'overlayOpacity': .7,
      'onShow': function onShow() {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function onHide() {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.addButton(Contao.lang.cancel, 'btn', function () {
      if (this.buttons[0].hasClass('btn-disabled')) {
        return;
      }
      this.hide();
    });
    M.addButton(Contao.lang.apply, 'btn primary', function () {
      if (this.buttons[1].hasClass('btn-disabled')) {
        return;
      }
      var frm = window.frames['simple-modal-iframe'],
        val = [],
        ul,
        inp,
        i,
        pickerValue,
        sIndex;
      if (frm === undefined) {
        alert('Could not find the SimpleModal frame');
        return;
      }
      ul = frm.document.getElementById(opt.id);
      // Load the previous values (#1816)
      if (pickerValue = ul.get('data-picker-value')) {
        val = JSON.parse(pickerValue);
      }
      inp = ul.getElementsByTagName('input');
      for (i = 0; i < inp.length; i++) {
        if (inp[i].id.match(/^(check_all_|reset_)/)) {
          continue;
        }
        // Add currently selected value, otherwise remove (#1816)
        sIndex = val.indexOf(inp[i].get('value'));
        if (inp[i].checked) {
          if (sIndex == -1) {
            val.push(inp[i].get('value'));
          }
        } else if (sIndex != -1) {
          val.splice(sIndex, 1);
        }
      }
      opt.callback(ul.get('data-table'), val);
      this.hide();
    });
    M.show({
      'title': (_opt$title3 = opt.title) === null || _opt$title3 === void 0 ? void 0 : _opt$title3.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<iframe src="' + opt.url + '" name="simple-modal-iframe" width="100%" height="' + opt.height + '" frameborder="0"></iframe>',
      'model': 'modal'
    });
  },
  /**
   * Open a TinyMCE file browser in a modal window
   *
   * @param {string} field_name The field name
   * @param {string} url        The URL
   * @param {string} type       The picker type
   * @param {object} win        The window object
   * @param {string} source     The source record
   */
  openModalBrowser: function openModalBrowser(field_name, url, type, win, source) {
    Backend.openModalSelector({
      'id': 'tl_listing',
      'title': win.document.getElement('div.mce-title').get('text'),
      'url': Contao.routes.backend_picker + '?context=' + (type == 'file' ? 'link' : 'file') + '&amp;extras[fieldType]=radio&amp;extras[filesOnly]=true&amp;extras[source]=' + source + '&amp;value=' + url + '&amp;popup=1',
      'callback': function callback(table, value) {
        win.document.getElementById(field_name).value = value.join(',');
      }
    });
  },
  /**
   * Automatically submit a form
   *
   * @param {object} el The DOM element
   */
  autoSubmit: function autoSubmit(el) {
    window.dispatchEvent(new Event('store-scroll-offset'));
    var hidden = new Element('input', {
      'type': 'hidden',
      'name': 'SUBMIT_TYPE',
      'value': 'auto'
    });
    var form = $(el) || el;
    hidden.inject(form, 'bottom');
    form.submit();
  },
  /**
   * Scroll the window to a certain vertical position
   *
   * @param {int} offset The offset to scroll to
   */
  vScrollTo: function vScrollTo(offset) {
    if (window.console) {
      console.warn('Backend.vScrollTo() is deprecated. Please use the Stimulus controller instead.');
    }
    window.addEvent('load', function () {
      window.scrollTo(null, parseInt(offset));
    });
  },
  /**
   * Toggle checkboxes
   *
   * @param {object} el   The DOM element
   * @param {string} [id] The ID of the target element
   */
  toggleCheckboxes: function toggleCheckboxes(el, id) {
    var items = $$('input'),
      status = $(el).checked ? 'checked' : '';
    for (var i = 0; i < items.length; i++) {
      if (items[i].type.toLowerCase() != 'checkbox') {
        continue;
      }
      if (id !== undefined && id != items[i].id.substr(0, id.length)) {
        continue;
      }
      items[i].checked = status;
    }
  },
  /**
   * Toggle a checkbox group
   *
   * @param {object} el The DOM element
   * @param {string} id The ID of the target element
   */
  toggleCheckboxGroup: function toggleCheckboxGroup(el, id) {
    var cls = $(el).className,
      status = $(el).checked ? 'checked' : '';
    if (cls == 'tl_checkbox') {
      var cbx = $(id) ? $$('#' + id + ' .tl_checkbox') : $(el).getParent('fieldset').getElements('.tl_checkbox');
      cbx.each(function (checkbox) {
        checkbox.checked = status;
      });
    } else if (cls == 'tl_tree_checkbox') {
      $$('#' + id + ' .parent .tl_tree_checkbox').each(function (checkbox) {
        checkbox.checked = status;
      });
    }
    window.dispatchEvent(new Event('store-scroll-offset'));
  },
  /**
   * Toggle checkbox elements
   *
   * @param {string} el  The DOM element
   * @param {string} cls The CSS class name
   */
  toggleCheckboxElements: function toggleCheckboxElements(el, cls) {
    var status = $(el).checked ? 'checked' : '';
    $$('.' + cls).each(function (checkbox) {
      if (checkbox.hasClass('tl_checkbox')) {
        checkbox.checked = status;
      }
    });
    window.dispatchEvent(new Event('store-scroll-offset'));
  },
  /**
   * Make parent view items sortable
   *
   * @param {object} ul The DOM element
   *
   * @author Joe Ray Gregory
   * @author Martin Auswöger
   */
  makeParentViewSortable: function makeParentViewSortable(ul) {
    var ds = new Scroller(document.getElement('body'), {
      onChange: function onChange(x, y) {
        this.element.scrollTo(this.element.getScroll().x, y);
      }
    });
    var list = new Sortables(ul, {
      constrain: true,
      opacity: 0.6,
      onStart: function onStart() {
        ds.start();
      },
      onComplete: function onComplete() {
        ds.stop();
      },
      onSort: function onSort(el) {
        var ul = el.getParent('ul'),
          wrapLevel = 0,
          divs,
          i;
        if (!ul) return;
        divs = ul.getChildren('li > div:first-child');
        if (!divs) return;
        for (i = 0; i < divs.length; i++) {
          if (divs[i].hasClass('wrapper_stop') && wrapLevel > 0) {
            wrapLevel--;
          }
          divs[i].className = divs[i].className.replace(/(^|\s)indent[^\s]*/g, '');
          if (wrapLevel > 0) {
            divs[i].addClass('indent').addClass('indent_' + wrapLevel);
          }
          if (divs[i].hasClass('wrapper_start')) {
            wrapLevel++;
          }
          divs[i].removeClass('indent_first');
          divs[i].removeClass('indent_last');
          if (divs[i - 1] && divs[i - 1].hasClass('wrapper_start')) {
            divs[i].addClass('indent_first');
          }
          if (divs[i + 1] && divs[i + 1].hasClass('wrapper_stop')) {
            divs[i].addClass('indent_last');
          }
        }
      },
      handle: '.drag-handle'
    });
    list.active = false;
    list.addEvent('start', function () {
      list.active = true;
    });
    list.addEvent('complete', function (el) {
      if (!list.active) return;
      var id, pid, req, href;
      if (el.getPrevious('li')) {
        id = el.get('id').replace(/li_/, '');
        pid = el.getPrevious('li').get('id').replace(/li_/, '');
        req = window.location.search.replace(/id=[0-9]*/, 'id=' + id) + '&act=cut&mode=1&pid=' + pid;
        href = window.location.href.replace(/\?.*$/, '');
        new Request.Contao({
          'url': href + req,
          'followRedirects': false
        }).get();
      } else if (el.getParent('ul')) {
        id = el.get('id').replace(/li_/, '');
        pid = el.getParent('ul').get('id').replace(/ul_/, '');
        req = window.location.search.replace(/id=[0-9]*/, 'id=' + id) + '&act=cut&mode=2&pid=' + pid;
        href = window.location.href.replace(/\?.*$/, '');
        new Request.Contao({
          'url': href + req,
          'followRedirects': false
        }).get();
      }
    });
  },
  /**
   * Make multiSRC items sortable
   *
   * @param {string} id  The ID of the target element
   * @param {string} oid The order field
   * @param {string} val The value field
   */
  makeMultiSrcSortable: function makeMultiSrcSortable(id, oid, val) {
    var list = new Sortables($(id), {
      constrain: true,
      opacity: 0.6
    }).addEvent('complete', function () {
      var els = [],
        lis = $(id).getChildren('[data-id]'),
        i;
      for (i = 0; i < lis.length; i++) {
        els.push(lis[i].get('data-id'));
      }
      if (oid === val) {
        $(val).value.split(',').forEach(function (j) {
          if (els.indexOf(j) === -1) {
            els.push(j);
          }
        });
      }
      $(oid).value = els.join(',');
    });
    $(id).getElements('.gimage').each(function (el) {
      if (el.hasClass('removable')) {
        new Element('button', {
          type: 'button',
          html: '&times;',
          'class': 'tl_red'
        }).addEvent('click', function () {
          var li = el.getParent('li'),
            did = li.get('data-id');
          $(val).value = $(val).value.split(',').filter(function (j) {
            return j != did;
          }).join(',');
          $(oid).value = $(oid).value.split(',').filter(function (j) {
            return j != did;
          }).join(',');
          li.dispose();
        }).inject(el, 'after');
      } else {
        new Element('button', {
          type: 'button',
          html: '&times',
          disabled: true
        }).inject(el, 'after');
      }
    });
    list.fireEvent("complete"); // Initial sorting
  },
  /**
   * Enable drag and drop for the file tree
   *
   * @param {object} ul      The DOM element
   * @param {object} options An optional options object
   */
  enableFileTreeDragAndDrop: function enableFileTreeDragAndDrop(ul, options) {
    var ds = new Scroller(document.getElement('body'), {
      onChange: function onChange(x, y) {
        this.element.scrollTo(this.element.getScroll().x, y);
      }
    });
    ul.addEvent('mousedown', function (event) {
      var dragHandle = event.target.hasClass('drag-handle') ? event.target : event.target.getParent('.drag-handle');
      var dragElement = event.target.getParent('.tl_file,.tl_folder');
      if (!dragHandle || !dragElement || event.rightClick) {
        return;
      }
      ds.start();
      ul.addClass('tl_listing_dragging');
      var cloneBase = dragElement.getElements('.tl_left')[0] || dragElement,
        clone = cloneBase.clone(true).inject(ul).addClass('tl_left_dragging'),
        currentHover,
        currentHoverTime,
        expandLink;
      clone.setPosition({
        x: event.page.x - cloneBase.getOffsetParent().getPosition().x - clone.getSize().x,
        y: cloneBase.getPosition(cloneBase.getOffsetParent()).y
      }).setStyle('display', 'none');
      var move = new Drag.Move(clone, {
        droppables: $$([ul]).append(ul.getElements('.tl_folder,li.parent,.tl_folder_top')),
        unDraggableTags: [],
        modifiers: {
          x: 'left',
          y: 'top'
        },
        onStart: function onStart() {
          clone.setStyle('display', '');
        },
        onEnter: function onEnter(element, droppable) {
          droppable = fixDroppable(droppable);
          droppable.addClass('tl_folder_dropping');
          if (droppable.hasClass('tl_folder') && currentHover !== droppable) {
            currentHover = droppable;
            currentHoverTime = new Date().getTime();
            expandLink = droppable.getElement('a.foldable');
            if (expandLink && !expandLink.hasClass('foldable--open')) {
              // Expand the folder after one second hover time
              setTimeout(function () {
                if (currentHover === droppable && currentHoverTime + 900 < new Date().getTime()) {
                  var event = document.createEvent('HTMLEvents');
                  event.initEvent('click', true, true);
                  expandLink.dispatchEvent(event);
                  currentHover = undefined;
                  currentHoverTime = undefined;
                  window.addEvent('ajax_change', function onAjax() {
                    if (move && move.droppables && ul && ul.getElements) {
                      move.droppables = $$([ul]).append(ul.getElements('.tl_folder,li.parent'));
                    }
                    window.removeEvent('ajax_change', onAjax);
                  });
                }
              }, 1000);
            }
          }
        },
        onCancel: function onCancel() {
          currentHover = undefined;
          currentHoverTime = undefined;
          ds.stop();
          clone.destroy();
          window.removeEvent('keyup', onKeyup);
          ul.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
          ul.removeClass('tl_listing_dragging');
        },
        onDrop: function onDrop(element, droppable) {
          currentHover = undefined;
          currentHoverTime = undefined;
          ds.stop();
          clone.destroy();
          window.removeEvent('keyup', onKeyup);
          ul.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
          ul.removeClass('tl_listing_dragging');
          droppable = fixDroppable(droppable);
          if (!droppable) {
            return;
          }
          var id = dragElement.get('data-id'),
            pid = droppable.get('data-id') || decodeURIComponent(options.url.split(/[?&]pid=/)[1].split('&')[0]);

          // Ignore invalid move operations
          if (id && pid && ((pid + '/').indexOf(id + '/') === 0 || pid + '/' === id.replace(/[^/]+$/, ''))) {
            return;
          }
          window.dispatchEvent(new Event('store-scroll-offset'));
          document.location.href = options.url + '&id=' + encodeURIComponent(id) + '&pid=' + encodeURIComponent(pid);
        },
        onLeave: function onLeave(element, droppable) {
          droppable = fixDroppable(droppable);
          droppable.removeClass('tl_folder_dropping');
          currentHover = undefined;
          currentHoverTime = undefined;
        }
      });
      move.start(event);
      window.addEvent('keyup', onKeyup);
      function onKeyup(event) {
        if (event.key === 'esc' && move && move.stop) {
          move.droppables = $$([]);
          move.stop();
        }
      }
    });
    function fixDroppable(droppable) {
      if (droppable && droppable.hasClass('parent') && droppable.getPrevious('.tl_folder')) {
        return droppable.getPrevious('.tl_folder');
      }
      return droppable;
    }
  },
  /**
   * List wizard
   *
   * @param {string} id The ID of the target element
   */
  listWizard: function listWizard(id) {
    var ul = $(id),
      makeSortable = function makeSortable(ul) {
        new Sortables(ul, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle'
        });
      },
      _addEventsTo = function addEventsTo(li) {
        var command, clone, input, previous, next;
        li.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                clone = li.clone(true).inject(li, 'before');
                if (input = li.getFirst('input')) {
                  clone.getFirst('input').value = input.value;
                }
                _addEventsTo(clone);
                input.select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (ul.getChildren().length > 1) {
                  li.destroy();
                }
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (previous = li.getPrevious('li')) {
                    li.inject(previous, 'before');
                  } else {
                    li.inject(ul, 'bottom');
                  }
                  bt.focus();
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (next = li.getNext('li')) {
                    li.inject(next, 'after');
                  } else {
                    li.inject(ul.getFirst('li'), 'before');
                  }
                  bt.focus();
                }
              });
              break;
          }
        });
      };
    makeSortable(ul);
    ul.getChildren().each(function (li) {
      _addEventsTo(li);
    });
  },
  /**
   * Table wizard
   *
   * @param {string} id The ID of the target element
   */
  tableWizard: function tableWizard(id) {
    var table = $(id),
      thead = table.getElement('thead'),
      tbody = table.getElement('tbody'),
      _makeSortable = function makeSortable(tbody) {
        var rows = tbody.getChildren(),
          textarea,
          children,
          i,
          j;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (textarea = children[j].getFirst('textarea')) {
              textarea.name = textarea.name.replace(/\[[0-9]+][[0-9]+]/g, '[' + i + '][' + j + ']');
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function onComplete() {
            _makeSortable(tbody);
          }
        });
      },
      _addEventsTo2 = function addEventsTo(tr) {
        var head = thead.getFirst('tr'),
          command,
          textarea,
          current,
          next,
          ntr,
          children,
          index,
          i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'rcopy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (textarea = children[i].getFirst('textarea')) {
                    next.getFirst('textarea').value = textarea.value;
                  }
                }
                ntr.inject(tr, 'after');
                _addEventsTo2(ntr);
                _makeSortable(tbody);
                ntr.getFirst('td').getFirst('textarea').select();
              });
              break;
            case 'rdelete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                _makeSortable(tbody);
              });
              break;
            case 'ccopy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                for (i = 0; i < children.length; i++) {
                  current = children[i].getChildren()[index];
                  next = current.clone(true).inject(current, 'after');
                  if (textarea = current.getFirst('textarea')) {
                    next.getFirst('textarea').value = textarea.value;
                  }
                  _addEventsTo2(next);
                }
                var headFirst = head.getFirst('td');
                next = headFirst.clone(true).inject(head.getLast('td'), 'before');
                _addEventsTo2(next);
                _makeSortable(tbody);
                children[0].getChildren()[index + 1].getFirst('textarea').select();
              });
              break;
            case 'cmovel':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (index > 0) {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(current.getPrevious(), 'before');
                  }
                } else {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(children[i].getLast(), 'before');
                  }
                }
                _makeSortable(tbody);
              });
              break;
            case 'cmover':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (index < tr.getChildren().length - 2) {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(current.getNext(), 'after');
                  }
                } else {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(children[i].getFirst(), 'before');
                  }
                }
                _makeSortable(tbody);
              });
              break;
            case 'cdelete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (tr.getChildren().length > 2) {
                  for (i = 0; i < children.length; i++) {
                    children[i].getChildren()[index].destroy();
                  }
                  head.getFirst('td').destroy();
                }
                _makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  _makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  _makeSortable(tbody);
                }
              });
              break;
          }
        });
      },
      getIndex = function getIndex(bt) {
        var td = $(bt).getParent('td'),
          tr = td.getParent('tr'),
          cols = tr.getChildren(),
          index = 0,
          i;
        for (i = 0; i < cols.length; i++) {
          if (cols[i] == td) {
            break;
          }
          index++;
        }
        return index;
      };
    _makeSortable(tbody);
    thead.getChildren().each(function (tr) {
      _addEventsTo2(tr);
    });
    tbody.getChildren().each(function (tr) {
      _addEventsTo2(tr);
    });
    Backend.tableWizardResize();
  },
  /**
   * Resize the table wizard fields on focus
   *
   * @param {float} [factor] The resize factor
   */
  tableWizardResize: function tableWizardResize(factor) {
    var size = window.localStorage.getItem('contao_table_wizard_cell_size');
    if (factor !== undefined) {
      size = '';
      $$('.tl_tablewizard textarea').each(function (el) {
        el.setStyle('width', (el.getStyle('width').toInt() * factor).round().limit(142, 284));
        el.setStyle('height', (el.getStyle('height').toInt() * factor).round().limit(66, 132));
        if (size == '') {
          size = el.getStyle('width') + '|' + el.getStyle('height');
        }
      });
      window.localStorage.setItem('contao_table_wizard_cell_size', size);
    } else if (size !== null) {
      var chunks = size.split('|');
      $$('.tl_tablewizard textarea').each(function (el) {
        el.setStyle('width', chunks[0]);
        el.setStyle('height', chunks[1]);
      });
    }
  },
  /**
   * Set the width of the table wizard
   */
  tableWizardSetWidth: function tableWizardSetWidth() {
    var wrap = $('tl_tablewizard');
    if (!wrap) return;
    wrap.setStyle('width', Math.round(wrap.getParent('.tl_formbody_edit').getComputedSize().width * 0.96));
  },
  /**
   * Options wizard
   *
   * @param {string} id The ID of the target element
   */
  optionsWizard: function optionsWizard(id) {
    var table = $(id),
      tbody = table.getElement('tbody'),
      _makeSortable2 = function makeSortable(tbody) {
        var rows = tbody.getChildren(),
          children,
          i,
          j,
          input;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (input = children[j].getFirst('input')) {
              input.name = input.name.replace(/\[[0-9]+]/g, '[' + i + ']');
              if (input.type == 'checkbox') {
                input.id = input.name.replace(/\[[0-9]+]/g, '').replace(/\[/g, '_').replace(/]/g, '') + '_' + i;
                input.getNext('label').set('for', input.id);
              }
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function onComplete() {
            _makeSortable2(tbody);
          }
        });
      },
      _addEventsTo3 = function addEventsTo(tr) {
        var command, input, next, ntr, children, i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (input = children[i].getFirst('input')) {
                    next.getFirst('input').value = input.value;
                    if (input.type == 'checkbox') {
                      next.getFirst('input').checked = input.checked ? 'checked' : '';
                    }
                  }
                }
                ntr.inject(tr, 'after');
                _addEventsTo3(ntr);
                _makeSortable2(tbody);
                ntr.getFirst('td').getFirst('input').select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                _makeSortable2(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  _makeSortable2(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  _makeSortable2(tbody);
                }
              });
              break;
          }
        });
      };
    _makeSortable2(tbody);
    tbody.getChildren().each(function (tr) {
      _addEventsTo3(tr);
    });
  },
  /**
   * Key/value wizard
   *
   * @param {string} id The ID of the target element
   */
  keyValueWizard: function keyValueWizard(id) {
    var table = $(id),
      tbody = table.getElement('tbody'),
      _makeSortable3 = function makeSortable(tbody) {
        var rows = tbody.getChildren(),
          children,
          i,
          j,
          input;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (input = children[j].getFirst('input')) {
              input.name = input.name.replace(/\[[0-9]+]/g, '[' + i + ']');
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function onComplete() {
            _makeSortable3(tbody);
          }
        });
      },
      _addEventsTo4 = function addEventsTo(tr) {
        var command, input, next, ntr, children, i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (input = children[i].getFirst('input')) {
                    next.getFirst().value = input.value;
                  }
                }
                ntr.inject(tr, 'after');
                _addEventsTo4(ntr);
                _makeSortable3(tbody);
                ntr.getFirst('td').getFirst('input').select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                _makeSortable3(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  _makeSortable3(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  _makeSortable3(tbody);
                }
              });
              break;
          }
        });
      };
    _makeSortable3(tbody);
    tbody.getChildren().each(function (tr) {
      _addEventsTo4(tr);
    });
  },
  /**
   * Checkbox wizard
   *
   * @param {string} id The ID of the target element
   */
  checkboxWizard: function checkboxWizard(id) {
    var container = $(id).getElement('.sortable'),
      makeSortable = function makeSortable(container) {
        new Sortables(container, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle'
        });
      },
      addEventsTo = function addEventsTo(span) {
        var nspan;
        span.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          bt.addEvent('keydown', function (e) {
            if (e.event.keyCode == 38) {
              e.preventDefault();
              if (nspan = span.getPrevious('span')) {
                span.inject(nspan, 'before');
              } else {
                span.inject(container, 'bottom');
              }
              bt.focus();
            } else if (e.event.keyCode == 40) {
              e.preventDefault();
              if (nspan = span.getNext('span')) {
                span.inject(nspan, 'after');
              } else {
                span.inject(container, 'top');
              }
              bt.focus();
            }
          });
        });
      };
    makeSortable(container);
    container.getChildren().each(function (span) {
      addEventsTo(span);
    });
  },
  /**
   * Update the fields of the imageSize widget upon change
   */
  enableImageSizeWidgets: function enableImageSizeWidgets() {
    $$('.tl_image_size').each(function (el) {
      var select = el.getElement('select'),
        widthInput = el.getChildren('input')[0],
        heightInput = el.getChildren('input')[1],
        update = function update() {
          if (select.get('value') === '' || select.get('value').indexOf('_') === 0 || select.get('value').toInt().toString() === select.get('value')) {
            widthInput.readOnly = true;
            heightInput.readOnly = true;
            var dimensions = $(select.getSelected()[0]).get('text');
            dimensions = dimensions.split('(').length > 1 ? dimensions.split('(').getLast().split(')')[0].split('x') : ['', ''];
            widthInput.set('value', '').set('placeholder', dimensions[0] * 1 || '');
            heightInput.set('value', '').set('placeholder', dimensions[1] * 1 || '');
          } else {
            widthInput.set('placeholder', '');
            heightInput.set('placeholder', '');
            widthInput.readOnly = false;
            heightInput.readOnly = false;
          }
        };
      update();
      select.addEvent('change', update);
      select.addEvent('keyup', update);
    });
  },
  /**
   * Allow toggling checkboxes or radio buttons by clicking a row
   *
   * @author Kamil Kuzminski
   */
  enableToggleSelect: function enableToggleSelect() {
    var container = $('tl_listing'),
      shiftToggle = function shiftToggle(el) {
        thisIndex = checkboxes.indexOf(el);
        startIndex = checkboxes.indexOf(start);
        from = Math.min(thisIndex, startIndex);
        to = Math.max(thisIndex, startIndex);
        status = !!checkboxes[startIndex].checked;
        for (from; from <= to; from++) {
          checkboxes[from].checked = status;
        }
      },
      clickEvent = function clickEvent(e) {
        var input = this.getElement('input[type="checkbox"],input[type="radio"]'),
          limitToggler = $(e.target).getParent('.limit_toggler');
        if (!input || input.get('disabled') || limitToggler !== null) {
          return;
        }

        // Radio buttons
        if (input.type == 'radio') {
          if (!input.checked) {
            input.checked = 'checked';
          }
          return;
        }

        // Checkboxes
        if (e.shift && start) {
          shiftToggle(input);
        } else {
          input.checked = input.checked ? '' : 'checked';
          if (input.get('onclick') == 'Backend.toggleCheckboxes(this)') {
            Backend.toggleCheckboxes(input); // see #6399
          }
        }
        start = input;
      },
      checkboxes = [],
      start,
      thisIndex,
      startIndex,
      status,
      from,
      to;
    if (container) {
      checkboxes = container.getElements('input[type="checkbox"]');
    }

    // Row click
    $$('.toggle_select').each(function (el) {
      var boundEvent = el.retrieve('boundEvent');
      if (boundEvent) {
        el.removeEvent('click', boundEvent);
      }

      // Do not propagate the form field click events
      el.getElements('label,input[type="checkbox"],input[type="radio"]').each(function (i) {
        i.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
      boundEvent = clickEvent.bind(el);
      el.addEvent('click', boundEvent);
      el.store('boundEvent', boundEvent);
    });

    // Checkbox click
    checkboxes.each(function (el) {
      el.addEvent('click', function (e) {
        if (e.shift && start) {
          shiftToggle(this);
        }
        start = this;
      });
    });
  },
  /**
   * Allow to mark the important part of an image
   *
   * @param {object} el The DOM element
   */
  editPreviewWizard: function editPreviewWizard(el) {
    el = $(el);
    var imageElement = el.getElement('img'),
      inputElements = {},
      isDrawing = false,
      partElement,
      startPos,
      getScale = function getScale() {
        return {
          x: imageElement.getComputedSize().width,
          y: imageElement.getComputedSize().height
        };
      },
      updateImage = function updateImage() {
        var scale = getScale(),
          imageSize = imageElement.getComputedSize();
        partElement.setStyles({
          top: imageSize.computedTop + (inputElements.y.get('value') * scale.y).round() + 'px',
          left: imageSize.computedLeft + (inputElements.x.get('value') * scale.x).round() + 'px',
          width: (inputElements.width.get('value') * scale.x).round() + 'px',
          height: (inputElements.height.get('value') * scale.y).round() + 'px'
        });
        if (!inputElements.width.get('value').toFloat() || !inputElements.height.get('value').toFloat()) {
          partElement.setStyle('display', 'none');
        } else {
          partElement.setStyle('display', null);
        }
      },
      updateValues = function updateValues() {
        var scale = getScale(),
          styles = partElement.getStyles('top', 'left', 'width', 'height'),
          imageSize = imageElement.getComputedSize(),
          values = {
            x: Math.max(0, Math.min(1, (styles.left.toFloat() - imageSize.computedLeft) / scale.x)),
            y: Math.max(0, Math.min(1, (styles.top.toFloat() - imageSize.computedTop) / scale.y))
          };
        values.width = Math.min(1 - values.x, styles.width.toFloat() / scale.x);
        values.height = Math.min(1 - values.y, styles.height.toFloat() / scale.y);
        if (!values.width || !values.height) {
          values.x = values.y = values.width = values.height = '';
          partElement.setStyle('display', 'none');
        } else {
          partElement.setStyle('display', null);
        }
        Object.each(values, function (value, key) {
          inputElements[key].set('value', value === '' ? '' : Number(value).toFixed(15));
        });
      },
      start = function start(event) {
        event.preventDefault();
        if (isDrawing) {
          return;
        }
        isDrawing = true;
        startPos = {
          x: event.page.x - el.getPosition().x - imageElement.getComputedSize().computedLeft,
          y: event.page.y - el.getPosition().y - imageElement.getComputedSize().computedTop
        };
        move(event);
      },
      move = function move(event) {
        if (!isDrawing) {
          return;
        }
        event.preventDefault();
        var imageSize = imageElement.getComputedSize();
        var rect = {
          x: [Math.max(0, Math.min(imageSize.width, startPos.x)), Math.max(0, Math.min(imageSize.width, event.page.x - el.getPosition().x - imageSize.computedLeft))],
          y: [Math.max(0, Math.min(imageSize.height, startPos.y)), Math.max(0, Math.min(imageSize.height, event.page.y - el.getPosition().y - imageSize.computedTop))]
        };
        partElement.setStyles({
          top: Math.min(rect.y[0], rect.y[1]) + imageSize.computedTop + 'px',
          left: Math.min(rect.x[0], rect.x[1]) + imageSize.computedLeft + 'px',
          width: Math.abs(rect.x[0] - rect.x[1]) + 'px',
          height: Math.abs(rect.y[0] - rect.y[1]) + 'px'
        });
        updateValues();
      },
      stop = function stop(event) {
        move(event);
        isDrawing = false;
      },
      init = function init() {
        el.getParent('.tl_tbox,.tl_box').getElements('input[name^="importantPart"]').each(function (input) {
          ['x', 'y', 'width', 'height'].each(function (key) {
            if (input.get('name').substr(13, key.length) === key.capitalize()) {
              inputElements[key] = input = $(input);
            }
          });
        });
        if (Object.getLength(inputElements) !== 4) {
          return;
        }
        Object.each(inputElements, function (input) {
          input.getParent().setStyle('display', 'none');
        });
        el.addClass('tl_edit_preview_enabled');
        partElement = new Element('div', {
          'class': 'tl_edit_preview_important_part'
        }).inject(el);
        updateImage();
        imageElement.addEvent('load', updateImage);
        el.addEvents({
          mousedown: start,
          touchstart: start
        });
        $(document.documentElement).addEvents({
          mousemove: move,
          touchmove: move,
          mouseup: stop,
          touchend: stop,
          touchcancel: stop,
          resize: updateImage
        });
      };
    window.addEvent('domready', init);
  },
  /**
   * Enable drag and drop file upload for the file tree
   *
   * @param {object} wrap    The DOM element
   * @param {object} options An optional options object
   */
  enableFileTreeUpload: function enableFileTreeUpload(wrap, options) {
    wrap = $(wrap);
    var fallbackUrl = options.url,
      dzElement = new Element('div', {
        'class': 'dropzone dropzone-filetree',
        html: '<span class="dropzone-previews"></span>'
      }).inject(wrap, 'top'),
      currentHover,
      currentHoverTime,
      expandLink;
    options.previewsContainer = dzElement.getElement('.dropzone-previews');
    options.clickable = false;
    var dz = new Dropzone(wrap, options);
    dz.on('queuecomplete', function () {
      window.location.reload();
    });
    dz.on('dragover', function (event) {
      if (!event.dataTransfer || !event.dataTransfer.types || event.dataTransfer.types.indexOf('Files') === -1) {
        return;
      }
      wrap.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
      var target = event.target && $(event.target);
      if (target) {
        var folder = target.match('.tl_folder') ? target : target.getParent('.tl_folder');
        if (!folder) {
          folder = target.getParent('.parent');
          folder = folder && folder.getPrevious('.tl_folder');
        }
        if (folder) {
          var link = folder.getElement('img[src$="/icons/new.svg"]');
          link = link && link.getParent('a');
        }
      }
      if (link && link.href) {
        dz.options.url = '' + link.href;
        folder.addClass('tl_folder_dropping');
        if (currentHover !== folder) {
          currentHover = folder;
          currentHoverTime = new Date().getTime();
          expandLink = folder.getElement('a.foldable');
          if (expandLink && !expandLink.hasClass('foldable--open')) {
            // Expand the folder after one second hover time
            setTimeout(function () {
              if (currentHover === folder && currentHoverTime + 900 < new Date().getTime()) {
                var event = document.createEvent('HTMLEvents');
                event.initEvent('click', true, true);
                expandLink.dispatchEvent(event);
                currentHover = undefined;
                currentHoverTime = undefined;
              }
            }, 1000);
          }
        }
      } else {
        dz.options.url = fallbackUrl;
        currentHover = undefined;
        currentHoverTime = undefined;
      }
    });
    dz.on('drop', function (event) {
      if (!event.dataTransfer || !event.dataTransfer.types || event.dataTransfer.types.indexOf('Files') === -1) {
        return;
      }
      dzElement.addClass('dropzone-filetree-enabled');
      window.dispatchEvent(new Event('store-scroll-offset'));
    });
    dz.on('dragleave', function () {
      wrap.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
      currentHover = undefined;
      currentHoverTime = undefined;
    });
  },
  /**
   * Crawl the website
   */
  crawl: function crawl() {
    var timeout = 2000,
      crawl = $('tl_crawl'),
      progressBar = crawl.getElement('div.progress-bar'),
      progressCount = crawl.getElement('p.progress-count'),
      results = crawl.getElement('div.results'),
      debugLog = crawl.getElement('p.debug-log');
    function updateData(response) {
      var total = response.total,
        done = total - response.pending,
        percentage = total > 0 ? parseInt(done / total * 100, 10) : 100,
        result;

      // Initialize the status bar at 10%
      if (done < 1 && percentage < 1) {
        done = 1;
        percentage = 10;
        total = 10;
      }
      progressBar.setStyle('width', percentage + '%');
      progressBar.set('html', percentage + '%');
      progressBar.setAttribute('aria-valuenow', percentage);
      progressCount.set('html', done + ' / ' + total);
      if (response.hasDebugLog) {
        debugLog.setStyle('display', 'block');
      }
      if (response.hasDebugLog) {
        debugLog.setStyle('display', 'block');
      }
      if (!response.finished) {
        return;
      }
      progressBar.removeClass('running').addClass('finished');
      results.removeClass('running').addClass('finished');
      for (result in response.results) {
        if (response.results.hasOwnProperty(result)) {
          var summary = results.getElement('.result[data-subscriber="' + result + '"] p.summary'),
            warning = results.getElement('.result[data-subscriber="' + result + '"] p.warning'),
            log = results.getElement('.result[data-subscriber="' + result + '"] p.subscriber-log'),
            subscriberResults = response.results[result],
            subscriberSummary = subscriberResults.summary;
          if (subscriberResults.warning) {
            warning.set('html', subscriberResults.warning);
          }
          if (subscriberResults.hasLog) {
            log.setStyle('display', 'block');
          }
          summary.addClass(subscriberResults.wasSuccessful ? 'success' : 'failure');
          summary.set('html', subscriberSummary);
        }
      }
    }
    function execRequest() {
      var onlyStatusUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      new Request({
        url: window.location.href,
        headers: {
          'Only-Status-Update': onlyStatusUpdate
        },
        onSuccess: function onSuccess(responseText) {
          var response = JSON.decode(responseText);
          updateData(response);
          if (!response.finished) {
            setTimeout(execRequest, timeout);
          }
        }
      }).send();
    }
    execRequest(true);
  }
};
window.Theme = {
  /**
   * Check for WebKit
   * @member {boolean}
  	 */
  isWebkit: Browser.chrome || Browser.safari || navigator.userAgent.match(/(?:webkit|khtml)/i),
  /**
   * Stop the propagation of click events of certain elements
   */
  stopClickPropagation: function stopClickPropagation() {
    // Do not propagate the click events of the icons
    $$('.picker_selector').each(function (ul) {
      ul.getElements('a').each(function (el) {
        el.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
    });

    // Do not propagate the click events of the checkboxes
    $$('.picker_selector,.click2edit').each(function (ul) {
      ul.getElements('input[type="checkbox"]').each(function (el) {
        el.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
    });
  },
  /**
   * Set up the [Ctrl] + click to edit functionality
   */
  setupCtrlClick: function setupCtrlClick() {
    $$('.click2edit').each(function (el) {
      // Do not propagate the click events of the default buttons (see #5731)
      el.getElements('a').each(function (a) {
        a.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });

      // Set up regular click events on touch devices
      if (Browser.Features.Touch) {
        el.addEvent('click', function () {
          if (!el.getAttribute('data-visited')) {
            el.setAttribute('data-visited', '1');
          } else {
            el.getElements('a').each(function (a) {
              if (a.hasClass('edit')) {
                document.location.href = a.href;
              }
            });
            el.removeAttribute('data-visited');
          }
        });
      } else {
        el.addEvent('click', function (e) {
          var key = Browser.Platform.mac ? e.event.metaKey : e.event.ctrlKey;
          if (!key) return;
          if (e.event.shiftKey) {
            el.getElements('a').each(function (a) {
              if (a.hasClass('children')) {
                document.location.href = a.href;
              }
            });
          } else {
            el.getElements('a').each(function (a) {
              if (a.hasClass('edit')) {
                document.location.href = a.href;
              }
            });
          }
        });
      }
    });
  },
  /**
   * Set up the textarea resizing
   */
  setupTextareaResizing: function setupTextareaResizing() {
    $$('.tl_textarea').each(function (el) {
      if (Browser.ie6 || Browser.ie7 || Browser.ie8) return;
      if (el.hasClass('noresize') || el.retrieve('autogrow')) return;

      // Set up the dummy element
      var dummy = new Element('div', {
        html: 'X',
        styles: {
          'position': 'absolute',
          'top': 0,
          'left': '-999em',
          'overflow-x': 'hidden'
        }
      }).setStyles(el.getStyles('font-size', 'font-family', 'width', 'line-height')).inject(document.body);

      // Also consider the box-sizing
      if (el.getStyle('-moz-box-sizing') == 'border-box' || el.getStyle('-webkit-box-sizing') == 'border-box' || el.getStyle('box-sizing') == 'border-box') {
        dummy.setStyles({
          'padding': el.getStyle('padding'),
          'border': el.getStyle('border-left')
        });
      }

      // Single line height
      var line = Math.max(dummy.clientHeight, 30);

      // Respond to the "input" event
      el.addEvent('input', function () {
        dummy.set('html', this.get('value').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n|\r\n/g, '<br>X'));
        var height = Math.max(line, dummy.getSize().y);
        if (this.clientHeight != height) this.tween('height', height);
      }).set('tween', {
        'duration': 100
      }).setStyle('height', line + 'px');

      // Fire the event
      el.fireEvent('input');
      el.store('autogrow', true);
    });
  },
  /**
   * Set up the menu toggle
   */
  setupMenuToggle: function setupMenuToggle() {
    var burger = $('burger');
    if (!burger) return;
    burger.addEvent('click', function () {
      document.body.toggleClass('show-navigation');
      burger.setAttribute('aria-expanded', document.body.hasClass('show-navigation') ? 'true' : 'false');
    }).addEvent('keydown', function (e) {
      if (e.event.keyCode == 27) {
        document.body.removeClass('show-navigation');
      }
    });
    if (window.matchMedia) {
      var matchMedia = window.matchMedia('(max-width:991px)');
      var setAriaControls = function setAriaControls() {
        if (matchMedia.matches) {
          burger.setAttribute('aria-controls', 'left');
          burger.setAttribute('aria-expanded', document.body.hasClass('show-navigation') ? 'true' : 'false');
        } else {
          burger.removeAttribute('aria-controls');
          burger.removeAttribute('aria-expanded');
        }
      };
      matchMedia.addEventListener('change', setAriaControls);
      setAriaControls();
    }
  },
  /**
   * Set up the profile toggle
   */
  setupProfileToggle: function setupProfileToggle() {
    var tmenu = $('tmenu');
    if (!tmenu) return;
    var li = tmenu.getElement('.submenu'),
      button = li.getFirst('span').getFirst('button'),
      menu = li.getFirst('ul');
    if (!li || !button || !menu) return;
    button.setAttribute('aria-controls', 'tmenu__profile');
    button.setAttribute('aria-expanded', 'false');
    menu.id = 'tmenu__profile';
    button.addEvent('click', function (e) {
      if (li.hasClass('active')) {
        li.removeClass('active');
        button.setAttribute('aria-expanded', 'false');
      } else {
        li.addClass('active');
        button.setAttribute('aria-expanded', 'true');
      }
      e.stopPropagation();
    });
    $(document.body).addEvent('click', function () {
      if (li.hasClass('active')) {
        li.removeClass('active');
      }
    });
  },
  /**
   * Set up the split button toggle
   */
  setupSplitButtonToggle: function setupSplitButtonToggle() {
    var toggle = $('sbtog');
    if (!toggle) return;
    var ul = toggle.getParent('.split-button').getElement('ul'),
      tab,
      timer;
    toggle.addEvent('click', function (e) {
      tab = false;
      ul.toggleClass('invisible');
      toggle.toggleClass('active');
      e.stopPropagation();
    });
    $(document.body).addEvent('click', function () {
      tab = false;
      ul.addClass('invisible');
      toggle.removeClass('active');
    });
    $(document.body).addEvent('keydown', function (e) {
      tab = e.event.keyCode == 9;
    });
    [toggle].append(ul.getElements('button')).each(function (el) {
      el.addEvent('focus', function () {
        if (!tab) return;
        ul.removeClass('invisible');
        toggle.addClass('active');
        clearTimeout(timer);
      });
      el.addEvent('blur', function () {
        if (!tab) return;
        timer = setTimeout(function () {
          ul.addClass('invisible');
          toggle.removeClass('active');
        }, 100);
      });
    });
    toggle.set('tabindex', '-1');
  }
};

// Initialize the back end script
window.addEvent('domready', function () {
  $(document.body).addClass('js');

  // Mark touch devices (see #5563)
  if (Browser.Features.Touch) {
    $(document.body).addClass('touch');
  }
  Backend.tableWizardSetWidth();
  Backend.enableImageSizeWidgets();
  Backend.enableToggleSelect();
  Theme.stopClickPropagation();
  Theme.setupCtrlClick();
  Theme.setupTextareaResizing();
  Theme.setupMenuToggle();
  Theme.setupProfileToggle();
  Theme.setupSplitButtonToggle();
});

// Resize the table wizard
window.addEvent('resize', function () {
  Backend.tableWizardSetWidth();
});

// Re-apply certain changes upon ajax_change
window.addEvent('ajax_change', function () {
  Backend.enableImageSizeWidgets();
  Backend.enableToggleSelect();
  Theme.stopClickPropagation();
  Theme.setupCtrlClick();
  Theme.setupTextareaResizing();
});

/***/ }),

/***/ "./core-bundle/assets/scripts/limit-height.js":
/*!****************************************************!*\
  !*** ./core-bundle/assets/scripts/limit-height.js ***!
  \****************************************************/
/***/ (() => {

window.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('div.limit_height').forEach(function (div) {
    if (window.console) {
      console.warn('Using "limit_height" class on child_record_callback is deprecated. Set a list.sorting.limitHeight in your DCA instead.');
    }
    var parent = div.parentNode.closest('.tl_content');

    // Return if the element is a wrapper
    if (parent && (parent.classList.contains('wrapper_start') || parent.classList.contains('wrapper_stop'))) return;
    var hgt = Number(div.className.replace(/[^0-9]*/, ''));

    // Return if there is no height value
    if (!hgt) return;
    var style = window.getComputedStyle(div, null);
    var padding = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);
    var height = div.clientHeight - padding;

    // Do not add the toggle if the preview height is below the max-height
    if (height <= hgt) return;

    // Resize the element if it is higher than the maximum height
    div.style.height = hgt + 'px';
    var button = document.createElement('button');
    button.setAttribute('type', 'button');
    button.title = Contao.lang.expand;
    button.innerHTML = '<span>...</span>';
    button.classList.add('unselectable');
    button.addEventListener('click', function () {
      if (div.style.height == 'auto') {
        div.style.height = hgt + 'px';
        button.title = Contao.lang.expand;
      } else {
        div.style.height = 'auto';
        button.title = Contao.lang.collapse;
      }
    });
    var toggler = document.createElement('div');
    toggler.classList.add('limit_toggler');
    toggler.append(button);
    div.append(toggler);
  });
});

/***/ }),

/***/ "./core-bundle/assets/scripts/modulewizard.js":
/*!****************************************************!*\
  !*** ./core-bundle/assets/scripts/modulewizard.js ***!
  \****************************************************/
/***/ (() => {

function _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t["return"] || t["return"](); } finally { if (u) throw o; } } }; }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
(function () {
  'use strict';

  var initializedRows = new WeakMap();
  var saveScrollOffsetEvent = new Event('store-scroll-offset');
  var init = function init(row) {
    // Check if this row has already been initialized
    if (initializedRows.has(row)) {
      return;
    }

    // Check if the row has all necessary elements to prevent the mutation observer
    // from initializing the incomplete widget.
    if (!row.querySelector('button.drag-handle')) {
      return;
    }
    initializedRows.set(row, true);
    var tbody = row.closest('tbody');
    var _makeSortable = function makeSortable(tbody) {
      Array.from(tbody.children).forEach(function (tr, i) {
        tr.querySelectorAll('input, select').forEach(function (el) {
          el.name = el.name.replace(/\[[0-9]+]/g, '[' + i + ']');
        });
      });

      // TODO: replace this with a vanilla JS solution
      new Sortables(tbody, {
        constrain: true,
        opacity: 0.6,
        handle: '.drag-handle',
        onComplete: function onComplete() {
          _makeSortable(tbody);
        }
      });
    };
    var _addEventsTo = function addEventsTo(tr) {
      tr.querySelectorAll('button').forEach(function (bt) {
        var command = bt.dataset.command;
        switch (command) {
          case 'copy':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              var ntr = tr.cloneNode(true);
              var selects = tr.querySelectorAll('select');
              var nselects = ntr.querySelectorAll('select');
              for (var j = 0; j < selects.length; j++) {
                nselects[j].value = selects[j].value;
              }
              ntr.querySelectorAll('[data-original-title]').forEach(function (el) {
                el.setAttribute('title', el.getAttribute('data-original-title'));
                el.removeAttribute('data-original-title');
              });
              initializedRows.set(ntr, true);
              tr.parentNode.insertBefore(ntr, tr.nextSibling);

              // Remove the ID of the select (used by Chosen)
              var select = ntr.querySelector('select.tl_select');
              select.removeAttribute('id');

              // Remove the existing Chosen container
              ntr.querySelector('.chzn-container').remove();
              _addEventsTo(ntr);
              _makeSortable(tbody);
            });
            break;
          case 'delete':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              if (tbody.children.length > 1) {
                tr.remove();
              } else {
                // Reset values for last element (#689)
                tr.querySelectorAll('select').forEach(function (select) {
                  select.value = select.children[0].value;
                });
              }
              _makeSortable(tbody);
            });
            break;
          case 'enable':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              var cbx = bt.previousElementSibling;
              if (cbx.checked) {
                cbx.checked = '';
              } else {
                cbx.checked = 'checked';
              }
            });
            break;
          default:
            if (bt.classList.contains('drag-handle')) {
              bt.addEventListener('keydown', function (event) {
                if (event.code === 'ArrowUp' || event.keyCode === 38) {
                  event.preventDefault();
                  if (tr.previousElementSibling) {
                    tr.previousElementSibling.insertAdjacentElement('beforebegin', tr);
                  } else {
                    tbody.insertAdjacentElement('beforeend', tr);
                  }
                  bt.focus();
                  _makeSortable(tbody);
                } else if (event.code === 'ArrowDown' || event.keyCode === 40) {
                  event.preventDefault();
                  if (tr.nextElementSibling) {
                    tr.nextElementSibling.insertAdjacentElement('afterend', tr);
                  } else {
                    tbody.insertAdjacentElement('afterbegin', tr);
                  }
                  bt.focus();
                  _makeSortable(tbody);
                }
              });
            }
            break;
        }
      });
      var select = tr.querySelector('td:first-child select');
      if (!select) {
        return;
      }
      var link = tr.querySelector('a.module_link');
      var images = tr.querySelectorAll('img.module_image');
      var updateLink = function updateLink() {
        link.href = link.href.replace(/id=[0-9]+/, 'id=' + select.value);
        if (select.value > 0) {
          link.classList.remove('hidden');
          images.forEach(function (image) {
            image.classList.add('hidden');
          });
        } else {
          link.classList.add('hidden');
          images.forEach(function (image) {
            image.classList.remove('hidden');
          });
        }
      };
      select.addEventListener('change', updateLink);

      // Backwards compatibility with MooTools "Chosen" script that fires non-native change event
      select.addEvent('change', updateLink);
    };
    _makeSortable(tbody);
    _addEventsTo(row);
  };
  document.querySelectorAll('.tl_modulewizard tr').forEach(init);
  new MutationObserver(function (mutationsList) {
    var _iterator = _createForOfIteratorHelper(mutationsList),
      _step;
    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var mutation = _step.value;
        if (mutation.type === 'childList') {
          mutation.addedNodes.forEach(function (element) {
            if (element.matches && element.matches('.tl_modulewizard tr, .tl_modulewizard tr *')) {
              init(element.closest('tr'));
            }
          });
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ }),

/***/ "./core-bundle/assets/scripts/mootao.js":
/*!**********************************************!*\
  !*** ./core-bundle/assets/scripts/mootao.js ***!
  \**********************************************/
/***/ (() => {

function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
/*
---

name: Request.Contao

description: Extends the MooTools Request.JSON class with Contao-specific routines.

license: LGPLv3

authors:
 - Leo Feyer

requires: [Request, JSON]

provides: Request.Contao

...
*/

Request.Contao = new Class({
  Extends: Request.JSON,
  options: {
    followRedirects: true,
    url: window.location.href
  },
  initialize: function initialize(options) {
    if (options && !options.url && options.field && options.field.form && options.field.form.action) {
      this.options.url = options.field.form.action;
    }
    this.parent(options);
  },
  success: function success(text) {
    var url = this.getHeader('X-Ajax-Location'),
      json;
    if (url && this.options.followRedirects) {
      location.replace(url);
      return;
    }

    // Support both plain text and JSON responses
    try {
      json = this.response.json = JSON.decode(text, this.options.secure);
    } catch (e) {
      json = {
        'content': text
      };
    }

    // Empty response
    if (json === null) {
      json = {
        'content': ''
      };
    } else if (_typeof(json) != 'object') {
      json = {
        'content': text
      };
    }

    // Isolate scripts and execute them
    if (json.content != '') {
      json.content = json.content.stripScripts(function (script) {
        json.javascript = script.replace(/<!--|\/\/-->|<!\[CDATA\[\/\/>|<!]]>/g, '');
      });
      if (json.javascript && this.options.evalScripts) {
        Browser.exec(json.javascript);
      }
    }
    this.onSuccess(json.content, json);
  },
  failure: function failure() {
    var url = this.getHeader('X-Ajax-Location');
    if (url && 401 === this.status) {
      location.replace(url);
      return;
    }
    if (url && this.options.followRedirects && this.status >= 300 && this.status < 400) {
      location.replace(url);
      return;
    }
    this.onFailure();
  }
});

/*
---

name: Drag

description: Extends the base Drag class with touch support.

license: LGPLv3

authors:
 - Andreas Schempp

requires: [Drag]

provides: Drag

...
*/

Class.refactor(Drag, {
  attach: function attach() {
    this.handles.addEvent('touchstart', this.bound.start);
    return this.previous.apply(this, arguments);
  },
  detach: function detach() {
    this.handles.removeEvent('touchstart', this.bound.start);
    return this.previous.apply(this, arguments);
  },
  start: function start() {
    document.addEvents({
      touchmove: this.bound.check,
      touchend: this.bound.cancel
    });
    this.previous.apply(this, arguments);
  },
  check: function check(event) {
    if (this.options.preventDefault) event.preventDefault();
    var distance = Math.round(Math.sqrt(Math.pow(event.page.x - this.mouse.start.x, 2) + Math.pow(event.page.y - this.mouse.start.y, 2)));
    if (distance > this.options.snap) {
      this.cancel();
      this.document.addEvents({
        mousemove: this.bound.drag,
        mouseup: this.bound.stop
      });
      document.addEvents({
        touchmove: this.bound.drag,
        touchend: this.bound.stop
      });
      this.fireEvent('start', [this.element, event]).fireEvent('snap', this.element);
    }
  },
  cancel: function cancel() {
    document.removeEvents({
      touchmove: this.bound.check,
      touchend: this.bound.cancel
    });
    return this.previous.apply(this, arguments);
  },
  stop: function stop() {
    document.removeEvents({
      touchmove: this.bound.drag,
      touchend: this.bound.stop
    });
    return this.previous.apply(this, arguments);
  }
});

/*
---

name: Sortables

description: Extends the base Sortables class with touch support.

license: LGPLv3

authors:
 - Andreas Schempp

requires: [Sortables]

provides: Sortables

...
*/

Class.refactor(Sortables, {
  initialize: function initialize(lists, options) {
    options.dragOptions = Object.merge(options.dragOptions || {}, {
      preventDefault: options.dragOptions && options.dragOptions.preventDefault || Browser.Features.Touch
    });
    if (options.dragOptions.unDraggableTags === undefined) {
      options.dragOptions.unDraggableTags = this.options.unDraggableTags.filter(function (tag) {
        return tag != 'button';
      });
    }
    return this.previous.apply(this, arguments);
  },
  addItems: function addItems() {
    Array.flatten(arguments).each(function (element) {
      this.elements.push(element);
      var start = element.retrieve('sortables:start', function (event) {
        this.start.call(this, event, element);
      }.bind(this));
      (this.options.handle ? element.getElement(this.options.handle) || element : element).addEvents({
        mousedown: start,
        touchstart: start
      });
    }, this);
    return this;
  },
  removeItems: function removeItems() {
    return $$(Array.flatten(arguments).map(function (element) {
      this.elements.erase(element);
      var start = element.retrieve('sortables:start');
      (this.options.handle ? element.getElement(this.options.handle) || element : element).removeEvents({
        mousedown: start,
        touchend: start
      });
      return element;
    }, this));
  },
  getClone: function getClone(event, element) {
    if (!this.options.clone) return new Element(element.tagName).inject(document.body);
    if (typeOf(this.options.clone) == 'function') return this.options.clone.call(this, event, element, this.list);
    var clone = this.previous.apply(this, arguments);
    clone.addEvent('touchstart', function (event) {
      element.fireEvent('touchstart', event);
    });
    return clone;
  }
});

/*
---

script: Request.Queue.js

name: Request.Queue

description: Extends the base Request.Queue class and attempts to fix some issues.

license: MIT-style license

authors:
 - Leo Feyer

requires:
	- Core/Element
	- Core/Request
	- Class.Binds

provides: [Request.Queue]

...
*/

Class.refactor(Request.Queue, {
  // Do not fire the "end" event here
  onComplete: function onComplete() {
    this.fireEvent('complete', arguments);
  },
  // Call resume() instead of runNext()
  onCancel: function onCancel() {
    if (this.options.autoAdvance && !this.error) this.resume();
    this.fireEvent('cancel', arguments);
  },
  // Call resume() instead of runNext() and fire the "end" event
  onSuccess: function onSuccess() {
    if (this.options.autoAdvance && !this.error) this.resume();
    this.fireEvent('success', arguments);
    if (!this.queue.length && !this.isRunning()) this.fireEvent('end');
  },
  // Call resume() instead of runNext() and fire the "end" event
  onFailure: function onFailure() {
    this.error = true;
    if (!this.options.stopOnFailure && this.options.autoAdvance) this.resume();
    this.fireEvent('failure', arguments);
    if (!this.queue.length && !this.isRunning()) this.fireEvent('end');
  },
  // Call resume() instead of runNext()
  onException: function onException() {
    this.error = true;
    if (!this.options.stopOnFailure && this.options.autoAdvance) this.resume();
    this.fireEvent('exception', arguments);
  }
});

/*
---

name: Contao.SerpPreview

description: Generates a SERP preview

license: LGPLv3

authors:
 - Leo Feyer

requires: [Request, JSON]

provides: Contao.SerpPreview

...
*/

Contao.SerpPreview = new Class({
  options: {
    id: 0,
    trail: null,
    titleField: null,
    titleFallbackField: null,
    aliasField: null,
    descriptionField: null,
    descriptionFallbackField: null,
    titleTag: null
  },
  shorten: function shorten(str, max) {
    if (str.length <= max) {
      return str;
    }
    return str.substr(0, str.lastIndexOf(' ', max)) + ' …';
  },
  html2string: function html2string(html) {
    return new DOMParser().parseFromString(html, 'text/html').body.textContent.replace(/\[-]/g, '\xAD').replace(/\[nbsp]/g, '\xA0');
  },
  getTinymce: function getTinymce() {
    if (window.tinyMCE && this.options.descriptionFallbackField) {
      return window.tinyMCE.get(this.options.descriptionFallbackField);
    }
  },
  initialize: function initialize() {
    Turbo.cache.exemptPageFromCache();
    this.options = Object.merge.apply(null, [{}, this.options].append(arguments));
    var serpTitle = $('serp_title_' + this.options.id),
      serpUrl = $('serp_url_' + this.options.id),
      serpDescription = $('serp_description_' + this.options.id),
      titleField = $(this.options.titleField),
      titleFallbackField = $(this.options.titleFallbackField),
      aliasField = $(this.options.aliasField),
      descriptionField = $(this.options.descriptionField),
      descriptionFallbackField = $(this.options.descriptionFallbackField),
      indexEmpty = this.options.trail.indexOf('›') === -1,
      titleTag = this.options.titleTag || '%s';
    titleField && titleField.addEvent('input', function () {
      if (titleField.value) {
        serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleField.value)).replace(/%%/g, '%'), 64));
      } else if (titleFallbackField && titleFallbackField.value) {
        serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleFallbackField.value)).replace(/%%/g, '%'), 64));
      } else {
        serpTitle.set('text', '');
      }
    }.bind(this));
    titleFallbackField && titleFallbackField.addEvent('input', function () {
      if (titleField && titleField.value) return;
      serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleFallbackField.value)).replace(/%%/g, '%'), 64));
    }.bind(this));
    aliasField && aliasField.addEvent('input', function () {
      if (aliasField.value == 'index' && indexEmpty) {
        serpUrl.set('text', this.options.trail);
      } else {
        serpUrl.set('text', this.options.trail + ' › ' + (aliasField.value || this.options.id).replace(/\//g, ' › '));
      }
    }.bind(this));
    descriptionField && descriptionField.addEvent('input', function () {
      if (descriptionField.value) {
        serpDescription.set('text', this.shorten(descriptionField.value, 160));
        return;
      }
      var editor = this.getTinymce();
      if (editor) {
        serpDescription.set('text', this.shorten(this.html2string(editor.getContent()), 160));
      } else if (descriptionFallbackField && descriptionFallbackField.value) {
        serpDescription.set('text', this.shorten(this.html2string(descriptionFallbackField.value), 160));
      } else {
        serpDescription.set('text', '');
      }
    }.bind(this));
    descriptionFallbackField && descriptionFallbackField.addEvent('input', function () {
      if (descriptionField && descriptionField.value) return;
      serpDescription.set('text', this.shorten(this.html2string(descriptionFallbackField.value), 160));
    }.bind(this));
    setTimeout(function () {
      var editor = this.getTinymce();
      editor && editor.on('keyup', function () {
        if (descriptionField && descriptionField.value) return;
        serpDescription.set('text', this.shorten(this.html2string(window.tinyMCE.activeEditor.getContent()), 160));
      }.bind(this));
    }.bind(this), 4);
  }
});

/***/ }),

/***/ "./core-bundle/assets/scripts/sectionwizard.js":
/*!*****************************************************!*\
  !*** ./core-bundle/assets/scripts/sectionwizard.js ***!
  \*****************************************************/
/***/ (() => {

function _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t["return"] || t["return"](); } finally { if (u) throw o; } } }; }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
(function () {
  'use strict';

  var initializedRows = new WeakMap();
  var saveScrollOffsetEvent = new Event('store-scroll-offset');
  var init = function init(row) {
    // Check if this row has already been initialized
    if (initializedRows.has(row)) {
      return;
    }

    // Check if the row has all necessary elements to prevent the mutation observer
    // from initializing the incomplete widget.
    if (!row.querySelector('button.drag-handle')) {
      return;
    }
    initializedRows.set(row, true);
    var tbody = row.closest('tbody');
    var _makeSortable = function makeSortable(tbody) {
      Array.from(tbody.children).forEach(function (tr, i) {
        tr.querySelectorAll('input, select').forEach(function (el) {
          el.name = el.name.replace(/\[[0-9]+]/g, '[' + i + ']');
        });
      });

      // TODO: replace this with a vanilla JS solution
      new Sortables(tbody, {
        constrain: true,
        opacity: 0.6,
        handle: '.drag-handle',
        onComplete: function onComplete() {
          _makeSortable(tbody);
        }
      });
    };
    var _addEventsTo = function addEventsTo(tr) {
      tr.querySelectorAll('button').forEach(function (bt) {
        var command = bt.dataset.command;
        switch (command) {
          case 'copy':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              var ntr = tr.cloneNode(true);
              var selects = tr.querySelectorAll('select');
              var nselects = ntr.querySelectorAll('select');
              for (var j = 0; j < selects.length; j++) {
                nselects[j].value = selects[j].value;
              }
              tr.parentNode.insertBefore(ntr, tr.nextSibling);
              _addEventsTo(ntr);
              _makeSortable(tbody);
            });
            break;
          case 'delete':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              if (tbody.children.length > 1) {
                tr.remove();
              } else {
                // Reset values for last element (#689)
                tr.querySelectorAll('input').forEach(function (input) {
                  input.value = '';
                });
                tr.querySelectorAll('select').forEach(function (select) {
                  select.value = select.children[0].value;
                });
              }
              _makeSortable(tbody);
            });
            break;
          default:
            if (bt.classList.contains('drag-handle')) {
              bt.addEventListener('keydown', function (event) {
                if (event.code === 'ArrowUp' || event.keyCode === 38) {
                  event.preventDefault();
                  if (tr.previousElementSibling) {
                    tr.previousElementSibling.insertAdjacentElement('beforebegin', tr);
                  } else {
                    tbody.insertAdjacentElement('beforeend', tr);
                  }
                  bt.focus();
                  _makeSortable(tbody);
                } else if (event.code === 'ArrowDown' || event.keyCode === 40) {
                  event.preventDefault();
                  if (tr.nextElementSibling) {
                    tr.nextElementSibling.insertAdjacentElement('afterend', tr);
                  } else {
                    tbody.insertAdjacentElement('afterbegin', tr);
                  }
                  bt.focus();
                  _makeSortable(tbody);
                }
              });
            }
            break;
        }
      });
    };
    _makeSortable(tbody);
    _addEventsTo(row);
  };
  document.querySelectorAll('.tl_sectionwizard tr').forEach(init);
  new MutationObserver(function (mutationsList) {
    var _iterator = _createForOfIteratorHelper(mutationsList),
      _step;
    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var mutation = _step.value;
        if (mutation.type === 'childList') {
          mutation.addedNodes.forEach(function (element) {
            if (element.matches && element.matches('.tl_sectionwizard tr, .tl_sectionwizard tr *')) {
              init(element.closest('tr'));
            }
          });
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ }),

/***/ "./core-bundle/assets/scripts/tips.js":
/*!********************************************!*\
  !*** ./core-bundle/assets/scripts/tips.js ***!
  \********************************************/
/***/ (() => {

function _createForOfIteratorHelper(r, e) { var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t["return"] || t["return"](); } finally { if (u) throw o; } } }; }
function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }
function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _iterableToArray(r) { if ("undefined" != typeof Symbol && null != r[Symbol.iterator] || null != r["@@iterator"]) return Array.from(r); }
function _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
(function () {
  var initialized = [];
  var tip = document.createElement('div');
  tip.setAttribute('role', 'tooltip');
  tip.classList.add('tip');
  tip.style.position = 'absolute';
  tip.style.display = 'none';
  var init = function init(el, x, y, useContent) {
    if (initialized.includes(el)) {
      return;
    }
    initialized.push(el);
    var text, timer;
    el.addEventListener('mouseenter', function () {
      if (useContent) {
        text = el.innerHTML;
      } else {
        var _text;
        text = el.getAttribute('title');
        el.setAttribute('data-original-title', text);
        el.removeAttribute('title');
        text = (_text = text) === null || _text === void 0 ? void 0 : _text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;');
      }
      if (!text) {
        return;
      }
      clearTimeout(timer);
      tip.style.willChange = 'display,contents';
      timer = setTimeout(function () {
        var position = el.getBoundingClientRect();
        var rtl = getComputedStyle(el).direction === 'rtl';
        var clientWidth = document.html.clientWidth;
        if (rtl && position.x < 200 || !rtl && position.x < clientWidth - 200) {
          tip.style.left = "".concat(window.scrollX + position.left + x, "px");
          tip.style.right = 'auto';
          tip.classList.remove('tip--rtl');
        } else {
          tip.style.left = 'auto';
          tip.style.right = "".concat(clientWidth - window.scrollX - position.right + x, "px");
          tip.classList.add('tip--rtl');
        }
        tip.innerHTML = "<div>".concat(text, "</div>");
        tip.style.top = "".concat(window.scrollY + position.top + y, "px");
        tip.style.display = 'block';
        tip.style.willChange = 'auto';
        if (!tip.parentNode && document.body) {
          document.body.append(tip);
        }
      }, 1000);
    });
    el.addEventListener('mouseleave', function () {
      if (el.hasAttribute('data-original-title')) {
        if (!el.hasAttribute('title')) {
          el.setAttribute('title', el.getAttribute('data-original-title'));
        }
        el.removeAttribute('data-original-title');
      }
      clearTimeout(timer);
      tip.style.willChange = 'auto';
      if (tip.style.display === 'block') {
        tip.style.willChange = 'display';
        timer = setTimeout(function () {
          tip.style.display = 'none';
          tip.style.willChange = 'auto';
        }, 100);
      }
    });
    var action = el.closest('button, a');

    // Hide tooltip when clicking a button (usually an operation icon in a wizard widget)
    if (action) {
      action.addEventListener('click', function () {
        clearTimeout(timer);
        tip.style.display = 'none';
        tip.style.willChange = 'auto';
      });
    }
  };
  function select(node, selector) {
    if (node.matches(selector)) {
      return [node].concat(_toConsumableArray(node.querySelectorAll(selector)));
    }
    return node.querySelectorAll(selector);
  }
  function setup(node) {
    select(node, 'p.tl_tip').forEach(function (el) {
      init(el, 0, 23, true);
    });
    select(node, '#home').forEach(function (el) {
      init(el, 6, 42);
    });
    select(node, '#tmenu a[title]').forEach(function (el) {
      init(el, 0, 42);
    });
    select(node, 'a[title][class^="group-"]').forEach(function (el) {
      init(el, -6, 27);
    });
    select(node, 'a[title].navigation').forEach(function (el) {
      init(el, 25, 32);
    });
    select(node, 'img[title]').forEach(function (el) {
      init(el, -9, el.classList.contains('gimage') ? 60 : 30);
    });
    select(node, 'a[title]').forEach(function (el) {
      if (el.classList.contains('picker-wizard')) {
        init(el, -4, 30);
      } else {
        init(el, -9, 30);
      }
    });
    select(node, 'button[title]').forEach(function (el) {
      if (el.classList.contains('unselectable')) {
        init(el, -4, 20);
      } else {
        init(el, -9, 30);
      }
    });
    ['input[title]', 'time[title]', 'span[title]'].forEach(function (selector) {
      select(node, selector).forEach(function (el) {
        init(el, -9, selector === 'time[title]' || selector === 'span[title]' ? 26 : 30);
      });
    });
  }
  setup(document.documentElement);
  new MutationObserver(function (mutationsList) {
    var _iterator = _createForOfIteratorHelper(mutationsList),
      _step;
    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var mutation = _step.value;
        if (mutation.type === 'childList') {
          mutation.addedNodes.forEach(function (element) {
            if (element.matches && element.querySelectorAll) {
              setup(element);
            }
          });
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
(() => {
"use strict";
/*!***************************************!*\
  !*** ./core-bundle/assets/backend.js ***!
  \***************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hotwired/stimulus-webpack-helpers */ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js");
/* harmony import */ var _hotwired_turbo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @hotwired/turbo */ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js");
/* harmony import */ var _scripts_mootao_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./scripts/mootao.js */ "./core-bundle/assets/scripts/mootao.js");
/* harmony import */ var _scripts_mootao_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_scripts_mootao_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _scripts_core_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./scripts/core.js */ "./core-bundle/assets/scripts/core.js");
/* harmony import */ var _scripts_core_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_scripts_core_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./scripts/limit-height.js */ "./core-bundle/assets/scripts/limit-height.js");
/* harmony import */ var _scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./scripts/modulewizard.js */ "./core-bundle/assets/scripts/modulewizard.js");
/* harmony import */ var _scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scripts/sectionwizard.js */ "./core-bundle/assets/scripts/sectionwizard.js");
/* harmony import */ var _scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _scripts_tips_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./scripts/tips.js */ "./core-bundle/assets/scripts/tips.js");
/* harmony import */ var _scripts_tips_js__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_scripts_tips_js__WEBPACK_IMPORTED_MODULE_8__);










// Start the Stimulus application
var application = _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Application.start();
application.debug = "development" === 'development';

// Register all controllers with `contao--` prefix
var context = __webpack_require__("./core-bundle/assets/controllers sync recursive \\.js$");
application.load(context.keys().map(function (key) {
  var identifier = (0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.identifierForContextKey)(key);
  if (identifier) {
    return (0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.definitionForModuleAndIdentifier)(context(key), "contao--".concat(identifier));
  }
}).filter(function (value) {
  return value;
}));

// Cancel all prefetch requests that contain a request token
document.documentElement.addEventListener('turbo:before-prefetch', function (e) {
  if (new URLSearchParams(e.target.href).has('rt') || e.target.closest('.sf-toolbar') !== null) {
    e.preventDefault();
  }
});

// Make the MooTools scripts reinitialize themselves
var mooDomready = function mooDomready() {
  if (!document.body.mooDomreadyFired) {
    document.body.mooDomreadyFired = true;
    window.fireEvent('domready');
  }
};
document.documentElement.addEventListener('turbo:render', mooDomready);
document.documentElement.addEventListener('turbo:frame-render', mooDomready);
})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbUJBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELDJDQUEyQztBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHdDQUF3QztBQUM1RTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUIsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RkFBdUYsWUFBWTtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDBEQUEwRDtBQUMxRCxvQkFBb0Isa0NBQWtDO0FBQ3RELHFDQUFxQyxpQ0FBaUM7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0MsZ0JBQWdCLGtDQUFrQztBQUNsRCxpQ0FBaUMsaUNBQWlDO0FBQ2xFLHFEQUFxRCxRQUFRO0FBQzdEO0FBQ0E7QUFDQSx1Q0FBdUMsS0FBSztBQUM1QztBQUNBO0FBQ0EsdUNBQXVDLEtBQUs7QUFDNUM7QUFDQTtBQUNBLHVDQUF1Qyx3QkFBd0I7QUFDL0Q7QUFDQTtBQUNBLHVDQUF1Qyx3QkFBd0I7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLElBQUk7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLG1CQUFtQjtBQUNqRTtBQUNBO0FBQ0EsS0FBSyxJQUFJO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsaUJBQWlCO0FBQzVDLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixLQUFLO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0JBQWdCLEdBQUcsZUFBZTtBQUN6RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLGNBQWMsS0FBSyxNQUFNO0FBQ3hDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0JBQWdCLEdBQUcsV0FBVztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixhQUFhO0FBQ2pDO0FBQ0E7QUFDQSwrQ0FBK0MsV0FBVyxxQkFBcUIsY0FBYyxJQUFJLFdBQVcsR0FBRyxXQUFXLFNBQVMscUJBQXFCLElBQUksV0FBVztBQUN2Syx1QkFBdUIsZUFBZTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLCtCQUErQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVFQUF1RTtBQUN2RTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxjQUFjO0FBQzdCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLCtCQUErQiw2QkFBNkIsSUFBSTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQSxzQkFBc0IsWUFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsbURBQW1ELFlBQVk7QUFDL0Qsb0RBQW9ELFlBQVk7QUFDaEU7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxnREFBZ0Q7QUFDaEQsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdCQUF3QjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksZUFBZTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGVBQWU7QUFDL0I7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBLHlCQUF5QjtBQUN6Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsWUFBWSwwQkFBMEI7QUFDdEM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztB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QUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsbUVBQW1FLG1CQUFtQjtBQUN0Rjs7QUFFQSw2Q0FBNkMsWUFBWTtBQUN6RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EscUVBQXFFLFlBQVk7QUFDakY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRixpQkFBaUI7QUFDbEc7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFD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QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG1EQUFtRCxLQUFLO0FBQ3hEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFFQUFxRTtBQUNyRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGFBQWE7QUFDM0I7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsY0FBYywyQkFBMkI7QUFDekM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLFlBQVkseUJBQXlCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBLDRCQUE0QixrREFBa0Q7QUFDOUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsWUFBWSx5QkFBeUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOLDRCQUE0QixrREFBa0Q7QUFDOUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGlCQUFpQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLGdCQUFnQjs7QUFFL0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLHlCQUF5QixzRUFBc0UsZUFBZTtBQUM3SDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsR0FBRztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGNBQWMsUUFBUTtBQUN0QjtBQUNBO0FBQ0EsZ0JBQWdCLDBDQUEwQztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDRFQUE0RSxZQUFZO0FBQ3hGLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9EQUFvRCxnQ0FBZ0M7QUFDcEY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0IseUJBQXlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCLG1CQUFtQix3QkFBd0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixTQUFTO0FBQzVCLG1CQUFtQixTQUFTO0FBQzVCLHFCQUFxQix3QkFBd0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMLHFEQUFxRCx3QkFBd0IsSUFBSTtBQUNqRjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7O0FBRUEsZ0JBQWdCLG9CQUFvQixJQUFJO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQixTQUFTOztBQUVUO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEIsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGtCQUFrQjtBQUM5QixZQUFZLE9BQU87O0FBRW5CO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCLFVBQVUsOEJBQThCO0FBQ3RFOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EseURBQXlELFFBQVE7QUFDakU7QUFDQSxHQUFHLElBQUksWUFBWTs7QUFFbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUNBQWlDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCO0FBQzlCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLCtDQUErQztBQUN2RTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtB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QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksTUFBTTtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7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O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsV0FBVztBQUM5RDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVCQUF1QixpQkFBaUIsSUFBSSxRQUFRO0FBQ3BEOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDRDQUE0QyxJQUFJOztBQUVoRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNB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QUMsb0JBQW9CLEVBQUVzMkIsV0FBVyxDQUFDLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvIHN5bmMgXFwuanMkIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AaG90d2lyZWQvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzL2Rpc3Qvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AaG90d2lyZWQvc3RpbXVsdXMvZGlzdC9zdGltdWx1cy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGhvdHdpcmVkL3R1cmJvL2Rpc3QvdHVyYm8uZXMyMDE3LWVzbS5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvYWNlLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2Nob3Nlbi1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9jbGlwYm9hcmQtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY29sb3Itc2NoZW1lLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2ltYWdlLXNpemUtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvanVtcC10YXJnZXRzLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2xpbWl0LWhlaWdodC1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9tZXRhd2l6YXJkLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Njcm9sbC1vZmZzZXQtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdGlueW1jZS1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b2dnbGUtZmllbGRzZXQtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9nZ2xlLW5hdmlnYXRpb24tY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9nZ2xlLW5vZGVzLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL3NjcmlwdHMvY29yZS5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvc2NyaXB0cy9saW1pdC1oZWlnaHQuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL3NjcmlwdHMvbW9kdWxld2l6YXJkLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9zY3JpcHRzL21vb3Rhby5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvc2NyaXB0cy9zZWN0aW9ud2l6YXJkLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9zY3JpcHRzL3RpcHMuanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9iYWNrZW5kLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBtYXAgPSB7XG5cdFwiLi9hY2UtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2FjZS1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9jaG9zZW4tY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2Nob3Nlbi1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9jbGlwYm9hcmQtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2NsaXBib2FyZC1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9jb2xvci1zY2hlbWUtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2NvbG9yLXNjaGVtZS1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2p1bXAtdGFyZ2V0cy1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvanVtcC10YXJnZXRzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2xpbWl0LWhlaWdodC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvbGltaXQtaGVpZ2h0LWNvbnRyb2xsZXIuanNcIixcblx0XCIuL21ldGF3aXphcmQtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL21ldGF3aXphcmQtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi90aW55bWNlLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90aW55bWNlLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RvZ2dsZS1maWVsZHNldC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9nZ2xlLWZpZWxkc2V0LWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RvZ2dsZS1uYXZpZ2F0aW9uLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b2dnbGUtbmF2aWdhdGlvbi1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi90b2dnbGUtbm9kZXMtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RvZ2dsZS1ub2Rlcy1jb250cm9sbGVyLmpzXCJcbn07XG5cblxuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHZhciBpZCA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpO1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhpZCk7XG59XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8obWFwLCByZXEpKSB7XG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBtYXBbcmVxXTtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzIHN5bmMgcmVjdXJzaXZlIFxcXFwuanMkXCI7IiwiLypcblN0aW11bHVzIFdlYnBhY2sgSGVscGVycyAxLjAuMFxuQ29weXJpZ2h0IMKpIDIwMjEgQmFzZWNhbXAsIExMQ1xuICovXG5mdW5jdGlvbiBkZWZpbml0aW9uc0Zyb21Db250ZXh0KGNvbnRleHQpIHtcbiAgICByZXR1cm4gY29udGV4dC5rZXlzKClcbiAgICAgICAgLm1hcCgoa2V5KSA9PiBkZWZpbml0aW9uRm9yTW9kdWxlV2l0aENvbnRleHRBbmRLZXkoY29udGV4dCwga2V5KSlcbiAgICAgICAgLmZpbHRlcigodmFsdWUpID0+IHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGRlZmluaXRpb25Gb3JNb2R1bGVXaXRoQ29udGV4dEFuZEtleShjb250ZXh0LCBrZXkpIHtcbiAgICBjb25zdCBpZGVudGlmaWVyID0gaWRlbnRpZmllckZvckNvbnRleHRLZXkoa2V5KTtcbiAgICBpZiAoaWRlbnRpZmllcikge1xuICAgICAgICByZXR1cm4gZGVmaW5pdGlvbkZvck1vZHVsZUFuZElkZW50aWZpZXIoY29udGV4dChrZXkpLCBpZGVudGlmaWVyKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllcihtb2R1bGUsIGlkZW50aWZpZXIpIHtcbiAgICBjb25zdCBjb250cm9sbGVyQ29uc3RydWN0b3IgPSBtb2R1bGUuZGVmYXVsdDtcbiAgICBpZiAodHlwZW9mIGNvbnRyb2xsZXJDb25zdHJ1Y3RvciA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIHsgaWRlbnRpZmllciwgY29udHJvbGxlckNvbnN0cnVjdG9yIH07XG4gICAgfVxufVxuZnVuY3Rpb24gaWRlbnRpZmllckZvckNvbnRleHRLZXkoa2V5KSB7XG4gICAgY29uc3QgbG9naWNhbE5hbWUgPSAoa2V5Lm1hdGNoKC9eKD86XFwuXFwvKT8oLispKD86W18tXWNvbnRyb2xsZXJcXC4uKz8pJC8pIHx8IFtdKVsxXTtcbiAgICBpZiAobG9naWNhbE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGxvZ2ljYWxOYW1lLnJlcGxhY2UoL18vZywgXCItXCIpLnJlcGxhY2UoL1xcLy9nLCBcIi0tXCIpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgZGVmaW5pdGlvbkZvck1vZHVsZUFuZElkZW50aWZpZXIsIGRlZmluaXRpb25Gb3JNb2R1bGVXaXRoQ29udGV4dEFuZEtleSwgZGVmaW5pdGlvbnNGcm9tQ29udGV4dCwgaWRlbnRpZmllckZvckNvbnRleHRLZXkgfTtcbiIsIi8qXG5TdGltdWx1cyAzLjIuMVxuQ29weXJpZ2h0IMKpIDIwMjMgQmFzZWNhbXAsIExMQ1xuICovXG5jbGFzcyBFdmVudExpc3RlbmVyIHtcbiAgICBjb25zdHJ1Y3RvcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0O1xuICAgICAgICB0aGlzLmV2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICAgICAgdGhpcy5ldmVudE9wdGlvbnMgPSBldmVudE9wdGlvbnM7XG4gICAgICAgIHRoaXMudW5vcmRlcmVkQmluZGluZ3MgPSBuZXcgU2V0KCk7XG4gICAgfVxuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgdGhpcywgdGhpcy5ldmVudE9wdGlvbnMpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMsIHRoaXMuZXZlbnRPcHRpb25zKTtcbiAgICB9XG4gICAgYmluZGluZ0Nvbm5lY3RlZChiaW5kaW5nKSB7XG4gICAgICAgIHRoaXMudW5vcmRlcmVkQmluZGluZ3MuYWRkKGJpbmRpbmcpO1xuICAgIH1cbiAgICBiaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcpIHtcbiAgICAgICAgdGhpcy51bm9yZGVyZWRCaW5kaW5ncy5kZWxldGUoYmluZGluZyk7XG4gICAgfVxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGV4dGVuZGVkRXZlbnQgPSBleHRlbmRFdmVudChldmVudCk7XG4gICAgICAgIGZvciAoY29uc3QgYmluZGluZyBvZiB0aGlzLmJpbmRpbmdzKSB7XG4gICAgICAgICAgICBpZiAoZXh0ZW5kZWRFdmVudC5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJpbmRpbmcuaGFuZGxlRXZlbnQoZXh0ZW5kZWRFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFzQmluZGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVub3JkZXJlZEJpbmRpbmdzLnNpemUgPiAwO1xuICAgIH1cbiAgICBnZXQgYmluZGluZ3MoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMudW5vcmRlcmVkQmluZGluZ3MpLnNvcnQoKGxlZnQsIHJpZ2h0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsZWZ0SW5kZXggPSBsZWZ0LmluZGV4LCByaWdodEluZGV4ID0gcmlnaHQuaW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gbGVmdEluZGV4IDwgcmlnaHRJbmRleCA/IC0xIDogbGVmdEluZGV4ID4gcmlnaHRJbmRleCA/IDEgOiAwO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBleHRlbmRFdmVudChldmVudCkge1xuICAgIGlmIChcImltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZFwiIGluIGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHsgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIH0gPSBldmVudDtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZXZlbnQsIHtcbiAgICAgICAgICAgIGltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDogZmFsc2UsXG4gICAgICAgICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbi5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jbGFzcyBEaXNwYXRjaGVyIHtcbiAgICBjb25zdHJ1Y3RvcihhcHBsaWNhdGlvbikge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uID0gYXBwbGljYXRpb247XG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKGV2ZW50TGlzdGVuZXIpID0+IGV2ZW50TGlzdGVuZXIuY29ubmVjdCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoZXZlbnRMaXN0ZW5lcikgPT4gZXZlbnRMaXN0ZW5lci5kaXNjb25uZWN0KCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBldmVudExpc3RlbmVycygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5ldmVudExpc3RlbmVyTWFwcy52YWx1ZXMoKSkucmVkdWNlKChsaXN0ZW5lcnMsIG1hcCkgPT4gbGlzdGVuZXJzLmNvbmNhdChBcnJheS5mcm9tKG1hcC52YWx1ZXMoKSkpLCBbXSk7XG4gICAgfVxuICAgIGJpbmRpbmdDb25uZWN0ZWQoYmluZGluZykge1xuICAgICAgICB0aGlzLmZldGNoRXZlbnRMaXN0ZW5lckZvckJpbmRpbmcoYmluZGluZykuYmluZGluZ0Nvbm5lY3RlZChiaW5kaW5nKTtcbiAgICB9XG4gICAgYmluZGluZ0Rpc2Nvbm5lY3RlZChiaW5kaW5nLCBjbGVhckV2ZW50TGlzdGVuZXJzID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJGb3JCaW5kaW5nKGJpbmRpbmcpLmJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZyk7XG4gICAgICAgIGlmIChjbGVhckV2ZW50TGlzdGVuZXJzKVxuICAgICAgICAgICAgdGhpcy5jbGVhckV2ZW50TGlzdGVuZXJzRm9yQmluZGluZyhiaW5kaW5nKTtcbiAgICB9XG4gICAgaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIGRldGFpbCA9IHt9KSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24uaGFuZGxlRXJyb3IoZXJyb3IsIGBFcnJvciAke21lc3NhZ2V9YCwgZGV0YWlsKTtcbiAgICB9XG4gICAgY2xlYXJFdmVudExpc3RlbmVyc0ZvckJpbmRpbmcoYmluZGluZykge1xuICAgICAgICBjb25zdCBldmVudExpc3RlbmVyID0gdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJGb3JCaW5kaW5nKGJpbmRpbmcpO1xuICAgICAgICBpZiAoIWV2ZW50TGlzdGVuZXIuaGFzQmluZGluZ3MoKSkge1xuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZU1hcHBlZEV2ZW50TGlzdGVuZXJGb3IoYmluZGluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVtb3ZlTWFwcGVkRXZlbnRMaXN0ZW5lckZvcihiaW5kaW5nKSB7XG4gICAgICAgIGNvbnN0IHsgZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zIH0gPSBiaW5kaW5nO1xuICAgICAgICBjb25zdCBldmVudExpc3RlbmVyTWFwID0gdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJNYXBGb3JFdmVudFRhcmdldChldmVudFRhcmdldCk7XG4gICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5jYWNoZUtleShldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIGV2ZW50TGlzdGVuZXJNYXAuZGVsZXRlKGNhY2hlS2V5KTtcbiAgICAgICAgaWYgKGV2ZW50TGlzdGVuZXJNYXAuc2l6ZSA9PSAwKVxuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVyTWFwcy5kZWxldGUoZXZlbnRUYXJnZXQpO1xuICAgIH1cbiAgICBmZXRjaEV2ZW50TGlzdGVuZXJGb3JCaW5kaW5nKGJpbmRpbmcpIHtcbiAgICAgICAgY29uc3QgeyBldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMgfSA9IGJpbmRpbmc7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoRXZlbnRMaXN0ZW5lcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpO1xuICAgIH1cbiAgICBmZXRjaEV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50TGlzdGVuZXJNYXAgPSB0aGlzLmZldGNoRXZlbnRMaXN0ZW5lck1hcEZvckV2ZW50VGFyZ2V0KGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmNhY2hlS2V5KGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICAgICAgbGV0IGV2ZW50TGlzdGVuZXIgPSBldmVudExpc3RlbmVyTWFwLmdldChjYWNoZUtleSk7XG4gICAgICAgIGlmICghZXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lciA9IHRoaXMuY3JlYXRlRXZlbnRMaXN0ZW5lcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpO1xuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lck1hcC5zZXQoY2FjaGVLZXksIGV2ZW50TGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudExpc3RlbmVyO1xuICAgIH1cbiAgICBjcmVhdGVFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgICAgICBjb25zdCBldmVudExpc3RlbmVyID0gbmV3IEV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgZXZlbnRMaXN0ZW5lci5jb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50TGlzdGVuZXI7XG4gICAgfVxuICAgIGZldGNoRXZlbnRMaXN0ZW5lck1hcEZvckV2ZW50VGFyZ2V0KGV2ZW50VGFyZ2V0KSB7XG4gICAgICAgIGxldCBldmVudExpc3RlbmVyTWFwID0gdGhpcy5ldmVudExpc3RlbmVyTWFwcy5nZXQoZXZlbnRUYXJnZXQpO1xuICAgICAgICBpZiAoIWV2ZW50TGlzdGVuZXJNYXApIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXJNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJNYXBzLnNldChldmVudFRhcmdldCwgZXZlbnRMaXN0ZW5lck1hcCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50TGlzdGVuZXJNYXA7XG4gICAgfVxuICAgIGNhY2hlS2V5KGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHBhcnRzID0gW2V2ZW50TmFtZV07XG4gICAgICAgIE9iamVjdC5rZXlzKGV2ZW50T3B0aW9ucylcbiAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgIC5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIHBhcnRzLnB1c2goYCR7ZXZlbnRPcHRpb25zW2tleV0gPyBcIlwiIDogXCIhXCJ9JHtrZXl9YCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcGFydHMuam9pbihcIjpcIik7XG4gICAgfVxufVxuXG5jb25zdCBkZWZhdWx0QWN0aW9uRGVzY3JpcHRvckZpbHRlcnMgPSB7XG4gICAgc3RvcCh7IGV2ZW50LCB2YWx1ZSB9KSB7XG4gICAgICAgIGlmICh2YWx1ZSlcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIHByZXZlbnQoeyBldmVudCwgdmFsdWUgfSkge1xuICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIHNlbGYoeyBldmVudCwgdmFsdWUsIGVsZW1lbnQgfSkge1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50ID09PSBldmVudC50YXJnZXQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuY29uc3QgZGVzY3JpcHRvclBhdHRlcm4gPSAvXig/Oig/OihbXi5dKz8pXFwrKT8oLis/KSg/OlxcLiguKz8pKT8oPzpAKHdpbmRvd3xkb2N1bWVudCkpPy0+KT8oLis/KSg/OiMoW146XSs/KSkoPzo6KC4rKSk/JC87XG5mdW5jdGlvbiBwYXJzZUFjdGlvbkRlc2NyaXB0b3JTdHJpbmcoZGVzY3JpcHRvclN0cmluZykge1xuICAgIGNvbnN0IHNvdXJjZSA9IGRlc2NyaXB0b3JTdHJpbmcudHJpbSgpO1xuICAgIGNvbnN0IG1hdGNoZXMgPSBzb3VyY2UubWF0Y2goZGVzY3JpcHRvclBhdHRlcm4pIHx8IFtdO1xuICAgIGxldCBldmVudE5hbWUgPSBtYXRjaGVzWzJdO1xuICAgIGxldCBrZXlGaWx0ZXIgPSBtYXRjaGVzWzNdO1xuICAgIGlmIChrZXlGaWx0ZXIgJiYgIVtcImtleWRvd25cIiwgXCJrZXl1cFwiLCBcImtleXByZXNzXCJdLmluY2x1ZGVzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgZXZlbnROYW1lICs9IGAuJHtrZXlGaWx0ZXJ9YDtcbiAgICAgICAga2V5RmlsdGVyID0gXCJcIjtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZlbnRUYXJnZXQ6IHBhcnNlRXZlbnRUYXJnZXQobWF0Y2hlc1s0XSksXG4gICAgICAgIGV2ZW50TmFtZSxcbiAgICAgICAgZXZlbnRPcHRpb25zOiBtYXRjaGVzWzddID8gcGFyc2VFdmVudE9wdGlvbnMobWF0Y2hlc1s3XSkgOiB7fSxcbiAgICAgICAgaWRlbnRpZmllcjogbWF0Y2hlc1s1XSxcbiAgICAgICAgbWV0aG9kTmFtZTogbWF0Y2hlc1s2XSxcbiAgICAgICAga2V5RmlsdGVyOiBtYXRjaGVzWzFdIHx8IGtleUZpbHRlcixcbiAgICB9O1xufVxuZnVuY3Rpb24gcGFyc2VFdmVudFRhcmdldChldmVudFRhcmdldE5hbWUpIHtcbiAgICBpZiAoZXZlbnRUYXJnZXROYW1lID09IFwid2luZG93XCIpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdztcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRUYXJnZXROYW1lID09IFwiZG9jdW1lbnRcIikge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VFdmVudE9wdGlvbnMoZXZlbnRPcHRpb25zKSB7XG4gICAgcmV0dXJuIGV2ZW50T3B0aW9uc1xuICAgICAgICAuc3BsaXQoXCI6XCIpXG4gICAgICAgIC5yZWR1Y2UoKG9wdGlvbnMsIHRva2VuKSA9PiBPYmplY3QuYXNzaWduKG9wdGlvbnMsIHsgW3Rva2VuLnJlcGxhY2UoL14hLywgXCJcIildOiAhL14hLy50ZXN0KHRva2VuKSB9KSwge30pO1xufVxuZnVuY3Rpb24gc3RyaW5naWZ5RXZlbnRUYXJnZXQoZXZlbnRUYXJnZXQpIHtcbiAgICBpZiAoZXZlbnRUYXJnZXQgPT0gd2luZG93KSB7XG4gICAgICAgIHJldHVybiBcIndpbmRvd1wiO1xuICAgIH1cbiAgICBlbHNlIGlmIChldmVudFRhcmdldCA9PSBkb2N1bWVudCkge1xuICAgICAgICByZXR1cm4gXCJkb2N1bWVudFwiO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2FtZWxpemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvKD86W18tXSkoW2EtejAtOV0pL2csIChfLCBjaGFyKSA9PiBjaGFyLnRvVXBwZXJDYXNlKCkpO1xufVxuZnVuY3Rpb24gbmFtZXNwYWNlQ2FtZWxpemUodmFsdWUpIHtcbiAgICByZXR1cm4gY2FtZWxpemUodmFsdWUucmVwbGFjZSgvLS0vZywgXCItXCIpLnJlcGxhY2UoL19fL2csIFwiX1wiKSk7XG59XG5mdW5jdGlvbiBjYXBpdGFsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdmFsdWUuc2xpY2UoMSk7XG59XG5mdW5jdGlvbiBkYXNoZXJpemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvKFtBLVpdKS9nLCAoXywgY2hhcikgPT4gYC0ke2NoYXIudG9Mb3dlckNhc2UoKX1gKTtcbn1cbmZ1bmN0aW9uIHRva2VuaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLm1hdGNoKC9bXlxcc10rL2cpIHx8IFtdO1xufVxuXG5mdW5jdGlvbiBpc1NvbWV0aGluZyhvYmplY3QpIHtcbiAgICByZXR1cm4gb2JqZWN0ICE9PSBudWxsICYmIG9iamVjdCAhPT0gdW5kZWZpbmVkO1xufVxuZnVuY3Rpb24gaGFzUHJvcGVydHkob2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7XG59XG5cbmNvbnN0IGFsbE1vZGlmaWVycyA9IFtcIm1ldGFcIiwgXCJjdHJsXCIsIFwiYWx0XCIsIFwic2hpZnRcIl07XG5jbGFzcyBBY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGluZGV4LCBkZXNjcmlwdG9yLCBzY2hlbWEpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZGVzY3JpcHRvci5ldmVudFRhcmdldCB8fCBlbGVtZW50O1xuICAgICAgICB0aGlzLmV2ZW50TmFtZSA9IGRlc2NyaXB0b3IuZXZlbnROYW1lIHx8IGdldERlZmF1bHRFdmVudE5hbWVGb3JFbGVtZW50KGVsZW1lbnQpIHx8IGVycm9yKFwibWlzc2luZyBldmVudCBuYW1lXCIpO1xuICAgICAgICB0aGlzLmV2ZW50T3B0aW9ucyA9IGRlc2NyaXB0b3IuZXZlbnRPcHRpb25zIHx8IHt9O1xuICAgICAgICB0aGlzLmlkZW50aWZpZXIgPSBkZXNjcmlwdG9yLmlkZW50aWZpZXIgfHwgZXJyb3IoXCJtaXNzaW5nIGlkZW50aWZpZXJcIik7XG4gICAgICAgIHRoaXMubWV0aG9kTmFtZSA9IGRlc2NyaXB0b3IubWV0aG9kTmFtZSB8fCBlcnJvcihcIm1pc3NpbmcgbWV0aG9kIG5hbWVcIik7XG4gICAgICAgIHRoaXMua2V5RmlsdGVyID0gZGVzY3JpcHRvci5rZXlGaWx0ZXIgfHwgXCJcIjtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgfVxuICAgIHN0YXRpYyBmb3JUb2tlbih0b2tlbiwgc2NoZW1hKSB7XG4gICAgICAgIHJldHVybiBuZXcgdGhpcyh0b2tlbi5lbGVtZW50LCB0b2tlbi5pbmRleCwgcGFyc2VBY3Rpb25EZXNjcmlwdG9yU3RyaW5nKHRva2VuLmNvbnRlbnQpLCBzY2hlbWEpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgZXZlbnRGaWx0ZXIgPSB0aGlzLmtleUZpbHRlciA/IGAuJHt0aGlzLmtleUZpbHRlcn1gIDogXCJcIjtcbiAgICAgICAgY29uc3QgZXZlbnRUYXJnZXQgPSB0aGlzLmV2ZW50VGFyZ2V0TmFtZSA/IGBAJHt0aGlzLmV2ZW50VGFyZ2V0TmFtZX1gIDogXCJcIjtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuZXZlbnROYW1lfSR7ZXZlbnRGaWx0ZXJ9JHtldmVudFRhcmdldH0tPiR7dGhpcy5pZGVudGlmaWVyfSMke3RoaXMubWV0aG9kTmFtZX1gO1xuICAgIH1cbiAgICBzaG91bGRJZ25vcmVLZXlib2FyZEV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5rZXlGaWx0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWx0ZXJzID0gdGhpcy5rZXlGaWx0ZXIuc3BsaXQoXCIrXCIpO1xuICAgICAgICBpZiAodGhpcy5rZXlGaWx0ZXJEaXNzYXRpc2ZpZWQoZXZlbnQsIGZpbHRlcnMpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdGFuZGFyZEZpbHRlciA9IGZpbHRlcnMuZmlsdGVyKChrZXkpID0+ICFhbGxNb2RpZmllcnMuaW5jbHVkZXMoa2V5KSlbMF07XG4gICAgICAgIGlmICghc3RhbmRhcmRGaWx0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWhhc1Byb3BlcnR5KHRoaXMua2V5TWFwcGluZ3MsIHN0YW5kYXJkRmlsdGVyKSkge1xuICAgICAgICAgICAgZXJyb3IoYGNvbnRhaW5zIHVua25vd24ga2V5IGZpbHRlcjogJHt0aGlzLmtleUZpbHRlcn1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5rZXlNYXBwaW5nc1tzdGFuZGFyZEZpbHRlcl0udG9Mb3dlckNhc2UoKSAhPT0gZXZlbnQua2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuICAgIHNob3VsZElnbm9yZU1vdXNlRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmtleUZpbHRlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpbHRlcnMgPSBbdGhpcy5rZXlGaWx0ZXJdO1xuICAgICAgICBpZiAodGhpcy5rZXlGaWx0ZXJEaXNzYXRpc2ZpZWQoZXZlbnQsIGZpbHRlcnMpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGdldCBwYXJhbXMoKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHt9O1xuICAgICAgICBjb25zdCBwYXR0ZXJuID0gbmV3IFJlZ0V4cChgXmRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LSguKyktcGFyYW0kYCwgXCJpXCIpO1xuICAgICAgICBmb3IgKGNvbnN0IHsgbmFtZSwgdmFsdWUgfSBvZiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5hdHRyaWJ1dGVzKSkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBuYW1lLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gbWF0Y2ggJiYgbWF0Y2hbMV07XG4gICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zW2NhbWVsaXplKGtleSldID0gdHlwZWNhc3QodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgfVxuICAgIGdldCBldmVudFRhcmdldE5hbWUoKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdpZnlFdmVudFRhcmdldCh0aGlzLmV2ZW50VGFyZ2V0KTtcbiAgICB9XG4gICAgZ2V0IGtleU1hcHBpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWEua2V5TWFwcGluZ3M7XG4gICAgfVxuICAgIGtleUZpbHRlckRpc3NhdGlzZmllZChldmVudCwgZmlsdGVycykge1xuICAgICAgICBjb25zdCBbbWV0YSwgY3RybCwgYWx0LCBzaGlmdF0gPSBhbGxNb2RpZmllcnMubWFwKChtb2RpZmllcikgPT4gZmlsdGVycy5pbmNsdWRlcyhtb2RpZmllcikpO1xuICAgICAgICByZXR1cm4gZXZlbnQubWV0YUtleSAhPT0gbWV0YSB8fCBldmVudC5jdHJsS2V5ICE9PSBjdHJsIHx8IGV2ZW50LmFsdEtleSAhPT0gYWx0IHx8IGV2ZW50LnNoaWZ0S2V5ICE9PSBzaGlmdDtcbiAgICB9XG59XG5jb25zdCBkZWZhdWx0RXZlbnROYW1lcyA9IHtcbiAgICBhOiAoKSA9PiBcImNsaWNrXCIsXG4gICAgYnV0dG9uOiAoKSA9PiBcImNsaWNrXCIsXG4gICAgZm9ybTogKCkgPT4gXCJzdWJtaXRcIixcbiAgICBkZXRhaWxzOiAoKSA9PiBcInRvZ2dsZVwiLFxuICAgIGlucHV0OiAoZSkgPT4gKGUuZ2V0QXR0cmlidXRlKFwidHlwZVwiKSA9PSBcInN1Ym1pdFwiID8gXCJjbGlja1wiIDogXCJpbnB1dFwiKSxcbiAgICBzZWxlY3Q6ICgpID0+IFwiY2hhbmdlXCIsXG4gICAgdGV4dGFyZWE6ICgpID0+IFwiaW5wdXRcIixcbn07XG5mdW5jdGlvbiBnZXREZWZhdWx0RXZlbnROYW1lRm9yRWxlbWVudChlbGVtZW50KSB7XG4gICAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICh0YWdOYW1lIGluIGRlZmF1bHRFdmVudE5hbWVzKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0RXZlbnROYW1lc1t0YWdOYW1lXShlbGVtZW50KTtcbiAgICB9XG59XG5mdW5jdGlvbiBlcnJvcihtZXNzYWdlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gdHlwZWNhc3QodmFsdWUpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChvX08pIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbn1cblxuY2xhc3MgQmluZGluZyB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uO1xuICAgIH1cbiAgICBnZXQgaW5kZXgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5pbmRleDtcbiAgICB9XG4gICAgZ2V0IGV2ZW50VGFyZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uZXZlbnRUYXJnZXQ7XG4gICAgfVxuICAgIGdldCBldmVudE9wdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5ldmVudE9wdGlvbnM7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGhhbmRsZUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGFjdGlvbkV2ZW50ID0gdGhpcy5wcmVwYXJlQWN0aW9uRXZlbnQoZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy53aWxsQmVJbnZva2VkQnlFdmVudChldmVudCkgJiYgdGhpcy5hcHBseUV2ZW50TW9kaWZpZXJzKGFjdGlvbkV2ZW50KSkge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VXaXRoRXZlbnQoYWN0aW9uRXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBldmVudE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5ldmVudE5hbWU7XG4gICAgfVxuICAgIGdldCBtZXRob2QoKSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuY29udHJvbGxlclt0aGlzLm1ldGhvZE5hbWVdO1xuICAgICAgICBpZiAodHlwZW9mIG1ldGhvZCA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBtZXRob2Q7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY3Rpb24gXCIke3RoaXMuYWN0aW9ufVwiIHJlZmVyZW5jZXMgdW5kZWZpbmVkIG1ldGhvZCBcIiR7dGhpcy5tZXRob2ROYW1lfVwiYCk7XG4gICAgfVxuICAgIGFwcGx5RXZlbnRNb2RpZmllcnMoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgeyBlbGVtZW50IH0gPSB0aGlzLmFjdGlvbjtcbiAgICAgICAgY29uc3QgeyBhY3Rpb25EZXNjcmlwdG9yRmlsdGVycyB9ID0gdGhpcy5jb250ZXh0LmFwcGxpY2F0aW9uO1xuICAgICAgICBjb25zdCB7IGNvbnRyb2xsZXIgfSA9IHRoaXMuY29udGV4dDtcbiAgICAgICAgbGV0IHBhc3NlcyA9IHRydWU7XG4gICAgICAgIGZvciAoY29uc3QgW25hbWUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLmV2ZW50T3B0aW9ucykpIHtcbiAgICAgICAgICAgIGlmIChuYW1lIGluIGFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyID0gYWN0aW9uRGVzY3JpcHRvckZpbHRlcnNbbmFtZV07XG4gICAgICAgICAgICAgICAgcGFzc2VzID0gcGFzc2VzICYmIGZpbHRlcih7IG5hbWUsIHZhbHVlLCBldmVudCwgZWxlbWVudCwgY29udHJvbGxlciB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXNzZXM7XG4gICAgfVxuICAgIHByZXBhcmVBY3Rpb25FdmVudChldmVudCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihldmVudCwgeyBwYXJhbXM6IHRoaXMuYWN0aW9uLnBhcmFtcyB9KTtcbiAgICB9XG4gICAgaW52b2tlV2l0aEV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0LCBjdXJyZW50VGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMubWV0aG9kLmNhbGwodGhpcy5jb250cm9sbGVyLCBldmVudCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQubG9nRGVidWdBY3Rpdml0eSh0aGlzLm1ldGhvZE5hbWUsIHsgZXZlbnQsIHRhcmdldCwgY3VycmVudFRhcmdldCwgYWN0aW9uOiB0aGlzLm1ldGhvZE5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXIsIGVsZW1lbnQsIGluZGV4IH0gPSB0aGlzO1xuICAgICAgICAgICAgY29uc3QgZGV0YWlsID0geyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50LCBpbmRleCwgZXZlbnQgfTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5oYW5kbGVFcnJvcihlcnJvciwgYGludm9raW5nIGFjdGlvbiBcIiR7dGhpcy5hY3Rpb259XCJgLCBkZXRhaWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdpbGxCZUludm9rZWRCeUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGV2ZW50VGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50ICYmIHRoaXMuYWN0aW9uLnNob3VsZElnbm9yZUtleWJvYXJkRXZlbnQoZXZlbnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgTW91c2VFdmVudCAmJiB0aGlzLmFjdGlvbi5zaG91bGRJZ25vcmVNb3VzZUV2ZW50KGV2ZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChldmVudFRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgdGhpcy5lbGVtZW50LmNvbnRhaW5zKGV2ZW50VGFyZ2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuY29udGFpbnNFbGVtZW50KGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmNvbnRhaW5zRWxlbWVudCh0aGlzLmFjdGlvbi5lbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgY29udHJvbGxlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5jb250cm9sbGVyO1xuICAgIH1cbiAgICBnZXQgbWV0aG9kTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uLm1ldGhvZE5hbWU7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgc2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NvcGU7XG4gICAgfVxufVxuXG5jbGFzcyBFbGVtZW50T2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9O1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLmVsZW1lbnRzID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB0aGlzLnByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKHRoaXMuZWxlbWVudCwgdGhpcy5tdXRhdGlvbk9ic2VydmVySW5pdCk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXVzZShjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKHRoaXMuZWxlbWVudCwgdGhpcy5tdXRhdGlvbk9ic2VydmVySW5pdCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci50YWtlUmVjb3JkcygpO1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBuZXcgU2V0KHRoaXMubWF0Y2hFbGVtZW50c0luVHJlZSgpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudHMpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaGVzLmhhcyhlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIEFycmF5LmZyb20obWF0Y2hlcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbnMpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NNdXRhdGlvbihtdXRhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc011dGF0aW9uKG11dGF0aW9uKSB7XG4gICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09IFwiYXR0cmlidXRlc1wiKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NBdHRyaWJ1dGVDaGFuZ2UobXV0YXRpb24udGFyZ2V0LCBtdXRhdGlvbi5hdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtdXRhdGlvbi50eXBlID09IFwiY2hpbGRMaXN0XCIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc1JlbW92ZWROb2RlcyhtdXRhdGlvbi5yZW1vdmVkTm9kZXMpO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQWRkZWROb2RlcyhtdXRhdGlvbi5hZGRlZE5vZGVzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzQXR0cmlidXRlQ2hhbmdlKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5lbGVtZW50QXR0cmlidXRlQ2hhbmdlZCAmJiB0aGlzLm1hdGNoRWxlbWVudChlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudEF0dHJpYnV0ZUNoYW5nZWQoZWxlbWVudCwgYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5tYXRjaEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzUmVtb3ZlZE5vZGVzKG5vZGVzKSB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBBcnJheS5mcm9tKG5vZGVzKSkge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudEZyb21Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NUcmVlKGVsZW1lbnQsIHRoaXMucmVtb3ZlRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc0FkZGVkTm9kZXMobm9kZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIEFycmF5LmZyb20obm9kZXMpKSB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbGVtZW50RnJvbU5vZGUobm9kZSk7XG4gICAgICAgICAgICBpZiAoZWxlbWVudCAmJiB0aGlzLmVsZW1lbnRJc0FjdGl2ZShlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc1RyZWUoZWxlbWVudCwgdGhpcy5hZGRFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBtYXRjaEVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5tYXRjaEVsZW1lbnQoZWxlbWVudCk7XG4gICAgfVxuICAgIG1hdGNoRWxlbWVudHNJblRyZWUodHJlZSA9IHRoaXMuZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5tYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUpO1xuICAgIH1cbiAgICBwcm9jZXNzVHJlZSh0cmVlLCBwcm9jZXNzb3IpIHtcbiAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMubWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlKSkge1xuICAgICAgICAgICAgcHJvY2Vzc29yLmNhbGwodGhpcywgZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudEZyb21Ob2RlKG5vZGUpIHtcbiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRJc0FjdGl2ZShlbGVtZW50KSB7XG4gICAgICAgIGlmIChlbGVtZW50LmlzQ29ubmVjdGVkICE9IHRoaXMuZWxlbWVudC5pc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5jb250YWlucyhlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhZGRFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudElzQWN0aXZlKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5hZGQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudE1hdGNoZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50TWF0Y2hlZChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVtb3ZlRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5kZWxldGUoZWxlbWVudCk7XG4gICAgICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5lbGVtZW50VW5tYXRjaGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50VW5tYXRjaGVkKGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBBdHRyaWJ1dGVPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVOYW1lID0gYXR0cmlidXRlTmFtZTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlciA9IG5ldyBFbGVtZW50T2JzZXJ2ZXIoZWxlbWVudCwgdGhpcyk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50T2JzZXJ2ZXIuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IHNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gYFske3RoaXMuYXR0cmlidXRlTmFtZX1dYDtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHBhdXNlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnBhdXNlKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RhcnRlZDtcbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQuaGFzQXR0cmlidXRlKHRoaXMuYXR0cmlidXRlTmFtZSk7XG4gICAgfVxuICAgIG1hdGNoRWxlbWVudHNJblRyZWUodHJlZSkge1xuICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMubWF0Y2hFbGVtZW50KHRyZWUpID8gW3RyZWVdIDogW107XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBBcnJheS5mcm9tKHRyZWUucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yKSk7XG4gICAgICAgIHJldHVybiBtYXRjaC5jb25jYXQobWF0Y2hlcyk7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudE1hdGNoZWRBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudE1hdGNoZWRBdHRyaWJ1dGUoZWxlbWVudCwgdGhpcy5hdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZEF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50VW5tYXRjaGVkQXR0cmlidXRlKGVsZW1lbnQsIHRoaXMuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudEF0dHJpYnV0ZUNoYW5nZWQoZWxlbWVudCwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5lbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkICYmIHRoaXMuYXR0cmlidXRlTmFtZSA9PSBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRBdHRyaWJ1dGVWYWx1ZUNoYW5nZWQoZWxlbWVudCwgYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGFkZChtYXAsIGtleSwgdmFsdWUpIHtcbiAgICBmZXRjaChtYXAsIGtleSkuYWRkKHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGRlbChtYXAsIGtleSwgdmFsdWUpIHtcbiAgICBmZXRjaChtYXAsIGtleSkuZGVsZXRlKHZhbHVlKTtcbiAgICBwcnVuZShtYXAsIGtleSk7XG59XG5mdW5jdGlvbiBmZXRjaChtYXAsIGtleSkge1xuICAgIGxldCB2YWx1ZXMgPSBtYXAuZ2V0KGtleSk7XG4gICAgaWYgKCF2YWx1ZXMpIHtcbiAgICAgICAgdmFsdWVzID0gbmV3IFNldCgpO1xuICAgICAgICBtYXAuc2V0KGtleSwgdmFsdWVzKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlcztcbn1cbmZ1bmN0aW9uIHBydW5lKG1hcCwga2V5KSB7XG4gICAgY29uc3QgdmFsdWVzID0gbWFwLmdldChrZXkpO1xuICAgIGlmICh2YWx1ZXMgIT0gbnVsbCAmJiB2YWx1ZXMuc2l6ZSA9PSAwKSB7XG4gICAgICAgIG1hcC5kZWxldGUoa2V5KTtcbiAgICB9XG59XG5cbmNsYXNzIE11bHRpbWFwIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy52YWx1ZXNCeUtleSA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZ2V0IGtleXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkua2V5cygpKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlcygpIHtcbiAgICAgICAgY29uc3Qgc2V0cyA9IEFycmF5LmZyb20odGhpcy52YWx1ZXNCeUtleS52YWx1ZXMoKSk7XG4gICAgICAgIHJldHVybiBzZXRzLnJlZHVjZSgodmFsdWVzLCBzZXQpID0+IHZhbHVlcy5jb25jYXQoQXJyYXkuZnJvbShzZXQpKSwgW10pO1xuICAgIH1cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgY29uc3Qgc2V0cyA9IEFycmF5LmZyb20odGhpcy52YWx1ZXNCeUtleS52YWx1ZXMoKSk7XG4gICAgICAgIHJldHVybiBzZXRzLnJlZHVjZSgoc2l6ZSwgc2V0KSA9PiBzaXplICsgc2V0LnNpemUsIDApO1xuICAgIH1cbiAgICBhZGQoa2V5LCB2YWx1ZSkge1xuICAgICAgICBhZGQodGhpcy52YWx1ZXNCeUtleSwga2V5LCB2YWx1ZSk7XG4gICAgfVxuICAgIGRlbGV0ZShrZXksIHZhbHVlKSB7XG4gICAgICAgIGRlbCh0aGlzLnZhbHVlc0J5S2V5LCBrZXksIHZhbHVlKTtcbiAgICB9XG4gICAgaGFzKGtleSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy52YWx1ZXNCeUtleS5nZXQoa2V5KTtcbiAgICAgICAgcmV0dXJuIHZhbHVlcyAhPSBudWxsICYmIHZhbHVlcy5oYXModmFsdWUpO1xuICAgIH1cbiAgICBoYXNLZXkoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlc0J5S2V5LmhhcyhrZXkpO1xuICAgIH1cbiAgICBoYXNWYWx1ZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBzZXRzID0gQXJyYXkuZnJvbSh0aGlzLnZhbHVlc0J5S2V5LnZhbHVlcygpKTtcbiAgICAgICAgcmV0dXJuIHNldHMuc29tZSgoc2V0KSA9PiBzZXQuaGFzKHZhbHVlKSk7XG4gICAgfVxuICAgIGdldFZhbHVlc0ZvcktleShrZXkpIHtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy52YWx1ZXNCeUtleS5nZXQoa2V5KTtcbiAgICAgICAgcmV0dXJuIHZhbHVlcyA/IEFycmF5LmZyb20odmFsdWVzKSA6IFtdO1xuICAgIH1cbiAgICBnZXRLZXlzRm9yVmFsdWUodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy52YWx1ZXNCeUtleSlcbiAgICAgICAgICAgIC5maWx0ZXIoKFtfa2V5LCB2YWx1ZXNdKSA9PiB2YWx1ZXMuaGFzKHZhbHVlKSlcbiAgICAgICAgICAgIC5tYXAoKFtrZXksIF92YWx1ZXNdKSA9PiBrZXkpO1xuICAgIH1cbn1cblxuY2xhc3MgSW5kZXhlZE11bHRpbWFwIGV4dGVuZHMgTXVsdGltYXAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmtleXNCeVZhbHVlID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBnZXQgdmFsdWVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmtleXNCeVZhbHVlLmtleXMoKSk7XG4gICAgfVxuICAgIGFkZChrZXksIHZhbHVlKSB7XG4gICAgICAgIHN1cGVyLmFkZChrZXksIHZhbHVlKTtcbiAgICAgICAgYWRkKHRoaXMua2V5c0J5VmFsdWUsIHZhbHVlLCBrZXkpO1xuICAgIH1cbiAgICBkZWxldGUoa2V5LCB2YWx1ZSkge1xuICAgICAgICBzdXBlci5kZWxldGUoa2V5LCB2YWx1ZSk7XG4gICAgICAgIGRlbCh0aGlzLmtleXNCeVZhbHVlLCB2YWx1ZSwga2V5KTtcbiAgICB9XG4gICAgaGFzVmFsdWUodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5c0J5VmFsdWUuaGFzKHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0S2V5c0ZvclZhbHVlKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHNldCA9IHRoaXMua2V5c0J5VmFsdWUuZ2V0KHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHNldCA/IEFycmF5LmZyb20oc2V0KSA6IFtdO1xuICAgIH1cbn1cblxuY2xhc3MgU2VsZWN0b3JPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgc2VsZWN0b3IsIGRlbGVnYXRlLCBkZXRhaWxzKSB7XG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyID0gbmV3IEVsZW1lbnRPYnNlcnZlcihlbGVtZW50LCB0aGlzKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQgPSBuZXcgTXVsdGltYXAoKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0b3IoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3RvcjtcbiAgICB9XG4gICAgc2V0IHNlbGVjdG9yKHNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIucGF1c2UoY2FsbGJhY2spO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRPYnNlcnZlci5lbGVtZW50O1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCB7IHNlbGVjdG9yIH0gPSB0aGlzO1xuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBlbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc2VsZWN0b3JNYXRjaEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlcyAmJiB0aGlzLmRlbGVnYXRlLnNlbGVjdG9yTWF0Y2hFbGVtZW50KGVsZW1lbnQsIHRoaXMuZGV0YWlscyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBtYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUpIHtcbiAgICAgICAgY29uc3QgeyBzZWxlY3RvciB9ID0gdGhpcztcbiAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMubWF0Y2hFbGVtZW50KHRyZWUpID8gW3RyZWVdIDogW107XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gQXJyYXkuZnJvbSh0cmVlLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKS5maWx0ZXIoKG1hdGNoKSA9PiB0aGlzLm1hdGNoRWxlbWVudChtYXRjaCkpO1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoLmNvbmNhdChtYXRjaGVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50TWF0Y2hlZChlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0b3IgfSA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rvck1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCBzZWxlY3RvcnMgPSB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuZ2V0S2V5c0ZvclZhbHVlKGVsZW1lbnQpO1xuICAgICAgICBmb3IgKGNvbnN0IHNlbGVjdG9yIG9mIHNlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBzZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudEF0dHJpYnV0ZUNoYW5nZWQoZWxlbWVudCwgX2F0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3QgeyBzZWxlY3RvciB9ID0gdGhpcztcbiAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gdGhpcy5tYXRjaEVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVkQmVmb3JlID0gdGhpcy5tYXRjaGVzQnlFbGVtZW50LmhhcyhzZWxlY3RvciwgZWxlbWVudCk7XG4gICAgICAgICAgICBpZiAobWF0Y2hlcyAmJiAhbWF0Y2hlZEJlZm9yZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFtYXRjaGVzICYmIG1hdGNoZWRCZWZvcmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdG9yVW5tYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3Rvck1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zZWxlY3Rvck1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IsIHRoaXMuZGV0YWlscyk7XG4gICAgICAgIHRoaXMubWF0Y2hlc0J5RWxlbWVudC5hZGQoc2VsZWN0b3IsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBzZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBzZWxlY3Rvcikge1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnNlbGVjdG9yVW5tYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yLCB0aGlzLmRldGFpbHMpO1xuICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuZGVsZXRlKHNlbGVjdG9yLCBlbGVtZW50KTtcbiAgICB9XG59XG5cbmNsYXNzIFN0cmluZ01hcE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0cmluZ01hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4gdGhpcy5wcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHsgYXR0cmlidXRlczogdHJ1ZSwgYXR0cmlidXRlT2xkVmFsdWU6IHRydWUgfSk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZU5hbWUgb2YgdGhpcy5rbm93bkF0dHJpYnV0ZU5hbWVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzTXV0YXRpb24obXV0YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbihtdXRhdGlvbikge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gbXV0YXRpb24uYXR0cmlidXRlTmFtZTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCBtdXRhdGlvbi5vbGRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVmcmVzaEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSkge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLmRlbGVnYXRlLmdldFN0cmluZ01hcEtleUZvckF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKGtleSAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc3RyaW5nTWFwLmhhcyhhdHRyaWJ1dGVOYW1lKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RyaW5nTWFwS2V5QWRkZWQoa2V5LCBhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0cmluZ01hcC5nZXQoYXR0cmlidXRlTmFtZSkgIT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcFZhbHVlQ2hhbmdlZCh2YWx1ZSwga2V5LCBvbGRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5zdHJpbmdNYXAuZ2V0KGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RyaW5nTWFwLmRlbGV0ZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAob2xkVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RyaW5nTWFwS2V5UmVtb3ZlZChrZXksIGF0dHJpYnV0ZU5hbWUsIG9sZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RyaW5nTWFwLnNldChhdHRyaWJ1dGVOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RyaW5nTWFwS2V5QWRkZWQoa2V5LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLnN0cmluZ01hcEtleUFkZGVkKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLnN0cmluZ01hcEtleUFkZGVkKGtleSwgYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RyaW5nTWFwVmFsdWVDaGFuZ2VkKHZhbHVlLCBrZXksIG9sZFZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLnN0cmluZ01hcFZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBWYWx1ZUNoYW5nZWQodmFsdWUsIGtleSwgb2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcEtleVJlbW92ZWQoa2V5LCBhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlSZW1vdmVkKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLnN0cmluZ01hcEtleVJlbW92ZWQoa2V5LCBhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGtub3duQXR0cmlidXRlTmFtZXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQodGhpcy5jdXJyZW50QXR0cmlidXRlTmFtZXMuY29uY2F0KHRoaXMucmVjb3JkZWRBdHRyaWJ1dGVOYW1lcykpKTtcbiAgICB9XG4gICAgZ2V0IGN1cnJlbnRBdHRyaWJ1dGVOYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5lbGVtZW50LmF0dHJpYnV0ZXMpLm1hcCgoYXR0cmlidXRlKSA9PiBhdHRyaWJ1dGUubmFtZSk7XG4gICAgfVxuICAgIGdldCByZWNvcmRlZEF0dHJpYnV0ZU5hbWVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnN0cmluZ01hcC5rZXlzKCkpO1xuICAgIH1cbn1cblxuY2xhc3MgVG9rZW5MaXN0T2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIgPSBuZXcgQXR0cmlidXRlT2JzZXJ2ZXIoZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy50b2tlbnNCeUVsZW1lbnQgPSBuZXcgTXVsdGltYXAoKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLnN0YXJ0ZWQ7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHBhdXNlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIucGF1c2UoY2FsbGJhY2spO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgYXR0cmlidXRlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIuYXR0cmlidXRlTmFtZTtcbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWRBdHRyaWJ1dGUoZWxlbWVudCkge1xuICAgICAgICB0aGlzLnRva2Vuc01hdGNoZWQodGhpcy5yZWFkVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KSk7XG4gICAgfVxuICAgIGVsZW1lbnRBdHRyaWJ1dGVWYWx1ZUNoYW5nZWQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCBbdW5tYXRjaGVkVG9rZW5zLCBtYXRjaGVkVG9rZW5zXSA9IHRoaXMucmVmcmVzaFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgIHRoaXMudG9rZW5zVW5tYXRjaGVkKHVubWF0Y2hlZFRva2Vucyk7XG4gICAgICAgIHRoaXMudG9rZW5zTWF0Y2hlZChtYXRjaGVkVG9rZW5zKTtcbiAgICB9XG4gICAgZWxlbWVudFVubWF0Y2hlZEF0dHJpYnV0ZShlbGVtZW50KSB7XG4gICAgICAgIHRoaXMudG9rZW5zVW5tYXRjaGVkKHRoaXMudG9rZW5zQnlFbGVtZW50LmdldFZhbHVlc0ZvcktleShlbGVtZW50KSk7XG4gICAgfVxuICAgIHRva2Vuc01hdGNoZWQodG9rZW5zKSB7XG4gICAgICAgIHRva2Vucy5mb3JFYWNoKCh0b2tlbikgPT4gdGhpcy50b2tlbk1hdGNoZWQodG9rZW4pKTtcbiAgICB9XG4gICAgdG9rZW5zVW5tYXRjaGVkKHRva2Vucykge1xuICAgICAgICB0b2tlbnMuZm9yRWFjaCgodG9rZW4pID0+IHRoaXMudG9rZW5Vbm1hdGNoZWQodG9rZW4pKTtcbiAgICB9XG4gICAgdG9rZW5NYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudG9rZW5NYXRjaGVkKHRva2VuKTtcbiAgICAgICAgdGhpcy50b2tlbnNCeUVsZW1lbnQuYWRkKHRva2VuLmVsZW1lbnQsIHRva2VuKTtcbiAgICB9XG4gICAgdG9rZW5Vbm1hdGNoZWQodG9rZW4pIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS50b2tlblVubWF0Y2hlZCh0b2tlbik7XG4gICAgICAgIHRoaXMudG9rZW5zQnlFbGVtZW50LmRlbGV0ZSh0b2tlbi5lbGVtZW50LCB0b2tlbik7XG4gICAgfVxuICAgIHJlZnJlc2hUb2tlbnNGb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgcHJldmlvdXNUb2tlbnMgPSB0aGlzLnRva2Vuc0J5RWxlbWVudC5nZXRWYWx1ZXNGb3JLZXkoZWxlbWVudCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUb2tlbnMgPSB0aGlzLnJlYWRUb2tlbnNGb3JFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICBjb25zdCBmaXJzdERpZmZlcmluZ0luZGV4ID0gemlwKHByZXZpb3VzVG9rZW5zLCBjdXJyZW50VG9rZW5zKS5maW5kSW5kZXgoKFtwcmV2aW91c1Rva2VuLCBjdXJyZW50VG9rZW5dKSA9PiAhdG9rZW5zQXJlRXF1YWwocHJldmlvdXNUb2tlbiwgY3VycmVudFRva2VuKSk7XG4gICAgICAgIGlmIChmaXJzdERpZmZlcmluZ0luZGV4ID09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gW1tdLCBbXV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW3ByZXZpb3VzVG9rZW5zLnNsaWNlKGZpcnN0RGlmZmVyaW5nSW5kZXgpLCBjdXJyZW50VG9rZW5zLnNsaWNlKGZpcnN0RGlmZmVyaW5nSW5kZXgpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWFkVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgIGNvbnN0IHRva2VuU3RyaW5nID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkgfHwgXCJcIjtcbiAgICAgICAgcmV0dXJuIHBhcnNlVG9rZW5TdHJpbmcodG9rZW5TdHJpbmcsIGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlVG9rZW5TdHJpbmcodG9rZW5TdHJpbmcsIGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICByZXR1cm4gdG9rZW5TdHJpbmdcbiAgICAgICAgLnRyaW0oKVxuICAgICAgICAuc3BsaXQoL1xccysvKVxuICAgICAgICAuZmlsdGVyKChjb250ZW50KSA9PiBjb250ZW50Lmxlbmd0aClcbiAgICAgICAgLm1hcCgoY29udGVudCwgaW5kZXgpID0+ICh7IGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIGNvbnRlbnQsIGluZGV4IH0pKTtcbn1cbmZ1bmN0aW9uIHppcChsZWZ0LCByaWdodCkge1xuICAgIGNvbnN0IGxlbmd0aCA9IE1hdGgubWF4KGxlZnQubGVuZ3RoLCByaWdodC5sZW5ndGgpO1xuICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoIH0sIChfLCBpbmRleCkgPT4gW2xlZnRbaW5kZXhdLCByaWdodFtpbmRleF1dKTtcbn1cbmZ1bmN0aW9uIHRva2Vuc0FyZUVxdWFsKGxlZnQsIHJpZ2h0KSB7XG4gICAgcmV0dXJuIGxlZnQgJiYgcmlnaHQgJiYgbGVmdC5pbmRleCA9PSByaWdodC5pbmRleCAmJiBsZWZ0LmNvbnRlbnQgPT0gcmlnaHQuY29udGVudDtcbn1cblxuY2xhc3MgVmFsdWVMaXN0T2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIgPSBuZXcgVG9rZW5MaXN0T2JzZXJ2ZXIoZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5wYXJzZVJlc3VsdHNCeVRva2VuID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgICAgdGhpcy52YWx1ZXNCeVRva2VuQnlFbGVtZW50ID0gbmV3IFdlYWtNYXAoKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnN0YXJ0ZWQ7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuTGlzdE9ic2VydmVyLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBhdHRyaWJ1dGVOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbkxpc3RPYnNlcnZlci5hdHRyaWJ1dGVOYW1lO1xuICAgIH1cbiAgICB0b2tlbk1hdGNoZWQodG9rZW4pIHtcbiAgICAgICAgY29uc3QgeyBlbGVtZW50IH0gPSB0b2tlbjtcbiAgICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gdGhpcy5mZXRjaFBhcnNlUmVzdWx0Rm9yVG9rZW4odG9rZW4pO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hWYWx1ZXNCeVRva2VuRm9yRWxlbWVudChlbGVtZW50KS5zZXQodG9rZW4sIHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudE1hdGNoZWRWYWx1ZShlbGVtZW50LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9rZW5Vbm1hdGNoZWQodG9rZW4pIHtcbiAgICAgICAgY29uc3QgeyBlbGVtZW50IH0gPSB0b2tlbjtcbiAgICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gdGhpcy5mZXRjaFBhcnNlUmVzdWx0Rm9yVG9rZW4odG9rZW4pO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hWYWx1ZXNCeVRva2VuRm9yRWxlbWVudChlbGVtZW50KS5kZWxldGUodG9rZW4pO1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50VW5tYXRjaGVkVmFsdWUoZWxlbWVudCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZldGNoUGFyc2VSZXN1bHRGb3JUb2tlbih0b2tlbikge1xuICAgICAgICBsZXQgcGFyc2VSZXN1bHQgPSB0aGlzLnBhcnNlUmVzdWx0c0J5VG9rZW4uZ2V0KHRva2VuKTtcbiAgICAgICAgaWYgKCFwYXJzZVJlc3VsdCkge1xuICAgICAgICAgICAgcGFyc2VSZXN1bHQgPSB0aGlzLnBhcnNlVG9rZW4odG9rZW4pO1xuICAgICAgICAgICAgdGhpcy5wYXJzZVJlc3VsdHNCeVRva2VuLnNldCh0b2tlbiwgcGFyc2VSZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJzZVJlc3VsdDtcbiAgICB9XG4gICAgZmV0Y2hWYWx1ZXNCeVRva2VuRm9yRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGxldCB2YWx1ZXNCeVRva2VuID0gdGhpcy52YWx1ZXNCeVRva2VuQnlFbGVtZW50LmdldChlbGVtZW50KTtcbiAgICAgICAgaWYgKCF2YWx1ZXNCeVRva2VuKSB7XG4gICAgICAgICAgICB2YWx1ZXNCeVRva2VuID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZXNCeVRva2VuQnlFbGVtZW50LnNldChlbGVtZW50LCB2YWx1ZXNCeVRva2VuKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWVzQnlUb2tlbjtcbiAgICB9XG4gICAgcGFyc2VUb2tlbih0b2tlbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmRlbGVnYXRlLnBhcnNlVmFsdWVGb3JUb2tlbih0b2tlbik7XG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIHsgZXJyb3IgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgQmluZGluZ09ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMuYmluZGluZ3NCeUFjdGlvbiA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICghdGhpcy52YWx1ZUxpc3RPYnNlcnZlcikge1xuICAgICAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlciA9IG5ldyBWYWx1ZUxpc3RPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMuYWN0aW9uQXR0cmlidXRlLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy52YWx1ZUxpc3RPYnNlcnZlcikge1xuICAgICAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy52YWx1ZUxpc3RPYnNlcnZlcjtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdEFsbEFjdGlvbnMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgYWN0aW9uQXR0cmlidXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWEuYWN0aW9uQXR0cmlidXRlO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGJpbmRpbmdzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmJpbmRpbmdzQnlBY3Rpb24udmFsdWVzKCkpO1xuICAgIH1cbiAgICBjb25uZWN0QWN0aW9uKGFjdGlvbikge1xuICAgICAgICBjb25zdCBiaW5kaW5nID0gbmV3IEJpbmRpbmcodGhpcy5jb250ZXh0LCBhY3Rpb24pO1xuICAgICAgICB0aGlzLmJpbmRpbmdzQnlBY3Rpb24uc2V0KGFjdGlvbiwgYmluZGluZyk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUuYmluZGluZ0Nvbm5lY3RlZChiaW5kaW5nKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgY29uc3QgYmluZGluZyA9IHRoaXMuYmluZGluZ3NCeUFjdGlvbi5nZXQoYWN0aW9uKTtcbiAgICAgICAgaWYgKGJpbmRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuYmluZGluZ3NCeUFjdGlvbi5kZWxldGUoYWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuYmluZGluZ0Rpc2Nvbm5lY3RlZChiaW5kaW5nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0QWxsQWN0aW9ucygpIHtcbiAgICAgICAgdGhpcy5iaW5kaW5ncy5mb3JFYWNoKChiaW5kaW5nKSA9PiB0aGlzLmRlbGVnYXRlLmJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZywgdHJ1ZSkpO1xuICAgICAgICB0aGlzLmJpbmRpbmdzQnlBY3Rpb24uY2xlYXIoKTtcbiAgICB9XG4gICAgcGFyc2VWYWx1ZUZvclRva2VuKHRva2VuKSB7XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IEFjdGlvbi5mb3JUb2tlbih0b2tlbiwgdGhpcy5zY2hlbWEpO1xuICAgICAgICBpZiAoYWN0aW9uLmlkZW50aWZpZXIgPT0gdGhpcy5pZGVudGlmaWVyKSB7XG4gICAgICAgICAgICByZXR1cm4gYWN0aW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkVmFsdWUoZWxlbWVudCwgYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdEFjdGlvbihhY3Rpb24pO1xuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkVmFsdWUoZWxlbWVudCwgYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdEFjdGlvbihhY3Rpb24pO1xuICAgIH1cbn1cblxuY2xhc3MgVmFsdWVPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5yZWNlaXZlciA9IHJlY2VpdmVyO1xuICAgICAgICB0aGlzLnN0cmluZ01hcE9ic2VydmVyID0gbmV3IFN0cmluZ01hcE9ic2VydmVyKHRoaXMuZWxlbWVudCwgdGhpcyk7XG4gICAgICAgIHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwID0gdGhpcy5jb250cm9sbGVyLnZhbHVlRGVzY3JpcHRvck1hcDtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuc3RyaW5nTWFwT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2tzRm9yRGVmYXVsdFZhbHVlcygpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnN0cmluZ01hcE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuY29udHJvbGxlcjtcbiAgICB9XG4gICAgZ2V0U3RyaW5nTWFwS2V5Rm9yQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZU5hbWUgaW4gdGhpcy52YWx1ZURlc2NyaXB0b3JNYXApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcFthdHRyaWJ1dGVOYW1lXS5uYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcEtleUFkZGVkKGtleSwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JNYXBbYXR0cmlidXRlTmFtZV07XG4gICAgICAgIGlmICghdGhpcy5oYXNWYWx1ZShrZXkpKSB7XG4gICAgICAgICAgICB0aGlzLmludm9rZUNoYW5nZWRDYWxsYmFjayhrZXksIGRlc2NyaXB0b3Iud3JpdGVyKHRoaXMucmVjZWl2ZXJba2V5XSksIGRlc2NyaXB0b3Iud3JpdGVyKGRlc2NyaXB0b3IuZGVmYXVsdFZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RyaW5nTWFwVmFsdWVDaGFuZ2VkKHZhbHVlLCBuYW1lLCBvbGRWYWx1ZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JOYW1lTWFwW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChvbGRWYWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgb2xkVmFsdWUgPSBkZXNjcmlwdG9yLndyaXRlcihkZXNjcmlwdG9yLmRlZmF1bHRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2sobmFtZSwgdmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9XG4gICAgc3RyaW5nTWFwS2V5UmVtb3ZlZChrZXksIGF0dHJpYnV0ZU5hbWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck5hbWVNYXBba2V5XTtcbiAgICAgICAgaWYgKHRoaXMuaGFzVmFsdWUoa2V5KSkge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2soa2V5LCBkZXNjcmlwdG9yLndyaXRlcih0aGlzLnJlY2VpdmVyW2tleV0pLCBvbGRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmludm9rZUNoYW5nZWRDYWxsYmFjayhrZXksIGRlc2NyaXB0b3Iud3JpdGVyKGRlc2NyaXB0b3IuZGVmYXVsdFZhbHVlKSwgb2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGludm9rZUNoYW5nZWRDYWxsYmFja3NGb3JEZWZhdWx0VmFsdWVzKCkge1xuICAgICAgICBmb3IgKGNvbnN0IHsga2V5LCBuYW1lLCBkZWZhdWx0VmFsdWUsIHdyaXRlciB9IG9mIHRoaXMudmFsdWVEZXNjcmlwdG9ycykge1xuICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZSAhPSB1bmRlZmluZWQgJiYgIXRoaXMuY29udHJvbGxlci5kYXRhLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2sobmFtZSwgd3JpdGVyKGRlZmF1bHRWYWx1ZSksIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW52b2tlQ2hhbmdlZENhbGxiYWNrKG5hbWUsIHJhd1ZhbHVlLCByYXdPbGRWYWx1ZSkge1xuICAgICAgICBjb25zdCBjaGFuZ2VkTWV0aG9kTmFtZSA9IGAke25hbWV9Q2hhbmdlZGA7XG4gICAgICAgIGNvbnN0IGNoYW5nZWRNZXRob2QgPSB0aGlzLnJlY2VpdmVyW2NoYW5nZWRNZXRob2ROYW1lXTtcbiAgICAgICAgaWYgKHR5cGVvZiBjaGFuZ2VkTWV0aG9kID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTmFtZU1hcFtuYW1lXTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBkZXNjcmlwdG9yLnJlYWRlcihyYXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgbGV0IG9sZFZhbHVlID0gcmF3T2xkVmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHJhd09sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlID0gZGVzY3JpcHRvci5yZWFkZXIocmF3T2xkVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjaGFuZ2VkTWV0aG9kLmNhbGwodGhpcy5yZWNlaXZlciwgdmFsdWUsIG9sZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFR5cGVFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlID0gYFN0aW11bHVzIFZhbHVlIFwiJHt0aGlzLmNvbnRleHQuaWRlbnRpZmllcn0uJHtkZXNjcmlwdG9yLm5hbWV9XCIgLSAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHZhbHVlRGVzY3JpcHRvcnMoKSB7XG4gICAgICAgIGNvbnN0IHsgdmFsdWVEZXNjcmlwdG9yTWFwIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModmFsdWVEZXNjcmlwdG9yTWFwKS5tYXAoKGtleSkgPT4gdmFsdWVEZXNjcmlwdG9yTWFwW2tleV0pO1xuICAgIH1cbiAgICBnZXQgdmFsdWVEZXNjcmlwdG9yTmFtZU1hcCgpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvcnMgPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy52YWx1ZURlc2NyaXB0b3JNYXApLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwW2tleV07XG4gICAgICAgICAgICBkZXNjcmlwdG9yc1tkZXNjcmlwdG9yLm5hbWVdID0gZGVzY3JpcHRvcjtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9ycztcbiAgICB9XG4gICAgaGFzVmFsdWUoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JOYW1lTWFwW2F0dHJpYnV0ZU5hbWVdO1xuICAgICAgICBjb25zdCBoYXNNZXRob2ROYW1lID0gYGhhcyR7Y2FwaXRhbGl6ZShkZXNjcmlwdG9yLm5hbWUpfWA7XG4gICAgICAgIHJldHVybiB0aGlzLnJlY2VpdmVyW2hhc01ldGhvZE5hbWVdO1xuICAgIH1cbn1cblxuY2xhc3MgVGFyZ2V0T2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy50YXJnZXRzQnlOYW1lID0gbmV3IE11bHRpbWFwKCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIgPSBuZXcgVG9rZW5MaXN0T2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLmF0dHJpYnV0ZU5hbWUsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIGlmICh0aGlzLnRva2VuTGlzdE9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBbGxUYXJnZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnN0b3AoKTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRva2VuTGlzdE9ic2VydmVyO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRva2VuTWF0Y2hlZCh7IGVsZW1lbnQsIGNvbnRlbnQ6IG5hbWUgfSkge1xuICAgICAgICBpZiAodGhpcy5zY29wZS5jb250YWluc0VsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdFRhcmdldChlbGVtZW50LCBuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b2tlblVubWF0Y2hlZCh7IGVsZW1lbnQsIGNvbnRlbnQ6IG5hbWUgfSkge1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSk7XG4gICAgfVxuICAgIGNvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICghdGhpcy50YXJnZXRzQnlOYW1lLmhhcyhuYW1lLCBlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXRzQnlOYW1lLmFkZChuYW1lLCBlbGVtZW50KTtcbiAgICAgICAgICAgIChfYSA9IHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXVzZSgoKSA9PiB0aGlzLmRlbGVnYXRlLnRhcmdldENvbm5lY3RlZChlbGVtZW50LCBuYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdFRhcmdldChlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0c0J5TmFtZS5oYXMobmFtZSwgZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0c0J5TmFtZS5kZWxldGUobmFtZSwgZWxlbWVudCk7XG4gICAgICAgICAgICAoX2EgPSB0aGlzLnRva2VuTGlzdE9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGF1c2UoKCkgPT4gdGhpcy5kZWxlZ2F0ZS50YXJnZXREaXNjb25uZWN0ZWQoZWxlbWVudCwgbmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RBbGxUYXJnZXRzKCkge1xuICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgdGhpcy50YXJnZXRzQnlOYW1lLmtleXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLnRhcmdldHNCeU5hbWUuZ2V0VmFsdWVzRm9yS2V5KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBhdHRyaWJ1dGVOYW1lKCkge1xuICAgICAgICByZXR1cm4gYGRhdGEtJHt0aGlzLmNvbnRleHQuaWRlbnRpZmllcn0tdGFyZ2V0YDtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIHByb3BlcnR5TmFtZSkge1xuICAgIGNvbnN0IGFuY2VzdG9ycyA9IGdldEFuY2VzdG9yc0ZvckNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKTtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShhbmNlc3RvcnMucmVkdWNlKCh2YWx1ZXMsIGNvbnN0cnVjdG9yKSA9PiB7XG4gICAgICAgIGdldE93blN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpLmZvckVhY2goKG5hbWUpID0+IHZhbHVlcy5hZGQobmFtZSkpO1xuICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH0sIG5ldyBTZXQoKSkpO1xufVxuZnVuY3Rpb24gcmVhZEluaGVyaXRhYmxlU3RhdGljT2JqZWN0UGFpcnMoY29uc3RydWN0b3IsIHByb3BlcnR5TmFtZSkge1xuICAgIGNvbnN0IGFuY2VzdG9ycyA9IGdldEFuY2VzdG9yc0ZvckNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKTtcbiAgICByZXR1cm4gYW5jZXN0b3JzLnJlZHVjZSgocGFpcnMsIGNvbnN0cnVjdG9yKSA9PiB7XG4gICAgICAgIHBhaXJzLnB1c2goLi4uZ2V0T3duU3RhdGljT2JqZWN0UGFpcnMoY29uc3RydWN0b3IsIHByb3BlcnR5TmFtZSkpO1xuICAgICAgICByZXR1cm4gcGFpcnM7XG4gICAgfSwgW10pO1xufVxuZnVuY3Rpb24gZ2V0QW5jZXN0b3JzRm9yQ29uc3RydWN0b3IoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCBhbmNlc3RvcnMgPSBbXTtcbiAgICB3aGlsZSAoY29uc3RydWN0b3IpIHtcbiAgICAgICAgYW5jZXN0b3JzLnB1c2goY29uc3RydWN0b3IpO1xuICAgICAgICBjb25zdHJ1Y3RvciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihjb25zdHJ1Y3Rvcik7XG4gICAgfVxuICAgIHJldHVybiBhbmNlc3RvcnMucmV2ZXJzZSgpO1xufVxuZnVuY3Rpb24gZ2V0T3duU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIHByb3BlcnR5TmFtZSkge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSBjb25zdHJ1Y3Rvcltwcm9wZXJ0eU5hbWVdO1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KGRlZmluaXRpb24pID8gZGVmaW5pdGlvbiA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0T3duU3RhdGljT2JqZWN0UGFpcnMoY29uc3RydWN0b3IsIHByb3BlcnR5TmFtZSkge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSBjb25zdHJ1Y3Rvcltwcm9wZXJ0eU5hbWVdO1xuICAgIHJldHVybiBkZWZpbml0aW9uID8gT2JqZWN0LmtleXMoZGVmaW5pdGlvbikubWFwKChrZXkpID0+IFtrZXksIGRlZmluaXRpb25ba2V5XV0pIDogW107XG59XG5cbmNsYXNzIE91dGxldE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLm91dGxldHNCeU5hbWUgPSBuZXcgTXVsdGltYXAoKTtcbiAgICAgICAgdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZSA9IG5ldyBNdWx0aW1hcCgpO1xuICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXJNYXAgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5vdXRsZXREZWZpbml0aW9ucy5mb3JFYWNoKChvdXRsZXROYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXR1cFNlbGVjdG9yT2JzZXJ2ZXJGb3JPdXRsZXQob3V0bGV0TmFtZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXR1cEF0dHJpYnV0ZU9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5kZXBlbmRlbnRDb250ZXh0cy5mb3JFYWNoKChjb250ZXh0KSA9PiBjb250ZXh0LnJlZnJlc2goKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLmZvckVhY2goKG9ic2VydmVyKSA9PiBvYnNlcnZlci5yZWZyZXNoKCkpO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyTWFwLmZvckVhY2goKG9ic2VydmVyKSA9PiBvYnNlcnZlci5yZWZyZXNoKCkpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdEFsbE91dGxldHMoKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcFNlbGVjdG9yT2JzZXJ2ZXJzKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BBdHRyaWJ1dGVPYnNlcnZlcnMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wU2VsZWN0b3JPYnNlcnZlcnMoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIuc3RvcCgpKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcC5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0b3BBdHRyaWJ1dGVPYnNlcnZlcnMoKSB7XG4gICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZU9ic2VydmVyTWFwLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyTWFwLmZvckVhY2goKG9ic2VydmVyKSA9PiBvYnNlcnZlci5zdG9wKCkpO1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdG9yTWF0Y2hlZChlbGVtZW50LCBfc2VsZWN0b3IsIHsgb3V0bGV0TmFtZSB9KSB7XG4gICAgICAgIGNvbnN0IG91dGxldCA9IHRoaXMuZ2V0T3V0bGV0KGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgICAgICBpZiAob3V0bGV0KSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBfc2VsZWN0b3IsIHsgb3V0bGV0TmFtZSB9KSB7XG4gICAgICAgIGNvbnN0IG91dGxldCA9IHRoaXMuZ2V0T3V0bGV0RnJvbU1hcChlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKG91dGxldCkge1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0b3JNYXRjaEVsZW1lbnQoZWxlbWVudCwgeyBvdXRsZXROYW1lIH0pIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yKG91dGxldE5hbWUpO1xuICAgICAgICBjb25zdCBoYXNPdXRsZXQgPSB0aGlzLmhhc091dGxldChlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgY29uc3QgaGFzT3V0bGV0Q29udHJvbGxlciA9IGVsZW1lbnQubWF0Y2hlcyhgWyR7dGhpcy5zY2hlbWEuY29udHJvbGxlckF0dHJpYnV0ZX1+PSR7b3V0bGV0TmFtZX1dYCk7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIGhhc091dGxldCAmJiBoYXNPdXRsZXRDb250cm9sbGVyICYmIGVsZW1lbnQubWF0Y2hlcyhzZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWRBdHRyaWJ1dGUoX2VsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3Qgb3V0bGV0TmFtZSA9IHRoaXMuZ2V0T3V0bGV0TmFtZUZyb21PdXRsZXRBdHRyaWJ1dGVOYW1lKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBpZiAob3V0bGV0TmFtZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRBdHRyaWJ1dGVWYWx1ZUNoYW5nZWQoX2VsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3Qgb3V0bGV0TmFtZSA9IHRoaXMuZ2V0T3V0bGV0TmFtZUZyb21PdXRsZXRBdHRyaWJ1dGVOYW1lKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBpZiAob3V0bGV0TmFtZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRBdHRyaWJ1dGUoX2VsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3Qgb3V0bGV0TmFtZSA9IHRoaXMuZ2V0T3V0bGV0TmFtZUZyb21PdXRsZXRBdHRyaWJ1dGVOYW1lKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBpZiAob3V0bGV0TmFtZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCF0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmhhcyhvdXRsZXROYW1lLCBlbGVtZW50KSkge1xuICAgICAgICAgICAgdGhpcy5vdXRsZXRzQnlOYW1lLmFkZChvdXRsZXROYW1lLCBvdXRsZXQpO1xuICAgICAgICAgICAgdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5hZGQob3V0bGV0TmFtZSwgZWxlbWVudCk7XG4gICAgICAgICAgICAoX2EgPSB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZ2V0KG91dGxldE5hbWUpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGF1c2UoKCkgPT4gdGhpcy5kZWxlZ2F0ZS5vdXRsZXRDb25uZWN0ZWQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdE91dGxldChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAodGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5oYXMob3V0bGV0TmFtZSwgZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0c0J5TmFtZS5kZWxldGUob3V0bGV0TmFtZSwgb3V0bGV0KTtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuZGVsZXRlKG91dGxldE5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgKF9hID0gdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwXG4gICAgICAgICAgICAgICAgLmdldChvdXRsZXROYW1lKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhdXNlKCgpID0+IHRoaXMuZGVsZWdhdGUub3V0bGV0RGlzY29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RBbGxPdXRsZXRzKCkge1xuICAgICAgICBmb3IgKGNvbnN0IG91dGxldE5hbWUgb2YgdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5rZXlzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5nZXRWYWx1ZXNGb3JLZXkob3V0bGV0TmFtZSkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dGxldCBvZiB0aGlzLm91dGxldHNCeU5hbWUuZ2V0VmFsdWVzRm9yS2V5KG91dGxldE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdE91dGxldChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZ2V0KG91dGxldE5hbWUpO1xuICAgICAgICBpZiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIG9ic2VydmVyLnNlbGVjdG9yID0gdGhpcy5zZWxlY3RvcihvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXR1cFNlbGVjdG9yT2JzZXJ2ZXJGb3JPdXRsZXQob3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuc2VsZWN0b3Iob3V0bGV0TmFtZSk7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yT2JzZXJ2ZXIgPSBuZXcgU2VsZWN0b3JPYnNlcnZlcihkb2N1bWVudC5ib2R5LCBzZWxlY3RvciwgdGhpcywgeyBvdXRsZXROYW1lIH0pO1xuICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuc2V0KG91dGxldE5hbWUsIHNlbGVjdG9yT2JzZXJ2ZXIpO1xuICAgICAgICBzZWxlY3Rvck9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHNldHVwQXR0cmlidXRlT2JzZXJ2ZXJGb3JPdXRsZXQob3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5hdHRyaWJ1dGVOYW1lRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlT2JzZXJ2ZXIgPSBuZXcgQXR0cmlidXRlT2JzZXJ2ZXIodGhpcy5zY29wZS5lbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCB0aGlzKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5zZXQob3V0bGV0TmFtZSwgYXR0cmlidXRlT2JzZXJ2ZXIpO1xuICAgICAgICBhdHRyaWJ1dGVPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzZWxlY3RvcihvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLm91dGxldHMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBhdHRyaWJ1dGVOYW1lRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLnNjaGVtYS5vdXRsZXRBdHRyaWJ1dGVGb3JTY29wZSh0aGlzLmlkZW50aWZpZXIsIG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBnZXRPdXRsZXROYW1lRnJvbU91dGxldEF0dHJpYnV0ZU5hbWUoYXR0cmlidXRlTmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXREZWZpbml0aW9ucy5maW5kKChvdXRsZXROYW1lKSA9PiB0aGlzLmF0dHJpYnV0ZU5hbWVGb3JPdXRsZXROYW1lKG91dGxldE5hbWUpID09PSBhdHRyaWJ1dGVOYW1lKTtcbiAgICB9XG4gICAgZ2V0IG91dGxldERlcGVuZGVuY2llcygpIHtcbiAgICAgICAgY29uc3QgZGVwZW5kZW5jaWVzID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMucm91dGVyLm1vZHVsZXMuZm9yRWFjaCgobW9kdWxlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb25zdHJ1Y3RvciA9IG1vZHVsZS5kZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3RvcjtcbiAgICAgICAgICAgIGNvbnN0IG91dGxldHMgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgXCJvdXRsZXRzXCIpO1xuICAgICAgICAgICAgb3V0bGV0cy5mb3JFYWNoKChvdXRsZXQpID0+IGRlcGVuZGVuY2llcy5hZGQob3V0bGV0LCBtb2R1bGUuaWRlbnRpZmllcikpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlcGVuZGVuY2llcztcbiAgICB9XG4gICAgZ2V0IG91dGxldERlZmluaXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXREZXBlbmRlbmNpZXMuZ2V0S2V5c0ZvclZhbHVlKHRoaXMuaWRlbnRpZmllcik7XG4gICAgfVxuICAgIGdldCBkZXBlbmRlbnRDb250cm9sbGVySWRlbnRpZmllcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dGxldERlcGVuZGVuY2llcy5nZXRWYWx1ZXNGb3JLZXkodGhpcy5pZGVudGlmaWVyKTtcbiAgICB9XG4gICAgZ2V0IGRlcGVuZGVudENvbnRleHRzKCkge1xuICAgICAgICBjb25zdCBpZGVudGlmaWVycyA9IHRoaXMuZGVwZW5kZW50Q29udHJvbGxlcklkZW50aWZpZXJzO1xuICAgICAgICByZXR1cm4gdGhpcy5yb3V0ZXIuY29udGV4dHMuZmlsdGVyKChjb250ZXh0KSA9PiBpZGVudGlmaWVycy5pbmNsdWRlcyhjb250ZXh0LmlkZW50aWZpZXIpKTtcbiAgICB9XG4gICAgaGFzT3V0bGV0KGVsZW1lbnQsIG91dGxldE5hbWUpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5nZXRPdXRsZXQoZWxlbWVudCwgb3V0bGV0TmFtZSkgfHwgISF0aGlzLmdldE91dGxldEZyb21NYXAoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGdldE91dGxldChlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLmdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICB9XG4gICAgZ2V0T3V0bGV0RnJvbU1hcChlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dGxldHNCeU5hbWUuZ2V0VmFsdWVzRm9yS2V5KG91dGxldE5hbWUpLmZpbmQoKG91dGxldCkgPT4gb3V0bGV0LmVsZW1lbnQgPT09IGVsZW1lbnQpO1xuICAgIH1cbiAgICBnZXQgc2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NvcGU7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NoZW1hO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgYXBwbGljYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuYXBwbGljYXRpb247XG4gICAgfVxuICAgIGdldCByb3V0ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnJvdXRlcjtcbiAgICB9XG59XG5cbmNsYXNzIENvbnRleHQge1xuICAgIGNvbnN0cnVjdG9yKG1vZHVsZSwgc2NvcGUpIHtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5ID0gKGZ1bmN0aW9uTmFtZSwgZGV0YWlsID0ge30pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCB9ID0gdGhpcztcbiAgICAgICAgICAgIGRldGFpbCA9IE9iamVjdC5hc3NpZ24oeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50IH0sIGRldGFpbCk7XG4gICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmxvZ0RlYnVnQWN0aXZpdHkodGhpcy5pZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubW9kdWxlID0gbW9kdWxlO1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICAgIHRoaXMuY29udHJvbGxlciA9IG5ldyBtb2R1bGUuY29udHJvbGxlckNvbnN0cnVjdG9yKHRoaXMpO1xuICAgICAgICB0aGlzLmJpbmRpbmdPYnNlcnZlciA9IG5ldyBCaW5kaW5nT2JzZXJ2ZXIodGhpcywgdGhpcy5kaXNwYXRjaGVyKTtcbiAgICAgICAgdGhpcy52YWx1ZU9ic2VydmVyID0gbmV3IFZhbHVlT2JzZXJ2ZXIodGhpcywgdGhpcy5jb250cm9sbGVyKTtcbiAgICAgICAgdGhpcy50YXJnZXRPYnNlcnZlciA9IG5ldyBUYXJnZXRPYnNlcnZlcih0aGlzLCB0aGlzKTtcbiAgICAgICAgdGhpcy5vdXRsZXRPYnNlcnZlciA9IG5ldyBPdXRsZXRPYnNlcnZlcih0aGlzLCB0aGlzKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5pbml0aWFsaXplKCk7XG4gICAgICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJpbml0aWFsaXplXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgXCJpbml0aWFsaXppbmcgY29udHJvbGxlclwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmJpbmRpbmdPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0aGlzLnZhbHVlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0aGlzLm91dGxldE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiY29ubmVjdFwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIFwiY29ubmVjdGluZyBjb250cm9sbGVyXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMub3V0bGV0T2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImRpc2Nvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBcImRpc2Nvbm5lY3RpbmcgY29udHJvbGxlclwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm91dGxldE9ic2VydmVyLnN0b3AoKTtcbiAgICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgIHRoaXMudmFsdWVPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgIHRoaXMuYmluZGluZ09ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgZ2V0IGFwcGxpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb2R1bGUuYXBwbGljYXRpb247XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb2R1bGUuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24uc2NoZW1hO1xuICAgIH1cbiAgICBnZXQgZGlzcGF0Y2hlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24uZGlzcGF0Y2hlcjtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBwYXJlbnRFbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwgPSB7fSkge1xuICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXIsIGVsZW1lbnQgfSA9IHRoaXM7XG4gICAgICAgIGRldGFpbCA9IE9iamVjdC5hc3NpZ24oeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50IH0sIGRldGFpbCk7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24uaGFuZGxlRXJyb3IoZXJyb3IsIGBFcnJvciAke21lc3NhZ2V9YCwgZGV0YWlsKTtcbiAgICB9XG4gICAgdGFyZ2V0Q29ubmVjdGVkKGVsZW1lbnQsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5pbnZva2VDb250cm9sbGVyTWV0aG9kKGAke25hbWV9VGFyZ2V0Q29ubmVjdGVkYCwgZWxlbWVudCk7XG4gICAgfVxuICAgIHRhcmdldERpc2Nvbm5lY3RlZChlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lfVRhcmdldERpc2Nvbm5lY3RlZGAsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBvdXRsZXRDb25uZWN0ZWQob3V0bGV0LCBlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lc3BhY2VDYW1lbGl6ZShuYW1lKX1PdXRsZXRDb25uZWN0ZWRgLCBvdXRsZXQsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBvdXRsZXREaXNjb25uZWN0ZWQob3V0bGV0LCBlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lc3BhY2VDYW1lbGl6ZShuYW1lKX1PdXRsZXREaXNjb25uZWN0ZWRgLCBvdXRsZXQsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBpbnZva2VDb250cm9sbGVyTWV0aG9kKG1ldGhvZE5hbWUsIC4uLmFyZ3MpIHtcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IHRoaXMuY29udHJvbGxlcjtcbiAgICAgICAgaWYgKHR5cGVvZiBjb250cm9sbGVyW21ldGhvZE5hbWVdID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgY29udHJvbGxlclttZXRob2ROYW1lXSguLi5hcmdzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYmxlc3MoY29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gc2hhZG93KGNvbnN0cnVjdG9yLCBnZXRCbGVzc2VkUHJvcGVydGllcyhjb25zdHJ1Y3RvcikpO1xufVxuZnVuY3Rpb24gc2hhZG93KGNvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgY29uc3Qgc2hhZG93Q29uc3RydWN0b3IgPSBleHRlbmQoY29uc3RydWN0b3IpO1xuICAgIGNvbnN0IHNoYWRvd1Byb3BlcnRpZXMgPSBnZXRTaGFkb3dQcm9wZXJ0aWVzKGNvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvcGVydGllcyk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoc2hhZG93Q29uc3RydWN0b3IucHJvdG90eXBlLCBzaGFkb3dQcm9wZXJ0aWVzKTtcbiAgICByZXR1cm4gc2hhZG93Q29uc3RydWN0b3I7XG59XG5mdW5jdGlvbiBnZXRCbGVzc2VkUHJvcGVydGllcyhjb25zdHJ1Y3Rvcikge1xuICAgIGNvbnN0IGJsZXNzaW5ncyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBcImJsZXNzaW5nc1wiKTtcbiAgICByZXR1cm4gYmxlc3NpbmdzLnJlZHVjZSgoYmxlc3NlZFByb3BlcnRpZXMsIGJsZXNzaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBibGVzc2luZyhjb25zdHJ1Y3Rvcik7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSBibGVzc2VkUHJvcGVydGllc1trZXldIHx8IHt9O1xuICAgICAgICAgICAgYmxlc3NlZFByb3BlcnRpZXNba2V5XSA9IE9iamVjdC5hc3NpZ24oZGVzY3JpcHRvciwgcHJvcGVydGllc1trZXldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmxlc3NlZFByb3BlcnRpZXM7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gZ2V0U2hhZG93UHJvcGVydGllcyhwcm90b3R5cGUsIHByb3BlcnRpZXMpIHtcbiAgICByZXR1cm4gZ2V0T3duS2V5cyhwcm9wZXJ0aWVzKS5yZWR1Y2UoKHNoYWRvd1Byb3BlcnRpZXMsIGtleSkgPT4ge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gZ2V0U2hhZG93ZWREZXNjcmlwdG9yKHByb3RvdHlwZSwgcHJvcGVydGllcywga2V5KTtcbiAgICAgICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oc2hhZG93UHJvcGVydGllcywgeyBba2V5XTogZGVzY3JpcHRvciB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hhZG93UHJvcGVydGllcztcbiAgICB9LCB7fSk7XG59XG5mdW5jdGlvbiBnZXRTaGFkb3dlZERlc2NyaXB0b3IocHJvdG90eXBlLCBwcm9wZXJ0aWVzLCBrZXkpIHtcbiAgICBjb25zdCBzaGFkb3dpbmdEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwcm90b3R5cGUsIGtleSk7XG4gICAgY29uc3Qgc2hhZG93ZWRCeVZhbHVlID0gc2hhZG93aW5nRGVzY3JpcHRvciAmJiBcInZhbHVlXCIgaW4gc2hhZG93aW5nRGVzY3JpcHRvcjtcbiAgICBpZiAoIXNoYWRvd2VkQnlWYWx1ZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwcm9wZXJ0aWVzLCBrZXkpLnZhbHVlO1xuICAgICAgICBpZiAoc2hhZG93aW5nRGVzY3JpcHRvcikge1xuICAgICAgICAgICAgZGVzY3JpcHRvci5nZXQgPSBzaGFkb3dpbmdEZXNjcmlwdG9yLmdldCB8fCBkZXNjcmlwdG9yLmdldDtcbiAgICAgICAgICAgIGRlc2NyaXB0b3Iuc2V0ID0gc2hhZG93aW5nRGVzY3JpcHRvci5zZXQgfHwgZGVzY3JpcHRvci5zZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gICAgfVxufVxuY29uc3QgZ2V0T3duS2V5cyA9ICgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gKG9iamVjdCkgPT4gWy4uLk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iamVjdCksIC4uLk9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7XG4gICAgfVxufSkoKTtcbmNvbnN0IGV4dGVuZCA9ICgoKSA9PiB7XG4gICAgZnVuY3Rpb24gZXh0ZW5kV2l0aFJlZmxlY3QoY29uc3RydWN0b3IpIHtcbiAgICAgICAgZnVuY3Rpb24gZXh0ZW5kZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoY29uc3RydWN0b3IsIGFyZ3VtZW50cywgbmV3LnRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZXh0ZW5kZWQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShjb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHtcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBleHRlbmRlZCB9LFxuICAgICAgICB9KTtcbiAgICAgICAgUmVmbGVjdC5zZXRQcm90b3R5cGVPZihleHRlbmRlZCwgY29uc3RydWN0b3IpO1xuICAgICAgICByZXR1cm4gZXh0ZW5kZWQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRlc3RSZWZsZWN0RXh0ZW5zaW9uKCkge1xuICAgICAgICBjb25zdCBhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5hLmNhbGwodGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGIgPSBleHRlbmRXaXRoUmVmbGVjdChhKTtcbiAgICAgICAgYi5wcm90b3R5cGUuYSA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgcmV0dXJuIG5ldyBiKCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIHRlc3RSZWZsZWN0RXh0ZW5zaW9uKCk7XG4gICAgICAgIHJldHVybiBleHRlbmRXaXRoUmVmbGVjdDtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiAoY29uc3RydWN0b3IpID0+IGNsYXNzIGV4dGVuZGVkIGV4dGVuZHMgY29uc3RydWN0b3Ige1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG5cbmZ1bmN0aW9uIGJsZXNzRGVmaW5pdGlvbihkZWZpbml0aW9uKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWRlbnRpZmllcjogZGVmaW5pdGlvbi5pZGVudGlmaWVyLFxuICAgICAgICBjb250cm9sbGVyQ29uc3RydWN0b3I6IGJsZXNzKGRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yKSxcbiAgICB9O1xufVxuXG5jbGFzcyBNb2R1bGUge1xuICAgIGNvbnN0cnVjdG9yKGFwcGxpY2F0aW9uLCBkZWZpbml0aW9uKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5kZWZpbml0aW9uID0gYmxlc3NEZWZpbml0aW9uKGRlZmluaXRpb24pO1xuICAgICAgICB0aGlzLmNvbnRleHRzQnlTY29wZSA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMuY29ubmVjdGVkQ29udGV4dHMgPSBuZXcgU2V0KCk7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZpbml0aW9uLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVyQ29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yO1xuICAgIH1cbiAgICBnZXQgY29udGV4dHMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY29ubmVjdGVkQ29udGV4dHMpO1xuICAgIH1cbiAgICBjb25uZWN0Q29udGV4dEZvclNjb3BlKHNjb3BlKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmZldGNoQ29udGV4dEZvclNjb3BlKHNjb3BlKTtcbiAgICAgICAgdGhpcy5jb25uZWN0ZWRDb250ZXh0cy5hZGQoY29udGV4dCk7XG4gICAgICAgIGNvbnRleHQuY29ubmVjdCgpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0Q29udGV4dEZvclNjb3BlKHNjb3BlKSB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmNvbnRleHRzQnlTY29wZS5nZXQoc2NvcGUpO1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0ZWRDb250ZXh0cy5kZWxldGUoY29udGV4dCk7XG4gICAgICAgICAgICBjb250ZXh0LmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmZXRjaENvbnRleHRGb3JTY29wZShzY29wZSkge1xuICAgICAgICBsZXQgY29udGV4dCA9IHRoaXMuY29udGV4dHNCeVNjb3BlLmdldChzY29wZSk7XG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dCA9IG5ldyBDb250ZXh0KHRoaXMsIHNjb3BlKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dHNCeVNjb3BlLnNldChzY29wZSwgY29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgfVxufVxuXG5jbGFzcyBDbGFzc01hcCB7XG4gICAgY29uc3RydWN0b3Ioc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIH1cbiAgICBoYXMobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmhhcyh0aGlzLmdldERhdGFLZXkobmFtZSkpO1xuICAgIH1cbiAgICBnZXQobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGwobmFtZSlbMF07XG4gICAgfVxuICAgIGdldEFsbChuYW1lKSB7XG4gICAgICAgIGNvbnN0IHRva2VuU3RyaW5nID0gdGhpcy5kYXRhLmdldCh0aGlzLmdldERhdGFLZXkobmFtZSkpIHx8IFwiXCI7XG4gICAgICAgIHJldHVybiB0b2tlbml6ZSh0b2tlblN0cmluZyk7XG4gICAgfVxuICAgIGdldEF0dHJpYnV0ZU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkodGhpcy5nZXREYXRhS2V5KG5hbWUpKTtcbiAgICB9XG4gICAgZ2V0RGF0YUtleShuYW1lKSB7XG4gICAgICAgIHJldHVybiBgJHtuYW1lfS1jbGFzc2A7XG4gICAgfVxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5kYXRhO1xuICAgIH1cbn1cblxuY2xhc3MgRGF0YU1hcCB7XG4gICAgY29uc3RydWN0b3Ioc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldChrZXkpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgICB9XG4gICAgc2V0KGtleSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KGtleSk7XG4gICAgfVxuICAgIGhhcyhrZXkpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50Lmhhc0F0dHJpYnV0ZShuYW1lKTtcbiAgICB9XG4gICAgZGVsZXRlKGtleSkge1xuICAgICAgICBpZiAodGhpcy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZ2V0QXR0cmlidXRlTmFtZUZvcktleShrZXkpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KSB7XG4gICAgICAgIHJldHVybiBgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0tJHtkYXNoZXJpemUoa2V5KX1gO1xuICAgIH1cbn1cblxuY2xhc3MgR3VpZGUge1xuICAgIGNvbnN0cnVjdG9yKGxvZ2dlcikge1xuICAgICAgICB0aGlzLndhcm5lZEtleXNCeU9iamVjdCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyO1xuICAgIH1cbiAgICB3YXJuKG9iamVjdCwga2V5LCBtZXNzYWdlKSB7XG4gICAgICAgIGxldCB3YXJuZWRLZXlzID0gdGhpcy53YXJuZWRLZXlzQnlPYmplY3QuZ2V0KG9iamVjdCk7XG4gICAgICAgIGlmICghd2FybmVkS2V5cykge1xuICAgICAgICAgICAgd2FybmVkS2V5cyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgIHRoaXMud2FybmVkS2V5c0J5T2JqZWN0LnNldChvYmplY3QsIHdhcm5lZEtleXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghd2FybmVkS2V5cy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgd2FybmVkS2V5cy5hZGQoa2V5KTtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4obWVzc2FnZSwgb2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKGF0dHJpYnV0ZU5hbWUsIHRva2VuKSB7XG4gICAgcmV0dXJuIGBbJHthdHRyaWJ1dGVOYW1lfX49XCIke3Rva2VufVwiXWA7XG59XG5cbmNsYXNzIFRhcmdldFNldCB7XG4gICAgY29uc3RydWN0b3Ioc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLnNjaGVtYTtcbiAgICB9XG4gICAgaGFzKHRhcmdldE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCh0YXJnZXROYW1lKSAhPSBudWxsO1xuICAgIH1cbiAgICBmaW5kKC4uLnRhcmdldE5hbWVzKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXROYW1lcy5yZWR1Y2UoKHRhcmdldCwgdGFyZ2V0TmFtZSkgPT4gdGFyZ2V0IHx8IHRoaXMuZmluZFRhcmdldCh0YXJnZXROYW1lKSB8fCB0aGlzLmZpbmRMZWdhY3lUYXJnZXQodGFyZ2V0TmFtZSksIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIGZpbmRBbGwoLi4udGFyZ2V0TmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldE5hbWVzLnJlZHVjZSgodGFyZ2V0cywgdGFyZ2V0TmFtZSkgPT4gW1xuICAgICAgICAgICAgLi4udGFyZ2V0cyxcbiAgICAgICAgICAgIC4uLnRoaXMuZmluZEFsbFRhcmdldHModGFyZ2V0TmFtZSksXG4gICAgICAgICAgICAuLi50aGlzLmZpbmRBbGxMZWdhY3lUYXJnZXRzKHRhcmdldE5hbWUpLFxuICAgICAgICBdLCBbXSk7XG4gICAgfVxuICAgIGZpbmRUYXJnZXQodGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5maW5kRWxlbWVudChzZWxlY3Rvcik7XG4gICAgfVxuICAgIGZpbmRBbGxUYXJnZXRzKHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yKTtcbiAgICB9XG4gICAgZ2V0U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuc2NoZW1hLnRhcmdldEF0dHJpYnV0ZUZvclNjb3BlKHRoaXMuaWRlbnRpZmllcik7XG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVWYWx1ZUNvbnRhaW5zVG9rZW4oYXR0cmlidXRlTmFtZSwgdGFyZ2V0TmFtZSk7XG4gICAgfVxuICAgIGZpbmRMZWdhY3lUYXJnZXQodGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0TGVnYWN5U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5kZXByZWNhdGUodGhpcy5zY29wZS5maW5kRWxlbWVudChzZWxlY3RvciksIHRhcmdldE5hbWUpO1xuICAgIH1cbiAgICBmaW5kQWxsTGVnYWN5VGFyZ2V0cyh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5nZXRMZWdhY3lTZWxlY3RvckZvclRhcmdldE5hbWUodGFyZ2V0TmFtZSk7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmZpbmRBbGxFbGVtZW50cyhzZWxlY3RvcikubWFwKChlbGVtZW50KSA9PiB0aGlzLmRlcHJlY2F0ZShlbGVtZW50LCB0YXJnZXROYW1lKSk7XG4gICAgfVxuICAgIGdldExlZ2FjeVNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldERlc2NyaXB0b3IgPSBgJHt0aGlzLmlkZW50aWZpZXJ9LiR7dGFyZ2V0TmFtZX1gO1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKHRoaXMuc2NoZW1hLnRhcmdldEF0dHJpYnV0ZSwgdGFyZ2V0RGVzY3JpcHRvcik7XG4gICAgfVxuICAgIGRlcHJlY2F0ZShlbGVtZW50LCB0YXJnZXROYW1lKSB7XG4gICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIgfSA9IHRoaXM7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5zY2hlbWEudGFyZ2V0QXR0cmlidXRlO1xuICAgICAgICAgICAgY29uc3QgcmV2aXNlZEF0dHJpYnV0ZU5hbWUgPSB0aGlzLnNjaGVtYS50YXJnZXRBdHRyaWJ1dGVGb3JTY29wZShpZGVudGlmaWVyKTtcbiAgICAgICAgICAgIHRoaXMuZ3VpZGUud2FybihlbGVtZW50LCBgdGFyZ2V0OiR7dGFyZ2V0TmFtZX1gLCBgUGxlYXNlIHJlcGxhY2UgJHthdHRyaWJ1dGVOYW1lfT1cIiR7aWRlbnRpZmllcn0uJHt0YXJnZXROYW1lfVwiIHdpdGggJHtyZXZpc2VkQXR0cmlidXRlTmFtZX09XCIke3RhcmdldE5hbWV9XCIuIGAgK1xuICAgICAgICAgICAgICAgIGBUaGUgJHthdHRyaWJ1dGVOYW1lfSBhdHRyaWJ1dGUgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgU3RpbXVsdXMuYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBndWlkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZ3VpZGU7XG4gICAgfVxufVxuXG5jbGFzcyBPdXRsZXRTZXQge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlLCBjb250cm9sbGVyRWxlbWVudCkge1xuICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICAgIHRoaXMuY29udHJvbGxlckVsZW1lbnQgPSBjb250cm9sbGVyRWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5zY2hlbWE7XG4gICAgfVxuICAgIGhhcyhvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQob3V0bGV0TmFtZSkgIT0gbnVsbDtcbiAgICB9XG4gICAgZmluZCguLi5vdXRsZXROYW1lcykge1xuICAgICAgICByZXR1cm4gb3V0bGV0TmFtZXMucmVkdWNlKChvdXRsZXQsIG91dGxldE5hbWUpID0+IG91dGxldCB8fCB0aGlzLmZpbmRPdXRsZXQob3V0bGV0TmFtZSksIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIGZpbmRBbGwoLi4ub3V0bGV0TmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIG91dGxldE5hbWVzLnJlZHVjZSgob3V0bGV0cywgb3V0bGV0TmFtZSkgPT4gWy4uLm91dGxldHMsIC4uLnRoaXMuZmluZEFsbE91dGxldHMob3V0bGV0TmFtZSldLCBbXSk7XG4gICAgfVxuICAgIGdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLnNjaGVtYS5vdXRsZXRBdHRyaWJ1dGVGb3JTY29wZSh0aGlzLmlkZW50aWZpZXIsIG91dGxldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5jb250cm9sbGVyRWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgfVxuICAgIGZpbmRPdXRsZXQob3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG91dGxldE5hbWUpO1xuICAgICAgICBpZiAoc2VsZWN0b3IpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kRWxlbWVudChzZWxlY3Rvciwgb3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGZpbmRBbGxPdXRsZXRzKG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yID8gdGhpcy5maW5kQWxsRWxlbWVudHMoc2VsZWN0b3IsIG91dGxldE5hbWUpIDogW107XG4gICAgfVxuICAgIGZpbmRFbGVtZW50KHNlbGVjdG9yLCBvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5zY29wZS5xdWVyeUVsZW1lbnRzKHNlbGVjdG9yKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbHRlcigoZWxlbWVudCkgPT4gdGhpcy5tYXRjaGVzRWxlbWVudChlbGVtZW50LCBzZWxlY3Rvciwgb3V0bGV0TmFtZSkpWzBdO1xuICAgIH1cbiAgICBmaW5kQWxsRWxlbWVudHMoc2VsZWN0b3IsIG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSB0aGlzLnNjb3BlLnF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpO1xuICAgICAgICByZXR1cm4gZWxlbWVudHMuZmlsdGVyKChlbGVtZW50KSA9PiB0aGlzLm1hdGNoZXNFbGVtZW50KGVsZW1lbnQsIHNlbGVjdG9yLCBvdXRsZXROYW1lKSk7XG4gICAgfVxuICAgIG1hdGNoZXNFbGVtZW50KGVsZW1lbnQsIHNlbGVjdG9yLCBvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXJBdHRyaWJ1dGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLnNjb3BlLnNjaGVtYS5jb250cm9sbGVyQXR0cmlidXRlKSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gZWxlbWVudC5tYXRjaGVzKHNlbGVjdG9yKSAmJiBjb250cm9sbGVyQXR0cmlidXRlLnNwbGl0KFwiIFwiKS5pbmNsdWRlcyhvdXRsZXROYW1lKTtcbiAgICB9XG59XG5cbmNsYXNzIFNjb3BlIHtcbiAgICBjb25zdHJ1Y3RvcihzY2hlbWEsIGVsZW1lbnQsIGlkZW50aWZpZXIsIGxvZ2dlcikge1xuICAgICAgICB0aGlzLnRhcmdldHMgPSBuZXcgVGFyZ2V0U2V0KHRoaXMpO1xuICAgICAgICB0aGlzLmNsYXNzZXMgPSBuZXcgQ2xhc3NNYXAodGhpcyk7XG4gICAgICAgIHRoaXMuZGF0YSA9IG5ldyBEYXRhTWFwKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbnRhaW5zRWxlbWVudCA9IChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KHRoaXMuY29udHJvbGxlclNlbGVjdG9yKSA9PT0gdGhpcy5lbGVtZW50O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNjaGVtYSA9IHNjaGVtYTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5pZGVudGlmaWVyID0gaWRlbnRpZmllcjtcbiAgICAgICAgdGhpcy5ndWlkZSA9IG5ldyBHdWlkZShsb2dnZXIpO1xuICAgICAgICB0aGlzLm91dGxldHMgPSBuZXcgT3V0bGV0U2V0KHRoaXMuZG9jdW1lbnRTY29wZSwgZWxlbWVudCk7XG4gICAgfVxuICAgIGZpbmRFbGVtZW50KHNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikgPyB0aGlzLmVsZW1lbnQgOiB0aGlzLnF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpLmZpbmQodGhpcy5jb250YWluc0VsZW1lbnQpO1xuICAgIH1cbiAgICBmaW5kQWxsRWxlbWVudHMoc2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIC4uLih0aGlzLmVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikgPyBbdGhpcy5lbGVtZW50XSA6IFtdKSxcbiAgICAgICAgICAgIC4uLnRoaXMucXVlcnlFbGVtZW50cyhzZWxlY3RvcikuZmlsdGVyKHRoaXMuY29udGFpbnNFbGVtZW50KSxcbiAgICAgICAgXTtcbiAgICB9XG4gICAgcXVlcnlFbGVtZW50cyhzZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlclNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGUsIHRoaXMuaWRlbnRpZmllcik7XG4gICAgfVxuICAgIGdldCBpc0RvY3VtZW50U2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQgPT09IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGRvY3VtZW50U2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzRG9jdW1lbnRTY29wZVxuICAgICAgICAgICAgPyB0aGlzXG4gICAgICAgICAgICA6IG5ldyBTY29wZSh0aGlzLnNjaGVtYSwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB0aGlzLmlkZW50aWZpZXIsIHRoaXMuZ3VpZGUubG9nZ2VyKTtcbiAgICB9XG59XG5cbmNsYXNzIFNjb3BlT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHNjaGVtYSwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlciA9IG5ldyBWYWx1ZUxpc3RPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMuY29udHJvbGxlckF0dHJpYnV0ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50ID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgICAgdGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGU7XG4gICAgfVxuICAgIHBhcnNlVmFsdWVGb3JUb2tlbih0b2tlbikge1xuICAgICAgICBjb25zdCB7IGVsZW1lbnQsIGNvbnRlbnQ6IGlkZW50aWZpZXIgfSA9IHRva2VuO1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVZhbHVlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcik7XG4gICAgfVxuICAgIHBhcnNlVmFsdWVGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IHNjb3Blc0J5SWRlbnRpZmllciA9IHRoaXMuZmV0Y2hTY29wZXNCeUlkZW50aWZpZXJGb3JFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICBsZXQgc2NvcGUgPSBzY29wZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAoIXNjb3BlKSB7XG4gICAgICAgICAgICBzY29wZSA9IHRoaXMuZGVsZWdhdGUuY3JlYXRlU2NvcGVGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgICAgIHNjb3Blc0J5SWRlbnRpZmllci5zZXQoaWRlbnRpZmllciwgc2NvcGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY29wZTtcbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWRWYWx1ZShlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VDb3VudCA9ICh0aGlzLnNjb3BlUmVmZXJlbmNlQ291bnRzLmdldCh2YWx1ZSkgfHwgMCkgKyAxO1xuICAgICAgICB0aGlzLnNjb3BlUmVmZXJlbmNlQ291bnRzLnNldCh2YWx1ZSwgcmVmZXJlbmNlQ291bnQpO1xuICAgICAgICBpZiAocmVmZXJlbmNlQ291bnQgPT0gMSkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zY29wZUNvbm5lY3RlZCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudFVubWF0Y2hlZFZhbHVlKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZUNvdW50ID0gdGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5nZXQodmFsdWUpO1xuICAgICAgICBpZiAocmVmZXJlbmNlQ291bnQpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVSZWZlcmVuY2VDb3VudHMuc2V0KHZhbHVlLCByZWZlcmVuY2VDb3VudCAtIDEpO1xuICAgICAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50ID09IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlbGVnYXRlLnNjb3BlRGlzY29ubmVjdGVkKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmZXRjaFNjb3Blc0J5SWRlbnRpZmllckZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBsZXQgc2NvcGVzQnlJZGVudGlmaWVyID0gdGhpcy5zY29wZXNCeUlkZW50aWZpZXJCeUVsZW1lbnQuZ2V0KGVsZW1lbnQpO1xuICAgICAgICBpZiAoIXNjb3Blc0J5SWRlbnRpZmllcikge1xuICAgICAgICAgICAgc2NvcGVzQnlJZGVudGlmaWVyID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgdGhpcy5zY29wZXNCeUlkZW50aWZpZXJCeUVsZW1lbnQuc2V0KGVsZW1lbnQsIHNjb3Blc0J5SWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNjb3Blc0J5SWRlbnRpZmllcjtcbiAgICB9XG59XG5cbmNsYXNzIFJvdXRlciB7XG4gICAgY29uc3RydWN0b3IoYXBwbGljYXRpb24pIHtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbiA9IGFwcGxpY2F0aW9uO1xuICAgICAgICB0aGlzLnNjb3BlT2JzZXJ2ZXIgPSBuZXcgU2NvcGVPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMuc2NoZW1hLCB0aGlzKTtcbiAgICAgICAgdGhpcy5zY29wZXNCeUlkZW50aWZpZXIgPSBuZXcgTXVsdGltYXAoKTtcbiAgICAgICAgdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24uZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24uc2NoZW1hO1xuICAgIH1cbiAgICBnZXQgbG9nZ2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWNhdGlvbi5sb2dnZXI7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVyQXR0cmlidXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWEuY29udHJvbGxlckF0dHJpYnV0ZTtcbiAgICB9XG4gICAgZ2V0IG1vZHVsZXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci52YWx1ZXMoKSk7XG4gICAgfVxuICAgIGdldCBjb250ZXh0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kdWxlcy5yZWR1Y2UoKGNvbnRleHRzLCBtb2R1bGUpID0+IGNvbnRleHRzLmNvbmNhdChtb2R1bGUuY29udGV4dHMpLCBbXSk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnNjb3BlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgbG9hZERlZmluaXRpb24oZGVmaW5pdGlvbikge1xuICAgICAgICB0aGlzLnVubG9hZElkZW50aWZpZXIoZGVmaW5pdGlvbi5pZGVudGlmaWVyKTtcbiAgICAgICAgY29uc3QgbW9kdWxlID0gbmV3IE1vZHVsZSh0aGlzLmFwcGxpY2F0aW9uLCBkZWZpbml0aW9uKTtcbiAgICAgICAgdGhpcy5jb25uZWN0TW9kdWxlKG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IGFmdGVyTG9hZCA9IGRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yLmFmdGVyTG9hZDtcbiAgICAgICAgaWYgKGFmdGVyTG9hZCkge1xuICAgICAgICAgICAgYWZ0ZXJMb2FkLmNhbGwoZGVmaW5pdGlvbi5jb250cm9sbGVyQ29uc3RydWN0b3IsIGRlZmluaXRpb24uaWRlbnRpZmllciwgdGhpcy5hcHBsaWNhdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5sb2FkSWRlbnRpZmllcihpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci5nZXQoaWRlbnRpZmllcik7XG4gICAgICAgIGlmIChtb2R1bGUpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdE1vZHVsZShtb2R1bGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldENvbnRleHRGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci5nZXQoaWRlbnRpZmllcik7XG4gICAgICAgIGlmIChtb2R1bGUpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGUuY29udGV4dHMuZmluZCgoY29udGV4dCkgPT4gY29udGV4dC5lbGVtZW50ID09IGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByb3Bvc2VUb0Nvbm5lY3RTY29wZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgY29uc3Qgc2NvcGUgPSB0aGlzLnNjb3BlT2JzZXJ2ZXIucGFyc2VWYWx1ZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAoc2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVPYnNlcnZlci5lbGVtZW50TWF0Y2hlZFZhbHVlKHNjb3BlLmVsZW1lbnQsIHNjb3BlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYENvdWxkbid0IGZpbmQgb3IgY3JlYXRlIHNjb3BlIGZvciBpZGVudGlmaWVyOiBcIiR7aWRlbnRpZmllcn1cIiBhbmQgZWxlbWVudDpgLCBlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24uaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIGRldGFpbCk7XG4gICAgfVxuICAgIGNyZWF0ZVNjb3BlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICByZXR1cm4gbmV3IFNjb3BlKHRoaXMuc2NoZW1hLCBlbGVtZW50LCBpZGVudGlmaWVyLCB0aGlzLmxvZ2dlcik7XG4gICAgfVxuICAgIHNjb3BlQ29ubmVjdGVkKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyLmFkZChzY29wZS5pZGVudGlmaWVyLCBzY29wZSk7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci5nZXQoc2NvcGUuaWRlbnRpZmllcik7XG4gICAgICAgIGlmIChtb2R1bGUpIHtcbiAgICAgICAgICAgIG1vZHVsZS5jb25uZWN0Q29udGV4dEZvclNjb3BlKHNjb3BlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzY29wZURpc2Nvbm5lY3RlZChzY29wZSkge1xuICAgICAgICB0aGlzLnNjb3Blc0J5SWRlbnRpZmllci5kZWxldGUoc2NvcGUuaWRlbnRpZmllciwgc2NvcGUpO1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KHNjb3BlLmlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICBtb2R1bGUuZGlzY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29ubmVjdE1vZHVsZShtb2R1bGUpIHtcbiAgICAgICAgdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyLnNldChtb2R1bGUuaWRlbnRpZmllciwgbW9kdWxlKTtcbiAgICAgICAgY29uc3Qgc2NvcGVzID0gdGhpcy5zY29wZXNCeUlkZW50aWZpZXIuZ2V0VmFsdWVzRm9yS2V5KG1vZHVsZS5pZGVudGlmaWVyKTtcbiAgICAgICAgc2NvcGVzLmZvckVhY2goKHNjb3BlKSA9PiBtb2R1bGUuY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0TW9kdWxlKG1vZHVsZSkge1xuICAgICAgICB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZGVsZXRlKG1vZHVsZS5pZGVudGlmaWVyKTtcbiAgICAgICAgY29uc3Qgc2NvcGVzID0gdGhpcy5zY29wZXNCeUlkZW50aWZpZXIuZ2V0VmFsdWVzRm9yS2V5KG1vZHVsZS5pZGVudGlmaWVyKTtcbiAgICAgICAgc2NvcGVzLmZvckVhY2goKHNjb3BlKSA9PiBtb2R1bGUuZGlzY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkpO1xuICAgIH1cbn1cblxuY29uc3QgZGVmYXVsdFNjaGVtYSA9IHtcbiAgICBjb250cm9sbGVyQXR0cmlidXRlOiBcImRhdGEtY29udHJvbGxlclwiLFxuICAgIGFjdGlvbkF0dHJpYnV0ZTogXCJkYXRhLWFjdGlvblwiLFxuICAgIHRhcmdldEF0dHJpYnV0ZTogXCJkYXRhLXRhcmdldFwiLFxuICAgIHRhcmdldEF0dHJpYnV0ZUZvclNjb3BlOiAoaWRlbnRpZmllcikgPT4gYGRhdGEtJHtpZGVudGlmaWVyfS10YXJnZXRgLFxuICAgIG91dGxldEF0dHJpYnV0ZUZvclNjb3BlOiAoaWRlbnRpZmllciwgb3V0bGV0KSA9PiBgZGF0YS0ke2lkZW50aWZpZXJ9LSR7b3V0bGV0fS1vdXRsZXRgLFxuICAgIGtleU1hcHBpbmdzOiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oeyBlbnRlcjogXCJFbnRlclwiLCB0YWI6IFwiVGFiXCIsIGVzYzogXCJFc2NhcGVcIiwgc3BhY2U6IFwiIFwiLCB1cDogXCJBcnJvd1VwXCIsIGRvd246IFwiQXJyb3dEb3duXCIsIGxlZnQ6IFwiQXJyb3dMZWZ0XCIsIHJpZ2h0OiBcIkFycm93UmlnaHRcIiwgaG9tZTogXCJIb21lXCIsIGVuZDogXCJFbmRcIiwgcGFnZV91cDogXCJQYWdlVXBcIiwgcGFnZV9kb3duOiBcIlBhZ2VEb3duXCIgfSwgb2JqZWN0RnJvbUVudHJpZXMoXCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5elwiLnNwbGl0KFwiXCIpLm1hcCgoYykgPT4gW2MsIGNdKSkpLCBvYmplY3RGcm9tRW50cmllcyhcIjAxMjM0NTY3ODlcIi5zcGxpdChcIlwiKS5tYXAoKG4pID0+IFtuLCBuXSkpKSxcbn07XG5mdW5jdGlvbiBvYmplY3RGcm9tRW50cmllcyhhcnJheSkge1xuICAgIHJldHVybiBhcnJheS5yZWR1Y2UoKG1lbW8sIFtrLCB2XSkgPT4gKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgbWVtbyksIHsgW2tdOiB2IH0pKSwge30pO1xufVxuXG5jbGFzcyBBcHBsaWNhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgc2NoZW1hID0gZGVmYXVsdFNjaGVtYSkge1xuICAgICAgICB0aGlzLmxvZ2dlciA9IGNvbnNvbGU7XG4gICAgICAgIHRoaXMuZGVidWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5ID0gKGlkZW50aWZpZXIsIGZ1bmN0aW9uTmFtZSwgZGV0YWlsID0ge30pID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlYnVnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dGb3JtYXR0ZWRNZXNzYWdlKGlkZW50aWZpZXIsIGZ1bmN0aW9uTmFtZSwgZGV0YWlsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnJvdXRlciA9IG5ldyBSb3V0ZXIodGhpcyk7XG4gICAgICAgIHRoaXMuYWN0aW9uRGVzY3JpcHRvckZpbHRlcnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0QWN0aW9uRGVzY3JpcHRvckZpbHRlcnMpO1xuICAgIH1cbiAgICBzdGF0aWMgc3RhcnQoZWxlbWVudCwgc2NoZW1hKSB7XG4gICAgICAgIGNvbnN0IGFwcGxpY2F0aW9uID0gbmV3IHRoaXMoZWxlbWVudCwgc2NoZW1hKTtcbiAgICAgICAgYXBwbGljYXRpb24uc3RhcnQoKTtcbiAgICAgICAgcmV0dXJuIGFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBhc3luYyBzdGFydCgpIHtcbiAgICAgICAgYXdhaXQgZG9tUmVhZHkoKTtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiYXBwbGljYXRpb25cIiwgXCJzdGFydGluZ1wiKTtcbiAgICAgICAgdGhpcy5kaXNwYXRjaGVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMucm91dGVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImFwcGxpY2F0aW9uXCIsIFwic3RhcnRcIik7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImFwcGxpY2F0aW9uXCIsIFwic3RvcHBpbmdcIik7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlci5zdG9wKCk7XG4gICAgICAgIHRoaXMucm91dGVyLnN0b3AoKTtcbiAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiYXBwbGljYXRpb25cIiwgXCJzdG9wXCIpO1xuICAgIH1cbiAgICByZWdpc3RlcihpZGVudGlmaWVyLCBjb250cm9sbGVyQ29uc3RydWN0b3IpIHtcbiAgICAgICAgdGhpcy5sb2FkKHsgaWRlbnRpZmllciwgY29udHJvbGxlckNvbnN0cnVjdG9yIH0pO1xuICAgIH1cbiAgICByZWdpc3RlckFjdGlvbk9wdGlvbihuYW1lLCBmaWx0ZXIpIHtcbiAgICAgICAgdGhpcy5hY3Rpb25EZXNjcmlwdG9yRmlsdGVyc1tuYW1lXSA9IGZpbHRlcjtcbiAgICB9XG4gICAgbG9hZChoZWFkLCAuLi5yZXN0KSB7XG4gICAgICAgIGNvbnN0IGRlZmluaXRpb25zID0gQXJyYXkuaXNBcnJheShoZWFkKSA/IGhlYWQgOiBbaGVhZCwgLi4ucmVzdF07XG4gICAgICAgIGRlZmluaXRpb25zLmZvckVhY2goKGRlZmluaXRpb24pID0+IHtcbiAgICAgICAgICAgIGlmIChkZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3Rvci5zaG91bGRMb2FkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubG9hZERlZmluaXRpb24oZGVmaW5pdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB1bmxvYWQoaGVhZCwgLi4ucmVzdCkge1xuICAgICAgICBjb25zdCBpZGVudGlmaWVycyA9IEFycmF5LmlzQXJyYXkoaGVhZCkgPyBoZWFkIDogW2hlYWQsIC4uLnJlc3RdO1xuICAgICAgICBpZGVudGlmaWVycy5mb3JFYWNoKChpZGVudGlmaWVyKSA9PiB0aGlzLnJvdXRlci51bmxvYWRJZGVudGlmaWVyKGlkZW50aWZpZXIpKTtcbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3V0ZXIuY29udGV4dHMubWFwKChjb250ZXh0KSA9PiBjb250ZXh0LmNvbnRyb2xsZXIpO1xuICAgIH1cbiAgICBnZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5yb3V0ZXIuZ2V0Q29udGV4dEZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpO1xuICAgICAgICByZXR1cm4gY29udGV4dCA/IGNvbnRleHQuY29udHJvbGxlciA6IG51bGw7XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihgJXNcXG5cXG4lb1xcblxcbiVvYCwgbWVzc2FnZSwgZXJyb3IsIGRldGFpbCk7XG4gICAgICAgIChfYSA9IHdpbmRvdy5vbmVycm9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbCh3aW5kb3csIG1lc3NhZ2UsIFwiXCIsIDAsIDAsIGVycm9yKTtcbiAgICB9XG4gICAgbG9nRm9ybWF0dGVkTWVzc2FnZShpZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCA9IHt9KSB7XG4gICAgICAgIGRldGFpbCA9IE9iamVjdC5hc3NpZ24oeyBhcHBsaWNhdGlvbjogdGhpcyB9LCBkZXRhaWwpO1xuICAgICAgICB0aGlzLmxvZ2dlci5ncm91cENvbGxhcHNlZChgJHtpZGVudGlmaWVyfSAjJHtmdW5jdGlvbk5hbWV9YCk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZyhcImRldGFpbHM6XCIsIE9iamVjdC5hc3NpZ24oe30sIGRldGFpbCkpO1xuICAgICAgICB0aGlzLmxvZ2dlci5ncm91cEVuZCgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRvbVJlYWR5KCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSBcImxvYWRpbmdcIikge1xuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBDbGFzc1Byb3BlcnRpZXNCbGVzc2luZyhjb25zdHJ1Y3Rvcikge1xuICAgIGNvbnN0IGNsYXNzZXMgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgXCJjbGFzc2VzXCIpO1xuICAgIHJldHVybiBjbGFzc2VzLnJlZHVjZSgocHJvcGVydGllcywgY2xhc3NEZWZpbml0aW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnRpZXMsIHByb3BlcnRpZXNGb3JDbGFzc0RlZmluaXRpb24oY2xhc3NEZWZpbml0aW9uKSk7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gcHJvcGVydGllc0ZvckNsYXNzRGVmaW5pdGlvbihrZXkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBbYCR7a2V5fUNsYXNzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGNsYXNzZXMgfSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgaWYgKGNsYXNzZXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzZXMuZ2V0KGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBjbGFzc2VzLmdldEF0dHJpYnV0ZU5hbWUoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGF0dHJpYnV0ZSBcIiR7YXR0cmlidXRlfVwiYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2Ake2tleX1DbGFzc2VzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGFzc2VzLmdldEFsbChrZXkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2BoYXMke2NhcGl0YWxpemUoa2V5KX1DbGFzc2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3Nlcy5oYXMoa2V5KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gT3V0bGV0UHJvcGVydGllc0JsZXNzaW5nKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3Qgb3V0bGV0cyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBcIm91dGxldHNcIik7XG4gICAgcmV0dXJuIG91dGxldHMucmVkdWNlKChwcm9wZXJ0aWVzLCBvdXRsZXREZWZpbml0aW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnRpZXMsIHByb3BlcnRpZXNGb3JPdXRsZXREZWZpbml0aW9uKG91dGxldERlZmluaXRpb24pKTtcbiAgICB9LCB7fSk7XG59XG5mdW5jdGlvbiBnZXRPdXRsZXRDb250cm9sbGVyKGNvbnRyb2xsZXIsIGVsZW1lbnQsIGlkZW50aWZpZXIpIHtcbiAgICByZXR1cm4gY29udHJvbGxlci5hcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcik7XG59XG5mdW5jdGlvbiBnZXRDb250cm9sbGVyQW5kRW5zdXJlQ29ubmVjdGVkU2NvcGUoY29udHJvbGxlciwgZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgIGxldCBvdXRsZXRDb250cm9sbGVyID0gZ2V0T3V0bGV0Q29udHJvbGxlcihjb250cm9sbGVyLCBlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICBpZiAob3V0bGV0Q29udHJvbGxlcilcbiAgICAgICAgcmV0dXJuIG91dGxldENvbnRyb2xsZXI7XG4gICAgY29udHJvbGxlci5hcHBsaWNhdGlvbi5yb3V0ZXIucHJvcG9zZVRvQ29ubmVjdFNjb3BlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgb3V0bGV0Q29udHJvbGxlciA9IGdldE91dGxldENvbnRyb2xsZXIoY29udHJvbGxlciwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgaWYgKG91dGxldENvbnRyb2xsZXIpXG4gICAgICAgIHJldHVybiBvdXRsZXRDb250cm9sbGVyO1xufVxuZnVuY3Rpb24gcHJvcGVydGllc0Zvck91dGxldERlZmluaXRpb24obmFtZSkge1xuICAgIGNvbnN0IGNhbWVsaXplZE5hbWUgPSBuYW1lc3BhY2VDYW1lbGl6ZShuYW1lKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldEVsZW1lbnQgPSB0aGlzLm91dGxldHMuZmluZChuYW1lKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMub3V0bGV0cy5nZXRTZWxlY3RvckZvck91dGxldE5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG91dGxldEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0bGV0Q29udHJvbGxlciA9IGdldENvbnRyb2xsZXJBbmRFbnN1cmVDb25uZWN0ZWRTY29wZSh0aGlzLCBvdXRsZXRFbGVtZW50LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG91dGxldENvbnRyb2xsZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0bGV0Q29udHJvbGxlcjtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgcHJvdmlkZWQgb3V0bGV0IGVsZW1lbnQgaXMgbWlzc2luZyBhbiBvdXRsZXQgY29udHJvbGxlciBcIiR7bmFtZX1cIiBpbnN0YW5jZSBmb3IgaG9zdCBjb250cm9sbGVyIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCJgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIG91dGxldCBlbGVtZW50IFwiJHtuYW1lfVwiIGZvciBob3N0IGNvbnRyb2xsZXIgXCIke3RoaXMuaWRlbnRpZmllcn1cIi4gU3RpbXVsdXMgY291bGRuJ3QgZmluZCBhIG1hdGNoaW5nIG91dGxldCBlbGVtZW50IHVzaW5nIHNlbGVjdG9yIFwiJHtzZWxlY3Rvcn1cIi5gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtjYW1lbGl6ZWROYW1lfU91dGxldHNgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldHMgPSB0aGlzLm91dGxldHMuZmluZEFsbChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAob3V0bGV0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXRzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKChvdXRsZXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRDb250cm9sbGVyID0gZ2V0Q29udHJvbGxlckFuZEVuc3VyZUNvbm5lY3RlZFNjb3BlKHRoaXMsIG91dGxldEVsZW1lbnQsIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG91dGxldENvbnRyb2xsZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dGxldENvbnRyb2xsZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFRoZSBwcm92aWRlZCBvdXRsZXQgZWxlbWVudCBpcyBtaXNzaW5nIGFuIG91dGxldCBjb250cm9sbGVyIFwiJHtuYW1lfVwiIGluc3RhbmNlIGZvciBob3N0IGNvbnRyb2xsZXIgXCIke3RoaXMuaWRlbnRpZmllcn1cImAsIG91dGxldEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoY29udHJvbGxlcikgPT4gY29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtjYW1lbGl6ZWROYW1lfU91dGxldEVsZW1lbnRgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldEVsZW1lbnQgPSB0aGlzLm91dGxldHMuZmluZChuYW1lKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMub3V0bGV0cy5nZXRTZWxlY3RvckZvck91dGxldE5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG91dGxldEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dGxldEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3Npbmcgb3V0bGV0IGVsZW1lbnQgXCIke25hbWV9XCIgZm9yIGhvc3QgY29udHJvbGxlciBcIiR7dGhpcy5pZGVudGlmaWVyfVwiLiBTdGltdWx1cyBjb3VsZG4ndCBmaW5kIGEgbWF0Y2hpbmcgb3V0bGV0IGVsZW1lbnQgdXNpbmcgc2VsZWN0b3IgXCIke3NlbGVjdG9yfVwiLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtjYW1lbGl6ZWROYW1lfU91dGxldEVsZW1lbnRzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzLmZpbmRBbGwobmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYGhhcyR7Y2FwaXRhbGl6ZShjYW1lbGl6ZWROYW1lKX1PdXRsZXRgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm91dGxldHMuaGFzKG5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBUYXJnZXRQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCB0YXJnZXRzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwidGFyZ2V0c1wiKTtcbiAgICByZXR1cm4gdGFyZ2V0cy5yZWR1Y2UoKHByb3BlcnRpZXMsIHRhcmdldERlZmluaXRpb24pID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocHJvcGVydGllcywgcHJvcGVydGllc0ZvclRhcmdldERlZmluaXRpb24odGFyZ2V0RGVmaW5pdGlvbikpO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JUYXJnZXREZWZpbml0aW9uKG5hbWUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBbYCR7bmFtZX1UYXJnZXRgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMudGFyZ2V0cy5maW5kKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyB0YXJnZXQgZWxlbWVudCBcIiR7bmFtZX1cIiBmb3IgXCIke3RoaXMuaWRlbnRpZmllcn1cIiBjb250cm9sbGVyYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2Ake25hbWV9VGFyZ2V0c2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0cy5maW5kQWxsKG5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2BoYXMke2NhcGl0YWxpemUobmFtZSl9VGFyZ2V0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXRzLmhhcyhuYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gVmFsdWVQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCB2YWx1ZURlZmluaXRpb25QYWlycyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBcInZhbHVlc1wiKTtcbiAgICBjb25zdCBwcm9wZXJ0eURlc2NyaXB0b3JNYXAgPSB7XG4gICAgICAgIHZhbHVlRGVzY3JpcHRvck1hcDoge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZURlZmluaXRpb25QYWlycy5yZWR1Y2UoKHJlc3VsdCwgdmFsdWVEZWZpbml0aW9uUGFpcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZURlc2NyaXB0b3IgPSBwYXJzZVZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpciwgdGhpcy5pZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuZGF0YS5nZXRBdHRyaWJ1dGVOYW1lRm9yS2V5KHZhbHVlRGVzY3JpcHRvci5rZXkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihyZXN1bHQsIHsgW2F0dHJpYnV0ZU5hbWVdOiB2YWx1ZURlc2NyaXB0b3IgfSk7XG4gICAgICAgICAgICAgICAgfSwge30pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIHJldHVybiB2YWx1ZURlZmluaXRpb25QYWlycy5yZWR1Y2UoKHByb3BlcnRpZXMsIHZhbHVlRGVmaW5pdGlvblBhaXIpID0+IHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocHJvcGVydGllcywgcHJvcGVydGllc0ZvclZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpcikpO1xuICAgIH0sIHByb3BlcnR5RGVzY3JpcHRvck1hcCk7XG59XG5mdW5jdGlvbiBwcm9wZXJ0aWVzRm9yVmFsdWVEZWZpbml0aW9uUGFpcih2YWx1ZURlZmluaXRpb25QYWlyLCBjb250cm9sbGVyKSB7XG4gICAgY29uc3QgZGVmaW5pdGlvbiA9IHBhcnNlVmFsdWVEZWZpbml0aW9uUGFpcih2YWx1ZURlZmluaXRpb25QYWlyLCBjb250cm9sbGVyKTtcbiAgICBjb25zdCB7IGtleSwgbmFtZSwgcmVhZGVyOiByZWFkLCB3cml0ZXI6IHdyaXRlIH0gPSBkZWZpbml0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICAgIFtuYW1lXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5kYXRhLmdldChrZXkpO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVmaW5pdGlvbi5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5kZWxldGUoa2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5zZXQoa2V5LCB3cml0ZSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgaGFzJHtjYXBpdGFsaXplKG5hbWUpfWBdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5oYXMoa2V5KSB8fCBkZWZpbml0aW9uLmhhc0N1c3RvbURlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlVmFsdWVEZWZpbml0aW9uUGFpcihbdG9rZW4sIHR5cGVEZWZpbml0aW9uXSwgY29udHJvbGxlcikge1xuICAgIHJldHVybiB2YWx1ZURlc2NyaXB0b3JGb3JUb2tlbkFuZFR5cGVEZWZpbml0aW9uKHtcbiAgICAgICAgY29udHJvbGxlcixcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIHR5cGVEZWZpbml0aW9uLFxuICAgIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVDb25zdGFudChjb25zdGFudCkge1xuICAgIHN3aXRjaCAoY29uc3RhbnQpIHtcbiAgICAgICAgY2FzZSBBcnJheTpcbiAgICAgICAgICAgIHJldHVybiBcImFycmF5XCI7XG4gICAgICAgIGNhc2UgQm9vbGVhbjpcbiAgICAgICAgICAgIHJldHVybiBcImJvb2xlYW5cIjtcbiAgICAgICAgY2FzZSBOdW1iZXI6XG4gICAgICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgICAgY2FzZSBPYmplY3Q6XG4gICAgICAgICAgICByZXR1cm4gXCJvYmplY3RcIjtcbiAgICAgICAgY2FzZSBTdHJpbmc6XG4gICAgICAgICAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZVZhbHVlVHlwZURlZmF1bHQoZGVmYXVsdFZhbHVlKSB7XG4gICAgc3dpdGNoICh0eXBlb2YgZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgIGNhc2UgXCJib29sZWFuXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJib29sZWFuXCI7XG4gICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgIHJldHVybiBcIm51bWJlclwiO1xuICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZGVmYXVsdFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIFwiYXJyYXlcIjtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGRlZmF1bHRWYWx1ZSkgPT09IFwiW29iamVjdCBPYmplY3RdXCIpXG4gICAgICAgIHJldHVybiBcIm9iamVjdFwiO1xufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVPYmplY3QocGF5bG9hZCkge1xuICAgIGNvbnN0IHsgY29udHJvbGxlciwgdG9rZW4sIHR5cGVPYmplY3QgfSA9IHBheWxvYWQ7XG4gICAgY29uc3QgaGFzVHlwZSA9IGlzU29tZXRoaW5nKHR5cGVPYmplY3QudHlwZSk7XG4gICAgY29uc3QgaGFzRGVmYXVsdCA9IGlzU29tZXRoaW5nKHR5cGVPYmplY3QuZGVmYXVsdCk7XG4gICAgY29uc3QgZnVsbE9iamVjdCA9IGhhc1R5cGUgJiYgaGFzRGVmYXVsdDtcbiAgICBjb25zdCBvbmx5VHlwZSA9IGhhc1R5cGUgJiYgIWhhc0RlZmF1bHQ7XG4gICAgY29uc3Qgb25seURlZmF1bHQgPSAhaGFzVHlwZSAmJiBoYXNEZWZhdWx0O1xuICAgIGNvbnN0IHR5cGVGcm9tT2JqZWN0ID0gcGFyc2VWYWx1ZVR5cGVDb25zdGFudCh0eXBlT2JqZWN0LnR5cGUpO1xuICAgIGNvbnN0IHR5cGVGcm9tRGVmYXVsdFZhbHVlID0gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KHBheWxvYWQudHlwZU9iamVjdC5kZWZhdWx0KTtcbiAgICBpZiAob25seVR5cGUpXG4gICAgICAgIHJldHVybiB0eXBlRnJvbU9iamVjdDtcbiAgICBpZiAob25seURlZmF1bHQpXG4gICAgICAgIHJldHVybiB0eXBlRnJvbURlZmF1bHRWYWx1ZTtcbiAgICBpZiAodHlwZUZyb21PYmplY3QgIT09IHR5cGVGcm9tRGVmYXVsdFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnR5UGF0aCA9IGNvbnRyb2xsZXIgPyBgJHtjb250cm9sbGVyfS4ke3Rva2VufWAgOiB0b2tlbjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgc3BlY2lmaWVkIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSBTdGltdWx1cyBWYWx1ZSBcIiR7cHJvcGVydHlQYXRofVwiIG11c3QgbWF0Y2ggdGhlIGRlZmluZWQgdHlwZSBcIiR7dHlwZUZyb21PYmplY3R9XCIuIFRoZSBwcm92aWRlZCBkZWZhdWx0IHZhbHVlIG9mIFwiJHt0eXBlT2JqZWN0LmRlZmF1bHR9XCIgaXMgb2YgdHlwZSBcIiR7dHlwZUZyb21EZWZhdWx0VmFsdWV9XCIuYCk7XG4gICAgfVxuICAgIGlmIChmdWxsT2JqZWN0KVxuICAgICAgICByZXR1cm4gdHlwZUZyb21PYmplY3Q7XG59XG5mdW5jdGlvbiBwYXJzZVZhbHVlVHlwZURlZmluaXRpb24ocGF5bG9hZCkge1xuICAgIGNvbnN0IHsgY29udHJvbGxlciwgdG9rZW4sIHR5cGVEZWZpbml0aW9uIH0gPSBwYXlsb2FkO1xuICAgIGNvbnN0IHR5cGVPYmplY3QgPSB7IGNvbnRyb2xsZXIsIHRva2VuLCB0eXBlT2JqZWN0OiB0eXBlRGVmaW5pdGlvbiB9O1xuICAgIGNvbnN0IHR5cGVGcm9tT2JqZWN0ID0gcGFyc2VWYWx1ZVR5cGVPYmplY3QodHlwZU9iamVjdCk7XG4gICAgY29uc3QgdHlwZUZyb21EZWZhdWx0VmFsdWUgPSBwYXJzZVZhbHVlVHlwZURlZmF1bHQodHlwZURlZmluaXRpb24pO1xuICAgIGNvbnN0IHR5cGVGcm9tQ29uc3RhbnQgPSBwYXJzZVZhbHVlVHlwZUNvbnN0YW50KHR5cGVEZWZpbml0aW9uKTtcbiAgICBjb25zdCB0eXBlID0gdHlwZUZyb21PYmplY3QgfHwgdHlwZUZyb21EZWZhdWx0VmFsdWUgfHwgdHlwZUZyb21Db25zdGFudDtcbiAgICBpZiAodHlwZSlcbiAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgY29uc3QgcHJvcGVydHlQYXRoID0gY29udHJvbGxlciA/IGAke2NvbnRyb2xsZXJ9LiR7dHlwZURlZmluaXRpb259YCA6IHRva2VuO1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB2YWx1ZSB0eXBlIFwiJHtwcm9wZXJ0eVBhdGh9XCIgZm9yIFwiJHt0b2tlbn1cIiB2YWx1ZWApO1xufVxuZnVuY3Rpb24gZGVmYXVsdFZhbHVlRm9yRGVmaW5pdGlvbih0eXBlRGVmaW5pdGlvbikge1xuICAgIGNvbnN0IGNvbnN0YW50ID0gcGFyc2VWYWx1ZVR5cGVDb25zdGFudCh0eXBlRGVmaW5pdGlvbik7XG4gICAgaWYgKGNvbnN0YW50KVxuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlc0J5VHlwZVtjb25zdGFudF07XG4gICAgY29uc3QgaGFzRGVmYXVsdCA9IGhhc1Byb3BlcnR5KHR5cGVEZWZpbml0aW9uLCBcImRlZmF1bHRcIik7XG4gICAgY29uc3QgaGFzVHlwZSA9IGhhc1Byb3BlcnR5KHR5cGVEZWZpbml0aW9uLCBcInR5cGVcIik7XG4gICAgY29uc3QgdHlwZU9iamVjdCA9IHR5cGVEZWZpbml0aW9uO1xuICAgIGlmIChoYXNEZWZhdWx0KVxuICAgICAgICByZXR1cm4gdHlwZU9iamVjdC5kZWZhdWx0O1xuICAgIGlmIChoYXNUeXBlKSB7XG4gICAgICAgIGNvbnN0IHsgdHlwZSB9ID0gdHlwZU9iamVjdDtcbiAgICAgICAgY29uc3QgY29uc3RhbnRGcm9tVHlwZSA9IHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQodHlwZSk7XG4gICAgICAgIGlmIChjb25zdGFudEZyb21UeXBlKVxuICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZXNCeVR5cGVbY29uc3RhbnRGcm9tVHlwZV07XG4gICAgfVxuICAgIHJldHVybiB0eXBlRGVmaW5pdGlvbjtcbn1cbmZ1bmN0aW9uIHZhbHVlRGVzY3JpcHRvckZvclRva2VuQW5kVHlwZURlZmluaXRpb24ocGF5bG9hZCkge1xuICAgIGNvbnN0IHsgdG9rZW4sIHR5cGVEZWZpbml0aW9uIH0gPSBwYXlsb2FkO1xuICAgIGNvbnN0IGtleSA9IGAke2Rhc2hlcml6ZSh0b2tlbil9LXZhbHVlYDtcbiAgICBjb25zdCB0eXBlID0gcGFyc2VWYWx1ZVR5cGVEZWZpbml0aW9uKHBheWxvYWQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGUsXG4gICAgICAgIGtleSxcbiAgICAgICAgbmFtZTogY2FtZWxpemUoa2V5KSxcbiAgICAgICAgZ2V0IGRlZmF1bHRWYWx1ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWVGb3JEZWZpbml0aW9uKHR5cGVEZWZpbml0aW9uKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0IGhhc0N1c3RvbURlZmF1bHRWYWx1ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVZhbHVlVHlwZURlZmF1bHQodHlwZURlZmluaXRpb24pICE9PSB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHJlYWRlcjogcmVhZGVyc1t0eXBlXSxcbiAgICAgICAgd3JpdGVyOiB3cml0ZXJzW3R5cGVdIHx8IHdyaXRlcnMuZGVmYXVsdCxcbiAgICB9O1xufVxuY29uc3QgZGVmYXVsdFZhbHVlc0J5VHlwZSA9IHtcbiAgICBnZXQgYXJyYXkoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9LFxuICAgIGJvb2xlYW46IGZhbHNlLFxuICAgIG51bWJlcjogMCxcbiAgICBnZXQgb2JqZWN0KCkge1xuICAgICAgICByZXR1cm4ge307XG4gICAgfSxcbiAgICBzdHJpbmc6IFwiXCIsXG59O1xuY29uc3QgcmVhZGVycyA9IHtcbiAgICBhcnJheSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBhcnJheSA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBleHBlY3RlZCB2YWx1ZSBvZiB0eXBlIFwiYXJyYXlcIiBidXQgaW5zdGVhZCBnb3QgdmFsdWUgXCIke3ZhbHVlfVwiIG9mIHR5cGUgXCIke3BhcnNlVmFsdWVUeXBlRGVmYXVsdChhcnJheSl9XCJgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgfSxcbiAgICBib29sZWFuKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhKHZhbHVlID09IFwiMFwiIHx8IFN0cmluZyh2YWx1ZSkudG9Mb3dlckNhc2UoKSA9PSBcImZhbHNlXCIpO1xuICAgIH0sXG4gICAgbnVtYmVyKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUucmVwbGFjZSgvXy9nLCBcIlwiKSk7XG4gICAgfSxcbiAgICBvYmplY3QodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIGlmIChvYmplY3QgPT09IG51bGwgfHwgdHlwZW9mIG9iamVjdCAhPSBcIm9iamVjdFwiIHx8IEFycmF5LmlzQXJyYXkob2JqZWN0KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgZXhwZWN0ZWQgdmFsdWUgb2YgdHlwZSBcIm9iamVjdFwiIGJ1dCBpbnN0ZWFkIGdvdCB2YWx1ZSBcIiR7dmFsdWV9XCIgb2YgdHlwZSBcIiR7cGFyc2VWYWx1ZVR5cGVEZWZhdWx0KG9iamVjdCl9XCJgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH0sXG4gICAgc3RyaW5nKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxufTtcbmNvbnN0IHdyaXRlcnMgPSB7XG4gICAgZGVmYXVsdDogd3JpdGVTdHJpbmcsXG4gICAgYXJyYXk6IHdyaXRlSlNPTixcbiAgICBvYmplY3Q6IHdyaXRlSlNPTixcbn07XG5mdW5jdGlvbiB3cml0ZUpTT04odmFsdWUpIHtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xufVxuZnVuY3Rpb24gd3JpdGVTdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gYCR7dmFsdWV9YDtcbn1cblxuY2xhc3MgQ29udHJvbGxlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCkge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IHNob3VsZExvYWQoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBzdGF0aWMgYWZ0ZXJMb2FkKF9pZGVudGlmaWVyLCBfYXBwbGljYXRpb24pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBnZXQgYXBwbGljYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuYXBwbGljYXRpb247XG4gICAgfVxuICAgIGdldCBzY29wZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zY29wZTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgdGFyZ2V0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUudGFyZ2V0cztcbiAgICB9XG4gICAgZ2V0IG91dGxldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLm91dGxldHM7XG4gICAgfVxuICAgIGdldCBjbGFzc2VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5jbGFzc2VzO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZGF0YTtcbiAgICB9XG4gICAgaW5pdGlhbGl6ZSgpIHtcbiAgICB9XG4gICAgY29ubmVjdCgpIHtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICB9XG4gICAgZGlzcGF0Y2goZXZlbnROYW1lLCB7IHRhcmdldCA9IHRoaXMuZWxlbWVudCwgZGV0YWlsID0ge30sIHByZWZpeCA9IHRoaXMuaWRlbnRpZmllciwgYnViYmxlcyA9IHRydWUsIGNhbmNlbGFibGUgPSB0cnVlLCB9ID0ge30pIHtcbiAgICAgICAgY29uc3QgdHlwZSA9IHByZWZpeCA/IGAke3ByZWZpeH06JHtldmVudE5hbWV9YCA6IGV2ZW50TmFtZTtcbiAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQodHlwZSwgeyBkZXRhaWwsIGJ1YmJsZXMsIGNhbmNlbGFibGUgfSk7XG4gICAgICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgIH1cbn1cbkNvbnRyb2xsZXIuYmxlc3NpbmdzID0gW1xuICAgIENsYXNzUHJvcGVydGllc0JsZXNzaW5nLFxuICAgIFRhcmdldFByb3BlcnRpZXNCbGVzc2luZyxcbiAgICBWYWx1ZVByb3BlcnRpZXNCbGVzc2luZyxcbiAgICBPdXRsZXRQcm9wZXJ0aWVzQmxlc3NpbmcsXG5dO1xuQ29udHJvbGxlci50YXJnZXRzID0gW107XG5Db250cm9sbGVyLm91dGxldHMgPSBbXTtcbkNvbnRyb2xsZXIudmFsdWVzID0ge307XG5cbmV4cG9ydCB7IEFwcGxpY2F0aW9uLCBBdHRyaWJ1dGVPYnNlcnZlciwgQ29udGV4dCwgQ29udHJvbGxlciwgRWxlbWVudE9ic2VydmVyLCBJbmRleGVkTXVsdGltYXAsIE11bHRpbWFwLCBTZWxlY3Rvck9ic2VydmVyLCBTdHJpbmdNYXBPYnNlcnZlciwgVG9rZW5MaXN0T2JzZXJ2ZXIsIFZhbHVlTGlzdE9ic2VydmVyLCBhZGQsIGRlZmF1bHRTY2hlbWEsIGRlbCwgZmV0Y2gsIHBydW5lIH07XG4iLCIvKiFcblR1cmJvIDguMC41XG5Db3B5cmlnaHQgwqkgMjAyNCAzN3NpZ25hbHMgTExDXG4gKi9cbi8qKlxuICogVGhlIE1JVCBMaWNlbnNlIChNSVQpXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE5IEphdmFuIE1ha2htYWxpXG4gKlxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICpcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqL1xuXG4oZnVuY3Rpb24gKHByb3RvdHlwZSkge1xuICBpZiAodHlwZW9mIHByb3RvdHlwZS5yZXF1ZXN0U3VibWl0ID09IFwiZnVuY3Rpb25cIikgcmV0dXJuXG5cbiAgcHJvdG90eXBlLnJlcXVlc3RTdWJtaXQgPSBmdW5jdGlvbiAoc3VibWl0dGVyKSB7XG4gICAgaWYgKHN1Ym1pdHRlcikge1xuICAgICAgdmFsaWRhdGVTdWJtaXR0ZXIoc3VibWl0dGVyLCB0aGlzKTtcbiAgICAgIHN1Ym1pdHRlci5jbGljaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWJtaXR0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICBzdWJtaXR0ZXIudHlwZSA9IFwic3VibWl0XCI7XG4gICAgICBzdWJtaXR0ZXIuaGlkZGVuID0gdHJ1ZTtcbiAgICAgIHRoaXMuYXBwZW5kQ2hpbGQoc3VibWl0dGVyKTtcbiAgICAgIHN1Ym1pdHRlci5jbGljaygpO1xuICAgICAgdGhpcy5yZW1vdmVDaGlsZChzdWJtaXR0ZXIpO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiB2YWxpZGF0ZVN1Ym1pdHRlcihzdWJtaXR0ZXIsIGZvcm0pIHtcbiAgICBzdWJtaXR0ZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCB8fCByYWlzZShUeXBlRXJyb3IsIFwicGFyYW1ldGVyIDEgaXMgbm90IG9mIHR5cGUgJ0hUTUxFbGVtZW50J1wiKTtcbiAgICBzdWJtaXR0ZXIudHlwZSA9PSBcInN1Ym1pdFwiIHx8IHJhaXNlKFR5cGVFcnJvciwgXCJUaGUgc3BlY2lmaWVkIGVsZW1lbnQgaXMgbm90IGEgc3VibWl0IGJ1dHRvblwiKTtcbiAgICBzdWJtaXR0ZXIuZm9ybSA9PSBmb3JtIHx8XG4gICAgICByYWlzZShET01FeGNlcHRpb24sIFwiVGhlIHNwZWNpZmllZCBlbGVtZW50IGlzIG5vdCBvd25lZCBieSB0aGlzIGZvcm0gZWxlbWVudFwiLCBcIk5vdEZvdW5kRXJyb3JcIik7XG4gIH1cblxuICBmdW5jdGlvbiByYWlzZShlcnJvckNvbnN0cnVjdG9yLCBtZXNzYWdlLCBuYW1lKSB7XG4gICAgdGhyb3cgbmV3IGVycm9yQ29uc3RydWN0b3IoXCJGYWlsZWQgdG8gZXhlY3V0ZSAncmVxdWVzdFN1Ym1pdCcgb24gJ0hUTUxGb3JtRWxlbWVudCc6IFwiICsgbWVzc2FnZSArIFwiLlwiLCBuYW1lKVxuICB9XG59KShIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlKTtcblxuY29uc3Qgc3VibWl0dGVyc0J5Rm9ybSA9IG5ldyBXZWFrTWFwKCk7XG5cbmZ1bmN0aW9uIGZpbmRTdWJtaXR0ZXJGcm9tQ2xpY2tUYXJnZXQodGFyZ2V0KSB7XG4gIGNvbnN0IGVsZW1lbnQgPSB0YXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50ID8gdGFyZ2V0IDogdGFyZ2V0IGluc3RhbmNlb2YgTm9kZSA/IHRhcmdldC5wYXJlbnRFbGVtZW50IDogbnVsbDtcbiAgY29uc3QgY2FuZGlkYXRlID0gZWxlbWVudCA/IGVsZW1lbnQuY2xvc2VzdChcImlucHV0LCBidXR0b25cIikgOiBudWxsO1xuICByZXR1cm4gY2FuZGlkYXRlPy50eXBlID09IFwic3VibWl0XCIgPyBjYW5kaWRhdGUgOiBudWxsXG59XG5cbmZ1bmN0aW9uIGNsaWNrQ2FwdHVyZWQoZXZlbnQpIHtcbiAgY29uc3Qgc3VibWl0dGVyID0gZmluZFN1Ym1pdHRlckZyb21DbGlja1RhcmdldChldmVudC50YXJnZXQpO1xuXG4gIGlmIChzdWJtaXR0ZXIgJiYgc3VibWl0dGVyLmZvcm0pIHtcbiAgICBzdWJtaXR0ZXJzQnlGb3JtLnNldChzdWJtaXR0ZXIuZm9ybSwgc3VibWl0dGVyKTtcbiAgfVxufVxuXG4oZnVuY3Rpb24gKCkge1xuICBpZiAoXCJzdWJtaXR0ZXJcIiBpbiBFdmVudC5wcm90b3R5cGUpIHJldHVyblxuXG4gIGxldCBwcm90b3R5cGUgPSB3aW5kb3cuRXZlbnQucHJvdG90eXBlO1xuICAvLyBDZXJ0YWluIHZlcnNpb25zIG9mIFNhZmFyaSAxNSBoYXZlIGEgYnVnIHdoZXJlIHRoZXkgd29uJ3RcbiAgLy8gcG9wdWxhdGUgdGhlIHN1Ym1pdHRlci4gVGhpcyBodXJ0cyBUdXJib0RyaXZlJ3MgZW5hYmxlL2Rpc2FibGUgZGV0ZWN0aW9uLlxuICAvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTIyOTY2MFxuICBpZiAoXCJTdWJtaXRFdmVudFwiIGluIHdpbmRvdykge1xuICAgIGNvbnN0IHByb3RvdHlwZU9mU3VibWl0RXZlbnQgPSB3aW5kb3cuU3VibWl0RXZlbnQucHJvdG90eXBlO1xuXG4gICAgaWYgKC9BcHBsZSBDb21wdXRlci8udGVzdChuYXZpZ2F0b3IudmVuZG9yKSAmJiAhKFwic3VibWl0dGVyXCIgaW4gcHJvdG90eXBlT2ZTdWJtaXRFdmVudCkpIHtcbiAgICAgIHByb3RvdHlwZSA9IHByb3RvdHlwZU9mU3VibWl0RXZlbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAvLyBwb2x5ZmlsbCBub3QgbmVlZGVkXG4gICAgfVxuICB9XG5cbiAgYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrQ2FwdHVyZWQsIHRydWUpO1xuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90b3R5cGUsIFwic3VibWl0dGVyXCIsIHtcbiAgICBnZXQoKSB7XG4gICAgICBpZiAodGhpcy50eXBlID09IFwic3VibWl0XCIgJiYgdGhpcy50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHN1Ym1pdHRlcnNCeUZvcm0uZ2V0KHRoaXMudGFyZ2V0KVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59KSgpO1xuXG5jb25zdCBGcmFtZUxvYWRpbmdTdHlsZSA9IHtcbiAgZWFnZXI6IFwiZWFnZXJcIixcbiAgbGF6eTogXCJsYXp5XCJcbn07XG5cbi8qKlxuICogQ29udGFpbnMgYSBmcmFnbWVudCBvZiBIVE1MIHdoaWNoIGlzIHVwZGF0ZWQgYmFzZWQgb24gbmF2aWdhdGlvbiB3aXRoaW5cbiAqIGl0IChlLmcuIHZpYSBsaW5rcyBvciBmb3JtIHN1Ym1pc3Npb25zKS5cbiAqXG4gKiBAY3VzdG9tRWxlbWVudCB0dXJiby1mcmFtZVxuICogQGV4YW1wbGVcbiAqICAgPHR1cmJvLWZyYW1lIGlkPVwibWVzc2FnZXNcIj5cbiAqICAgICA8YSBocmVmPVwiL21lc3NhZ2VzL2V4cGFuZGVkXCI+XG4gKiAgICAgICBTaG93IGFsbCBleHBhbmRlZCBtZXNzYWdlcyBpbiB0aGlzIGZyYW1lLlxuICogICAgIDwvYT5cbiAqXG4gKiAgICAgPGZvcm0gYWN0aW9uPVwiL21lc3NhZ2VzXCI+XG4gKiAgICAgICBTaG93IHJlc3BvbnNlIGZyb20gdGhpcyBmb3JtIHdpdGhpbiB0aGlzIGZyYW1lLlxuICogICAgIDwvZm9ybT5cbiAqICAgPC90dXJiby1mcmFtZT5cbiAqL1xuY2xhc3MgRnJhbWVFbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdGF0aWMgZGVsZWdhdGVDb25zdHJ1Y3RvciA9IHVuZGVmaW5lZFxuXG4gIGxvYWRlZCA9IFByb21pc2UucmVzb2x2ZSgpXG5cbiAgc3RhdGljIGdldCBvYnNlcnZlZEF0dHJpYnV0ZXMoKSB7XG4gICAgcmV0dXJuIFtcImRpc2FibGVkXCIsIFwibG9hZGluZ1wiLCBcInNyY1wiXVxuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmRlbGVnYXRlID0gbmV3IEZyYW1lRWxlbWVudC5kZWxlZ2F0ZUNvbnN0cnVjdG9yKHRoaXMpO1xuICB9XG5cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5jb25uZWN0KCk7XG4gIH1cblxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLmRlbGVnYXRlLmRpc2Nvbm5lY3QoKTtcbiAgfVxuXG4gIHJlbG9hZCgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5zb3VyY2VVUkxSZWxvYWRlZCgpXG4gIH1cblxuICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2sobmFtZSkge1xuICAgIGlmIChuYW1lID09IFwibG9hZGluZ1wiKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLmxvYWRpbmdTdHlsZUNoYW5nZWQoKTtcbiAgICB9IGVsc2UgaWYgKG5hbWUgPT0gXCJzcmNcIikge1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5zb3VyY2VVUkxDaGFuZ2VkKCk7XG4gICAgfSBlbHNlIGlmIChuYW1lID09IFwiZGlzYWJsZWRcIikge1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5kaXNhYmxlZENoYW5nZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgVVJMIHRvIGxhemlseSBsb2FkIHNvdXJjZSBIVE1MIGZyb21cbiAgICovXG4gIGdldCBzcmMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwic3JjXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgVVJMIHRvIGxhemlseSBsb2FkIHNvdXJjZSBIVE1MIGZyb21cbiAgICovXG4gIHNldCBzcmModmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwic3JjXCIsIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoXCJzcmNcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHJlZnJlc2ggbW9kZSBmb3IgdGhlIGZyYW1lLlxuICAgKi9cbiAgZ2V0IHJlZnJlc2goKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwicmVmcmVzaFwiKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHJlZnJlc2ggbW9kZSBmb3IgdGhlIGZyYW1lLlxuICAgKi9cbiAgc2V0IHJlZnJlc2godmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwicmVmcmVzaFwiLCB2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwicmVmcmVzaFwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgZWxlbWVudCBpcyBsb2FkaW5nXG4gICAqL1xuICBnZXQgbG9hZGluZygpIHtcbiAgICByZXR1cm4gZnJhbWVMb2FkaW5nU3R5bGVGcm9tU3RyaW5nKHRoaXMuZ2V0QXR0cmlidXRlKFwibG9hZGluZ1wiKSB8fCBcIlwiKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHZhbHVlIG9mIGlmIHRoZSBlbGVtZW50IGlzIGxvYWRpbmdcbiAgICovXG4gIHNldCBsb2FkaW5nKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImxvYWRpbmdcIiwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcImxvYWRpbmdcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc2FibGVkIHN0YXRlIG9mIHRoZSBmcmFtZS5cbiAgICpcbiAgICogSWYgZGlzYWJsZWQsIG5vIHJlcXVlc3RzIHdpbGwgYmUgaW50ZXJjZXB0ZWQgYnkgdGhlIGZyYW1lLlxuICAgKi9cbiAgZ2V0IGRpc2FibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmhhc0F0dHJpYnV0ZShcImRpc2FibGVkXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgZGlzYWJsZWQgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiBkaXNhYmxlZCwgbm8gcmVxdWVzdHMgd2lsbCBiZSBpbnRlcmNlcHRlZCBieSB0aGUgZnJhbWUuXG4gICAqL1xuICBzZXQgZGlzYWJsZWQodmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGF1dG9zY3JvbGwgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiB0cnVlLCB0aGUgZnJhbWUgd2lsbCBiZSBzY3JvbGxlZCBpbnRvIHZpZXcgYXV0b21hdGljYWxseSBvbiB1cGRhdGUuXG4gICAqL1xuICBnZXQgYXV0b3Njcm9sbCgpIHtcbiAgICByZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoXCJhdXRvc2Nyb2xsXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYXV0b3Njcm9sbCBzdGF0ZSBvZiB0aGUgZnJhbWUuXG4gICAqXG4gICAqIElmIHRydWUsIHRoZSBmcmFtZSB3aWxsIGJlIHNjcm9sbGVkIGludG8gdmlldyBhdXRvbWF0aWNhbGx5IG9uIHVwZGF0ZS5cbiAgICovXG4gIHNldCBhdXRvc2Nyb2xsKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImF1dG9zY3JvbGxcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiYXV0b3Njcm9sbFwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgZWxlbWVudCBoYXMgZmluaXNoZWQgbG9hZGluZ1xuICAgKi9cbiAgZ2V0IGNvbXBsZXRlKCkge1xuICAgIHJldHVybiAhdGhpcy5kZWxlZ2F0ZS5pc0xvYWRpbmdcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBhY3RpdmUgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiBpbmFjdGl2ZSwgc291cmNlIGNoYW5nZXMgd2lsbCBub3QgYmUgb2JzZXJ2ZWQuXG4gICAqL1xuICBnZXQgaXNBY3RpdmUoKSB7XG4gICAgcmV0dXJuIHRoaXMub3duZXJEb2N1bWVudCA9PT0gZG9jdW1lbnQgJiYgIXRoaXMuaXNQcmV2aWV3XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYWN0aXZlIHN0YXRlIG9mIHRoZSBmcmFtZS5cbiAgICpcbiAgICogSWYgaW5hY3RpdmUsIHNvdXJjZSBjaGFuZ2VzIHdpbGwgbm90IGJlIG9ic2VydmVkLlxuICAgKi9cbiAgZ2V0IGlzUHJldmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5vd25lckRvY3VtZW50Py5kb2N1bWVudEVsZW1lbnQ/Lmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tcHJldmlld1wiKVxuICB9XG59XG5cbmZ1bmN0aW9uIGZyYW1lTG9hZGluZ1N0eWxlRnJvbVN0cmluZyhzdHlsZSkge1xuICBzd2l0Y2ggKHN0eWxlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlIFwibGF6eVwiOlxuICAgICAgcmV0dXJuIEZyYW1lTG9hZGluZ1N0eWxlLmxhenlcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIEZyYW1lTG9hZGluZ1N0eWxlLmVhZ2VyXG4gIH1cbn1cblxuZnVuY3Rpb24gZXhwYW5kVVJMKGxvY2F0YWJsZSkge1xuICByZXR1cm4gbmV3IFVSTChsb2NhdGFibGUudG9TdHJpbmcoKSwgZG9jdW1lbnQuYmFzZVVSSSlcbn1cblxuZnVuY3Rpb24gZ2V0QW5jaG9yKHVybCkge1xuICBsZXQgYW5jaG9yTWF0Y2g7XG4gIGlmICh1cmwuaGFzaCkge1xuICAgIHJldHVybiB1cmwuaGFzaC5zbGljZSgxKVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25kLWFzc2lnblxuICB9IGVsc2UgaWYgKChhbmNob3JNYXRjaCA9IHVybC5ocmVmLm1hdGNoKC8jKC4qKSQvKSkpIHtcbiAgICByZXR1cm4gYW5jaG9yTWF0Y2hbMV1cbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRBY3Rpb24kMShmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgY29uc3QgYWN0aW9uID0gc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJmb3JtYWN0aW9uXCIpIHx8IGZvcm0uZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpIHx8IGZvcm0uYWN0aW9uO1xuXG4gIHJldHVybiBleHBhbmRVUkwoYWN0aW9uKVxufVxuXG5mdW5jdGlvbiBnZXRFeHRlbnNpb24odXJsKSB7XG4gIHJldHVybiAoZ2V0TGFzdFBhdGhDb21wb25lbnQodXJsKS5tYXRjaCgvXFwuW14uXSokLykgfHwgW10pWzBdIHx8IFwiXCJcbn1cblxuZnVuY3Rpb24gaXNIVE1MKHVybCkge1xuICByZXR1cm4gISFnZXRFeHRlbnNpb24odXJsKS5tYXRjaCgvXig/OnxcXC4oPzpodG18aHRtbHx4aHRtbHxwaHApKSQvKVxufVxuXG5mdW5jdGlvbiBpc1ByZWZpeGVkQnkoYmFzZVVSTCwgdXJsKSB7XG4gIGNvbnN0IHByZWZpeCA9IGdldFByZWZpeCh1cmwpO1xuICByZXR1cm4gYmFzZVVSTC5ocmVmID09PSBleHBhbmRVUkwocHJlZml4KS5ocmVmIHx8IGJhc2VVUkwuaHJlZi5zdGFydHNXaXRoKHByZWZpeClcbn1cblxuZnVuY3Rpb24gbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgcm9vdExvY2F0aW9uKSB7XG4gIHJldHVybiBpc1ByZWZpeGVkQnkobG9jYXRpb24sIHJvb3RMb2NhdGlvbikgJiYgaXNIVE1MKGxvY2F0aW9uKVxufVxuXG5mdW5jdGlvbiBnZXRSZXF1ZXN0VVJMKHVybCkge1xuICBjb25zdCBhbmNob3IgPSBnZXRBbmNob3IodXJsKTtcbiAgcmV0dXJuIGFuY2hvciAhPSBudWxsID8gdXJsLmhyZWYuc2xpY2UoMCwgLShhbmNob3IubGVuZ3RoICsgMSkpIDogdXJsLmhyZWZcbn1cblxuZnVuY3Rpb24gdG9DYWNoZUtleSh1cmwpIHtcbiAgcmV0dXJuIGdldFJlcXVlc3RVUkwodXJsKVxufVxuXG5mdW5jdGlvbiB1cmxzQXJlRXF1YWwobGVmdCwgcmlnaHQpIHtcbiAgcmV0dXJuIGV4cGFuZFVSTChsZWZ0KS5ocmVmID09IGV4cGFuZFVSTChyaWdodCkuaHJlZlxufVxuXG5mdW5jdGlvbiBnZXRQYXRoQ29tcG9uZW50cyh1cmwpIHtcbiAgcmV0dXJuIHVybC5wYXRobmFtZS5zcGxpdChcIi9cIikuc2xpY2UoMSlcbn1cblxuZnVuY3Rpb24gZ2V0TGFzdFBhdGhDb21wb25lbnQodXJsKSB7XG4gIHJldHVybiBnZXRQYXRoQ29tcG9uZW50cyh1cmwpLnNsaWNlKC0xKVswXVxufVxuXG5mdW5jdGlvbiBnZXRQcmVmaXgodXJsKSB7XG4gIHJldHVybiBhZGRUcmFpbGluZ1NsYXNoKHVybC5vcmlnaW4gKyB1cmwucGF0aG5hbWUpXG59XG5cbmZ1bmN0aW9uIGFkZFRyYWlsaW5nU2xhc2godmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLmVuZHNXaXRoKFwiL1wiKSA/IHZhbHVlIDogdmFsdWUgKyBcIi9cIlxufVxuXG5jbGFzcyBGZXRjaFJlc3BvbnNlIHtcbiAgY29uc3RydWN0b3IocmVzcG9uc2UpIHtcbiAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gIH1cblxuICBnZXQgc3VjY2VlZGVkKCkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlLm9rXG4gIH1cblxuICBnZXQgZmFpbGVkKCkge1xuICAgIHJldHVybiAhdGhpcy5zdWNjZWVkZWRcbiAgfVxuXG4gIGdldCBjbGllbnRFcnJvcigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXNDb2RlID49IDQwMCAmJiB0aGlzLnN0YXR1c0NvZGUgPD0gNDk5XG4gIH1cblxuICBnZXQgc2VydmVyRXJyb3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzQ29kZSA+PSA1MDAgJiYgdGhpcy5zdGF0dXNDb2RlIDw9IDU5OVxuICB9XG5cbiAgZ2V0IHJlZGlyZWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzcG9uc2UucmVkaXJlY3RlZFxuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiBleHBhbmRVUkwodGhpcy5yZXNwb25zZS51cmwpXG4gIH1cblxuICBnZXQgaXNIVE1MKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRlbnRUeXBlICYmIHRoaXMuY29udGVudFR5cGUubWF0Y2goL14oPzp0ZXh0XFwvKFteXFxzOyxdK1xcYik/aHRtbHxhcHBsaWNhdGlvblxcL3hodG1sXFwreG1sKVxcYi8pXG4gIH1cblxuICBnZXQgc3RhdHVzQ29kZSgpIHtcbiAgICByZXR1cm4gdGhpcy5yZXNwb25zZS5zdGF0dXNcbiAgfVxuXG4gIGdldCBjb250ZW50VHlwZSgpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkZXIoXCJDb250ZW50LVR5cGVcIilcbiAgfVxuXG4gIGdldCByZXNwb25zZVRleHQoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzcG9uc2UuY2xvbmUoKS50ZXh0KClcbiAgfVxuXG4gIGdldCByZXNwb25zZUhUTUwoKSB7XG4gICAgaWYgKHRoaXMuaXNIVE1MKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXNwb25zZS5jbG9uZSgpLnRleHQoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZClcbiAgICB9XG4gIH1cblxuICBoZWFkZXIobmFtZSkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlLmhlYWRlcnMuZ2V0KG5hbWUpXG4gIH1cbn1cblxuZnVuY3Rpb24gYWN0aXZhdGVTY3JpcHRFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1ldmFsXCIpID09IFwiZmFsc2VcIikge1xuICAgIHJldHVybiBlbGVtZW50XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgY3JlYXRlZFNjcmlwdEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xuICAgIGNvbnN0IGNzcE5vbmNlID0gZ2V0TWV0YUNvbnRlbnQoXCJjc3Atbm9uY2VcIik7XG4gICAgaWYgKGNzcE5vbmNlKSB7XG4gICAgICBjcmVhdGVkU2NyaXB0RWxlbWVudC5ub25jZSA9IGNzcE5vbmNlO1xuICAgIH1cbiAgICBjcmVhdGVkU2NyaXB0RWxlbWVudC50ZXh0Q29udGVudCA9IGVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgY3JlYXRlZFNjcmlwdEVsZW1lbnQuYXN5bmMgPSBmYWxzZTtcbiAgICBjb3B5RWxlbWVudEF0dHJpYnV0ZXMoY3JlYXRlZFNjcmlwdEVsZW1lbnQsIGVsZW1lbnQpO1xuICAgIHJldHVybiBjcmVhdGVkU2NyaXB0RWxlbWVudFxuICB9XG59XG5cbmZ1bmN0aW9uIGNvcHlFbGVtZW50QXR0cmlidXRlcyhkZXN0aW5hdGlvbkVsZW1lbnQsIHNvdXJjZUVsZW1lbnQpIHtcbiAgZm9yIChjb25zdCB7IG5hbWUsIHZhbHVlIH0gb2Ygc291cmNlRWxlbWVudC5hdHRyaWJ1dGVzKSB7XG4gICAgZGVzdGluYXRpb25FbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRGcmFnbWVudChodG1sKSB7XG4gIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRlbXBsYXRlXCIpO1xuICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBodG1sO1xuICByZXR1cm4gdGVtcGxhdGUuY29udGVudFxufVxuXG5mdW5jdGlvbiBkaXNwYXRjaChldmVudE5hbWUsIHsgdGFyZ2V0LCBjYW5jZWxhYmxlLCBkZXRhaWwgfSA9IHt9KSB7XG4gIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KGV2ZW50TmFtZSwge1xuICAgIGNhbmNlbGFibGUsXG4gICAgYnViYmxlczogdHJ1ZSxcbiAgICBjb21wb3NlZDogdHJ1ZSxcbiAgICBkZXRhaWxcbiAgfSk7XG5cbiAgaWYgKHRhcmdldCAmJiB0YXJnZXQuaXNDb25uZWN0ZWQpIHtcbiAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gIH0gZWxzZSB7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9XG5cbiAgcmV0dXJuIGV2ZW50XG59XG5cbmZ1bmN0aW9uIG5leHRSZXBhaW50KCkge1xuICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSBcImhpZGRlblwiKSB7XG4gICAgcmV0dXJuIG5leHRFdmVudExvb3BUaWNrKClcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbmV4dEFuaW1hdGlvbkZyYW1lKClcbiAgfVxufVxuXG5mdW5jdGlvbiBuZXh0QW5pbWF0aW9uRnJhbWUoKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHJlc29sdmUoKSkpXG59XG5cbmZ1bmN0aW9uIG5leHRFdmVudExvb3BUaWNrKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZSgpLCAwKSlcbn1cblxuZnVuY3Rpb24gbmV4dE1pY3JvdGFzaygpIHtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG59XG5cbmZ1bmN0aW9uIHBhcnNlSFRNTERvY3VtZW50KGh0bWwgPSBcIlwiKSB7XG4gIHJldHVybiBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGh0bWwsIFwidGV4dC9odG1sXCIpXG59XG5cbmZ1bmN0aW9uIHVuaW5kZW50KHN0cmluZ3MsIC4uLnZhbHVlcykge1xuICBjb25zdCBsaW5lcyA9IGludGVycG9sYXRlKHN0cmluZ3MsIHZhbHVlcykucmVwbGFjZSgvXlxcbi8sIFwiXCIpLnNwbGl0KFwiXFxuXCIpO1xuICBjb25zdCBtYXRjaCA9IGxpbmVzWzBdLm1hdGNoKC9eXFxzKy8pO1xuICBjb25zdCBpbmRlbnQgPSBtYXRjaCA/IG1hdGNoWzBdLmxlbmd0aCA6IDA7XG4gIHJldHVybiBsaW5lcy5tYXAoKGxpbmUpID0+IGxpbmUuc2xpY2UoaW5kZW50KSkuam9pbihcIlxcblwiKVxufVxuXG5mdW5jdGlvbiBpbnRlcnBvbGF0ZShzdHJpbmdzLCB2YWx1ZXMpIHtcbiAgcmV0dXJuIHN0cmluZ3MucmVkdWNlKChyZXN1bHQsIHN0cmluZywgaSkgPT4ge1xuICAgIGNvbnN0IHZhbHVlID0gdmFsdWVzW2ldID09IHVuZGVmaW5lZCA/IFwiXCIgOiB2YWx1ZXNbaV07XG4gICAgcmV0dXJuIHJlc3VsdCArIHN0cmluZyArIHZhbHVlXG4gIH0sIFwiXCIpXG59XG5cbmZ1bmN0aW9uIHV1aWQoKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiAzNiB9KVxuICAgIC5tYXAoKF8sIGkpID0+IHtcbiAgICAgIGlmIChpID09IDggfHwgaSA9PSAxMyB8fCBpID09IDE4IHx8IGkgPT0gMjMpIHtcbiAgICAgICAgcmV0dXJuIFwiLVwiXG4gICAgICB9IGVsc2UgaWYgKGkgPT0gMTQpIHtcbiAgICAgICAgcmV0dXJuIFwiNFwiXG4gICAgICB9IGVsc2UgaWYgKGkgPT0gMTkpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KSArIDgpLnRvU3RyaW5nKDE2KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE1KS50b1N0cmluZygxNilcbiAgICAgIH1cbiAgICB9KVxuICAgIC5qb2luKFwiXCIpXG59XG5cbmZ1bmN0aW9uIGdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCAuLi5lbGVtZW50cykge1xuICBmb3IgKGNvbnN0IHZhbHVlIG9mIGVsZW1lbnRzLm1hcCgoZWxlbWVudCkgPT4gZWxlbWVudD8uZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpKSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIikgcmV0dXJuIHZhbHVlXG4gIH1cblxuICByZXR1cm4gbnVsbFxufVxuXG5mdW5jdGlvbiBoYXNBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgLi4uZWxlbWVudHMpIHtcbiAgcmV0dXJuIGVsZW1lbnRzLnNvbWUoKGVsZW1lbnQpID0+IGVsZW1lbnQgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkpXG59XG5cbmZ1bmN0aW9uIG1hcmtBc0J1c3koLi4uZWxlbWVudHMpIHtcbiAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRzKSB7XG4gICAgaWYgKGVsZW1lbnQubG9jYWxOYW1lID09IFwidHVyYm8tZnJhbWVcIikge1xuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJidXN5XCIsIFwiXCIpO1xuICAgIH1cbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtYnVzeVwiLCBcInRydWVcIik7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2xlYXJCdXN5U3RhdGUoLi4uZWxlbWVudHMpIHtcbiAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRzKSB7XG4gICAgaWYgKGVsZW1lbnQubG9jYWxOYW1lID09IFwidHVyYm8tZnJhbWVcIikge1xuICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJidXN5XCIpO1xuICAgIH1cblxuICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1idXN5XCIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHdhaXRGb3JMb2FkKGVsZW1lbnQsIHRpbWVvdXRJbk1pbGxpc2Vjb25kcyA9IDIwMDApIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgY29uc3Qgb25Db21wbGV0ZSA9ICgpID0+IHtcbiAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIG9uQ29tcGxldGUpO1xuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCBvbkNvbXBsZXRlKTtcbiAgICAgIHJlc29sdmUoKTtcbiAgICB9O1xuXG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBvbkNvbXBsZXRlLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgb25Db21wbGV0ZSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgdGltZW91dEluTWlsbGlzZWNvbmRzKTtcbiAgfSlcbn1cblxuZnVuY3Rpb24gZ2V0SGlzdG9yeU1ldGhvZEZvckFjdGlvbihhY3Rpb24pIHtcbiAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICBjYXNlIFwicmVwbGFjZVwiOlxuICAgICAgcmV0dXJuIGhpc3RvcnkucmVwbGFjZVN0YXRlXG4gICAgY2FzZSBcImFkdmFuY2VcIjpcbiAgICBjYXNlIFwicmVzdG9yZVwiOlxuICAgICAgcmV0dXJuIGhpc3RvcnkucHVzaFN0YXRlXG4gIH1cbn1cblxuZnVuY3Rpb24gaXNBY3Rpb24oYWN0aW9uKSB7XG4gIHJldHVybiBhY3Rpb24gPT0gXCJhZHZhbmNlXCIgfHwgYWN0aW9uID09IFwicmVwbGFjZVwiIHx8IGFjdGlvbiA9PSBcInJlc3RvcmVcIlxufVxuXG5mdW5jdGlvbiBnZXRWaXNpdEFjdGlvbiguLi5lbGVtZW50cykge1xuICBjb25zdCBhY3Rpb24gPSBnZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWFjdGlvblwiLCAuLi5lbGVtZW50cyk7XG5cbiAgcmV0dXJuIGlzQWN0aW9uKGFjdGlvbikgPyBhY3Rpb24gOiBudWxsXG59XG5cbmZ1bmN0aW9uIGdldE1ldGFFbGVtZW50KG5hbWUpIHtcbiAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYG1ldGFbbmFtZT1cIiR7bmFtZX1cIl1gKVxufVxuXG5mdW5jdGlvbiBnZXRNZXRhQ29udGVudChuYW1lKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBnZXRNZXRhRWxlbWVudChuYW1lKTtcbiAgcmV0dXJuIGVsZW1lbnQgJiYgZWxlbWVudC5jb250ZW50XG59XG5cbmZ1bmN0aW9uIHNldE1ldGFDb250ZW50KG5hbWUsIGNvbnRlbnQpIHtcbiAgbGV0IGVsZW1lbnQgPSBnZXRNZXRhRWxlbWVudChuYW1lKTtcblxuICBpZiAoIWVsZW1lbnQpIHtcbiAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm1ldGFcIik7XG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIG5hbWUpO1xuXG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgfVxuXG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiY29udGVudFwiLCBjb250ZW50KTtcblxuICByZXR1cm4gZWxlbWVudFxufVxuXG5mdW5jdGlvbiBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gIGlmIChlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgIHJldHVybiAoXG4gICAgICBlbGVtZW50LmNsb3Nlc3Qoc2VsZWN0b3IpIHx8IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkoZWxlbWVudC5hc3NpZ25lZFNsb3QgfHwgZWxlbWVudC5nZXRSb290Tm9kZSgpPy5ob3N0LCBzZWxlY3RvcilcbiAgICApXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudElzRm9jdXNhYmxlKGVsZW1lbnQpIHtcbiAgY29uc3QgaW5lcnREaXNhYmxlZE9ySGlkZGVuID0gXCJbaW5lcnRdLCA6ZGlzYWJsZWQsIFtoaWRkZW5dLCBkZXRhaWxzOm5vdChbb3Blbl0pLCBkaWFsb2c6bm90KFtvcGVuXSlcIjtcblxuICByZXR1cm4gISFlbGVtZW50ICYmIGVsZW1lbnQuY2xvc2VzdChpbmVydERpc2FibGVkT3JIaWRkZW4pID09IG51bGwgJiYgdHlwZW9mIGVsZW1lbnQuZm9jdXMgPT0gXCJmdW5jdGlvblwiXG59XG5cbmZ1bmN0aW9uIHF1ZXJ5QXV0b2ZvY3VzYWJsZUVsZW1lbnQoZWxlbWVudE9yRG9jdW1lbnRGcmFnbWVudCkge1xuICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50T3JEb2N1bWVudEZyYWdtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbYXV0b2ZvY3VzXVwiKSkuZmluZChlbGVtZW50SXNGb2N1c2FibGUpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGFyb3VuZChjYWxsYmFjaywgcmVhZGVyKSB7XG4gIGNvbnN0IGJlZm9yZSA9IHJlYWRlcigpO1xuXG4gIGNhbGxiYWNrKCk7XG5cbiAgYXdhaXQgbmV4dEFuaW1hdGlvbkZyYW1lKCk7XG5cbiAgY29uc3QgYWZ0ZXIgPSByZWFkZXIoKTtcblxuICByZXR1cm4gW2JlZm9yZSwgYWZ0ZXJdXG59XG5cbmZ1bmN0aW9uIGRvZXNOb3RUYXJnZXRJRnJhbWUobmFtZSkge1xuICBpZiAobmFtZSA9PT0gXCJfYmxhbmtcIikge1xuICAgIHJldHVybiBmYWxzZVxuICB9IGVsc2UgaWYgKG5hbWUpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUobmFtZSkpIHtcbiAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTElGcmFtZUVsZW1lbnQpIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxufVxuXG5mdW5jdGlvbiBmaW5kTGlua0Zyb21DbGlja1RhcmdldCh0YXJnZXQpIHtcbiAgcmV0dXJuIGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkodGFyZ2V0LCBcImFbaHJlZl06bm90KFt0YXJnZXRePV9dKTpub3QoW2Rvd25sb2FkXSlcIilcbn1cblxuZnVuY3Rpb24gZ2V0TG9jYXRpb25Gb3JMaW5rKGxpbmspIHtcbiAgcmV0dXJuIGV4cGFuZFVSTChsaW5rLmdldEF0dHJpYnV0ZShcImhyZWZcIikgfHwgXCJcIilcbn1cblxuZnVuY3Rpb24gZGVib3VuY2UoZm4sIGRlbGF5KSB7XG4gIGxldCB0aW1lb3V0SWQgPSBudWxsO1xuXG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4gZm4uYXBwbHkodGhpcywgYXJncyk7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dChjYWxsYmFjaywgZGVsYXkpO1xuICB9XG59XG5cbmNsYXNzIExpbWl0ZWRTZXQgZXh0ZW5kcyBTZXQge1xuICBjb25zdHJ1Y3RvcihtYXhTaXplKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm1heFNpemUgPSBtYXhTaXplO1xuICB9XG5cbiAgYWRkKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuc2l6ZSA+PSB0aGlzLm1heFNpemUpIHtcbiAgICAgIGNvbnN0IGl0ZXJhdG9yID0gdGhpcy52YWx1ZXMoKTtcbiAgICAgIGNvbnN0IG9sZGVzdFZhbHVlID0gaXRlcmF0b3IubmV4dCgpLnZhbHVlO1xuICAgICAgdGhpcy5kZWxldGUob2xkZXN0VmFsdWUpO1xuICAgIH1cbiAgICBzdXBlci5hZGQodmFsdWUpO1xuICB9XG59XG5cbmNvbnN0IHJlY2VudFJlcXVlc3RzID0gbmV3IExpbWl0ZWRTZXQoMjApO1xuXG5jb25zdCBuYXRpdmVGZXRjaCA9IHdpbmRvdy5mZXRjaDtcblxuZnVuY3Rpb24gZmV0Y2hXaXRoVHVyYm9IZWFkZXJzKHVybCwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IG1vZGlmaWVkSGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycyB8fCB7fSk7XG4gIGNvbnN0IHJlcXVlc3RVSUQgPSB1dWlkKCk7XG4gIHJlY2VudFJlcXVlc3RzLmFkZChyZXF1ZXN0VUlEKTtcbiAgbW9kaWZpZWRIZWFkZXJzLmFwcGVuZChcIlgtVHVyYm8tUmVxdWVzdC1JZFwiLCByZXF1ZXN0VUlEKTtcblxuICByZXR1cm4gbmF0aXZlRmV0Y2godXJsLCB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBoZWFkZXJzOiBtb2RpZmllZEhlYWRlcnNcbiAgfSlcbn1cblxuZnVuY3Rpb24gZmV0Y2hNZXRob2RGcm9tU3RyaW5nKG1ldGhvZCkge1xuICBzd2l0Y2ggKG1ldGhvZC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBcImdldFwiOlxuICAgICAgcmV0dXJuIEZldGNoTWV0aG9kLmdldFxuICAgIGNhc2UgXCJwb3N0XCI6XG4gICAgICByZXR1cm4gRmV0Y2hNZXRob2QucG9zdFxuICAgIGNhc2UgXCJwdXRcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5wdXRcbiAgICBjYXNlIFwicGF0Y2hcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5wYXRjaFxuICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5kZWxldGVcbiAgfVxufVxuXG5jb25zdCBGZXRjaE1ldGhvZCA9IHtcbiAgZ2V0OiBcImdldFwiLFxuICBwb3N0OiBcInBvc3RcIixcbiAgcHV0OiBcInB1dFwiLFxuICBwYXRjaDogXCJwYXRjaFwiLFxuICBkZWxldGU6IFwiZGVsZXRlXCJcbn07XG5cbmZ1bmN0aW9uIGZldGNoRW5jdHlwZUZyb21TdHJpbmcoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChlbmNvZGluZy50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBGZXRjaEVuY3R5cGUubXVsdGlwYXJ0OlxuICAgICAgcmV0dXJuIEZldGNoRW5jdHlwZS5tdWx0aXBhcnRcbiAgICBjYXNlIEZldGNoRW5jdHlwZS5wbGFpbjpcbiAgICAgIHJldHVybiBGZXRjaEVuY3R5cGUucGxhaW5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIEZldGNoRW5jdHlwZS51cmxFbmNvZGVkXG4gIH1cbn1cblxuY29uc3QgRmV0Y2hFbmN0eXBlID0ge1xuICB1cmxFbmNvZGVkOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICBtdWx0aXBhcnQ6IFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiLFxuICBwbGFpbjogXCJ0ZXh0L3BsYWluXCJcbn07XG5cbmNsYXNzIEZldGNoUmVxdWVzdCB7XG4gIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxuICAjcmVzb2x2ZVJlcXVlc3RQcm9taXNlID0gKF92YWx1ZSkgPT4ge31cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgbWV0aG9kLCBsb2NhdGlvbiwgcmVxdWVzdEJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCksIHRhcmdldCA9IG51bGwsIGVuY3R5cGUgPSBGZXRjaEVuY3R5cGUudXJsRW5jb2RlZCkge1xuICAgIGNvbnN0IFt1cmwsIGJvZHldID0gYnVpbGRSZXNvdXJjZUFuZEJvZHkoZXhwYW5kVVJMKGxvY2F0aW9uKSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgZW5jdHlwZSk7XG5cbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMgPSB7XG4gICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgcmVkaXJlY3Q6IFwiZm9sbG93XCIsXG4gICAgICBtZXRob2Q6IG1ldGhvZC50b1VwcGVyQ2FzZSgpLFxuICAgICAgaGVhZGVyczogeyAuLi50aGlzLmRlZmF1bHRIZWFkZXJzIH0sXG4gICAgICBib2R5OiBib2R5LFxuICAgICAgc2lnbmFsOiB0aGlzLmFib3J0U2lnbmFsLFxuICAgICAgcmVmZXJyZXI6IHRoaXMuZGVsZWdhdGUucmVmZXJyZXI/LmhyZWZcbiAgICB9O1xuICAgIHRoaXMuZW5jdHlwZSA9IGVuY3R5cGU7XG4gIH1cblxuICBnZXQgbWV0aG9kKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoT3B0aW9ucy5tZXRob2RcbiAgfVxuXG4gIHNldCBtZXRob2QodmFsdWUpIHtcbiAgICBjb25zdCBmZXRjaEJvZHkgPSB0aGlzLmlzU2FmZSA/IHRoaXMudXJsLnNlYXJjaFBhcmFtcyA6IHRoaXMuZmV0Y2hPcHRpb25zLmJvZHkgfHwgbmV3IEZvcm1EYXRhKCk7XG4gICAgY29uc3QgZmV0Y2hNZXRob2QgPSBmZXRjaE1ldGhvZEZyb21TdHJpbmcodmFsdWUpIHx8IEZldGNoTWV0aG9kLmdldDtcblxuICAgIHRoaXMudXJsLnNlYXJjaCA9IFwiXCI7XG5cbiAgICBjb25zdCBbdXJsLCBib2R5XSA9IGJ1aWxkUmVzb3VyY2VBbmRCb2R5KHRoaXMudXJsLCBmZXRjaE1ldGhvZCwgZmV0Y2hCb2R5LCB0aGlzLmVuY3R5cGUpO1xuXG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMuYm9keSA9IGJvZHk7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMubWV0aG9kID0gZmV0Y2hNZXRob2QudG9VcHBlckNhc2UoKTtcbiAgfVxuXG4gIGdldCBoZWFkZXJzKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoT3B0aW9ucy5oZWFkZXJzXG4gIH1cblxuICBzZXQgaGVhZGVycyh2YWx1ZSkge1xuICAgIHRoaXMuZmV0Y2hPcHRpb25zLmhlYWRlcnMgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBib2R5KCkge1xuICAgIGlmICh0aGlzLmlzU2FmZSkge1xuICAgICAgcmV0dXJuIHRoaXMudXJsLnNlYXJjaFBhcmFtc1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5mZXRjaE9wdGlvbnMuYm9keVxuICAgIH1cbiAgfVxuXG4gIHNldCBib2R5KHZhbHVlKSB7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMuYm9keSA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnVybFxuICB9XG5cbiAgZ2V0IHBhcmFtcygpIHtcbiAgICByZXR1cm4gdGhpcy51cmwuc2VhcmNoUGFyYW1zXG4gIH1cblxuICBnZXQgZW50cmllcygpIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5ID8gQXJyYXkuZnJvbSh0aGlzLmJvZHkuZW50cmllcygpKSA6IFtdXG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgfVxuXG4gIGFzeW5jIHBlcmZvcm0oKSB7XG4gICAgY29uc3QgeyBmZXRjaE9wdGlvbnMgfSA9IHRoaXM7XG4gICAgdGhpcy5kZWxlZ2F0ZS5wcmVwYXJlUmVxdWVzdCh0aGlzKTtcbiAgICBjb25zdCBldmVudCA9IGF3YWl0IHRoaXMuI2FsbG93UmVxdWVzdFRvQmVJbnRlcmNlcHRlZChmZXRjaE9wdGlvbnMpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnJlcXVlc3RTdGFydGVkKHRoaXMpO1xuXG4gICAgICBpZiAoZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdCkge1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdC5yZXNwb25zZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSBmZXRjaFdpdGhUdXJib0hlYWRlcnModGhpcy51cmwuaHJlZiwgZmV0Y2hPcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlc3BvbnNlO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucmVjZWl2ZShyZXNwb25zZSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLm5hbWUgIT09IFwiQWJvcnRFcnJvclwiKSB7XG4gICAgICAgIGlmICh0aGlzLiN3aWxsRGVsZWdhdGVFcnJvckhhbmRsaW5nKGVycm9yKSkge1xuICAgICAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdEVycm9yZWQodGhpcywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdEZpbmlzaGVkKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlY2VpdmUocmVzcG9uc2UpIHtcbiAgICBjb25zdCBmZXRjaFJlc3BvbnNlID0gbmV3IEZldGNoUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtZmV0Y2gtcmVzcG9uc2VcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyBmZXRjaFJlc3BvbnNlIH0sXG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0XG4gICAgfSk7XG4gICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdFByZXZlbnRlZEhhbmRsaW5nUmVzcG9uc2UodGhpcywgZmV0Y2hSZXNwb25zZSk7XG4gICAgfSBlbHNlIGlmIChmZXRjaFJlc3BvbnNlLnN1Y2NlZWRlZCkge1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5yZXF1ZXN0U3VjY2VlZGVkV2l0aFJlc3BvbnNlKHRoaXMsIGZldGNoUmVzcG9uc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UodGhpcywgZmV0Y2hSZXNwb25zZSk7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaFJlc3BvbnNlXG4gIH1cblxuICBnZXQgZGVmYXVsdEhlYWRlcnMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIEFjY2VwdDogXCJ0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3hodG1sK3htbFwiXG4gICAgfVxuICB9XG5cbiAgZ2V0IGlzU2FmZSgpIHtcbiAgICByZXR1cm4gaXNTYWZlKHRoaXMubWV0aG9kKVxuICB9XG5cbiAgZ2V0IGFib3J0U2lnbmFsKCkge1xuICAgIHJldHVybiB0aGlzLmFib3J0Q29udHJvbGxlci5zaWduYWxcbiAgfVxuXG4gIGFjY2VwdFJlc3BvbnNlVHlwZShtaW1lVHlwZSkge1xuICAgIHRoaXMuaGVhZGVyc1tcIkFjY2VwdFwiXSA9IFttaW1lVHlwZSwgdGhpcy5oZWFkZXJzW1wiQWNjZXB0XCJdXS5qb2luKFwiLCBcIik7XG4gIH1cblxuICBhc3luYyAjYWxsb3dSZXF1ZXN0VG9CZUludGVyY2VwdGVkKGZldGNoT3B0aW9ucykge1xuICAgIGNvbnN0IHJlcXVlc3RJbnRlcmNlcHRpb24gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gKHRoaXMuI3Jlc29sdmVSZXF1ZXN0UHJvbWlzZSA9IHJlc29sdmUpKTtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZldGNoLXJlcXVlc3RcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDoge1xuICAgICAgICBmZXRjaE9wdGlvbnMsXG4gICAgICAgIHVybDogdGhpcy51cmwsXG4gICAgICAgIHJlc3VtZTogdGhpcy4jcmVzb2x2ZVJlcXVlc3RQcm9taXNlXG4gICAgICB9LFxuICAgICAgdGFyZ2V0OiB0aGlzLnRhcmdldFxuICAgIH0pO1xuICAgIHRoaXMudXJsID0gZXZlbnQuZGV0YWlsLnVybDtcbiAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgYXdhaXQgcmVxdWVzdEludGVyY2VwdGlvbjtcblxuICAgIHJldHVybiBldmVudFxuICB9XG5cbiAgI3dpbGxEZWxlZ2F0ZUVycm9ySGFuZGxpbmcoZXJyb3IpIHtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86ZmV0Y2gtcmVxdWVzdC1lcnJvclwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyByZXF1ZXN0OiB0aGlzLCBlcnJvcjogZXJyb3IgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cbn1cblxuZnVuY3Rpb24gaXNTYWZlKGZldGNoTWV0aG9kKSB7XG4gIHJldHVybiBmZXRjaE1ldGhvZEZyb21TdHJpbmcoZmV0Y2hNZXRob2QpID09IEZldGNoTWV0aG9kLmdldFxufVxuXG5mdW5jdGlvbiBidWlsZFJlc291cmNlQW5kQm9keShyZXNvdXJjZSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgZW5jdHlwZSkge1xuICBjb25zdCBzZWFyY2hQYXJhbXMgPVxuICAgIEFycmF5LmZyb20ocmVxdWVzdEJvZHkpLmxlbmd0aCA+IDAgPyBuZXcgVVJMU2VhcmNoUGFyYW1zKGVudHJpZXNFeGNsdWRpbmdGaWxlcyhyZXF1ZXN0Qm9keSkpIDogcmVzb3VyY2Uuc2VhcmNoUGFyYW1zO1xuXG4gIGlmIChpc1NhZmUobWV0aG9kKSkge1xuICAgIHJldHVybiBbbWVyZ2VJbnRvVVJMU2VhcmNoUGFyYW1zKHJlc291cmNlLCBzZWFyY2hQYXJhbXMpLCBudWxsXVxuICB9IGVsc2UgaWYgKGVuY3R5cGUgPT0gRmV0Y2hFbmN0eXBlLnVybEVuY29kZWQpIHtcbiAgICByZXR1cm4gW3Jlc291cmNlLCBzZWFyY2hQYXJhbXNdXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFtyZXNvdXJjZSwgcmVxdWVzdEJvZHldXG4gIH1cbn1cblxuZnVuY3Rpb24gZW50cmllc0V4Y2x1ZGluZ0ZpbGVzKHJlcXVlc3RCb2R5KSB7XG4gIGNvbnN0IGVudHJpZXMgPSBbXTtcblxuICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgcmVxdWVzdEJvZHkpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBGaWxlKSBjb250aW51ZVxuICAgIGVsc2UgZW50cmllcy5wdXNoKFtuYW1lLCB2YWx1ZV0pO1xuICB9XG5cbiAgcmV0dXJuIGVudHJpZXNcbn1cblxuZnVuY3Rpb24gbWVyZ2VJbnRvVVJMU2VhcmNoUGFyYW1zKHVybCwgcmVxdWVzdEJvZHkpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhlbnRyaWVzRXhjbHVkaW5nRmlsZXMocmVxdWVzdEJvZHkpKTtcblxuICB1cmwuc2VhcmNoID0gc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCk7XG5cbiAgcmV0dXJuIHVybFxufVxuXG5jbGFzcyBBcHBlYXJhbmNlT2JzZXJ2ZXIge1xuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIodGhpcy5pbnRlcnNlY3QpO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlci51bm9ic2VydmUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBpbnRlcnNlY3QgPSAoZW50cmllcykgPT4ge1xuICAgIGNvbnN0IGxhc3RFbnRyeSA9IGVudHJpZXMuc2xpY2UoLTEpWzBdO1xuICAgIGlmIChsYXN0RW50cnk/LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRBcHBlYXJlZEluVmlld3BvcnQodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgU3RyZWFtTWVzc2FnZSB7XG4gIHN0YXRpYyBjb250ZW50VHlwZSA9IFwidGV4dC92bmQudHVyYm8tc3RyZWFtLmh0bWxcIlxuXG4gIHN0YXRpYyB3cmFwKG1lc3NhZ2UpIHtcbiAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIG5ldyB0aGlzKGNyZWF0ZURvY3VtZW50RnJhZ21lbnQobWVzc2FnZSkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtZXNzYWdlXG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gaW1wb3J0U3RyZWFtRWxlbWVudHMoZnJhZ21lbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGltcG9ydFN0cmVhbUVsZW1lbnRzKGZyYWdtZW50KSB7XG4gIGZvciAoY29uc3QgZWxlbWVudCBvZiBmcmFnbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwidHVyYm8tc3RyZWFtXCIpKSB7XG4gICAgY29uc3Qgc3RyZWFtRWxlbWVudCA9IGRvY3VtZW50LmltcG9ydE5vZGUoZWxlbWVudCwgdHJ1ZSk7XG5cbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiBzdHJlYW1FbGVtZW50LnRlbXBsYXRlRWxlbWVudC5jb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIikpIHtcbiAgICAgIGluZXJ0U2NyaXB0RWxlbWVudC5yZXBsYWNlV2l0aChhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoaW5lcnRTY3JpcHRFbGVtZW50KSk7XG4gICAgfVxuXG4gICAgZWxlbWVudC5yZXBsYWNlV2l0aChzdHJlYW1FbGVtZW50KTtcbiAgfVxuXG4gIHJldHVybiBmcmFnbWVudFxufVxuXG5jb25zdCBQUkVGRVRDSF9ERUxBWSA9IDEwMDtcblxuY2xhc3MgUHJlZmV0Y2hDYWNoZSB7XG4gICNwcmVmZXRjaFRpbWVvdXQgPSBudWxsXG4gICNwcmVmZXRjaGVkID0gbnVsbFxuXG4gIGdldCh1cmwpIHtcbiAgICBpZiAodGhpcy4jcHJlZmV0Y2hlZCAmJiB0aGlzLiNwcmVmZXRjaGVkLnVybCA9PT0gdXJsICYmIHRoaXMuI3ByZWZldGNoZWQuZXhwaXJlID4gRGF0ZS5ub3coKSkge1xuICAgICAgcmV0dXJuIHRoaXMuI3ByZWZldGNoZWQucmVxdWVzdFxuICAgIH1cbiAgfVxuXG4gIHNldExhdGVyKHVybCwgcmVxdWVzdCwgdHRsKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgdGhpcy4jcHJlZmV0Y2hUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXF1ZXN0LnBlcmZvcm0oKTtcbiAgICAgIHRoaXMuc2V0KHVybCwgcmVxdWVzdCwgdHRsKTtcbiAgICAgIHRoaXMuI3ByZWZldGNoVGltZW91dCA9IG51bGw7XG4gICAgfSwgUFJFRkVUQ0hfREVMQVkpO1xuICB9XG5cbiAgc2V0KHVybCwgcmVxdWVzdCwgdHRsKSB7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZCA9IHsgdXJsLCByZXF1ZXN0LCBleHBpcmU6IG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgdHRsKSB9O1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgaWYgKHRoaXMuI3ByZWZldGNoVGltZW91dCkgY2xlYXJUaW1lb3V0KHRoaXMuI3ByZWZldGNoVGltZW91dCk7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZCA9IG51bGw7XG4gIH1cbn1cblxuY29uc3QgY2FjaGVUdGwgPSAxMCAqIDEwMDA7XG5jb25zdCBwcmVmZXRjaENhY2hlID0gbmV3IFByZWZldGNoQ2FjaGUoKTtcblxuY29uc3QgRm9ybVN1Ym1pc3Npb25TdGF0ZSA9IHtcbiAgaW5pdGlhbGl6ZWQ6IFwiaW5pdGlhbGl6ZWRcIixcbiAgcmVxdWVzdGluZzogXCJyZXF1ZXN0aW5nXCIsXG4gIHdhaXRpbmc6IFwid2FpdGluZ1wiLFxuICByZWNlaXZpbmc6IFwicmVjZWl2aW5nXCIsXG4gIHN0b3BwaW5nOiBcInN0b3BwaW5nXCIsXG4gIHN0b3BwZWQ6IFwic3RvcHBlZFwiXG59O1xuXG5jbGFzcyBGb3JtU3VibWlzc2lvbiB7XG4gIHN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5pbml0aWFsaXplZFxuXG4gIHN0YXRpYyBjb25maXJtTWV0aG9kKG1lc3NhZ2UsIF9lbGVtZW50LCBfc3VibWl0dGVyKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb25maXJtKG1lc3NhZ2UpKVxuICB9XG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIsIG11c3RSZWRpcmVjdCA9IGZhbHNlKSB7XG4gICAgY29uc3QgbWV0aG9kID0gZ2V0TWV0aG9kKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IGFjdGlvbiA9IGdldEFjdGlvbihnZXRGb3JtQWN0aW9uKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpLCBtZXRob2QpO1xuICAgIGNvbnN0IGJvZHkgPSBidWlsZEZvcm1EYXRhKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IGVuY3R5cGUgPSBnZXRFbmN0eXBlKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpO1xuXG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLnN1Ym1pdHRlciA9IHN1Ym1pdHRlcjtcbiAgICB0aGlzLmZldGNoUmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QodGhpcywgbWV0aG9kLCBhY3Rpb24sIGJvZHksIGZvcm1FbGVtZW50LCBlbmN0eXBlKTtcbiAgICB0aGlzLm11c3RSZWRpcmVjdCA9IG11c3RSZWRpcmVjdDtcbiAgfVxuXG4gIGdldCBtZXRob2QoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0Lm1ldGhvZFxuICB9XG5cbiAgc2V0IG1ldGhvZCh2YWx1ZSkge1xuICAgIHRoaXMuZmV0Y2hSZXF1ZXN0Lm1ldGhvZCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGFjdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QudXJsLnRvU3RyaW5nKClcbiAgfVxuXG4gIHNldCBhY3Rpb24odmFsdWUpIHtcbiAgICB0aGlzLmZldGNoUmVxdWVzdC51cmwgPSBleHBhbmRVUkwodmFsdWUpO1xuICB9XG5cbiAgZ2V0IGJvZHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LmJvZHlcbiAgfVxuXG4gIGdldCBlbmN0eXBlKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdC5lbmN0eXBlXG4gIH1cblxuICBnZXQgaXNTYWZlKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdC5pc1NhZmVcbiAgfVxuXG4gIGdldCBsb2NhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QudXJsXG4gIH1cblxuICAvLyBUaGUgc3VibWlzc2lvbiBwcm9jZXNzXG5cbiAgYXN5bmMgc3RhcnQoKSB7XG4gICAgY29uc3QgeyBpbml0aWFsaXplZCwgcmVxdWVzdGluZyB9ID0gRm9ybVN1Ym1pc3Npb25TdGF0ZTtcbiAgICBjb25zdCBjb25maXJtYXRpb25NZXNzYWdlID0gZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1jb25maXJtXCIsIHRoaXMuc3VibWl0dGVyLCB0aGlzLmZvcm1FbGVtZW50KTtcblxuICAgIGlmICh0eXBlb2YgY29uZmlybWF0aW9uTWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29uc3QgYW5zd2VyID0gYXdhaXQgRm9ybVN1Ym1pc3Npb24uY29uZmlybU1ldGhvZChjb25maXJtYXRpb25NZXNzYWdlLCB0aGlzLmZvcm1FbGVtZW50LCB0aGlzLnN1Ym1pdHRlcik7XG4gICAgICBpZiAoIWFuc3dlcikge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBpbml0aWFsaXplZCkge1xuICAgICAgdGhpcy5zdGF0ZSA9IHJlcXVlc3Rpbmc7XG4gICAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QucGVyZm9ybSgpXG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBjb25zdCB7IHN0b3BwaW5nLCBzdG9wcGVkIH0gPSBGb3JtU3VibWlzc2lvblN0YXRlO1xuICAgIGlmICh0aGlzLnN0YXRlICE9IHN0b3BwaW5nICYmIHRoaXMuc3RhdGUgIT0gc3RvcHBlZCkge1xuICAgICAgdGhpcy5zdGF0ZSA9IHN0b3BwaW5nO1xuICAgICAgdGhpcy5mZXRjaFJlcXVlc3QuY2FuY2VsKCk7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIC8vIEZldGNoIHJlcXVlc3QgZGVsZWdhdGVcblxuICBwcmVwYXJlUmVxdWVzdChyZXF1ZXN0KSB7XG4gICAgaWYgKCFyZXF1ZXN0LmlzU2FmZSkge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZXRDb29raWVWYWx1ZShnZXRNZXRhQ29udGVudChcImNzcmYtcGFyYW1cIikpIHx8IGdldE1ldGFDb250ZW50KFwiY3NyZi10b2tlblwiKTtcbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICByZXF1ZXN0LmhlYWRlcnNbXCJYLUNTUkYtVG9rZW5cIl0gPSB0b2tlbjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5yZXF1ZXN0QWNjZXB0c1R1cmJvU3RyZWFtUmVzcG9uc2UocmVxdWVzdCkpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKF9yZXF1ZXN0KSB7XG4gICAgdGhpcy5zdGF0ZSA9IEZvcm1TdWJtaXNzaW9uU3RhdGUud2FpdGluZztcbiAgICB0aGlzLnN1Ym1pdHRlcj8uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgdGhpcy5zZXRTdWJtaXRzV2l0aCgpO1xuICAgIG1hcmtBc0J1c3kodGhpcy5mb3JtRWxlbWVudCk7XG4gICAgZGlzcGF0Y2goXCJ0dXJibzpzdWJtaXQtc3RhcnRcIiwge1xuICAgICAgdGFyZ2V0OiB0aGlzLmZvcm1FbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGZvcm1TdWJtaXNzaW9uOiB0aGlzIH1cbiAgICB9KTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uU3RhcnRlZCh0aGlzKTtcbiAgfVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuXG4gICAgdGhpcy5yZXN1bHQgPSB7IHN1Y2Nlc3M6IHJlc3BvbnNlLnN1Y2NlZWRlZCwgZmV0Y2hSZXNwb25zZTogcmVzcG9uc2UgfTtcbiAgfVxuXG4gIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBpZiAocmVzcG9uc2UuY2xpZW50RXJyb3IgfHwgcmVzcG9uc2Uuc2VydmVyRXJyb3IpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UodGhpcywgcmVzcG9uc2UpO1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuXG4gICAgaWYgKHRoaXMucmVxdWVzdE11c3RSZWRpcmVjdChyZXF1ZXN0KSAmJiByZXNwb25zZVN1Y2NlZWRlZFdpdGhvdXRSZWRpcmVjdChyZXNwb25zZSkpIHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiRm9ybSByZXNwb25zZXMgbXVzdCByZWRpcmVjdCB0byBhbm90aGVyIGxvY2F0aW9uXCIpO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkVycm9yZWQodGhpcywgZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5yZWNlaXZpbmc7XG4gICAgICB0aGlzLnJlc3VsdCA9IHsgc3VjY2VzczogdHJ1ZSwgZmV0Y2hSZXNwb25zZTogcmVzcG9uc2UgfTtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UodGhpcywgcmVzcG9uc2UpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICB0aGlzLnJlc3VsdCA9IHsgc3VjY2VzczogZmFsc2UsIGZldGNoUmVzcG9uc2U6IHJlc3BvbnNlIH07XG4gICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkZhaWxlZFdpdGhSZXNwb25zZSh0aGlzLCByZXNwb25zZSk7XG4gIH1cblxuICByZXF1ZXN0RXJyb3JlZChyZXF1ZXN0LCBlcnJvcikge1xuICAgIHRoaXMucmVzdWx0ID0geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3IgfTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uRXJyb3JlZCh0aGlzLCBlcnJvcik7XG4gIH1cblxuICByZXF1ZXN0RmluaXNoZWQoX3JlcXVlc3QpIHtcbiAgICB0aGlzLnN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5zdG9wcGVkO1xuICAgIHRoaXMuc3VibWl0dGVyPy5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICB0aGlzLnJlc2V0U3VibWl0dGVyVGV4dCgpO1xuICAgIGNsZWFyQnVzeVN0YXRlKHRoaXMuZm9ybUVsZW1lbnQpO1xuICAgIGRpc3BhdGNoKFwidHVyYm86c3VibWl0LWVuZFwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMuZm9ybUVsZW1lbnQsXG4gICAgICBkZXRhaWw6IHsgZm9ybVN1Ym1pc3Npb246IHRoaXMsIC4uLnRoaXMucmVzdWx0IH1cbiAgICB9KTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uRmluaXNoZWQodGhpcyk7XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgc2V0U3VibWl0c1dpdGgoKSB7XG4gICAgaWYgKCF0aGlzLnN1Ym1pdHRlciB8fCAhdGhpcy5zdWJtaXRzV2l0aCkgcmV0dXJuXG5cbiAgICBpZiAodGhpcy5zdWJtaXR0ZXIubWF0Y2hlcyhcImJ1dHRvblwiKSkge1xuICAgICAgdGhpcy5vcmlnaW5hbFN1Ym1pdFRleHQgPSB0aGlzLnN1Ym1pdHRlci5pbm5lckhUTUw7XG4gICAgICB0aGlzLnN1Ym1pdHRlci5pbm5lckhUTUwgPSB0aGlzLnN1Ym1pdHNXaXRoO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zdWJtaXR0ZXIubWF0Y2hlcyhcImlucHV0XCIpKSB7XG4gICAgICBjb25zdCBpbnB1dCA9IHRoaXMuc3VibWl0dGVyO1xuICAgICAgdGhpcy5vcmlnaW5hbFN1Ym1pdFRleHQgPSBpbnB1dC52YWx1ZTtcbiAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5zdWJtaXRzV2l0aDtcbiAgICB9XG4gIH1cblxuICByZXNldFN1Ym1pdHRlclRleHQoKSB7XG4gICAgaWYgKCF0aGlzLnN1Ym1pdHRlciB8fCAhdGhpcy5vcmlnaW5hbFN1Ym1pdFRleHQpIHJldHVyblxuXG4gICAgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJidXR0b25cIikpIHtcbiAgICAgIHRoaXMuc3VibWl0dGVyLmlubmVySFRNTCA9IHRoaXMub3JpZ2luYWxTdWJtaXRUZXh0O1xuICAgIH0gZWxzZSBpZiAodGhpcy5zdWJtaXR0ZXIubWF0Y2hlcyhcImlucHV0XCIpKSB7XG4gICAgICBjb25zdCBpbnB1dCA9IHRoaXMuc3VibWl0dGVyO1xuICAgICAgaW5wdXQudmFsdWUgPSB0aGlzLm9yaWdpbmFsU3VibWl0VGV4dDtcbiAgICB9XG4gIH1cblxuICByZXF1ZXN0TXVzdFJlZGlyZWN0KHJlcXVlc3QpIHtcbiAgICByZXR1cm4gIXJlcXVlc3QuaXNTYWZlICYmIHRoaXMubXVzdFJlZGlyZWN0XG4gIH1cblxuICByZXF1ZXN0QWNjZXB0c1R1cmJvU3RyZWFtUmVzcG9uc2UocmVxdWVzdCkge1xuICAgIHJldHVybiAhcmVxdWVzdC5pc1NhZmUgfHwgaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIiwgdGhpcy5zdWJtaXR0ZXIsIHRoaXMuZm9ybUVsZW1lbnQpXG4gIH1cblxuICBnZXQgc3VibWl0c1dpdGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN1Ym1pdHMtd2l0aFwiKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJ1aWxkRm9ybURhdGEoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtRWxlbWVudCk7XG4gIGNvbnN0IG5hbWUgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG4gIGNvbnN0IHZhbHVlID0gc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKTtcblxuICBpZiAobmFtZSkge1xuICAgIGZvcm1EYXRhLmFwcGVuZChuYW1lLCB2YWx1ZSB8fCBcIlwiKTtcbiAgfVxuXG4gIHJldHVybiBmb3JtRGF0YVxufVxuXG5mdW5jdGlvbiBnZXRDb29raWVWYWx1ZShjb29raWVOYW1lKSB7XG4gIGlmIChjb29raWVOYW1lICE9IG51bGwpIHtcbiAgICBjb25zdCBjb29raWVzID0gZG9jdW1lbnQuY29va2llID8gZG9jdW1lbnQuY29va2llLnNwbGl0KFwiOyBcIikgOiBbXTtcbiAgICBjb25zdCBjb29raWUgPSBjb29raWVzLmZpbmQoKGNvb2tpZSkgPT4gY29va2llLnN0YXJ0c1dpdGgoY29va2llTmFtZSkpO1xuICAgIGlmIChjb29raWUpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gY29va2llLnNwbGl0KFwiPVwiKS5zbGljZSgxKS5qb2luKFwiPVwiKTtcbiAgICAgIHJldHVybiB2YWx1ZSA/IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgOiB1bmRlZmluZWRcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVzcG9uc2VTdWNjZWVkZWRXaXRob3V0UmVkaXJlY3QocmVzcG9uc2UpIHtcbiAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c0NvZGUgPT0gMjAwICYmICFyZXNwb25zZS5yZWRpcmVjdGVkXG59XG5cbmZ1bmN0aW9uIGdldEZvcm1BY3Rpb24oZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICBjb25zdCBmb3JtRWxlbWVudEFjdGlvbiA9IHR5cGVvZiBmb3JtRWxlbWVudC5hY3Rpb24gPT09IFwic3RyaW5nXCIgPyBmb3JtRWxlbWVudC5hY3Rpb24gOiBudWxsO1xuXG4gIGlmIChzdWJtaXR0ZXI/Lmhhc0F0dHJpYnV0ZShcImZvcm1hY3Rpb25cIikpIHtcbiAgICByZXR1cm4gc3VibWl0dGVyLmdldEF0dHJpYnV0ZShcImZvcm1hY3Rpb25cIikgfHwgXCJcIlxuICB9IGVsc2Uge1xuICAgIHJldHVybiBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIikgfHwgZm9ybUVsZW1lbnRBY3Rpb24gfHwgXCJcIlxuICB9XG59XG5cbmZ1bmN0aW9uIGdldEFjdGlvbihmb3JtQWN0aW9uLCBmZXRjaE1ldGhvZCkge1xuICBjb25zdCBhY3Rpb24gPSBleHBhbmRVUkwoZm9ybUFjdGlvbik7XG5cbiAgaWYgKGlzU2FmZShmZXRjaE1ldGhvZCkpIHtcbiAgICBhY3Rpb24uc2VhcmNoID0gXCJcIjtcbiAgfVxuXG4gIHJldHVybiBhY3Rpb25cbn1cblxuZnVuY3Rpb24gZ2V0TWV0aG9kKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgY29uc3QgbWV0aG9kID0gc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJmb3JtbWV0aG9kXCIpIHx8IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm1ldGhvZFwiKSB8fCBcIlwiO1xuICByZXR1cm4gZmV0Y2hNZXRob2RGcm9tU3RyaW5nKG1ldGhvZC50b0xvd2VyQ2FzZSgpKSB8fCBGZXRjaE1ldGhvZC5nZXRcbn1cblxuZnVuY3Rpb24gZ2V0RW5jdHlwZShmb3JtRWxlbWVudCwgc3VibWl0dGVyKSB7XG4gIHJldHVybiBmZXRjaEVuY3R5cGVGcm9tU3RyaW5nKHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybWVuY3R5cGVcIikgfHwgZm9ybUVsZW1lbnQuZW5jdHlwZSlcbn1cblxuY2xhc3MgU25hcHNob3Qge1xuICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgfVxuXG4gIGdldCBhY3RpdmVFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5hY3RpdmVFbGVtZW50XG4gIH1cblxuICBnZXQgY2hpbGRyZW4oKSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLmVsZW1lbnQuY2hpbGRyZW5dXG4gIH1cblxuICBoYXNBbmNob3IoYW5jaG9yKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudEZvckFuY2hvcihhbmNob3IpICE9IG51bGxcbiAgfVxuXG4gIGdldEVsZW1lbnRGb3JBbmNob3IoYW5jaG9yKSB7XG4gICAgcmV0dXJuIGFuY2hvciA/IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKGBbaWQ9JyR7YW5jaG9yfSddLCBhW25hbWU9JyR7YW5jaG9yfSddYCkgOiBudWxsXG4gIH1cblxuICBnZXQgaXNDb25uZWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pc0Nvbm5lY3RlZFxuICB9XG5cbiAgZ2V0IGZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHF1ZXJ5QXV0b2ZvY3VzYWJsZUVsZW1lbnQodGhpcy5lbGVtZW50KVxuICB9XG5cbiAgZ2V0IHBlcm1hbmVudEVsZW1lbnRzKCkge1xuICAgIHJldHVybiBxdWVyeVBlcm1hbmVudEVsZW1lbnRzQWxsKHRoaXMuZWxlbWVudClcbiAgfVxuXG4gIGdldFBlcm1hbmVudEVsZW1lbnRCeUlkKGlkKSB7XG4gICAgcmV0dXJuIGdldFBlcm1hbmVudEVsZW1lbnRCeUlkKHRoaXMuZWxlbWVudCwgaWQpXG4gIH1cblxuICBnZXRQZXJtYW5lbnRFbGVtZW50TWFwRm9yU25hcHNob3Qoc25hcHNob3QpIHtcbiAgICBjb25zdCBwZXJtYW5lbnRFbGVtZW50TWFwID0ge307XG5cbiAgICBmb3IgKGNvbnN0IGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50IG9mIHRoaXMucGVybWFuZW50RWxlbWVudHMpIHtcbiAgICAgIGNvbnN0IHsgaWQgfSA9IGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50O1xuICAgICAgY29uc3QgbmV3UGVybWFuZW50RWxlbWVudCA9IHNuYXBzaG90LmdldFBlcm1hbmVudEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgIGlmIChuZXdQZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgICAgIHBlcm1hbmVudEVsZW1lbnRNYXBbaWRdID0gW2N1cnJlbnRQZXJtYW5lbnRFbGVtZW50LCBuZXdQZXJtYW5lbnRFbGVtZW50XTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcGVybWFuZW50RWxlbWVudE1hcFxuICB9XG59XG5cbmZ1bmN0aW9uIGdldFBlcm1hbmVudEVsZW1lbnRCeUlkKG5vZGUsIGlkKSB7XG4gIHJldHVybiBub2RlLnF1ZXJ5U2VsZWN0b3IoYCMke2lkfVtkYXRhLXR1cmJvLXBlcm1hbmVudF1gKVxufVxuXG5mdW5jdGlvbiBxdWVyeVBlcm1hbmVudEVsZW1lbnRzQWxsKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUucXVlcnlTZWxlY3RvckFsbChcIltpZF1bZGF0YS10dXJiby1wZXJtYW5lbnRdXCIpXG59XG5cbmNsYXNzIEZvcm1TdWJtaXRPYnNlcnZlciB7XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBldmVudFRhcmdldCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZXZlbnRUYXJnZXQ7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuc3VibWl0Q2FwdHVyZWQsIHRydWUpO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLnN1Ym1pdENhcHR1cmVkLCB0cnVlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHN1Ym1pdENhcHR1cmVkID0gKCkgPT4ge1xuICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLnN1Ym1pdEJ1YmJsZWQsIGZhbHNlKTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRCdWJibGVkLCBmYWxzZSk7XG4gIH1cblxuICBzdWJtaXRCdWJibGVkID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKCFldmVudC5kZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICBjb25zdCBmb3JtID0gZXZlbnQudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEZvcm1FbGVtZW50ID8gZXZlbnQudGFyZ2V0IDogdW5kZWZpbmVkO1xuICAgICAgY29uc3Qgc3VibWl0dGVyID0gZXZlbnQuc3VibWl0dGVyIHx8IHVuZGVmaW5lZDtcblxuICAgICAgaWYgKFxuICAgICAgICBmb3JtICYmXG4gICAgICAgIHN1Ym1pc3Npb25Eb2VzTm90RGlzbWlzc0RpYWxvZyhmb3JtLCBzdWJtaXR0ZXIpICYmXG4gICAgICAgIHN1Ym1pc3Npb25Eb2VzTm90VGFyZ2V0SUZyYW1lKGZvcm0sIHN1Ym1pdHRlcikgJiZcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS53aWxsU3VibWl0Rm9ybShmb3JtLCBzdWJtaXR0ZXIpXG4gICAgICApIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pdHRlZChmb3JtLCBzdWJtaXR0ZXIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzdWJtaXNzaW9uRG9lc05vdERpc21pc3NEaWFsb2coZm9ybSwgc3VibWl0dGVyKSB7XG4gIGNvbnN0IG1ldGhvZCA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybW1ldGhvZFwiKSB8fCBmb3JtLmdldEF0dHJpYnV0ZShcIm1ldGhvZFwiKTtcblxuICByZXR1cm4gbWV0aG9kICE9IFwiZGlhbG9nXCJcbn1cblxuZnVuY3Rpb24gc3VibWlzc2lvbkRvZXNOb3RUYXJnZXRJRnJhbWUoZm9ybSwgc3VibWl0dGVyKSB7XG4gIGNvbnN0IHRhcmdldCA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybXRhcmdldFwiKSB8fCBmb3JtLmdldEF0dHJpYnV0ZShcInRhcmdldFwiKTtcblxuICByZXR1cm4gZG9lc05vdFRhcmdldElGcmFtZSh0YXJnZXQpXG59XG5cbmNsYXNzIFZpZXcge1xuICAjcmVzb2x2ZVJlbmRlclByb21pc2UgPSAoX3ZhbHVlKSA9PiB7fVxuICAjcmVzb2x2ZUludGVyY2VwdGlvblByb21pc2UgPSAoX3ZhbHVlKSA9PiB7fVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBlbGVtZW50KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gIH1cblxuICAvLyBTY3JvbGxpbmdcblxuICBzY3JvbGxUb0FuY2hvcihhbmNob3IpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5zbmFwc2hvdC5nZXRFbGVtZW50Rm9yQW5jaG9yKGFuY2hvcik7XG4gICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgIHRoaXMuc2Nyb2xsVG9FbGVtZW50KGVsZW1lbnQpO1xuICAgICAgdGhpcy5mb2N1c0VsZW1lbnQoZWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2Nyb2xsVG9Qb3NpdGlvbih7IHg6IDAsIHk6IDAgfSk7XG4gICAgfVxuICB9XG5cbiAgc2Nyb2xsVG9BbmNob3JGcm9tTG9jYXRpb24obG9jYXRpb24pIHtcbiAgICB0aGlzLnNjcm9sbFRvQW5jaG9yKGdldEFuY2hvcihsb2NhdGlvbikpO1xuICB9XG5cbiAgc2Nyb2xsVG9FbGVtZW50KGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnNjcm9sbEludG9WaWV3KCk7XG4gIH1cblxuICBmb2N1c0VsZW1lbnQoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50Lmhhc0F0dHJpYnV0ZShcInRhYmluZGV4XCIpKSB7XG4gICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgXCItMVwiKTtcbiAgICAgICAgZWxlbWVudC5mb2N1cygpO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcInRhYmluZGV4XCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHNjcm9sbFRvUG9zaXRpb24oeyB4LCB5IH0pIHtcbiAgICB0aGlzLnNjcm9sbFJvb3Quc2Nyb2xsVG8oeCwgeSk7XG4gIH1cblxuICBzY3JvbGxUb1RvcCgpIHtcbiAgICB0aGlzLnNjcm9sbFRvUG9zaXRpb24oeyB4OiAwLCB5OiAwIH0pO1xuICB9XG5cbiAgZ2V0IHNjcm9sbFJvb3QoKSB7XG4gICAgcmV0dXJuIHdpbmRvd1xuICB9XG5cbiAgLy8gUmVuZGVyaW5nXG5cbiAgYXN5bmMgcmVuZGVyKHJlbmRlcmVyKSB7XG4gICAgY29uc3QgeyBpc1ByZXZpZXcsIHNob3VsZFJlbmRlciwgd2lsbFJlbmRlciwgbmV3U25hcHNob3Q6IHNuYXBzaG90IH0gPSByZW5kZXJlcjtcblxuICAgIC8vIEEgd29ya2Fyb3VuZCB0byBpZ25vcmUgdHJhY2tlZCBlbGVtZW50IG1pc21hdGNoIHJlbG9hZHMgd2hlbiBwZXJmb3JtaW5nXG4gICAgLy8gYSBwcm9tb3RlZCBWaXNpdCBmcm9tIGEgZnJhbWUgbmF2aWdhdGlvblxuICAgIGNvbnN0IHNob3VsZEludmFsaWRhdGUgPSB3aWxsUmVuZGVyO1xuXG4gICAgaWYgKHNob3VsZFJlbmRlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5yZW5kZXJQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+ICh0aGlzLiNyZXNvbHZlUmVuZGVyUHJvbWlzZSA9IHJlc29sdmUpKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICBhd2FpdCB0aGlzLnByZXBhcmVUb1JlbmRlclNuYXBzaG90KHJlbmRlcmVyKTtcblxuICAgICAgICBjb25zdCByZW5kZXJJbnRlcmNlcHRpb24gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gKHRoaXMuI3Jlc29sdmVJbnRlcmNlcHRpb25Qcm9taXNlID0gcmVzb2x2ZSkpO1xuICAgICAgICBjb25zdCBvcHRpb25zID0geyByZXN1bWU6IHRoaXMuI3Jlc29sdmVJbnRlcmNlcHRpb25Qcm9taXNlLCByZW5kZXI6IHRoaXMucmVuZGVyZXIucmVuZGVyRWxlbWVudCwgcmVuZGVyTWV0aG9kOiB0aGlzLnJlbmRlcmVyLnJlbmRlck1ldGhvZCB9O1xuICAgICAgICBjb25zdCBpbW1lZGlhdGVSZW5kZXIgPSB0aGlzLmRlbGVnYXRlLmFsbG93c0ltbWVkaWF0ZVJlbmRlcihzbmFwc2hvdCwgb3B0aW9ucyk7XG4gICAgICAgIGlmICghaW1tZWRpYXRlUmVuZGVyKSBhd2FpdCByZW5kZXJJbnRlcmNlcHRpb247XG5cbiAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTbmFwc2hvdChyZW5kZXJlcik7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlld1JlbmRlcmVkU25hcHNob3Qoc25hcHNob3QsIGlzUHJldmlldywgdGhpcy5yZW5kZXJlci5yZW5kZXJNZXRob2QpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcodGhpcy5lbGVtZW50KTtcbiAgICAgICAgdGhpcy5maW5pc2hSZW5kZXJpbmdTbmFwc2hvdChyZW5kZXJlcik7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBkZWxldGUgdGhpcy5yZW5kZXJlcjtcbiAgICAgICAgdGhpcy4jcmVzb2x2ZVJlbmRlclByb21pc2UodW5kZWZpbmVkKTtcbiAgICAgICAgZGVsZXRlIHRoaXMucmVuZGVyUHJvbWlzZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHNob3VsZEludmFsaWRhdGUpIHtcbiAgICAgIHRoaXMuaW52YWxpZGF0ZShyZW5kZXJlci5yZWxvYWRSZWFzb24pO1xuICAgIH1cbiAgfVxuXG4gIGludmFsaWRhdGUocmVhc29uKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS52aWV3SW52YWxpZGF0ZWQocmVhc29uKTtcbiAgfVxuXG4gIGFzeW5jIHByZXBhcmVUb1JlbmRlclNuYXBzaG90KHJlbmRlcmVyKSB7XG4gICAgdGhpcy5tYXJrQXNQcmV2aWV3KHJlbmRlcmVyLmlzUHJldmlldyk7XG4gICAgYXdhaXQgcmVuZGVyZXIucHJlcGFyZVRvUmVuZGVyKCk7XG4gIH1cblxuICBtYXJrQXNQcmV2aWV3KGlzUHJldmlldykge1xuICAgIGlmIChpc1ByZXZpZXcpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXByZXZpZXdcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXByZXZpZXdcIik7XG4gICAgfVxuICB9XG5cbiAgbWFya1Zpc2l0RGlyZWN0aW9uKGRpcmVjdGlvbikge1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXZpc2l0LWRpcmVjdGlvblwiLCBkaXJlY3Rpb24pO1xuICB9XG5cbiAgdW5tYXJrVmlzaXREaXJlY3Rpb24oKSB7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtdHVyYm8tdmlzaXQtZGlyZWN0aW9uXCIpO1xuICB9XG5cbiAgYXN5bmMgcmVuZGVyU25hcHNob3QocmVuZGVyZXIpIHtcbiAgICBhd2FpdCByZW5kZXJlci5yZW5kZXIoKTtcbiAgfVxuXG4gIGZpbmlzaFJlbmRlcmluZ1NuYXBzaG90KHJlbmRlcmVyKSB7XG4gICAgcmVuZGVyZXIuZmluaXNoUmVuZGVyaW5nKCk7XG4gIH1cbn1cblxuY2xhc3MgRnJhbWVWaWV3IGV4dGVuZHMgVmlldyB7XG4gIG1pc3NpbmcoKSB7XG4gICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGA8c3Ryb25nIGNsYXNzPVwidHVyYm8tZnJhbWUtZXJyb3JcIj5Db250ZW50IG1pc3Npbmc8L3N0cm9uZz5gO1xuICB9XG5cbiAgZ2V0IHNuYXBzaG90KCkge1xuICAgIHJldHVybiBuZXcgU25hcHNob3QodGhpcy5lbGVtZW50KVxuICB9XG59XG5cbmNsYXNzIExpbmtJbnRlcmNlcHRvciB7XG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBlbGVtZW50KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tCdWJibGVkKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidHVyYm86Y2xpY2tcIiwgdGhpcy5saW5rQ2xpY2tlZCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS12aXNpdFwiLCB0aGlzLndpbGxWaXNpdCk7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbGlja0J1YmJsZWQpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0dXJibzpjbGlja1wiLCB0aGlzLmxpbmtDbGlja2VkKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLXZpc2l0XCIsIHRoaXMud2lsbFZpc2l0KTtcbiAgfVxuXG4gIGNsaWNrQnViYmxlZCA9IChldmVudCkgPT4ge1xuICAgIGlmICh0aGlzLmNsaWNrRXZlbnRJc1NpZ25pZmljYW50KGV2ZW50KSkge1xuICAgICAgdGhpcy5jbGlja0V2ZW50ID0gZXZlbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlbGV0ZSB0aGlzLmNsaWNrRXZlbnQ7XG4gICAgfVxuICB9XG5cbiAgbGlua0NsaWNrZWQgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5jbGlja0V2ZW50ICYmIHRoaXMuY2xpY2tFdmVudElzU2lnbmlmaWNhbnQoZXZlbnQpKSB7XG4gICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zaG91bGRJbnRlcmNlcHRMaW5rQ2xpY2soZXZlbnQudGFyZ2V0LCBldmVudC5kZXRhaWwudXJsLCBldmVudC5kZXRhaWwub3JpZ2luYWxFdmVudCkpIHtcbiAgICAgICAgdGhpcy5jbGlja0V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUubGlua0NsaWNrSW50ZXJjZXB0ZWQoZXZlbnQudGFyZ2V0LCBldmVudC5kZXRhaWwudXJsLCBldmVudC5kZXRhaWwub3JpZ2luYWxFdmVudCk7XG4gICAgICB9XG4gICAgfVxuICAgIGRlbGV0ZSB0aGlzLmNsaWNrRXZlbnQ7XG4gIH1cblxuICB3aWxsVmlzaXQgPSAoX2V2ZW50KSA9PiB7XG4gICAgZGVsZXRlIHRoaXMuY2xpY2tFdmVudDtcbiAgfVxuXG4gIGNsaWNrRXZlbnRJc1NpZ25pZmljYW50KGV2ZW50KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQuY29tcG9zZWQgPyBldmVudC50YXJnZXQ/LnBhcmVudEVsZW1lbnQgOiBldmVudC50YXJnZXQ7XG4gICAgY29uc3QgZWxlbWVudCA9IGZpbmRMaW5rRnJvbUNsaWNrVGFyZ2V0KHRhcmdldCkgfHwgdGFyZ2V0O1xuXG4gICAgcmV0dXJuIGVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50ICYmIGVsZW1lbnQuY2xvc2VzdChcInR1cmJvLWZyYW1lLCBodG1sXCIpID09IHRoaXMuZWxlbWVudFxuICB9XG59XG5cbmNsYXNzIExpbmtDbGlja09ic2VydmVyIHtcbiAgc3RhcnRlZCA9IGZhbHNlXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIGV2ZW50VGFyZ2V0KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQ2FwdHVyZWQsIHRydWUpO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tDYXB0dXJlZCwgdHJ1ZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBjbGlja0NhcHR1cmVkID0gKCkgPT4ge1xuICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tCdWJibGVkLCBmYWxzZSk7XG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbGlja0J1YmJsZWQsIGZhbHNlKTtcbiAgfVxuXG4gIGNsaWNrQnViYmxlZCA9IChldmVudCkgPT4ge1xuICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgdGhpcy5jbGlja0V2ZW50SXNTaWduaWZpY2FudChldmVudCkpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IChldmVudC5jb21wb3NlZFBhdGggJiYgZXZlbnQuY29tcG9zZWRQYXRoKClbMF0pIHx8IGV2ZW50LnRhcmdldDtcbiAgICAgIGNvbnN0IGxpbmsgPSBmaW5kTGlua0Zyb21DbGlja1RhcmdldCh0YXJnZXQpO1xuICAgICAgaWYgKGxpbmsgJiYgZG9lc05vdFRhcmdldElGcmFtZShsaW5rLnRhcmdldCkpIHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbkZvckxpbmsobGluayk7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLndpbGxGb2xsb3dMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXZlbnQpKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLmRlbGVnYXRlLmZvbGxvd2VkTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY2xpY2tFdmVudElzU2lnbmlmaWNhbnQoZXZlbnQpIHtcbiAgICByZXR1cm4gIShcbiAgICAgIChldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LmlzQ29udGVudEVkaXRhYmxlKSB8fFxuICAgICAgZXZlbnQuZGVmYXVsdFByZXZlbnRlZCB8fFxuICAgICAgZXZlbnQud2hpY2ggPiAxIHx8XG4gICAgICBldmVudC5hbHRLZXkgfHxcbiAgICAgIGV2ZW50LmN0cmxLZXkgfHxcbiAgICAgIGV2ZW50Lm1ldGFLZXkgfHxcbiAgICAgIGV2ZW50LnNoaWZ0S2V5XG4gICAgKVxuICB9XG59XG5cbmNsYXNzIEZvcm1MaW5rQ2xpY2tPYnNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBlbGVtZW50KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yID0gbmV3IExpbmtDbGlja09ic2VydmVyKHRoaXMsIGVsZW1lbnQpO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RhcnQoKTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RvcCgpO1xuICB9XG5cbiAgLy8gTGluayBob3ZlciBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIGNhblByZWZldGNoUmVxdWVzdFRvTG9jYXRpb24obGluaywgbG9jYXRpb24pIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHByZWZldGNoQW5kQ2FjaGVSZXF1ZXN0VG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbikge1xuICAgIHJldHVyblxuICB9XG5cbiAgLy8gTGluayBjbGljayBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxGb2xsb3dMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgb3JpZ2luYWxFdmVudCkge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmRlbGVnYXRlLndpbGxTdWJtaXRGb3JtTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIG9yaWdpbmFsRXZlbnQpICYmXG4gICAgICAobGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLW1ldGhvZFwiKSB8fCBsaW5rLmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tc3RyZWFtXCIpKVxuICAgIClcbiAgfVxuXG4gIGZvbGxvd2VkTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24pIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XG5cbiAgICBjb25zdCB0eXBlID0gXCJoaWRkZW5cIjtcbiAgICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgbG9jYXRpb24uc2VhcmNoUGFyYW1zKSB7XG4gICAgICBmb3JtLmFwcGVuZChPYmplY3QuYXNzaWduKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSwgeyB0eXBlLCBuYW1lLCB2YWx1ZSB9KSk7XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aW9uID0gT2JqZWN0LmFzc2lnbihsb2NhdGlvbiwgeyBzZWFyY2g6IFwiXCIgfSk7XG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvXCIsIFwidHJ1ZVwiKTtcbiAgICBmb3JtLnNldEF0dHJpYnV0ZShcImFjdGlvblwiLCBhY3Rpb24uaHJlZik7XG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJoaWRkZW5cIiwgXCJcIik7XG5cbiAgICBjb25zdCBtZXRob2QgPSBsaW5rLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tbWV0aG9kXCIpO1xuICAgIGlmIChtZXRob2QpIGZvcm0uc2V0QXR0cmlidXRlKFwibWV0aG9kXCIsIG1ldGhvZCk7XG5cbiAgICBjb25zdCB0dXJib0ZyYW1lID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIpO1xuICAgIGlmICh0dXJib0ZyYW1lKSBmb3JtLnNldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgdHVyYm9GcmFtZSk7XG5cbiAgICBjb25zdCB0dXJib0FjdGlvbiA9IGdldFZpc2l0QWN0aW9uKGxpbmspO1xuICAgIGlmICh0dXJib0FjdGlvbikgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWFjdGlvblwiLCB0dXJib0FjdGlvbik7XG5cbiAgICBjb25zdCB0dXJib0NvbmZpcm0gPSBsaW5rLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tY29uZmlybVwiKTtcbiAgICBpZiAodHVyYm9Db25maXJtKSBmb3JtLnNldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tY29uZmlybVwiLCB0dXJib0NvbmZpcm0pO1xuXG4gICAgY29uc3QgdHVyYm9TdHJlYW0gPSBsaW5rLmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tc3RyZWFtXCIpO1xuICAgIGlmICh0dXJib1N0cmVhbSkgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiLCBcIlwiKTtcblxuICAgIHRoaXMuZGVsZWdhdGUuc3VibWl0dGVkRm9ybUxpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uLCBmb3JtKTtcblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZm9ybSk7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwidHVyYm86c3VibWl0LWVuZFwiLCAoKSA9PiBmb3JtLnJlbW92ZSgpLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IGZvcm0ucmVxdWVzdFN1Ym1pdCgpKTtcbiAgfVxufVxuXG5jbGFzcyBCYXJkbyB7XG4gIHN0YXRpYyBhc3luYyBwcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoZGVsZWdhdGUsIHBlcm1hbmVudEVsZW1lbnRNYXAsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgYmFyZG8gPSBuZXcgdGhpcyhkZWxlZ2F0ZSwgcGVybWFuZW50RWxlbWVudE1hcCk7XG4gICAgYmFyZG8uZW50ZXIoKTtcbiAgICBhd2FpdCBjYWxsYmFjaygpO1xuICAgIGJhcmRvLmxlYXZlKCk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgcGVybWFuZW50RWxlbWVudE1hcCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLnBlcm1hbmVudEVsZW1lbnRNYXAgPSBwZXJtYW5lbnRFbGVtZW50TWFwO1xuICB9XG5cbiAgZW50ZXIoKSB7XG4gICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLnBlcm1hbmVudEVsZW1lbnRNYXApIHtcbiAgICAgIGNvbnN0IFtjdXJyZW50UGVybWFuZW50RWxlbWVudCwgbmV3UGVybWFuZW50RWxlbWVudF0gPSB0aGlzLnBlcm1hbmVudEVsZW1lbnRNYXBbaWRdO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5lbnRlcmluZ0JhcmRvKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LCBuZXdQZXJtYW5lbnRFbGVtZW50KTtcbiAgICAgIHRoaXMucmVwbGFjZU5ld1Blcm1hbmVudEVsZW1lbnRXaXRoUGxhY2Vob2xkZXIobmV3UGVybWFuZW50RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgbGVhdmUoKSB7XG4gICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLnBlcm1hbmVudEVsZW1lbnRNYXApIHtcbiAgICAgIGNvbnN0IFtjdXJyZW50UGVybWFuZW50RWxlbWVudF0gPSB0aGlzLnBlcm1hbmVudEVsZW1lbnRNYXBbaWRdO1xuICAgICAgdGhpcy5yZXBsYWNlQ3VycmVudFBlcm1hbmVudEVsZW1lbnRXaXRoQ2xvbmUoY3VycmVudFBlcm1hbmVudEVsZW1lbnQpO1xuICAgICAgdGhpcy5yZXBsYWNlUGxhY2Vob2xkZXJXaXRoUGVybWFuZW50RWxlbWVudChjdXJyZW50UGVybWFuZW50RWxlbWVudCk7XG4gICAgICB0aGlzLmRlbGVnYXRlLmxlYXZpbmdCYXJkbyhjdXJyZW50UGVybWFuZW50RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgcmVwbGFjZU5ld1Blcm1hbmVudEVsZW1lbnRXaXRoUGxhY2Vob2xkZXIocGVybWFuZW50RWxlbWVudCkge1xuICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gY3JlYXRlUGxhY2Vob2xkZXJGb3JQZXJtYW5lbnRFbGVtZW50KHBlcm1hbmVudEVsZW1lbnQpO1xuICAgIHBlcm1hbmVudEVsZW1lbnQucmVwbGFjZVdpdGgocGxhY2Vob2xkZXIpO1xuICB9XG5cbiAgcmVwbGFjZUN1cnJlbnRQZXJtYW5lbnRFbGVtZW50V2l0aENsb25lKHBlcm1hbmVudEVsZW1lbnQpIHtcbiAgICBjb25zdCBjbG9uZSA9IHBlcm1hbmVudEVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xuICAgIHBlcm1hbmVudEVsZW1lbnQucmVwbGFjZVdpdGgoY2xvbmUpO1xuICB9XG5cbiAgcmVwbGFjZVBsYWNlaG9sZGVyV2l0aFBlcm1hbmVudEVsZW1lbnQocGVybWFuZW50RWxlbWVudCkge1xuICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gdGhpcy5nZXRQbGFjZWhvbGRlckJ5SWQocGVybWFuZW50RWxlbWVudC5pZCk7XG4gICAgcGxhY2Vob2xkZXI/LnJlcGxhY2VXaXRoKHBlcm1hbmVudEVsZW1lbnQpO1xuICB9XG5cbiAgZ2V0UGxhY2Vob2xkZXJCeUlkKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMucGxhY2Vob2xkZXJzLmZpbmQoKGVsZW1lbnQpID0+IGVsZW1lbnQuY29udGVudCA9PSBpZClcbiAgfVxuXG4gIGdldCBwbGFjZWhvbGRlcnMoKSB7XG4gICAgcmV0dXJuIFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwibWV0YVtuYW1lPXR1cmJvLXBlcm1hbmVudC1wbGFjZWhvbGRlcl1bY29udGVudF1cIildXG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlUGxhY2Vob2xkZXJGb3JQZXJtYW5lbnRFbGVtZW50KHBlcm1hbmVudEVsZW1lbnQpIHtcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJtZXRhXCIpO1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0dXJiby1wZXJtYW5lbnQtcGxhY2Vob2xkZXJcIik7XG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiY29udGVudFwiLCBwZXJtYW5lbnRFbGVtZW50LmlkKTtcbiAgcmV0dXJuIGVsZW1lbnRcbn1cblxuY2xhc3MgUmVuZGVyZXIge1xuICAjYWN0aXZlRWxlbWVudCA9IG51bGxcblxuICBjb25zdHJ1Y3RvcihjdXJyZW50U25hcHNob3QsIG5ld1NuYXBzaG90LCByZW5kZXJFbGVtZW50LCBpc1ByZXZpZXcsIHdpbGxSZW5kZXIgPSB0cnVlKSB7XG4gICAgdGhpcy5jdXJyZW50U25hcHNob3QgPSBjdXJyZW50U25hcHNob3Q7XG4gICAgdGhpcy5uZXdTbmFwc2hvdCA9IG5ld1NuYXBzaG90O1xuICAgIHRoaXMuaXNQcmV2aWV3ID0gaXNQcmV2aWV3O1xuICAgIHRoaXMud2lsbFJlbmRlciA9IHdpbGxSZW5kZXI7XG4gICAgdGhpcy5yZW5kZXJFbGVtZW50ID0gcmVuZGVyRWxlbWVudDtcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiAodGhpcy5yZXNvbHZpbmdGdW5jdGlvbnMgPSB7IHJlc29sdmUsIHJlamVjdCB9KSk7XG4gIH1cblxuICBnZXQgc2hvdWxkUmVuZGVyKCkge1xuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBnZXQgc2hvdWxkQXV0b2ZvY3VzKCkge1xuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBnZXQgcmVsb2FkUmVhc29uKCkge1xuICAgIHJldHVyblxuICB9XG5cbiAgcHJlcGFyZVRvUmVuZGVyKCkge1xuICAgIHJldHVyblxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIC8vIEFic3RyYWN0IG1ldGhvZFxuICB9XG5cbiAgZmluaXNoUmVuZGVyaW5nKCkge1xuICAgIGlmICh0aGlzLnJlc29sdmluZ0Z1bmN0aW9ucykge1xuICAgICAgdGhpcy5yZXNvbHZpbmdGdW5jdGlvbnMucmVzb2x2ZSgpO1xuICAgICAgZGVsZXRlIHRoaXMucmVzb2x2aW5nRnVuY3Rpb25zO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHByZXNlcnZpbmdQZXJtYW5lbnRFbGVtZW50cyhjYWxsYmFjaykge1xuICAgIGF3YWl0IEJhcmRvLnByZXNlcnZpbmdQZXJtYW5lbnRFbGVtZW50cyh0aGlzLCB0aGlzLnBlcm1hbmVudEVsZW1lbnRNYXAsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGZvY3VzRmlyc3RBdXRvZm9jdXNhYmxlRWxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5zaG91bGRBdXRvZm9jdXMpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmNvbm5lY3RlZFNuYXBzaG90LmZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnQ7XG4gICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQmFyZG8gZGVsZWdhdGVcblxuICBlbnRlcmluZ0JhcmRvKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgaWYgKHRoaXMuI2FjdGl2ZUVsZW1lbnQpIHJldHVyblxuXG4gICAgaWYgKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LmNvbnRhaW5zKHRoaXMuY3VycmVudFNuYXBzaG90LmFjdGl2ZUVsZW1lbnQpKSB7XG4gICAgICB0aGlzLiNhY3RpdmVFbGVtZW50ID0gdGhpcy5jdXJyZW50U25hcHNob3QuYWN0aXZlRWxlbWVudDtcbiAgICB9XG4gIH1cblxuICBsZWF2aW5nQmFyZG8oY3VycmVudFBlcm1hbmVudEVsZW1lbnQpIHtcbiAgICBpZiAoY3VycmVudFBlcm1hbmVudEVsZW1lbnQuY29udGFpbnModGhpcy4jYWN0aXZlRWxlbWVudCkgJiYgdGhpcy4jYWN0aXZlRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICB0aGlzLiNhY3RpdmVFbGVtZW50LmZvY3VzKCk7XG5cbiAgICAgIHRoaXMuI2FjdGl2ZUVsZW1lbnQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGdldCBjb25uZWN0ZWRTbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5pc0Nvbm5lY3RlZCA/IHRoaXMubmV3U25hcHNob3QgOiB0aGlzLmN1cnJlbnRTbmFwc2hvdFxuICB9XG5cbiAgZ2V0IGN1cnJlbnRFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRTbmFwc2hvdC5lbGVtZW50XG4gIH1cblxuICBnZXQgbmV3RWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5lbGVtZW50XG4gIH1cblxuICBnZXQgcGVybWFuZW50RWxlbWVudE1hcCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50U25hcHNob3QuZ2V0UGVybWFuZW50RWxlbWVudE1hcEZvclNuYXBzaG90KHRoaXMubmV3U25hcHNob3QpXG4gIH1cblxuICBnZXQgcmVuZGVyTWV0aG9kKCkge1xuICAgIHJldHVybiBcInJlcGxhY2VcIlxuICB9XG59XG5cbmNsYXNzIEZyYW1lUmVuZGVyZXIgZXh0ZW5kcyBSZW5kZXJlciB7XG4gIHN0YXRpYyByZW5kZXJFbGVtZW50KGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSB7XG4gICAgY29uc3QgZGVzdGluYXRpb25SYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgZGVzdGluYXRpb25SYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoY3VycmVudEVsZW1lbnQpO1xuICAgIGRlc3RpbmF0aW9uUmFuZ2UuZGVsZXRlQ29udGVudHMoKTtcblxuICAgIGNvbnN0IGZyYW1lRWxlbWVudCA9IG5ld0VsZW1lbnQ7XG4gICAgY29uc3Qgc291cmNlUmFuZ2UgPSBmcmFtZUVsZW1lbnQub3duZXJEb2N1bWVudD8uY3JlYXRlUmFuZ2UoKTtcbiAgICBpZiAoc291cmNlUmFuZ2UpIHtcbiAgICAgIHNvdXJjZVJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyhmcmFtZUVsZW1lbnQpO1xuICAgICAgY3VycmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoc291cmNlUmFuZ2UuZXh0cmFjdENvbnRlbnRzKCkpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBjdXJyZW50U25hcHNob3QsIG5ld1NuYXBzaG90LCByZW5kZXJFbGVtZW50LCBpc1ByZXZpZXcsIHdpbGxSZW5kZXIgPSB0cnVlKSB7XG4gICAgc3VwZXIoY3VycmVudFNuYXBzaG90LCBuZXdTbmFwc2hvdCwgcmVuZGVyRWxlbWVudCwgaXNQcmV2aWV3LCB3aWxsUmVuZGVyKTtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gIH1cblxuICBnZXQgc2hvdWxkUmVuZGVyKCkge1xuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBhc3luYyByZW5kZXIoKSB7XG4gICAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICB0aGlzLnByZXNlcnZpbmdQZXJtYW5lbnRFbGVtZW50cygoKSA9PiB7XG4gICAgICB0aGlzLmxvYWRGcmFtZUVsZW1lbnQoKTtcbiAgICB9KTtcbiAgICB0aGlzLnNjcm9sbEZyYW1lSW50b1ZpZXcoKTtcbiAgICBhd2FpdCBuZXh0UmVwYWludCgpO1xuICAgIHRoaXMuZm9jdXNGaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50KCk7XG4gICAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICB0aGlzLmFjdGl2YXRlU2NyaXB0RWxlbWVudHMoKTtcbiAgfVxuXG4gIGxvYWRGcmFtZUVsZW1lbnQoKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS53aWxsUmVuZGVyRnJhbWUodGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5uZXdFbGVtZW50KTtcbiAgICB0aGlzLnJlbmRlckVsZW1lbnQodGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5uZXdFbGVtZW50KTtcbiAgfVxuXG4gIHNjcm9sbEZyYW1lSW50b1ZpZXcoKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudEVsZW1lbnQuYXV0b3Njcm9sbCB8fCB0aGlzLm5ld0VsZW1lbnQuYXV0b3Njcm9sbCkge1xuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuY3VycmVudEVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICBjb25zdCBibG9jayA9IHJlYWRTY3JvbGxMb2dpY2FsUG9zaXRpb24odGhpcy5jdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWF1dG9zY3JvbGwtYmxvY2tcIiksIFwiZW5kXCIpO1xuICAgICAgY29uc3QgYmVoYXZpb3IgPSByZWFkU2Nyb2xsQmVoYXZpb3IodGhpcy5jdXJyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWF1dG9zY3JvbGwtYmVoYXZpb3JcIiksIFwiYXV0b1wiKTtcblxuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJsb2NrLCBiZWhhdmlvciB9KTtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBhY3RpdmF0ZVNjcmlwdEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgaW5lcnRTY3JpcHRFbGVtZW50IG9mIHRoaXMubmV3U2NyaXB0RWxlbWVudHMpIHtcbiAgICAgIGNvbnN0IGFjdGl2YXRlZFNjcmlwdEVsZW1lbnQgPSBhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoaW5lcnRTY3JpcHRFbGVtZW50KTtcbiAgICAgIGluZXJ0U2NyaXB0RWxlbWVudC5yZXBsYWNlV2l0aChhY3RpdmF0ZWRTY3JpcHRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBnZXQgbmV3U2NyaXB0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcInNjcmlwdFwiKVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlYWRTY3JvbGxMb2dpY2FsUG9zaXRpb24odmFsdWUsIGRlZmF1bHRWYWx1ZSkge1xuICBpZiAodmFsdWUgPT0gXCJlbmRcIiB8fCB2YWx1ZSA9PSBcInN0YXJ0XCIgfHwgdmFsdWUgPT0gXCJjZW50ZXJcIiB8fCB2YWx1ZSA9PSBcIm5lYXJlc3RcIikge1xuICAgIHJldHVybiB2YWx1ZVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBkZWZhdWx0VmFsdWVcbiAgfVxufVxuXG5mdW5jdGlvbiByZWFkU2Nyb2xsQmVoYXZpb3IodmFsdWUsIGRlZmF1bHRWYWx1ZSkge1xuICBpZiAodmFsdWUgPT0gXCJhdXRvXCIgfHwgdmFsdWUgPT0gXCJzbW9vdGhcIikge1xuICAgIHJldHVybiB2YWx1ZVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBkZWZhdWx0VmFsdWVcbiAgfVxufVxuXG5jbGFzcyBQcm9ncmVzc0JhciB7XG4gIHN0YXRpYyBhbmltYXRpb25EdXJhdGlvbiA9IDMwMCAvKm1zKi9cblxuICBzdGF0aWMgZ2V0IGRlZmF1bHRDU1MoKSB7XG4gICAgcmV0dXJuIHVuaW5kZW50YFxuICAgICAgLnR1cmJvLXByb2dyZXNzLWJhciB7XG4gICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgbGVmdDogMDtcbiAgICAgICAgaGVpZ2h0OiAzcHg7XG4gICAgICAgIGJhY2tncm91bmQ6ICMwMDc2ZmY7XG4gICAgICAgIHotaW5kZXg6IDIxNDc0ODM2NDc7XG4gICAgICAgIHRyYW5zaXRpb246XG4gICAgICAgICAgd2lkdGggJHtQcm9ncmVzc0Jhci5hbmltYXRpb25EdXJhdGlvbn1tcyBlYXNlLW91dCxcbiAgICAgICAgICBvcGFjaXR5ICR7UHJvZ3Jlc3NCYXIuYW5pbWF0aW9uRHVyYXRpb24gLyAyfW1zICR7UHJvZ3Jlc3NCYXIuYW5pbWF0aW9uRHVyYXRpb24gLyAyfW1zIGVhc2UtaW47XG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoMCwgMCwgMCk7XG4gICAgICB9XG4gICAgYFxuICB9XG5cbiAgaGlkaW5nID0gZmFsc2VcbiAgdmFsdWUgPSAwXG4gIHZpc2libGUgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3R5bGVzaGVldEVsZW1lbnQgPSB0aGlzLmNyZWF0ZVN0eWxlc2hlZXRFbGVtZW50KCk7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQgPSB0aGlzLmNyZWF0ZVByb2dyZXNzRWxlbWVudCgpO1xuICAgIHRoaXMuaW5zdGFsbFN0eWxlc2hlZXRFbGVtZW50KCk7XG4gICAgdGhpcy5zZXRWYWx1ZSgwKTtcbiAgfVxuXG4gIHNob3coKSB7XG4gICAgaWYgKCF0aGlzLnZpc2libGUpIHtcbiAgICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgICB0aGlzLmluc3RhbGxQcm9ncmVzc0VsZW1lbnQoKTtcbiAgICAgIHRoaXMuc3RhcnRUcmlja2xpbmcoKTtcbiAgICB9XG4gIH1cblxuICBoaWRlKCkge1xuICAgIGlmICh0aGlzLnZpc2libGUgJiYgIXRoaXMuaGlkaW5nKSB7XG4gICAgICB0aGlzLmhpZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmZhZGVQcm9ncmVzc0VsZW1lbnQoKCkgPT4ge1xuICAgICAgICB0aGlzLnVuaW5zdGFsbFByb2dyZXNzRWxlbWVudCgpO1xuICAgICAgICB0aGlzLnN0b3BUcmlja2xpbmcoKTtcbiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaGlkaW5nID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBzZXRWYWx1ZSh2YWx1ZSkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBpbnN0YWxsU3R5bGVzaGVldEVsZW1lbnQoKSB7XG4gICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUodGhpcy5zdHlsZXNoZWV0RWxlbWVudCwgZG9jdW1lbnQuaGVhZC5maXJzdENoaWxkKTtcbiAgfVxuXG4gIGluc3RhbGxQcm9ncmVzc0VsZW1lbnQoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBcIjBcIjtcbiAgICB0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gXCIxXCI7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lmluc2VydEJlZm9yZSh0aGlzLnByb2dyZXNzRWxlbWVudCwgZG9jdW1lbnQuYm9keSk7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gIH1cblxuICBmYWRlUHJvZ3Jlc3NFbGVtZW50KGNhbGxiYWNrKSB7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUub3BhY2l0eSA9IFwiMFwiO1xuICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIFByb2dyZXNzQmFyLmFuaW1hdGlvbkR1cmF0aW9uICogMS41KTtcbiAgfVxuXG4gIHVuaW5zdGFsbFByb2dyZXNzRWxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5wcm9ncmVzc0VsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMucHJvZ3Jlc3NFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBzdGFydFRyaWNrbGluZygpIHtcbiAgICBpZiAoIXRoaXMudHJpY2tsZUludGVydmFsKSB7XG4gICAgICB0aGlzLnRyaWNrbGVJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLnRyaWNrbGUsIFByb2dyZXNzQmFyLmFuaW1hdGlvbkR1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICBzdG9wVHJpY2tsaW5nKCkge1xuICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudHJpY2tsZUludGVydmFsKTtcbiAgICBkZWxldGUgdGhpcy50cmlja2xlSW50ZXJ2YWw7XG4gIH1cblxuICB0cmlja2xlID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0VmFsdWUodGhpcy52YWx1ZSArIE1hdGgucmFuZG9tKCkgLyAxMDApO1xuICB9XG5cbiAgcmVmcmVzaCgpIHtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBgJHsxMCArIHRoaXMudmFsdWUgKiA5MH0lYDtcbiAgICB9KTtcbiAgfVxuXG4gIGNyZWF0ZVN0eWxlc2hlZXRFbGVtZW50KCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgZWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBQcm9ncmVzc0Jhci5kZWZhdWx0Q1NTO1xuICAgIGlmICh0aGlzLmNzcE5vbmNlKSB7XG4gICAgICBlbGVtZW50Lm5vbmNlID0gdGhpcy5jc3BOb25jZTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuXG4gIGNyZWF0ZVByb2dyZXNzRWxlbWVudCgpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBlbGVtZW50LmNsYXNzTmFtZSA9IFwidHVyYm8tcHJvZ3Jlc3MtYmFyXCI7XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuXG4gIGdldCBjc3BOb25jZSgpIHtcbiAgICByZXR1cm4gZ2V0TWV0YUNvbnRlbnQoXCJjc3Atbm9uY2VcIilcbiAgfVxufVxuXG5jbGFzcyBIZWFkU25hcHNob3QgZXh0ZW5kcyBTbmFwc2hvdCB7XG4gIGRldGFpbHNCeU91dGVySFRNTCA9IHRoaXMuY2hpbGRyZW5cbiAgICAuZmlsdGVyKChlbGVtZW50KSA9PiAhZWxlbWVudElzTm9zY3JpcHQoZWxlbWVudCkpXG4gICAgLm1hcCgoZWxlbWVudCkgPT4gZWxlbWVudFdpdGhvdXROb25jZShlbGVtZW50KSlcbiAgICAucmVkdWNlKChyZXN1bHQsIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgb3V0ZXJIVE1MIH0gPSBlbGVtZW50O1xuICAgICAgY29uc3QgZGV0YWlscyA9XG4gICAgICAgIG91dGVySFRNTCBpbiByZXN1bHRcbiAgICAgICAgICA/IHJlc3VsdFtvdXRlckhUTUxdXG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIHR5cGU6IGVsZW1lbnRUeXBlKGVsZW1lbnQpLFxuICAgICAgICAgICAgICB0cmFja2VkOiBlbGVtZW50SXNUcmFja2VkKGVsZW1lbnQpLFxuICAgICAgICAgICAgICBlbGVtZW50czogW11cbiAgICAgICAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgIFtvdXRlckhUTUxdOiB7XG4gICAgICAgICAgLi4uZGV0YWlscyxcbiAgICAgICAgICBlbGVtZW50czogWy4uLmRldGFpbHMuZWxlbWVudHMsIGVsZW1lbnRdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB7fSlcblxuICBnZXQgdHJhY2tlZEVsZW1lbnRTaWduYXR1cmUoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MKVxuICAgICAgLmZpbHRlcigob3V0ZXJIVE1MKSA9PiB0aGlzLmRldGFpbHNCeU91dGVySFRNTFtvdXRlckhUTUxdLnRyYWNrZWQpXG4gICAgICAuam9pbihcIlwiKVxuICB9XG5cbiAgZ2V0U2NyaXB0RWxlbWVudHNOb3RJblNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudHNNYXRjaGluZ1R5cGVOb3RJblNuYXBzaG90KFwic2NyaXB0XCIsIHNuYXBzaG90KVxuICB9XG5cbiAgZ2V0U3R5bGVzaGVldEVsZW1lbnRzTm90SW5TbmFwc2hvdChzbmFwc2hvdCkge1xuICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRzTWF0Y2hpbmdUeXBlTm90SW5TbmFwc2hvdChcInN0eWxlc2hlZXRcIiwgc25hcHNob3QpXG4gIH1cblxuICBnZXRFbGVtZW50c01hdGNoaW5nVHlwZU5vdEluU25hcHNob3QobWF0Y2hlZFR5cGUsIHNuYXBzaG90KSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MKVxuICAgICAgLmZpbHRlcigob3V0ZXJIVE1MKSA9PiAhKG91dGVySFRNTCBpbiBzbmFwc2hvdC5kZXRhaWxzQnlPdXRlckhUTUwpKVxuICAgICAgLm1hcCgob3V0ZXJIVE1MKSA9PiB0aGlzLmRldGFpbHNCeU91dGVySFRNTFtvdXRlckhUTUxdKVxuICAgICAgLmZpbHRlcigoeyB0eXBlIH0pID0+IHR5cGUgPT0gbWF0Y2hlZFR5cGUpXG4gICAgICAubWFwKCh7IGVsZW1lbnRzOiBbZWxlbWVudF0gfSkgPT4gZWxlbWVudClcbiAgfVxuXG4gIGdldCBwcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmRldGFpbHNCeU91dGVySFRNTCkucmVkdWNlKChyZXN1bHQsIG91dGVySFRNTCkgPT4ge1xuICAgICAgY29uc3QgeyB0eXBlLCB0cmFja2VkLCBlbGVtZW50cyB9ID0gdGhpcy5kZXRhaWxzQnlPdXRlckhUTUxbb3V0ZXJIVE1MXTtcbiAgICAgIGlmICh0eXBlID09IG51bGwgJiYgIXRyYWNrZWQpIHtcbiAgICAgICAgcmV0dXJuIFsuLi5yZXN1bHQsIC4uLmVsZW1lbnRzXVxuICAgICAgfSBlbHNlIGlmIChlbGVtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHJldHVybiBbLi4ucmVzdWx0LCAuLi5lbGVtZW50cy5zbGljZSgxKV1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH1cbiAgICB9LCBbXSlcbiAgfVxuXG4gIGdldE1ldGFWYWx1ZShuYW1lKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZmluZE1ldGFFbGVtZW50QnlOYW1lKG5hbWUpO1xuICAgIHJldHVybiBlbGVtZW50ID8gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIpIDogbnVsbFxuICB9XG5cbiAgZmluZE1ldGFFbGVtZW50QnlOYW1lKG5hbWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5kZXRhaWxzQnlPdXRlckhUTUwpLnJlZHVjZSgocmVzdWx0LCBvdXRlckhUTUwpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZWxlbWVudHM6IFtlbGVtZW50XVxuICAgICAgfSA9IHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MW291dGVySFRNTF07XG4gICAgICByZXR1cm4gZWxlbWVudElzTWV0YUVsZW1lbnRXaXRoTmFtZShlbGVtZW50LCBuYW1lKSA/IGVsZW1lbnQgOiByZXN1bHRcbiAgICB9LCB1bmRlZmluZWQgfCB1bmRlZmluZWQpXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudFR5cGUoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudElzU2NyaXB0KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFwic2NyaXB0XCJcbiAgfSBlbHNlIGlmIChlbGVtZW50SXNTdHlsZXNoZWV0KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFwic3R5bGVzaGVldFwiXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudElzVHJhY2tlZChlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tdHJhY2tcIikgPT0gXCJyZWxvYWRcIlxufVxuXG5mdW5jdGlvbiBlbGVtZW50SXNTY3JpcHQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwic2NyaXB0XCJcbn1cblxuZnVuY3Rpb24gZWxlbWVudElzTm9zY3JpcHQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwibm9zY3JpcHRcIlxufVxuXG5mdW5jdGlvbiBlbGVtZW50SXNTdHlsZXNoZWV0KGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQubG9jYWxOYW1lO1xuICByZXR1cm4gdGFnTmFtZSA9PSBcInN0eWxlXCIgfHwgKHRhZ05hbWUgPT0gXCJsaW5rXCIgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJyZWxcIikgPT0gXCJzdHlsZXNoZWV0XCIpXG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRJc01ldGFFbGVtZW50V2l0aE5hbWUoZWxlbWVudCwgbmFtZSkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwibWV0YVwiICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSA9PSBuYW1lXG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRXaXRob3V0Tm9uY2UoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJub25jZVwiKSkge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgXCJcIik7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudFxufVxuXG5jbGFzcyBQYWdlU25hcHNob3QgZXh0ZW5kcyBTbmFwc2hvdCB7XG4gIHN0YXRpYyBmcm9tSFRNTFN0cmluZyhodG1sID0gXCJcIikge1xuICAgIHJldHVybiB0aGlzLmZyb21Eb2N1bWVudChwYXJzZUhUTUxEb2N1bWVudChodG1sKSlcbiAgfVxuXG4gIHN0YXRpYyBmcm9tRWxlbWVudChlbGVtZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuZnJvbURvY3VtZW50KGVsZW1lbnQub3duZXJEb2N1bWVudClcbiAgfVxuXG4gIHN0YXRpYyBmcm9tRG9jdW1lbnQoeyBkb2N1bWVudEVsZW1lbnQsIGJvZHksIGhlYWQgfSkge1xuICAgIHJldHVybiBuZXcgdGhpcyhkb2N1bWVudEVsZW1lbnQsIGJvZHksIG5ldyBIZWFkU25hcHNob3QoaGVhZCkpXG4gIH1cblxuICBjb25zdHJ1Y3Rvcihkb2N1bWVudEVsZW1lbnQsIGJvZHksIGhlYWRTbmFwc2hvdCkge1xuICAgIHN1cGVyKGJvZHkpO1xuICAgIHRoaXMuZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnRFbGVtZW50O1xuICAgIHRoaXMuaGVhZFNuYXBzaG90ID0gaGVhZFNuYXBzaG90O1xuICB9XG5cbiAgY2xvbmUoKSB7XG4gICAgY29uc3QgY2xvbmVkRWxlbWVudCA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICBjb25zdCBzZWxlY3RFbGVtZW50cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0XCIpO1xuICAgIGNvbnN0IGNsb25lZFNlbGVjdEVsZW1lbnRzID0gY2xvbmVkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0XCIpO1xuXG4gICAgZm9yIChjb25zdCBbaW5kZXgsIHNvdXJjZV0gb2Ygc2VsZWN0RWxlbWVudHMuZW50cmllcygpKSB7XG4gICAgICBjb25zdCBjbG9uZSA9IGNsb25lZFNlbGVjdEVsZW1lbnRzW2luZGV4XTtcbiAgICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIGNsb25lLnNlbGVjdGVkT3B0aW9ucykgb3B0aW9uLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBzb3VyY2Uuc2VsZWN0ZWRPcHRpb25zKSBjbG9uZS5vcHRpb25zW29wdGlvbi5pbmRleF0uc2VsZWN0ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgY2xvbmVkUGFzc3dvcmRJbnB1dCBvZiBjbG9uZWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJwYXNzd29yZFwiXScpKSB7XG4gICAgICBjbG9uZWRQYXNzd29yZElucHV0LnZhbHVlID0gXCJcIjtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFBhZ2VTbmFwc2hvdCh0aGlzLmRvY3VtZW50RWxlbWVudCwgY2xvbmVkRWxlbWVudCwgdGhpcy5oZWFkU25hcHNob3QpXG4gIH1cblxuICBnZXQgbGFuZygpIHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibGFuZ1wiKVxuICB9XG5cbiAgZ2V0IGhlYWRFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmhlYWRTbmFwc2hvdC5lbGVtZW50XG4gIH1cblxuICBnZXQgcm9vdExvY2F0aW9uKCkge1xuICAgIGNvbnN0IHJvb3QgPSB0aGlzLmdldFNldHRpbmcoXCJyb290XCIpID8/IFwiL1wiO1xuICAgIHJldHVybiBleHBhbmRVUkwocm9vdClcbiAgfVxuXG4gIGdldCBjYWNoZUNvbnRyb2xWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKFwiY2FjaGUtY29udHJvbFwiKVxuICB9XG5cbiAgZ2V0IGlzUHJldmlld2FibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FjaGVDb250cm9sVmFsdWUgIT0gXCJuby1wcmV2aWV3XCJcbiAgfVxuXG4gIGdldCBpc0NhY2hlYWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZUNvbnRyb2xWYWx1ZSAhPSBcIm5vLWNhY2hlXCJcbiAgfVxuXG4gIGdldCBpc1Zpc2l0YWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKFwidmlzaXQtY29udHJvbFwiKSAhPSBcInJlbG9hZFwiXG4gIH1cblxuICBnZXQgcHJlZmVyc1ZpZXdUcmFuc2l0aW9ucygpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkU25hcHNob3QuZ2V0TWV0YVZhbHVlKFwidmlldy10cmFuc2l0aW9uXCIpID09PSBcInNhbWUtb3JpZ2luXCJcbiAgfVxuXG4gIGdldCBzaG91bGRNb3JwaFBhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U2V0dGluZyhcInJlZnJlc2gtbWV0aG9kXCIpID09PSBcIm1vcnBoXCJcbiAgfVxuXG4gIGdldCBzaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmdldFNldHRpbmcoXCJyZWZyZXNoLXNjcm9sbFwiKSA9PT0gXCJwcmVzZXJ2ZVwiXG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgZ2V0U2V0dGluZyhuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZFNuYXBzaG90LmdldE1ldGFWYWx1ZShgdHVyYm8tJHtuYW1lfWApXG4gIH1cbn1cblxuY2xhc3MgVmlld1RyYW5zaXRpb25lciB7XG4gICN2aWV3VHJhbnNpdGlvblN0YXJ0ZWQgPSBmYWxzZVxuICAjbGFzdE9wZXJhdGlvbiA9IFByb21pc2UucmVzb2x2ZSgpXG5cbiAgcmVuZGVyQ2hhbmdlKHVzZVZpZXdUcmFuc2l0aW9uLCByZW5kZXIpIHtcbiAgICBpZiAodXNlVmlld1RyYW5zaXRpb24gJiYgdGhpcy52aWV3VHJhbnNpdGlvbnNBdmFpbGFibGUgJiYgIXRoaXMuI3ZpZXdUcmFuc2l0aW9uU3RhcnRlZCkge1xuICAgICAgdGhpcy4jdmlld1RyYW5zaXRpb25TdGFydGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuI2xhc3RPcGVyYXRpb24gPSB0aGlzLiNsYXN0T3BlcmF0aW9uLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBkb2N1bWVudC5zdGFydFZpZXdUcmFuc2l0aW9uKHJlbmRlcikuZmluaXNoZWQ7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4jbGFzdE9wZXJhdGlvbiA9IHRoaXMuI2xhc3RPcGVyYXRpb24udGhlbihyZW5kZXIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLiNsYXN0T3BlcmF0aW9uXG4gIH1cblxuICBnZXQgdmlld1RyYW5zaXRpb25zQXZhaWxhYmxlKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5zdGFydFZpZXdUcmFuc2l0aW9uXG4gIH1cbn1cblxuY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gIGFjdGlvbjogXCJhZHZhbmNlXCIsXG4gIGhpc3RvcnlDaGFuZ2VkOiBmYWxzZSxcbiAgdmlzaXRDYWNoZWRTbmFwc2hvdDogKCkgPT4ge30sXG4gIHdpbGxSZW5kZXI6IHRydWUsXG4gIHVwZGF0ZUhpc3Rvcnk6IHRydWUsXG4gIHNob3VsZENhY2hlU25hcHNob3Q6IHRydWUsXG4gIGFjY2VwdHNTdHJlYW1SZXNwb25zZTogZmFsc2Vcbn07XG5cbmNvbnN0IFRpbWluZ01ldHJpYyA9IHtcbiAgdmlzaXRTdGFydDogXCJ2aXNpdFN0YXJ0XCIsXG4gIHJlcXVlc3RTdGFydDogXCJyZXF1ZXN0U3RhcnRcIixcbiAgcmVxdWVzdEVuZDogXCJyZXF1ZXN0RW5kXCIsXG4gIHZpc2l0RW5kOiBcInZpc2l0RW5kXCJcbn07XG5cbmNvbnN0IFZpc2l0U3RhdGUgPSB7XG4gIGluaXRpYWxpemVkOiBcImluaXRpYWxpemVkXCIsXG4gIHN0YXJ0ZWQ6IFwic3RhcnRlZFwiLFxuICBjYW5jZWxlZDogXCJjYW5jZWxlZFwiLFxuICBmYWlsZWQ6IFwiZmFpbGVkXCIsXG4gIGNvbXBsZXRlZDogXCJjb21wbGV0ZWRcIlxufTtcblxuY29uc3QgU3lzdGVtU3RhdHVzQ29kZSA9IHtcbiAgbmV0d29ya0ZhaWx1cmU6IDAsXG4gIHRpbWVvdXRGYWlsdXJlOiAtMSxcbiAgY29udGVudFR5cGVNaXNtYXRjaDogLTJcbn07XG5cbmNvbnN0IERpcmVjdGlvbiA9IHtcbiAgYWR2YW5jZTogXCJmb3J3YXJkXCIsXG4gIHJlc3RvcmU6IFwiYmFja1wiLFxuICByZXBsYWNlOiBcIm5vbmVcIlxufTtcblxuY2xhc3MgVmlzaXQge1xuICBpZGVudGlmaWVyID0gdXVpZCgpIC8vIFJlcXVpcmVkIGJ5IHR1cmJvLWlvc1xuICB0aW1pbmdNZXRyaWNzID0ge31cblxuICBmb2xsb3dlZFJlZGlyZWN0ID0gZmFsc2VcbiAgaGlzdG9yeUNoYW5nZWQgPSBmYWxzZVxuICBzY3JvbGxlZCA9IGZhbHNlXG4gIHNob3VsZENhY2hlU25hcHNob3QgPSB0cnVlXG4gIGFjY2VwdHNTdHJlYW1SZXNwb25zZSA9IGZhbHNlXG4gIHNuYXBzaG90Q2FjaGVkID0gZmFsc2VcbiAgc3RhdGUgPSBWaXNpdFN0YXRlLmluaXRpYWxpemVkXG4gIHZpZXdUcmFuc2l0aW9uZXIgPSBuZXcgVmlld1RyYW5zaXRpb25lcigpXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIgPSByZXN0b3JhdGlvbklkZW50aWZpZXIgfHwgdXVpZCgpO1xuXG4gICAgY29uc3Qge1xuICAgICAgYWN0aW9uLFxuICAgICAgaGlzdG9yeUNoYW5nZWQsXG4gICAgICByZWZlcnJlcixcbiAgICAgIHNuYXBzaG90LFxuICAgICAgc25hcHNob3RIVE1MLFxuICAgICAgcmVzcG9uc2UsXG4gICAgICB2aXNpdENhY2hlZFNuYXBzaG90LFxuICAgICAgd2lsbFJlbmRlcixcbiAgICAgIHVwZGF0ZUhpc3RvcnksXG4gICAgICBzaG91bGRDYWNoZVNuYXBzaG90LFxuICAgICAgYWNjZXB0c1N0cmVhbVJlc3BvbnNlLFxuICAgICAgZGlyZWN0aW9uXG4gICAgfSA9IHtcbiAgICAgIC4uLmRlZmF1bHRPcHRpb25zLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH07XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG4gICAgdGhpcy5oaXN0b3J5Q2hhbmdlZCA9IGhpc3RvcnlDaGFuZ2VkO1xuICAgIHRoaXMucmVmZXJyZXIgPSByZWZlcnJlcjtcbiAgICB0aGlzLnNuYXBzaG90ID0gc25hcHNob3Q7XG4gICAgdGhpcy5zbmFwc2hvdEhUTUwgPSBzbmFwc2hvdEhUTUw7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMuaXNTYW1lUGFnZSA9IHRoaXMuZGVsZWdhdGUubG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZSh0aGlzLmxvY2F0aW9uLCB0aGlzLmFjdGlvbik7XG4gICAgdGhpcy5pc1BhZ2VSZWZyZXNoID0gdGhpcy52aWV3LmlzUGFnZVJlZnJlc2godGhpcyk7XG4gICAgdGhpcy52aXNpdENhY2hlZFNuYXBzaG90ID0gdmlzaXRDYWNoZWRTbmFwc2hvdDtcbiAgICB0aGlzLndpbGxSZW5kZXIgPSB3aWxsUmVuZGVyO1xuICAgIHRoaXMudXBkYXRlSGlzdG9yeSA9IHVwZGF0ZUhpc3Rvcnk7XG4gICAgdGhpcy5zY3JvbGxlZCA9ICF3aWxsUmVuZGVyO1xuICAgIHRoaXMuc2hvdWxkQ2FjaGVTbmFwc2hvdCA9IHNob3VsZENhY2hlU25hcHNob3Q7XG4gICAgdGhpcy5hY2NlcHRzU3RyZWFtUmVzcG9uc2UgPSBhY2NlcHRzU3RyZWFtUmVzcG9uc2U7XG4gICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb24gfHwgRGlyZWN0aW9uW2FjdGlvbl07XG4gIH1cblxuICBnZXQgYWRhcHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5hZGFwdGVyXG4gIH1cblxuICBnZXQgdmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS52aWV3XG4gIH1cblxuICBnZXQgaGlzdG9yeSgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5XG4gIH1cblxuICBnZXQgcmVzdG9yYXRpb25EYXRhKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkuZ2V0UmVzdG9yYXRpb25EYXRhRm9ySWRlbnRpZmllcih0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllcilcbiAgfVxuXG4gIGdldCBzaWxlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNTYW1lUGFnZVxuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gVmlzaXRTdGF0ZS5pbml0aWFsaXplZCkge1xuICAgICAgdGhpcy5yZWNvcmRUaW1pbmdNZXRyaWMoVGltaW5nTWV0cmljLnZpc2l0U3RhcnQpO1xuICAgICAgdGhpcy5zdGF0ZSA9IFZpc2l0U3RhdGUuc3RhcnRlZDtcbiAgICAgIHRoaXMuYWRhcHRlci52aXNpdFN0YXJ0ZWQodGhpcyk7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpc2l0U3RhcnRlZCh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gVmlzaXRTdGF0ZS5zdGFydGVkKSB7XG4gICAgICBpZiAodGhpcy5yZXF1ZXN0KSB7XG4gICAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2FuY2VsUmVuZGVyKCk7XG4gICAgICB0aGlzLnN0YXRlID0gVmlzaXRTdGF0ZS5jYW5jZWxlZDtcbiAgICB9XG4gIH1cblxuICBjb21wbGV0ZSgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBWaXNpdFN0YXRlLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy52aXNpdEVuZCk7XG4gICAgICB0aGlzLmFkYXB0ZXIudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgICB0aGlzLnN0YXRlID0gVmlzaXRTdGF0ZS5jb21wbGV0ZWQ7XG4gICAgICB0aGlzLmZvbGxvd1JlZGlyZWN0KCk7XG5cbiAgICAgIGlmICghdGhpcy5mb2xsb3dlZFJlZGlyZWN0KSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZmFpbCgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBWaXNpdFN0YXRlLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBWaXNpdFN0YXRlLmZhaWxlZDtcbiAgICAgIHRoaXMuYWRhcHRlci52aXNpdEZhaWxlZCh0aGlzKTtcbiAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgY2hhbmdlSGlzdG9yeSgpIHtcbiAgICBpZiAoIXRoaXMuaGlzdG9yeUNoYW5nZWQgJiYgdGhpcy51cGRhdGVIaXN0b3J5KSB7XG4gICAgICBjb25zdCBhY3Rpb25Gb3JIaXN0b3J5ID0gdGhpcy5sb2NhdGlvbi5ocmVmID09PSB0aGlzLnJlZmVycmVyPy5ocmVmID8gXCJyZXBsYWNlXCIgOiB0aGlzLmFjdGlvbjtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGdldEhpc3RvcnlNZXRob2RGb3JBY3Rpb24oYWN0aW9uRm9ySGlzdG9yeSk7XG4gICAgICB0aGlzLmhpc3RvcnkudXBkYXRlKG1ldGhvZCwgdGhpcy5sb2NhdGlvbiwgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIpO1xuICAgICAgdGhpcy5oaXN0b3J5Q2hhbmdlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgaXNzdWVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLmhhc1ByZWxvYWRlZFJlc3BvbnNlKCkpIHtcbiAgICAgIHRoaXMuc2ltdWxhdGVSZXF1ZXN0KCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnNob3VsZElzc3VlUmVxdWVzdCgpICYmICF0aGlzLnJlcXVlc3QpIHtcbiAgICAgIHRoaXMucmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QodGhpcywgRmV0Y2hNZXRob2QuZ2V0LCB0aGlzLmxvY2F0aW9uKTtcbiAgICAgIHRoaXMucmVxdWVzdC5wZXJmb3JtKCk7XG4gICAgfVxuICB9XG5cbiAgc2ltdWxhdGVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLnJlc3BvbnNlKSB7XG4gICAgICB0aGlzLnN0YXJ0UmVxdWVzdCgpO1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSgpO1xuICAgICAgdGhpcy5maW5pc2hSZXF1ZXN0KCk7XG4gICAgfVxuICB9XG5cbiAgc3RhcnRSZXF1ZXN0KCkge1xuICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy5yZXF1ZXN0U3RhcnQpO1xuICAgIHRoaXMuYWRhcHRlci52aXNpdFJlcXVlc3RTdGFydGVkKHRoaXMpO1xuICB9XG5cbiAgcmVjb3JkUmVzcG9uc2UocmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlKSB7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgY29uc3QgeyBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICAgIGlmIChpc1N1Y2Nlc3NmdWwoc3RhdHVzQ29kZSkpIHtcbiAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVxdWVzdENvbXBsZXRlZCh0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYWRhcHRlci52aXNpdFJlcXVlc3RGYWlsZWRXaXRoU3RhdHVzQ29kZSh0aGlzLCBzdGF0dXNDb2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmaW5pc2hSZXF1ZXN0KCkge1xuICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy5yZXF1ZXN0RW5kKTtcbiAgICB0aGlzLmFkYXB0ZXIudmlzaXRSZXF1ZXN0RmluaXNoZWQodGhpcyk7XG4gIH1cblxuICBsb2FkUmVzcG9uc2UoKSB7XG4gICAgaWYgKHRoaXMucmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHsgc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MIH0gPSB0aGlzLnJlc3BvbnNlO1xuICAgICAgdGhpcy5yZW5kZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zaG91bGRDYWNoZVNuYXBzaG90KSB0aGlzLmNhY2hlU25hcHNob3QoKTtcbiAgICAgICAgaWYgKHRoaXMudmlldy5yZW5kZXJQcm9taXNlKSBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUHJvbWlzZTtcblxuICAgICAgICBpZiAoaXNTdWNjZXNzZnVsKHN0YXR1c0NvZGUpICYmIHJlc3BvbnNlSFRNTCAhPSBudWxsKSB7XG4gICAgICAgICAgY29uc3Qgc25hcHNob3QgPSBQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclBhZ2VTbmFwc2hvdChzbmFwc2hvdCwgZmFsc2UpO1xuXG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJFcnJvcihQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKSwgdGhpcyk7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgdGhpcy5mYWlsKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGdldENhY2hlZFNuYXBzaG90KCkge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy52aWV3LmdldENhY2hlZFNuYXBzaG90Rm9yTG9jYXRpb24odGhpcy5sb2NhdGlvbikgfHwgdGhpcy5nZXRQcmVsb2FkZWRTbmFwc2hvdCgpO1xuXG4gICAgaWYgKHNuYXBzaG90ICYmICghZ2V0QW5jaG9yKHRoaXMubG9jYXRpb24pIHx8IHNuYXBzaG90Lmhhc0FuY2hvcihnZXRBbmNob3IodGhpcy5sb2NhdGlvbikpKSkge1xuICAgICAgaWYgKHRoaXMuYWN0aW9uID09IFwicmVzdG9yZVwiIHx8IHNuYXBzaG90LmlzUHJldmlld2FibGUpIHtcbiAgICAgICAgcmV0dXJuIHNuYXBzaG90XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0UHJlbG9hZGVkU25hcHNob3QoKSB7XG4gICAgaWYgKHRoaXMuc25hcHNob3RIVE1MKSB7XG4gICAgICByZXR1cm4gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHRoaXMuc25hcHNob3RIVE1MKVxuICAgIH1cbiAgfVxuXG4gIGhhc0NhY2hlZFNuYXBzaG90KCkge1xuICAgIHJldHVybiB0aGlzLmdldENhY2hlZFNuYXBzaG90KCkgIT0gbnVsbFxuICB9XG5cbiAgbG9hZENhY2hlZFNuYXBzaG90KCkge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy5nZXRDYWNoZWRTbmFwc2hvdCgpO1xuICAgIGlmIChzbmFwc2hvdCkge1xuICAgICAgY29uc3QgaXNQcmV2aWV3ID0gdGhpcy5zaG91bGRJc3N1ZVJlcXVlc3QoKTtcbiAgICAgIHRoaXMucmVuZGVyKGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5jYWNoZVNuYXBzaG90KCk7XG4gICAgICAgIGlmICh0aGlzLmlzU2FtZVBhZ2UgfHwgdGhpcy5pc1BhZ2VSZWZyZXNoKSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHRoaXMudmlldy5yZW5kZXJQcm9taXNlKSBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUHJvbWlzZTtcblxuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyUGFnZVNuYXBzaG90KHNuYXBzaG90LCBpc1ByZXZpZXcpO1xuXG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgaWYgKCFpc1ByZXZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZvbGxvd1JlZGlyZWN0KCkge1xuICAgIGlmICh0aGlzLnJlZGlyZWN0ZWRUb0xvY2F0aW9uICYmICF0aGlzLmZvbGxvd2VkUmVkaXJlY3QgJiYgdGhpcy5yZXNwb25zZT8ucmVkaXJlY3RlZCkge1xuICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UHJvcG9zZWRUb0xvY2F0aW9uKHRoaXMucmVkaXJlY3RlZFRvTG9jYXRpb24sIHtcbiAgICAgICAgYWN0aW9uOiBcInJlcGxhY2VcIixcbiAgICAgICAgcmVzcG9uc2U6IHRoaXMucmVzcG9uc2UsXG4gICAgICAgIHNob3VsZENhY2hlU25hcHNob3Q6IGZhbHNlLFxuICAgICAgICB3aWxsUmVuZGVyOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICB0aGlzLmZvbGxvd2VkUmVkaXJlY3QgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGdvVG9TYW1lUGFnZUFuY2hvcigpIHtcbiAgICBpZiAodGhpcy5pc1NhbWVQYWdlKSB7XG4gICAgICB0aGlzLnJlbmRlcihhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2FjaGVTbmFwc2hvdCgpO1xuICAgICAgICB0aGlzLnBlcmZvcm1TY3JvbGwoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VIaXN0b3J5KCk7XG4gICAgICAgIHRoaXMuYWRhcHRlci52aXNpdFJlbmRlcmVkKHRoaXMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gRmV0Y2ggcmVxdWVzdCBkZWxlZ2F0ZVxuXG4gIHByZXBhcmVSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBpZiAodGhpcy5hY2NlcHRzU3RyZWFtUmVzcG9uc2UpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKCkge1xuICAgIHRoaXMuc3RhcnRSZXF1ZXN0KCk7XG4gIH1cblxuICByZXF1ZXN0UHJldmVudGVkSGFuZGxpbmdSZXNwb25zZShfcmVxdWVzdCwgX3Jlc3BvbnNlKSB7fVxuXG4gIGFzeW5jIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICBpZiAocmVzcG9uc2VIVE1MID09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSh7XG4gICAgICAgIHN0YXR1c0NvZGU6IFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaCxcbiAgICAgICAgcmVkaXJlY3RlZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVkaXJlY3RlZFRvTG9jYXRpb24gPSByZXNwb25zZS5yZWRpcmVjdGVkID8gcmVzcG9uc2UubG9jYXRpb24gOiB1bmRlZmluZWQ7XG4gICAgICB0aGlzLnJlY29yZFJlc3BvbnNlKHsgc3RhdHVzQ29kZTogc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MLCByZWRpcmVjdGVkIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICBpZiAocmVzcG9uc2VIVE1MID09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSh7XG4gICAgICAgIHN0YXR1c0NvZGU6IFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaCxcbiAgICAgICAgcmVkaXJlY3RlZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVjb3JkUmVzcG9uc2UoeyBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLCByZXNwb25zZUhUTUwsIHJlZGlyZWN0ZWQgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdEVycm9yZWQoX3JlcXVlc3QsIF9lcnJvcikge1xuICAgIHRoaXMucmVjb3JkUmVzcG9uc2Uoe1xuICAgICAgc3RhdHVzQ29kZTogU3lzdGVtU3RhdHVzQ29kZS5uZXR3b3JrRmFpbHVyZSxcbiAgICAgIHJlZGlyZWN0ZWQ6IGZhbHNlXG4gICAgfSk7XG4gIH1cblxuICByZXF1ZXN0RmluaXNoZWQoKSB7XG4gICAgdGhpcy5maW5pc2hSZXF1ZXN0KCk7XG4gIH1cblxuICAvLyBTY3JvbGxpbmdcblxuICBwZXJmb3JtU2Nyb2xsKCkge1xuICAgIGlmICghdGhpcy5zY3JvbGxlZCAmJiAhdGhpcy52aWV3LmZvcmNlUmVsb2FkZWQgJiYgIXRoaXMudmlldy5zaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKHRoaXMpKSB7XG4gICAgICBpZiAodGhpcy5hY3Rpb24gPT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb1Jlc3RvcmVkUG9zaXRpb24oKSB8fCB0aGlzLnNjcm9sbFRvQW5jaG9yKCkgfHwgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNjcm9sbFRvQW5jaG9yKCkgfHwgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5pc1NhbWVQYWdlKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbih0aGlzLnZpZXcubGFzdFJlbmRlcmVkTG9jYXRpb24sIHRoaXMubG9jYXRpb24pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNjcm9sbGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzY3JvbGxUb1Jlc3RvcmVkUG9zaXRpb24oKSB7XG4gICAgY29uc3QgeyBzY3JvbGxQb3NpdGlvbiB9ID0gdGhpcy5yZXN0b3JhdGlvbkRhdGE7XG4gICAgaWYgKHNjcm9sbFBvc2l0aW9uKSB7XG4gICAgICB0aGlzLnZpZXcuc2Nyb2xsVG9Qb3NpdGlvbihzY3JvbGxQb3NpdGlvbik7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIHNjcm9sbFRvQW5jaG9yKCkge1xuICAgIGNvbnN0IGFuY2hvciA9IGdldEFuY2hvcih0aGlzLmxvY2F0aW9uKTtcbiAgICBpZiAoYW5jaG9yICE9IG51bGwpIHtcbiAgICAgIHRoaXMudmlldy5zY3JvbGxUb0FuY2hvcihhbmNob3IpO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cblxuICAvLyBJbnN0cnVtZW50YXRpb25cblxuICByZWNvcmRUaW1pbmdNZXRyaWMobWV0cmljKSB7XG4gICAgdGhpcy50aW1pbmdNZXRyaWNzW21ldHJpY10gPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgfVxuXG4gIGdldFRpbWluZ01ldHJpY3MoKSB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy50aW1pbmdNZXRyaWNzIH1cbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBnZXRIaXN0b3J5TWV0aG9kRm9yQWN0aW9uKGFjdGlvbikge1xuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlIFwicmVwbGFjZVwiOlxuICAgICAgICByZXR1cm4gaGlzdG9yeS5yZXBsYWNlU3RhdGVcbiAgICAgIGNhc2UgXCJhZHZhbmNlXCI6XG4gICAgICBjYXNlIFwicmVzdG9yZVwiOlxuICAgICAgICByZXR1cm4gaGlzdG9yeS5wdXNoU3RhdGVcbiAgICB9XG4gIH1cblxuICBoYXNQcmVsb2FkZWRSZXNwb25zZSgpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaXMucmVzcG9uc2UgPT0gXCJvYmplY3RcIlxuICB9XG5cbiAgc2hvdWxkSXNzdWVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLmlzU2FtZVBhZ2UpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0gZWxzZSBpZiAodGhpcy5hY3Rpb24gPT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgIHJldHVybiAhdGhpcy5oYXNDYWNoZWRTbmFwc2hvdCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLndpbGxSZW5kZXJcbiAgICB9XG4gIH1cblxuICBjYWNoZVNuYXBzaG90KCkge1xuICAgIGlmICghdGhpcy5zbmFwc2hvdENhY2hlZCkge1xuICAgICAgdGhpcy52aWV3LmNhY2hlU25hcHNob3QodGhpcy5zbmFwc2hvdCkudGhlbigoc25hcHNob3QpID0+IHNuYXBzaG90ICYmIHRoaXMudmlzaXRDYWNoZWRTbmFwc2hvdChzbmFwc2hvdCkpO1xuICAgICAgdGhpcy5zbmFwc2hvdENhY2hlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVuZGVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5jYW5jZWxSZW5kZXIoKTtcbiAgICB0aGlzLmZyYW1lID0gYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICBhd2FpdCBjYWxsYmFjaygpO1xuICAgIGRlbGV0ZSB0aGlzLmZyYW1lO1xuICB9XG5cbiAgYXN5bmMgcmVuZGVyUGFnZVNuYXBzaG90KHNuYXBzaG90LCBpc1ByZXZpZXcpIHtcbiAgICBhd2FpdCB0aGlzLnZpZXdUcmFuc2l0aW9uZXIucmVuZGVyQ2hhbmdlKHRoaXMudmlldy5zaG91bGRUcmFuc2l0aW9uVG8oc25hcHNob3QpLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUGFnZShzbmFwc2hvdCwgaXNQcmV2aWV3LCB0aGlzLndpbGxSZW5kZXIsIHRoaXMpO1xuICAgICAgdGhpcy5wZXJmb3JtU2Nyb2xsKCk7XG4gICAgfSk7XG4gIH1cblxuICBjYW5jZWxSZW5kZXIoKSB7XG4gICAgaWYgKHRoaXMuZnJhbWUpIHtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuZnJhbWUpO1xuICAgICAgZGVsZXRlIHRoaXMuZnJhbWU7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGlzU3VjY2Vzc2Z1bChzdGF0dXNDb2RlKSB7XG4gIHJldHVybiBzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwXG59XG5cbmNsYXNzIEJyb3dzZXJBZGFwdGVyIHtcbiAgcHJvZ3Jlc3NCYXIgPSBuZXcgUHJvZ3Jlc3NCYXIoKVxuXG4gIGNvbnN0cnVjdG9yKHNlc3Npb24pIHtcbiAgICB0aGlzLnNlc3Npb24gPSBzZXNzaW9uO1xuICB9XG5cbiAgdmlzaXRQcm9wb3NlZFRvTG9jYXRpb24obG9jYXRpb24sIG9wdGlvbnMpIHtcbiAgICBpZiAobG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5uYXZpZ2F0b3Iucm9vdExvY2F0aW9uKSkge1xuICAgICAgdGhpcy5uYXZpZ2F0b3Iuc3RhcnRWaXNpdChsb2NhdGlvbiwgb3B0aW9ucz8ucmVzdG9yYXRpb25JZGVudGlmaWVyIHx8IHV1aWQoKSwgb3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbG9jYXRpb24udG9TdHJpbmcoKTtcbiAgICB9XG4gIH1cblxuICB2aXNpdFN0YXJ0ZWQodmlzaXQpIHtcbiAgICB0aGlzLmxvY2F0aW9uID0gdmlzaXQubG9jYXRpb247XG4gICAgdmlzaXQubG9hZENhY2hlZFNuYXBzaG90KCk7XG4gICAgdmlzaXQuaXNzdWVSZXF1ZXN0KCk7XG4gICAgdmlzaXQuZ29Ub1NhbWVQYWdlQW5jaG9yKCk7XG4gIH1cblxuICB2aXNpdFJlcXVlc3RTdGFydGVkKHZpc2l0KSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5zZXRWYWx1ZSgwKTtcbiAgICBpZiAodmlzaXQuaGFzQ2FjaGVkU25hcHNob3QoKSB8fCB2aXNpdC5hY3Rpb24gIT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgIHRoaXMuc2hvd1Zpc2l0UHJvZ3Jlc3NCYXJBZnRlckRlbGF5KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2hvd1Byb2dyZXNzQmFyKCk7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRSZXF1ZXN0Q29tcGxldGVkKHZpc2l0KSB7XG4gICAgdmlzaXQubG9hZFJlc3BvbnNlKCk7XG4gIH1cblxuICB2aXNpdFJlcXVlc3RGYWlsZWRXaXRoU3RhdHVzQ29kZSh2aXNpdCwgc3RhdHVzQ29kZSkge1xuICAgIHN3aXRjaCAoc3RhdHVzQ29kZSkge1xuICAgICAgY2FzZSBTeXN0ZW1TdGF0dXNDb2RlLm5ldHdvcmtGYWlsdXJlOlxuICAgICAgY2FzZSBTeXN0ZW1TdGF0dXNDb2RlLnRpbWVvdXRGYWlsdXJlOlxuICAgICAgY2FzZSBTeXN0ZW1TdGF0dXNDb2RlLmNvbnRlbnRUeXBlTWlzbWF0Y2g6XG4gICAgICAgIHJldHVybiB0aGlzLnJlbG9hZCh7XG4gICAgICAgICAgcmVhc29uOiBcInJlcXVlc3RfZmFpbGVkXCIsXG4gICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgc3RhdHVzQ29kZVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB2aXNpdC5sb2FkUmVzcG9uc2UoKVxuICAgIH1cbiAgfVxuXG4gIHZpc2l0UmVxdWVzdEZpbmlzaGVkKF92aXNpdCkge31cblxuICB2aXNpdENvbXBsZXRlZChfdmlzaXQpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDEpO1xuICAgIHRoaXMuaGlkZVZpc2l0UHJvZ3Jlc3NCYXIoKTtcbiAgfVxuXG4gIHBhZ2VJbnZhbGlkYXRlZChyZWFzb24pIHtcbiAgICB0aGlzLnJlbG9hZChyZWFzb24pO1xuICB9XG5cbiAgdmlzaXRGYWlsZWQoX3Zpc2l0KSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5zZXRWYWx1ZSgxKTtcbiAgICB0aGlzLmhpZGVWaXNpdFByb2dyZXNzQmFyKCk7XG4gIH1cblxuICB2aXNpdFJlbmRlcmVkKF92aXNpdCkge31cblxuICAvLyBGb3JtIFN1Ym1pc3Npb24gRGVsZWdhdGVcblxuICBmb3JtU3VibWlzc2lvblN0YXJ0ZWQoX2Zvcm1TdWJtaXNzaW9uKSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5zZXRWYWx1ZSgwKTtcbiAgICB0aGlzLnNob3dGb3JtUHJvZ3Jlc3NCYXJBZnRlckRlbGF5KCk7XG4gIH1cblxuICBmb3JtU3VibWlzc2lvbkZpbmlzaGVkKF9mb3JtU3VibWlzc2lvbikge1xuICAgIHRoaXMucHJvZ3Jlc3NCYXIuc2V0VmFsdWUoMSk7XG4gICAgdGhpcy5oaWRlRm9ybVByb2dyZXNzQmFyKCk7XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgc2hvd1Zpc2l0UHJvZ3Jlc3NCYXJBZnRlckRlbGF5KCkge1xuICAgIHRoaXMudmlzaXRQcm9ncmVzc0JhclRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCh0aGlzLnNob3dQcm9ncmVzc0JhciwgdGhpcy5zZXNzaW9uLnByb2dyZXNzQmFyRGVsYXkpO1xuICB9XG5cbiAgaGlkZVZpc2l0UHJvZ3Jlc3NCYXIoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5oaWRlKCk7XG4gICAgaWYgKHRoaXMudmlzaXRQcm9ncmVzc0JhclRpbWVvdXQgIT0gbnVsbCkge1xuICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnZpc2l0UHJvZ3Jlc3NCYXJUaW1lb3V0KTtcbiAgICAgIGRlbGV0ZSB0aGlzLnZpc2l0UHJvZ3Jlc3NCYXJUaW1lb3V0O1xuICAgIH1cbiAgfVxuXG4gIHNob3dGb3JtUHJvZ3Jlc3NCYXJBZnRlckRlbGF5KCkge1xuICAgIGlmICh0aGlzLmZvcm1Qcm9ncmVzc0JhclRpbWVvdXQgPT0gbnVsbCkge1xuICAgICAgdGhpcy5mb3JtUHJvZ3Jlc3NCYXJUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQodGhpcy5zaG93UHJvZ3Jlc3NCYXIsIHRoaXMuc2Vzc2lvbi5wcm9ncmVzc0JhckRlbGF5KTtcbiAgICB9XG4gIH1cblxuICBoaWRlRm9ybVByb2dyZXNzQmFyKCkge1xuICAgIHRoaXMucHJvZ3Jlc3NCYXIuaGlkZSgpO1xuICAgIGlmICh0aGlzLmZvcm1Qcm9ncmVzc0JhclRpbWVvdXQgIT0gbnVsbCkge1xuICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLmZvcm1Qcm9ncmVzc0JhclRpbWVvdXQpO1xuICAgICAgZGVsZXRlIHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dDtcbiAgICB9XG4gIH1cblxuICBzaG93UHJvZ3Jlc3NCYXIgPSAoKSA9PiB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5zaG93KCk7XG4gIH1cblxuICByZWxvYWQocmVhc29uKSB7XG4gICAgZGlzcGF0Y2goXCJ0dXJibzpyZWxvYWRcIiwgeyBkZXRhaWw6IHJlYXNvbiB9KTtcblxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdGhpcy5sb2NhdGlvbj8udG9TdHJpbmcoKSB8fCB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgfVxuXG4gIGdldCBuYXZpZ2F0b3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2Vzc2lvbi5uYXZpZ2F0b3JcbiAgfVxufVxuXG5jbGFzcyBDYWNoZU9ic2VydmVyIHtcbiAgc2VsZWN0b3IgPSBcIltkYXRhLXR1cmJvLXRlbXBvcmFyeV1cIlxuICBkZXByZWNhdGVkU2VsZWN0b3IgPSBcIltkYXRhLXR1cmJvLWNhY2hlPWZhbHNlXVwiXG5cbiAgc3RhcnRlZCA9IGZhbHNlXG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWNhY2hlXCIsIHRoaXMucmVtb3ZlVGVtcG9yYXJ5RWxlbWVudHMsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS1jYWNoZVwiLCB0aGlzLnJlbW92ZVRlbXBvcmFyeUVsZW1lbnRzLCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlVGVtcG9yYXJ5RWxlbWVudHMgPSAoX2V2ZW50KSA9PiB7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMudGVtcG9yYXJ5RWxlbWVudHMpIHtcbiAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHRlbXBvcmFyeUVsZW1lbnRzKCkge1xuICAgIHJldHVybiBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yKSwgLi4udGhpcy50ZW1wb3JhcnlFbGVtZW50c1dpdGhEZXByZWNhdGlvbl1cbiAgfVxuXG4gIGdldCB0ZW1wb3JhcnlFbGVtZW50c1dpdGhEZXByZWNhdGlvbigpIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5kZXByZWNhdGVkU2VsZWN0b3IpO1xuXG4gICAgaWYgKGVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBgVGhlICR7dGhpcy5kZXByZWNhdGVkU2VsZWN0b3J9IHNlbGVjdG9yIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uLiBVc2UgJHt0aGlzLnNlbGVjdG9yfSBpbnN0ZWFkLmBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFsuLi5lbGVtZW50c11cbiAgfVxufVxuXG5jbGFzcyBGcmFtZVJlZGlyZWN0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXNzaW9uLCBlbGVtZW50KSB7XG4gICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yID0gbmV3IExpbmtJbnRlcmNlcHRvcih0aGlzLCBlbGVtZW50KTtcbiAgICB0aGlzLmZvcm1TdWJtaXRPYnNlcnZlciA9IG5ldyBGb3JtU3VibWl0T2JzZXJ2ZXIodGhpcywgZWxlbWVudCk7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICB0aGlzLmxpbmtJbnRlcmNlcHRvci5zdGFydCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyLnN0YXJ0KCk7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0b3AoKTtcbiAgICB0aGlzLmZvcm1TdWJtaXRPYnNlcnZlci5zdG9wKCk7XG4gIH1cblxuICAvLyBMaW5rIGludGVyY2VwdG9yIGRlbGVnYXRlXG5cbiAgc2hvdWxkSW50ZXJjZXB0TGlua0NsaWNrKGVsZW1lbnQsIF9sb2NhdGlvbiwgX2V2ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuI3Nob3VsZFJlZGlyZWN0KGVsZW1lbnQpXG4gIH1cblxuICBsaW5rQ2xpY2tJbnRlcmNlcHRlZChlbGVtZW50LCB1cmwsIGV2ZW50KSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQpO1xuICAgIGlmIChmcmFtZSkge1xuICAgICAgZnJhbWUuZGVsZWdhdGUubGlua0NsaWNrSW50ZXJjZXB0ZWQoZWxlbWVudCwgdXJsLCBldmVudCk7XG4gICAgfVxuICB9XG5cbiAgLy8gRm9ybSBzdWJtaXQgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybShlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICByZXR1cm4gKFxuICAgICAgZWxlbWVudC5jbG9zZXN0KFwidHVyYm8tZnJhbWVcIikgPT0gbnVsbCAmJlxuICAgICAgdGhpcy4jc2hvdWxkU3VibWl0KGVsZW1lbnQsIHN1Ym1pdHRlcikgJiZcbiAgICAgIHRoaXMuI3Nob3VsZFJlZGlyZWN0KGVsZW1lbnQsIHN1Ym1pdHRlcilcbiAgICApXG4gIH1cblxuICBmb3JtU3VibWl0dGVkKGVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGZyYW1lID0gdGhpcy4jZmluZEZyYW1lRWxlbWVudChlbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIGlmIChmcmFtZSkge1xuICAgICAgZnJhbWUuZGVsZWdhdGUuZm9ybVN1Ym1pdHRlZChlbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIH1cbiAgfVxuXG4gICNzaG91bGRTdWJtaXQoZm9ybSwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgYWN0aW9uID0gZ2V0QWN0aW9uJDEoZm9ybSwgc3VibWl0dGVyKTtcbiAgICBjb25zdCBtZXRhID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbWV0YVtuYW1lPVwidHVyYm8tcm9vdFwiXWApO1xuICAgIGNvbnN0IHJvb3RMb2NhdGlvbiA9IGV4cGFuZFVSTChtZXRhPy5jb250ZW50ID8/IFwiL1wiKTtcblxuICAgIHJldHVybiB0aGlzLiNzaG91bGRSZWRpcmVjdChmb3JtLCBzdWJtaXR0ZXIpICYmIGxvY2F0aW9uSXNWaXNpdGFibGUoYWN0aW9uLCByb290TG9jYXRpb24pXG4gIH1cblxuICAjc2hvdWxkUmVkaXJlY3QoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgaXNOYXZpZ2F0YWJsZSA9XG4gICAgICBlbGVtZW50IGluc3RhbmNlb2YgSFRNTEZvcm1FbGVtZW50XG4gICAgICAgID8gdGhpcy5zZXNzaW9uLnN1Ym1pc3Npb25Jc05hdmlnYXRhYmxlKGVsZW1lbnQsIHN1Ym1pdHRlcilcbiAgICAgICAgOiB0aGlzLnNlc3Npb24uZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCk7XG5cbiAgICBpZiAoaXNOYXZpZ2F0YWJsZSkge1xuICAgICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgICByZXR1cm4gZnJhbWUgPyBmcmFtZSAhPSBlbGVtZW50LmNsb3Nlc3QoXCJ0dXJiby1mcmFtZVwiKSA6IGZhbHNlXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gICNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGlkID0gc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIpIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKTtcbiAgICBpZiAoaWQgJiYgaWQgIT0gXCJfdG9wXCIpIHtcbiAgICAgIGNvbnN0IGZyYW1lID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lkfTpub3QoW2Rpc2FibGVkXSlgKTtcbiAgICAgIGlmIChmcmFtZSBpbnN0YW5jZW9mIEZyYW1lRWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZnJhbWVcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgSGlzdG9yeSB7XG4gIGxvY2F0aW9uXG4gIHJlc3RvcmF0aW9uSWRlbnRpZmllciA9IHV1aWQoKVxuICByZXN0b3JhdGlvbkRhdGEgPSB7fVxuICBzdGFydGVkID0gZmFsc2VcbiAgcGFnZUxvYWRlZCA9IGZhbHNlXG4gIGN1cnJlbnRJbmRleCA9IDBcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgdGhpcy5vblBvcFN0YXRlLCBmYWxzZSk7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCB0aGlzLm9uUGFnZUxvYWQsIGZhbHNlKTtcbiAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaGlzdG9yeS5zdGF0ZT8udHVyYm8/LnJlc3RvcmF0aW9uSW5kZXggfHwgMDtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLnJlcGxhY2UobmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZikpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIHRoaXMub25Qb3BTdGF0ZSwgZmFsc2UpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgdGhpcy5vblBhZ2VMb2FkLCBmYWxzZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwdXNoKGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIpIHtcbiAgICB0aGlzLnVwZGF0ZShoaXN0b3J5LnB1c2hTdGF0ZSwgbG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllcik7XG4gIH1cblxuICByZXBsYWNlKGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIpIHtcbiAgICB0aGlzLnVwZGF0ZShoaXN0b3J5LnJlcGxhY2VTdGF0ZSwgbG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllcik7XG4gIH1cblxuICB1cGRhdGUobWV0aG9kLCBsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyID0gdXVpZCgpKSB7XG4gICAgaWYgKG1ldGhvZCA9PT0gaGlzdG9yeS5wdXNoU3RhdGUpICsrdGhpcy5jdXJyZW50SW5kZXg7XG5cbiAgICBjb25zdCBzdGF0ZSA9IHsgdHVyYm86IHsgcmVzdG9yYXRpb25JZGVudGlmaWVyLCByZXN0b3JhdGlvbkluZGV4OiB0aGlzLmN1cnJlbnRJbmRleCB9IH07XG4gICAgbWV0aG9kLmNhbGwoaGlzdG9yeSwgc3RhdGUsIFwiXCIsIGxvY2F0aW9uLmhyZWYpO1xuICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICB0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllciA9IHJlc3RvcmF0aW9uSWRlbnRpZmllcjtcbiAgfVxuXG4gIC8vIFJlc3RvcmF0aW9uIGRhdGFcblxuICBnZXRSZXN0b3JhdGlvbkRhdGFGb3JJZGVudGlmaWVyKHJlc3RvcmF0aW9uSWRlbnRpZmllcikge1xuICAgIHJldHVybiB0aGlzLnJlc3RvcmF0aW9uRGF0YVtyZXN0b3JhdGlvbklkZW50aWZpZXJdIHx8IHt9XG4gIH1cblxuICB1cGRhdGVSZXN0b3JhdGlvbkRhdGEoYWRkaXRpb25hbERhdGEpIHtcbiAgICBjb25zdCB7IHJlc3RvcmF0aW9uSWRlbnRpZmllciB9ID0gdGhpcztcbiAgICBjb25zdCByZXN0b3JhdGlvbkRhdGEgPSB0aGlzLnJlc3RvcmF0aW9uRGF0YVtyZXN0b3JhdGlvbklkZW50aWZpZXJdO1xuICAgIHRoaXMucmVzdG9yYXRpb25EYXRhW3Jlc3RvcmF0aW9uSWRlbnRpZmllcl0gPSB7XG4gICAgICAuLi5yZXN0b3JhdGlvbkRhdGEsXG4gICAgICAuLi5hZGRpdGlvbmFsRGF0YVxuICAgIH07XG4gIH1cblxuICAvLyBTY3JvbGwgcmVzdG9yYXRpb25cblxuICBhc3N1bWVDb250cm9sT2ZTY3JvbGxSZXN0b3JhdGlvbigpIHtcbiAgICBpZiAoIXRoaXMucHJldmlvdXNTY3JvbGxSZXN0b3JhdGlvbikge1xuICAgICAgdGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uID0gaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbiA/PyBcImF1dG9cIjtcbiAgICAgIGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24gPSBcIm1hbnVhbFwiO1xuICAgIH1cbiAgfVxuXG4gIHJlbGlucXVpc2hDb250cm9sT2ZTY3JvbGxSZXN0b3JhdGlvbigpIHtcbiAgICBpZiAodGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uKSB7XG4gICAgICBoaXN0b3J5LnNjcm9sbFJlc3RvcmF0aW9uID0gdGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uO1xuICAgICAgZGVsZXRlIHRoaXMucHJldmlvdXNTY3JvbGxSZXN0b3JhdGlvbjtcbiAgICB9XG4gIH1cblxuICAvLyBFdmVudCBoYW5kbGVyc1xuXG4gIG9uUG9wU3RhdGUgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5zaG91bGRIYW5kbGVQb3BTdGF0ZSgpKSB7XG4gICAgICBjb25zdCB7IHR1cmJvIH0gPSBldmVudC5zdGF0ZSB8fCB7fTtcbiAgICAgIGlmICh0dXJibykge1xuICAgICAgICB0aGlzLmxvY2F0aW9uID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgICAgIGNvbnN0IHsgcmVzdG9yYXRpb25JZGVudGlmaWVyLCByZXN0b3JhdGlvbkluZGV4IH0gPSB0dXJibztcbiAgICAgICAgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIgPSByZXN0b3JhdGlvbklkZW50aWZpZXI7XG4gICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHJlc3RvcmF0aW9uSW5kZXggPiB0aGlzLmN1cnJlbnRJbmRleCA/IFwiZm9yd2FyZFwiIDogXCJiYWNrXCI7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUuaGlzdG9yeVBvcHBlZFRvTG9jYXRpb25XaXRoUmVzdG9yYXRpb25JZGVudGlmaWVyQW5kRGlyZWN0aW9uKHRoaXMubG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllciwgZGlyZWN0aW9uKTtcbiAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSByZXN0b3JhdGlvbkluZGV4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG9uUGFnZUxvYWQgPSBhc3luYyAoX2V2ZW50KSA9PiB7XG4gICAgYXdhaXQgbmV4dE1pY3JvdGFzaygpO1xuICAgIHRoaXMucGFnZUxvYWRlZCA9IHRydWU7XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgc2hvdWxkSGFuZGxlUG9wU3RhdGUoKSB7XG4gICAgLy8gU2FmYXJpIGRpc3BhdGNoZXMgYSBwb3BzdGF0ZSBldmVudCBhZnRlciB3aW5kb3cncyBsb2FkIGV2ZW50LCBpZ25vcmUgaXRcbiAgICByZXR1cm4gdGhpcy5wYWdlSXNMb2FkZWQoKVxuICB9XG5cbiAgcGFnZUlzTG9hZGVkKCkge1xuICAgIHJldHVybiB0aGlzLnBhZ2VMb2FkZWQgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSBcImNvbXBsZXRlXCJcbiAgfVxufVxuXG5jbGFzcyBMaW5rUHJlZmV0Y2hPYnNlcnZlciB7XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuICAjcHJlZmV0Y2hlZExpbmsgPSBudWxsXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIGV2ZW50VGFyZ2V0KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHJldHVyblxuXG4gICAgaWYgKHRoaXMuZXZlbnRUYXJnZXQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkaW5nXCIpIHtcbiAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgdGhpcy4jZW5hYmxlLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuI2VuYWJsZSgpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHJldHVyblxuXG4gICAgdGhpcy5ldmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCB0aGlzLiN0cnlUb1ByZWZldGNoUmVxdWVzdCwge1xuICAgICAgY2FwdHVyZTogdHJ1ZSxcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIHRoaXMuI2NhbmNlbFJlcXVlc3RJZk9ic29sZXRlLCB7XG4gICAgICBjYXB0dXJlOiB0cnVlLFxuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5ldmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlcXVlc3RcIiwgdGhpcy4jdHJ5VG9Vc2VQcmVmZXRjaGVkUmVxdWVzdCwgdHJ1ZSk7XG4gICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gIH1cblxuICAjZW5hYmxlID0gKCkgPT4ge1xuICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgdGhpcy4jdHJ5VG9QcmVmZXRjaFJlcXVlc3QsIHtcbiAgICAgIGNhcHR1cmU6IHRydWUsXG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCB0aGlzLiNjYW5jZWxSZXF1ZXN0SWZPYnNvbGV0ZSwge1xuICAgICAgY2FwdHVyZTogdHJ1ZSxcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcblxuICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS1mZXRjaC1yZXF1ZXN0XCIsIHRoaXMuI3RyeVRvVXNlUHJlZmV0Y2hlZFJlcXVlc3QsIHRydWUpO1xuICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gIH1cblxuICAjdHJ5VG9QcmVmZXRjaFJlcXVlc3QgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZ2V0TWV0YUNvbnRlbnQoXCJ0dXJiby1wcmVmZXRjaFwiKSA9PT0gXCJmYWxzZVwiKSByZXR1cm5cblxuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICBjb25zdCBpc0xpbmsgPSB0YXJnZXQubWF0Y2hlcyAmJiB0YXJnZXQubWF0Y2hlcyhcImFbaHJlZl06bm90KFt0YXJnZXRePV9dKTpub3QoW2Rvd25sb2FkXSlcIik7XG5cbiAgICBpZiAoaXNMaW5rICYmIHRoaXMuI2lzUHJlZmV0Y2hhYmxlKHRhcmdldCkpIHtcbiAgICAgIGNvbnN0IGxpbmsgPSB0YXJnZXQ7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uRm9yTGluayhsaW5rKTtcblxuICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuY2FuUHJlZmV0Y2hSZXF1ZXN0VG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbikpIHtcbiAgICAgICAgdGhpcy4jcHJlZmV0Y2hlZExpbmsgPSBsaW5rO1xuXG4gICAgICAgIGNvbnN0IGZldGNoUmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QoXG4gICAgICAgICAgdGhpcyxcbiAgICAgICAgICBGZXRjaE1ldGhvZC5nZXQsXG4gICAgICAgICAgbG9jYXRpb24sXG4gICAgICAgICAgbmV3IFVSTFNlYXJjaFBhcmFtcygpLFxuICAgICAgICAgIHRhcmdldFxuICAgICAgICApO1xuXG4gICAgICAgIHByZWZldGNoQ2FjaGUuc2V0TGF0ZXIobG9jYXRpb24udG9TdHJpbmcoKSwgZmV0Y2hSZXF1ZXN0LCB0aGlzLiNjYWNoZVR0bCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgI2NhbmNlbFJlcXVlc3RJZk9ic29sZXRlID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcy4jcHJlZmV0Y2hlZExpbmspIHRoaXMuI2NhbmNlbFByZWZldGNoUmVxdWVzdCgpO1xuICB9XG5cbiAgI2NhbmNlbFByZWZldGNoUmVxdWVzdCA9ICgpID0+IHtcbiAgICBwcmVmZXRjaENhY2hlLmNsZWFyKCk7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZExpbmsgPSBudWxsO1xuICB9XG5cbiAgI3RyeVRvVXNlUHJlZmV0Y2hlZFJlcXVlc3QgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgIT09IFwiRk9STVwiICYmIGV2ZW50LmRldGFpbC5mZXRjaE9wdGlvbnMubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgICBjb25zdCBjYWNoZWQgPSBwcmVmZXRjaENhY2hlLmdldChldmVudC5kZXRhaWwudXJsLnRvU3RyaW5nKCkpO1xuXG4gICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgIC8vIFVzZXIgY2xpY2tlZCBsaW5rLCB1c2UgY2FjaGUgcmVzcG9uc2VcbiAgICAgICAgZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdCA9IGNhY2hlZDtcbiAgICAgIH1cblxuICAgICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuICAgIH1cbiAgfVxuXG4gIHByZXBhcmVSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBjb25zdCBsaW5rID0gcmVxdWVzdC50YXJnZXQ7XG5cbiAgICByZXF1ZXN0LmhlYWRlcnNbXCJYLVNlYy1QdXJwb3NlXCJdID0gXCJwcmVmZXRjaFwiO1xuXG4gICAgY29uc3QgdHVyYm9GcmFtZSA9IGxpbmsuY2xvc2VzdChcInR1cmJvLWZyYW1lXCIpO1xuICAgIGNvbnN0IHR1cmJvRnJhbWVUYXJnZXQgPSBsaW5rLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIikgfHwgdHVyYm9GcmFtZT8uZ2V0QXR0cmlidXRlKFwidGFyZ2V0XCIpIHx8IHR1cmJvRnJhbWU/LmlkO1xuXG4gICAgaWYgKHR1cmJvRnJhbWVUYXJnZXQgJiYgdHVyYm9GcmFtZVRhcmdldCAhPT0gXCJfdG9wXCIpIHtcbiAgICAgIHJlcXVlc3QuaGVhZGVyc1tcIlR1cmJvLUZyYW1lXCJdID0gdHVyYm9GcmFtZVRhcmdldDtcbiAgICB9XG4gIH1cblxuICAvLyBGZXRjaCByZXF1ZXN0IGludGVyZmFjZVxuXG4gIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UoKSB7fVxuXG4gIHJlcXVlc3RTdGFydGVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0RXJyb3JlZChmZXRjaFJlcXVlc3QpIHt9XG5cbiAgcmVxdWVzdEZpbmlzaGVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0UHJldmVudGVkSGFuZGxpbmdSZXNwb25zZShmZXRjaFJlcXVlc3QsIGZldGNoUmVzcG9uc2UpIHt9XG5cbiAgcmVxdWVzdEZhaWxlZFdpdGhSZXNwb25zZShmZXRjaFJlcXVlc3QsIGZldGNoUmVzcG9uc2UpIHt9XG5cbiAgZ2V0ICNjYWNoZVR0bCgpIHtcbiAgICByZXR1cm4gTnVtYmVyKGdldE1ldGFDb250ZW50KFwidHVyYm8tcHJlZmV0Y2gtY2FjaGUtdGltZVwiKSkgfHwgY2FjaGVUdGxcbiAgfVxuXG4gICNpc1ByZWZldGNoYWJsZShsaW5rKSB7XG4gICAgY29uc3QgaHJlZiA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKTtcblxuICAgIGlmICghaHJlZikgcmV0dXJuIGZhbHNlXG5cbiAgICBpZiAodW5mZXRjaGFibGVMaW5rKGxpbmspKSByZXR1cm4gZmFsc2VcbiAgICBpZiAobGlua1RvVGhlU2FtZVBhZ2UobGluaykpIHJldHVybiBmYWxzZVxuICAgIGlmIChsaW5rT3B0c091dChsaW5rKSkgcmV0dXJuIGZhbHNlXG4gICAgaWYgKG5vblNhZmVMaW5rKGxpbmspKSByZXR1cm4gZmFsc2VcbiAgICBpZiAoZXZlbnRQcmV2ZW50ZWQobGluaykpIHJldHVybiBmYWxzZVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfVxufVxuXG5jb25zdCB1bmZldGNoYWJsZUxpbmsgPSAobGluaykgPT4ge1xuICByZXR1cm4gbGluay5vcmlnaW4gIT09IGRvY3VtZW50LmxvY2F0aW9uLm9yaWdpbiB8fCAhW1wiaHR0cDpcIiwgXCJodHRwczpcIl0uaW5jbHVkZXMobGluay5wcm90b2NvbCkgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJ0YXJnZXRcIilcbn07XG5cbmNvbnN0IGxpbmtUb1RoZVNhbWVQYWdlID0gKGxpbmspID0+IHtcbiAgcmV0dXJuIChsaW5rLnBhdGhuYW1lICsgbGluay5zZWFyY2ggPT09IGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lICsgZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoKSB8fCBsaW5rLmhyZWYuc3RhcnRzV2l0aChcIiNcIilcbn07XG5cbmNvbnN0IGxpbmtPcHRzT3V0ID0gKGxpbmspID0+IHtcbiAgaWYgKGxpbmsuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1wcmVmZXRjaFwiKSA9PT0gXCJmYWxzZVwiKSByZXR1cm4gdHJ1ZVxuICBpZiAobGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvXCIpID09PSBcImZhbHNlXCIpIHJldHVybiB0cnVlXG5cbiAgY29uc3QgdHVyYm9QcmVmZXRjaFBhcmVudCA9IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkobGluaywgXCJbZGF0YS10dXJiby1wcmVmZXRjaF1cIik7XG4gIGlmICh0dXJib1ByZWZldGNoUGFyZW50ICYmIHR1cmJvUHJlZmV0Y2hQYXJlbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1wcmVmZXRjaFwiKSA9PT0gXCJmYWxzZVwiKSByZXR1cm4gdHJ1ZVxuXG4gIHJldHVybiBmYWxzZVxufTtcblxuY29uc3Qgbm9uU2FmZUxpbmsgPSAobGluaykgPT4ge1xuICBjb25zdCB0dXJib01ldGhvZCA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1tZXRob2RcIik7XG4gIGlmICh0dXJib01ldGhvZCAmJiB0dXJib01ldGhvZC50b0xvd2VyQ2FzZSgpICE9PSBcImdldFwiKSByZXR1cm4gdHJ1ZVxuXG4gIGlmIChpc1VKUyhsaW5rKSkgcmV0dXJuIHRydWVcbiAgaWYgKGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1jb25maXJtXCIpKSByZXR1cm4gdHJ1ZVxuICBpZiAobGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKSkgcmV0dXJuIHRydWVcblxuICByZXR1cm4gZmFsc2Vcbn07XG5cbmNvbnN0IGlzVUpTID0gKGxpbmspID0+IHtcbiAgcmV0dXJuIGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS1yZW1vdGVcIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLWJlaGF2aW9yXCIpIHx8IGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS1jb25maXJtXCIpIHx8IGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS1tZXRob2RcIilcbn07XG5cbmNvbnN0IGV2ZW50UHJldmVudGVkID0gKGxpbmspID0+IHtcbiAgY29uc3QgZXZlbnQgPSBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1wcmVmZXRjaFwiLCB7IHRhcmdldDogbGluaywgY2FuY2VsYWJsZTogdHJ1ZSB9KTtcbiAgcmV0dXJuIGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWRcbn07XG5cbmNsYXNzIE5hdmlnYXRvciB7XG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgcHJvcG9zZVZpc2l0KGxvY2F0aW9uLCBvcHRpb25zID0ge30pIHtcbiAgICBpZiAodGhpcy5kZWxlZ2F0ZS5hbGxvd3NWaXNpdGluZ0xvY2F0aW9uV2l0aEFjdGlvbihsb2NhdGlvbiwgb3B0aW9ucy5hY3Rpb24pKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpc2l0UHJvcG9zZWRUb0xvY2F0aW9uKGxvY2F0aW9uLCBvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICBzdGFydFZpc2l0KGxvY2F0YWJsZSwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCBvcHRpb25zID0ge30pIHtcbiAgICB0aGlzLnN0b3AoKTtcbiAgICB0aGlzLmN1cnJlbnRWaXNpdCA9IG5ldyBWaXNpdCh0aGlzLCBleHBhbmRVUkwobG9jYXRhYmxlKSwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCB7XG4gICAgICByZWZlcnJlcjogdGhpcy5sb2NhdGlvbixcbiAgICAgIC4uLm9wdGlvbnNcbiAgICB9KTtcbiAgICB0aGlzLmN1cnJlbnRWaXNpdC5zdGFydCgpO1xuICB9XG5cbiAgc3VibWl0Rm9ybShmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgICB0aGlzLnN0b3AoKTtcbiAgICB0aGlzLmZvcm1TdWJtaXNzaW9uID0gbmV3IEZvcm1TdWJtaXNzaW9uKHRoaXMsIGZvcm0sIHN1Ym1pdHRlciwgdHJ1ZSk7XG5cbiAgICB0aGlzLmZvcm1TdWJtaXNzaW9uLnN0YXJ0KCk7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLmZvcm1TdWJtaXNzaW9uKSB7XG4gICAgICB0aGlzLmZvcm1TdWJtaXNzaW9uLnN0b3AoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLmZvcm1TdWJtaXNzaW9uO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmN1cnJlbnRWaXNpdCkge1xuICAgICAgdGhpcy5jdXJyZW50VmlzaXQuY2FuY2VsKCk7XG4gICAgICBkZWxldGUgdGhpcy5jdXJyZW50VmlzaXQ7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGFkYXB0ZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUuYWRhcHRlclxuICB9XG5cbiAgZ2V0IHZpZXcoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUudmlld1xuICB9XG5cbiAgZ2V0IHJvb3RMb2NhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3LnNuYXBzaG90LnJvb3RMb2NhdGlvblxuICB9XG5cbiAgZ2V0IGhpc3RvcnkoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUuaGlzdG9yeVxuICB9XG5cbiAgLy8gRm9ybSBzdWJtaXNzaW9uIGRlbGVnYXRlXG5cbiAgZm9ybVN1Ym1pc3Npb25TdGFydGVkKGZvcm1TdWJtaXNzaW9uKSB7XG4gICAgLy8gTm90IGFsbCBhZGFwdGVycyBpbXBsZW1lbnQgZm9ybVN1Ym1pc3Npb25TdGFydGVkXG4gICAgaWYgKHR5cGVvZiB0aGlzLmFkYXB0ZXIuZm9ybVN1Ym1pc3Npb25TdGFydGVkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuYWRhcHRlci5mb3JtU3VibWlzc2lvblN0YXJ0ZWQoZm9ybVN1Ym1pc3Npb24pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZvcm1TdWJtaXNzaW9uU3VjY2VlZGVkV2l0aFJlc3BvbnNlKGZvcm1TdWJtaXNzaW9uLCBmZXRjaFJlc3BvbnNlKSB7XG4gICAgaWYgKGZvcm1TdWJtaXNzaW9uID09IHRoaXMuZm9ybVN1Ym1pc3Npb24pIHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IGZldGNoUmVzcG9uc2UucmVzcG9uc2VIVE1MO1xuICAgICAgaWYgKHJlc3BvbnNlSFRNTCkge1xuICAgICAgICBjb25zdCBzaG91bGRDYWNoZVNuYXBzaG90ID0gZm9ybVN1Ym1pc3Npb24uaXNTYWZlO1xuICAgICAgICBpZiAoIXNob3VsZENhY2hlU25hcHNob3QpIHtcbiAgICAgICAgICB0aGlzLnZpZXcuY2xlYXJTbmFwc2hvdENhY2hlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IHN0YXR1c0NvZGUsIHJlZGlyZWN0ZWQgfSA9IGZldGNoUmVzcG9uc2U7XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuI2dldEFjdGlvbkZvckZvcm1TdWJtaXNzaW9uKGZvcm1TdWJtaXNzaW9uLCBmZXRjaFJlc3BvbnNlKTtcbiAgICAgICAgY29uc3QgdmlzaXRPcHRpb25zID0ge1xuICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICBzaG91bGRDYWNoZVNuYXBzaG90LFxuICAgICAgICAgIHJlc3BvbnNlOiB7IHN0YXR1c0NvZGUsIHJlc3BvbnNlSFRNTCwgcmVkaXJlY3RlZCB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJvcG9zZVZpc2l0KGZldGNoUmVzcG9uc2UubG9jYXRpb24sIHZpc2l0T3B0aW9ucyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcblxuICAgIGlmIChyZXNwb25zZUhUTUwpIHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHJlc3BvbnNlSFRNTCk7XG4gICAgICBpZiAoZmV0Y2hSZXNwb25zZS5zZXJ2ZXJFcnJvcikge1xuICAgICAgICBhd2FpdCB0aGlzLnZpZXcucmVuZGVyRXJyb3Ioc25hcHNob3QsIHRoaXMuY3VycmVudFZpc2l0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJQYWdlKHNuYXBzaG90LCBmYWxzZSwgdHJ1ZSwgdGhpcy5jdXJyZW50VmlzaXQpO1xuICAgICAgfVxuICAgICAgaWYoIXNuYXBzaG90LnNob3VsZFByZXNlcnZlU2Nyb2xsUG9zaXRpb24pIHtcbiAgICAgICAgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9XG4gICAgICB0aGlzLnZpZXcuY2xlYXJTbmFwc2hvdENhY2hlKCk7XG4gICAgfVxuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25FcnJvcmVkKGZvcm1TdWJtaXNzaW9uLCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GaW5pc2hlZChmb3JtU3VibWlzc2lvbikge1xuICAgIC8vIE5vdCBhbGwgYWRhcHRlcnMgaW1wbGVtZW50IGZvcm1TdWJtaXNzaW9uRmluaXNoZWRcbiAgICBpZiAodHlwZW9mIHRoaXMuYWRhcHRlci5mb3JtU3VibWlzc2lvbkZpbmlzaGVkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuYWRhcHRlci5mb3JtU3VibWlzc2lvbkZpbmlzaGVkKGZvcm1TdWJtaXNzaW9uKTtcbiAgICB9XG4gIH1cblxuICAvLyBWaXNpdCBkZWxlZ2F0ZVxuXG4gIHZpc2l0U3RhcnRlZCh2aXNpdCkge1xuICAgIHRoaXMuZGVsZWdhdGUudmlzaXRTdGFydGVkKHZpc2l0KTtcbiAgfVxuXG4gIHZpc2l0Q29tcGxldGVkKHZpc2l0KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS52aXNpdENvbXBsZXRlZCh2aXNpdCk7XG4gICAgZGVsZXRlIHRoaXMuY3VycmVudFZpc2l0O1xuICB9XG5cbiAgbG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZShsb2NhdGlvbiwgYWN0aW9uKSB7XG4gICAgY29uc3QgYW5jaG9yID0gZ2V0QW5jaG9yKGxvY2F0aW9uKTtcbiAgICBjb25zdCBjdXJyZW50QW5jaG9yID0gZ2V0QW5jaG9yKHRoaXMudmlldy5sYXN0UmVuZGVyZWRMb2NhdGlvbik7XG4gICAgY29uc3QgaXNSZXN0b3JhdGlvblRvVG9wID0gYWN0aW9uID09PSBcInJlc3RvcmVcIiAmJiB0eXBlb2YgYW5jaG9yID09PSBcInVuZGVmaW5lZFwiO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIGFjdGlvbiAhPT0gXCJyZXBsYWNlXCIgJiZcbiAgICAgIGdldFJlcXVlc3RVUkwobG9jYXRpb24pID09PSBnZXRSZXF1ZXN0VVJMKHRoaXMudmlldy5sYXN0UmVuZGVyZWRMb2NhdGlvbikgJiZcbiAgICAgIChpc1Jlc3RvcmF0aW9uVG9Ub3AgfHwgKGFuY2hvciAhPSBudWxsICYmIGFuY2hvciAhPT0gY3VycmVudEFuY2hvcikpXG4gICAgKVxuICB9XG5cbiAgdmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbihvbGRVUkwsIG5ld1VSTCkge1xuICAgIHRoaXMuZGVsZWdhdGUudmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbihvbGRVUkwsIG5ld1VSTCk7XG4gIH1cblxuICAvLyBWaXNpdHNcblxuICBnZXQgbG9jYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5sb2NhdGlvblxuICB9XG5cbiAgZ2V0IHJlc3RvcmF0aW9uSWRlbnRpZmllcigpIHtcbiAgICByZXR1cm4gdGhpcy5oaXN0b3J5LnJlc3RvcmF0aW9uSWRlbnRpZmllclxuICB9XG5cbiAgI2dldEFjdGlvbkZvckZvcm1TdWJtaXNzaW9uKGZvcm1TdWJtaXNzaW9uLCBmZXRjaFJlc3BvbnNlKSB7XG4gICAgY29uc3QgeyBzdWJtaXR0ZXIsIGZvcm1FbGVtZW50IH0gPSBmb3JtU3VibWlzc2lvbjtcbiAgICByZXR1cm4gZ2V0VmlzaXRBY3Rpb24oc3VibWl0dGVyLCBmb3JtRWxlbWVudCkgfHwgdGhpcy4jZ2V0RGVmYXVsdEFjdGlvbihmZXRjaFJlc3BvbnNlKVxuICB9XG5cbiAgI2dldERlZmF1bHRBY3Rpb24oZmV0Y2hSZXNwb25zZSkge1xuICAgIGNvbnN0IHNhbWVMb2NhdGlvblJlZGlyZWN0ID0gZmV0Y2hSZXNwb25zZS5yZWRpcmVjdGVkICYmIGZldGNoUmVzcG9uc2UubG9jYXRpb24uaHJlZiA9PT0gdGhpcy5sb2NhdGlvbj8uaHJlZjtcbiAgICByZXR1cm4gc2FtZUxvY2F0aW9uUmVkaXJlY3QgPyBcInJlcGxhY2VcIiA6IFwiYWR2YW5jZVwiXG4gIH1cbn1cblxuY29uc3QgUGFnZVN0YWdlID0ge1xuICBpbml0aWFsOiAwLFxuICBsb2FkaW5nOiAxLFxuICBpbnRlcmFjdGl2ZTogMixcbiAgY29tcGxldGU6IDNcbn07XG5cbmNsYXNzIFBhZ2VPYnNlcnZlciB7XG4gIHN0YWdlID0gUGFnZVN0YWdlLmluaXRpYWxcbiAgc3RhcnRlZCA9IGZhbHNlXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgaWYgKHRoaXMuc3RhZ2UgPT0gUGFnZVN0YWdlLmluaXRpYWwpIHtcbiAgICAgICAgdGhpcy5zdGFnZSA9IFBhZ2VTdGFnZS5sb2FkaW5nO1xuICAgICAgfVxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5c3RhdGVjaGFuZ2VcIiwgdGhpcy5pbnRlcnByZXRSZWFkeVN0YXRlLCBmYWxzZSk7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5wYWdlV2lsbFVubG9hZCwgZmFsc2UpO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZWFkeXN0YXRlY2hhbmdlXCIsIHRoaXMuaW50ZXJwcmV0UmVhZHlTdGF0ZSwgZmFsc2UpO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsIHRoaXMucGFnZVdpbGxVbmxvYWQsIGZhbHNlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGludGVycHJldFJlYWR5U3RhdGUgPSAoKSA9PiB7XG4gICAgY29uc3QgeyByZWFkeVN0YXRlIH0gPSB0aGlzO1xuICAgIGlmIChyZWFkeVN0YXRlID09IFwiaW50ZXJhY3RpdmVcIikge1xuICAgICAgdGhpcy5wYWdlSXNJbnRlcmFjdGl2ZSgpO1xuICAgIH0gZWxzZSBpZiAocmVhZHlTdGF0ZSA9PSBcImNvbXBsZXRlXCIpIHtcbiAgICAgIHRoaXMucGFnZUlzQ29tcGxldGUoKTtcbiAgICB9XG4gIH1cblxuICBwYWdlSXNJbnRlcmFjdGl2ZSgpIHtcbiAgICBpZiAodGhpcy5zdGFnZSA9PSBQYWdlU3RhZ2UubG9hZGluZykge1xuICAgICAgdGhpcy5zdGFnZSA9IFBhZ2VTdGFnZS5pbnRlcmFjdGl2ZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUucGFnZUJlY2FtZUludGVyYWN0aXZlKCk7XG4gICAgfVxuICB9XG5cbiAgcGFnZUlzQ29tcGxldGUoKSB7XG4gICAgdGhpcy5wYWdlSXNJbnRlcmFjdGl2ZSgpO1xuICAgIGlmICh0aGlzLnN0YWdlID09IFBhZ2VTdGFnZS5pbnRlcmFjdGl2ZSkge1xuICAgICAgdGhpcy5zdGFnZSA9IFBhZ2VTdGFnZS5jb21wbGV0ZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUucGFnZUxvYWRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIHBhZ2VXaWxsVW5sb2FkID0gKCkgPT4ge1xuICAgIHRoaXMuZGVsZWdhdGUucGFnZVdpbGxVbmxvYWQoKTtcbiAgfVxuXG4gIGdldCByZWFkeVN0YXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5yZWFkeVN0YXRlXG4gIH1cbn1cblxuY2xhc3MgU2Nyb2xsT2JzZXJ2ZXIge1xuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIHRoaXMub25TY3JvbGwsIGZhbHNlKTtcbiAgICAgIHRoaXMub25TY3JvbGwoKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIHRoaXMub25TY3JvbGwsIGZhbHNlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIG9uU2Nyb2xsID0gKCkgPT4ge1xuICAgIHRoaXMudXBkYXRlUG9zaXRpb24oeyB4OiB3aW5kb3cucGFnZVhPZmZzZXQsIHk6IHdpbmRvdy5wYWdlWU9mZnNldCB9KTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICB1cGRhdGVQb3NpdGlvbihwb3NpdGlvbikge1xuICAgIHRoaXMuZGVsZWdhdGUuc2Nyb2xsUG9zaXRpb25DaGFuZ2VkKHBvc2l0aW9uKTtcbiAgfVxufVxuXG5jbGFzcyBTdHJlYW1NZXNzYWdlUmVuZGVyZXIge1xuICByZW5kZXIoeyBmcmFnbWVudCB9KSB7XG4gICAgQmFyZG8ucHJlc2VydmluZ1Blcm1hbmVudEVsZW1lbnRzKHRoaXMsIGdldFBlcm1hbmVudEVsZW1lbnRNYXBGb3JGcmFnbWVudChmcmFnbWVudCksICgpID0+IHtcbiAgICAgIHdpdGhBdXRvZm9jdXNGcm9tRnJhZ21lbnQoZnJhZ21lbnQsICgpID0+IHtcbiAgICAgICAgd2l0aFByZXNlcnZlZEZvY3VzKCgpID0+IHtcbiAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gQmFyZG8gZGVsZWdhdGVcblxuICBlbnRlcmluZ0JhcmRvKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LCBuZXdQZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgbmV3UGVybWFuZW50RWxlbWVudC5yZXBsYWNlV2l0aChjdXJyZW50UGVybWFuZW50RWxlbWVudC5jbG9uZU5vZGUodHJ1ZSkpO1xuICB9XG5cbiAgbGVhdmluZ0JhcmRvKCkge31cbn1cblxuZnVuY3Rpb24gZ2V0UGVybWFuZW50RWxlbWVudE1hcEZvckZyYWdtZW50KGZyYWdtZW50KSB7XG4gIGNvbnN0IHBlcm1hbmVudEVsZW1lbnRzSW5Eb2N1bWVudCA9IHF1ZXJ5UGVybWFuZW50RWxlbWVudHNBbGwoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTtcbiAgY29uc3QgcGVybWFuZW50RWxlbWVudE1hcCA9IHt9O1xuICBmb3IgKGNvbnN0IHBlcm1hbmVudEVsZW1lbnRJbkRvY3VtZW50IG9mIHBlcm1hbmVudEVsZW1lbnRzSW5Eb2N1bWVudCkge1xuICAgIGNvbnN0IHsgaWQgfSA9IHBlcm1hbmVudEVsZW1lbnRJbkRvY3VtZW50O1xuXG4gICAgZm9yIChjb25zdCBzdHJlYW1FbGVtZW50IG9mIGZyYWdtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0dXJiby1zdHJlYW1cIikpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnRJblN0cmVhbSA9IGdldFBlcm1hbmVudEVsZW1lbnRCeUlkKHN0cmVhbUVsZW1lbnQudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsIGlkKTtcblxuICAgICAgaWYgKGVsZW1lbnRJblN0cmVhbSkge1xuICAgICAgICBwZXJtYW5lbnRFbGVtZW50TWFwW2lkXSA9IFtwZXJtYW5lbnRFbGVtZW50SW5Eb2N1bWVudCwgZWxlbWVudEluU3RyZWFtXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGVybWFuZW50RWxlbWVudE1hcFxufVxuXG5hc3luYyBmdW5jdGlvbiB3aXRoQXV0b2ZvY3VzRnJvbUZyYWdtZW50KGZyYWdtZW50LCBjYWxsYmFjaykge1xuICBjb25zdCBnZW5lcmF0ZWRJRCA9IGB0dXJiby1zdHJlYW0tYXV0b2ZvY3VzLSR7dXVpZCgpfWA7XG4gIGNvbnN0IHR1cmJvU3RyZWFtcyA9IGZyYWdtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0dXJiby1zdHJlYW1cIik7XG4gIGNvbnN0IGVsZW1lbnRXaXRoQXV0b2ZvY3VzID0gZmlyc3RBdXRvZm9jdXNhYmxlRWxlbWVudEluU3RyZWFtcyh0dXJib1N0cmVhbXMpO1xuICBsZXQgd2lsbEF1dG9mb2N1c0lkID0gbnVsbDtcblxuICBpZiAoZWxlbWVudFdpdGhBdXRvZm9jdXMpIHtcbiAgICBpZiAoZWxlbWVudFdpdGhBdXRvZm9jdXMuaWQpIHtcbiAgICAgIHdpbGxBdXRvZm9jdXNJZCA9IGVsZW1lbnRXaXRoQXV0b2ZvY3VzLmlkO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aWxsQXV0b2ZvY3VzSWQgPSBnZW5lcmF0ZWRJRDtcbiAgICB9XG5cbiAgICBlbGVtZW50V2l0aEF1dG9mb2N1cy5pZCA9IHdpbGxBdXRvZm9jdXNJZDtcbiAgfVxuXG4gIGNhbGxiYWNrKCk7XG4gIGF3YWl0IG5leHRSZXBhaW50KCk7XG5cbiAgY29uc3QgaGFzTm9BY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PSBudWxsIHx8IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT0gZG9jdW1lbnQuYm9keTtcblxuICBpZiAoaGFzTm9BY3RpdmVFbGVtZW50ICYmIHdpbGxBdXRvZm9jdXNJZCkge1xuICAgIGNvbnN0IGVsZW1lbnRUb0F1dG9mb2N1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHdpbGxBdXRvZm9jdXNJZCk7XG5cbiAgICBpZiAoZWxlbWVudElzRm9jdXNhYmxlKGVsZW1lbnRUb0F1dG9mb2N1cykpIHtcbiAgICAgIGVsZW1lbnRUb0F1dG9mb2N1cy5mb2N1cygpO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudFRvQXV0b2ZvY3VzICYmIGVsZW1lbnRUb0F1dG9mb2N1cy5pZCA9PSBnZW5lcmF0ZWRJRCkge1xuICAgICAgZWxlbWVudFRvQXV0b2ZvY3VzLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xuICAgIH1cbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB3aXRoUHJlc2VydmVkRm9jdXMoY2FsbGJhY2spIHtcbiAgY29uc3QgW2FjdGl2ZUVsZW1lbnRCZWZvcmVSZW5kZXIsIGFjdGl2ZUVsZW1lbnRBZnRlclJlbmRlcl0gPSBhd2FpdCBhcm91bmQoY2FsbGJhY2ssICgpID0+IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpO1xuXG4gIGNvbnN0IHJlc3RvcmVGb2N1c1RvID0gYWN0aXZlRWxlbWVudEJlZm9yZVJlbmRlciAmJiBhY3RpdmVFbGVtZW50QmVmb3JlUmVuZGVyLmlkO1xuXG4gIGlmIChyZXN0b3JlRm9jdXNUbykge1xuICAgIGNvbnN0IGVsZW1lbnRUb0ZvY3VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVzdG9yZUZvY3VzVG8pO1xuXG4gICAgaWYgKGVsZW1lbnRJc0ZvY3VzYWJsZShlbGVtZW50VG9Gb2N1cykgJiYgZWxlbWVudFRvRm9jdXMgIT0gYWN0aXZlRWxlbWVudEFmdGVyUmVuZGVyKSB7XG4gICAgICBlbGVtZW50VG9Gb2N1cy5mb2N1cygpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBmaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50SW5TdHJlYW1zKG5vZGVMaXN0T2ZTdHJlYW1FbGVtZW50cykge1xuICBmb3IgKGNvbnN0IHN0cmVhbUVsZW1lbnQgb2Ygbm9kZUxpc3RPZlN0cmVhbUVsZW1lbnRzKSB7XG4gICAgY29uc3QgZWxlbWVudFdpdGhBdXRvZm9jdXMgPSBxdWVyeUF1dG9mb2N1c2FibGVFbGVtZW50KHN0cmVhbUVsZW1lbnQudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQpO1xuXG4gICAgaWYgKGVsZW1lbnRXaXRoQXV0b2ZvY3VzKSByZXR1cm4gZWxlbWVudFdpdGhBdXRvZm9jdXNcbiAgfVxuXG4gIHJldHVybiBudWxsXG59XG5cbmNsYXNzIFN0cmVhbU9ic2VydmVyIHtcbiAgc291cmNlcyA9IG5ldyBTZXQoKVxuICAjc3RhcnRlZCA9IGZhbHNlXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuI3N0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuI3N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS1mZXRjaC1yZXNwb25zZVwiLCB0aGlzLmluc3BlY3RGZXRjaFJlc3BvbnNlLCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy4jc3RhcnRlZCkge1xuICAgICAgdGhpcy4jc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS1mZXRjaC1yZXNwb25zZVwiLCB0aGlzLmluc3BlY3RGZXRjaFJlc3BvbnNlLCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgICBpZiAoIXRoaXMuc3RyZWFtU291cmNlSXNDb25uZWN0ZWQoc291cmNlKSkge1xuICAgICAgdGhpcy5zb3VyY2VzLmFkZChzb3VyY2UpO1xuICAgICAgc291cmNlLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMucmVjZWl2ZU1lc3NhZ2VFdmVudCwgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuc3RyZWFtU291cmNlSXNDb25uZWN0ZWQoc291cmNlKSkge1xuICAgICAgdGhpcy5zb3VyY2VzLmRlbGV0ZShzb3VyY2UpO1xuICAgICAgc291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMucmVjZWl2ZU1lc3NhZ2VFdmVudCwgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIHN0cmVhbVNvdXJjZUlzQ29ubmVjdGVkKHNvdXJjZSkge1xuICAgIHJldHVybiB0aGlzLnNvdXJjZXMuaGFzKHNvdXJjZSlcbiAgfVxuXG4gIGluc3BlY3RGZXRjaFJlc3BvbnNlID0gKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBmZXRjaFJlc3BvbnNlRnJvbUV2ZW50KGV2ZW50KTtcbiAgICBpZiAocmVzcG9uc2UgJiYgZmV0Y2hSZXNwb25zZUlzU3RyZWFtKHJlc3BvbnNlKSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VSZXNwb25zZShyZXNwb25zZSk7XG4gICAgfVxuICB9XG5cbiAgcmVjZWl2ZU1lc3NhZ2VFdmVudCA9IChldmVudCkgPT4ge1xuICAgIGlmICh0aGlzLiNzdGFydGVkICYmIHR5cGVvZiBldmVudC5kYXRhID09IFwic3RyaW5nXCIpIHtcbiAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VIVE1MKGV2ZW50LmRhdGEpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlY2VpdmVNZXNzYWdlUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICBjb25zdCBodG1sID0gYXdhaXQgcmVzcG9uc2UucmVzcG9uc2VIVE1MO1xuICAgIGlmIChodG1sKSB7XG4gICAgICB0aGlzLnJlY2VpdmVNZXNzYWdlSFRNTChodG1sKTtcbiAgICB9XG4gIH1cblxuICByZWNlaXZlTWVzc2FnZUhUTUwoaHRtbCkge1xuICAgIHRoaXMuZGVsZWdhdGUucmVjZWl2ZWRNZXNzYWdlRnJvbVN0cmVhbShTdHJlYW1NZXNzYWdlLndyYXAoaHRtbCkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZldGNoUmVzcG9uc2VGcm9tRXZlbnQoZXZlbnQpIHtcbiAgY29uc3QgZmV0Y2hSZXNwb25zZSA9IGV2ZW50LmRldGFpbD8uZmV0Y2hSZXNwb25zZTtcbiAgaWYgKGZldGNoUmVzcG9uc2UgaW5zdGFuY2VvZiBGZXRjaFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIGZldGNoUmVzcG9uc2VcbiAgfVxufVxuXG5mdW5jdGlvbiBmZXRjaFJlc3BvbnNlSXNTdHJlYW0ocmVzcG9uc2UpIHtcbiAgY29uc3QgY29udGVudFR5cGUgPSByZXNwb25zZS5jb250ZW50VHlwZSA/PyBcIlwiO1xuICByZXR1cm4gY29udGVudFR5cGUuc3RhcnRzV2l0aChTdHJlYW1NZXNzYWdlLmNvbnRlbnRUeXBlKVxufVxuXG5jbGFzcyBFcnJvclJlbmRlcmVyIGV4dGVuZHMgUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIGNvbnN0IHsgZG9jdW1lbnRFbGVtZW50LCBib2R5IH0gPSBkb2N1bWVudDtcblxuICAgIGRvY3VtZW50RWxlbWVudC5yZXBsYWNlQ2hpbGQobmV3RWxlbWVudCwgYm9keSk7XG4gIH1cblxuICBhc3luYyByZW5kZXIoKSB7XG4gICAgdGhpcy5yZXBsYWNlSGVhZEFuZEJvZHkoKTtcbiAgICB0aGlzLmFjdGl2YXRlU2NyaXB0RWxlbWVudHMoKTtcbiAgfVxuXG4gIHJlcGxhY2VIZWFkQW5kQm9keSgpIHtcbiAgICBjb25zdCB7IGRvY3VtZW50RWxlbWVudCwgaGVhZCB9ID0gZG9jdW1lbnQ7XG4gICAgZG9jdW1lbnRFbGVtZW50LnJlcGxhY2VDaGlsZCh0aGlzLm5ld0hlYWQsIGhlYWQpO1xuICAgIHRoaXMucmVuZGVyRWxlbWVudCh0aGlzLmN1cnJlbnRFbGVtZW50LCB0aGlzLm5ld0VsZW1lbnQpO1xuICB9XG5cbiAgYWN0aXZhdGVTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IHJlcGxhY2VhYmxlRWxlbWVudCBvZiB0aGlzLnNjcmlwdEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCBwYXJlbnROb2RlID0gcmVwbGFjZWFibGVFbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICBpZiAocGFyZW50Tm9kZSkge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gYWN0aXZhdGVTY3JpcHRFbGVtZW50KHJlcGxhY2VhYmxlRWxlbWVudCk7XG4gICAgICAgIHBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGVsZW1lbnQsIHJlcGxhY2VhYmxlRWxlbWVudCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0IG5ld0hlYWQoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3U25hcHNob3QuaGVhZFNuYXBzaG90LmVsZW1lbnRcbiAgfVxuXG4gIGdldCBzY3JpcHRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIilcbiAgfVxufVxuXG4vLyBiYXNlIElJRkUgdG8gZGVmaW5lIGlkaW9tb3JwaFxudmFyIElkaW9tb3JwaCA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBBTkQgTk9XIElUIEJFR0lOUy4uLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGxldCBFTVBUWV9TRVQgPSBuZXcgU2V0KCk7XG5cbiAgICAgICAgLy8gZGVmYXVsdCBjb25maWd1cmF0aW9uIHZhbHVlcywgdXBkYXRhYmxlIGJ5IHVzZXJzIG5vd1xuICAgICAgICBsZXQgZGVmYXVsdHMgPSB7XG4gICAgICAgICAgICBtb3JwaFN0eWxlOiBcIm91dGVySFRNTFwiLFxuICAgICAgICAgICAgY2FsbGJhY2tzIDoge1xuICAgICAgICAgICAgICAgIGJlZm9yZU5vZGVBZGRlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBhZnRlck5vZGVBZGRlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBiZWZvcmVOb2RlTW9ycGhlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBhZnRlck5vZGVNb3JwaGVkOiBub09wLFxuICAgICAgICAgICAgICAgIGJlZm9yZU5vZGVSZW1vdmVkOiBub09wLFxuICAgICAgICAgICAgICAgIGFmdGVyTm9kZVJlbW92ZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYmVmb3JlQXR0cmlidXRlVXBkYXRlZDogbm9PcCxcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhlYWQ6IHtcbiAgICAgICAgICAgICAgICBzdHlsZTogJ21lcmdlJyxcbiAgICAgICAgICAgICAgICBzaG91bGRQcmVzZXJ2ZTogZnVuY3Rpb24gKGVsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWx0LmdldEF0dHJpYnV0ZShcImltLXByZXNlcnZlXCIpID09PSBcInRydWVcIjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNob3VsZFJlQXBwZW5kOiBmdW5jdGlvbiAoZWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbHQuZ2V0QXR0cmlidXRlKFwiaW0tcmUtYXBwZW5kXCIpID09PSBcInRydWVcIjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNob3VsZFJlbW92ZTogbm9PcCxcbiAgICAgICAgICAgICAgICBhZnRlckhlYWRNb3JwaGVkOiBub09wLFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gQ29yZSBNb3JwaGluZyBBbGdvcml0aG0gLSBtb3JwaCwgbW9ycGhOb3JtYWxpemVkQ29udGVudCwgbW9ycGhPbGROb2RlVG8sIG1vcnBoQ2hpbGRyZW5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBtb3JwaChvbGROb2RlLCBuZXdDb250ZW50LCBjb25maWcgPSB7fSkge1xuXG4gICAgICAgICAgICBpZiAob2xkTm9kZSBpbnN0YW5jZW9mIERvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgb2xkTm9kZSA9IG9sZE5vZGUuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudCA9IHBhcnNlQ29udGVudChuZXdDb250ZW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IG5vcm1hbGl6ZWRDb250ZW50ID0gbm9ybWFsaXplQ29udGVudChuZXdDb250ZW50KTtcblxuICAgICAgICAgICAgbGV0IGN0eCA9IGNyZWF0ZU1vcnBoQ29udGV4dChvbGROb2RlLCBub3JtYWxpemVkQ29udGVudCwgY29uZmlnKTtcblxuICAgICAgICAgICAgcmV0dXJuIG1vcnBoTm9ybWFsaXplZENvbnRlbnQob2xkTm9kZSwgbm9ybWFsaXplZENvbnRlbnQsIGN0eCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBtb3JwaE5vcm1hbGl6ZWRDb250ZW50KG9sZE5vZGUsIG5vcm1hbGl6ZWROZXdDb250ZW50LCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChjdHguaGVhZC5ibG9jaykge1xuICAgICAgICAgICAgICAgIGxldCBvbGRIZWFkID0gb2xkTm9kZS5xdWVyeVNlbGVjdG9yKCdoZWFkJyk7XG4gICAgICAgICAgICAgICAgbGV0IG5ld0hlYWQgPSBub3JtYWxpemVkTmV3Q29udGVudC5xdWVyeVNlbGVjdG9yKCdoZWFkJyk7XG4gICAgICAgICAgICAgICAgaWYgKG9sZEhlYWQgJiYgbmV3SGVhZCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgcHJvbWlzZXMgPSBoYW5kbGVIZWFkRWxlbWVudChuZXdIZWFkLCBvbGRIZWFkLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIGhlYWQgcHJvbWlzZXMgcmVzb2x2ZSwgY2FsbCBtb3JwaCBhZ2FpbiwgaWdub3JpbmcgdGhlIGhlYWQgdGFnXG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vcnBoTm9ybWFsaXplZENvbnRlbnQob2xkTm9kZSwgbm9ybWFsaXplZE5ld0NvbnRlbnQsIE9iamVjdC5hc3NpZ24oY3R4LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jazogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdHgubW9ycGhTdHlsZSA9PT0gXCJpbm5lckhUTUxcIikge1xuXG4gICAgICAgICAgICAgICAgLy8gaW5uZXJIVE1MLCBzbyB3ZSBhcmUgb25seSB1cGRhdGluZyB0aGUgY2hpbGRyZW5cbiAgICAgICAgICAgICAgICBtb3JwaENoaWxkcmVuKG5vcm1hbGl6ZWROZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBvbGROb2RlLmNoaWxkcmVuO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGN0eC5tb3JwaFN0eWxlID09PSBcIm91dGVySFRNTFwiIHx8IGN0eC5tb3JwaFN0eWxlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgZmluZCB0aGUgYmVzdCBlbGVtZW50IG1hdGNoIGluIHRoZSBuZXcgY29udGVudCwgbW9ycGggdGhhdCwgYW5kIG1lcmdlIGl0cyBzaWJsaW5nc1xuICAgICAgICAgICAgICAgIC8vIGludG8gZWl0aGVyIHNpZGUgb2YgdGhlIGJlc3QgbWF0Y2hcbiAgICAgICAgICAgICAgICBsZXQgYmVzdE1hdGNoID0gZmluZEJlc3ROb2RlTWF0Y2gobm9ybWFsaXplZE5ld0NvbnRlbnQsIG9sZE5vZGUsIGN0eCk7XG5cbiAgICAgICAgICAgICAgICAvLyBzdGFzaCB0aGUgc2libGluZ3MgdGhhdCB3aWxsIG5lZWQgdG8gYmUgaW5zZXJ0ZWQgb24gZWl0aGVyIHNpZGUgb2YgdGhlIGJlc3QgbWF0Y2hcbiAgICAgICAgICAgICAgICBsZXQgcHJldmlvdXNTaWJsaW5nID0gYmVzdE1hdGNoPy5wcmV2aW91c1NpYmxpbmc7XG4gICAgICAgICAgICAgICAgbGV0IG5leHRTaWJsaW5nID0gYmVzdE1hdGNoPy5uZXh0U2libGluZztcblxuICAgICAgICAgICAgICAgIC8vIG1vcnBoIGl0XG4gICAgICAgICAgICAgICAgbGV0IG1vcnBoZWROb2RlID0gbW9ycGhPbGROb2RlVG8ob2xkTm9kZSwgYmVzdE1hdGNoLCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGJlc3RNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSB3YXMgYSBiZXN0IG1hdGNoLCBtZXJnZSB0aGUgc2libGluZ3MgaW4gdG9vIGFuZCByZXR1cm4gdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIHdob2xlIGJ1bmNoXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnNlcnRTaWJsaW5ncyhwcmV2aW91c1NpYmxpbmcsIG1vcnBoZWROb2RlLCBuZXh0U2libGluZyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIG5vdGhpbmcgd2FzIGFkZGVkIHRvIHRoZSBET01cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBcIkRvIG5vdCB1bmRlcnN0YW5kIGhvdyB0byBtb3JwaCBzdHlsZSBcIiArIGN0eC5tb3JwaFN0eWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIHBvc3NpYmxlQWN0aXZlRWxlbWVudFxuICAgICAgICAgKiBAcGFyYW0gY3R4XG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gaWdub3JlVmFsdWVPZkFjdGl2ZUVsZW1lbnQocG9zc2libGVBY3RpdmVFbGVtZW50LCBjdHgpIHtcbiAgICAgICAgICAgIHJldHVybiBjdHguaWdub3JlQWN0aXZlVmFsdWUgJiYgcG9zc2libGVBY3RpdmVFbGVtZW50ID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIHBvc3NpYmxlQWN0aXZlRWxlbWVudCAhPT0gZG9jdW1lbnQuYm9keTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gb2xkTm9kZSByb290IG5vZGUgdG8gbWVyZ2UgY29udGVudCBpbnRvXG4gICAgICAgICAqIEBwYXJhbSBuZXdDb250ZW50IG5ldyBjb250ZW50IHRvIG1lcmdlXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICogQHJldHVybnMge0VsZW1lbnR9IHRoZSBlbGVtZW50IHRoYXQgZW5kZWQgdXAgaW4gdGhlIERPTVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbW9ycGhPbGROb2RlVG8ob2xkTm9kZSwgbmV3Q29udGVudCwgY3R4KSB7XG4gICAgICAgICAgICBpZiAoY3R4Lmlnbm9yZUFjdGl2ZSAmJiBvbGROb2RlID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50KSA7IGVsc2UgaWYgKG5ld0NvbnRlbnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVSZW1vdmVkKG9sZE5vZGUpID09PSBmYWxzZSkgcmV0dXJuIG9sZE5vZGU7XG5cbiAgICAgICAgICAgICAgICBvbGROb2RlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlUmVtb3ZlZChvbGROb2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlzU29mdE1hdGNoKG9sZE5vZGUsIG5ld0NvbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZVJlbW92ZWQob2xkTm9kZSkgPT09IGZhbHNlKSByZXR1cm4gb2xkTm9kZTtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlQWRkZWQobmV3Q29udGVudCkgPT09IGZhbHNlKSByZXR1cm4gb2xkTm9kZTtcblxuICAgICAgICAgICAgICAgIG9sZE5vZGUucGFyZW50RWxlbWVudC5yZXBsYWNlQ2hpbGQobmV3Q29udGVudCwgb2xkTm9kZSk7XG4gICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVBZGRlZChuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICBjdHguY2FsbGJhY2tzLmFmdGVyTm9kZVJlbW92ZWQob2xkTm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld0NvbnRlbnQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVNb3JwaGVkKG9sZE5vZGUsIG5ld0NvbnRlbnQpID09PSBmYWxzZSkgcmV0dXJuIG9sZE5vZGU7XG5cbiAgICAgICAgICAgICAgICBpZiAob2xkTm9kZSBpbnN0YW5jZW9mIEhUTUxIZWFkRWxlbWVudCAmJiBjdHguaGVhZC5pZ25vcmUpIDsgZWxzZSBpZiAob2xkTm9kZSBpbnN0YW5jZW9mIEhUTUxIZWFkRWxlbWVudCAmJiBjdHguaGVhZC5zdHlsZSAhPT0gXCJtb3JwaFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUhlYWRFbGVtZW50KG5ld0NvbnRlbnQsIG9sZE5vZGUsIGN0eCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3luY05vZGVGcm9tKG5ld0NvbnRlbnQsIG9sZE5vZGUsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaWdub3JlVmFsdWVPZkFjdGl2ZUVsZW1lbnQob2xkTm9kZSwgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9ycGhDaGlsZHJlbihuZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlTW9ycGhlZChvbGROb2RlLCBuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2xkTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIGlzIHRoZSBjb3JlIGFsZ29yaXRobSBmb3IgbWF0Y2hpbmcgdXAgY2hpbGRyZW4uICBUaGUgaWRlYSBpcyB0byB1c2UgaWQgc2V0cyB0byB0cnkgdG8gbWF0Y2ggdXBcbiAgICAgICAgICogbm9kZXMgYXMgZmFpdGhmdWxseSBhcyBwb3NzaWJsZS4gIFdlIGdyZWVkaWx5IG1hdGNoLCB3aGljaCBhbGxvd3MgdXMgdG8ga2VlcCB0aGUgYWxnb3JpdGhtIGZhc3QsIGJ1dFxuICAgICAgICAgKiBieSB1c2luZyBpZCBzZXRzLCB3ZSBhcmUgYWJsZSB0byBiZXR0ZXIgbWF0Y2ggdXAgd2l0aCBjb250ZW50IGRlZXBlciBpbiB0aGUgRE9NLlxuICAgICAgICAgKlxuICAgICAgICAgKiBCYXNpYyBhbGdvcml0aG0gaXMsIGZvciBlYWNoIG5vZGUgaW4gdGhlIG5ldyBjb250ZW50OlxuICAgICAgICAgKlxuICAgICAgICAgKiAtIGlmIHdlIGhhdmUgcmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBvbGQgcGFyZW50LCBhcHBlbmQgdGhlIG5ldyBjb250ZW50XG4gICAgICAgICAqIC0gaWYgdGhlIG5ldyBjb250ZW50IGhhcyBhbiBpZCBzZXQgbWF0Y2ggd2l0aCB0aGUgY3VycmVudCBpbnNlcnRpb24gcG9pbnQsIG1vcnBoXG4gICAgICAgICAqIC0gc2VhcmNoIGZvciBhbiBpZCBzZXQgbWF0Y2hcbiAgICAgICAgICogLSBpZiBpZCBzZXQgbWF0Y2ggZm91bmQsIG1vcnBoXG4gICAgICAgICAqIC0gb3RoZXJ3aXNlIHNlYXJjaCBmb3IgYSBcInNvZnRcIiBtYXRjaFxuICAgICAgICAgKiAtIGlmIGEgc29mdCBtYXRjaCBpcyBmb3VuZCwgbW9ycGhcbiAgICAgICAgICogLSBvdGhlcndpc2UsIHByZXBlbmQgdGhlIG5ldyBub2RlIGJlZm9yZSB0aGUgY3VycmVudCBpbnNlcnRpb24gcG9pbnRcbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIHR3byBzZWFyY2ggYWxnb3JpdGhtcyB0ZXJtaW5hdGUgaWYgY29tcGV0aW5nIG5vZGUgbWF0Y2hlcyBhcHBlYXIgdG8gb3V0d2VpZ2ggd2hhdCBjYW4gYmUgYWNoaWV2ZWRcbiAgICAgICAgICogd2l0aCB0aGUgY3VycmVudCBub2RlLiAgU2VlIGZpbmRJZFNldE1hdGNoKCkgYW5kIGZpbmRTb2Z0TWF0Y2goKSBmb3IgZGV0YWlscy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBuZXdQYXJlbnQgdGhlIHBhcmVudCBlbGVtZW50IG9mIHRoZSBuZXcgY29udGVudFxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfSBvbGRQYXJlbnQgdGhlIG9sZCBjb250ZW50IHRoYXQgd2UgYXJlIG1lcmdpbmcgdGhlIG5ldyBjb250ZW50IGludG9cbiAgICAgICAgICogQHBhcmFtIGN0eCB0aGUgbWVyZ2UgY29udGV4dFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbW9ycGhDaGlsZHJlbihuZXdQYXJlbnQsIG9sZFBhcmVudCwgY3R4KSB7XG5cbiAgICAgICAgICAgIGxldCBuZXh0TmV3Q2hpbGQgPSBuZXdQYXJlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIGxldCBpbnNlcnRpb25Qb2ludCA9IG9sZFBhcmVudC5maXJzdENoaWxkO1xuICAgICAgICAgICAgbGV0IG5ld0NoaWxkO1xuXG4gICAgICAgICAgICAvLyBydW4gdGhyb3VnaCBhbGwgdGhlIG5ldyBjb250ZW50XG4gICAgICAgICAgICB3aGlsZSAobmV4dE5ld0NoaWxkKSB7XG5cbiAgICAgICAgICAgICAgICBuZXdDaGlsZCA9IG5leHROZXdDaGlsZDtcbiAgICAgICAgICAgICAgICBuZXh0TmV3Q2hpbGQgPSBuZXdDaGlsZC5uZXh0U2libGluZztcblxuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGFyZSBhdCB0aGUgZW5kIG9mIHRoZSBleGl0aW5nIHBhcmVudCdzIGNoaWxkcmVuLCBqdXN0IGFwcGVuZFxuICAgICAgICAgICAgICAgIGlmIChpbnNlcnRpb25Qb2ludCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVBZGRlZChuZXdDaGlsZCkgPT09IGZhbHNlKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgb2xkUGFyZW50LmFwcGVuZENoaWxkKG5ld0NoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVBZGRlZChuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgY3VycmVudCBub2RlIGhhcyBhbiBpZCBzZXQgbWF0Y2ggdGhlbiBtb3JwaFxuICAgICAgICAgICAgICAgIGlmIChpc0lkU2V0TWF0Y2gobmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vcnBoT2xkTm9kZVRvKGluc2VydGlvblBvaW50LCBuZXdDaGlsZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0aW9uUG9pbnQgPSBpbnNlcnRpb25Qb2ludC5uZXh0U2libGluZztcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCBuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBzZWFyY2ggZm9yd2FyZCBpbiB0aGUgZXhpc3Rpbmcgb2xkIGNoaWxkcmVuIGZvciBhbiBpZCBzZXQgbWF0Y2hcbiAgICAgICAgICAgICAgICBsZXQgaWRTZXRNYXRjaCA9IGZpbmRJZFNldE1hdGNoKG5ld1BhcmVudCwgb2xkUGFyZW50LCBuZXdDaGlsZCwgaW5zZXJ0aW9uUG9pbnQsIGN0eCk7XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBmb3VuZCBhIHBvdGVudGlhbCBtYXRjaCwgcmVtb3ZlIHRoZSBub2RlcyB1bnRpbCB0aGF0IHBvaW50IGFuZCBtb3JwaFxuICAgICAgICAgICAgICAgIGlmIChpZFNldE1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydGlvblBvaW50ID0gcmVtb3ZlTm9kZXNCZXR3ZWVuKGluc2VydGlvblBvaW50LCBpZFNldE1hdGNoLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICBtb3JwaE9sZE5vZGVUbyhpZFNldE1hdGNoLCBuZXdDaGlsZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCBuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIG5vIGlkIHNldCBtYXRjaCBmb3VuZCwgc28gc2NhbiBmb3J3YXJkIGZvciBhIHNvZnQgbWF0Y2ggZm9yIHRoZSBjdXJyZW50IG5vZGVcbiAgICAgICAgICAgICAgICBsZXQgc29mdE1hdGNoID0gZmluZFNvZnRNYXRjaChuZXdQYXJlbnQsIG9sZFBhcmVudCwgbmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgZm91bmQgYSBzb2Z0IG1hdGNoIGZvciB0aGUgY3VycmVudCBub2RlLCBtb3JwaFxuICAgICAgICAgICAgICAgIGlmIChzb2Z0TWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0aW9uUG9pbnQgPSByZW1vdmVOb2Rlc0JldHdlZW4oaW5zZXJ0aW9uUG9pbnQsIHNvZnRNYXRjaCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgbW9ycGhPbGROb2RlVG8oc29mdE1hdGNoLCBuZXdDaGlsZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCBuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGFiYW5kb24gYWxsIGhvcGUgb2YgbW9ycGhpbmcsIGp1c3QgaW5zZXJ0IHRoZSBuZXcgY2hpbGQgYmVmb3JlIHRoZSBpbnNlcnRpb24gcG9pbnRcbiAgICAgICAgICAgICAgICAvLyBhbmQgbW92ZSBvblxuICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVBZGRlZChuZXdDaGlsZCkgPT09IGZhbHNlKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBvbGRQYXJlbnQuaW5zZXJ0QmVmb3JlKG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCk7XG4gICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVBZGRlZChuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCBuZXdDaGlsZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgcmVtYWluaW5nIG9sZCBub2RlcyB0aGF0IGRpZG4ndCBtYXRjaCB1cCB3aXRoIG5ldyBjb250ZW50XG4gICAgICAgICAgICB3aGlsZSAoaW5zZXJ0aW9uUG9pbnQgIT09IG51bGwpIHtcblxuICAgICAgICAgICAgICAgIGxldCB0ZW1wTm9kZSA9IGluc2VydGlvblBvaW50O1xuICAgICAgICAgICAgICAgIGluc2VydGlvblBvaW50ID0gaW5zZXJ0aW9uUG9pbnQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgcmVtb3ZlTm9kZSh0ZW1wTm9kZSwgY3R4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gQXR0cmlidXRlIFN5bmNpbmcgQ29kZVxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSBhdHRyIHtTdHJpbmd9IHRoZSBhdHRyaWJ1dGUgdG8gYmUgbXV0YXRlZFxuICAgICAgICAgKiBAcGFyYW0gdG8ge0VsZW1lbnR9IHRoZSBlbGVtZW50IHRoYXQgaXMgZ29pbmcgdG8gYmUgdXBkYXRlZFxuICAgICAgICAgKiBAcGFyYW0gdXBkYXRlVHlwZSB7KFwidXBkYXRlXCJ8XCJyZW1vdmVcIil9XG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgdGhlIGF0dHJpYnV0ZSBzaG91bGQgYmUgaWdub3JlZCwgZmFsc2Ugb3RoZXJ3aXNlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpZ25vcmVBdHRyaWJ1dGUoYXR0ciwgdG8sIHVwZGF0ZVR5cGUsIGN0eCkge1xuICAgICAgICAgICAgaWYoYXR0ciA9PT0gJ3ZhbHVlJyAmJiBjdHguaWdub3JlQWN0aXZlVmFsdWUgJiYgdG8gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGN0eC5jYWxsYmFja3MuYmVmb3JlQXR0cmlidXRlVXBkYXRlZChhdHRyLCB0bywgdXBkYXRlVHlwZSkgPT09IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN5bmNzIGEgZ2l2ZW4gbm9kZSB3aXRoIGFub3RoZXIgbm9kZSwgY29weWluZyBvdmVyIGFsbCBhdHRyaWJ1dGVzIGFuZFxuICAgICAgICAgKiBpbm5lciBlbGVtZW50IHN0YXRlIGZyb20gdGhlICdmcm9tJyBub2RlIHRvIHRoZSAndG8nIG5vZGVcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSBmcm9tIHRoZSBlbGVtZW50IHRvIGNvcHkgYXR0cmlidXRlcyAmIHN0YXRlIGZyb21cbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fSB0byB0aGUgZWxlbWVudCB0byBjb3B5IGF0dHJpYnV0ZXMgJiBzdGF0ZSB0b1xuICAgICAgICAgKiBAcGFyYW0gY3R4IHRoZSBtZXJnZSBjb250ZXh0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzeW5jTm9kZUZyb20oZnJvbSwgdG8sIGN0eCkge1xuICAgICAgICAgICAgbGV0IHR5cGUgPSBmcm9tLm5vZGVUeXBlO1xuXG4gICAgICAgICAgICAvLyBpZiBpcyBhbiBlbGVtZW50IHR5cGUsIHN5bmMgdGhlIGF0dHJpYnV0ZXMgZnJvbSB0aGVcbiAgICAgICAgICAgIC8vIG5ldyBub2RlIGludG8gdGhlIG5ldyBub2RlXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gMSAvKiBlbGVtZW50IHR5cGUgKi8pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9tQXR0cmlidXRlcyA9IGZyb20uYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICBjb25zdCB0b0F0dHJpYnV0ZXMgPSB0by5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZnJvbUF0dHJpYnV0ZSBvZiBmcm9tQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWdub3JlQXR0cmlidXRlKGZyb21BdHRyaWJ1dGUubmFtZSwgdG8sICd1cGRhdGUnLCBjdHgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodG8uZ2V0QXR0cmlidXRlKGZyb21BdHRyaWJ1dGUubmFtZSkgIT09IGZyb21BdHRyaWJ1dGUudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldEF0dHJpYnV0ZShmcm9tQXR0cmlidXRlLm5hbWUsIGZyb21BdHRyaWJ1dGUudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGl0ZXJhdGUgYmFja3dhcmRzIHRvIGF2b2lkIHNraXBwaW5nIG92ZXIgaXRlbXMgd2hlbiBhIGRlbGV0ZSBvY2N1cnNcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gdG9BdHRyaWJ1dGVzLmxlbmd0aCAtIDE7IDAgPD0gaTsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvQXR0cmlidXRlID0gdG9BdHRyaWJ1dGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWdub3JlQXR0cmlidXRlKHRvQXR0cmlidXRlLm5hbWUsIHRvLCAncmVtb3ZlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmcm9tLmhhc0F0dHJpYnV0ZSh0b0F0dHJpYnV0ZS5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8ucmVtb3ZlQXR0cmlidXRlKHRvQXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzeW5jIHRleHQgbm9kZXNcbiAgICAgICAgICAgIGlmICh0eXBlID09PSA4IC8qIGNvbW1lbnQgKi8gfHwgdHlwZSA9PT0gMyAvKiB0ZXh0ICovKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRvLm5vZGVWYWx1ZSAhPT0gZnJvbS5ub2RlVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdG8ubm9kZVZhbHVlID0gZnJvbS5ub2RlVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWlnbm9yZVZhbHVlT2ZBY3RpdmVFbGVtZW50KHRvLCBjdHgpKSB7XG4gICAgICAgICAgICAgICAgLy8gc3luYyBpbnB1dCB2YWx1ZXNcbiAgICAgICAgICAgICAgICBzeW5jSW5wdXRWYWx1ZShmcm9tLCB0bywgY3R4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gZnJvbSB7RWxlbWVudH0gZWxlbWVudCB0byBzeW5jIHRoZSB2YWx1ZSBmcm9tXG4gICAgICAgICAqIEBwYXJhbSB0byB7RWxlbWVudH0gZWxlbWVudCB0byBzeW5jIHRoZSB2YWx1ZSB0b1xuICAgICAgICAgKiBAcGFyYW0gYXR0cmlidXRlTmFtZSB7U3RyaW5nfSB0aGUgYXR0cmlidXRlIG5hbWVcbiAgICAgICAgICogQHBhcmFtIGN0eCB0aGUgbWVyZ2UgY29udGV4dFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc3luY0Jvb2xlYW5BdHRyaWJ1dGUoZnJvbSwgdG8sIGF0dHJpYnV0ZU5hbWUsIGN0eCkge1xuICAgICAgICAgICAgaWYgKGZyb21bYXR0cmlidXRlTmFtZV0gIT09IHRvW2F0dHJpYnV0ZU5hbWVdKSB7XG4gICAgICAgICAgICAgICAgbGV0IGlnbm9yZVVwZGF0ZSA9IGlnbm9yZUF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCB0bywgJ3VwZGF0ZScsIGN0eCk7XG4gICAgICAgICAgICAgICAgaWYgKCFpZ25vcmVVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9bYXR0cmlidXRlTmFtZV0gPSBmcm9tW2F0dHJpYnV0ZU5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZnJvbVthdHRyaWJ1dGVOYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZVVwZGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIGZyb21bYXR0cmlidXRlTmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpZ25vcmVBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgdG8sICdyZW1vdmUnLCBjdHgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0by5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTkI6IG1hbnkgYm90aGFucyBkaWVkIHRvIGJyaW5nIHVzIGluZm9ybWF0aW9uOlxuICAgICAgICAgKlxuICAgICAgICAgKiAgaHR0cHM6Ly9naXRodWIuY29tL3BhdHJpY2stc3RlZWxlLWlkZW0vbW9ycGhkb20vYmxvYi9tYXN0ZXIvc3JjL3NwZWNpYWxFbEhhbmRsZXJzLmpzXG4gICAgICAgICAqICBodHRwczovL2dpdGh1Yi5jb20vY2hvb2pzL25hbm9tb3JwaC9ibG9iL21hc3Rlci9saWIvbW9ycGguanNMMTEzXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSBmcm9tIHtFbGVtZW50fSB0aGUgZWxlbWVudCB0byBzeW5jIHRoZSBpbnB1dCB2YWx1ZSBmcm9tXG4gICAgICAgICAqIEBwYXJhbSB0byB7RWxlbWVudH0gdGhlIGVsZW1lbnQgdG8gc3luYyB0aGUgaW5wdXQgdmFsdWUgdG9cbiAgICAgICAgICogQHBhcmFtIGN0eCB0aGUgbWVyZ2UgY29udGV4dFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc3luY0lucHV0VmFsdWUoZnJvbSwgdG8sIGN0eCkge1xuICAgICAgICAgICAgaWYgKGZyb20gaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50ICYmXG4gICAgICAgICAgICAgICAgdG8gaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50ICYmXG4gICAgICAgICAgICAgICAgZnJvbS50eXBlICE9PSAnZmlsZScpIHtcblxuICAgICAgICAgICAgICAgIGxldCBmcm9tVmFsdWUgPSBmcm9tLnZhbHVlO1xuICAgICAgICAgICAgICAgIGxldCB0b1ZhbHVlID0gdG8udmFsdWU7XG5cbiAgICAgICAgICAgICAgICAvLyBzeW5jIGJvb2xlYW4gYXR0cmlidXRlc1xuICAgICAgICAgICAgICAgIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCAnY2hlY2tlZCcsIGN0eCk7XG4gICAgICAgICAgICAgICAgc3luY0Jvb2xlYW5BdHRyaWJ1dGUoZnJvbSwgdG8sICdkaXNhYmxlZCcsIGN0eCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWZyb20uaGFzQXR0cmlidXRlKCd2YWx1ZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaWdub3JlQXR0cmlidXRlKCd2YWx1ZScsIHRvLCAncmVtb3ZlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8udmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnJlbW92ZUF0dHJpYnV0ZSgndmFsdWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbVZhbHVlICE9PSB0b1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaWdub3JlQXR0cmlidXRlKCd2YWx1ZScsIHRvLCAndXBkYXRlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0QXR0cmlidXRlKCd2YWx1ZScsIGZyb21WYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0by52YWx1ZSA9IGZyb21WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbSBpbnN0YW5jZW9mIEhUTUxPcHRpb25FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgc3luY0Jvb2xlYW5BdHRyaWJ1dGUoZnJvbSwgdG8sICdzZWxlY3RlZCcsIGN0eCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZyb20gaW5zdGFuY2VvZiBIVE1MVGV4dEFyZWFFbGVtZW50ICYmIHRvIGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxldCBmcm9tVmFsdWUgPSBmcm9tLnZhbHVlO1xuICAgICAgICAgICAgICAgIGxldCB0b1ZhbHVlID0gdG8udmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGlnbm9yZUF0dHJpYnV0ZSgndmFsdWUnLCB0bywgJ3VwZGF0ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZnJvbVZhbHVlICE9PSB0b1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvLnZhbHVlID0gZnJvbVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodG8uZmlyc3RDaGlsZCAmJiB0by5maXJzdENoaWxkLm5vZGVWYWx1ZSAhPT0gZnJvbVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvLmZpcnN0Q2hpbGQubm9kZVZhbHVlID0gZnJvbVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gdGhlIEhFQUQgdGFnIGNhbiBiZSBoYW5kbGVkIHNwZWNpYWxseSwgZWl0aGVyIHcvIGEgJ21lcmdlJyBvciAnYXBwZW5kJyBzdHlsZVxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZUhlYWRFbGVtZW50KG5ld0hlYWRUYWcsIGN1cnJlbnRIZWFkLCBjdHgpIHtcblxuICAgICAgICAgICAgbGV0IGFkZGVkID0gW107XG4gICAgICAgICAgICBsZXQgcmVtb3ZlZCA9IFtdO1xuICAgICAgICAgICAgbGV0IHByZXNlcnZlZCA9IFtdO1xuICAgICAgICAgICAgbGV0IG5vZGVzVG9BcHBlbmQgPSBbXTtcblxuICAgICAgICAgICAgbGV0IGhlYWRNZXJnZVN0eWxlID0gY3R4LmhlYWQuc3R5bGU7XG5cbiAgICAgICAgICAgIC8vIHB1dCBhbGwgbmV3IGhlYWQgZWxlbWVudHMgaW50byBhIE1hcCwgYnkgdGhlaXIgb3V0ZXJIVE1MXG4gICAgICAgICAgICBsZXQgc3JjVG9OZXdIZWFkTm9kZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5ld0hlYWRDaGlsZCBvZiBuZXdIZWFkVGFnLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgc3JjVG9OZXdIZWFkTm9kZXMuc2V0KG5ld0hlYWRDaGlsZC5vdXRlckhUTUwsIG5ld0hlYWRDaGlsZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGZvciBlYWNoIGVsdCBpbiB0aGUgY3VycmVudCBoZWFkXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGN1cnJlbnRIZWFkRWx0IG9mIGN1cnJlbnRIZWFkLmNoaWxkcmVuKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBoZWFkIGVsZW1lbnQgaXMgaW4gdGhlIG1hcFxuICAgICAgICAgICAgICAgIGxldCBpbk5ld0NvbnRlbnQgPSBzcmNUb05ld0hlYWROb2Rlcy5oYXMoY3VycmVudEhlYWRFbHQub3V0ZXJIVE1MKTtcbiAgICAgICAgICAgICAgICBsZXQgaXNSZUFwcGVuZGVkID0gY3R4LmhlYWQuc2hvdWxkUmVBcHBlbmQoY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgIGxldCBpc1ByZXNlcnZlZCA9IGN0eC5oZWFkLnNob3VsZFByZXNlcnZlKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICBpZiAoaW5OZXdDb250ZW50IHx8IGlzUHJlc2VydmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1JlQXBwZW5kZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgY3VycmVudCB2ZXJzaW9uIGFuZCBsZXQgdGhlIG5ldyB2ZXJzaW9uIHJlcGxhY2UgaXQgYW5kIHJlLWV4ZWN1dGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWQucHVzaChjdXJyZW50SGVhZEVsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGVsZW1lbnQgYWxyZWFkeSBleGlzdHMgYW5kIHNob3VsZCBub3QgYmUgcmUtYXBwZW5kZWQsIHNvIHJlbW92ZSBpdCBmcm9tXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbmV3IGNvbnRlbnQgbWFwLCBwcmVzZXJ2aW5nIGl0IGluIHRoZSBET01cbiAgICAgICAgICAgICAgICAgICAgICAgIHNyY1RvTmV3SGVhZE5vZGVzLmRlbGV0ZShjdXJyZW50SGVhZEVsdC5vdXRlckhUTUwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJlc2VydmVkLnB1c2goY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRNZXJnZVN0eWxlID09PSBcImFwcGVuZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBhcmUgYXBwZW5kaW5nIGFuZCB0aGlzIGV4aXN0aW5nIGVsZW1lbnQgaXMgbm90IG5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyBpZiBhbmQgb25seSBpZiBpdCBpcyBtYXJrZWQgZm9yIHJlLWFwcGVuZCBkbyB3ZSBkbyBhbnl0aGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUmVBcHBlbmRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWQucHVzaChjdXJyZW50SGVhZEVsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNUb0FwcGVuZC5wdXNoKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBtZXJnZSwgd2UgcmVtb3ZlIHRoaXMgY29udGVudCBzaW5jZSBpdCBpcyBub3QgaW4gdGhlIG5ldyBoZWFkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LmhlYWQuc2hvdWxkUmVtb3ZlKGN1cnJlbnRIZWFkRWx0KSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkLnB1c2goY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBQdXNoIHRoZSByZW1haW5pbmcgbmV3IGhlYWQgZWxlbWVudHMgaW4gdGhlIE1hcCBpbnRvIHRoZVxuICAgICAgICAgICAgLy8gbm9kZXMgdG8gYXBwZW5kIHRvIHRoZSBoZWFkIHRhZ1xuICAgICAgICAgICAgbm9kZXNUb0FwcGVuZC5wdXNoKC4uLnNyY1RvTmV3SGVhZE5vZGVzLnZhbHVlcygpKTtcblxuICAgICAgICAgICAgbGV0IHByb21pc2VzID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5ld05vZGUgb2Ygbm9kZXNUb0FwcGVuZCkge1xuICAgICAgICAgICAgICAgIGxldCBuZXdFbHQgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChuZXdOb2RlLm91dGVySFRNTCkuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlQWRkZWQobmV3RWx0KSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0VsdC5ocmVmIHx8IG5ld0VsdC5zcmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXNvbHZlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKF9yZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSA9IF9yZXNvbHZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbHQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2gocHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEhlYWQuYXBwZW5kQ2hpbGQobmV3RWx0KTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVBZGRlZChuZXdFbHQpO1xuICAgICAgICAgICAgICAgICAgICBhZGRlZC5wdXNoKG5ld0VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZW1vdmUgYWxsIHJlbW92ZWQgZWxlbWVudHMsIGFmdGVyIHdlIGhhdmUgYXBwZW5kZWQgdGhlIG5ldyBlbGVtZW50cyB0byBhdm9pZFxuICAgICAgICAgICAgLy8gYWRkaXRpb25hbCBuZXR3b3JrIHJlcXVlc3RzIGZvciB0aGluZ3MgbGlrZSBzdHlsZSBzaGVldHNcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVtb3ZlZEVsZW1lbnQgb2YgcmVtb3ZlZCkge1xuICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVSZW1vdmVkKHJlbW92ZWRFbGVtZW50KSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEhlYWQucmVtb3ZlQ2hpbGQocmVtb3ZlZEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICBjdHguY2FsbGJhY2tzLmFmdGVyTm9kZVJlbW92ZWQocmVtb3ZlZEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3R4LmhlYWQuYWZ0ZXJIZWFkTW9ycGhlZChjdXJyZW50SGVhZCwge2FkZGVkOiBhZGRlZCwga2VwdDogcHJlc2VydmVkLCByZW1vdmVkOiByZW1vdmVkfSk7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZXM7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBub09wKCkge1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICBEZWVwIG1lcmdlcyB0aGUgY29uZmlnIG9iamVjdCBhbmQgdGhlIElkaW9tb3JvcGguZGVmYXVsdHMgb2JqZWN0IHRvXG4gICAgICAgICAgcHJvZHVjZSBhIGZpbmFsIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBtZXJnZURlZmF1bHRzKGNvbmZpZykge1xuICAgICAgICAgICAgbGV0IGZpbmFsQ29uZmlnID0ge307XG4gICAgICAgICAgICAvLyBjb3B5IHRvcCBsZXZlbCBzdHVmZiBpbnRvIGZpbmFsIGNvbmZpZ1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihmaW5hbENvbmZpZywgZGVmYXVsdHMpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihmaW5hbENvbmZpZywgY29uZmlnKTtcblxuICAgICAgICAgICAgLy8gY29weSBjYWxsYmFja3MgaW50byBmaW5hbCBjb25maWcgKGRvIHRoaXMgdG8gZGVlcCBtZXJnZSB0aGUgY2FsbGJhY2tzKVxuICAgICAgICAgICAgZmluYWxDb25maWcuY2FsbGJhY2tzID0ge307XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGZpbmFsQ29uZmlnLmNhbGxiYWNrcywgZGVmYXVsdHMuY2FsbGJhY2tzKTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmluYWxDb25maWcuY2FsbGJhY2tzLCBjb25maWcuY2FsbGJhY2tzKTtcblxuICAgICAgICAgICAgLy8gY29weSBoZWFkIGNvbmZpZyBpbnRvIGZpbmFsIGNvbmZpZyAgKGRvIHRoaXMgdG8gZGVlcCBtZXJnZSB0aGUgaGVhZClcbiAgICAgICAgICAgIGZpbmFsQ29uZmlnLmhlYWQgPSB7fTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmluYWxDb25maWcuaGVhZCwgZGVmYXVsdHMuaGVhZCk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGZpbmFsQ29uZmlnLmhlYWQsIGNvbmZpZy5oZWFkKTtcbiAgICAgICAgICAgIHJldHVybiBmaW5hbENvbmZpZztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU1vcnBoQ29udGV4dChvbGROb2RlLCBuZXdDb250ZW50LCBjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZyA9IG1lcmdlRGVmYXVsdHMoY29uZmlnKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBvbGROb2RlLFxuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQ6IG5ld0NvbnRlbnQsXG4gICAgICAgICAgICAgICAgY29uZmlnOiBjb25maWcsXG4gICAgICAgICAgICAgICAgbW9ycGhTdHlsZTogY29uZmlnLm1vcnBoU3R5bGUsXG4gICAgICAgICAgICAgICAgaWdub3JlQWN0aXZlOiBjb25maWcuaWdub3JlQWN0aXZlLFxuICAgICAgICAgICAgICAgIGlnbm9yZUFjdGl2ZVZhbHVlOiBjb25maWcuaWdub3JlQWN0aXZlVmFsdWUsXG4gICAgICAgICAgICAgICAgaWRNYXA6IGNyZWF0ZUlkTWFwKG9sZE5vZGUsIG5ld0NvbnRlbnQpLFxuICAgICAgICAgICAgICAgIGRlYWRJZHM6IG5ldyBTZXQoKSxcbiAgICAgICAgICAgICAgICBjYWxsYmFja3M6IGNvbmZpZy5jYWxsYmFja3MsXG4gICAgICAgICAgICAgICAgaGVhZDogY29uZmlnLmhlYWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGlzSWRTZXRNYXRjaChub2RlMSwgbm9kZTIsIGN0eCkge1xuICAgICAgICAgICAgaWYgKG5vZGUxID09IG51bGwgfHwgbm9kZTIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChub2RlMS5ub2RlVHlwZSA9PT0gbm9kZTIubm9kZVR5cGUgJiYgbm9kZTEudGFnTmFtZSA9PT0gbm9kZTIudGFnTmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlMS5pZCAhPT0gXCJcIiAmJiBub2RlMS5pZCA9PT0gbm9kZTIuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBub2RlMSwgbm9kZTIpID4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpc1NvZnRNYXRjaChub2RlMSwgbm9kZTIpIHtcbiAgICAgICAgICAgIGlmIChub2RlMSA9PSBudWxsIHx8IG5vZGUyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm9kZTEubm9kZVR5cGUgPT09IG5vZGUyLm5vZGVUeXBlICYmIG5vZGUxLnRhZ05hbWUgPT09IG5vZGUyLnRhZ05hbWVcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZU5vZGVzQmV0d2VlbihzdGFydEluY2x1c2l2ZSwgZW5kRXhjbHVzaXZlLCBjdHgpIHtcbiAgICAgICAgICAgIHdoaWxlIChzdGFydEluY2x1c2l2ZSAhPT0gZW5kRXhjbHVzaXZlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRlbXBOb2RlID0gc3RhcnRJbmNsdXNpdmU7XG4gICAgICAgICAgICAgICAgc3RhcnRJbmNsdXNpdmUgPSBzdGFydEluY2x1c2l2ZS5uZXh0U2libGluZztcbiAgICAgICAgICAgICAgICByZW1vdmVOb2RlKHRlbXBOb2RlLCBjdHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCBlbmRFeGNsdXNpdmUpO1xuICAgICAgICAgICAgcmV0dXJuIGVuZEV4Y2x1c2l2ZS5uZXh0U2libGluZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gU2NhbnMgZm9yd2FyZCBmcm9tIHRoZSBpbnNlcnRpb25Qb2ludCBpbiB0aGUgb2xkIHBhcmVudCBsb29raW5nIGZvciBhIHBvdGVudGlhbCBpZCBtYXRjaFxuICAgICAgICAvLyBmb3IgdGhlIG5ld0NoaWxkLiAgV2Ugc3RvcCBpZiB3ZSBmaW5kIGEgcG90ZW50aWFsIGlkIG1hdGNoIGZvciB0aGUgbmV3IGNoaWxkIE9SXG4gICAgICAgIC8vIGlmIHRoZSBudW1iZXIgb2YgcG90ZW50aWFsIGlkIG1hdGNoZXMgd2UgYXJlIGRpc2NhcmRpbmcgaXMgZ3JlYXRlciB0aGFuIHRoZVxuICAgICAgICAvLyBwb3RlbnRpYWwgaWQgbWF0Y2hlcyBmb3IgdGhlIG5ldyBjaGlsZFxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGZpbmRJZFNldE1hdGNoKG5ld0NvbnRlbnQsIG9sZFBhcmVudCwgbmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpIHtcblxuICAgICAgICAgICAgLy8gbWF4IGlkIG1hdGNoZXMgd2UgYXJlIHdpbGxpbmcgdG8gZGlzY2FyZCBpbiBvdXIgc2VhcmNoXG4gICAgICAgICAgICBsZXQgbmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50ID0gZ2V0SWRJbnRlcnNlY3Rpb25Db3VudChjdHgsIG5ld0NoaWxkLCBvbGRQYXJlbnQpO1xuXG4gICAgICAgICAgICBsZXQgcG90ZW50aWFsTWF0Y2ggPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBvbmx5IHNlYXJjaCBmb3J3YXJkIGlmIHRoZXJlIGlzIGEgcG9zc2liaWxpdHkgb2YgYW4gaWQgbWF0Y2hcbiAgICAgICAgICAgIGlmIChuZXdDaGlsZFBvdGVudGlhbElkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgbGV0IHBvdGVudGlhbE1hdGNoID0gaW5zZXJ0aW9uUG9pbnQ7XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSBwb3NzaWJpbGl0eSBvZiBhbiBpZCBtYXRjaCwgc2NhbiBmb3J3YXJkXG4gICAgICAgICAgICAgICAgLy8ga2VlcCB0cmFjayBvZiB0aGUgcG90ZW50aWFsIGlkIG1hdGNoIGNvdW50IHdlIGFyZSBkaXNjYXJkaW5nICh0aGVcbiAgICAgICAgICAgICAgICAvLyBuZXdDaGlsZFBvdGVudGlhbElkQ291bnQgbXVzdCBiZSBncmVhdGVyIHRoYW4gdGhpcyB0byBtYWtlIGl0IGxpa2VseVxuICAgICAgICAgICAgICAgIC8vIHdvcnRoIGl0KVxuICAgICAgICAgICAgICAgIGxldCBvdGhlck1hdGNoQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlIChwb3RlbnRpYWxNYXRjaCAhPSBudWxsKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhbiBpZCBtYXRjaCwgcmV0dXJuIHRoZSBjdXJyZW50IHBvdGVudGlhbCBtYXRjaFxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJZFNldE1hdGNoKG5ld0NoaWxkLCBwb3RlbnRpYWxNYXRjaCwgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvdGVudGlhbE1hdGNoO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29tcHV0ZXIgdGhlIG90aGVyIHBvdGVudGlhbCBtYXRjaGVzIG9mIHRoaXMgbmV3IGNvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJNYXRjaENvdW50ICs9IGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBwb3RlbnRpYWxNYXRjaCwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdGhlck1hdGNoQ291bnQgPiBuZXdDaGlsZFBvdGVudGlhbElkQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgbW9yZSBwb3RlbnRpYWwgaWQgbWF0Y2hlcyBpbiBfb3RoZXJfIGNvbnRlbnQsIHdlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBub3QgaGF2ZSBhIGdvb2QgY2FuZGlkYXRlIGZvciBhbiBpZCBtYXRjaCwgc28gcmV0dXJuIG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYWR2YW5jZWQgdG8gdGhlIG5leHQgb2xkIGNvbnRlbnQgY2hpbGRcbiAgICAgICAgICAgICAgICAgICAgcG90ZW50aWFsTWF0Y2ggPSBwb3RlbnRpYWxNYXRjaC5uZXh0U2libGluZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcG90ZW50aWFsTWF0Y2g7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFNjYW5zIGZvcndhcmQgZnJvbSB0aGUgaW5zZXJ0aW9uUG9pbnQgaW4gdGhlIG9sZCBwYXJlbnQgbG9va2luZyBmb3IgYSBwb3RlbnRpYWwgc29mdCBtYXRjaFxuICAgICAgICAvLyBmb3IgdGhlIG5ld0NoaWxkLiAgV2Ugc3RvcCBpZiB3ZSBmaW5kIGEgcG90ZW50aWFsIHNvZnQgbWF0Y2ggZm9yIHRoZSBuZXcgY2hpbGQgT1JcbiAgICAgICAgLy8gaWYgd2UgZmluZCBhIHBvdGVudGlhbCBpZCBtYXRjaCBpbiB0aGUgb2xkIHBhcmVudHMgY2hpbGRyZW4gT1IgaWYgd2UgZmluZCB0d29cbiAgICAgICAgLy8gcG90ZW50aWFsIHNvZnQgbWF0Y2hlcyBmb3IgdGhlIG5leHQgdHdvIHBpZWNlcyBvZiBuZXcgY29udGVudFxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGZpbmRTb2Z0TWF0Y2gobmV3Q29udGVudCwgb2xkUGFyZW50LCBuZXdDaGlsZCwgaW5zZXJ0aW9uUG9pbnQsIGN0eCkge1xuXG4gICAgICAgICAgICBsZXQgcG90ZW50aWFsU29mdE1hdGNoID0gaW5zZXJ0aW9uUG9pbnQ7XG4gICAgICAgICAgICBsZXQgbmV4dFNpYmxpbmcgPSBuZXdDaGlsZC5uZXh0U2libGluZztcbiAgICAgICAgICAgIGxldCBzaWJsaW5nU29mdE1hdGNoQ291bnQgPSAwO1xuXG4gICAgICAgICAgICB3aGlsZSAocG90ZW50aWFsU29mdE1hdGNoICE9IG51bGwpIHtcblxuICAgICAgICAgICAgICAgIGlmIChnZXRJZEludGVyc2VjdGlvbkNvdW50KGN0eCwgcG90ZW50aWFsU29mdE1hdGNoLCBuZXdDb250ZW50KSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGN1cnJlbnQgcG90ZW50aWFsIHNvZnQgbWF0Y2ggaGFzIGEgcG90ZW50aWFsIGlkIHNldCBtYXRjaCB3aXRoIHRoZSByZW1haW5pbmcgbmV3XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnRlbnQgc28gYmFpbCBvdXQgb2YgbG9va2luZ1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGEgc29mdCBtYXRjaCB3aXRoIHRoZSBjdXJyZW50IG5vZGUsIHJldHVybiBpdFxuICAgICAgICAgICAgICAgIGlmIChpc1NvZnRNYXRjaChuZXdDaGlsZCwgcG90ZW50aWFsU29mdE1hdGNoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG90ZW50aWFsU29mdE1hdGNoO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc1NvZnRNYXRjaChuZXh0U2libGluZywgcG90ZW50aWFsU29mdE1hdGNoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbmV4dCBuZXcgbm9kZSBoYXMgYSBzb2Z0IG1hdGNoIHdpdGggdGhpcyBub2RlLCBzb1xuICAgICAgICAgICAgICAgICAgICAvLyBpbmNyZW1lbnQgdGhlIGNvdW50IG9mIGZ1dHVyZSBzb2Z0IG1hdGNoZXNcbiAgICAgICAgICAgICAgICAgICAgc2libGluZ1NvZnRNYXRjaENvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nID0gbmV4dFNpYmxpbmcubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIHR3byBmdXR1cmUgc29mdCBtYXRjaGVzLCBiYWlsIHRvIGFsbG93IHRoZSBzaWJsaW5ncyB0byBzb2Z0IG1hdGNoXG4gICAgICAgICAgICAgICAgICAgIC8vIHNvIHRoYXQgd2UgZG9uJ3QgY29uc3VtZSBmdXR1cmUgc29mdCBtYXRjaGVzIGZvciB0aGUgc2FrZSBvZiB0aGUgY3VycmVudCBub2RlXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaWJsaW5nU29mdE1hdGNoQ291bnQgPj0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBhZHZhbmNlZCB0byB0aGUgbmV4dCBvbGQgY29udGVudCBjaGlsZFxuICAgICAgICAgICAgICAgIHBvdGVudGlhbFNvZnRNYXRjaCA9IHBvdGVudGlhbFNvZnRNYXRjaC5uZXh0U2libGluZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHBvdGVudGlhbFNvZnRNYXRjaDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHBhcnNlQ29udGVudChuZXdDb250ZW50KSB7XG4gICAgICAgICAgICBsZXQgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXG4gICAgICAgICAgICAvLyByZW1vdmUgc3ZncyB0byBhdm9pZCBmYWxzZS1wb3NpdGl2ZSBtYXRjaGVzIG9uIGhlYWQsIGV0Yy5cbiAgICAgICAgICAgIGxldCBjb250ZW50V2l0aFN2Z3NSZW1vdmVkID0gbmV3Q29udGVudC5yZXBsYWNlKC88c3ZnKFxcc1tePl0qPnw+KShbXFxzXFxTXSo/KTxcXC9zdmc+L2dpbSwgJycpO1xuXG4gICAgICAgICAgICAvLyBpZiB0aGUgbmV3Q29udGVudCBjb250YWlucyBhIGh0bWwsIGhlYWQgb3IgYm9keSB0YWcsIHdlIGNhbiBzaW1wbHkgcGFyc2UgaXQgdy9vIHdyYXBwaW5nXG4gICAgICAgICAgICBpZiAoY29udGVudFdpdGhTdmdzUmVtb3ZlZC5tYXRjaCgvPFxcL2h0bWw+LykgfHwgY29udGVudFdpdGhTdmdzUmVtb3ZlZC5tYXRjaCgvPFxcL2hlYWQ+LykgfHwgY29udGVudFdpdGhTdmdzUmVtb3ZlZC5tYXRjaCgvPFxcL2JvZHk+LykpIHtcbiAgICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcobmV3Q29udGVudCwgXCJ0ZXh0L2h0bWxcIik7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgYSBmdWxsIEhUTUwgZG9jdW1lbnQsIHJldHVybiB0aGUgZG9jdW1lbnQgaXRzZWxmIGFzIHRoZSBwYXJlbnQgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9odG1sPi8pKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuZ2VuZXJhdGVkQnlJZGlvbW9ycGggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgcmV0dXJuIHRoZSBodG1sIGVsZW1lbnQgYXMgdGhlIHBhcmVudCBjb250YWluZXJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGh0bWxFbGVtZW50ID0gY29udGVudC5maXJzdENoaWxkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaHRtbEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxFbGVtZW50LmdlbmVyYXRlZEJ5SWRpb21vcnBoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBodG1sRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBpdCBpcyBwYXJ0aWFsIEhUTUwsIHdyYXAgaXQgaW4gYSB0ZW1wbGF0ZSB0YWcgdG8gcHJvdmlkZSBhIHBhcmVudCBlbGVtZW50IGFuZCBhbHNvIHRvIGhlbHBcbiAgICAgICAgICAgICAgICAvLyBkZWFsIHdpdGggdG91Y2h5IHRhZ3MgbGlrZSB0ciwgdGJvZHksIGV0Yy5cbiAgICAgICAgICAgICAgICBsZXQgcmVzcG9uc2VEb2MgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKFwiPGJvZHk+PHRlbXBsYXRlPlwiICsgbmV3Q29udGVudCArIFwiPC90ZW1wbGF0ZT48L2JvZHk+XCIsIFwidGV4dC9odG1sXCIpO1xuICAgICAgICAgICAgICAgIGxldCBjb250ZW50ID0gcmVzcG9uc2VEb2MuYm9keS5xdWVyeVNlbGVjdG9yKCd0ZW1wbGF0ZScpLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgY29udGVudC5nZW5lcmF0ZWRCeUlkaW9tb3JwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZUNvbnRlbnQobmV3Q29udGVudCkge1xuICAgICAgICAgICAgaWYgKG5ld0NvbnRlbnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIG5vaW5zcGVjdGlvbiBVbm5lY2Vzc2FyeUxvY2FsVmFyaWFibGVKU1xuICAgICAgICAgICAgICAgIGNvbnN0IGR1bW15UGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGR1bW15UGFyZW50O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdDb250ZW50LmdlbmVyYXRlZEJ5SWRpb21vcnBoKSB7XG4gICAgICAgICAgICAgICAgLy8gdGhlIHRlbXBsYXRlIHRhZyBjcmVhdGVkIGJ5IGlkaW9tb3JwaCBwYXJzaW5nIGNhbiBzZXJ2ZSBhcyBhIGR1bW15IHBhcmVudFxuICAgICAgICAgICAgICAgIHJldHVybiBuZXdDb250ZW50O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdDb250ZW50IGluc3RhbmNlb2YgTm9kZSkge1xuICAgICAgICAgICAgICAgIC8vIGEgc2luZ2xlIG5vZGUgaXMgYWRkZWQgYXMgYSBjaGlsZCB0byBhIGR1bW15IHBhcmVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGR1bW15UGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgZHVtbXlQYXJlbnQuYXBwZW5kKG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkdW1teVBhcmVudDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gYWxsIG5vZGVzIGluIHRoZSBhcnJheSBvciBIVE1MRWxlbWVudCBjb2xsZWN0aW9uIGFyZSBjb25zb2xpZGF0ZWQgdW5kZXJcbiAgICAgICAgICAgICAgICAvLyBhIHNpbmdsZSBkdW1teSBwYXJlbnQgZWxlbWVudFxuICAgICAgICAgICAgICAgIGNvbnN0IGR1bW15UGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlbHQgb2YgWy4uLm5ld0NvbnRlbnRdKSB7XG4gICAgICAgICAgICAgICAgICAgIGR1bW15UGFyZW50LmFwcGVuZChlbHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZHVtbXlQYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbnNlcnRTaWJsaW5ncyhwcmV2aW91c1NpYmxpbmcsIG1vcnBoZWROb2RlLCBuZXh0U2libGluZykge1xuICAgICAgICAgICAgbGV0IHN0YWNrID0gW107XG4gICAgICAgICAgICBsZXQgYWRkZWQgPSBbXTtcbiAgICAgICAgICAgIHdoaWxlIChwcmV2aW91c1NpYmxpbmcgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gocHJldmlvdXNTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICBwcmV2aW91c1NpYmxpbmcgPSBwcmV2aW91c1NpYmxpbmcucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgIGFkZGVkLnB1c2gobm9kZSk7IC8vIHB1c2ggYWRkZWQgcHJlY2VkaW5nIHNpYmxpbmdzIG9uIGluIG9yZGVyIGFuZCBpbnNlcnRcbiAgICAgICAgICAgICAgICBtb3JwaGVkTm9kZS5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShub2RlLCBtb3JwaGVkTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRlZC5wdXNoKG1vcnBoZWROb2RlKTtcbiAgICAgICAgICAgIHdoaWxlIChuZXh0U2libGluZyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc3RhY2sucHVzaChuZXh0U2libGluZyk7XG4gICAgICAgICAgICAgICAgYWRkZWQucHVzaChuZXh0U2libGluZyk7IC8vIGhlcmUgd2UgYXJlIGdvaW5nIGluIG9yZGVyLCBzbyBwdXNoIG9uIGFzIHdlIHNjYW4sIHJhdGhlciB0aGFuIGFkZFxuICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nID0gbmV4dFNpYmxpbmcubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG1vcnBoZWROb2RlLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHN0YWNrLnBvcCgpLCBtb3JwaGVkTm9kZS5uZXh0U2libGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYWRkZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaW5kQmVzdE5vZGVNYXRjaChuZXdDb250ZW50LCBvbGROb2RlLCBjdHgpIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50RWxlbWVudDtcbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ID0gbmV3Q29udGVudC5maXJzdENoaWxkO1xuICAgICAgICAgICAgbGV0IGJlc3RFbGVtZW50ID0gY3VycmVudEVsZW1lbnQ7XG4gICAgICAgICAgICBsZXQgc2NvcmUgPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld1Njb3JlID0gc2NvcmVFbGVtZW50KGN1cnJlbnRFbGVtZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdTY29yZSA+IHNjb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIGJlc3RFbGVtZW50ID0gY3VycmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIHNjb3JlID0gbmV3U2NvcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ID0gY3VycmVudEVsZW1lbnQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYmVzdEVsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzY29yZUVsZW1lbnQobm9kZTEsIG5vZGUyLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChpc1NvZnRNYXRjaChub2RlMSwgbm9kZTIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC41ICsgZ2V0SWRJbnRlcnNlY3Rpb25Db3VudChjdHgsIG5vZGUxLCBub2RlMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZU5vZGUodGVtcE5vZGUsIGN0eCkge1xuICAgICAgICAgICAgcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCB0ZW1wTm9kZSk7XG4gICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlUmVtb3ZlZCh0ZW1wTm9kZSkgPT09IGZhbHNlKSByZXR1cm47XG5cbiAgICAgICAgICAgIHRlbXBOb2RlLnJlbW92ZSgpO1xuICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVSZW1vdmVkKHRlbXBOb2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gSUQgU2V0IEZ1bmN0aW9uc1xuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAgICAgZnVuY3Rpb24gaXNJZEluQ29uc2lkZXJhdGlvbihjdHgsIGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gIWN0eC5kZWFkSWRzLmhhcyhpZCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpZElzV2l0aGluTm9kZShjdHgsIGlkLCB0YXJnZXROb2RlKSB7XG4gICAgICAgICAgICBsZXQgaWRTZXQgPSBjdHguaWRNYXAuZ2V0KHRhcmdldE5vZGUpIHx8IEVNUFRZX1NFVDtcbiAgICAgICAgICAgIHJldHVybiBpZFNldC5oYXMoaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlSWRzRnJvbUNvbnNpZGVyYXRpb24oY3R4LCBub2RlKSB7XG4gICAgICAgICAgICBsZXQgaWRTZXQgPSBjdHguaWRNYXAuZ2V0KG5vZGUpIHx8IEVNUFRZX1NFVDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRTZXQpIHtcbiAgICAgICAgICAgICAgICBjdHguZGVhZElkcy5hZGQoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0SWRJbnRlcnNlY3Rpb25Db3VudChjdHgsIG5vZGUxLCBub2RlMikge1xuICAgICAgICAgICAgbGV0IHNvdXJjZVNldCA9IGN0eC5pZE1hcC5nZXQobm9kZTEpIHx8IEVNUFRZX1NFVDtcbiAgICAgICAgICAgIGxldCBtYXRjaENvdW50ID0gMDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaWQgb2Ygc291cmNlU2V0KSB7XG4gICAgICAgICAgICAgICAgLy8gYSBwb3RlbnRpYWwgbWF0Y2ggaXMgYW4gaWQgaW4gdGhlIHNvdXJjZSBhbmQgcG90ZW50aWFsSWRzU2V0LCBidXRcbiAgICAgICAgICAgICAgICAvLyB0aGF0IGhhcyBub3QgYWxyZWFkeSBiZWVuIG1lcmdlZCBpbnRvIHRoZSBET01cbiAgICAgICAgICAgICAgICBpZiAoaXNJZEluQ29uc2lkZXJhdGlvbihjdHgsIGlkKSAmJiBpZElzV2l0aGluTm9kZShjdHgsIGlkLCBub2RlMikpIHtcbiAgICAgICAgICAgICAgICAgICAgKyttYXRjaENvdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtYXRjaENvdW50O1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgYm90dG9tIHVwIGFsZ29yaXRobSB0aGF0IGZpbmRzIGFsbCBlbGVtZW50cyB3aXRoIGlkcyBpbnNpZGUgb2YgdGhlIG5vZGVcbiAgICAgICAgICogYXJndW1lbnQgYW5kIHBvcHVsYXRlcyBpZCBzZXRzIGZvciB0aG9zZSBub2RlcyBhbmQgYWxsIHRoZWlyIHBhcmVudHMsIGdlbmVyYXRpbmdcbiAgICAgICAgICogYSBzZXQgb2YgaWRzIGNvbnRhaW5lZCB3aXRoaW4gYWxsIG5vZGVzIGZvciB0aGUgZW50aXJlIGhpZXJhcmNoeSBpbiB0aGUgRE9NXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSBub2RlIHtFbGVtZW50fVxuICAgICAgICAgKiBAcGFyYW0ge01hcDxOb2RlLCBTZXQ8U3RyaW5nPj59IGlkTWFwXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBwb3B1bGF0ZUlkTWFwRm9yTm9kZShub2RlLCBpZE1hcCkge1xuICAgICAgICAgICAgbGV0IG5vZGVQYXJlbnQgPSBub2RlLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAvLyBmaW5kIGFsbCBlbGVtZW50cyB3aXRoIGFuIGlkIHByb3BlcnR5XG4gICAgICAgICAgICBsZXQgaWRFbGVtZW50cyA9IG5vZGUucXVlcnlTZWxlY3RvckFsbCgnW2lkXScpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbHQgb2YgaWRFbGVtZW50cykge1xuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50ID0gZWx0O1xuICAgICAgICAgICAgICAgIC8vIHdhbGsgdXAgdGhlIHBhcmVudCBoaWVyYXJjaHkgb2YgdGhhdCBlbGVtZW50LCBhZGRpbmcgdGhlIGlkXG4gICAgICAgICAgICAgICAgLy8gb2YgZWxlbWVudCB0byB0aGUgcGFyZW50J3MgaWQgc2V0XG4gICAgICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09IG5vZGVQYXJlbnQgJiYgY3VycmVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBpZFNldCA9IGlkTWFwLmdldChjdXJyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGlkIHNldCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgaXQgYW5kIGluc2VydCBpdCBpbiB0aGUgIG1hcFxuICAgICAgICAgICAgICAgICAgICBpZiAoaWRTZXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWRTZXQgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZE1hcC5zZXQoY3VycmVudCwgaWRTZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlkU2V0LmFkZChlbHQuaWQpO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGlzIGZ1bmN0aW9uIGNvbXB1dGVzIGEgbWFwIG9mIG5vZGVzIHRvIGFsbCBpZHMgY29udGFpbmVkIHdpdGhpbiB0aGF0IG5vZGUgKGluY2x1c2l2ZSBvZiB0aGVcbiAgICAgICAgICogbm9kZSkuICBUaGlzIG1hcCBjYW4gYmUgdXNlZCB0byBhc2sgaWYgdHdvIG5vZGVzIGhhdmUgaW50ZXJzZWN0aW5nIHNldHMgb2YgaWRzLCB3aGljaCBhbGxvd3NcbiAgICAgICAgICogZm9yIGEgbG9vc2VyIGRlZmluaXRpb24gb2YgXCJtYXRjaGluZ1wiIHRoYW4gdHJhZGl0aW9uIGlkIG1hdGNoaW5nLCBhbmQgYWxsb3dzIGNoaWxkIG5vZGVzXG4gICAgICAgICAqIHRvIGNvbnRyaWJ1dGUgdG8gYSBwYXJlbnQgbm9kZXMgbWF0Y2hpbmcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gb2xkQ29udGVudCAgdGhlIG9sZCBjb250ZW50IHRoYXQgd2lsbCBiZSBtb3JwaGVkXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gbmV3Q29udGVudCAgdGhlIG5ldyBjb250ZW50IHRvIG1vcnBoIHRvXG4gICAgICAgICAqIEByZXR1cm5zIHtNYXA8Tm9kZSwgU2V0PFN0cmluZz4+fSBhIG1hcCBvZiBub2RlcyB0byBpZCBzZXRzIGZvciB0aGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUlkTWFwKG9sZENvbnRlbnQsIG5ld0NvbnRlbnQpIHtcbiAgICAgICAgICAgIGxldCBpZE1hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHBvcHVsYXRlSWRNYXBGb3JOb2RlKG9sZENvbnRlbnQsIGlkTWFwKTtcbiAgICAgICAgICAgIHBvcHVsYXRlSWRNYXBGb3JOb2RlKG5ld0NvbnRlbnQsIGlkTWFwKTtcbiAgICAgICAgICAgIHJldHVybiBpZE1hcDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gVGhpcyBpcyB3aGF0IGVuZHMgdXAgYmVjb21pbmcgdGhlIElkaW9tb3JwaCBnbG9iYWwgb2JqZWN0XG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1vcnBoLFxuICAgICAgICAgICAgZGVmYXVsdHNcbiAgICAgICAgfVxuICAgIH0pKCk7XG5cbmZ1bmN0aW9uIG1vcnBoRWxlbWVudHMoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQsIHsgY2FsbGJhY2tzLCAuLi5vcHRpb25zIH0gPSB7fSkge1xuICBJZGlvbW9ycGgubW9ycGgoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQsIHtcbiAgICAuLi5vcHRpb25zLFxuICAgIGNhbGxiYWNrczogbmV3IERlZmF1bHRJZGlvbW9ycGhDYWxsYmFja3MoY2FsbGJhY2tzKVxuICB9KTtcbn1cblxuZnVuY3Rpb24gbW9ycGhDaGlsZHJlbihjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICBtb3JwaEVsZW1lbnRzKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50LmNoaWxkcmVuLCB7XG4gICAgbW9ycGhTdHlsZTogXCJpbm5lckhUTUxcIlxuICB9KTtcbn1cblxuY2xhc3MgRGVmYXVsdElkaW9tb3JwaENhbGxiYWNrcyB7XG4gICNiZWZvcmVOb2RlTW9ycGhlZFxuXG4gIGNvbnN0cnVjdG9yKHsgYmVmb3JlTm9kZU1vcnBoZWQgfSA9IHt9KSB7XG4gICAgdGhpcy4jYmVmb3JlTm9kZU1vcnBoZWQgPSBiZWZvcmVOb2RlTW9ycGhlZCB8fCAoKCkgPT4gdHJ1ZSk7XG4gIH1cblxuICBiZWZvcmVOb2RlQWRkZWQgPSAobm9kZSkgPT4ge1xuICAgIHJldHVybiAhKG5vZGUuaWQgJiYgbm9kZS5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXBlcm1hbmVudFwiKSAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChub2RlLmlkKSlcbiAgfVxuXG4gIGJlZm9yZU5vZGVNb3JwaGVkID0gKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSA9PiB7XG4gICAgaWYgKGN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgaWYgKCFjdXJyZW50RWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXBlcm1hbmVudFwiKSAmJiB0aGlzLiNiZWZvcmVOb2RlTW9ycGhlZChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkpIHtcbiAgICAgICAgY29uc3QgZXZlbnQgPSBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1tb3JwaC1lbGVtZW50XCIsIHtcbiAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgICAgIHRhcmdldDogY3VycmVudEVsZW1lbnQsXG4gICAgICAgICAgZGV0YWlsOiB7IGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50IH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBiZWZvcmVBdHRyaWJ1dGVVcGRhdGVkID0gKGF0dHJpYnV0ZU5hbWUsIHRhcmdldCwgbXV0YXRpb25UeXBlKSA9PiB7XG4gICAgY29uc3QgZXZlbnQgPSBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1tb3JwaC1hdHRyaWJ1dGVcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIHRhcmdldCxcbiAgICAgIGRldGFpbDogeyBhdHRyaWJ1dGVOYW1lLCBtdXRhdGlvblR5cGUgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICBiZWZvcmVOb2RlUmVtb3ZlZCA9IChub2RlKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMuYmVmb3JlTm9kZU1vcnBoZWQobm9kZSlcbiAgfVxuXG4gIGFmdGVyTm9kZU1vcnBoZWQgPSAoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpID0+IHtcbiAgICBpZiAoY3VycmVudEVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG4gICAgICBkaXNwYXRjaChcInR1cmJvOm1vcnBoLWVsZW1lbnRcIiwge1xuICAgICAgICB0YXJnZXQ6IGN1cnJlbnRFbGVtZW50LFxuICAgICAgICBkZXRhaWw6IHsgY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIE1vcnBoaW5nRnJhbWVSZW5kZXJlciBleHRlbmRzIEZyYW1lUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZyYW1lLW1vcnBoXCIsIHtcbiAgICAgIHRhcmdldDogY3VycmVudEVsZW1lbnQsXG4gICAgICBkZXRhaWw6IHsgY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQgfVxuICAgIH0pO1xuXG4gICAgbW9ycGhDaGlsZHJlbihjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCk7XG4gIH1cbn1cblxuY2xhc3MgUGFnZVJlbmRlcmVyIGV4dGVuZHMgUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIGlmIChkb2N1bWVudC5ib2R5ICYmIG5ld0VsZW1lbnQgaW5zdGFuY2VvZiBIVE1MQm9keUVsZW1lbnQpIHtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVwbGFjZVdpdGgobmV3RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChuZXdFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBnZXQgc2hvdWxkUmVuZGVyKCkge1xuICAgIHJldHVybiB0aGlzLm5ld1NuYXBzaG90LmlzVmlzaXRhYmxlICYmIHRoaXMudHJhY2tlZEVsZW1lbnRzQXJlSWRlbnRpY2FsXG4gIH1cblxuICBnZXQgcmVsb2FkUmVhc29uKCkge1xuICAgIGlmICghdGhpcy5uZXdTbmFwc2hvdC5pc1Zpc2l0YWJsZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVhc29uOiBcInR1cmJvX3Zpc2l0X2NvbnRyb2xfaXNfcmVsb2FkXCJcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXRoaXMudHJhY2tlZEVsZW1lbnRzQXJlSWRlbnRpY2FsKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZWFzb246IFwidHJhY2tlZF9lbGVtZW50X21pc21hdGNoXCJcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBwcmVwYXJlVG9SZW5kZXIoKSB7XG4gICAgdGhpcy4jc2V0TGFuZ3VhZ2UoKTtcbiAgICBhd2FpdCB0aGlzLm1lcmdlSGVhZCgpO1xuICB9XG5cbiAgYXN5bmMgcmVuZGVyKCkge1xuICAgIGlmICh0aGlzLndpbGxSZW5kZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMucmVwbGFjZUJvZHkoKTtcbiAgICB9XG4gIH1cblxuICBmaW5pc2hSZW5kZXJpbmcoKSB7XG4gICAgc3VwZXIuZmluaXNoUmVuZGVyaW5nKCk7XG4gICAgaWYgKCF0aGlzLmlzUHJldmlldykge1xuICAgICAgdGhpcy5mb2N1c0ZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnQoKTtcbiAgICB9XG4gIH1cblxuICBnZXQgY3VycmVudEhlYWRTbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50U25hcHNob3QuaGVhZFNuYXBzaG90XG4gIH1cblxuICBnZXQgbmV3SGVhZFNuYXBzaG90KCkge1xuICAgIHJldHVybiB0aGlzLm5ld1NuYXBzaG90LmhlYWRTbmFwc2hvdFxuICB9XG5cbiAgZ2V0IG5ld0VsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3U25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgI3NldExhbmd1YWdlKCkge1xuICAgIGNvbnN0IHsgZG9jdW1lbnRFbGVtZW50IH0gPSB0aGlzLmN1cnJlbnRTbmFwc2hvdDtcbiAgICBjb25zdCB7IGxhbmcgfSA9IHRoaXMubmV3U25hcHNob3Q7XG5cbiAgICBpZiAobGFuZykge1xuICAgICAgZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShcImxhbmdcIiwgbGFuZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJsYW5nXCIpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG1lcmdlSGVhZCgpIHtcbiAgICBjb25zdCBtZXJnZWRIZWFkRWxlbWVudHMgPSB0aGlzLm1lcmdlUHJvdmlzaW9uYWxFbGVtZW50cygpO1xuICAgIGNvbnN0IG5ld1N0eWxlc2hlZXRFbGVtZW50cyA9IHRoaXMuY29weU5ld0hlYWRTdHlsZXNoZWV0RWxlbWVudHMoKTtcbiAgICB0aGlzLmNvcHlOZXdIZWFkU2NyaXB0RWxlbWVudHMoKTtcblxuICAgIGF3YWl0IG1lcmdlZEhlYWRFbGVtZW50cztcbiAgICBhd2FpdCBuZXdTdHlsZXNoZWV0RWxlbWVudHM7XG5cbiAgICBpZiAodGhpcy53aWxsUmVuZGVyKSB7XG4gICAgICB0aGlzLnJlbW92ZVVudXNlZER5bmFtaWNTdHlsZXNoZWV0RWxlbWVudHMoKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyByZXBsYWNlQm9keSgpIHtcbiAgICBhd2FpdCB0aGlzLnByZXNlcnZpbmdQZXJtYW5lbnRFbGVtZW50cyhhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLmFjdGl2YXRlTmV3Qm9keSgpO1xuICAgICAgYXdhaXQgdGhpcy5hc3NpZ25OZXdCb2R5KCk7XG4gICAgfSk7XG4gIH1cblxuICBnZXQgdHJhY2tlZEVsZW1lbnRzQXJlSWRlbnRpY2FsKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRIZWFkU25hcHNob3QudHJhY2tlZEVsZW1lbnRTaWduYXR1cmUgPT0gdGhpcy5uZXdIZWFkU25hcHNob3QudHJhY2tlZEVsZW1lbnRTaWduYXR1cmVcbiAgfVxuXG4gIGFzeW5jIGNvcHlOZXdIZWFkU3R5bGVzaGVldEVsZW1lbnRzKCkge1xuICAgIGNvbnN0IGxvYWRpbmdFbGVtZW50cyA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMubmV3SGVhZFN0eWxlc2hlZXRFbGVtZW50cykge1xuICAgICAgbG9hZGluZ0VsZW1lbnRzLnB1c2god2FpdEZvckxvYWQoZWxlbWVudCkpO1xuXG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIH1cblxuICAgIGF3YWl0IFByb21pc2UuYWxsKGxvYWRpbmdFbGVtZW50cyk7XG4gIH1cblxuICBjb3B5TmV3SGVhZFNjcmlwdEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm5ld0hlYWRTY3JpcHRFbGVtZW50cykge1xuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoZWxlbWVudCkpO1xuICAgIH1cbiAgfVxuXG4gIHJlbW92ZVVudXNlZER5bmFtaWNTdHlsZXNoZWV0RWxlbWVudHMoKSB7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMudW51c2VkRHluYW1pY1N0eWxlc2hlZXRFbGVtZW50cykge1xuICAgICAgZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBtZXJnZVByb3Zpc2lvbmFsRWxlbWVudHMoKSB7XG4gICAgY29uc3QgbmV3SGVhZEVsZW1lbnRzID0gWy4uLnRoaXMubmV3SGVhZFByb3Zpc2lvbmFsRWxlbWVudHNdO1xuXG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMuY3VycmVudEhlYWRQcm92aXNpb25hbEVsZW1lbnRzKSB7XG4gICAgICBpZiAoIXRoaXMuaXNDdXJyZW50RWxlbWVudEluRWxlbWVudExpc3QoZWxlbWVudCwgbmV3SGVhZEVsZW1lbnRzKSkge1xuICAgICAgICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBuZXdIZWFkRWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgaXNDdXJyZW50RWxlbWVudEluRWxlbWVudExpc3QoZWxlbWVudCwgZWxlbWVudExpc3QpIHtcbiAgICBmb3IgKGNvbnN0IFtpbmRleCwgbmV3RWxlbWVudF0gb2YgZWxlbWVudExpc3QuZW50cmllcygpKSB7XG4gICAgICAvLyBpZiB0aXRsZSBlbGVtZW50Li4uXG4gICAgICBpZiAoZWxlbWVudC50YWdOYW1lID09IFwiVElUTEVcIikge1xuICAgICAgICBpZiAobmV3RWxlbWVudC50YWdOYW1lICE9IFwiVElUTEVcIikge1xuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVsZW1lbnQuaW5uZXJIVE1MID09IG5ld0VsZW1lbnQuaW5uZXJIVE1MKSB7XG4gICAgICAgICAgZWxlbWVudExpc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIGFueSBvdGhlciBlbGVtZW50Li4uXG4gICAgICBpZiAobmV3RWxlbWVudC5pc0VxdWFsTm9kZShlbGVtZW50KSkge1xuICAgICAgICBlbGVtZW50TGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgcmVtb3ZlQ3VycmVudEhlYWRQcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLmN1cnJlbnRIZWFkUHJvdmlzaW9uYWxFbGVtZW50cykge1xuICAgICAgZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBjb3B5TmV3SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMoKSB7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMubmV3SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgYWN0aXZhdGVOZXdCb2R5KCkge1xuICAgIGRvY3VtZW50LmFkb3B0Tm9kZSh0aGlzLm5ld0VsZW1lbnQpO1xuICAgIHRoaXMuYWN0aXZhdGVOZXdCb2R5U2NyaXB0RWxlbWVudHMoKTtcbiAgfVxuXG4gIGFjdGl2YXRlTmV3Qm9keVNjcmlwdEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgaW5lcnRTY3JpcHRFbGVtZW50IG9mIHRoaXMubmV3Qm9keVNjcmlwdEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCBhY3RpdmF0ZWRTY3JpcHRFbGVtZW50ID0gYWN0aXZhdGVTY3JpcHRFbGVtZW50KGluZXJ0U2NyaXB0RWxlbWVudCk7XG4gICAgICBpbmVydFNjcmlwdEVsZW1lbnQucmVwbGFjZVdpdGgoYWN0aXZhdGVkU2NyaXB0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYXNzaWduTmV3Qm9keSgpIHtcbiAgICBhd2FpdCB0aGlzLnJlbmRlckVsZW1lbnQodGhpcy5jdXJyZW50RWxlbWVudCwgdGhpcy5uZXdFbGVtZW50KTtcbiAgfVxuXG4gIGdldCB1bnVzZWREeW5hbWljU3R5bGVzaGVldEVsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLm9sZEhlYWRTdHlsZXNoZWV0RWxlbWVudHMuZmlsdGVyKChlbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXRyYWNrXCIpID09PSBcImR5bmFtaWNcIlxuICAgIH0pXG4gIH1cblxuICBnZXQgb2xkSGVhZFN0eWxlc2hlZXRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50SGVhZFNuYXBzaG90LmdldFN0eWxlc2hlZXRFbGVtZW50c05vdEluU25hcHNob3QodGhpcy5uZXdIZWFkU25hcHNob3QpXG4gIH1cblxuICBnZXQgbmV3SGVhZFN0eWxlc2hlZXRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdIZWFkU25hcHNob3QuZ2V0U3R5bGVzaGVldEVsZW1lbnRzTm90SW5TbmFwc2hvdCh0aGlzLmN1cnJlbnRIZWFkU25hcHNob3QpXG4gIH1cblxuICBnZXQgbmV3SGVhZFNjcmlwdEVsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLm5ld0hlYWRTbmFwc2hvdC5nZXRTY3JpcHRFbGVtZW50c05vdEluU25hcHNob3QodGhpcy5jdXJyZW50SGVhZFNuYXBzaG90KVxuICB9XG5cbiAgZ2V0IGN1cnJlbnRIZWFkUHJvdmlzaW9uYWxFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50SGVhZFNuYXBzaG90LnByb3Zpc2lvbmFsRWxlbWVudHNcbiAgfVxuXG4gIGdldCBuZXdIZWFkUHJvdmlzaW9uYWxFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdIZWFkU25hcHNob3QucHJvdmlzaW9uYWxFbGVtZW50c1xuICB9XG5cbiAgZ2V0IG5ld0JvZHlTY3JpcHRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIilcbiAgfVxufVxuXG5jbGFzcyBNb3JwaGluZ1BhZ2VSZW5kZXJlciBleHRlbmRzIFBhZ2VSZW5kZXJlciB7XG4gIHN0YXRpYyByZW5kZXJFbGVtZW50KGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSB7XG4gICAgbW9ycGhFbGVtZW50cyhjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCwge1xuICAgICAgY2FsbGJhY2tzOiB7XG4gICAgICAgIGJlZm9yZU5vZGVNb3JwaGVkOiBlbGVtZW50ID0+ICFjYW5SZWZyZXNoRnJhbWUoZWxlbWVudClcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGZvciAoY29uc3QgZnJhbWUgb2YgY3VycmVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcInR1cmJvLWZyYW1lXCIpKSB7XG4gICAgICBpZiAoY2FuUmVmcmVzaEZyYW1lKGZyYW1lKSkgcmVmcmVzaEZyYW1lKGZyYW1lKTtcbiAgICB9XG5cbiAgICBkaXNwYXRjaChcInR1cmJvOm1vcnBoXCIsIHsgZGV0YWlsOiB7IGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50IH0gfSk7XG4gIH1cblxuICBhc3luYyBwcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoY2FsbGJhY2spIHtcbiAgICByZXR1cm4gYXdhaXQgY2FsbGJhY2soKVxuICB9XG5cbiAgZ2V0IHJlbmRlck1ldGhvZCgpIHtcbiAgICByZXR1cm4gXCJtb3JwaFwiXG4gIH1cblxuICBnZXQgc2hvdWxkQXV0b2ZvY3VzKCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbmZ1bmN0aW9uIGNhblJlZnJlc2hGcmFtZShmcmFtZSkge1xuICByZXR1cm4gZnJhbWUgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQgJiZcbiAgICBmcmFtZS5zcmMgJiZcbiAgICBmcmFtZS5yZWZyZXNoID09PSBcIm1vcnBoXCIgJiZcbiAgICAhZnJhbWUuY2xvc2VzdChcIltkYXRhLXR1cmJvLXBlcm1hbmVudF1cIilcbn1cblxuZnVuY3Rpb24gcmVmcmVzaEZyYW1lKGZyYW1lKSB7XG4gIGZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtZnJhbWUtcmVuZGVyXCIsICh7IGRldGFpbCB9KSA9PiB7XG4gICAgZGV0YWlsLnJlbmRlciA9IE1vcnBoaW5nRnJhbWVSZW5kZXJlci5yZW5kZXJFbGVtZW50O1xuICB9LCB7IG9uY2U6IHRydWUgfSk7XG5cbiAgZnJhbWUucmVsb2FkKCk7XG59XG5cbmNsYXNzIFNuYXBzaG90Q2FjaGUge1xuICBrZXlzID0gW11cbiAgc25hcHNob3RzID0ge31cblxuICBjb25zdHJ1Y3RvcihzaXplKSB7XG4gICAgdGhpcy5zaXplID0gc2l6ZTtcbiAgfVxuXG4gIGhhcyhsb2NhdGlvbikge1xuICAgIHJldHVybiB0b0NhY2hlS2V5KGxvY2F0aW9uKSBpbiB0aGlzLnNuYXBzaG90c1xuICB9XG5cbiAgZ2V0KGxvY2F0aW9uKSB7XG4gICAgaWYgKHRoaXMuaGFzKGxvY2F0aW9uKSkge1xuICAgICAgY29uc3Qgc25hcHNob3QgPSB0aGlzLnJlYWQobG9jYXRpb24pO1xuICAgICAgdGhpcy50b3VjaChsb2NhdGlvbik7XG4gICAgICByZXR1cm4gc25hcHNob3RcbiAgICB9XG4gIH1cblxuICBwdXQobG9jYXRpb24sIHNuYXBzaG90KSB7XG4gICAgdGhpcy53cml0ZShsb2NhdGlvbiwgc25hcHNob3QpO1xuICAgIHRoaXMudG91Y2gobG9jYXRpb24pO1xuICAgIHJldHVybiBzbmFwc2hvdFxuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5zbmFwc2hvdHMgPSB7fTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICByZWFkKGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuc25hcHNob3RzW3RvQ2FjaGVLZXkobG9jYXRpb24pXVxuICB9XG5cbiAgd3JpdGUobG9jYXRpb24sIHNuYXBzaG90KSB7XG4gICAgdGhpcy5zbmFwc2hvdHNbdG9DYWNoZUtleShsb2NhdGlvbildID0gc25hcHNob3Q7XG4gIH1cblxuICB0b3VjaChsb2NhdGlvbikge1xuICAgIGNvbnN0IGtleSA9IHRvQ2FjaGVLZXkobG9jYXRpb24pO1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5rZXlzLmluZGV4T2Yoa2V5KTtcbiAgICBpZiAoaW5kZXggPiAtMSkgdGhpcy5rZXlzLnNwbGljZShpbmRleCwgMSk7XG4gICAgdGhpcy5rZXlzLnVuc2hpZnQoa2V5KTtcbiAgICB0aGlzLnRyaW0oKTtcbiAgfVxuXG4gIHRyaW0oKSB7XG4gICAgZm9yIChjb25zdCBrZXkgb2YgdGhpcy5rZXlzLnNwbGljZSh0aGlzLnNpemUpKSB7XG4gICAgICBkZWxldGUgdGhpcy5zbmFwc2hvdHNba2V5XTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgUGFnZVZpZXcgZXh0ZW5kcyBWaWV3IHtcbiAgc25hcHNob3RDYWNoZSA9IG5ldyBTbmFwc2hvdENhY2hlKDEwKVxuICBsYXN0UmVuZGVyZWRMb2NhdGlvbiA9IG5ldyBVUkwobG9jYXRpb24uaHJlZilcbiAgZm9yY2VSZWxvYWRlZCA9IGZhbHNlXG5cbiAgc2hvdWxkVHJhbnNpdGlvblRvKG5ld1NuYXBzaG90KSB7XG4gICAgcmV0dXJuIHRoaXMuc25hcHNob3QucHJlZmVyc1ZpZXdUcmFuc2l0aW9ucyAmJiBuZXdTbmFwc2hvdC5wcmVmZXJzVmlld1RyYW5zaXRpb25zXG4gIH1cblxuICByZW5kZXJQYWdlKHNuYXBzaG90LCBpc1ByZXZpZXcgPSBmYWxzZSwgd2lsbFJlbmRlciA9IHRydWUsIHZpc2l0KSB7XG4gICAgY29uc3Qgc2hvdWxkTW9ycGhQYWdlID0gdGhpcy5pc1BhZ2VSZWZyZXNoKHZpc2l0KSAmJiB0aGlzLnNuYXBzaG90LnNob3VsZE1vcnBoUGFnZTtcbiAgICBjb25zdCByZW5kZXJlckNsYXNzID0gc2hvdWxkTW9ycGhQYWdlID8gTW9ycGhpbmdQYWdlUmVuZGVyZXIgOiBQYWdlUmVuZGVyZXI7XG5cbiAgICBjb25zdCByZW5kZXJlciA9IG5ldyByZW5kZXJlckNsYXNzKHRoaXMuc25hcHNob3QsIHNuYXBzaG90LCByZW5kZXJlckNsYXNzLnJlbmRlckVsZW1lbnQsIGlzUHJldmlldywgd2lsbFJlbmRlcik7XG5cbiAgICBpZiAoIXJlbmRlcmVyLnNob3VsZFJlbmRlcikge1xuICAgICAgdGhpcy5mb3JjZVJlbG9hZGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmlzaXQ/LmNoYW5nZUhpc3RvcnkoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5yZW5kZXIocmVuZGVyZXIpXG4gIH1cblxuICByZW5kZXJFcnJvcihzbmFwc2hvdCwgdmlzaXQpIHtcbiAgICB2aXNpdD8uY2hhbmdlSGlzdG9yeSgpO1xuICAgIGNvbnN0IHJlbmRlcmVyID0gbmV3IEVycm9yUmVuZGVyZXIodGhpcy5zbmFwc2hvdCwgc25hcHNob3QsIEVycm9yUmVuZGVyZXIucmVuZGVyRWxlbWVudCwgZmFsc2UpO1xuICAgIHJldHVybiB0aGlzLnJlbmRlcihyZW5kZXJlcilcbiAgfVxuXG4gIGNsZWFyU25hcHNob3RDYWNoZSgpIHtcbiAgICB0aGlzLnNuYXBzaG90Q2FjaGUuY2xlYXIoKTtcbiAgfVxuXG4gIGFzeW5jIGNhY2hlU25hcHNob3Qoc25hcHNob3QgPSB0aGlzLnNuYXBzaG90KSB7XG4gICAgaWYgKHNuYXBzaG90LmlzQ2FjaGVhYmxlKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpZXdXaWxsQ2FjaGVTbmFwc2hvdCgpO1xuICAgICAgY29uc3QgeyBsYXN0UmVuZGVyZWRMb2NhdGlvbjogbG9jYXRpb24gfSA9IHRoaXM7XG4gICAgICBhd2FpdCBuZXh0RXZlbnRMb29wVGljaygpO1xuICAgICAgY29uc3QgY2FjaGVkU25hcHNob3QgPSBzbmFwc2hvdC5jbG9uZSgpO1xuICAgICAgdGhpcy5zbmFwc2hvdENhY2hlLnB1dChsb2NhdGlvbiwgY2FjaGVkU25hcHNob3QpO1xuICAgICAgcmV0dXJuIGNhY2hlZFNuYXBzaG90XG4gICAgfVxuICB9XG5cbiAgZ2V0Q2FjaGVkU25hcHNob3RGb3JMb2NhdGlvbihsb2NhdGlvbikge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90Q2FjaGUuZ2V0KGxvY2F0aW9uKVxuICB9XG5cbiAgaXNQYWdlUmVmcmVzaCh2aXNpdCkge1xuICAgIHJldHVybiAhdmlzaXQgfHwgKHRoaXMubGFzdFJlbmRlcmVkTG9jYXRpb24ucGF0aG5hbWUgPT09IHZpc2l0LmxvY2F0aW9uLnBhdGhuYW1lICYmIHZpc2l0LmFjdGlvbiA9PT0gXCJyZXBsYWNlXCIpXG4gIH1cblxuICBzaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKHZpc2l0KSB7XG4gICAgcmV0dXJuIHRoaXMuaXNQYWdlUmVmcmVzaCh2aXNpdCkgJiYgdGhpcy5zbmFwc2hvdC5zaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uXG4gIH1cblxuICBnZXQgc25hcHNob3QoKSB7XG4gICAgcmV0dXJuIFBhZ2VTbmFwc2hvdC5mcm9tRWxlbWVudCh0aGlzLmVsZW1lbnQpXG4gIH1cbn1cblxuY2xhc3MgUHJlbG9hZGVyIHtcbiAgc2VsZWN0b3IgPSBcImFbZGF0YS10dXJiby1wcmVsb2FkXVwiXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIHNuYXBzaG90Q2FjaGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5zbmFwc2hvdENhY2hlID0gc25hcHNob3RDYWNoZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgdGhpcy4jcHJlbG9hZEFsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhkb2N1bWVudC5ib2R5KTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIHRoaXMuI3ByZWxvYWRBbGwpO1xuICB9XG5cbiAgcHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhlbGVtZW50KSB7XG4gICAgZm9yIChjb25zdCBsaW5rIG9mIGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yKSkge1xuICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc2hvdWxkUHJlbG9hZExpbmsobGluaykpIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVVJMKGxpbmspO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHByZWxvYWRVUkwobGluaykge1xuICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IFVSTChsaW5rLmhyZWYpO1xuXG4gICAgaWYgKHRoaXMuc25hcHNob3RDYWNoZS5oYXMobG9jYXRpb24pKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBmZXRjaFJlcXVlc3QgPSBuZXcgRmV0Y2hSZXF1ZXN0KHRoaXMsIEZldGNoTWV0aG9kLmdldCwgbG9jYXRpb24sIG5ldyBVUkxTZWFyY2hQYXJhbXMoKSwgbGluayk7XG4gICAgYXdhaXQgZmV0Y2hSZXF1ZXN0LnBlcmZvcm0oKTtcbiAgfVxuXG4gIC8vIEZldGNoIHJlcXVlc3QgZGVsZWdhdGVcblxuICBwcmVwYXJlUmVxdWVzdChmZXRjaFJlcXVlc3QpIHtcbiAgICBmZXRjaFJlcXVlc3QuaGVhZGVyc1tcIlgtU2VjLVB1cnBvc2VcIl0gPSBcInByZWZldGNoXCI7XG4gIH1cblxuICBhc3luYyByZXF1ZXN0U3VjY2VlZGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHJlc3BvbnNlSFRNTCk7XG5cbiAgICAgIHRoaXMuc25hcHNob3RDYWNoZS5wdXQoZmV0Y2hSZXF1ZXN0LnVybCwgc25hcHNob3QpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIC8vIElmIHdlIGNhbm5vdCBwcmVsb2FkIHRoYXQgaXMgb2shXG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdFN0YXJ0ZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RFcnJvcmVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0RmluaXNoZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICByZXF1ZXN0RmFpbGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICAjcHJlbG9hZEFsbCA9ICgpID0+IHtcbiAgICB0aGlzLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZG9jdW1lbnQuYm9keSk7XG4gIH1cbn1cblxuY2xhc3MgQ2FjaGUge1xuICBjb25zdHJ1Y3RvcihzZXNzaW9uKSB7XG4gICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG4gIH1cblxuICByZXNldENhY2hlQ29udHJvbCgpIHtcbiAgICB0aGlzLiNzZXRDYWNoZUNvbnRyb2woXCJcIik7XG4gIH1cblxuICBleGVtcHRQYWdlRnJvbUNhY2hlKCkge1xuICAgIHRoaXMuI3NldENhY2hlQ29udHJvbChcIm5vLWNhY2hlXCIpO1xuICB9XG5cbiAgZXhlbXB0UGFnZUZyb21QcmV2aWV3KCkge1xuICAgIHRoaXMuI3NldENhY2hlQ29udHJvbChcIm5vLXByZXZpZXdcIik7XG4gIH1cblxuICAjc2V0Q2FjaGVDb250cm9sKHZhbHVlKSB7XG4gICAgc2V0TWV0YUNvbnRlbnQoXCJ0dXJiby1jYWNoZS1jb250cm9sXCIsIHZhbHVlKTtcbiAgfVxufVxuXG5jbGFzcyBTZXNzaW9uIHtcbiAgbmF2aWdhdG9yID0gbmV3IE5hdmlnYXRvcih0aGlzKVxuICBoaXN0b3J5ID0gbmV3IEhpc3RvcnkodGhpcylcbiAgdmlldyA9IG5ldyBQYWdlVmlldyh0aGlzLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpXG4gIGFkYXB0ZXIgPSBuZXcgQnJvd3NlckFkYXB0ZXIodGhpcylcblxuICBwYWdlT2JzZXJ2ZXIgPSBuZXcgUGFnZU9ic2VydmVyKHRoaXMpXG4gIGNhY2hlT2JzZXJ2ZXIgPSBuZXcgQ2FjaGVPYnNlcnZlcigpXG4gIGxpbmtQcmVmZXRjaE9ic2VydmVyID0gbmV3IExpbmtQcmVmZXRjaE9ic2VydmVyKHRoaXMsIGRvY3VtZW50KVxuICBsaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBMaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCB3aW5kb3cpXG4gIGZvcm1TdWJtaXRPYnNlcnZlciA9IG5ldyBGb3JtU3VibWl0T2JzZXJ2ZXIodGhpcywgZG9jdW1lbnQpXG4gIHNjcm9sbE9ic2VydmVyID0gbmV3IFNjcm9sbE9ic2VydmVyKHRoaXMpXG4gIHN0cmVhbU9ic2VydmVyID0gbmV3IFN0cmVhbU9ic2VydmVyKHRoaXMpXG4gIGZvcm1MaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBGb3JtTGlua0NsaWNrT2JzZXJ2ZXIodGhpcywgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KVxuICBmcmFtZVJlZGlyZWN0b3IgPSBuZXcgRnJhbWVSZWRpcmVjdG9yKHRoaXMsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudClcbiAgc3RyZWFtTWVzc2FnZVJlbmRlcmVyID0gbmV3IFN0cmVhbU1lc3NhZ2VSZW5kZXJlcigpXG4gIGNhY2hlID0gbmV3IENhY2hlKHRoaXMpXG5cbiAgZHJpdmUgPSB0cnVlXG4gIGVuYWJsZWQgPSB0cnVlXG4gIHByb2dyZXNzQmFyRGVsYXkgPSA1MDBcbiAgc3RhcnRlZCA9IGZhbHNlXG4gIGZvcm1Nb2RlID0gXCJvblwiXG4gICNwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gMTUwXG5cbiAgY29uc3RydWN0b3IocmVjZW50UmVxdWVzdHMpIHtcbiAgICB0aGlzLnJlY2VudFJlcXVlc3RzID0gcmVjZW50UmVxdWVzdHM7XG4gICAgdGhpcy5wcmVsb2FkZXIgPSBuZXcgUHJlbG9hZGVyKHRoaXMsIHRoaXMudmlldy5zbmFwc2hvdENhY2hlKTtcbiAgICB0aGlzLmRlYm91bmNlZFJlZnJlc2ggPSB0aGlzLnJlZnJlc2g7XG4gICAgdGhpcy5wYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gdGhpcy5wYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucGFnZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmNhY2hlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMubGlua1ByZWZldGNoT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmZvcm1TdWJtaXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5zY3JvbGxPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5zdHJlYW1PYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5mcmFtZVJlZGlyZWN0b3Iuc3RhcnQoKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5zdGFydCgpO1xuICAgICAgdGhpcy5wcmVsb2FkZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGRpc2FibGUoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucGFnZU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuY2FjaGVPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLmxpbmtQcmVmZXRjaE9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMubGlua0NsaWNrT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5zY3JvbGxPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLnN0cmVhbU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZnJhbWVSZWRpcmVjdG9yLnN0b3AoKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5zdG9wKCk7XG4gICAgICB0aGlzLnByZWxvYWRlci5zdG9wKCk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZWdpc3RlckFkYXB0ZXIoYWRhcHRlcikge1xuICAgIHRoaXMuYWRhcHRlciA9IGFkYXB0ZXI7XG4gIH1cblxuICB2aXNpdChsb2NhdGlvbiwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgZnJhbWVFbGVtZW50ID0gb3B0aW9ucy5mcmFtZSA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMuZnJhbWUpIDogbnVsbDtcblxuICAgIGlmIChmcmFtZUVsZW1lbnQgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IG9wdGlvbnMuYWN0aW9uIHx8IGdldFZpc2l0QWN0aW9uKGZyYW1lRWxlbWVudCk7XG5cbiAgICAgIGZyYW1lRWxlbWVudC5kZWxlZ2F0ZS5wcm9wb3NlVmlzaXRJZk5hdmlnYXRlZFdpdGhBY3Rpb24oZnJhbWVFbGVtZW50LCBhY3Rpb24pO1xuICAgICAgZnJhbWVFbGVtZW50LnNyYyA9IGxvY2F0aW9uLnRvU3RyaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubmF2aWdhdG9yLnByb3Bvc2VWaXNpdChleHBhbmRVUkwobG9jYXRpb24pLCBvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICByZWZyZXNoKHVybCwgcmVxdWVzdElkKSB7XG4gICAgY29uc3QgaXNSZWNlbnRSZXF1ZXN0ID0gcmVxdWVzdElkICYmIHRoaXMucmVjZW50UmVxdWVzdHMuaGFzKHJlcXVlc3RJZCk7XG4gICAgaWYgKCFpc1JlY2VudFJlcXVlc3QgJiYgIXRoaXMubmF2aWdhdG9yLmN1cnJlbnRWaXNpdCkge1xuICAgICAgdGhpcy52aXNpdCh1cmwsIHsgYWN0aW9uOiBcInJlcGxhY2VcIiwgc2hvdWxkQ2FjaGVTbmFwc2hvdDogZmFsc2UgfSk7XG4gICAgfVxuICB9XG5cbiAgY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgICB0aGlzLnN0cmVhbU9ic2VydmVyLmNvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gICAgdGhpcy5zdHJlYW1PYnNlcnZlci5kaXNjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSk7XG4gIH1cblxuICByZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICB0aGlzLnN0cmVhbU1lc3NhZ2VSZW5kZXJlci5yZW5kZXIoU3RyZWFtTWVzc2FnZS53cmFwKG1lc3NhZ2UpKTtcbiAgfVxuXG4gIGNsZWFyQ2FjaGUoKSB7XG4gICAgdGhpcy52aWV3LmNsZWFyU25hcHNob3RDYWNoZSgpO1xuICB9XG5cbiAgc2V0UHJvZ3Jlc3NCYXJEZWxheShkZWxheSkge1xuICAgIHRoaXMucHJvZ3Jlc3NCYXJEZWxheSA9IGRlbGF5O1xuICB9XG5cbiAgc2V0Rm9ybU1vZGUobW9kZSkge1xuICAgIHRoaXMuZm9ybU1vZGUgPSBtb2RlO1xuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkubG9jYXRpb25cbiAgfVxuXG4gIGdldCByZXN0b3JhdGlvbklkZW50aWZpZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5yZXN0b3JhdGlvbklkZW50aWZpZXJcbiAgfVxuXG4gIGdldCBwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kKCkge1xuICAgIHJldHVybiB0aGlzLiNwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kXG4gIH1cblxuICBzZXQgcGFnZVJlZnJlc2hEZWJvdW5jZVBlcmlvZCh2YWx1ZSkge1xuICAgIHRoaXMucmVmcmVzaCA9IGRlYm91bmNlKHRoaXMuZGVib3VuY2VkUmVmcmVzaC5iaW5kKHRoaXMpLCB2YWx1ZSk7XG4gICAgdGhpcy4jcGFnZVJlZnJlc2hEZWJvdW5jZVBlcmlvZCA9IHZhbHVlO1xuICB9XG5cbiAgLy8gUHJlbG9hZGVyIGRlbGVnYXRlXG5cbiAgc2hvdWxkUHJlbG9hZExpbmsoZWxlbWVudCkge1xuICAgIGNvbnN0IGlzVW5zYWZlID0gZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLW1ldGhvZFwiKTtcbiAgICBjb25zdCBpc1N0cmVhbSA9IGVsZW1lbnQuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIik7XG4gICAgY29uc3QgZnJhbWVUYXJnZXQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIik7XG4gICAgY29uc3QgZnJhbWUgPSBmcmFtZVRhcmdldCA9PSBcIl90b3BcIiA/XG4gICAgICBudWxsIDpcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZyYW1lVGFyZ2V0KSB8fCBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KGVsZW1lbnQsIFwidHVyYm8tZnJhbWU6bm90KFtkaXNhYmxlZF0pXCIpO1xuXG4gICAgaWYgKGlzVW5zYWZlIHx8IGlzU3RyZWFtIHx8IGZyYW1lIGluc3RhbmNlb2YgRnJhbWVFbGVtZW50KSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbG9jYXRpb24gPSBuZXcgVVJMKGVsZW1lbnQuaHJlZik7XG5cbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRJc05hdmlnYXRhYmxlKGVsZW1lbnQpICYmIGxvY2F0aW9uSXNWaXNpdGFibGUobG9jYXRpb24sIHRoaXMuc25hcHNob3Qucm9vdExvY2F0aW9uKVxuICAgIH1cbiAgfVxuXG4gIC8vIEhpc3RvcnkgZGVsZWdhdGVcblxuICBoaXN0b3J5UG9wcGVkVG9Mb2NhdGlvbldpdGhSZXN0b3JhdGlvbklkZW50aWZpZXJBbmREaXJlY3Rpb24obG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllciwgZGlyZWN0aW9uKSB7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5uYXZpZ2F0b3Iuc3RhcnRWaXNpdChsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCB7XG4gICAgICAgIGFjdGlvbjogXCJyZXN0b3JlXCIsXG4gICAgICAgIGhpc3RvcnlDaGFuZ2VkOiB0cnVlLFxuICAgICAgICBkaXJlY3Rpb25cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFkYXB0ZXIucGFnZUludmFsaWRhdGVkKHtcbiAgICAgICAgcmVhc29uOiBcInR1cmJvX2Rpc2FibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIFNjcm9sbCBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHNjcm9sbFBvc2l0aW9uQ2hhbmdlZChwb3NpdGlvbikge1xuICAgIHRoaXMuaGlzdG9yeS51cGRhdGVSZXN0b3JhdGlvbkRhdGEoeyBzY3JvbGxQb3NpdGlvbjogcG9zaXRpb24gfSk7XG4gIH1cblxuICAvLyBGb3JtIGNsaWNrIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgd2lsbFN1Ym1pdEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbikge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRJc05hdmlnYXRhYmxlKGxpbmspICYmIGxvY2F0aW9uSXNWaXNpdGFibGUobG9jYXRpb24sIHRoaXMuc25hcHNob3Qucm9vdExvY2F0aW9uKVxuICB9XG5cbiAgc3VibWl0dGVkRm9ybUxpbmtUb0xvY2F0aW9uKCkge31cblxuICAvLyBMaW5rIGhvdmVyIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgY2FuUHJlZmV0Y2hSZXF1ZXN0VG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbikge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmVsZW1lbnRJc05hdmlnYXRhYmxlKGxpbmspICYmXG4gICAgICAgIGxvY2F0aW9uSXNWaXNpdGFibGUobG9jYXRpb24sIHRoaXMuc25hcHNob3Qucm9vdExvY2F0aW9uKVxuICAgIClcbiAgfVxuXG4gIC8vIExpbmsgY2xpY2sgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsRm9sbG93TGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2ZW50KSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUobGluaykgJiZcbiAgICAgIGxvY2F0aW9uSXNWaXNpdGFibGUobG9jYXRpb24sIHRoaXMuc25hcHNob3Qucm9vdExvY2F0aW9uKSAmJlxuICAgICAgdGhpcy5hcHBsaWNhdGlvbkFsbG93c0ZvbGxvd2luZ0xpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uLCBldmVudClcbiAgICApXG4gIH1cblxuICBmb2xsb3dlZExpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgY29uc3QgYWN0aW9uID0gdGhpcy5nZXRBY3Rpb25Gb3JMaW5rKGxpbmspO1xuICAgIGNvbnN0IGFjY2VwdHNTdHJlYW1SZXNwb25zZSA9IGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIik7XG5cbiAgICB0aGlzLnZpc2l0KGxvY2F0aW9uLmhyZWYsIHsgYWN0aW9uLCBhY2NlcHRzU3RyZWFtUmVzcG9uc2UgfSk7XG4gIH1cblxuICAvLyBOYXZpZ2F0b3IgZGVsZWdhdGVcblxuICBhbGxvd3NWaXNpdGluZ0xvY2F0aW9uV2l0aEFjdGlvbihsb2NhdGlvbiwgYWN0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMubG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZShsb2NhdGlvbiwgYWN0aW9uKSB8fCB0aGlzLmFwcGxpY2F0aW9uQWxsb3dzVmlzaXRpbmdMb2NhdGlvbihsb2NhdGlvbilcbiAgfVxuXG4gIHZpc2l0UHJvcG9zZWRUb0xvY2F0aW9uKGxvY2F0aW9uLCBvcHRpb25zKSB7XG4gICAgZXh0ZW5kVVJMV2l0aERlcHJlY2F0ZWRQcm9wZXJ0aWVzKGxvY2F0aW9uKTtcbiAgICB0aGlzLmFkYXB0ZXIudmlzaXRQcm9wb3NlZFRvTG9jYXRpb24obG9jYXRpb24sIG9wdGlvbnMpO1xuICB9XG5cbiAgLy8gVmlzaXQgZGVsZWdhdGVcblxuICB2aXNpdFN0YXJ0ZWQodmlzaXQpIHtcbiAgICBpZiAoIXZpc2l0LmFjY2VwdHNTdHJlYW1SZXNwb25zZSkge1xuICAgICAgbWFya0FzQnVzeShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuICAgICAgdGhpcy52aWV3Lm1hcmtWaXNpdERpcmVjdGlvbih2aXNpdC5kaXJlY3Rpb24pO1xuICAgIH1cbiAgICBleHRlbmRVUkxXaXRoRGVwcmVjYXRlZFByb3BlcnRpZXModmlzaXQubG9jYXRpb24pO1xuICAgIGlmICghdmlzaXQuc2lsZW50KSB7XG4gICAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJWaXNpdGluZ0xvY2F0aW9uKHZpc2l0LmxvY2F0aW9uLCB2aXNpdC5hY3Rpb24pO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0Q29tcGxldGVkKHZpc2l0KSB7XG4gICAgdGhpcy52aWV3LnVubWFya1Zpc2l0RGlyZWN0aW9uKCk7XG4gICAgY2xlYXJCdXN5U3RhdGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJQYWdlTG9hZCh2aXNpdC5nZXRUaW1pbmdNZXRyaWNzKCkpO1xuICB9XG5cbiAgbG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZShsb2NhdGlvbiwgYWN0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMubmF2aWdhdG9yLmxvY2F0aW9uV2l0aEFjdGlvbklzU2FtZVBhZ2UobG9jYXRpb24sIGFjdGlvbilcbiAgfVxuXG4gIHZpc2l0U2Nyb2xsZWRUb1NhbWVQYWdlTG9jYXRpb24ob2xkVVJMLCBuZXdVUkwpIHtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJWaXNpdGluZ1NhbWVQYWdlTG9jYXRpb24ob2xkVVJMLCBuZXdVUkwpO1xuICB9XG5cbiAgLy8gRm9ybSBzdWJtaXQgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybShmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBhY3Rpb24gPSBnZXRBY3Rpb24kMShmb3JtLCBzdWJtaXR0ZXIpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuc3VibWlzc2lvbklzTmF2aWdhdGFibGUoZm9ybSwgc3VibWl0dGVyKSAmJlxuICAgICAgbG9jYXRpb25Jc1Zpc2l0YWJsZShleHBhbmRVUkwoYWN0aW9uKSwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gICAgKVxuICB9XG5cbiAgZm9ybVN1Ym1pdHRlZChmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgICB0aGlzLm5hdmlnYXRvci5zdWJtaXRGb3JtKGZvcm0sIHN1Ym1pdHRlcik7XG4gIH1cblxuICAvLyBQYWdlIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgcGFnZUJlY2FtZUludGVyYWN0aXZlKCkge1xuICAgIHRoaXMudmlldy5sYXN0UmVuZGVyZWRMb2NhdGlvbiA9IHRoaXMubG9jYXRpb247XG4gICAgdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyUGFnZUxvYWQoKTtcbiAgfVxuXG4gIHBhZ2VMb2FkZWQoKSB7XG4gICAgdGhpcy5oaXN0b3J5LmFzc3VtZUNvbnRyb2xPZlNjcm9sbFJlc3RvcmF0aW9uKCk7XG4gIH1cblxuICBwYWdlV2lsbFVubG9hZCgpIHtcbiAgICB0aGlzLmhpc3RvcnkucmVsaW5xdWlzaENvbnRyb2xPZlNjcm9sbFJlc3RvcmF0aW9uKCk7XG4gIH1cblxuICAvLyBTdHJlYW0gb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICByZWNlaXZlZE1lc3NhZ2VGcm9tU3RyZWFtKG1lc3NhZ2UpIHtcbiAgICB0aGlzLnJlbmRlclN0cmVhbU1lc3NhZ2UobWVzc2FnZSk7XG4gIH1cblxuICAvLyBQYWdlIHZpZXcgZGVsZWdhdGVcblxuICB2aWV3V2lsbENhY2hlU25hcHNob3QoKSB7XG4gICAgaWYgKCF0aGlzLm5hdmlnYXRvci5jdXJyZW50VmlzaXQ/LnNpbGVudCkge1xuICAgICAgdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkJlZm9yZUNhY2hpbmdTbmFwc2hvdCgpO1xuICAgIH1cbiAgfVxuXG4gIGFsbG93c0ltbWVkaWF0ZVJlbmRlcih7IGVsZW1lbnQgfSwgb3B0aW9ucykge1xuICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkJlZm9yZVJlbmRlcihlbGVtZW50LCBvcHRpb25zKTtcbiAgICBjb25zdCB7XG4gICAgICBkZWZhdWx0UHJldmVudGVkLFxuICAgICAgZGV0YWlsOiB7IHJlbmRlciB9XG4gICAgfSA9IGV2ZW50O1xuXG4gICAgaWYgKHRoaXMudmlldy5yZW5kZXJlciAmJiByZW5kZXIpIHtcbiAgICAgIHRoaXMudmlldy5yZW5kZXJlci5yZW5kZXJFbGVtZW50ID0gcmVuZGVyO1xuICAgIH1cblxuICAgIHJldHVybiAhZGVmYXVsdFByZXZlbnRlZFxuICB9XG5cbiAgdmlld1JlbmRlcmVkU25hcHNob3QoX3NuYXBzaG90LCBfaXNQcmV2aWV3LCByZW5kZXJNZXRob2QpIHtcbiAgICB0aGlzLnZpZXcubGFzdFJlbmRlcmVkTG9jYXRpb24gPSB0aGlzLmhpc3RvcnkubG9jYXRpb247XG4gICAgdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyUmVuZGVyKHJlbmRlck1ldGhvZCk7XG4gIH1cblxuICBwcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KGVsZW1lbnQpIHtcbiAgICB0aGlzLnByZWxvYWRlci5wcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KGVsZW1lbnQpO1xuICB9XG5cbiAgdmlld0ludmFsaWRhdGVkKHJlYXNvbikge1xuICAgIHRoaXMuYWRhcHRlci5wYWdlSW52YWxpZGF0ZWQocmVhc29uKTtcbiAgfVxuXG4gIC8vIEZyYW1lIGVsZW1lbnRcblxuICBmcmFtZUxvYWRlZChmcmFtZSkge1xuICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlckZyYW1lTG9hZChmcmFtZSk7XG4gIH1cblxuICBmcmFtZVJlbmRlcmVkKGZldGNoUmVzcG9uc2UsIGZyYW1lKSB7XG4gICAgdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyRnJhbWVSZW5kZXIoZmV0Y2hSZXNwb25zZSwgZnJhbWUpO1xuICB9XG5cbiAgLy8gQXBwbGljYXRpb24gZXZlbnRzXG5cbiAgYXBwbGljYXRpb25BbGxvd3NGb2xsb3dpbmdMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXYpIHtcbiAgICBjb25zdCBldmVudCA9IHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlckNsaWNraW5nTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2KTtcbiAgICByZXR1cm4gIWV2ZW50LmRlZmF1bHRQcmV2ZW50ZWRcbiAgfVxuXG4gIGFwcGxpY2F0aW9uQWxsb3dzVmlzaXRpbmdMb2NhdGlvbihsb2NhdGlvbikge1xuICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkJlZm9yZVZpc2l0aW5nTG9jYXRpb24obG9jYXRpb24pO1xuICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25BZnRlckNsaWNraW5nTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2ZW50KSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86Y2xpY2tcIiwge1xuICAgICAgdGFyZ2V0OiBsaW5rLFxuICAgICAgZGV0YWlsOiB7IHVybDogbG9jYXRpb24uaHJlZiwgb3JpZ2luYWxFdmVudDogZXZlbnQgfSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25CZWZvcmVWaXNpdGluZ0xvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLXZpc2l0XCIsIHtcbiAgICAgIGRldGFpbDogeyB1cmw6IGxvY2F0aW9uLmhyZWYgfSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25BZnRlclZpc2l0aW5nTG9jYXRpb24obG9jYXRpb24sIGFjdGlvbikge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOnZpc2l0XCIsIHsgZGV0YWlsOiB7IHVybDogbG9jYXRpb24uaHJlZiwgYWN0aW9uIH0gfSlcbiAgfVxuXG4gIG5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlQ2FjaGluZ1NuYXBzaG90KCkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1jYWNoZVwiKVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25CZWZvcmVSZW5kZXIobmV3Qm9keSwgb3B0aW9ucykge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1yZW5kZXJcIiwge1xuICAgICAgZGV0YWlsOiB7IG5ld0JvZHksIC4uLm9wdGlvbnMgfSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25BZnRlclJlbmRlcihyZW5kZXJNZXRob2QpIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goXCJ0dXJibzpyZW5kZXJcIiwgeyBkZXRhaWw6IHsgcmVuZGVyTWV0aG9kIH0gfSlcbiAgfVxuXG4gIG5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJQYWdlTG9hZCh0aW1pbmcgPSB7fSkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOmxvYWRcIiwge1xuICAgICAgZGV0YWlsOiB7IHVybDogdGhpcy5sb2NhdGlvbi5ocmVmLCB0aW1pbmcgfVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyVmlzaXRpbmdTYW1lUGFnZUxvY2F0aW9uKG9sZFVSTCwgbmV3VVJMKSB7XG4gICAgZGlzcGF0Y2hFdmVudChcbiAgICAgIG5ldyBIYXNoQ2hhbmdlRXZlbnQoXCJoYXNoY2hhbmdlXCIsIHtcbiAgICAgICAgb2xkVVJMOiBvbGRVUkwudG9TdHJpbmcoKSxcbiAgICAgICAgbmV3VVJMOiBuZXdVUkwudG9TdHJpbmcoKVxuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25BZnRlckZyYW1lTG9hZChmcmFtZSkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOmZyYW1lLWxvYWRcIiwgeyB0YXJnZXQ6IGZyYW1lIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyRnJhbWVSZW5kZXIoZmV0Y2hSZXNwb25zZSwgZnJhbWUpIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goXCJ0dXJibzpmcmFtZS1yZW5kZXJcIiwge1xuICAgICAgZGV0YWlsOiB7IGZldGNoUmVzcG9uc2UgfSxcbiAgICAgIHRhcmdldDogZnJhbWUsXG4gICAgICBjYW5jZWxhYmxlOiB0cnVlXG4gICAgfSlcbiAgfVxuXG4gIC8vIEhlbHBlcnNcblxuICBzdWJtaXNzaW9uSXNOYXZpZ2F0YWJsZShmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgICBpZiAodGhpcy5mb3JtTW9kZSA9PSBcIm9mZlwiKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc3VibWl0dGVySXNOYXZpZ2F0YWJsZSA9IHN1Ym1pdHRlciA/IHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUoc3VibWl0dGVyKSA6IHRydWU7XG5cbiAgICAgIGlmICh0aGlzLmZvcm1Nb2RlID09IFwib3B0aW5cIikge1xuICAgICAgICByZXR1cm4gc3VibWl0dGVySXNOYXZpZ2F0YWJsZSAmJiBmb3JtLmNsb3Nlc3QoJ1tkYXRhLXR1cmJvPVwidHJ1ZVwiXScpICE9IG51bGxcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBzdWJtaXR0ZXJJc05hdmlnYXRhYmxlICYmIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUoZm9ybSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBlbGVtZW50SXNOYXZpZ2F0YWJsZShlbGVtZW50KSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gZmluZENsb3Nlc3RSZWN1cnNpdmVseShlbGVtZW50LCBcIltkYXRhLXR1cmJvXVwiKTtcbiAgICBjb25zdCB3aXRoaW5GcmFtZSA9IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkoZWxlbWVudCwgXCJ0dXJiby1mcmFtZVwiKTtcblxuICAgIC8vIENoZWNrIGlmIERyaXZlIGlzIGVuYWJsZWQgb24gdGhlIHNlc3Npb24gb3Igd2UncmUgd2l0aGluIGEgRnJhbWUuXG4gICAgaWYgKHRoaXMuZHJpdmUgfHwgd2l0aGluRnJhbWUpIHtcbiAgICAgIC8vIEVsZW1lbnQgaXMgbmF2aWdhdGFibGUgYnkgZGVmYXVsdCwgdW5sZXNzIGBkYXRhLXR1cmJvPVwiZmFsc2VcImAuXG4gICAgICBpZiAoY29udGFpbmVyKSB7XG4gICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJib1wiKSAhPSBcImZhbHNlXCJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEVsZW1lbnQgaXNuJ3QgbmF2aWdhdGFibGUgYnkgZGVmYXVsdCwgdW5sZXNzIGBkYXRhLXR1cmJvPVwidHJ1ZVwiYC5cbiAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvXCIpID09IFwidHJ1ZVwiXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgZ2V0QWN0aW9uRm9yTGluayhsaW5rKSB7XG4gICAgcmV0dXJuIGdldFZpc2l0QWN0aW9uKGxpbmspIHx8IFwiYWR2YW5jZVwiXG4gIH1cblxuICBnZXQgc25hcHNob3QoKSB7XG4gICAgcmV0dXJuIHRoaXMudmlldy5zbmFwc2hvdFxuICB9XG59XG5cbi8vIE9sZGVyIHZlcnNpb25zIG9mIHRoZSBUdXJibyBOYXRpdmUgYWRhcHRlcnMgcmVmZXJlbmNlZCB0aGVcbi8vIGBMb2NhdGlvbiNhYnNvbHV0ZVVSTGAgcHJvcGVydHkgaW4gdGhlaXIgaW1wbGVtZW50YXRpb25zIG9mXG4vLyB0aGUgYEFkYXB0ZXIjdmlzaXRQcm9wb3NlZFRvTG9jYXRpb24oKWAgYW5kIGAjdmlzaXRTdGFydGVkKClgXG4vLyBtZXRob2RzLiBUaGUgTG9jYXRpb24gY2xhc3MgaGFzIHNpbmNlIGJlZW4gcmVtb3ZlZCBpbiBmYXZvclxuLy8gb2YgdGhlIERPTSBVUkwgQVBJLCBhbmQgYWNjb3JkaW5nbHkgYWxsIEFkYXB0ZXIgbWV0aG9kcyBub3dcbi8vIHJlY2VpdmUgVVJMIG9iamVjdHMuXG4vL1xuLy8gV2UgYWxpYXMgI2Fic29sdXRlVVJMIHRvICN0b1N0cmluZygpIGhlcmUgdG8gYXZvaWQgY3Jhc2hpbmdcbi8vIG9sZGVyIGFkYXB0ZXJzIHdoaWNoIGRvIG5vdCBleHBlY3QgVVJMIG9iamVjdHMuIFdlIHNob3VsZFxuLy8gY29uc2lkZXIgcmVtb3ZpbmcgdGhpcyBzdXBwb3J0IGF0IHNvbWUgcG9pbnQgaW4gdGhlIGZ1dHVyZS5cblxuZnVuY3Rpb24gZXh0ZW5kVVJMV2l0aERlcHJlY2F0ZWRQcm9wZXJ0aWVzKHVybCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh1cmwsIGRlcHJlY2F0ZWRMb2NhdGlvblByb3BlcnR5RGVzY3JpcHRvcnMpO1xufVxuXG5jb25zdCBkZXByZWNhdGVkTG9jYXRpb25Qcm9wZXJ0eURlc2NyaXB0b3JzID0ge1xuICBhYnNvbHV0ZVVSTDoge1xuICAgIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKClcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IHNlc3Npb24gPSBuZXcgU2Vzc2lvbihyZWNlbnRSZXF1ZXN0cyk7XG5jb25zdCB7IGNhY2hlLCBuYXZpZ2F0b3I6IG5hdmlnYXRvciQxIH0gPSBzZXNzaW9uO1xuXG4vKipcbiAqIFN0YXJ0cyB0aGUgbWFpbiBzZXNzaW9uLlxuICogVGhpcyBpbml0aWFsaXNlcyBhbnkgbmVjZXNzYXJ5IG9ic2VydmVycyBzdWNoIGFzIHRob3NlIHRvIG1vbml0b3JcbiAqIGxpbmsgaW50ZXJhY3Rpb25zLlxuICovXG5mdW5jdGlvbiBzdGFydCgpIHtcbiAgc2Vzc2lvbi5zdGFydCgpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBhbiBhZGFwdGVyIGZvciB0aGUgbWFpbiBzZXNzaW9uLlxuICpcbiAqIEBwYXJhbSBhZGFwdGVyIEFkYXB0ZXIgdG8gcmVnaXN0ZXJcbiAqL1xuZnVuY3Rpb24gcmVnaXN0ZXJBZGFwdGVyKGFkYXB0ZXIpIHtcbiAgc2Vzc2lvbi5yZWdpc3RlckFkYXB0ZXIoYWRhcHRlcik7XG59XG5cbi8qKlxuICogUGVyZm9ybXMgYW4gYXBwbGljYXRpb24gdmlzaXQgdG8gdGhlIGdpdmVuIGxvY2F0aW9uLlxuICpcbiAqIEBwYXJhbSBsb2NhdGlvbiBMb2NhdGlvbiB0byB2aXNpdCAoYSBVUkwgb3IgcGF0aClcbiAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbnMgdG8gYXBwbHlcbiAqIEBwYXJhbSBvcHRpb25zLmFjdGlvbiBUeXBlIG9mIGhpc3RvcnkgbmF2aWdhdGlvbiB0byBhcHBseSAoXCJyZXN0b3JlXCIsXG4gKiBcInJlcGxhY2VcIiBvciBcImFkdmFuY2VcIilcbiAqIEBwYXJhbSBvcHRpb25zLmhpc3RvcnlDaGFuZ2VkIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBicm93c2VyIGhpc3RvcnkgaGFzXG4gKiBhbHJlYWR5IGJlZW4gY2hhbmdlZCBmb3IgdGhpcyB2aXNpdCBvciBub3RcbiAqIEBwYXJhbSBvcHRpb25zLnJlZmVycmVyIFNwZWNpZmllcyB0aGUgcmVmZXJyZXIgb2YgdGhpcyB2aXNpdCBzdWNoIHRoYXRcbiAqIG5hdmlnYXRpb25zIHRvIHRoZSBzYW1lIHBhZ2Ugd2lsbCBub3QgcmVzdWx0IGluIGEgbmV3IGhpc3RvcnkgZW50cnkuXG4gKiBAcGFyYW0gb3B0aW9ucy5zbmFwc2hvdEhUTUwgQ2FjaGVkIHNuYXBzaG90IHRvIHJlbmRlclxuICogQHBhcmFtIG9wdGlvbnMucmVzcG9uc2UgUmVzcG9uc2Ugb2YgdGhlIHNwZWNpZmllZCBsb2NhdGlvblxuICovXG5mdW5jdGlvbiB2aXNpdChsb2NhdGlvbiwgb3B0aW9ucykge1xuICBzZXNzaW9uLnZpc2l0KGxvY2F0aW9uLCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBDb25uZWN0cyBhIHN0cmVhbSBzb3VyY2UgdG8gdGhlIG1haW4gc2Vzc2lvbi5cbiAqXG4gKiBAcGFyYW0gc291cmNlIFN0cmVhbSBzb3VyY2UgdG8gY29ubmVjdFxuICovXG5mdW5jdGlvbiBjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSkge1xuICBzZXNzaW9uLmNvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKTtcbn1cblxuLyoqXG4gKiBEaXNjb25uZWN0cyBhIHN0cmVhbSBzb3VyY2UgZnJvbSB0aGUgbWFpbiBzZXNzaW9uLlxuICpcbiAqIEBwYXJhbSBzb3VyY2UgU3RyZWFtIHNvdXJjZSB0byBkaXNjb25uZWN0XG4gKi9cbmZ1bmN0aW9uIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gIHNlc3Npb24uZGlzY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpO1xufVxuXG4vKipcbiAqIFJlbmRlcnMgYSBzdHJlYW0gbWVzc2FnZSB0byB0aGUgbWFpbiBzZXNzaW9uIGJ5IGFwcGVuZGluZyBpdCB0byB0aGVcbiAqIGN1cnJlbnQgZG9jdW1lbnQuXG4gKlxuICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSB0byByZW5kZXJcbiAqL1xuZnVuY3Rpb24gcmVuZGVyU3RyZWFtTWVzc2FnZShtZXNzYWdlKSB7XG4gIHNlc3Npb24ucmVuZGVyU3RyZWFtTWVzc2FnZShtZXNzYWdlKTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGFsbCBlbnRyaWVzIGZyb20gdGhlIFR1cmJvIERyaXZlIHBhZ2UgY2FjaGUuXG4gKiBDYWxsIHRoaXMgd2hlbiBzdGF0ZSBoYXMgY2hhbmdlZCBvbiB0aGUgc2VydmVyIHRoYXQgbWF5IGFmZmVjdCBjYWNoZWQgcGFnZXMuXG4gKlxuICogQGRlcHJlY2F0ZWQgc2luY2UgdmVyc2lvbiA3LjIuMCBpbiBmYXZvciBvZiBgVHVyYm8uY2FjaGUuY2xlYXIoKWBcbiAqL1xuZnVuY3Rpb24gY2xlYXJDYWNoZSgpIHtcbiAgY29uc29sZS53YXJuKFxuICAgIFwiUGxlYXNlIHJlcGxhY2UgYFR1cmJvLmNsZWFyQ2FjaGUoKWAgd2l0aCBgVHVyYm8uY2FjaGUuY2xlYXIoKWAuIFRoZSB0b3AtbGV2ZWwgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgVHVyYm8uYFwiXG4gICk7XG4gIHNlc3Npb24uY2xlYXJDYWNoZSgpO1xufVxuXG4vKipcbiAqIFNldHMgdGhlIGRlbGF5IGFmdGVyIHdoaWNoIHRoZSBwcm9ncmVzcyBiYXIgd2lsbCBhcHBlYXIgZHVyaW5nIG5hdmlnYXRpb24uXG4gKlxuICogVGhlIHByb2dyZXNzIGJhciBhcHBlYXJzIGFmdGVyIDUwMG1zIGJ5IGRlZmF1bHQuXG4gKlxuICogTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGhhcyBubyBlZmZlY3Qgd2hlbiB1c2VkIHdpdGggdGhlIGlPUyBvciBBbmRyb2lkXG4gKiBhZGFwdGVycy5cbiAqXG4gKiBAcGFyYW0gZGVsYXkgVGltZSB0byBkZWxheSBpbiBtaWxsaXNlY29uZHNcbiAqL1xuZnVuY3Rpb24gc2V0UHJvZ3Jlc3NCYXJEZWxheShkZWxheSkge1xuICBzZXNzaW9uLnNldFByb2dyZXNzQmFyRGVsYXkoZGVsYXkpO1xufVxuXG5mdW5jdGlvbiBzZXRDb25maXJtTWV0aG9kKGNvbmZpcm1NZXRob2QpIHtcbiAgRm9ybVN1Ym1pc3Npb24uY29uZmlybU1ldGhvZCA9IGNvbmZpcm1NZXRob2Q7XG59XG5cbmZ1bmN0aW9uIHNldEZvcm1Nb2RlKG1vZGUpIHtcbiAgc2Vzc2lvbi5zZXRGb3JtTW9kZShtb2RlKTtcbn1cblxudmFyIFR1cmJvID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIG5hdmlnYXRvcjogbmF2aWdhdG9yJDEsXG4gIHNlc3Npb246IHNlc3Npb24sXG4gIGNhY2hlOiBjYWNoZSxcbiAgUGFnZVJlbmRlcmVyOiBQYWdlUmVuZGVyZXIsXG4gIFBhZ2VTbmFwc2hvdDogUGFnZVNuYXBzaG90LFxuICBGcmFtZVJlbmRlcmVyOiBGcmFtZVJlbmRlcmVyLFxuICBmZXRjaDogZmV0Y2hXaXRoVHVyYm9IZWFkZXJzLFxuICBzdGFydDogc3RhcnQsXG4gIHJlZ2lzdGVyQWRhcHRlcjogcmVnaXN0ZXJBZGFwdGVyLFxuICB2aXNpdDogdmlzaXQsXG4gIGNvbm5lY3RTdHJlYW1Tb3VyY2U6IGNvbm5lY3RTdHJlYW1Tb3VyY2UsXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2U6IGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2UsXG4gIHJlbmRlclN0cmVhbU1lc3NhZ2U6IHJlbmRlclN0cmVhbU1lc3NhZ2UsXG4gIGNsZWFyQ2FjaGU6IGNsZWFyQ2FjaGUsXG4gIHNldFByb2dyZXNzQmFyRGVsYXk6IHNldFByb2dyZXNzQmFyRGVsYXksXG4gIHNldENvbmZpcm1NZXRob2Q6IHNldENvbmZpcm1NZXRob2QsXG4gIHNldEZvcm1Nb2RlOiBzZXRGb3JtTW9kZVxufSk7XG5cbmNsYXNzIFR1cmJvRnJhbWVNaXNzaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7fVxuXG5jbGFzcyBGcmFtZUNvbnRyb2xsZXIge1xuICBmZXRjaFJlc3BvbnNlTG9hZGVkID0gKF9mZXRjaFJlc3BvbnNlKSA9PiBQcm9taXNlLnJlc29sdmUoKVxuICAjY3VycmVudEZldGNoUmVxdWVzdCA9IG51bGxcbiAgI3Jlc29sdmVWaXNpdFByb21pc2UgPSAoKSA9PiB7fVxuICAjY29ubmVjdGVkID0gZmFsc2VcbiAgI2hhc0JlZW5Mb2FkZWQgPSBmYWxzZVxuICAjaWdub3JlZEF0dHJpYnV0ZXMgPSBuZXcgU2V0KClcbiAgYWN0aW9uID0gbnVsbFxuXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMudmlldyA9IG5ldyBGcmFtZVZpZXcodGhpcywgdGhpcy5lbGVtZW50KTtcbiAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlciA9IG5ldyBBcHBlYXJhbmNlT2JzZXJ2ZXIodGhpcywgdGhpcy5lbGVtZW50KTtcbiAgICB0aGlzLmZvcm1MaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBGb3JtTGlua0NsaWNrT2JzZXJ2ZXIodGhpcywgdGhpcy5lbGVtZW50KTtcbiAgICB0aGlzLmxpbmtJbnRlcmNlcHRvciA9IG5ldyBMaW5rSW50ZXJjZXB0b3IodGhpcywgdGhpcy5lbGVtZW50KTtcbiAgICB0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllciA9IHV1aWQoKTtcbiAgICB0aGlzLmZvcm1TdWJtaXRPYnNlcnZlciA9IG5ldyBGb3JtU3VibWl0T2JzZXJ2ZXIodGhpcywgdGhpcy5lbGVtZW50KTtcbiAgfVxuXG4gIC8vIEZyYW1lIGRlbGVnYXRlXG5cbiAgY29ubmVjdCgpIHtcbiAgICBpZiAoIXRoaXMuI2Nvbm5lY3RlZCkge1xuICAgICAgdGhpcy4jY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgIGlmICh0aGlzLmxvYWRpbmdTdHlsZSA9PSBGcmFtZUxvYWRpbmdTdHlsZS5sYXp5KSB7XG4gICAgICAgIHRoaXMuYXBwZWFyYW5jZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLiNsb2FkU291cmNlVVJMKCk7XG4gICAgICB9XG4gICAgICB0aGlzLmZvcm1MaW5rQ2xpY2tPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RhcnQoKTtcbiAgICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICB9XG5cbiAgZGlzY29ubmVjdCgpIHtcbiAgICBpZiAodGhpcy4jY29ubmVjdGVkKSB7XG4gICAgICB0aGlzLiNjb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuYXBwZWFyYW5jZU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0b3AoKTtcbiAgICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gIH1cblxuICBkaXNhYmxlZENoYW5nZWQoKSB7XG4gICAgaWYgKHRoaXMubG9hZGluZ1N0eWxlID09IEZyYW1lTG9hZGluZ1N0eWxlLmVhZ2VyKSB7XG4gICAgICB0aGlzLiNsb2FkU291cmNlVVJMKCk7XG4gICAgfVxuICB9XG5cbiAgc291cmNlVVJMQ2hhbmdlZCgpIHtcbiAgICBpZiAodGhpcy4jaXNJZ25vcmluZ0NoYW5nZXNUbyhcInNyY1wiKSkgcmV0dXJuXG5cbiAgICBpZiAodGhpcy5lbGVtZW50LmlzQ29ubmVjdGVkKSB7XG4gICAgICB0aGlzLmNvbXBsZXRlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubG9hZGluZ1N0eWxlID09IEZyYW1lTG9hZGluZ1N0eWxlLmVhZ2VyIHx8IHRoaXMuI2hhc0JlZW5Mb2FkZWQpIHtcbiAgICAgIHRoaXMuI2xvYWRTb3VyY2VVUkwoKTtcbiAgICB9XG4gIH1cblxuICBzb3VyY2VVUkxSZWxvYWRlZCgpIHtcbiAgICBjb25zdCB7IHNyYyB9ID0gdGhpcy5lbGVtZW50O1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKTtcbiAgICB0aGlzLmVsZW1lbnQuc3JjID0gbnVsbDtcbiAgICB0aGlzLmVsZW1lbnQuc3JjID0gc3JjO1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQubG9hZGVkXG4gIH1cblxuICBsb2FkaW5nU3R5bGVDaGFuZ2VkKCkge1xuICAgIGlmICh0aGlzLmxvYWRpbmdTdHlsZSA9PSBGcmFtZUxvYWRpbmdTdHlsZS5sYXp5KSB7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLiNsb2FkU291cmNlVVJMKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgI2xvYWRTb3VyY2VVUkwoKSB7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmlzQWN0aXZlICYmICF0aGlzLmNvbXBsZXRlICYmIHRoaXMuc291cmNlVVJMKSB7XG4gICAgICB0aGlzLmVsZW1lbnQubG9hZGVkID0gdGhpcy4jdmlzaXQoZXhwYW5kVVJMKHRoaXMuc291cmNlVVJMKSk7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdG9wKCk7XG4gICAgICBhd2FpdCB0aGlzLmVsZW1lbnQubG9hZGVkO1xuICAgICAgdGhpcy4jaGFzQmVlbkxvYWRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZFJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICBpZiAoZmV0Y2hSZXNwb25zZS5yZWRpcmVjdGVkIHx8IChmZXRjaFJlc3BvbnNlLnN1Y2NlZWRlZCAmJiBmZXRjaFJlc3BvbnNlLmlzSFRNTCkpIHtcbiAgICAgIHRoaXMuc291cmNlVVJMID0gZmV0Y2hSZXNwb25zZS5yZXNwb25zZS51cmw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcbiAgICAgIGlmIChodG1sKSB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gcGFyc2VIVE1MRG9jdW1lbnQoaHRtbCk7XG4gICAgICAgIGNvbnN0IHBhZ2VTbmFwc2hvdCA9IFBhZ2VTbmFwc2hvdC5mcm9tRG9jdW1lbnQoZG9jdW1lbnQpO1xuXG4gICAgICAgIGlmIChwYWdlU25hcHNob3QuaXNWaXNpdGFibGUpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLiNsb2FkRnJhbWVSZXNwb25zZShmZXRjaFJlc3BvbnNlLCBkb2N1bWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy4jaGFuZGxlVW52aXNpdGFibGVGcmFtZVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZmV0Y2hSZXNwb25zZUxvYWRlZCA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFwcGVhcmFuY2Ugb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBlbGVtZW50QXBwZWFyZWRJblZpZXdwb3J0KGVsZW1lbnQpIHtcbiAgICB0aGlzLnByb3Bvc2VWaXNpdElmTmF2aWdhdGVkV2l0aEFjdGlvbihlbGVtZW50LCBnZXRWaXNpdEFjdGlvbihlbGVtZW50KSk7XG4gICAgdGhpcy4jbG9hZFNvdXJjZVVSTCgpO1xuICB9XG5cbiAgLy8gRm9ybSBsaW5rIGNsaWNrIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgd2lsbFN1Ym1pdEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuI3Nob3VsZEludGVyY2VwdE5hdmlnYXRpb24obGluaylcbiAgfVxuXG4gIHN1Ym1pdHRlZEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rLCBfbG9jYXRpb24sIGZvcm0pIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQobGluayk7XG4gICAgaWYgKGZyYW1lKSBmb3JtLnNldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgZnJhbWUuaWQpO1xuICB9XG5cbiAgLy8gTGluayBpbnRlcmNlcHRvciBkZWxlZ2F0ZVxuXG4gIHNob3VsZEludGVyY2VwdExpbmtDbGljayhlbGVtZW50LCBfbG9jYXRpb24sIF9ldmVudCkge1xuICAgIHJldHVybiB0aGlzLiNzaG91bGRJbnRlcmNlcHROYXZpZ2F0aW9uKGVsZW1lbnQpXG4gIH1cblxuICBsaW5rQ2xpY2tJbnRlcmNlcHRlZChlbGVtZW50LCBsb2NhdGlvbikge1xuICAgIHRoaXMuI25hdmlnYXRlRnJhbWUoZWxlbWVudCwgbG9jYXRpb24pO1xuICB9XG5cbiAgLy8gRm9ybSBzdWJtaXQgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybShlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KFwidHVyYm8tZnJhbWVcIikgPT0gdGhpcy5lbGVtZW50ICYmIHRoaXMuI3Nob3VsZEludGVyY2VwdE5hdmlnYXRpb24oZWxlbWVudCwgc3VibWl0dGVyKVxuICB9XG5cbiAgZm9ybVN1Ym1pdHRlZChlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBpZiAodGhpcy5mb3JtU3VibWlzc2lvbikge1xuICAgICAgdGhpcy5mb3JtU3VibWlzc2lvbi5zdG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy5mb3JtU3VibWlzc2lvbiA9IG5ldyBGb3JtU3VibWlzc2lvbih0aGlzLCBlbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IHsgZmV0Y2hSZXF1ZXN0IH0gPSB0aGlzLmZvcm1TdWJtaXNzaW9uO1xuICAgIHRoaXMucHJlcGFyZVJlcXVlc3QoZmV0Y2hSZXF1ZXN0KTtcbiAgICB0aGlzLmZvcm1TdWJtaXNzaW9uLnN0YXJ0KCk7XG4gIH1cblxuICAvLyBGZXRjaCByZXF1ZXN0IGRlbGVnYXRlXG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJlcXVlc3QuaGVhZGVyc1tcIlR1cmJvLUZyYW1lXCJdID0gdGhpcy5pZDtcblxuICAgIGlmICh0aGlzLmN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudD8uaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIikpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKF9yZXF1ZXN0KSB7XG4gICAgbWFya0FzQnVzeSh0aGlzLmVsZW1lbnQpO1xuICB9XG5cbiAgcmVxdWVzdFByZXZlbnRlZEhhbmRsaW5nUmVzcG9uc2UoX3JlcXVlc3QsIF9yZXNwb25zZSkge1xuICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKTtcbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRSZXNwb25zZShyZXNwb25zZSk7XG4gICAgdGhpcy4jcmVzb2x2ZVZpc2l0UHJvbWlzZSgpO1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdEZhaWxlZFdpdGhSZXNwb25zZShyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGF3YWl0IHRoaXMubG9hZFJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlKCk7XG4gIH1cblxuICByZXF1ZXN0RXJyb3JlZChyZXF1ZXN0LCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKTtcbiAgfVxuXG4gIHJlcXVlc3RGaW5pc2hlZChfcmVxdWVzdCkge1xuICAgIGNsZWFyQnVzeVN0YXRlKHRoaXMuZWxlbWVudCk7XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pc3Npb24gZGVsZWdhdGVcblxuICBmb3JtU3VibWlzc2lvblN0YXJ0ZWQoeyBmb3JtRWxlbWVudCB9KSB7XG4gICAgbWFya0FzQnVzeShmb3JtRWxlbWVudCwgdGhpcy4jZmluZEZyYW1lRWxlbWVudChmb3JtRWxlbWVudCkpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIHJlc3BvbnNlKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGZvcm1TdWJtaXNzaW9uLmZvcm1FbGVtZW50LCBmb3JtU3VibWlzc2lvbi5zdWJtaXR0ZXIpO1xuXG4gICAgZnJhbWUuZGVsZWdhdGUucHJvcG9zZVZpc2l0SWZOYXZpZ2F0ZWRXaXRoQWN0aW9uKGZyYW1lLCBnZXRWaXNpdEFjdGlvbihmb3JtU3VibWlzc2lvbi5zdWJtaXR0ZXIsIGZvcm1TdWJtaXNzaW9uLmZvcm1FbGVtZW50LCBmcmFtZSkpO1xuICAgIGZyYW1lLmRlbGVnYXRlLmxvYWRSZXNwb25zZShyZXNwb25zZSk7XG5cbiAgICBpZiAoIWZvcm1TdWJtaXNzaW9uLmlzU2FmZSkge1xuICAgICAgc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG4gICAgfVxuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICB0aGlzLmVsZW1lbnQuZGVsZWdhdGUubG9hZFJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgIHNlc3Npb24uY2xlYXJDYWNoZSgpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25FcnJvcmVkKGZvcm1TdWJtaXNzaW9uLCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GaW5pc2hlZCh7IGZvcm1FbGVtZW50IH0pIHtcbiAgICBjbGVhckJ1c3lTdGF0ZShmb3JtRWxlbWVudCwgdGhpcy4jZmluZEZyYW1lRWxlbWVudChmb3JtRWxlbWVudCkpO1xuICB9XG5cbiAgLy8gVmlldyBkZWxlZ2F0ZVxuXG4gIGFsbG93c0ltbWVkaWF0ZVJlbmRlcih7IGVsZW1lbnQ6IG5ld0ZyYW1lIH0sIG9wdGlvbnMpIHtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZyYW1lLXJlbmRlclwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMuZWxlbWVudCxcbiAgICAgIGRldGFpbDogeyBuZXdGcmFtZSwgLi4ub3B0aW9ucyB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIGNvbnN0IHtcbiAgICAgIGRlZmF1bHRQcmV2ZW50ZWQsXG4gICAgICBkZXRhaWw6IHsgcmVuZGVyIH1cbiAgICB9ID0gZXZlbnQ7XG5cbiAgICBpZiAodGhpcy52aWV3LnJlbmRlcmVyICYmIHJlbmRlcikge1xuICAgICAgdGhpcy52aWV3LnJlbmRlcmVyLnJlbmRlckVsZW1lbnQgPSByZW5kZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuICFkZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICB2aWV3UmVuZGVyZWRTbmFwc2hvdChfc25hcHNob3QsIF9pc1ByZXZpZXcsIF9yZW5kZXJNZXRob2QpIHt9XG5cbiAgcHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhlbGVtZW50KSB7XG4gICAgc2Vzc2lvbi5wcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KGVsZW1lbnQpO1xuICB9XG5cbiAgdmlld0ludmFsaWRhdGVkKCkge31cblxuICAvLyBGcmFtZSByZW5kZXJlciBkZWxlZ2F0ZVxuXG4gIHdpbGxSZW5kZXJGcmFtZShjdXJyZW50RWxlbWVudCwgX25ld0VsZW1lbnQpIHtcbiAgICB0aGlzLnByZXZpb3VzRnJhbWVFbGVtZW50ID0gY3VycmVudEVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgdmlzaXRDYWNoZWRTbmFwc2hvdCA9ICh7IGVsZW1lbnQgfSkgPT4ge1xuICAgIGNvbnN0IGZyYW1lID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgdGhpcy5lbGVtZW50LmlkKTtcblxuICAgIGlmIChmcmFtZSAmJiB0aGlzLnByZXZpb3VzRnJhbWVFbGVtZW50KSB7XG4gICAgICBmcmFtZS5yZXBsYWNlQ2hpbGRyZW4oLi4udGhpcy5wcmV2aW91c0ZyYW1lRWxlbWVudC5jaGlsZHJlbik7XG4gICAgfVxuXG4gICAgZGVsZXRlIHRoaXMucHJldmlvdXNGcmFtZUVsZW1lbnQ7XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgYXN5bmMgI2xvYWRGcmFtZVJlc3BvbnNlKGZldGNoUmVzcG9uc2UsIGRvY3VtZW50KSB7XG4gICAgY29uc3QgbmV3RnJhbWVFbGVtZW50ID0gYXdhaXQgdGhpcy5leHRyYWN0Rm9yZWlnbkZyYW1lRWxlbWVudChkb2N1bWVudC5ib2R5KTtcblxuICAgIGlmIChuZXdGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gbmV3IFNuYXBzaG90KG5ld0ZyYW1lRWxlbWVudCk7XG4gICAgICBjb25zdCByZW5kZXJlciA9IG5ldyBGcmFtZVJlbmRlcmVyKHRoaXMsIHRoaXMudmlldy5zbmFwc2hvdCwgc25hcHNob3QsIEZyYW1lUmVuZGVyZXIucmVuZGVyRWxlbWVudCwgZmFsc2UsIGZhbHNlKTtcbiAgICAgIGlmICh0aGlzLnZpZXcucmVuZGVyUHJvbWlzZSkgYXdhaXQgdGhpcy52aWV3LnJlbmRlclByb21pc2U7XG4gICAgICB0aGlzLmNoYW5nZUhpc3RvcnkoKTtcblxuICAgICAgYXdhaXQgdGhpcy52aWV3LnJlbmRlcihyZW5kZXJlcik7XG4gICAgICB0aGlzLmNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgIHNlc3Npb24uZnJhbWVSZW5kZXJlZChmZXRjaFJlc3BvbnNlLCB0aGlzLmVsZW1lbnQpO1xuICAgICAgc2Vzc2lvbi5mcmFtZUxvYWRlZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgYXdhaXQgdGhpcy5mZXRjaFJlc3BvbnNlTG9hZGVkKGZldGNoUmVzcG9uc2UpO1xuICAgIH0gZWxzZSBpZiAodGhpcy4jd2lsbEhhbmRsZUZyYW1lTWlzc2luZ0Zyb21SZXNwb25zZShmZXRjaFJlc3BvbnNlKSkge1xuICAgICAgdGhpcy4jaGFuZGxlRnJhbWVNaXNzaW5nRnJvbVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jICN2aXNpdCh1cmwpIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gbmV3IEZldGNoUmVxdWVzdCh0aGlzLCBGZXRjaE1ldGhvZC5nZXQsIHVybCwgbmV3IFVSTFNlYXJjaFBhcmFtcygpLCB0aGlzLmVsZW1lbnQpO1xuXG4gICAgdGhpcy4jY3VycmVudEZldGNoUmVxdWVzdD8uY2FuY2VsKCk7XG4gICAgdGhpcy4jY3VycmVudEZldGNoUmVxdWVzdCA9IHJlcXVlc3Q7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UgPSAoKSA9PiB7fTtcbiAgICAgICAgdGhpcy4jY3VycmVudEZldGNoUmVxdWVzdCA9IG51bGw7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH07XG4gICAgICByZXF1ZXN0LnBlcmZvcm0oKTtcbiAgICB9KVxuICB9XG5cbiAgI25hdmlnYXRlRnJhbWUoZWxlbWVudCwgdXJsLCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKTtcblxuICAgIGZyYW1lLmRlbGVnYXRlLnByb3Bvc2VWaXNpdElmTmF2aWdhdGVkV2l0aEFjdGlvbihmcmFtZSwgZ2V0VmlzaXRBY3Rpb24oc3VibWl0dGVyLCBlbGVtZW50LCBmcmFtZSkpO1xuXG4gICAgdGhpcy4jd2l0aEN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudChlbGVtZW50LCAoKSA9PiB7XG4gICAgICBmcmFtZS5zcmMgPSB1cmw7XG4gICAgfSk7XG4gIH1cblxuICBwcm9wb3NlVmlzaXRJZk5hdmlnYXRlZFdpdGhBY3Rpb24oZnJhbWUsIGFjdGlvbiA9IG51bGwpIHtcbiAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcblxuICAgIGlmICh0aGlzLmFjdGlvbikge1xuICAgICAgY29uc3QgcGFnZVNuYXBzaG90ID0gUGFnZVNuYXBzaG90LmZyb21FbGVtZW50KGZyYW1lKS5jbG9uZSgpO1xuICAgICAgY29uc3QgeyB2aXNpdENhY2hlZFNuYXBzaG90IH0gPSBmcmFtZS5kZWxlZ2F0ZTtcblxuICAgICAgZnJhbWUuZGVsZWdhdGUuZmV0Y2hSZXNwb25zZUxvYWRlZCA9IGFzeW5jIChmZXRjaFJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGlmIChmcmFtZS5zcmMpIHtcbiAgICAgICAgICBjb25zdCB7IHN0YXR1c0NvZGUsIHJlZGlyZWN0ZWQgfSA9IGZldGNoUmVzcG9uc2U7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2VIVE1MID0gYXdhaXQgZmV0Y2hSZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7IHN0YXR1c0NvZGUsIHJlZGlyZWN0ZWQsIHJlc3BvbnNlSFRNTCB9O1xuICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICByZXNwb25zZSxcbiAgICAgICAgICAgIHZpc2l0Q2FjaGVkU25hcHNob3QsXG4gICAgICAgICAgICB3aWxsUmVuZGVyOiBmYWxzZSxcbiAgICAgICAgICAgIHVwZGF0ZUhpc3Rvcnk6IGZhbHNlLFxuICAgICAgICAgICAgcmVzdG9yYXRpb25JZGVudGlmaWVyOiB0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllcixcbiAgICAgICAgICAgIHNuYXBzaG90OiBwYWdlU25hcHNob3RcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgaWYgKHRoaXMuYWN0aW9uKSBvcHRpb25zLmFjdGlvbiA9IHRoaXMuYWN0aW9uO1xuXG4gICAgICAgICAgc2Vzc2lvbi52aXNpdChmcmFtZS5zcmMsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGNoYW5nZUhpc3RvcnkoKSB7XG4gICAgaWYgKHRoaXMuYWN0aW9uKSB7XG4gICAgICBjb25zdCBtZXRob2QgPSBnZXRIaXN0b3J5TWV0aG9kRm9yQWN0aW9uKHRoaXMuYWN0aW9uKTtcbiAgICAgIHNlc3Npb24uaGlzdG9yeS51cGRhdGUobWV0aG9kLCBleHBhbmRVUkwodGhpcy5lbGVtZW50LnNyYyB8fCBcIlwiKSwgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jICNoYW5kbGVVbnZpc2l0YWJsZUZyYW1lUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIGBUaGUgcmVzcG9uc2UgKCR7ZmV0Y2hSZXNwb25zZS5zdGF0dXNDb2RlfSkgZnJvbSA8dHVyYm8tZnJhbWUgaWQ9XCIke3RoaXMuZWxlbWVudC5pZH1cIj4gaXMgcGVyZm9ybWluZyBhIGZ1bGwgcGFnZSB2aXNpdCBkdWUgdG8gdHVyYm8tdmlzaXQtY29udHJvbC5gXG4gICAgKTtcblxuICAgIGF3YWl0IHRoaXMuI3Zpc2l0UmVzcG9uc2UoZmV0Y2hSZXNwb25zZS5yZXNwb25zZSk7XG4gIH1cblxuICAjd2lsbEhhbmRsZUZyYW1lTWlzc2luZ0Zyb21SZXNwb25zZShmZXRjaFJlc3BvbnNlKSB7XG4gICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcImNvbXBsZXRlXCIsIFwiXCIpO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlO1xuICAgIGNvbnN0IHZpc2l0ID0gYXN5bmMgKHVybCwgb3B0aW9ucykgPT4ge1xuICAgICAgaWYgKHVybCBpbnN0YW5jZW9mIFJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuI3Zpc2l0UmVzcG9uc2UodXJsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlc3Npb24udmlzaXQodXJsLCBvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgZXZlbnQgPSBkaXNwYXRjaChcInR1cmJvOmZyYW1lLW1pc3NpbmdcIiwge1xuICAgICAgdGFyZ2V0OiB0aGlzLmVsZW1lbnQsXG4gICAgICBkZXRhaWw6IHsgcmVzcG9uc2UsIHZpc2l0IH0sXG4gICAgICBjYW5jZWxhYmxlOiB0cnVlXG4gICAgfSk7XG5cbiAgICByZXR1cm4gIWV2ZW50LmRlZmF1bHRQcmV2ZW50ZWRcbiAgfVxuXG4gICNoYW5kbGVGcmFtZU1pc3NpbmdGcm9tUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSkge1xuICAgIHRoaXMudmlldy5taXNzaW5nKCk7XG4gICAgdGhpcy4jdGhyb3dGcmFtZU1pc3NpbmdFcnJvcihmZXRjaFJlc3BvbnNlKTtcbiAgfVxuXG4gICN0aHJvd0ZyYW1lTWlzc2luZ0Vycm9yKGZldGNoUmVzcG9uc2UpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gYFRoZSByZXNwb25zZSAoJHtmZXRjaFJlc3BvbnNlLnN0YXR1c0NvZGV9KSBkaWQgbm90IGNvbnRhaW4gdGhlIGV4cGVjdGVkIDx0dXJiby1mcmFtZSBpZD1cIiR7dGhpcy5lbGVtZW50LmlkfVwiPiBhbmQgd2lsbCBiZSBpZ25vcmVkLiBUbyBwZXJmb3JtIGEgZnVsbCBwYWdlIHZpc2l0IGluc3RlYWQsIHNldCB0dXJiby12aXNpdC1jb250cm9sIHRvIHJlbG9hZC5gO1xuICAgIHRocm93IG5ldyBUdXJib0ZyYW1lTWlzc2luZ0Vycm9yKG1lc3NhZ2UpXG4gIH1cblxuICBhc3luYyAjdmlzaXRSZXNwb25zZShyZXNwb25zZSkge1xuICAgIGNvbnN0IHdyYXBwZWQgPSBuZXcgRmV0Y2hSZXNwb25zZShyZXNwb25zZSk7XG4gICAgY29uc3QgcmVzcG9uc2VIVE1MID0gYXdhaXQgd3JhcHBlZC5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyBsb2NhdGlvbiwgcmVkaXJlY3RlZCwgc3RhdHVzQ29kZSB9ID0gd3JhcHBlZDtcblxuICAgIHJldHVybiBzZXNzaW9uLnZpc2l0KGxvY2F0aW9uLCB7IHJlc3BvbnNlOiB7IHJlZGlyZWN0ZWQsIHN0YXR1c0NvZGUsIHJlc3BvbnNlSFRNTCB9IH0pXG4gIH1cblxuICAjZmluZEZyYW1lRWxlbWVudChlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBpZCA9IGdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgc3VibWl0dGVyLCBlbGVtZW50KSB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidGFyZ2V0XCIpO1xuICAgIHJldHVybiBnZXRGcmFtZUVsZW1lbnRCeUlkKGlkKSA/PyB0aGlzLmVsZW1lbnRcbiAgfVxuXG4gIGFzeW5jIGV4dHJhY3RGb3JlaWduRnJhbWVFbGVtZW50KGNvbnRhaW5lcikge1xuICAgIGxldCBlbGVtZW50O1xuICAgIGNvbnN0IGlkID0gQ1NTLmVzY2FwZSh0aGlzLmlkKTtcblxuICAgIHRyeSB7XG4gICAgICBlbGVtZW50ID0gYWN0aXZhdGVFbGVtZW50KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGB0dXJiby1mcmFtZSMke2lkfWApLCB0aGlzLnNvdXJjZVVSTCk7XG4gICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZWxlbWVudFxuICAgICAgfVxuXG4gICAgICBlbGVtZW50ID0gYWN0aXZhdGVFbGVtZW50KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGB0dXJiby1mcmFtZVtzcmNdW3JlY3Vyc2V+PSR7aWR9XWApLCB0aGlzLnNvdXJjZVVSTCk7XG4gICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICBhd2FpdCBlbGVtZW50LmxvYWRlZDtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXh0cmFjdEZvcmVpZ25GcmFtZUVsZW1lbnQoZWxlbWVudClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gbmV3IEZyYW1lRWxlbWVudCgpXG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gICNmb3JtQWN0aW9uSXNWaXNpdGFibGUoZm9ybSwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgYWN0aW9uID0gZ2V0QWN0aW9uJDEoZm9ybSwgc3VibWl0dGVyKTtcblxuICAgIHJldHVybiBsb2NhdGlvbklzVmlzaXRhYmxlKGV4cGFuZFVSTChhY3Rpb24pLCB0aGlzLnJvb3RMb2NhdGlvbilcbiAgfVxuXG4gICNzaG91bGRJbnRlcmNlcHROYXZpZ2F0aW9uKGVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGlkID0gZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiLCBzdWJtaXR0ZXIsIGVsZW1lbnQpIHx8IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIik7XG5cbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCAmJiAhdGhpcy4jZm9ybUFjdGlvbklzVmlzaXRhYmxlKGVsZW1lbnQsIHN1Ym1pdHRlcikpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmICghdGhpcy5lbmFibGVkIHx8IGlkID09IFwiX3RvcFwiKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoaWQpIHtcbiAgICAgIGNvbnN0IGZyYW1lRWxlbWVudCA9IGdldEZyYW1lRWxlbWVudEJ5SWQoaWQpO1xuICAgICAgaWYgKGZyYW1lRWxlbWVudCkge1xuICAgICAgICByZXR1cm4gIWZyYW1lRWxlbWVudC5kaXNhYmxlZFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghc2Vzc2lvbi5lbGVtZW50SXNOYXZpZ2F0YWJsZShlbGVtZW50KSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKHN1Ym1pdHRlciAmJiAhc2Vzc2lvbi5lbGVtZW50SXNOYXZpZ2F0YWJsZShzdWJtaXR0ZXIpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgLy8gQ29tcHV0ZWQgcHJvcGVydGllc1xuXG4gIGdldCBpZCgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LmlkXG4gIH1cblxuICBnZXQgZW5hYmxlZCgpIHtcbiAgICByZXR1cm4gIXRoaXMuZWxlbWVudC5kaXNhYmxlZFxuICB9XG5cbiAgZ2V0IHNvdXJjZVVSTCgpIHtcbiAgICBpZiAodGhpcy5lbGVtZW50LnNyYykge1xuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5zcmNcbiAgICB9XG4gIH1cblxuICBzZXQgc291cmNlVVJMKHNvdXJjZVVSTCkge1xuICAgIHRoaXMuI2lnbm9yaW5nQ2hhbmdlc1RvQXR0cmlidXRlKFwic3JjXCIsICgpID0+IHtcbiAgICAgIHRoaXMuZWxlbWVudC5zcmMgPSBzb3VyY2VVUkwgPz8gbnVsbDtcbiAgICB9KTtcbiAgfVxuXG4gIGdldCBsb2FkaW5nU3R5bGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5sb2FkaW5nXG4gIH1cblxuICBnZXQgaXNMb2FkaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmZvcm1TdWJtaXNzaW9uICE9PSB1bmRlZmluZWQgfHwgdGhpcy4jcmVzb2x2ZVZpc2l0UHJvbWlzZSgpICE9PSB1bmRlZmluZWRcbiAgfVxuXG4gIGdldCBjb21wbGV0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50Lmhhc0F0dHJpYnV0ZShcImNvbXBsZXRlXCIpXG4gIH1cblxuICBzZXQgY29tcGxldGUodmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiLCBcIlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImNvbXBsZXRlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBpc0FjdGl2ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LmlzQWN0aXZlICYmIHRoaXMuI2Nvbm5lY3RlZFxuICB9XG5cbiAgZ2V0IHJvb3RMb2NhdGlvbigpIHtcbiAgICBjb25zdCBtZXRhID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbWV0YVtuYW1lPVwidHVyYm8tcm9vdFwiXWApO1xuICAgIGNvbnN0IHJvb3QgPSBtZXRhPy5jb250ZW50ID8/IFwiL1wiO1xuICAgIHJldHVybiBleHBhbmRVUkwocm9vdClcbiAgfVxuXG4gICNpc0lnbm9yaW5nQ2hhbmdlc1RvKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy4jaWdub3JlZEF0dHJpYnV0ZXMuaGFzKGF0dHJpYnV0ZU5hbWUpXG4gIH1cblxuICAjaWdub3JpbmdDaGFuZ2VzVG9BdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgY2FsbGJhY2spIHtcbiAgICB0aGlzLiNpZ25vcmVkQXR0cmlidXRlcy5hZGQoYXR0cmlidXRlTmFtZSk7XG4gICAgY2FsbGJhY2soKTtcbiAgICB0aGlzLiNpZ25vcmVkQXR0cmlidXRlcy5kZWxldGUoYXR0cmlidXRlTmFtZSk7XG4gIH1cblxuICAjd2l0aEN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudChlbGVtZW50LCBjYWxsYmFjaykge1xuICAgIHRoaXMuY3VycmVudE5hdmlnYXRpb25FbGVtZW50ID0gZWxlbWVudDtcbiAgICBjYWxsYmFjaygpO1xuICAgIGRlbGV0ZSB0aGlzLmN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudDtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRGcmFtZUVsZW1lbnRCeUlkKGlkKSB7XG4gIGlmIChpZCAhPSBudWxsKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEZyYW1lRWxlbWVudCkge1xuICAgICAgcmV0dXJuIGVsZW1lbnRcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gYWN0aXZhdGVFbGVtZW50KGVsZW1lbnQsIGN1cnJlbnRVUkwpIHtcbiAgaWYgKGVsZW1lbnQpIHtcbiAgICBjb25zdCBzcmMgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcInNyY1wiKTtcbiAgICBpZiAoc3JjICE9IG51bGwgJiYgY3VycmVudFVSTCAhPSBudWxsICYmIHVybHNBcmVFcXVhbChzcmMsIGN1cnJlbnRVUkwpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE1hdGNoaW5nIDx0dXJiby1mcmFtZSBpZD1cIiR7ZWxlbWVudC5pZH1cIj4gZWxlbWVudCBoYXMgYSBzb3VyY2UgVVJMIHdoaWNoIHJlZmVyZW5jZXMgaXRzZWxmYClcbiAgICB9XG4gICAgaWYgKGVsZW1lbnQub3duZXJEb2N1bWVudCAhPT0gZG9jdW1lbnQpIHtcbiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5pbXBvcnROb2RlKGVsZW1lbnQsIHRydWUpO1xuICAgIH1cblxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgRnJhbWVFbGVtZW50KSB7XG4gICAgICBlbGVtZW50LmNvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgICBlbGVtZW50LmRpc2Nvbm5lY3RlZENhbGxiYWNrKCk7XG4gICAgICByZXR1cm4gZWxlbWVudFxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBTdHJlYW1BY3Rpb25zID0ge1xuICBhZnRlcigpIHtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKGUpID0+IGUucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKHRoaXMudGVtcGxhdGVDb250ZW50LCBlLm5leHRTaWJsaW5nKSk7XG4gIH0sXG5cbiAgYXBwZW5kKCkge1xuICAgIHRoaXMucmVtb3ZlRHVwbGljYXRlVGFyZ2V0Q2hpbGRyZW4oKTtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKGUpID0+IGUuYXBwZW5kKHRoaXMudGVtcGxhdGVDb250ZW50KSk7XG4gIH0sXG5cbiAgYmVmb3JlKCkge1xuICAgIHRoaXMudGFyZ2V0RWxlbWVudHMuZm9yRWFjaCgoZSkgPT4gZS5wYXJlbnRFbGVtZW50Py5pbnNlcnRCZWZvcmUodGhpcy50ZW1wbGF0ZUNvbnRlbnQsIGUpKTtcbiAgfSxcblxuICBwcmVwZW5kKCkge1xuICAgIHRoaXMucmVtb3ZlRHVwbGljYXRlVGFyZ2V0Q2hpbGRyZW4oKTtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKGUpID0+IGUucHJlcGVuZCh0aGlzLnRlbXBsYXRlQ29udGVudCkpO1xuICB9LFxuXG4gIHJlbW92ZSgpIHtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKGUpID0+IGUucmVtb3ZlKCkpO1xuICB9LFxuXG4gIHJlcGxhY2UoKSB7XG4gICAgY29uc3QgbWV0aG9kID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIik7XG5cbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKHRhcmdldEVsZW1lbnQpID0+IHtcbiAgICAgIGlmIChtZXRob2QgPT09IFwibW9ycGhcIikge1xuICAgICAgICBtb3JwaEVsZW1lbnRzKHRhcmdldEVsZW1lbnQsIHRoaXMudGVtcGxhdGVDb250ZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldEVsZW1lbnQucmVwbGFjZVdpdGgodGhpcy50ZW1wbGF0ZUNvbnRlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIHVwZGF0ZSgpIHtcbiAgICBjb25zdCBtZXRob2QgPSB0aGlzLmdldEF0dHJpYnV0ZShcIm1ldGhvZFwiKTtcblxuICAgIHRoaXMudGFyZ2V0RWxlbWVudHMuZm9yRWFjaCgodGFyZ2V0RWxlbWVudCkgPT4ge1xuICAgICAgaWYgKG1ldGhvZCA9PT0gXCJtb3JwaFwiKSB7XG4gICAgICAgIG1vcnBoQ2hpbGRyZW4odGFyZ2V0RWxlbWVudCwgdGhpcy50ZW1wbGF0ZUNvbnRlbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGFyZ2V0RWxlbWVudC5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICB0YXJnZXRFbGVtZW50LmFwcGVuZCh0aGlzLnRlbXBsYXRlQ29udGVudCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgcmVmcmVzaCgpIHtcbiAgICBzZXNzaW9uLnJlZnJlc2godGhpcy5iYXNlVVJJLCB0aGlzLnJlcXVlc3RJZCk7XG4gIH1cbn07XG5cbi8vIDx0dXJiby1zdHJlYW0gYWN0aW9uPXJlcGxhY2UgdGFyZ2V0PWlkPjx0ZW1wbGF0ZT4uLi5cblxuLyoqXG4gKiBSZW5kZXJzIHVwZGF0ZXMgdG8gdGhlIHBhZ2UgZnJvbSBhIHN0cmVhbSBvZiBtZXNzYWdlcy5cbiAqXG4gKiBVc2luZyB0aGUgYGFjdGlvbmAgYXR0cmlidXRlLCB0aGlzIGNhbiBiZSBjb25maWd1cmVkIG9uZSBvZiBlaWdodCB3YXlzOlxuICpcbiAqIC0gYGFmdGVyYCAtIGluc2VydHMgdGhlIHJlc3VsdCBhZnRlciB0aGUgdGFyZ2V0XG4gKiAtIGBhcHBlbmRgIC0gYXBwZW5kcyB0aGUgcmVzdWx0IHRvIHRoZSB0YXJnZXRcbiAqIC0gYGJlZm9yZWAgLSBpbnNlcnRzIHRoZSByZXN1bHQgYmVmb3JlIHRoZSB0YXJnZXRcbiAqIC0gYHByZXBlbmRgIC0gcHJlcGVuZHMgdGhlIHJlc3VsdCB0byB0aGUgdGFyZ2V0XG4gKiAtIGByZWZyZXNoYCAtIGluaXRpYXRlcyBhIHBhZ2UgcmVmcmVzaFxuICogLSBgcmVtb3ZlYCAtIHJlbW92ZXMgdGhlIHRhcmdldFxuICogLSBgcmVwbGFjZWAgLSByZXBsYWNlcyB0aGUgb3V0ZXIgSFRNTCBvZiB0aGUgdGFyZ2V0XG4gKiAtIGB1cGRhdGVgIC0gcmVwbGFjZXMgdGhlIGlubmVyIEhUTUwgb2YgdGhlIHRhcmdldFxuICpcbiAqIEBjdXN0b21FbGVtZW50IHR1cmJvLXN0cmVhbVxuICogQGV4YW1wbGVcbiAqICAgPHR1cmJvLXN0cmVhbSBhY3Rpb249XCJhcHBlbmRcIiB0YXJnZXQ9XCJkb21faWRcIj5cbiAqICAgICA8dGVtcGxhdGU+XG4gKiAgICAgICBDb250ZW50IHRvIGFwcGVuZCB0byB0YXJnZXQgZGVzaWduYXRlZCB3aXRoIHRoZSBkb21faWQuXG4gKiAgICAgPC90ZW1wbGF0ZT5cbiAqICAgPC90dXJiby1zdHJlYW0+XG4gKi9cbmNsYXNzIFN0cmVhbUVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIHN0YXRpYyBhc3luYyByZW5kZXJFbGVtZW50KG5ld0VsZW1lbnQpIHtcbiAgICBhd2FpdCBuZXdFbGVtZW50LnBlcmZvcm1BY3Rpb24oKTtcbiAgfVxuXG4gIGFzeW5jIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVuZGVyKCkge1xuICAgIHJldHVybiAodGhpcy5yZW5kZXJQcm9taXNlID8/PSAoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXZlbnQgPSB0aGlzLmJlZm9yZVJlbmRlckV2ZW50O1xuXG4gICAgICBpZiAodGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KSkge1xuICAgICAgICBhd2FpdCBuZXh0UmVwYWludCgpO1xuICAgICAgICBhd2FpdCBldmVudC5kZXRhaWwucmVuZGVyKHRoaXMpO1xuICAgICAgfVxuICAgIH0pKCkpXG4gIH1cblxuICBkaXNjb25uZWN0KCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnJlbW92ZSgpO1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5XG4gICAgfSBjYXRjaCB7fVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgZHVwbGljYXRlIGNoaWxkcmVuIChieSBJRClcbiAgICovXG4gIHJlbW92ZUR1cGxpY2F0ZVRhcmdldENoaWxkcmVuKCkge1xuICAgIHRoaXMuZHVwbGljYXRlQ2hpbGRyZW4uZm9yRWFjaCgoYykgPT4gYy5yZW1vdmUoKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgbGlzdCBvZiBkdXBsaWNhdGUgY2hpbGRyZW4gKGkuZS4gdGhvc2Ugd2l0aCB0aGUgc2FtZSBJRClcbiAgICovXG4gIGdldCBkdXBsaWNhdGVDaGlsZHJlbigpIHtcbiAgICBjb25zdCBleGlzdGluZ0NoaWxkcmVuID0gdGhpcy50YXJnZXRFbGVtZW50cy5mbGF0TWFwKChlKSA9PiBbLi4uZS5jaGlsZHJlbl0pLmZpbHRlcigoYykgPT4gISFjLmlkKTtcbiAgICBjb25zdCBuZXdDaGlsZHJlbklkcyA9IFsuLi4odGhpcy50ZW1wbGF0ZUNvbnRlbnQ/LmNoaWxkcmVuIHx8IFtdKV0uZmlsdGVyKChjKSA9PiAhIWMuaWQpLm1hcCgoYykgPT4gYy5pZCk7XG5cbiAgICByZXR1cm4gZXhpc3RpbmdDaGlsZHJlbi5maWx0ZXIoKGMpID0+IG5ld0NoaWxkcmVuSWRzLmluY2x1ZGVzKGMuaWQpKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGFjdGlvbiBmdW5jdGlvbiB0byBiZSBwZXJmb3JtZWQuXG4gICAqL1xuICBnZXQgcGVyZm9ybUFjdGlvbigpIHtcbiAgICBpZiAodGhpcy5hY3Rpb24pIHtcbiAgICAgIGNvbnN0IGFjdGlvbkZ1bmN0aW9uID0gU3RyZWFtQWN0aW9uc1t0aGlzLmFjdGlvbl07XG4gICAgICBpZiAoYWN0aW9uRnVuY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIGFjdGlvbkZ1bmN0aW9uXG4gICAgICB9XG4gICAgICB0aGlzLiNyYWlzZShcInVua25vd24gYWN0aW9uXCIpO1xuICAgIH1cbiAgICB0aGlzLiNyYWlzZShcImFjdGlvbiBhdHRyaWJ1dGUgaXMgbWlzc2luZ1wiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB0YXJnZXQgZWxlbWVudHMgd2hpY2ggdGhlIHRlbXBsYXRlIHdpbGwgYmUgcmVuZGVyZWQgdG8uXG4gICAqL1xuICBnZXQgdGFyZ2V0RWxlbWVudHMoKSB7XG4gICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICByZXR1cm4gdGhpcy50YXJnZXRFbGVtZW50c0J5SWRcbiAgICB9IGVsc2UgaWYgKHRoaXMudGFyZ2V0cykge1xuICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0RWxlbWVudHNCeVF1ZXJ5XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuI3JhaXNlKFwidGFyZ2V0IG9yIHRhcmdldHMgYXR0cmlidXRlIGlzIG1pc3NpbmdcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGNvbnRlbnRzIG9mIHRoZSBtYWluIGA8dGVtcGxhdGU+YC5cbiAgICovXG4gIGdldCB0ZW1wbGF0ZUNvbnRlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpXG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgbWFpbiBgPHRlbXBsYXRlPmAgdXNlZCBmb3IgcmVuZGVyaW5nXG4gICAqL1xuICBnZXQgdGVtcGxhdGVFbGVtZW50KCkge1xuICAgIGlmICh0aGlzLmZpcnN0RWxlbWVudENoaWxkID09PSBudWxsKSB7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IHRoaXMub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGVtcGxhdGVcIik7XG4gICAgICB0aGlzLmFwcGVuZENoaWxkKHRlbXBsYXRlKTtcbiAgICAgIHJldHVybiB0ZW1wbGF0ZVxuICAgIH0gZWxzZSBpZiAodGhpcy5maXJzdEVsZW1lbnRDaGlsZCBpbnN0YW5jZW9mIEhUTUxUZW1wbGF0ZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpcnN0RWxlbWVudENoaWxkXG4gICAgfVxuICAgIHRoaXMuI3JhaXNlKFwiZmlyc3QgY2hpbGQgZWxlbWVudCBtdXN0IGJlIGEgPHRlbXBsYXRlPiBlbGVtZW50XCIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgYWN0aW9uLlxuICAgKi9cbiAgZ2V0IGFjdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIilcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IHRhcmdldCAoYW4gZWxlbWVudCBJRCkgdG8gd2hpY2ggdGhlIHJlc3VsdCB3aWxsXG4gICAqIGJlIHJlbmRlcmVkLlxuICAgKi9cbiAgZ2V0IHRhcmdldCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIilcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IFwidGFyZ2V0c1wiIHNlbGVjdG9yIChhIENTUyBzZWxlY3RvcilcbiAgICovXG4gIGdldCB0YXJnZXRzKCkge1xuICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZShcInRhcmdldHNcIilcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWFkcyB0aGUgcmVxdWVzdC1pZCBhdHRyaWJ1dGVcbiAgICovXG4gIGdldCByZXF1ZXN0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwicmVxdWVzdC1pZFwiKVxuICB9XG5cbiAgI3JhaXNlKG1lc3NhZ2UpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGhpcy5kZXNjcmlwdGlvbn06ICR7bWVzc2FnZX1gKVxuICB9XG5cbiAgZ2V0IGRlc2NyaXB0aW9uKCkge1xuICAgIHJldHVybiAodGhpcy5vdXRlckhUTUwubWF0Y2goLzxbXj5dKz4vKSA/PyBbXSlbMF0gPz8gXCI8dHVyYm8tc3RyZWFtPlwiXG4gIH1cblxuICBnZXQgYmVmb3JlUmVuZGVyRXZlbnQoKSB7XG4gICAgcmV0dXJuIG5ldyBDdXN0b21FdmVudChcInR1cmJvOmJlZm9yZS1zdHJlYW0tcmVuZGVyXCIsIHtcbiAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgZGV0YWlsOiB7IG5ld1N0cmVhbTogdGhpcywgcmVuZGVyOiBTdHJlYW1FbGVtZW50LnJlbmRlckVsZW1lbnQgfVxuICAgIH0pXG4gIH1cblxuICBnZXQgdGFyZ2V0RWxlbWVudHNCeUlkKCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLm93bmVyRG9jdW1lbnQ/LmdldEVsZW1lbnRCeUlkKHRoaXMudGFyZ2V0KTtcblxuICAgIGlmIChlbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gW2VsZW1lbnRdXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIGdldCB0YXJnZXRFbGVtZW50c0J5UXVlcnkoKSB7XG4gICAgY29uc3QgZWxlbWVudHMgPSB0aGlzLm93bmVyRG9jdW1lbnQ/LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy50YXJnZXRzKTtcblxuICAgIGlmIChlbGVtZW50cy5sZW5ndGggIT09IDApIHtcbiAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlbGVtZW50cylcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFN0cmVhbVNvdXJjZUVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIHN0cmVhbVNvdXJjZSA9IG51bGxcblxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLnN0cmVhbVNvdXJjZSA9IHRoaXMuc3JjLm1hdGNoKC9ed3N7MSwyfTovKSA/IG5ldyBXZWJTb2NrZXQodGhpcy5zcmMpIDogbmV3IEV2ZW50U291cmNlKHRoaXMuc3JjKTtcblxuICAgIGNvbm5lY3RTdHJlYW1Tb3VyY2UodGhpcy5zdHJlYW1Tb3VyY2UpO1xuICB9XG5cbiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgaWYgKHRoaXMuc3RyZWFtU291cmNlKSB7XG4gICAgICB0aGlzLnN0cmVhbVNvdXJjZS5jbG9zZSgpO1xuXG4gICAgICBkaXNjb25uZWN0U3RyZWFtU291cmNlKHRoaXMuc3RyZWFtU291cmNlKTtcbiAgICB9XG4gIH1cblxuICBnZXQgc3JjKCkge1xuICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZShcInNyY1wiKSB8fCBcIlwiXG4gIH1cbn1cblxuRnJhbWVFbGVtZW50LmRlbGVnYXRlQ29uc3RydWN0b3IgPSBGcmFtZUNvbnRyb2xsZXI7XG5cbmlmIChjdXN0b21FbGVtZW50cy5nZXQoXCJ0dXJiby1mcmFtZVwiKSA9PT0gdW5kZWZpbmVkKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcInR1cmJvLWZyYW1lXCIsIEZyYW1lRWxlbWVudCk7XG59XG5cbmlmIChjdXN0b21FbGVtZW50cy5nZXQoXCJ0dXJiby1zdHJlYW1cIikgPT09IHVuZGVmaW5lZCkge1xuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoXCJ0dXJiby1zdHJlYW1cIiwgU3RyZWFtRWxlbWVudCk7XG59XG5cbmlmIChjdXN0b21FbGVtZW50cy5nZXQoXCJ0dXJiby1zdHJlYW0tc291cmNlXCIpID09PSB1bmRlZmluZWQpIHtcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKFwidHVyYm8tc3RyZWFtLXNvdXJjZVwiLCBTdHJlYW1Tb3VyY2VFbGVtZW50KTtcbn1cblxuKCgpID0+IHtcbiAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5jdXJyZW50U2NyaXB0O1xuICBpZiAoIWVsZW1lbnQpIHJldHVyblxuICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN1cHByZXNzLXdhcm5pbmdcIikpIHJldHVyblxuXG4gIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gIHdoaWxlIChlbGVtZW50KSB7XG4gICAgaWYgKGVsZW1lbnQgPT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUud2FybihcbiAgICAgICAgdW5pbmRlbnRgXG4gICAgICAgIFlvdSBhcmUgbG9hZGluZyBUdXJibyBmcm9tIGEgPHNjcmlwdD4gZWxlbWVudCBpbnNpZGUgdGhlIDxib2R5PiBlbGVtZW50LiBUaGlzIGlzIHByb2JhYmx5IG5vdCB3aGF0IHlvdSBtZWFudCB0byBkbyFcblxuICAgICAgICBMb2FkIHlvdXIgYXBwbGljYXRpb27igJlzIEphdmFTY3JpcHQgYnVuZGxlIGluc2lkZSB0aGUgPGhlYWQ+IGVsZW1lbnQgaW5zdGVhZC4gPHNjcmlwdD4gZWxlbWVudHMgaW4gPGJvZHk+IGFyZSBldmFsdWF0ZWQgd2l0aCBlYWNoIHBhZ2UgY2hhbmdlLlxuXG4gICAgICAgIEZvciBtb3JlIGluZm9ybWF0aW9uLCBzZWU6IGh0dHBzOi8vdHVyYm8uaG90d2lyZWQuZGV2L2hhbmRib29rL2J1aWxkaW5nI3dvcmtpbmctd2l0aC1zY3JpcHQtZWxlbWVudHNcblxuICAgICAgICDigJTigJRcbiAgICAgICAgU3VwcHJlc3MgdGhpcyB3YXJuaW5nIGJ5IGFkZGluZyBhIFwiZGF0YS10dXJiby1zdXBwcmVzcy13YXJuaW5nXCIgYXR0cmlidXRlIHRvOiAlc1xuICAgICAgYCxcbiAgICAgICAgZWxlbWVudC5vdXRlckhUTUxcbiAgICAgIClcbiAgICB9XG5cbiAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICB9XG59KSgpO1xuXG53aW5kb3cuVHVyYm8gPSB7IC4uLlR1cmJvLCBTdHJlYW1BY3Rpb25zIH07XG5zdGFydCgpO1xuXG5leHBvcnQgeyBGZXRjaEVuY3R5cGUsIEZldGNoTWV0aG9kLCBGZXRjaFJlcXVlc3QsIEZldGNoUmVzcG9uc2UsIEZyYW1lRWxlbWVudCwgRnJhbWVMb2FkaW5nU3R5bGUsIEZyYW1lUmVuZGVyZXIsIFBhZ2VSZW5kZXJlciwgUGFnZVNuYXBzaG90LCBTdHJlYW1BY3Rpb25zLCBTdHJlYW1FbGVtZW50LCBTdHJlYW1Tb3VyY2VFbGVtZW50LCBjYWNoZSwgY2xlYXJDYWNoZSwgY29ubmVjdFN0cmVhbVNvdXJjZSwgZGlzY29ubmVjdFN0cmVhbVNvdXJjZSwgZmV0Y2hXaXRoVHVyYm9IZWFkZXJzIGFzIGZldGNoLCBmZXRjaEVuY3R5cGVGcm9tU3RyaW5nLCBmZXRjaE1ldGhvZEZyb21TdHJpbmcsIGlzU2FmZSwgbmF2aWdhdG9yJDEgYXMgbmF2aWdhdG9yLCByZWdpc3RlckFkYXB0ZXIsIHJlbmRlclN0cmVhbU1lc3NhZ2UsIHNlc3Npb24sIHNldENvbmZpcm1NZXRob2QsIHNldEZvcm1Nb2RlLCBzZXRQcm9ncmVzc0JhckRlbGF5LCBzdGFydCwgdmlzaXQgfTtcbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgcmVhZE9ubHk6IEJvb2xlYW4sXG4gICAgfVxuXG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgZGl2IHRvIGFwcGx5IHRoZSBlZGl0b3IgdG9cbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5jb250YWluZXIuaWQgPSB0aGlzLmVsZW1lbnQuaWQgKyAnX2Rpdic7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTmFtZSA9IHRoaXMuZWxlbWVudC5jbGFzc05hbWU7XG4gICAgICAgIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmNvbnRhaW5lciwgdGhpcy5lbGVtZW50Lm5leHRTaWJsaW5nKTtcblxuICAgICAgICAvLyBIaWRlIHRoZSB0ZXh0YXJlYVxuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbJ2Rpc3BsYXknXSA9ICdub25lJztcblxuICAgICAgICAvLyBJbnN0YW50aWF0ZSB0aGUgZWRpdG9yXG4gICAgICAgIHRoaXMuZWRpdG9yID0gYWNlLmVkaXQodGhpcy5jb250YWluZXIsIHttYXhMaW5lczogSW5maW5pdHl9KTtcbiAgICAgICAgdGhpcy5lZGl0b3IuZ2V0U2Vzc2lvbigpLnNldFZhbHVlKHRoaXMuZWxlbWVudC52YWx1ZSk7XG5cbiAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2ZvY3VzJywgKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IHRoaXMuZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERpc2FibGUgY29tbWFuZCBjb25mbGljdHMgd2l0aCBBbHRHciAoc2VlICM1NzkyKVxuICAgICAgICB0aGlzLmVkaXRvci5jb21tYW5kcy5iaW5kS2V5KCdDdHJsLWFsdC1hfEN0cmwtYWx0LWV8Q3RybC1hbHQtaHxDdHJsLWFsdC1sfEN0cmwtYWx0LXMnLCBudWxsKTtcblxuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjb25maWcgY2FsbGJhY2tcbiAgICAgICAgdGhpcy5lbGVtZW50Py5jb25maWdDYWxsYmFjayh0aGlzLmVkaXRvcik7XG4gICAgfVxuXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmNob3NlbiA9IG5ldyBDaG9zZW4odGhpcy5lbGVtZW50KTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmNob3Nlbi5jb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuY2hvc2VuID0gbnVsbDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBjb250ZW50OiBTdHJpbmdcbiAgICB9XG5cbiAgICB3cml0ZSAoKSB7XG4gICAgICAgIGlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkICYmIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KSB7XG4gICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0aGlzLmNvbnRlbnRWYWx1ZSkuY2F0Y2godGhpcy5jbGlwYm9hcmRGYWxsYmFjay5iaW5kKHRoaXMpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkRmFsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsaXBib2FyZEZhbGxiYWNrICAoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSB0aGlzLmNvbnRlbnRWYWx1ZTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgIGlucHV0LnNlbGVjdCgpO1xuICAgICAgICBpbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSgwLCA5OTk5OSk7XG4gICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdjb3B5Jyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaW5wdXQpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5jb25zdCBwcmVmZXJzRGFyayA9ICgpID0+IHtcbiAgICBjb25zdCBwcmVmZXJzRGFyayA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjb250YW8tLXByZWZlcnMtZGFyaycpO1xuXG4gICAgaWYgKG51bGwgPT09IHByZWZlcnNEYXJrKSB7XG4gICAgICAgIHJldHVybiAhIXdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykubWF0Y2hlcztcbiAgICB9XG5cbiAgICByZXR1cm4gcHJlZmVyc0RhcmsgPT09ICd0cnVlJztcbn1cblxuY29uc3Qgc2V0Q29sb3JTY2hlbWUgPSAoKSA9PiB7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQuY29sb3JTY2hlbWUgPSBwcmVmZXJzRGFyaygpID8gJ2RhcmsnIDogJ2xpZ2h0Jztcbn07XG5cbndpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2V0Q29sb3JTY2hlbWUpO1xuc2V0Q29sb3JTY2hlbWUoKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnbGFiZWwnXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIGkxOG46IHtcbiAgICAgICAgICAgIHR5cGU6IE9iamVjdCxcbiAgICAgICAgICAgIGRlZmF1bHQ6IHsgbGlnaHQ6ICdEaXNhYmxlIGRhcmsgbW9kZScsIGRhcms6ICdFbmFibGUgZGFyayBtb2RlJyB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgaW5pdGlhbGl6ZSAoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlID0gdGhpcy50b2dnbGUuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRMYWJlbCA9IHRoaXMuc2V0TGFiZWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGUpO1xuXG4gICAgICAgIHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5zZXRMYWJlbCk7XG4gICAgICAgIHRoaXMuc2V0TGFiZWwoKTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGUpO1xuICAgIH1cblxuICAgIHRvZ2dsZSAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaXNEYXJrID0gIXByZWZlcnNEYXJrKCk7XG5cbiAgICAgICAgaWYgKGlzRGFyayA9PT0gd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKS5tYXRjaGVzKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnY29udGFvLS1wcmVmZXJzLWRhcmsnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjb250YW8tLXByZWZlcnMtZGFyaycsIFN0cmluZyhpc0RhcmspKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldENvbG9yU2NoZW1lKCk7XG5cbiAgICAgICAgLy8gQ2hhbmdlIHRoZSBsYWJlbCBhZnRlciB0aGUgZHJvcGRvd24gaXMgaGlkZGVuXG4gICAgICAgIHNldFRpbWVvdXQodGhpcy5zZXRMYWJlbCwgMzAwKTtcbiAgICB9XG5cbiAgICBzZXRMYWJlbCAoKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNMYWJlbFRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLmkxOG5WYWx1ZVtwcmVmZXJzRGFyaygpID8gJ2xpZ2h0JyA6ICdkYXJrJ107XG5cbiAgICAgICAgdGhpcy5sYWJlbFRhcmdldC50aXRsZSA9IGxhYmVsO1xuICAgICAgICB0aGlzLmxhYmVsVGFyZ2V0LmlubmVyVGV4dCA9IGxhYmVsO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIGNvbmZpZzogT2JqZWN0LFxuICAgIH1cblxuICAgIGluaXRpYWxpemUgKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZVdpemFyZCA9IHRoaXMudXBkYXRlV2l6YXJkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMub3Blbk1vZGFsID0gdGhpcy5vcGVuTW9kYWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG4gICAgICAgIHRoaXMuYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIHRoaXMuYnV0dG9uLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgdGhpcy5idXR0b24udGl0bGUgPSAnJztcbiAgICAgICAgdGhpcy5idXR0b25JbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICB0aGlzLmJ1dHRvbi5hcHBlbmQodGhpcy5idXR0b25JbWFnZSk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ3dpemFyZCcpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWZ0ZXIodGhpcy5idXR0b24pO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMudXBkYXRlV2l6YXJkKTtcbiAgICAgICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5Nb2RhbCk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVXaXphcmQoKTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnd2l6YXJkJyk7XG4gICAgICAgIHRoaXMuc2VsZWN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMudXBkYXRlV2l6YXJkKTtcbiAgICAgICAgdGhpcy5idXR0b25JbWFnZS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5idXR0b24ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgdXBkYXRlV2l6YXJkICgpIHtcbiAgICAgICAgaWYgKHRoaXMuY2FuRWRpdCgpKSB7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvbi50aXRsZSA9IHRoaXMuY29uZmlnVmFsdWUudGl0bGU7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5idXR0b25JbWFnZS5zcmMgPSB0aGlzLmNvbmZpZ1ZhbHVlLmljb247XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvbi50aXRsZSA9ICcnO1xuICAgICAgICAgICAgdGhpcy5idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5idXR0b25JbWFnZS5zcmMgPSB0aGlzLmNvbmZpZ1ZhbHVlLmljb25EaXNhYmxlZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wZW5Nb2RhbCAoKSB7XG4gICAgICAgIEJhY2tlbmQub3Blbk1vZGFsSWZyYW1lKHtcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLmNvbmZpZ1ZhbHVlLnRpdGxlLFxuICAgICAgICAgICAgdXJsOiBgJHsgdGhpcy5jb25maWdWYWx1ZS5ocmVmIH0maWQ9JHsgdGhpcy5zZWxlY3QudmFsdWUgfWBcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2FuRWRpdCAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ1ZhbHVlLmlkcy5pbmNsdWRlcyhOdW1iZXIodGhpcy5zZWxlY3QudmFsdWUpKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnbmF2aWdhdGlvbicsICdzZWN0aW9uJ107XG5cbiAgICBjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5yZWJ1aWxkTmF2aWdhdGlvbigpO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgc2VjdGlvblRhcmdldENvbm5lY3RlZCAoKSB7XG4gICAgICAgIGlmICghdGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVidWlsZE5hdmlnYXRpb24oKTtcbiAgICB9XG5cbiAgICByZWJ1aWxkTmF2aWdhdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNOYXZpZ2F0aW9uVGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsaW5rcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG5cbiAgICAgICAgdGhpcy5zZWN0aW9uVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICBhY3Rpb24uaW5uZXJUZXh0ID0gZWwuZ2V0QXR0cmlidXRlKGBkYXRhLSR7dGhpcy5pZGVudGlmaWVyfS1sYWJlbC12YWx1ZWApO1xuXG4gICAgICAgICAgICBhY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goJ3Njcm9sbHRvJywgeyB0YXJnZXQ6IGVsIH0pO1xuICAgICAgICAgICAgICAgIGVsLnNjcm9sbEludG9WaWV3KCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICAgICAgbGkuYXBwZW5kKGFjdGlvbik7XG5cbiAgICAgICAgICAgIGxpbmtzLmFwcGVuZChsaSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubmF2aWdhdGlvblRhcmdldC5yZXBsYWNlQ2hpbGRyZW4obGlua3MpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIG1heDogTnVtYmVyLFxuICAgICAgICBleHBhbmQ6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2U6IFN0cmluZyxcbiAgICAgICAgZXhwYW5kQWxsOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZEFsbFRpdGxlOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlQWxsOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlQWxsVGl0bGU6IFN0cmluZyxcbiAgICB9XG5cbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnb3BlcmF0aW9uJywgJ25vZGUnXTtcblxuICAgIGluaXRpYWxpemUgKCkge1xuICAgICAgICBzdXBlci5pbml0aWFsaXplKCk7XG4gICAgICAgIHRoaXMudG9nZ2xlck1hcCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMubmV4dElkID0gMTtcbiAgICB9XG5cbiAgICBvcGVyYXRpb25UYXJnZXRDb25uZWN0ZWQgKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbigpO1xuICAgIH1cblxuICAgIG5vZGVUYXJnZXRDb25uZWN0ZWQgKG5vZGUpIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBudWxsKTtcbiAgICAgICAgY29uc3QgcGFkZGluZyA9IHBhcnNlRmxvYXQoc3R5bGUucGFkZGluZ1RvcCkgKyBwYXJzZUZsb2F0KHN0eWxlLnBhZGRpbmdCb3R0b20pO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBub2RlLmNsaWVudEhlaWdodCAtIHBhZGRpbmc7XG5cbiAgICAgICAgLy8gUmVzaXplIHRoZSBlbGVtZW50IGlmIGl0IGlzIGhpZ2hlciB0aGFuIHRoZSBtYXhpbXVtIGhlaWdodFxuICAgICAgICBpZiAodGhpcy5tYXhWYWx1ZSA+IGhlaWdodCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFub2RlLmlkKSB7XG4gICAgICAgICAgICBub2RlLmlkID0gYGxpbWl0LWhlaWdodC0ke3RoaXMubmV4dElkKyt9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGUuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgICAgbm9kZS5zdHlsZS5tYXhIZWlnaHQgPSBgJHt0aGlzLm1heFZhbHVlfXB4YDtcblxuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLnRpdGxlID0gdGhpcy5leHBhbmRWYWx1ZTtcbiAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9ICc8c3Bhbj4uLi48L3NwYW4+JztcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Vuc2VsZWN0YWJsZScpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCBub2RlLmlkKTtcblxuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZShub2RlKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKGV2ZW50KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0b2dnbGVyLmNsYXNzTGlzdC5hZGQoJ2xpbWl0X3RvZ2dsZXInKTtcbiAgICAgICAgdG9nZ2xlci5hcHBlbmQoYnV0dG9uKTtcblxuICAgICAgICB0aGlzLnRvZ2dsZXJNYXAuc2V0KG5vZGUsIHRvZ2dsZXIpO1xuXG4gICAgICAgIG5vZGUuYXBwZW5kKHRvZ2dsZXIpO1xuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbigpO1xuICAgIH1cblxuICAgIG5vZGVUYXJnZXREaXNjb25uZWN0ZWQgKG5vZGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRvZ2dsZXJNYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRvZ2dsZXJNYXAuZ2V0KG5vZGUpLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLnRvZ2dsZXJNYXAuZGVsZXRlKG5vZGUpO1xuICAgICAgICBub2RlLnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgICAgIG5vZGUuc3R5bGUubWF4SGVpZ2h0ID0gJyc7XG4gICAgfVxuXG4gICAgdG9nZ2xlIChub2RlKSB7XG4gICAgICAgIGlmIChub2RlLnN0eWxlLm1heEhlaWdodCA9PT0gJycpIHtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2Uobm9kZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmV4cGFuZChub2RlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4cGFuZCAobm9kZSkge1xuICAgICAgICBpZiAoIXRoaXMudG9nZ2xlck1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGUuc3R5bGUubWF4SGVpZ2h0ID0gJyc7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMudG9nZ2xlck1hcC5nZXQobm9kZSkucXVlcnlTZWxlY3RvcignYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi50aXRsZSA9IHRoaXMuY29sbGFwc2VWYWx1ZTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgfVxuXG4gICAgY29sbGFwc2UgKG5vZGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRvZ2dsZXJNYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBub2RlLnN0eWxlLm1heEhlaWdodCA9IGAke3RoaXMubWF4VmFsdWV9cHhgO1xuICAgICAgICBjb25zdCBidXR0b24gPSB0aGlzLnRvZ2dsZXJNYXAuZ2V0KG5vZGUpLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24udGl0bGUgPSB0aGlzLmV4cGFuZFZhbHVlO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgfVxuXG4gICAgdG9nZ2xlQWxsIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gdGhpcy5oYXNFeHBhbmRlZCgpIF4gZXZlbnQuYWx0S2V5O1xuXG4gICAgICAgIHRoaXMubm9kZVRhcmdldHMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGlzRXhwYW5kZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbGxhcHNlKG5vZGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oZXZlbnQpO1xuICAgIH1cblxuICAgIGtleXByZXNzIChldmVudCkge1xuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbihldmVudCk7XG4gICAgfVxuXG4gICAgdXBkYXRlT3BlcmF0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzT3BlcmF0aW9uVGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBoYXNUb2dnbGVycyA9ICEhdGhpcy5ub2RlVGFyZ2V0cy5maW5kKChlbCkgPT4gdGhpcy50b2dnbGVyTWFwLmhhcyhlbCkpO1xuICAgICAgICBjb25zdCBleHBhbmRlZCA9IHRoaXMuaGFzRXhwYW5kZWQoKTtcblxuICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5zdHlsZS5kaXNwbGF5ID0gaGFzVG9nZ2xlcnMgPyAnJyA6ICdub25lJztcbiAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgdGhpcy5ub2RlVGFyZ2V0cy5tYXAoKGVsKSA9PiBlbC5pZCkuam9pbignICcpKTtcbiAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgZXhwYW5kZWQgPyAndHJ1ZScgOiAnZmFsc2UnKTtcblxuICAgICAgICBpZiAoZXhwYW5kZWQgXiAoZXZlbnQgPyBldmVudC5hbHRLZXkgOiBmYWxzZSkpIHtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LmlubmVyVGV4dCA9IHRoaXMuY29sbGFwc2VBbGxWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnRpdGxlID0gdGhpcy5jb2xsYXBzZUFsbFRpdGxlVmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5pbm5lclRleHQgPSB0aGlzLmV4cGFuZEFsbFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQudGl0bGUgPSB0aGlzLmV4cGFuZEFsbFRpdGxlVmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoYXNFeHBhbmRlZCAoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMubm9kZVRhcmdldHMuZmluZCgoZWwpID0+IHRoaXMudG9nZ2xlck1hcC5oYXMoZWwpICYmIGVsLnN0eWxlLm1heEhlaWdodCA9PT0gJycpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydpbnB1dCddO1xuXG4gICAgZGVsZXRlICgpIHtcbiAgICAgICAgdGhpcy5pbnB1dFRhcmdldHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgIH0pXG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cydcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnc2Nyb2xsVG8nLCAnYXV0b0ZvY3VzJywgJ3dpZGdldEVycm9yJ107XG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBzZXNzaW9uS2V5OiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0OiAnY29udGFvX2JhY2tlbmRfb2Zmc2V0J1xuICAgICAgICB9LFxuICAgICAgICBiZWhhdmlvcjoge1xuICAgICAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICAgICAgZGVmYXVsdDogJ2luc3RhbnQnXG4gICAgICAgIH0sXG4gICAgICAgIGJsb2NrOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0OiAnY2VudGVyJ1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIEJhY2t3YXJkcyBjb21wYXRpYmlsaXR5OiBhdXRvbWF0aWNhbGx5IHJlZ2lzdGVyIHRoZSBTdGltdWx1cyBjb250cm9sbGVyIGlmIHRoZSBsZWdhY3kgbWV0aG9kcyBhcmUgdXNlZFxuICAgIHN0YXRpYyBhZnRlckxvYWQoaWRlbnRpZmllciwgYXBwbGljYXRpb24pIHtcbiAgICAgICAgY29uc3QgbG9hZEZhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgaWRlbnRpZmllcik7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgeyBjb250cm9sbGVyQXR0cmlidXRlIH0gPSBhcHBsaWNhdGlvbi5zY2hlbWE7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZShjb250cm9sbGVyQXR0cmlidXRlLCBgJHtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKGNvbnRyb2xsZXJBdHRyaWJ1dGUpIHx8ICcnfSAkeyBpZGVudGlmaWVyIH1gKTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIgJiYgcmVzb2x2ZShjb250cm9sbGVyKSB8fCByZWplY3QoY29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpbmRvdy5CYWNrZW5kICYmICF3aW5kb3cuQmFja2VuZC5pbml0U2Nyb2xsT2Zmc2V0KSB7XG4gICAgICAgICAgICB3aW5kb3cuQmFja2VuZC5pbml0U2Nyb2xsT2Zmc2V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQmFja2VuZC5pbml0U2Nyb2xsT2Zmc2V0KCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgU3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuICAgICAgICAgICAgICAgIGxvYWRGYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpbmRvdy5CYWNrZW5kICYmICF3aW5kb3cuQmFja2VuZC5nZXRTY3JvbGxPZmZzZXQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5CYWNrZW5kLmdldFNjcm9sbE9mZnNldCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0JhY2tlbmQuZ2V0U2Nyb2xsT2Zmc2V0KCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgU3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuICAgICAgICAgICAgICAgIGxvYWRGYWxsYmFjaygpLnRoZW4oKGNvbnRyb2xsZXIpID0+IGNvbnRyb2xsZXIuZGlzY2FyZCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluaXRpYWxpemUgKCkge1xuICAgICAgICB0aGlzLnN0b3JlID0gdGhpcy5zdG9yZS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICBpZiAoIXRoaXMub2Zmc2V0KSByZXR1cm47XG5cbiAgICAgICAgd2luZG93LnNjcm9sbFRvKHtcbiAgICAgICAgICAgIHRvcDogdGhpcy5vZmZzZXQsXG4gICAgICAgICAgICBiZWhhdmlvcjogdGhpcy5iZWhhdmlvclZhbHVlLFxuICAgICAgICAgICAgYmxvY2s6IHRoaXMuYmxvY2tWYWx1ZVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm9mZnNldCA9IG51bGw7XG4gICAgfVxuXG4gICAgc2Nyb2xsVG9UYXJnZXRDb25uZWN0ZWQoKSB7XG4gICAgICAgIHRoaXMuc2Nyb2xsVG9UYXJnZXQuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgYmVoYXZpb3I6IHRoaXMuYmVoYXZpb3JWYWx1ZSxcbiAgICAgICAgICAgIGJsb2NrOiB0aGlzLmJsb2NrVmFsdWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXV0b0ZvY3VzVGFyZ2V0Q29ubmVjdGVkKCkge1xuICAgICAgICBpZiAodGhpcy5vZmZzZXQgfHwgdGhpcy5hdXRvRm9jdXMpIHJldHVybjtcblxuICAgICAgICBjb25zdCBpbnB1dCA9IHRoaXMuYXV0b0ZvY3VzVGFyZ2V0O1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIGlucHV0LmRpc2FibGVkIHx8IGlucHV0LnJlYWRvbmx5XG4gICAgICAgICAgICB8fCAhaW5wdXQub2Zmc2V0V2lkdGggfHwgIWlucHV0Lm9mZnNldEhlaWdodFxuICAgICAgICAgICAgfHwgaW5wdXQuY2xvc2VzdCgnLmNoem4tc2VhcmNoJylcbiAgICAgICAgICAgIHx8IGlucHV0LmF1dG9jb21wbGV0ZSAmJiBpbnB1dC5hdXRvY29tcGxldGUgIT09ICdvZmYnXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hdXRvRm9jdXMgPSB0cnVlO1xuICAgICAgICBpbnB1dC5mb2N1cygpO1xuICAgIH1cblxuICAgIHdpZGdldEVycm9yVGFyZ2V0Q29ubmVjdGVkKCkge1xuICAgICAgICB0aGlzLndpZGdldEVycm9yVGFyZ2V0LnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJyxcbiAgICAgICAgICAgIGJsb2NrOiAnc3RhcnQnXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0b3JlICgpIHtcbiAgICAgICAgdGhpcy5vZmZzZXQgPSB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgIH1cblxuICAgIGRpc2NhcmQgKCkge1xuICAgICAgICB0aGlzLm9mZnNldCA9IG51bGw7XG4gICAgfVxuXG4gICAgc2Nyb2xsVG9XaWRnZXRFcnJvcigpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzV2lkZ2V0RXJyb3JUYXJnZXQpIHtcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0RXJyb3JUYXJnZXRDb25uZWN0ZWQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBvZmZzZXQgKCkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHRoaXMuc2Vzc2lvbktleVZhbHVlKTtcblxuICAgICAgICByZXR1cm4gdmFsdWUgPyBwYXJzZUludCh2YWx1ZSkgOiBudWxsO1xuICAgIH1cblxuICAgIHNldCBvZmZzZXQgKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLnNlc3Npb25LZXlWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSh0aGlzLnNlc3Npb25LZXlWYWx1ZSwgU3RyaW5nKHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBpbml0aWFsaXplKCkge1xuICAgICAgICBUdXJiby5jYWNoZS5leGVtcHRQYWdlRnJvbUNhY2hlKCk7XG4gICAgfVxuXG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQudGlueW1jZUNvbmZpZykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gVGlueU1DRSBjb25maWcgd2FzIGF0dGFjaGVkIHRvIHRoZSBET00gZWxlbWVudCwgZXhwZWN0ZWQgYW4gZXhwYW5kbyBwcm9wZXJ0eSBjYWxsZWQgXCJ0aW55bWNlQ29uZmlnXCIuJywgdGhpcy5lbGVtZW50KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuZWxlbWVudC50aW55bWNlQ29uZmlnO1xuICAgICAgICBjb25maWcudGFyZ2V0ID0gdGhpcy5lbGVtZW50O1xuXG4gICAgICAgIC8vIFRpbnlNQ0UgY3JlYXRlcyB0aGUgZWRpdG9yIElEIGJhc2VkIG9uIHRoZSB0YXJnZXQgZWxlbWVudCdzIElEIChpZiBzZXQpLlxuICAgICAgICAvLyBUaGlzIGxlYWRzIHRvIGEgcHJvYmxlbSBpZiBhbiBlZGl0b3Igd2l0aCB0aGUgc2FtZSBJRCBpcyBzdGlsbCBhcm91bmQsXG4gICAgICAgIC8vIHdoaWNoIHdvdWxkIGJlIHRoZSBjYXNlIGlmIHRoZSBkaXNjb25uZWN0IGV2ZW50IGNsZWFuaW5nIHVwIHRoZSByZXNvdXJjZVxuICAgICAgICAvLyBoYXMgbm90IHJ1biB5ZXQuIFdlIHRoZXJlZm9yZSByZW1vdmUgdGhlIElEIGFuZCByZS1hZGQgaXQgYWZ0ZXJcbiAgICAgICAgLy8gaW5pdGlhbGl6aW5nIHRoZSBlZGl0b3IuXG4gICAgICAgIGNvbnN0IGVsZW1lbnRJZCA9IHRoaXMuZWxlbWVudC5pZDtcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcblxuICAgICAgICB0aW55bWNlPy5pbml0KGNvbmZpZykudGhlbigoZWRpdG9ycykgPT4ge1xuICAgICAgICAgICAgdGhpcy5lZGl0b3JJZCA9IGVkaXRvcnNbMF0/LmlkO1xuXG4gICAgICAgICAgICAvLyBGaXJlIGEgY3VzdG9tIGV2ZW50IHdoZW4gdGhlIGVkaXRvciBmaW5pc2hlZCBpbnRpYWxpemluZy5cbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goJ2VkaXRvci1sb2FkZWQnLCB7IGRldGFpbDogeyBjb250ZW50OiBlZGl0b3JzWzBdID8/IG51bGwgfSB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCBlbGVtZW50SWQpO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRpbnltY2U/LmdldCh0aGlzLmVkaXRvcklkKT8ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgbGVhdmUoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGlueW1jZT8uZ2V0KHRoaXMuZWRpdG9ySWQpXG5cbiAgICAgICAgaWYoIWVkaXRvciB8fCAhZWRpdG9yLnBsdWdpbnMuaGFzT3duUHJvcGVydHkoJ2F1dG9zYXZlJykgfHwgZWRpdG9yLmlzTm90RGlydHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyaWdnZXIgYSBiZWZvcmV1bmxvYWQgZXZlbnQgbGlrZSB3aGVuIG5hdmlnYXRpbmcgYXdheSB0byBjYXB0dXJlIHRoZSBUaW55TUNFIGF1dG9zYXZlIG1lc3NhZ2VcbiAgICAgICAgY29uc3QgZGVsZWdhdGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQmVmb3JlVW5sb2FkRXZlbnQnKTtcbiAgICAgICAgZGVsZWdhdGUuaW5pdEV2ZW50KCdiZWZvcmV1bmxvYWQnLCBmYWxzZSwgdHJ1ZSk7XG5cbiAgICAgICAgaWYoIXdpbmRvdy5kaXNwYXRjaEV2ZW50KGRlbGVnYXRlKSAmJiAhY29uZmlybShkZWxlZ2F0ZS5yZXR1cm5WYWx1ZSkpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBpZDogU3RyaW5nLFxuICAgICAgICB0YWJsZTogU3RyaW5nLFxuICAgIH1cblxuICAgIHN0YXRpYyBjbGFzc2VzID0gWydjb2xsYXBzZWQnXTtcblxuICAgIHN0YXRpYyBhZnRlckxvYWQgKGlkZW50aWZpZXIsIGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IGFkZENvbnRyb2xsZXIgPSAoZWwsIGlkLCB0YWJsZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZnMgPSBlbC5wYXJlbnROb2RlO1xuXG4gICAgICAgICAgICBmcy5kYXRhc2V0LmNvbnRyb2xsZXIgPSBgJHtmcy5kYXRhc2V0LmNvbnRyb2xsZXIgfHwgJyd9ICR7aWRlbnRpZmllcn1gO1xuICAgICAgICAgICAgZnMuc2V0QXR0cmlidXRlKGBkYXRhLSR7aWRlbnRpZmllcn0taWQtdmFsdWVgLCBpZCk7XG4gICAgICAgICAgICBmcy5zZXRBdHRyaWJ1dGUoYGRhdGEtJHtpZGVudGlmaWVyfS10YWJsZS12YWx1ZWAsIHRhYmxlKTtcbiAgICAgICAgICAgIGZzLnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LWNvbGxhcHNlZC1jbGFzc2AsICdjb2xsYXBzZWQnKTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1hY3Rpb24nLCBgY2xpY2stPiR7aWRlbnRpZmllcn0jdG9nZ2xlYCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtaWdyYXRlTGVnYWN5ID0gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGVnZW5kW2RhdGEtdG9nZ2xlLWZpZWxkc2V0XScpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVc2luZyB0aGUgXCJkYXRhLXRvZ2dsZS1maWVsZHNldFwiIGF0dHJpYnV0ZSBvbiBmaWVsZHNldCBsZWdlbmRzIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBDb250YW8gNi4gQXBwbHkgdGhlIFwiJHtpZGVudGlmaWVyfVwiIFN0aW11bHVzIGNvbnRyb2xsZXIgaW5zdGVhZC5gKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCB7IGlkLCB0YWJsZSB9ID0gSlNPTi5wYXJzZShlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlLWZpZWxkc2V0JykpO1xuICAgICAgICAgICAgICAgIGFkZENvbnRyb2xsZXIoZWwsIGlkLCB0YWJsZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgQWpheFJlcXVlc3QudG9nZ2xlRmllbGRzZXQgPSAoZWwsIGlkLCB0YWJsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZzID0gZWwucGFyZW50Tm9kZTtcblxuICAgICAgICAgICAgICAgIC8vIEFscmVhZHkgY2xpY2tlZCwgU3RpbXVsdXMgY29udHJvbGxlciB3YXMgYWRkZWQgZHluYW1pY2FsbHlcbiAgICAgICAgICAgICAgICBpZiAoYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGZzLCBpZGVudGlmaWVyKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignVXNpbmcgQWpheFJlcXVlc3QudG9nZ2xlRmllbGRzZXQoKSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gQ29udGFvIDYuIEFwcGx5IHRoZSBTdGltdWx1cyBhY3Rpb25zIGluc3RlYWQuJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYWRkQ29udHJvbGxlcihlbCwgaWQsIHRhYmxlKTtcblxuICAgICAgICAgICAgICAgIC8vIE9wdGltaXN0aWNhbGx5IHdhaXQgdW50aWwgU3RpbXVsdXMgaGFzIHJlZ2lzdGVyZWQgdGhlIG5ldyBjb250cm9sbGVyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGFwcGxpY2F0aW9uLmdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcihmcywgaWRlbnRpZmllcikudG9nZ2xlKCk7IH0sIDEwMCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsbGVkIGFzIHNvb24gYXMgcmVnaXN0ZXJlZCwgc28gRE9NIG1heSBub3QgaGF2ZSBiZWVuIGxvYWRlZCB5ZXRcbiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09IFwibG9hZGluZ1wiKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBtaWdyYXRlTGVnYWN5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1pZ3JhdGVMZWdhY3koKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xhYmVsLmVycm9yLCBsYWJlbC5tYW5kYXRvcnknKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGUnKSkge1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVc2luZyBjbGFzcyBcImhpZGVcIiBvbiBhIGZpZWxkc2V0IGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBDb250YW8gNi4gVXNlIGNsYXNzIFwiJHt0aGlzLmNvbGxhcHNlZENsYXNzfVwiIGluc3RlYWQuYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdG9nZ2xlICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5jb2xsYXBzZWRDbGFzcykpIHtcbiAgICAgICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb3BlbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLmNvbGxhcHNlZENsYXNzKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5jb2xsYXBzZWRDbGFzcyk7XG4gICAgICAgIHRoaXMuc3RvcmVTdGF0ZSgxKTtcbiAgICB9XG5cbiAgICBjbG9zZSAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuY29sbGFwc2VkQ2xhc3MpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmb3JtID0gdGhpcy5lbGVtZW50LmNsb3Nlc3QoJ2Zvcm0nKTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3JlcXVpcmVkXScpO1xuXG4gICAgICAgIGxldCBjb2xsYXBzZSA9IHRydWU7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghaW5wdXRbaV0udmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb2xsYXBzZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjb2xsYXBzZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZihmb3JtLmNoZWNrVmFsaWRpdHkpID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJykuY2xpY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuICAgICAgICAgICAgdGhpcy5zdG9yZVN0YXRlKDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RvcmVTdGF0ZSAoc3RhdGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc0lkVmFsdWUgfHwgIXRoaXMuaGFzVGFibGVWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZmV0Y2god2luZG93LmxvY2F0aW9uLmhyZWYsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZUZpZWxkc2V0JyxcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5pZFZhbHVlLFxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlVmFsdWUsXG4gICAgICAgICAgICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIGNsYXNzZXMgPSBbJ2NvbGxhcHNlZCddXG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICB1cmw6IFN0cmluZyxcbiAgICAgICAgcmVxdWVzdFRva2VuOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZFRpdGxlOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlVGl0bGU6IFN0cmluZyxcbiAgICB9XG5cbiAgICB0b2dnbGUgKHsgY3VycmVudFRhcmdldCwgcGFyYW1zOiB7IGNhdGVnb3J5IH19KSB7XG4gICAgICAgIGNvbnN0IGVsID0gY3VycmVudFRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICBjb25zdCBjb2xsYXBzZWQgPSBlbC5jbGFzc0xpc3QudG9nZ2xlKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuXG4gICAgICAgIGN1cnJlbnRUYXJnZXQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgY29sbGFwc2VkID8gJ2ZhbHNlJyA6ICd0cnVlJyk7XG4gICAgICAgIGN1cnJlbnRUYXJnZXQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGNvbGxhcHNlZCA/IHRoaXMuZXhwYW5kVGl0bGVWYWx1ZSA6IHRoaXMuY29sbGFwc2VUaXRsZVZhbHVlKTtcblxuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGNhdGVnb3J5LCBjb2xsYXBzZWQpO1xuICAgIH1cblxuICAgIHNlbmRSZXF1ZXN0IChjYXRlZ29yeSwgY29sbGFwc2VkKSB7XG4gICAgICAgIGZldGNoKHRoaXMudXJsVmFsdWUsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZU5hdmlnYXRpb24nLFxuICAgICAgICAgICAgICAgIGlkOiBjYXRlZ29yeSxcbiAgICAgICAgICAgICAgICBzdGF0ZTogY29sbGFwc2VkID8gMCA6IDEsXG4gICAgICAgICAgICAgICAgUkVRVUVTVF9UT0tFTjogdGhpcy5yZXF1ZXN0VG9rZW5WYWx1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgbW9kZToge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgICAgICAgZGVmYXVsdDogNVxuICAgICAgICB9LFxuICAgICAgICB0b2dnbGVBY3Rpb246IFN0cmluZyxcbiAgICAgICAgbG9hZEFjdGlvbjogU3RyaW5nLFxuICAgICAgICByZXF1ZXN0VG9rZW46IFN0cmluZyxcbiAgICAgICAgcmVmZXJlcklkOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZDogU3RyaW5nLFxuICAgICAgICBjb2xsYXBzZTogU3RyaW5nLFxuICAgICAgICBleHBhbmRBbGw6IFN0cmluZyxcbiAgICAgICAgZXhwYW5kQWxsVGl0bGU6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2VBbGw6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2VBbGxUaXRsZTogU3RyaW5nLFxuICAgIH1cblxuICAgIHN0YXRpYyB0YXJnZXRzID0gWydvcGVyYXRpb24nLCAnbm9kZScsICd0b2dnbGUnLCAnY2hpbGQnLCAncm9vdENoaWxkJ107XG5cbiAgICBvcGVyYXRpb25UYXJnZXRDb25uZWN0ZWQgKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbigpO1xuICAgIH1cblxuICAgIGNoaWxkVGFyZ2V0Q29ubmVjdGVkICgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICB0b2dnbGUgKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICBlbC5ibHVyKCk7XG5cbiAgICAgICAgdGhpcy50b2dnbGVUb2dnbGVyKGVsLCBldmVudC5wYXJhbXMuaWQsIGV2ZW50LnBhcmFtcy5sZXZlbCwgZXZlbnQucGFyYW1zLmZvbGRlcik7XG4gICAgfVxuXG4gICAgdG9nZ2xlVG9nZ2xlciAoZWwsIGlkLCBsZXZlbCwgZm9sZGVyKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5pZChpZCk7XG5cbiAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbS5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0NoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5leHBhbmRUb2dnbGVyKGVsKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoZWwsIGlkLCAxKTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2VUb2dnbGVyKGVsKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoZWwsIGlkLCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hDaGlsZChlbCwgaWQsIGxldmVsLCBmb2xkZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICBleHBhbmRUb2dnbGVyIChlbCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdmb2xkYWJsZS0tb3BlbicpO1xuICAgICAgICBlbC50aXRsZSA9IHRoaXMuY29sbGFwc2VWYWx1ZTtcbiAgICB9XG5cbiAgICBjb2xsYXBzZVRvZ2dsZXIgKGVsKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZvbGRhYmxlLS1vcGVuJyk7XG4gICAgICAgIGVsLnRpdGxlID0gdGhpcy5leHBhbmRWYWx1ZTtcbiAgICB9XG5cbiAgICBsb2FkVG9nZ2xlciAoZWwsIGVuYWJsZWQpIHtcbiAgICAgICAgZWwuY2xhc3NMaXN0W2VuYWJsZWQgPyAnYWRkJyA6ICdyZW1vdmUnXSgnZm9sZGFibGUtLWxvYWRpbmcnKTtcbiAgICB9XG5cbiAgICBzaG93Q2hpbGQgKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgfVxuXG4gICAgaGlkZUNoaWxkIChpdGVtKSB7XG4gICAgICAgIGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG5cbiAgICBhc3luYyBmZXRjaENoaWxkIChlbCwgaWQsIGxldmVsLCBmb2xkZXIpIHtcbiAgICAgICAgdGhpcy5sb2FkVG9nZ2xlcihlbCwgdHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChsb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgY29uc3Qgc2VhcmNoID0gdXJsLnNlYXJjaFBhcmFtcztcbiAgICAgICAgc2VhcmNoLnNldCgncmVmJywgdGhpcy5yZWZlcmVySWRWYWx1ZSk7XG4gICAgICAgIHVybC5zZWFyY2ggPSBzZWFyY2gudG9TdHJpbmcoKTtcblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgICAgICdhY3Rpb24nOiB0aGlzLmxvYWRBY3Rpb25WYWx1ZSxcbiAgICAgICAgICAgICAgICAnaWQnOiBpZCxcbiAgICAgICAgICAgICAgICAnbGV2ZWwnOiBsZXZlbCxcbiAgICAgICAgICAgICAgICAnZm9sZGVyJzogZm9sZGVyLFxuICAgICAgICAgICAgICAgICdzdGF0ZSc6IDEsXG4gICAgICAgICAgICAgICAgJ1JFUVVFU1RfVE9LRU4nOiB0aGlzLnJlcXVlc3RUb2tlblZhbHVlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IHR4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcblxuICAgICAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICAgICAgbGkuaWQgPSBpZDtcbiAgICAgICAgICAgIGxpLmNsYXNzTGlzdC5hZGQoJ3BhcmVudCcpO1xuICAgICAgICAgICAgbGkuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnO1xuICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKGBkYXRhLSR7dGhpcy5pZGVudGlmaWVyfS10YXJnZXRgLCBsZXZlbCA9PT0gMCA/ICdjaGlsZCByb290Q2hpbGQnIDogJ2NoaWxkJyk7XG5cbiAgICAgICAgICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICAgICAgICAgIHVsLmNsYXNzTGlzdC5hZGQoJ2xldmVsXycgKyBsZXZlbCk7XG4gICAgICAgICAgICB1bC5pbm5lckhUTUwgPSB0eHQ7XG4gICAgICAgICAgICBsaS5hcHBlbmQodWwpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlVmFsdWUgPT09IDUpIHtcbiAgICAgICAgICAgICAgICBlbC5jbG9zZXN0KCdsaScpLmFmdGVyKGxpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IGlzRm9sZGVyID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IGVsLmNsb3Nlc3QoJ2xpJyksXG4gICAgICAgICAgICAgICAgICAgIG5leHQ7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAodHlwZU9mKHBhcmVudCkgPT09ICdlbGVtZW50JyAmJiBwYXJlbnQudGFnTmFtZSA9PT0gJ0xJJyAmJiAobmV4dCA9IHBhcmVudC5uZXh0RWxlbWVudFNpYmxpbmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IG5leHQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0bF9mb2xkZXInKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNGb2xkZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNGb2xkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LmJlZm9yZShsaSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LmFmdGVyKGxpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnc3RydWN0dXJlJykpO1xuICAgICAgICAgICAgdGhpcy5leHBhbmRUb2dnbGVyKGVsKTtcblxuICAgICAgICAgICAgLy8gSE9PSyAoc2VlICM2NzUyKVxuICAgICAgICAgICAgd2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubG9hZFRvZ2dsZXIoZWwsIGZhbHNlKTtcbiAgICB9XG5cbiAgICBhc3luYyB0b2dnbGVBbGwgKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaHJlZiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuaHJlZjtcblxuICAgICAgICBpZiAodGhpcy5oYXNFeHBhbmRlZFJvb3QoKSBeIChldmVudCA/IGV2ZW50LmFsdEtleSA6IGZhbHNlKSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVBbGxTdGF0ZShocmVmLCAwKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4gdGhpcy5jb2xsYXBzZVRvZ2dsZXIoZWwpKTtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRUYXJnZXRzLmZvckVhY2goKGl0ZW0pID0+IGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4gZWwucmVtb3ZlKCkpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVUYXJnZXRzLmZvckVhY2goKGVsKSA9PiB0aGlzLmxvYWRUb2dnbGVyKGVsLCB0cnVlKSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlQWxsU3RhdGUoaHJlZiwgMSk7XG4gICAgICAgICAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRhcmdldHMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuZmV0Y2hDaGlsZChcbiAgICAgICAgICAgICAgICAgICAgZWwsXG4gICAgICAgICAgICAgICAgICAgIGVsLmdldEF0dHJpYnV0ZShgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0taWQtcGFyYW1gKSxcbiAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgZWwuZ2V0QXR0cmlidXRlKGBkYXRhLSR7dGhpcy5pZGVudGlmaWVyfS1mb2xkZXItcGFyYW1gKVxuICAgICAgICAgICAgICAgICkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKCk7XG4gICAgfVxuXG4gICAga2V5cHJlc3MgKGV2ZW50KSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKGV2ZW50KTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVTdGF0ZSAoZWwsIGlkLCBzdGF0ZSkge1xuICAgICAgICBhd2FpdCBmZXRjaChsb2NhdGlvbi5ocmVmLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICAgICAgJ1gtUmVxdWVzdGVkLVdpdGgnOiAnWE1MSHR0cFJlcXVlc3QnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgJ2FjdGlvbic6IHRoaXMudG9nZ2xlQWN0aW9uVmFsdWUsXG4gICAgICAgICAgICAgICAgJ2lkJzogaWQsXG4gICAgICAgICAgICAgICAgJ3N0YXRlJzogc3RhdGUsXG4gICAgICAgICAgICAgICAgJ1JFUVVFU1RfVE9LRU4nOiB0aGlzLnJlcXVlc3RUb2tlblZhbHVlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVBbGxTdGF0ZSAoaHJlZiwgc3RhdGUpIHtcbiAgICAgICAgYXdhaXQgZmV0Y2goYCR7aHJlZn0mc3RhdGU9JHtzdGF0ZX1gKTtcbiAgICB9XG5cbiAgICB1cGRhdGVPcGVyYXRpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNPcGVyYXRpb25UYXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmhhc0V4cGFuZGVkUm9vdCgpIF4gKGV2ZW50ID8gZXZlbnQuYWx0S2V5IDogZmFsc2UpKSB7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5pbm5lclRleHQgPSB0aGlzLmNvbGxhcHNlQWxsVmFsdWU7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC50aXRsZSA9IHRoaXMuY29sbGFwc2VBbGxUaXRsZVZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuaW5uZXJUZXh0ID0gdGhpcy5leHBhbmRBbGxWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnRpdGxlID0gdGhpcy5leHBhbmRBbGxUaXRsZVZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFzRXhwYW5kZWRSb290ICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5yb290Q2hpbGRUYXJnZXRzLmZpbmQoKGVsKSA9PiBlbC5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpXG4gICAgfVxufVxuIiwiLyoqXG4gKiBQcm92aWRlIG1ldGhvZHMgdG8gaGFuZGxlIEFqYXggcmVxdWVzdHMuXG4gKlxuICogQGF1dGhvciBMZW8gRmV5ZXIgPGh0dHBzOi8vZ2l0aHViLmNvbS9sZW9mZXllcj5cbiAqL1xud2luZG93LkFqYXhSZXF1ZXN0ID1cbntcblx0LyoqXG5cdCAqIFRvZ2dsZSB0aGUgbmF2aWdhdGlvbiBtZW51XG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgVGhlIElEIG9mIHRoZSBtZW51IGl0ZW1cblx0ICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgQWpheCBVUkxcblx0ICpcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHR0b2dnbGVOYXZpZ2F0aW9uOiBmdW5jdGlvbihlbCwgaWQsIHVybCkge1xuXHRcdGlmICh3aW5kb3cuY29uc29sZSkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBamF4UmVxdWVzdC50b2dnbGVOYXZpZ2F0aW9uKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgc3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuXHRcdH1cblxuXHRcdHZhciBpdGVtID0gJChpZCksXG5cdFx0XHRwYXJlbnQgPSAkKGVsKS5nZXRQYXJlbnQoJ2xpJyk7XG5cblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKHBhcmVudC5oYXNDbGFzcygnY29sbGFwc2VkJykpIHtcblx0XHRcdFx0cGFyZW50LnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHsgdXJsOiB1cmwgfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZU5hdmlnYXRpb24nLCAnaWQnOmlkLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGFyZW50LmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5leHBhbmQpO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oeyB1cmw6IHVybCB9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlTmF2aWdhdGlvbicsICdpZCc6aWQsICdzdGF0ZSc6MCwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgdGhlIHBhZ2UgdHJlZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgICBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqIEBwYXJhbSB7aW50fSAgICBsZXZlbCBUaGUgaW5kZW50YXRpb24gbGV2ZWxcblx0ICogQHBhcmFtIHtpbnR9ICAgIG1vZGUgIFRoZSBpbnNlcnQgbW9kZVxuXHQgKlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICovXG5cdHRvZ2dsZVN0cnVjdHVyZTogZnVuY3Rpb24oZWwsIGlkLCBsZXZlbCwgbW9kZSkge1xuXHRcdGlmICh3aW5kb3cuY29uc29sZSkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBamF4UmVxdWVzdC50b2dnbGVTdHJ1Y3R1cmUoKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBzdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG5cdFx0fVxuXG5cdFx0ZWwuYmx1cigpO1xuXG5cdFx0dmFyIGl0ZW0gPSAkKGlkKTtcblxuXHRcdGlmIChpdGVtKSB7XG5cdFx0XHRpZiAoaXRlbS5nZXRTdHlsZSgnZGlzcGxheScpID09ICdub25lJykge1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cblx0XHRcdFx0JChlbCkuYWRkQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5jb2xsYXBzZSk7XG5cblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtmaWVsZDplbH0pLnBvc3QoeydhY3Rpb24nOid0b2dnbGVTdHJ1Y3R1cmUnLCAnaWQnOmlkLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aXRlbS5zZXRTdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cblx0XHRcdFx0JChlbCkucmVtb3ZlQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5leHBhbmQpO1xuXG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7ZmllbGQ6ZWx9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3RydWN0dXJlJywgJ2lkJzppZCwgJ3N0YXRlJzowLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRuZXcgUmVxdWVzdC5Db250YW8oe1xuXHRcdFx0ZmllbGQ6IGVsLFxuXHRcdFx0ZXZhbFNjcmlwdHM6IHRydWUsXG5cdFx0XHRvblJlcXVlc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRBamF4UmVxdWVzdC5kaXNwbGF5Qm94KENvbnRhby5sYW5nLmxvYWRpbmcgKyAnIOKApicpO1xuXHRcdFx0fSxcblx0XHRcdG9uU3VjY2VzczogZnVuY3Rpb24odHh0KSB7XG5cdFx0XHRcdHZhciBsaSA9IG5ldyBFbGVtZW50KCdsaScsIHtcblx0XHRcdFx0XHQnaWQnOiBpZCxcblx0XHRcdFx0XHQnY2xhc3MnOiAncGFyZW50Jyxcblx0XHRcdFx0XHQnc3R5bGVzJzoge1xuXHRcdFx0XHRcdFx0J2Rpc3BsYXknOiAnaW5saW5lJ1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0bmV3IEVsZW1lbnQoJ3VsJywge1xuXHRcdFx0XHRcdCdjbGFzcyc6ICdsZXZlbF8nICsgbGV2ZWwsXG5cdFx0XHRcdFx0J2h0bWwnOiB0eHRcblx0XHRcdFx0fSkuaW5qZWN0KGxpLCAnYm90dG9tJyk7XG5cblx0XHRcdFx0aWYgKG1vZGUgPT0gNSkge1xuXHRcdFx0XHRcdGxpLmluamVjdCgkKGVsKS5nZXRQYXJlbnQoJ2xpJyksICdhZnRlcicpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBmb2xkZXIgPSBmYWxzZSxcblx0XHRcdFx0XHRcdHBhcmVudCA9ICQoZWwpLmdldFBhcmVudCgnbGknKSxcblx0XHRcdFx0XHRcdG5leHQ7XG5cblx0XHRcdFx0XHR3aGlsZSAodHlwZU9mKHBhcmVudCkgPT0gJ2VsZW1lbnQnICYmIChuZXh0ID0gcGFyZW50LmdldE5leHQoJ2xpJykpKSB7XG5cdFx0XHRcdFx0XHRwYXJlbnQgPSBuZXh0O1xuXHRcdFx0XHRcdFx0aWYgKHBhcmVudC5oYXNDbGFzcygndGxfZm9sZGVyJykpIHtcblx0XHRcdFx0XHRcdFx0Zm9sZGVyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGZvbGRlcikge1xuXHRcdFx0XHRcdFx0bGkuaW5qZWN0KHBhcmVudCwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRsaS5pbmplY3QocGFyZW50LCAnYWZ0ZXInKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHJlZmVyZXIgSURcblx0XHRcdFx0bGkuZ2V0RWxlbWVudHMoJ2EnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdFx0ZWwuaHJlZiA9IGVsLmhyZWYucmVwbGFjZSgvJnJlZj1bYS1mMC05XSsvLCAnJnJlZj0nICsgQ29udGFvLnJlZmVyZXJfaWQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblxuXHRcdFx0XHR3aW5kb3cuZmlyZUV2ZW50KCdzdHJ1Y3R1cmUnKTtcblx0XHRcdFx0QWpheFJlcXVlc3QuaGlkZUJveCgpO1xuXG5cdFx0XHRcdC8vIEhPT0tcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcbiAgIFx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzonbG9hZFN0cnVjdHVyZScsICdpZCc6aWQsICdsZXZlbCc6bGV2ZWwsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSB0aGUgZmlsZSB0cmVlXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgICAgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZm9sZGVyIFRoZSBmb2xkZXIncyBwYXRoXG5cdCAqIEBwYXJhbSB7aW50fSAgICBsZXZlbCAgVGhlIGluZGVudGF0aW9uIGxldmVsXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0dG9nZ2xlRmlsZU1hbmFnZXI6IGZ1bmN0aW9uKGVsLCBpZCwgZm9sZGVyLCBsZXZlbCkge1xuXHRcdGlmICh3aW5kb3cuY29uc29sZSkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBamF4UmVxdWVzdC50b2dnbGVGaWxlTWFuYWdlcigpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgdGhlIHN0aW11bHVzIGNvbnRyb2xsZXIgaW5zdGVhZC4nKTtcblx0XHR9XG5cblx0XHRlbC5ibHVyKCk7XG5cblx0XHR2YXIgaXRlbSA9ICQoaWQpO1xuXG5cdFx0aWYgKGl0ZW0pIHtcblx0XHRcdGlmIChpdGVtLmdldFN0eWxlKCdkaXNwbGF5JykgPT0gJ25vbmUnKSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcblxuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOmVsfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZUZpbGVNYW5hZ2VyJywgJ2lkJzppZCwgJ3N0YXRlJzoxLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXG5cdFx0XHRcdCQoZWwpLnJlbW92ZUNsYXNzKCdmb2xkYWJsZS0tb3BlbicpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgQ29udGFvLmxhbmcuZXhwYW5kKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOmVsfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZUZpbGVNYW5hZ2VyJywgJ2lkJzppZCwgJ3N0YXRlJzowLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRuZXcgUmVxdWVzdC5Db250YW8oe1xuXHRcdFx0ZmllbGQ6IGVsLFxuXHRcdFx0ZXZhbFNjcmlwdHM6IHRydWUsXG5cdFx0XHRvblJlcXVlc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRBamF4UmVxdWVzdC5kaXNwbGF5Qm94KENvbnRhby5sYW5nLmxvYWRpbmcgKyAnIOKApicpO1xuXHRcdFx0fSxcblx0XHRcdG9uU3VjY2VzczogZnVuY3Rpb24odHh0KSB7XG5cdFx0XHRcdHZhciBsaSA9IG5ldyBFbGVtZW50KCdsaScsIHtcblx0XHRcdFx0XHQnaWQnOiBpZCxcblx0XHRcdFx0XHQnY2xhc3MnOiAncGFyZW50Jyxcblx0XHRcdFx0XHQnc3R5bGVzJzoge1xuXHRcdFx0XHRcdFx0J2Rpc3BsYXknOiAnaW5saW5lJ1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0bmV3IEVsZW1lbnQoJ3VsJywge1xuXHRcdFx0XHRcdCdjbGFzcyc6ICdsZXZlbF8nICsgbGV2ZWwsXG5cdFx0XHRcdFx0J2h0bWwnOiB0eHRcblx0XHRcdFx0fSkuaW5qZWN0KGxpLCAnYm90dG9tJyk7XG5cblx0XHRcdFx0bGkuaW5qZWN0KCQoZWwpLmdldFBhcmVudCgnbGknKSwgJ2FmdGVyJyk7XG5cblx0XHRcdFx0Ly8gVXBkYXRlIHRoZSByZWZlcmVyIElEXG5cdFx0XHRcdGxpLmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLmhyZWYgPSBlbC5ocmVmLnJlcGxhY2UoLyZyZWY9W2EtZjAtOV0rLywgJyZyZWY9JyArIENvbnRhby5yZWZlcmVyX2lkKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0JChlbCkuYWRkQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5jb2xsYXBzZSk7XG5cblx0XHRcdFx0QWpheFJlcXVlc3QuaGlkZUJveCgpO1xuXG5cdFx0XHRcdC8vIEhPT0tcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcbiAgIFx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzonbG9hZEZpbGVNYW5hZ2VyJywgJ2lkJzppZCwgJ2xldmVsJzpsZXZlbCwgJ2ZvbGRlcic6Zm9sZGVyLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgc3ViLXBhbGV0dGVzIGluIGVkaXQgbW9kZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgICBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBUaGUgZmllbGQgbmFtZVxuXHQgKi9cblx0dG9nZ2xlU3VicGFsZXR0ZTogZnVuY3Rpb24oZWwsIGlkLCBmaWVsZCkge1xuXHRcdGVsLmJsdXIoKTtcblx0XHR2YXIgaXRlbSA9ICQoaWQpO1xuXG5cdFx0aWYgKGl0ZW0pIHtcblx0XHRcdGlmICghZWwudmFsdWUpIHtcblx0XHRcdFx0ZWwudmFsdWUgPSAxO1xuXHRcdFx0XHRlbC5jaGVja2VkID0gJ2NoZWNrZWQnO1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cdFx0XHRcdGl0ZW0uZ2V0RWxlbWVudHMoJ1tkYXRhLXJlcXVpcmVkXScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0XHRlbC5zZXQoJ3JlcXVpcmVkJywgJycpLnNldCgnZGF0YS1yZXF1aXJlZCcsIG51bGwpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtmaWVsZDogZWwsIG9uU3VjY2Vzczp1cGRhdGVWZXJzaW9uTnVtYmVyfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZVN1YnBhbGV0dGUnLCAnaWQnOmlkLCAnZmllbGQnOmZpZWxkLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWwudmFsdWUgPSAnJztcblx0XHRcdFx0ZWwuY2hlY2tlZCA9ICcnO1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdFx0aXRlbS5nZXRFbGVtZW50cygnW3JlcXVpcmVkXScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0XHRlbC5zZXQoJ3JlcXVpcmVkJywgbnVsbCkuc2V0KCdkYXRhLXJlcXVpcmVkJywgJycpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtmaWVsZDogZWwsIG9uU3VjY2Vzczp1cGRhdGVWZXJzaW9uTnVtYmVyfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZVN1YnBhbGV0dGUnLCAnaWQnOmlkLCAnZmllbGQnOmZpZWxkLCAnc3RhdGUnOjAsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7XG5cdFx0XHRmaWVsZDogZWwsXG5cdFx0XHRldmFsU2NyaXB0czogZmFsc2UsXG5cdFx0XHRvblJlcXVlc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRBamF4UmVxdWVzdC5kaXNwbGF5Qm94KENvbnRhby5sYW5nLmxvYWRpbmcgKyAnIOKApicpO1xuXHRcdFx0fSxcblx0XHRcdG9uU3VjY2VzczogZnVuY3Rpb24odHh0LCBqc29uKSB7XG5cdFx0XHRcdHZhciBkaXYgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHRcdCdpZCc6IGlkLFxuXHRcdFx0XHRcdCdjbGFzcyc6ICdzdWJwYWwgY2YnLFxuXHRcdFx0XHRcdCdodG1sJzogdHh0LFxuXHRcdFx0XHRcdCdzdHlsZXMnOiB7XG5cdFx0XHRcdFx0XHQnZGlzcGxheSc6ICdibG9jaydcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pLmluamVjdCgkKGVsKS5nZXRQYXJlbnQoJ2RpdicpLmdldFBhcmVudCgnZGl2JyksICdhZnRlcicpO1xuXG5cdFx0XHRcdC8vIEV4ZWN1dGUgc2NyaXB0cyBhZnRlciB0aGUgRE9NIGhhcyBiZWVuIHVwZGF0ZWRcblx0XHRcdFx0aWYgKGpzb24uamF2YXNjcmlwdCkge1xuXG5cdFx0XHRcdFx0Ly8gVXNlIEFzc2V0LmphdmFzY3JpcHQoKSBpbnN0ZWFkIG9mIGRvY3VtZW50LndyaXRlKCkgdG8gbG9hZCBhXG5cdFx0XHRcdFx0Ly8gSmF2YVNjcmlwdCBmaWxlIGFuZCByZS1leGVjdXRlIHRoZSBjb2RlIGFmdGVyIGl0IGhhcyBiZWVuIGxvYWRlZFxuXHRcdFx0XHRcdGRvY3VtZW50LndyaXRlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0XHRcdFx0XHR2YXIgc3JjID0gJyc7XG5cdFx0XHRcdFx0XHRzdHIucmVwbGFjZSgvPHNjcmlwdCBzcmM9XCIoW15cIl0rKVwiL2ksIGZ1bmN0aW9uKGFsbCwgbWF0Y2gpe1xuXHRcdFx0XHRcdFx0XHRzcmMgPSBtYXRjaDtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0c3JjICYmIEFzc2V0LmphdmFzY3JpcHQoc3JjLCB7XG5cdFx0XHRcdFx0XHRcdG9uTG9hZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0QnJvd3Nlci5leGVjKGpzb24uamF2YXNjcmlwdCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRCcm93c2VyLmV4ZWMoanNvbi5qYXZhc2NyaXB0KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGVsLnZhbHVlID0gMTtcblx0XHRcdFx0ZWwuY2hlY2tlZCA9ICdjaGVja2VkJztcblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHJlZmVyZXIgSURcblx0XHRcdFx0ZGl2LmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLmhyZWYgPSBlbC5ocmVmLnJlcGxhY2UoLyZyZWY9W2EtZjAtOV0rLywgJyZyZWY9JyArIENvbnRhby5yZWZlcmVyX2lkKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dXBkYXRlVmVyc2lvbk51bWJlcih0eHQpO1xuXG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmhpZGVCb3goKTtcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcblx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdsb2FkJzoxLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXG5cdFx0ZnVuY3Rpb24gdXBkYXRlVmVyc2lvbk51bWJlcihodG1sKSB7XG5cdFx0XHR2YXIgZmllbGRzID0gZWwuZm9ybS5lbGVtZW50cy5WRVJTSU9OX05VTUJFUiB8fCBbXTtcblx0XHRcdGlmICghZmllbGRzLmZvckVhY2gpIHtcblx0XHRcdFx0ZmllbGRzID0gW2ZpZWxkc107XG5cdFx0XHR9XG5cdFx0XHRmaWVsZHMuZm9yRWFjaChmdW5jdGlvbihmaWVsZCkge1xuXHRcdFx0XHRmaWVsZC52YWx1ZSA9IC88aW5wdXRcXHMrW14+XSo/bmFtZT1cIlZFUlNJT05fTlVNQkVSXCJcXHMrW14+XSo/dmFsdWU9XCIoW15cIl0qKVwiL2kuZXhlYyhodG1sKVsxXTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIHRoZSBzdGF0ZSBvZiBhIGNoZWNrYm94IGZpZWxkXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSAgZWwgICAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtib29sZWFufSByb3dJY29uIFdoZXRoZXIgdGhlIHJvdyBpY29uIHNob3VsZCBiZSB0b2dnbGVkIGFzIHdlbGxcblx0ICpcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHR0b2dnbGVGaWVsZDogZnVuY3Rpb24oZWwsIHJvd0ljb24pIHtcblx0XHRlbC5ibHVyKCk7XG5cblx0XHR2YXIgaW1nID0gbnVsbCxcblx0XHRcdGltYWdlcyA9ICQoZWwpLmdldEVsZW1lbnRzKCdpbWcnKSxcblx0XHRcdHB1Ymxpc2hlZCA9IChpbWFnZXNbMF0uZ2V0KCdkYXRhLXN0YXRlJykgPT0gMSksXG5cdFx0XHRkaXYgPSBlbC5nZXRQYXJlbnQoJ2RpdicpLFxuXHRcdFx0bmV4dCwgcGE7XG5cblx0XHRpZiAocm93SWNvbikge1xuXHRcdFx0Ly8gRmluZCB0aGUgaWNvbiBkZXBlbmRpbmcgb24gdGhlIHZpZXcgKHRyZWUgdmlldywgbGlzdCB2aWV3LCBwYXJlbnQgdmlldylcblx0XHRcdGlmIChkaXYuaGFzQ2xhc3MoJ3RsX3JpZ2h0JykpIHtcblx0XHRcdFx0aW1nID0gZGl2LmdldFByZXZpb3VzKCdkaXYnKS5nZXRFbGVtZW50cygnaW1nJyk7XG5cdFx0XHR9IGVsc2UgaWYgKGRpdi5oYXNDbGFzcygndGxfbGlzdGluZ19jb250YWluZXInKSkge1xuXHRcdFx0XHRpbWcgPSBlbC5nZXRQYXJlbnQoJ3RkJykuZ2V0UHJldmlvdXMoJ3RkJykuZ2V0Rmlyc3QoJ2Rpdi5saXN0X2ljb24nKTtcblx0XHRcdFx0aWYgKGltZyA9PT0gbnVsbCkgeyAvLyBjb21tZW50c1xuXHRcdFx0XHRcdGltZyA9IGVsLmdldFBhcmVudCgndGQnKS5nZXRQcmV2aW91cygndGQnKS5nZXRFbGVtZW50KCdkaXYuY3RlX3R5cGUnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaW1nID09PSBudWxsKSB7IC8vIHNob3dDb2x1bW5zXG5cdFx0XHRcdFx0aW1nID0gZWwuZ2V0UGFyZW50KCd0cicpLmdldEZpcnN0KCd0ZCcpLmdldEVsZW1lbnQoJ2Rpdi5saXN0X2ljb25fbmV3Jyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobmV4dCA9IGRpdi5nZXROZXh0KCdkaXYnKSkge1xuXHRcdFx0XHRpZiAobmV4dC5oYXNDbGFzcygnY3RlX3R5cGUnKSkge1xuXHRcdFx0XHRcdGltZyA9IG5leHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGltZyA9PT0gbnVsbCkgeyAvLyBuZXdzbGV0dGVyIHJlY2lwaWVudHNcblx0XHRcdFx0XHRpbWcgPSBuZXh0LmdldEZpcnN0KCdkaXYubGlzdF9pY29uJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hhbmdlIHRoZSByb3cgaWNvblxuXHRcdFx0aWYgKGltZyAhPT0gbnVsbCkge1xuXHRcdFx0XHQvLyBUcmVlIHZpZXdcblx0XHRcdFx0aWYgKCEoaW1nIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpICYmIGltZy5mb3JFYWNoKSB7XG5cdFx0XHRcdFx0aW1nLmZvckVhY2goKGltZykgPT4ge1xuXHRcdFx0XHRcdFx0aWYgKGltZy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09ICdpbWcnKSB7XG5cdFx0XHRcdFx0XHRcdGlmICghaW1nLmdldFBhcmVudCgndWwudGxfbGlzdGluZycpLmhhc0NsYXNzKCd0bF90cmVlX3h0bmQnKSkge1xuXHRcdFx0XHRcdFx0XHRcdHBhID0gaW1nLmdldFBhcmVudCgnYScpO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHBhICYmIHBhLmhyZWYuaW5kZXhPZignY29udGFvL3ByZXZpZXcnKSA9PSAtMSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG5leHQgPSBwYS5nZXROZXh0KCdhJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aW1nID0gbmV4dC5nZXRFbGVtZW50KCdpbWcnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGltZyA9IG5ldyBFbGVtZW50KCdpbWcnKTsgLy8gbm8gaWNvbnMgdXNlZCAoc2VlICMyMjg2KVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGNvbnN0IG5ld1NyYyA9ICFwdWJsaXNoZWQgPyBpbWcuZ2V0KCdkYXRhLWljb24nKSA6IGltZy5nZXQoJ2RhdGEtaWNvbi1kaXNhYmxlZCcpO1xuXHRcdFx0XHRcdFx0XHRpbWcuc3JjID0gKGltZy5zcmMuaW5jbHVkZXMoJy8nKSAmJiAhbmV3U3JjLmluY2x1ZGVzKCcvJykpID8gaW1nLnNyYy5zbGljZSgwLCBpbWcuc3JjLmxhc3RJbmRleE9mKCcvJykgKyAxKSArIG5ld1NyYyA6IG5ld1NyYztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIFBhcmVudCB2aWV3XG5cdFx0XHRcdGVsc2UgaWYgKGltZy5oYXNDbGFzcygnY3RlX3R5cGUnKSkge1xuXHRcdFx0XHRcdGlmICghcHVibGlzaGVkKSB7XG5cdFx0XHRcdFx0XHRpbWcuYWRkQ2xhc3MoJ3B1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdFx0aW1nLnJlbW92ZUNsYXNzKCd1bnB1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpbWcuYWRkQ2xhc3MoJ3VucHVibGlzaGVkJyk7XG5cdFx0XHRcdFx0XHRpbWcucmVtb3ZlQ2xhc3MoJ3B1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBMaXN0IHZpZXdcblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0aW1nLnNldFN0eWxlKCdiYWNrZ3JvdW5kLWltYWdlJywgJ3VybCgnICsgKCFwdWJsaXNoZWQgPyBpbWcuZ2V0KCdkYXRhLWljb24nKSA6IGltZy5nZXQoJ2RhdGEtaWNvbi1kaXNhYmxlZCcpKSArICcpJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTZW5kIHJlcXVlc3Rcblx0XHRpbWFnZXMuZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xuXHRcdFx0Y29uc3QgbmV3U3JjID0gIXB1Ymxpc2hlZCA/IGltYWdlLmdldCgnZGF0YS1pY29uJykgOiBpbWFnZS5nZXQoJ2RhdGEtaWNvbi1kaXNhYmxlZCcpO1xuXHRcdFx0aW1hZ2Uuc3JjID0gKGltYWdlLnNyYy5pbmNsdWRlcygnLycpICYmICFuZXdTcmMuaW5jbHVkZXMoJy8nKSkgPyBpbWFnZS5zcmMuc2xpY2UoMCwgaW1hZ2Uuc3JjLmxhc3RJbmRleE9mKCcvJykgKyAxKSArIG5ld1NyYyA6IG5ld1NyYztcblx0XHRcdGltYWdlLnNldCgnZGF0YS1zdGF0ZScsICFwdWJsaXNoZWQgPyAxIDogMCk7XG5cdFx0fSk7XG5cblx0XHRpZiAoIXB1Ymxpc2hlZCAmJiAkKGVsKS5nZXQoJ2RhdGEtdGl0bGUnKSkge1xuXHRcdFx0ZWwudGl0bGUgPSAkKGVsKS5nZXQoJ2RhdGEtdGl0bGUnKTtcblx0XHR9IGVsc2UgaWYgKHB1Ymxpc2hlZCAmJiAkKGVsKS5nZXQoJ2RhdGEtdGl0bGUtZGlzYWJsZWQnKSkge1xuXHRcdFx0ZWwudGl0bGUgPSAkKGVsKS5nZXQoJ2RhdGEtdGl0bGUtZGlzYWJsZWQnKTtcblx0XHR9XG5cblx0XHRuZXcgUmVxdWVzdC5Db250YW8oeyd1cmwnOmVsLmhyZWYsICdmb2xsb3dSZWRpcmVjdHMnOmZhbHNlfSkuZ2V0KCk7XG5cblx0XHQvLyBSZXR1cm4gZmFsc2UgdG8gc3RvcCB0aGUgY2xpY2sgZXZlbnQgb24gbGlua1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIGEgZ3JvdXAgb2YgYSBtdWx0aS1jaGVja2JveCBmaWVsZFxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0dG9nZ2xlQ2hlY2tib3hHcm91cDogZnVuY3Rpb24oZWwsIGlkKSB7XG5cdFx0ZWwuYmx1cigpO1xuXG5cdFx0dmFyIGl0ZW0gPSAkKGlkKTtcblxuXHRcdGlmIChpdGVtKSB7XG5cdFx0XHRpZiAoaXRlbS5nZXRTdHlsZSgnZGlzcGxheScpID09ICdub25lJykge1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cdFx0XHRcdCQoZWwpLmFkZENsYXNzKCdmb2xkYWJsZS0tb3BlbicpO1xuXG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbygpLnBvc3QoeydhY3Rpb24nOid0b2dnbGVDaGVja2JveEdyb3VwJywgJ2lkJzppZCwgJ3N0YXRlJzoxLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHQkKGVsKS5yZW1vdmVDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oKS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlQ2hlY2tib3hHcm91cCcsICdpZCc6aWQsICdzdGF0ZSc6MCwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIERpc3BsYXkgdGhlIFwibG9hZGluZyBkYXRhXCIgbWVzc2FnZVxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgbWVzc2FnZSB0ZXh0XG5cdCAqL1xuXHRkaXNwbGF5Qm94OiBmdW5jdGlvbihtZXNzYWdlKSB7XG5cdFx0dmFyIGJveCA9ICQoJ3RsX2FqYXhCb3gnKSxcblx0XHRcdG92ZXJsYXkgPSAkKCd0bF9hamF4T3ZlcmxheScpLFxuXHRcdFx0c2Nyb2xsID0gd2luZG93LmdldFNjcm9sbCgpO1xuXG5cdFx0aWYgKG92ZXJsYXkgPT09IG51bGwpIHtcblx0XHRcdG92ZXJsYXkgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHQnaWQnOiAndGxfYWpheE92ZXJsYXknXG5cdFx0XHR9KS5pbmplY3QoJChkb2N1bWVudC5ib2R5KSwgJ2JvdHRvbScpO1xuXHRcdH1cblxuXHRcdG92ZXJsYXkuc2V0KHtcblx0XHRcdCdzdHlsZXMnOiB7XG5cdFx0XHRcdCdkaXNwbGF5JzogJ2Jsb2NrJyxcblx0XHRcdFx0J3RvcCc6IHNjcm9sbC55ICsgJ3B4J1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGJveCA9PT0gbnVsbCkge1xuXHRcdFx0Ym94ID0gbmV3IEVsZW1lbnQoJ2RpdicsIHtcblx0XHRcdFx0J2lkJzogJ3RsX2FqYXhCb3gnXG5cdFx0XHR9KS5pbmplY3QoJChkb2N1bWVudC5ib2R5KSwgJ2JvdHRvbScpO1xuXHRcdH1cblxuXHRcdGJveC5zZXQoe1xuXHRcdFx0J2h0bWwnOiBtZXNzYWdlLFxuXHRcdFx0J3N0eWxlcyc6IHtcblx0XHRcdFx0J2Rpc3BsYXknOiAnYmxvY2snLFxuXHRcdFx0XHQndG9wJzogKHNjcm9sbC55ICsgMTAwKSArICdweCdcblx0XHRcdH1cblx0XHR9KVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBIaWRlIHRoZSBcImxvYWRpbmcgZGF0YVwiIG1lc3NhZ2Vcblx0ICovXG5cdGhpZGVCb3g6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBib3ggPSAkKCd0bF9hamF4Qm94JyksXG5cdFx0XHRvdmVybGF5ID0gJCgndGxfYWpheE92ZXJsYXknKTtcblxuXHRcdGlmIChvdmVybGF5KSB7XG5cdFx0XHRvdmVybGF5LnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHR9XG5cblx0XHRpZiAoYm94KSB7XG5cdFx0XHRib3guc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdH1cblx0fVxufTtcblxuLyoqXG4gKiBQcm92aWRlIG1ldGhvZHMgdG8gaGFuZGxlIGJhY2sgZW5kIHRhc2tzLlxuICpcbiAqIEBhdXRob3IgTGVvIEZleWVyIDxodHRwczovL2dpdGh1Yi5jb20vbGVvZmV5ZXI+XG4gKi9cbndpbmRvdy5CYWNrZW5kID1cbntcblx0LyoqXG5cdCAqIFRoZSBjdXJyZW50IElEXG5cdCAqIEBtZW1iZXIgeyhzdHJpbmd8bnVsbCl9XG5cdCAqL1xuXHRjdXJyZW50SWQ6IG51bGwsXG5cblx0LyoqXG5cdCAqIFRoZSBwb3B1cCB3aW5kb3dcblx0ICogQG1lbWJlciB7b2JqZWN0fVxuXHQgKi9cblx0cG9wdXBXaW5kb3c6IG51bGwsXG5cblx0LyoqXG5cdCAqIFRoZSB0aGVtZSBwYXRoXG5cdCAqIEBtZW1iZXIge3N0cmluZ31cblx0ICovXG5cdHRoZW1lUGF0aDogQ29udGFvLnNjcmlwdF91cmwgKyAnc3lzdGVtL3RoZW1lcy8nICsgQ29udGFvLnRoZW1lICsgJy8nLFxuXG5cdC8qKlxuXHQgKiBPcGVuIGEgbW9kYWwgd2luZG93XG5cdCAqXG5cdCAqIEBwYXJhbSB7aW50fSAgICB3aWR0aCAgIFRoZSB3aWR0aCBpbiBwaXhlbHNcblx0ICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlICAgVGhlIHdpbmRvdydzIHRpdGxlXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBjb250ZW50IFRoZSB3aW5kb3cncyBjb250ZW50XG5cdCAqL1xuXHRvcGVuTW9kYWxXaW5kb3c6IGZ1bmN0aW9uKHdpZHRoLCB0aXRsZSwgY29udGVudCkge1xuXHRcdG5ldyBTaW1wbGVNb2RhbCh7XG5cdFx0XHQnd2lkdGgnOiB3aWR0aCxcblx0XHRcdCdoaWRlRm9vdGVyJzogdHJ1ZSxcblx0XHRcdCdkcmFnZ2FibGUnOiBmYWxzZSxcblx0XHRcdCdvdmVybGF5T3BhY2l0eSc6IC43LFxuXHRcdFx0J29uU2hvdyc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdoaWRkZW4nKTsgfSxcblx0XHRcdCdvbkhpZGUnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnYXV0bycpOyB9XG5cdFx0fSkuc2hvdyh7XG5cdFx0XHQndGl0bGUnOiB0aXRsZSxcblx0XHRcdCdjb250ZW50cyc6IGNvbnRlbnRcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogT3BlbiBhbiBpbWFnZSBpbiBhIG1vZGFsIHdpbmRvd1xuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBBbiBvcHRpb25hbCBvcHRpb25zIG9iamVjdFxuXHQgKi9cblx0b3Blbk1vZGFsSW1hZ2U6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgb3B0ID0gb3B0aW9ucyB8fCB7fSxcblx0XHRcdG1heFdpZHRoID0gKHdpbmRvdy5nZXRTaXplKCkueCAtIDIwKS50b0ludCgpO1xuXHRcdGlmICghb3B0LndpZHRoIHx8IG9wdC53aWR0aCA+IG1heFdpZHRoKSBvcHQud2lkdGggPSBNYXRoLm1pbihtYXhXaWR0aCwgOTAwKTtcblx0XHR2YXIgTSA9IG5ldyBTaW1wbGVNb2RhbCh7XG5cdFx0XHQnd2lkdGgnOiBvcHQud2lkdGgsXG5cdFx0XHQnaGlkZUZvb3Rlcic6IHRydWUsXG5cdFx0XHQnZHJhZ2dhYmxlJzogZmFsc2UsXG5cdFx0XHQnb3ZlcmxheU9wYWNpdHknOiAuNyxcblx0XHRcdCdvblNob3cnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7IH0sXG5cdFx0XHQnb25IaWRlJzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2F1dG8nKTsgfVxuXHRcdH0pO1xuXHRcdE0uc2hvdyh7XG5cdFx0XHQndGl0bGUnOiBvcHQudGl0bGU/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKSxcblx0XHRcdCdjb250ZW50cyc6ICc8aW1nIHNyYz1cIicgKyBvcHQudXJsICsgJ1wiIGFsdD1cIlwiPidcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogT3BlbiBhbiBpZnJhbWUgaW4gYSBtb2RhbCB3aW5kb3dcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9uYWwgb3B0aW9ucyBvYmplY3Rcblx0ICovXG5cdG9wZW5Nb2RhbElmcmFtZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBvcHQgPSBvcHRpb25zIHx8IHt9LFxuXHRcdFx0bWF4V2lkdGggPSAod2luZG93LmdldFNpemUoKS54IC0gMjApLnRvSW50KCksXG5cdFx0XHRtYXhIZWlnaHQgPSAod2luZG93LmdldFNpemUoKS55IC0gMTM3KS50b0ludCgpO1xuXHRcdGlmICghb3B0LndpZHRoIHx8IG9wdC53aWR0aCA+IG1heFdpZHRoKSBvcHQud2lkdGggPSBNYXRoLm1pbihtYXhXaWR0aCwgOTAwKTtcblx0XHRpZiAoIW9wdC5oZWlnaHQgfHwgb3B0LmhlaWdodCA+IG1heEhlaWdodCkgb3B0LmhlaWdodCA9IG1heEhlaWdodDtcblx0XHR2YXIgTSA9IG5ldyBTaW1wbGVNb2RhbCh7XG5cdFx0XHQnd2lkdGgnOiBvcHQud2lkdGgsXG5cdFx0XHQnaGlkZUZvb3Rlcic6IHRydWUsXG5cdFx0XHQnZHJhZ2dhYmxlJzogZmFsc2UsXG5cdFx0XHQnb3ZlcmxheU9wYWNpdHknOiAuNyxcblx0XHRcdCdvblNob3cnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7IH0sXG5cdFx0XHQnb25IaWRlJzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2F1dG8nKTsgfVxuXHRcdH0pO1xuXHRcdE0uc2hvdyh7XG5cdFx0XHQndGl0bGUnOiBvcHQudGl0bGU/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKSxcblx0XHRcdCdjb250ZW50cyc6ICc8aWZyYW1lIHNyYz1cIicgKyBvcHQudXJsICsgJ1wiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIicgKyBvcHQuaGVpZ2h0ICsgJ1wiIGZyYW1lYm9yZGVyPVwiMFwiPjwvaWZyYW1lPicsXG5cdFx0XHQnbW9kZWwnOiAnbW9kYWwnXG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wZW4gYSBzZWxlY3RvciBwYWdlIGluIGEgbW9kYWwgd2luZG93XG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0XG5cdCAqL1xuXHRvcGVuTW9kYWxTZWxlY3RvcjogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBvcHQgPSBvcHRpb25zIHx8IHt9LFxuXHRcdFx0bWF4V2lkdGggPSAod2luZG93LmdldFNpemUoKS54IC0gMjApLnRvSW50KCksXG5cdFx0XHRtYXhIZWlnaHQgPSAod2luZG93LmdldFNpemUoKS55IC0gMTkyKS50b0ludCgpO1xuXHRcdGlmICghb3B0LmlkKSBvcHQuaWQgPSAndGxfc2VsZWN0Jztcblx0XHRpZiAoIW9wdC53aWR0aCB8fCBvcHQud2lkdGggPiBtYXhXaWR0aCkgb3B0LndpZHRoID0gTWF0aC5taW4obWF4V2lkdGgsIDkwMCk7XG5cdFx0aWYgKCFvcHQuaGVpZ2h0IHx8IG9wdC5oZWlnaHQgPiBtYXhIZWlnaHQpIG9wdC5oZWlnaHQgPSBtYXhIZWlnaHQ7XG5cdFx0dmFyIE0gPSBuZXcgU2ltcGxlTW9kYWwoe1xuXHRcdFx0J3dpZHRoJzogb3B0LndpZHRoLFxuXHRcdFx0J2RyYWdnYWJsZSc6IGZhbHNlLFxuXHRcdFx0J292ZXJsYXlPcGFjaXR5JzogLjcsXG5cdFx0XHQnb25TaG93JzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2hpZGRlbicpOyB9LFxuXHRcdFx0J29uSGlkZSc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdhdXRvJyk7IH1cblx0XHR9KTtcblx0XHRNLmFkZEJ1dHRvbihDb250YW8ubGFuZy5jYW5jZWwsICdidG4nLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLmJ1dHRvbnNbMF0uaGFzQ2xhc3MoJ2J0bi1kaXNhYmxlZCcpKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHRoaXMuaGlkZSgpO1xuXHRcdH0pO1xuXHRcdE0uYWRkQnV0dG9uKENvbnRhby5sYW5nLmFwcGx5LCAnYnRuIHByaW1hcnknLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLmJ1dHRvbnNbMV0uaGFzQ2xhc3MoJ2J0bi1kaXNhYmxlZCcpKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHZhciBmcm0gPSB3aW5kb3cuZnJhbWVzWydzaW1wbGUtbW9kYWwtaWZyYW1lJ10sXG5cdFx0XHRcdHZhbCA9IFtdLCB1bCwgaW5wLCBpLCBwaWNrZXJWYWx1ZSwgc0luZGV4O1xuXHRcdFx0aWYgKGZybSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGFsZXJ0KCdDb3VsZCBub3QgZmluZCB0aGUgU2ltcGxlTW9kYWwgZnJhbWUnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dWwgPSBmcm0uZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3B0LmlkKTtcblx0XHRcdC8vIExvYWQgdGhlIHByZXZpb3VzIHZhbHVlcyAoIzE4MTYpXG5cdFx0XHRpZiAocGlja2VyVmFsdWUgPSB1bC5nZXQoJ2RhdGEtcGlja2VyLXZhbHVlJykpIHtcblx0XHRcdFx0dmFsID0gSlNPTi5wYXJzZShwaWNrZXJWYWx1ZSk7XG5cdFx0XHR9XG5cdFx0XHRpbnAgPSB1bC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKTtcblx0XHRcdGZvciAoaT0wOyBpPGlucC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAoaW5wW2ldLmlkLm1hdGNoKC9eKGNoZWNrX2FsbF98cmVzZXRfKS8pKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gQWRkIGN1cnJlbnRseSBzZWxlY3RlZCB2YWx1ZSwgb3RoZXJ3aXNlIHJlbW92ZSAoIzE4MTYpXG5cdFx0XHRcdHNJbmRleCA9IHZhbC5pbmRleE9mKGlucFtpXS5nZXQoJ3ZhbHVlJykpO1xuXHRcdFx0XHRpZiAoaW5wW2ldLmNoZWNrZWQpIHtcblx0XHRcdFx0XHRpZiAoc0luZGV4ID09IC0xKSB7XG5cdFx0XHRcdFx0XHR2YWwucHVzaChpbnBbaV0uZ2V0KCd2YWx1ZScpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSBpZiAoc0luZGV4ICE9IC0xKSB7XG5cdFx0XHRcdFx0dmFsLnNwbGljZShzSW5kZXgsIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRvcHQuY2FsbGJhY2sodWwuZ2V0KCdkYXRhLXRhYmxlJyksIHZhbCk7XG5cdFx0XHR0aGlzLmhpZGUoKTtcblx0XHR9KTtcblx0XHRNLnNob3coe1xuXHRcdFx0J3RpdGxlJzogb3B0LnRpdGxlPy5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLzwvZywgJyZsdDsnKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykucmVwbGFjZSgvJy9nLCAnJmFwb3M7JyksXG5cdFx0XHQnY29udGVudHMnOiAnPGlmcmFtZSBzcmM9XCInICsgb3B0LnVybCArICdcIiBuYW1lPVwic2ltcGxlLW1vZGFsLWlmcmFtZVwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIicgKyBvcHQuaGVpZ2h0ICsgJ1wiIGZyYW1lYm9yZGVyPVwiMFwiPjwvaWZyYW1lPicsXG5cdFx0XHQnbW9kZWwnOiAnbW9kYWwnXG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wZW4gYSBUaW55TUNFIGZpbGUgYnJvd3NlciBpbiBhIG1vZGFsIHdpbmRvd1xuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZmllbGRfbmFtZSBUaGUgZmllbGQgbmFtZVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsICAgICAgICBUaGUgVVJMXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlICAgICAgIFRoZSBwaWNrZXIgdHlwZVxuXHQgKiBAcGFyYW0ge29iamVjdH0gd2luICAgICAgICBUaGUgd2luZG93IG9iamVjdFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlICAgICBUaGUgc291cmNlIHJlY29yZFxuXHQgKi9cblx0b3Blbk1vZGFsQnJvd3NlcjogZnVuY3Rpb24oZmllbGRfbmFtZSwgdXJsLCB0eXBlLCB3aW4sIHNvdXJjZSkge1xuXHRcdEJhY2tlbmQub3Blbk1vZGFsU2VsZWN0b3Ioe1xuXHRcdFx0J2lkJzogJ3RsX2xpc3RpbmcnLFxuXHRcdFx0J3RpdGxlJzogd2luLmRvY3VtZW50LmdldEVsZW1lbnQoJ2Rpdi5tY2UtdGl0bGUnKS5nZXQoJ3RleHQnKSxcblx0XHRcdCd1cmwnOiBDb250YW8ucm91dGVzLmJhY2tlbmRfcGlja2VyICsgJz9jb250ZXh0PScgKyAodHlwZSA9PSAnZmlsZScgPyAnbGluaycgOiAnZmlsZScpICsgJyZhbXA7ZXh0cmFzW2ZpZWxkVHlwZV09cmFkaW8mYW1wO2V4dHJhc1tmaWxlc09ubHldPXRydWUmYW1wO2V4dHJhc1tzb3VyY2VdPScgKyBzb3VyY2UgKyAnJmFtcDt2YWx1ZT0nICsgdXJsICsgJyZhbXA7cG9wdXA9MScsXG5cdFx0XHQnY2FsbGJhY2snOiBmdW5jdGlvbih0YWJsZSwgdmFsdWUpIHtcblx0XHRcdFx0d2luLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZpZWxkX25hbWUpLnZhbHVlID0gdmFsdWUuam9pbignLCcpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBBdXRvbWF0aWNhbGx5IHN1Ym1pdCBhIGZvcm1cblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKi9cblx0YXV0b1N1Ym1pdDogZnVuY3Rpb24oZWwpIHtcblx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cblx0XHR2YXIgaGlkZGVuID0gbmV3IEVsZW1lbnQoJ2lucHV0Jywge1xuXHRcdFx0J3R5cGUnOiAnaGlkZGVuJyxcblx0XHRcdCduYW1lJzogJ1NVQk1JVF9UWVBFJyxcblx0XHRcdCd2YWx1ZSc6ICdhdXRvJ1xuXHRcdH0pO1xuXG5cdFx0dmFyIGZvcm0gPSAkKGVsKSB8fCBlbDtcblx0XHRoaWRkZW4uaW5qZWN0KGZvcm0sICdib3R0b20nKTtcblx0XHRmb3JtLnN1Ym1pdCgpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBTY3JvbGwgdGhlIHdpbmRvdyB0byBhIGNlcnRhaW4gdmVydGljYWwgcG9zaXRpb25cblx0ICpcblx0ICogQHBhcmFtIHtpbnR9IG9mZnNldCBUaGUgb2Zmc2V0IHRvIHNjcm9sbCB0b1xuXHQgKi9cblx0dlNjcm9sbFRvOiBmdW5jdGlvbihvZmZzZXQpIHtcblx0XHRpZiAod2luZG93LmNvbnNvbGUpIHtcblx0XHRcdGNvbnNvbGUud2FybignQmFja2VuZC52U2Nyb2xsVG8oKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBTdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG5cdFx0fVxuXG5cdFx0d2luZG93LmFkZEV2ZW50KCdsb2FkJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR3aW5kb3cuc2Nyb2xsVG8obnVsbCwgcGFyc2VJbnQob2Zmc2V0KSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSBjaGVja2JveGVzXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgIFRoZSBET00gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gW2lkXSBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHR0b2dnbGVDaGVja2JveGVzOiBmdW5jdGlvbihlbCwgaWQpIHtcblx0XHR2YXIgaXRlbXMgPSAkJCgnaW5wdXQnKSxcblx0XHRcdHN0YXR1cyA9ICQoZWwpLmNoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJztcblxuXHRcdGZvciAodmFyIGk9MDsgaTxpdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKGl0ZW1zW2ldLnR5cGUudG9Mb3dlckNhc2UoKSAhPSAnY2hlY2tib3gnKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGlkICE9PSB1bmRlZmluZWQgJiYgaWQgIT0gaXRlbXNbaV0uaWQuc3Vic3RyKDAsIGlkLmxlbmd0aCkpIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cdFx0XHRpdGVtc1tpXS5jaGVja2VkID0gc3RhdHVzO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIGEgY2hlY2tib3ggZ3JvdXBcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0dG9nZ2xlQ2hlY2tib3hHcm91cDogZnVuY3Rpb24oZWwsIGlkKSB7XG5cdFx0dmFyIGNscyA9ICQoZWwpLmNsYXNzTmFtZSxcblx0XHRcdHN0YXR1cyA9ICQoZWwpLmNoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJztcblxuXHRcdGlmIChjbHMgPT0gJ3RsX2NoZWNrYm94Jykge1xuXHRcdFx0dmFyIGNieCA9ICQoaWQpID8gJCQoJyMnICsgaWQgKyAnIC50bF9jaGVja2JveCcpIDogJChlbCkuZ2V0UGFyZW50KCdmaWVsZHNldCcpLmdldEVsZW1lbnRzKCcudGxfY2hlY2tib3gnKTtcblx0XHRcdGNieC5lYWNoKGZ1bmN0aW9uKGNoZWNrYm94KSB7XG5cdFx0XHRcdGNoZWNrYm94LmNoZWNrZWQgPSBzdGF0dXM7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKGNscyA9PSAndGxfdHJlZV9jaGVja2JveCcpIHtcblx0XHRcdCQkKCcjJyArIGlkICsgJyAucGFyZW50IC50bF90cmVlX2NoZWNrYm94JykuZWFjaChmdW5jdGlvbihjaGVja2JveCkge1xuXHRcdFx0XHRjaGVja2JveC5jaGVja2VkID0gc3RhdHVzO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgY2hlY2tib3ggZWxlbWVudHNcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGVsICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGNscyBUaGUgQ1NTIGNsYXNzIG5hbWVcblx0ICovXG5cdHRvZ2dsZUNoZWNrYm94RWxlbWVudHM6IGZ1bmN0aW9uKGVsLCBjbHMpIHtcblx0XHR2YXIgc3RhdHVzID0gJChlbCkuY2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnO1xuXG5cdFx0JCQoJy4nICsgY2xzKS5lYWNoKGZ1bmN0aW9uKGNoZWNrYm94KSB7XG5cdFx0XHRpZiAoY2hlY2tib3guaGFzQ2xhc3MoJ3RsX2NoZWNrYm94JykpIHtcblx0XHRcdFx0Y2hlY2tib3guY2hlY2tlZCA9IHN0YXR1cztcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0fSxcblxuXHQvKipcblx0ICogTWFrZSBwYXJlbnQgdmlldyBpdGVtcyBzb3J0YWJsZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gdWwgVGhlIERPTSBlbGVtZW50XG5cdCAqXG5cdCAqIEBhdXRob3IgSm9lIFJheSBHcmVnb3J5XG5cdCAqIEBhdXRob3IgTWFydGluIEF1c3fDtmdlclxuXHQgKi9cblx0bWFrZVBhcmVudFZpZXdTb3J0YWJsZTogZnVuY3Rpb24odWwpIHtcblx0XHR2YXIgZHMgPSBuZXcgU2Nyb2xsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudCgnYm9keScpLCB7XG5cdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oeCwgeSkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc2Nyb2xsVG8odGhpcy5lbGVtZW50LmdldFNjcm9sbCgpLngsIHkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dmFyIGxpc3QgPSBuZXcgU29ydGFibGVzKHVsLCB7XG5cdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRvblN0YXJ0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZHMuc3RhcnQoKTtcblx0XHRcdH0sXG5cdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZHMuc3RvcCgpO1xuXHRcdFx0fSxcblx0XHRcdG9uU29ydDogZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0dmFyIHVsID0gZWwuZ2V0UGFyZW50KCd1bCcpLFxuXHRcdFx0XHRcdHdyYXBMZXZlbCA9IDAsIGRpdnMsIGk7XG5cblx0XHRcdFx0aWYgKCF1bCkgcmV0dXJuO1xuXG5cdFx0XHRcdGRpdnMgPSB1bC5nZXRDaGlsZHJlbignbGkgPiBkaXY6Zmlyc3QtY2hpbGQnKTtcblxuXHRcdFx0XHRpZiAoIWRpdnMpIHJldHVybjtcblxuXHRcdFx0XHRmb3IgKGk9MDsgaTxkaXZzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGRpdnNbaV0uaGFzQ2xhc3MoJ3dyYXBwZXJfc3RvcCcpICYmIHdyYXBMZXZlbCA+IDApIHtcblx0XHRcdFx0XHRcdHdyYXBMZXZlbC0tO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRpdnNbaV0uY2xhc3NOYW1lID0gZGl2c1tpXS5jbGFzc05hbWUucmVwbGFjZSgvKF58XFxzKWluZGVudFteXFxzXSovZywgJycpO1xuXG5cdFx0XHRcdFx0aWYgKHdyYXBMZXZlbCA+IDApIHtcblx0XHRcdFx0XHRcdGRpdnNbaV0uYWRkQ2xhc3MoJ2luZGVudCcpLmFkZENsYXNzKCdpbmRlbnRfJyArIHdyYXBMZXZlbCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGRpdnNbaV0uaGFzQ2xhc3MoJ3dyYXBwZXJfc3RhcnQnKSkge1xuXHRcdFx0XHRcdFx0d3JhcExldmVsKys7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZGl2c1tpXS5yZW1vdmVDbGFzcygnaW5kZW50X2ZpcnN0Jyk7XG5cdFx0XHRcdFx0ZGl2c1tpXS5yZW1vdmVDbGFzcygnaW5kZW50X2xhc3QnKTtcblxuXHRcdFx0XHRcdGlmIChkaXZzW2ktMV0gJiYgZGl2c1tpLTFdLmhhc0NsYXNzKCd3cmFwcGVyX3N0YXJ0JykpIHtcblx0XHRcdFx0XHRcdGRpdnNbaV0uYWRkQ2xhc3MoJ2luZGVudF9maXJzdCcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChkaXZzW2krMV0gJiYgZGl2c1tpKzFdLmhhc0NsYXNzKCd3cmFwcGVyX3N0b3AnKSkge1xuXHRcdFx0XHRcdFx0ZGl2c1tpXS5hZGRDbGFzcygnaW5kZW50X2xhc3QnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnXG5cdFx0fSk7XG5cblx0XHRsaXN0LmFjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0bGlzdC5hZGRFdmVudCgnc3RhcnQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGxpc3QuYWN0aXZlID0gdHJ1ZTtcblx0XHR9KTtcblxuXHRcdGxpc3QuYWRkRXZlbnQoJ2NvbXBsZXRlJywgZnVuY3Rpb24oZWwpIHtcblx0XHRcdGlmICghbGlzdC5hY3RpdmUpIHJldHVybjtcblx0XHRcdHZhciBpZCwgcGlkLCByZXEsIGhyZWY7XG5cblx0XHRcdGlmIChlbC5nZXRQcmV2aW91cygnbGknKSkge1xuXHRcdFx0XHRpZCA9IGVsLmdldCgnaWQnKS5yZXBsYWNlKC9saV8vLCAnJyk7XG5cdFx0XHRcdHBpZCA9IGVsLmdldFByZXZpb3VzKCdsaScpLmdldCgnaWQnKS5yZXBsYWNlKC9saV8vLCAnJyk7XG5cdFx0XHRcdHJlcSA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gucmVwbGFjZSgvaWQ9WzAtOV0qLywgJ2lkPScgKyBpZCkgKyAnJmFjdD1jdXQmbW9kZT0xJnBpZD0nICsgcGlkO1xuXHRcdFx0XHRocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvXFw/LiokLywgJycpO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oeyd1cmwnOmhyZWYgKyByZXEsICdmb2xsb3dSZWRpcmVjdHMnOmZhbHNlfSkuZ2V0KCk7XG5cdFx0XHR9IGVsc2UgaWYgKGVsLmdldFBhcmVudCgndWwnKSkge1xuXHRcdFx0XHRpZCA9IGVsLmdldCgnaWQnKS5yZXBsYWNlKC9saV8vLCAnJyk7XG5cdFx0XHRcdHBpZCA9IGVsLmdldFBhcmVudCgndWwnKS5nZXQoJ2lkJykucmVwbGFjZSgvdWxfLywgJycpO1xuXHRcdFx0XHRyZXEgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnJlcGxhY2UoL2lkPVswLTldKi8sICdpZD0nICsgaWQpICsgJyZhY3Q9Y3V0Jm1vZGU9MiZwaWQ9JyArIHBpZDtcblx0XHRcdFx0aHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnJlcGxhY2UoL1xcPy4qJC8sICcnKTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHsndXJsJzpocmVmICsgcmVxLCAnZm9sbG93UmVkaXJlY3RzJzpmYWxzZX0pLmdldCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBNYWtlIG11bHRpU1JDIGl0ZW1zIHNvcnRhYmxlXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gb2lkIFRoZSBvcmRlciBmaWVsZFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdmFsIFRoZSB2YWx1ZSBmaWVsZFxuXHQgKi9cblx0bWFrZU11bHRpU3JjU29ydGFibGU6IGZ1bmN0aW9uKGlkLCBvaWQsIHZhbCkge1xuXHRcdHZhciBsaXN0ID0gbmV3IFNvcnRhYmxlcygkKGlkKSwge1xuXHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0b3BhY2l0eTogMC42XG5cdFx0fSkuYWRkRXZlbnQoJ2NvbXBsZXRlJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZWxzID0gW10sXG5cdFx0XHRcdGxpcyA9ICQoaWQpLmdldENoaWxkcmVuKCdbZGF0YS1pZF0nKSxcblx0XHRcdFx0aTtcblx0XHRcdGZvciAoaT0wOyBpPGxpcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRlbHMucHVzaChsaXNbaV0uZ2V0KCdkYXRhLWlkJykpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG9pZCA9PT0gdmFsKSB7XG5cdFx0XHRcdCQodmFsKS52YWx1ZS5zcGxpdCgnLCcpLmZvckVhY2goZnVuY3Rpb24oaikge1xuXHRcdFx0XHRcdGlmIChlbHMuaW5kZXhPZihqKSA9PT0gLTEpIHtcblx0XHRcdFx0XHRcdGVscy5wdXNoKGopO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHQkKG9pZCkudmFsdWUgPSBlbHMuam9pbignLCcpO1xuXHRcdH0pO1xuXHRcdCQoaWQpLmdldEVsZW1lbnRzKCcuZ2ltYWdlJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0aWYgKGVsLmhhc0NsYXNzKCdyZW1vdmFibGUnKSkge1xuXHRcdFx0XHRuZXcgRWxlbWVudCgnYnV0dG9uJywge1xuXHRcdFx0XHRcdHR5cGU6ICdidXR0b24nLFxuXHRcdFx0XHRcdGh0bWw6ICcmdGltZXM7Jyxcblx0XHRcdFx0XHQnY2xhc3MnOiAndGxfcmVkJ1xuXHRcdFx0XHR9KS5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgbGkgPSBlbC5nZXRQYXJlbnQoJ2xpJyksXG5cdFx0XHRcdFx0XHRkaWQgPSBsaS5nZXQoJ2RhdGEtaWQnKTtcblx0XHRcdFx0XHQkKHZhbCkudmFsdWUgPSAkKHZhbCkudmFsdWUuc3BsaXQoJywnKS5maWx0ZXIoZnVuY3Rpb24oaikgeyByZXR1cm4gaiAhPSBkaWQ7IH0pLmpvaW4oJywnKTtcblx0XHRcdFx0XHQkKG9pZCkudmFsdWUgPSAkKG9pZCkudmFsdWUuc3BsaXQoJywnKS5maWx0ZXIoZnVuY3Rpb24oaikgeyByZXR1cm4gaiAhPSBkaWQ7IH0pLmpvaW4oJywnKTtcblx0XHRcdFx0XHRsaS5kaXNwb3NlKCk7XG5cdFx0XHRcdH0pLmluamVjdChlbCwgJ2FmdGVyJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgRWxlbWVudCgnYnV0dG9uJywge1xuXHRcdFx0XHRcdHR5cGU6ICdidXR0b24nLFxuXHRcdFx0XHRcdGh0bWw6ICcmdGltZXMnLFxuXHRcdFx0XHRcdGRpc2FibGVkOiB0cnVlXG5cdFx0XHRcdH0pLmluamVjdChlbCwgJ2FmdGVyJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0bGlzdC5maXJlRXZlbnQoXCJjb21wbGV0ZVwiKTsgLy8gSW5pdGlhbCBzb3J0aW5nXG5cdH0sXG5cblx0LyoqXG5cdCAqIEVuYWJsZSBkcmFnIGFuZCBkcm9wIGZvciB0aGUgZmlsZSB0cmVlXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSB1bCAgICAgIFRoZSBET00gZWxlbWVudFxuXHQgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBBbiBvcHRpb25hbCBvcHRpb25zIG9iamVjdFxuXHQgKi9cblx0ZW5hYmxlRmlsZVRyZWVEcmFnQW5kRHJvcDogZnVuY3Rpb24odWwsIG9wdGlvbnMpIHtcblx0XHR2YXIgZHMgPSBuZXcgU2Nyb2xsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudCgnYm9keScpLCB7XG5cdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oeCwgeSkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc2Nyb2xsVG8odGhpcy5lbGVtZW50LmdldFNjcm9sbCgpLngsIHkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dWwuYWRkRXZlbnQoJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHR2YXIgZHJhZ0hhbmRsZSA9IGV2ZW50LnRhcmdldC5oYXNDbGFzcygnZHJhZy1oYW5kbGUnKSA/IGV2ZW50LnRhcmdldCA6IGV2ZW50LnRhcmdldC5nZXRQYXJlbnQoJy5kcmFnLWhhbmRsZScpO1xuXHRcdFx0dmFyIGRyYWdFbGVtZW50ID0gZXZlbnQudGFyZ2V0LmdldFBhcmVudCgnLnRsX2ZpbGUsLnRsX2ZvbGRlcicpO1xuXG5cdFx0XHRpZiAoIWRyYWdIYW5kbGUgfHwgIWRyYWdFbGVtZW50IHx8IGV2ZW50LnJpZ2h0Q2xpY2spIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRkcy5zdGFydCgpO1xuXHRcdFx0dWwuYWRkQ2xhc3MoJ3RsX2xpc3RpbmdfZHJhZ2dpbmcnKTtcblxuXHRcdFx0dmFyIGNsb25lQmFzZSA9IChkcmFnRWxlbWVudC5nZXRFbGVtZW50cygnLnRsX2xlZnQnKVswXSB8fCBkcmFnRWxlbWVudCksXG5cdFx0XHRcdGNsb25lID0gY2xvbmVCYXNlLmNsb25lKHRydWUpXG5cdFx0XHRcdFx0LmluamVjdCh1bClcblx0XHRcdFx0XHQuYWRkQ2xhc3MoJ3RsX2xlZnRfZHJhZ2dpbmcnKSxcblx0XHRcdFx0Y3VycmVudEhvdmVyLCBjdXJyZW50SG92ZXJUaW1lLCBleHBhbmRMaW5rO1xuXG5cdFx0XHRjbG9uZS5zZXRQb3NpdGlvbih7XG5cdFx0XHRcdHg6IGV2ZW50LnBhZ2UueCAtIGNsb25lQmFzZS5nZXRPZmZzZXRQYXJlbnQoKS5nZXRQb3NpdGlvbigpLnggLSBjbG9uZS5nZXRTaXplKCkueCxcblx0XHRcdFx0eTogY2xvbmVCYXNlLmdldFBvc2l0aW9uKGNsb25lQmFzZS5nZXRPZmZzZXRQYXJlbnQoKSkueVxuXHRcdFx0fSkuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXG5cdFx0XHR2YXIgbW92ZSA9IG5ldyBEcmFnLk1vdmUoY2xvbmUsIHtcblx0XHRcdFx0ZHJvcHBhYmxlczogJCQoW3VsXSkuYXBwZW5kKHVsLmdldEVsZW1lbnRzKCcudGxfZm9sZGVyLGxpLnBhcmVudCwudGxfZm9sZGVyX3RvcCcpKSxcblx0XHRcdFx0dW5EcmFnZ2FibGVUYWdzOiBbXSxcblx0XHRcdFx0bW9kaWZpZXJzOiB7XG5cdFx0XHRcdFx0eDogJ2xlZnQnLFxuXHRcdFx0XHRcdHk6ICd0b3AnXG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uU3RhcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNsb25lLnNldFN0eWxlKCdkaXNwbGF5JywgJycpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRvbkVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBkcm9wcGFibGUpIHtcblx0XHRcdFx0XHRkcm9wcGFibGUgPSBmaXhEcm9wcGFibGUoZHJvcHBhYmxlKTtcblx0XHRcdFx0XHRkcm9wcGFibGUuYWRkQ2xhc3MoJ3RsX2ZvbGRlcl9kcm9wcGluZycpO1xuXG5cdFx0XHRcdFx0aWYgKGRyb3BwYWJsZS5oYXNDbGFzcygndGxfZm9sZGVyJykgJiYgY3VycmVudEhvdmVyICE9PSBkcm9wcGFibGUpIHtcblx0XHRcdFx0XHRcdGN1cnJlbnRIb3ZlciA9IGRyb3BwYWJsZTtcblx0XHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblx0XHRcdFx0XHRcdGV4cGFuZExpbmsgPSBkcm9wcGFibGUuZ2V0RWxlbWVudCgnYS5mb2xkYWJsZScpO1xuXG5cdFx0XHRcdFx0XHRpZiAoZXhwYW5kTGluayAmJiAhZXhwYW5kTGluay5oYXNDbGFzcygnZm9sZGFibGUtLW9wZW4nKSkge1xuXHRcdFx0XHRcdFx0XHQvLyBFeHBhbmQgdGhlIGZvbGRlciBhZnRlciBvbmUgc2Vjb25kIGhvdmVyIHRpbWVcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoY3VycmVudEhvdmVyID09PSBkcm9wcGFibGUgJiYgY3VycmVudEhvdmVyVGltZSArIDkwMCA8IG5ldyBEYXRlKCkuZ2V0VGltZSgpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnSFRNTEV2ZW50cycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZXZlbnQuaW5pdEV2ZW50KCdjbGljaycsIHRydWUsIHRydWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZXhwYW5kTGluay5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IHVuZGVmaW5lZDtcblxuXHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmFkZEV2ZW50KCdhamF4X2NoYW5nZScsIGZ1bmN0aW9uIG9uQWpheCgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKG1vdmUgJiYgbW92ZS5kcm9wcGFibGVzICYmIHVsICYmIHVsLmdldEVsZW1lbnRzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bW92ZS5kcm9wcGFibGVzID0gJCQoW3VsXSkuYXBwZW5kKHVsLmdldEVsZW1lbnRzKCcudGxfZm9sZGVyLGxpLnBhcmVudCcpKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cucmVtb3ZlRXZlbnQoJ2FqYXhfY2hhbmdlJywgb25BamF4KTtcblx0XHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSwgMTAwMCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRvbkNhbmNlbDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cblx0XHRcdFx0XHRkcy5zdG9wKCk7XG5cdFx0XHRcdFx0Y2xvbmUuZGVzdHJveSgpO1xuXHRcdFx0XHRcdHdpbmRvdy5yZW1vdmVFdmVudCgna2V5dXAnLCBvbktleXVwKTtcblx0XHRcdFx0XHR1bC5nZXRFbGVtZW50cygnLnRsX2ZvbGRlcl9kcm9wcGluZycpLnJlbW92ZUNsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblx0XHRcdFx0XHR1bC5yZW1vdmVDbGFzcygndGxfbGlzdGluZ19kcmFnZ2luZycpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRvbkRyb3A6IGZ1bmN0aW9uKGVsZW1lbnQsIGRyb3BwYWJsZSkge1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlciA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdFx0ZHMuc3RvcCgpO1xuXHRcdFx0XHRcdGNsb25lLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR3aW5kb3cucmVtb3ZlRXZlbnQoJ2tleXVwJywgb25LZXl1cCk7XG5cdFx0XHRcdFx0dWwuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXJfZHJvcHBpbmcnKS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHRcdFx0dWwucmVtb3ZlQ2xhc3MoJ3RsX2xpc3RpbmdfZHJhZ2dpbmcnKTtcblxuXHRcdFx0XHRcdGRyb3BwYWJsZSA9IGZpeERyb3BwYWJsZShkcm9wcGFibGUpO1xuXG5cdFx0XHRcdFx0aWYgKCFkcm9wcGFibGUpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR2YXIgaWQgPSBkcmFnRWxlbWVudC5nZXQoJ2RhdGEtaWQnKSxcblx0XHRcdFx0XHRcdHBpZCA9IGRyb3BwYWJsZS5nZXQoJ2RhdGEtaWQnKSB8fCBkZWNvZGVVUklDb21wb25lbnQob3B0aW9ucy51cmwuc3BsaXQoL1s/Jl1waWQ9LylbMV0uc3BsaXQoJyYnKVswXSk7XG5cblx0XHRcdFx0XHQvLyBJZ25vcmUgaW52YWxpZCBtb3ZlIG9wZXJhdGlvbnNcblx0XHRcdFx0XHRpZiAoaWQgJiYgcGlkICYmICgocGlkKycvJykuaW5kZXhPZihpZCsnLycpID09PSAwIHx8IHBpZCsnLycgPT09IGlkLnJlcGxhY2UoL1teL10rJC8sICcnKSkpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0ZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IG9wdGlvbnMudXJsICsgJyZpZD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGlkKSArICcmcGlkPScgKyBlbmNvZGVVUklDb21wb25lbnQocGlkKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0b25MZWF2ZTogZnVuY3Rpb24oZWxlbWVudCwgZHJvcHBhYmxlKSB7XG5cdFx0XHRcdFx0ZHJvcHBhYmxlID0gZml4RHJvcHBhYmxlKGRyb3BwYWJsZSk7XG5cdFx0XHRcdFx0ZHJvcHBhYmxlLnJlbW92ZUNsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdG1vdmUuc3RhcnQoZXZlbnQpO1xuXHRcdFx0d2luZG93LmFkZEV2ZW50KCdrZXl1cCcsIG9uS2V5dXApO1xuXG5cdFx0XHRmdW5jdGlvbiBvbktleXVwKGV2ZW50KSB7XG5cdFx0XHRcdGlmIChldmVudC5rZXkgPT09ICdlc2MnICYmIG1vdmUgJiYgbW92ZS5zdG9wKSB7XG5cdFx0XHRcdFx0bW92ZS5kcm9wcGFibGVzID0gJCQoW10pO1xuXHRcdFx0XHRcdG1vdmUuc3RvcCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBmaXhEcm9wcGFibGUoZHJvcHBhYmxlKSB7XG5cdFx0XHRpZiAoZHJvcHBhYmxlICYmIGRyb3BwYWJsZS5oYXNDbGFzcygncGFyZW50JykgJiYgZHJvcHBhYmxlLmdldFByZXZpb3VzKCcudGxfZm9sZGVyJykpIHtcblx0XHRcdFx0cmV0dXJuIGRyb3BwYWJsZS5nZXRQcmV2aW91cygnLnRsX2ZvbGRlcicpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZHJvcHBhYmxlO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogTGlzdCB3aXphcmRcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICovXG5cdGxpc3RXaXphcmQ6IGZ1bmN0aW9uKGlkKSB7XG5cdFx0dmFyIHVsID0gJChpZCksXG5cdFx0XHRtYWtlU29ydGFibGUgPSBmdW5jdGlvbih1bCkge1xuXHRcdFx0XHRuZXcgU29ydGFibGVzKHVsLCB7XG5cdFx0XHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0XHRcdG9wYWNpdHk6IDAuNixcblx0XHRcdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdGFkZEV2ZW50c1RvID0gZnVuY3Rpb24obGkpIHtcblx0XHRcdFx0dmFyIGNvbW1hbmQsIGNsb25lLCBpbnB1dCwgcHJldmlvdXMsIG5leHQ7XG5cblx0XHRcdFx0bGkuZ2V0RWxlbWVudHMoJ2J1dHRvbicpLmVhY2goZnVuY3Rpb24oYnQpIHtcblx0XHRcdFx0XHRpZiAoYnQuaGFzRXZlbnQoJ2NsaWNrJykpIHJldHVybjtcblx0XHRcdFx0XHRjb21tYW5kID0gYnQuZ2V0UHJvcGVydHkoJ2RhdGEtY29tbWFuZCcpO1xuXG5cdFx0XHRcdFx0c3dpdGNoIChjb21tYW5kKSB7XG5cdFx0XHRcdFx0XHRjYXNlICdjb3B5Jzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGNsb25lID0gbGkuY2xvbmUodHJ1ZSkuaW5qZWN0KGxpLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlucHV0ID0gbGkuZ2V0Rmlyc3QoJ2lucHV0JykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNsb25lLmdldEZpcnN0KCdpbnB1dCcpLnZhbHVlID0gaW5wdXQudmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGFkZEV2ZW50c1RvKGNsb25lKTtcblx0XHRcdFx0XHRcdFx0XHRpbnB1dC5zZWxlY3QoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh1bC5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxpLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgbnVsbDpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGUuZXZlbnQua2V5Q29kZSA9PSAzOCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHByZXZpb3VzID0gbGkuZ2V0UHJldmlvdXMoJ2xpJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGkuaW5qZWN0KHByZXZpb3VzLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsaS5pbmplY3QodWwsICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChlLmV2ZW50LmtleUNvZGUgPT0gNDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChuZXh0ID0gbGkuZ2V0TmV4dCgnbGknKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsaS5pbmplY3QobmV4dCwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsaS5pbmplY3QodWwuZ2V0Rmlyc3QoJ2xpJyksICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH07XG5cblx0XHRtYWtlU29ydGFibGUodWwpO1xuXG5cdFx0dWwuZ2V0Q2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKGxpKSB7XG5cdFx0XHRhZGRFdmVudHNUbyhsaSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRhYmxlIHdpemFyZFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0dGFibGVXaXphcmQ6IGZ1bmN0aW9uKGlkKSB7XG5cdFx0dmFyIHRhYmxlID0gJChpZCksXG5cdFx0XHR0aGVhZCA9IHRhYmxlLmdldEVsZW1lbnQoJ3RoZWFkJyksXG5cdFx0XHR0Ym9keSA9IHRhYmxlLmdldEVsZW1lbnQoJ3Rib2R5JyksXG5cdFx0XHRtYWtlU29ydGFibGUgPSBmdW5jdGlvbih0Ym9keSkge1xuXHRcdFx0XHR2YXIgcm93cyA9IHRib2R5LmdldENoaWxkcmVuKCksXG5cdFx0XHRcdFx0dGV4dGFyZWEsIGNoaWxkcmVuLCBpLCBqO1xuXG5cdFx0XHRcdGZvciAoaT0wOyBpPHJvd3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRjaGlsZHJlbiA9IHJvd3NbaV0uZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRmb3IgKGo9MDsgajxjaGlsZHJlbi5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0aWYgKHRleHRhcmVhID0gY2hpbGRyZW5bal0uZ2V0Rmlyc3QoJ3RleHRhcmVhJykpIHtcblx0XHRcdFx0XHRcdFx0dGV4dGFyZWEubmFtZSA9IHRleHRhcmVhLm5hbWUucmVwbGFjZSgvXFxbWzAtOV0rXVtbMC05XStdL2csICdbJyArIGkgKyAnXVsnICsgaiArICddJylcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRuZXcgU29ydGFibGVzKHRib2R5LCB7XG5cdFx0XHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0XHRcdG9wYWNpdHk6IDAuNixcblx0XHRcdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdGFkZEV2ZW50c1RvID0gZnVuY3Rpb24odHIpIHtcblx0XHRcdFx0dmFyIGhlYWQgPSB0aGVhZC5nZXRGaXJzdCgndHInKSxcblx0XHRcdFx0XHRjb21tYW5kLCB0ZXh0YXJlYSwgY3VycmVudCwgbmV4dCwgbnRyLCBjaGlsZHJlbiwgaW5kZXgsIGk7XG5cblx0XHRcdFx0dHIuZ2V0RWxlbWVudHMoJ2J1dHRvbicpLmVhY2goZnVuY3Rpb24oYnQpIHtcblx0XHRcdFx0XHRpZiAoYnQuaGFzRXZlbnQoJ2NsaWNrJykpIHJldHVybjtcblx0XHRcdFx0XHRjb21tYW5kID0gYnQuZ2V0UHJvcGVydHkoJ2RhdGEtY29tbWFuZCcpO1xuXG5cdFx0XHRcdFx0c3dpdGNoIChjb21tYW5kKSB7XG5cdFx0XHRcdFx0XHRjYXNlICdyY29weSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRudHIgPSBuZXcgRWxlbWVudCgndHInKTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRyLmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdG5leHQgPSBjaGlsZHJlbltpXS5jbG9uZSh0cnVlKS5pbmplY3QobnRyLCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGV4dGFyZWEgPSBjaGlsZHJlbltpXS5nZXRGaXJzdCgndGV4dGFyZWEnKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRuZXh0LmdldEZpcnN0KCd0ZXh0YXJlYScpLnZhbHVlID0gdGV4dGFyZWEudmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG50ci5pbmplY3QodHIsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdGFkZEV2ZW50c1RvKG50cik7XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHRudHIuZ2V0Rmlyc3QoJ3RkJykuZ2V0Rmlyc3QoJ3RleHRhcmVhJykuc2VsZWN0KCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ3JkZWxldGUnOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRib2R5LmdldENoaWxkcmVuKCkubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dHIuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdjY29weSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpbmRleCA9IGdldEluZGV4KGJ0KTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRib2R5LmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQgPSBjaGlsZHJlbltpXS5nZXRDaGlsZHJlbigpW2luZGV4XTtcblx0XHRcdFx0XHRcdFx0XHRcdG5leHQgPSBjdXJyZW50LmNsb25lKHRydWUpLmluamVjdChjdXJyZW50LCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0ZXh0YXJlYSA9IGN1cnJlbnQuZ2V0Rmlyc3QoJ3RleHRhcmVhJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmV4dC5nZXRGaXJzdCgndGV4dGFyZWEnKS52YWx1ZSA9IHRleHRhcmVhLnZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YWRkRXZlbnRzVG8obmV4dCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHZhciBoZWFkRmlyc3QgPSBoZWFkLmdldEZpcnN0KCd0ZCcpO1xuXHRcdFx0XHRcdFx0XHRcdG5leHQgPSBoZWFkRmlyc3QuY2xvbmUodHJ1ZSkuaW5qZWN0KGhlYWQuZ2V0TGFzdCgndGQnKSwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdGFkZEV2ZW50c1RvKG5leHQpO1xuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW5bMF0uZ2V0Q2hpbGRyZW4oKVtpbmRleCArIDFdLmdldEZpcnN0KCd0ZXh0YXJlYScpLnNlbGVjdCgpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdjbW92ZWwnOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aW5kZXggPSBnZXRJbmRleChidCk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0Ym9keS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChpbmRleCA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQgPSBjaGlsZHJlbltpXS5nZXRDaGlsZHJlbigpW2luZGV4XTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudC5pbmplY3QoY3VycmVudC5nZXRQcmV2aW91cygpLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQgPSBjaGlsZHJlbltpXS5nZXRDaGlsZHJlbigpW2luZGV4XTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudC5pbmplY3QoY2hpbGRyZW5baV0uZ2V0TGFzdCgpLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2Ntb3Zlcic6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpbmRleCA9IGdldEluZGV4KGJ0KTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRib2R5LmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGluZGV4IDwgKHRyLmdldENoaWxkcmVuKCkubGVuZ3RoIC0gMikpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQgPSBjaGlsZHJlbltpXS5nZXRDaGlsZHJlbigpW2luZGV4XTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudC5pbmplY3QoY3VycmVudC5nZXROZXh0KCksICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gY2hpbGRyZW5baV0uZ2V0Q2hpbGRyZW4oKVtpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQuaW5qZWN0KGNoaWxkcmVuW2ldLmdldEZpcnN0KCksICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnY2RlbGV0ZSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpbmRleCA9IGdldEluZGV4KGJ0KTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRib2R5LmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRyLmdldENoaWxkcmVuKCkubGVuZ3RoID4gMikge1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW5baV0uZ2V0Q2hpbGRyZW4oKVtpbmRleF0uZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0aGVhZC5nZXRGaXJzdCgndGQnKS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgbnVsbDpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGUuZXZlbnQua2V5Q29kZSA9PSAzOCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG50ciA9IHRyLmdldFByZXZpb3VzKCd0cicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdChudHIsICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdCh0Ym9keSwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChlLmV2ZW50LmtleUNvZGUgPT0gNDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChudHIgPSB0ci5nZXROZXh0KCd0cicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdChudHIsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KHRib2R5LCAndG9wJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdGdldEluZGV4ID0gZnVuY3Rpb24oYnQpIHtcblx0XHRcdFx0dmFyIHRkID0gJChidCkuZ2V0UGFyZW50KCd0ZCcpLFxuXHRcdFx0XHRcdHRyID0gdGQuZ2V0UGFyZW50KCd0cicpLFxuXHRcdFx0XHRcdGNvbHMgPSB0ci5nZXRDaGlsZHJlbigpLFxuXHRcdFx0XHRcdGluZGV4ID0gMCwgaTtcblxuXHRcdFx0XHRmb3IgKGk9MDsgaTxjb2xzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGNvbHNbaV0gPT0gdGQpIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIGluZGV4O1xuXHRcdFx0fTtcblxuXHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cblx0XHR0aGVhZC5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24odHIpIHtcblx0XHRcdGFkZEV2ZW50c1RvKHRyKTtcblx0XHR9KTtcblxuXHRcdHRib2R5LmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbih0cikge1xuXHRcdFx0YWRkRXZlbnRzVG8odHIpO1xuXHRcdH0pO1xuXG5cdFx0QmFja2VuZC50YWJsZVdpemFyZFJlc2l6ZSgpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBSZXNpemUgdGhlIHRhYmxlIHdpemFyZCBmaWVsZHMgb24gZm9jdXNcblx0ICpcblx0ICogQHBhcmFtIHtmbG9hdH0gW2ZhY3Rvcl0gVGhlIHJlc2l6ZSBmYWN0b3Jcblx0ICovXG5cdHRhYmxlV2l6YXJkUmVzaXplOiBmdW5jdGlvbihmYWN0b3IpIHtcblx0XHR2YXIgc2l6ZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY29udGFvX3RhYmxlX3dpemFyZF9jZWxsX3NpemUnKTtcblxuXHRcdGlmIChmYWN0b3IgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0c2l6ZSA9ICcnO1xuXHRcdFx0JCQoJy50bF90YWJsZXdpemFyZCB0ZXh0YXJlYScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0ZWwuc2V0U3R5bGUoJ3dpZHRoJywgKGVsLmdldFN0eWxlKCd3aWR0aCcpLnRvSW50KCkgKiBmYWN0b3IpLnJvdW5kKCkubGltaXQoMTQyLCAyODQpKTtcblx0XHRcdFx0ZWwuc2V0U3R5bGUoJ2hlaWdodCcsIChlbC5nZXRTdHlsZSgnaGVpZ2h0JykudG9JbnQoKSAqIGZhY3Rvcikucm91bmQoKS5saW1pdCg2NiwgMTMyKSk7XG5cdFx0XHRcdGlmIChzaXplID09ICcnKSB7XG5cdFx0XHRcdFx0c2l6ZSA9IGVsLmdldFN0eWxlKCd3aWR0aCcpICsgJ3wnICsgZWwuZ2V0U3R5bGUoJ2hlaWdodCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY29udGFvX3RhYmxlX3dpemFyZF9jZWxsX3NpemUnLCBzaXplKTtcblx0XHR9IGVsc2UgaWYgKHNpemUgIT09IG51bGwpIHtcblx0XHRcdHZhciBjaHVua3MgPSBzaXplLnNwbGl0KCd8Jyk7XG5cdFx0XHQkJCgnLnRsX3RhYmxld2l6YXJkIHRleHRhcmVhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRlbC5zZXRTdHlsZSgnd2lkdGgnLCBjaHVua3NbMF0pO1xuXHRcdFx0XHRlbC5zZXRTdHlsZSgnaGVpZ2h0JywgY2h1bmtzWzFdKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogU2V0IHRoZSB3aWR0aCBvZiB0aGUgdGFibGUgd2l6YXJkXG5cdCAqL1xuXHR0YWJsZVdpemFyZFNldFdpZHRoOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgd3JhcCA9ICQoJ3RsX3RhYmxld2l6YXJkJyk7XG5cdFx0aWYgKCF3cmFwKSByZXR1cm47XG5cdFx0d3JhcC5zZXRTdHlsZSgnd2lkdGgnLCBNYXRoLnJvdW5kKHdyYXAuZ2V0UGFyZW50KCcudGxfZm9ybWJvZHlfZWRpdCcpLmdldENvbXB1dGVkU2l6ZSgpLndpZHRoICogMC45NikpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBPcHRpb25zIHdpemFyZFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0b3B0aW9uc1dpemFyZDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgdGFibGUgPSAkKGlkKSxcblx0XHRcdHRib2R5ID0gdGFibGUuZ2V0RWxlbWVudCgndGJvZHknKSxcblx0XHRcdG1ha2VTb3J0YWJsZSA9IGZ1bmN0aW9uKHRib2R5KSB7XG5cdFx0XHRcdHZhciByb3dzID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKSxcblx0XHRcdFx0XHRjaGlsZHJlbiwgaSwgaiwgaW5wdXQ7XG5cblx0XHRcdFx0Zm9yIChpPTA7IGk8cm93cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGNoaWxkcmVuID0gcm93c1tpXS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdGZvciAoaj0wOyBqPGNoaWxkcmVuLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0XHRpZiAoaW5wdXQgPSBjaGlsZHJlbltqXS5nZXRGaXJzdCgnaW5wdXQnKSkge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5uYW1lID0gaW5wdXQubmFtZS5yZXBsYWNlKC9cXFtbMC05XStdL2csICdbJyArIGkgKyAnXScpO1xuXHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQudHlwZSA9PSAnY2hlY2tib3gnKSB7XG5cdFx0XHRcdFx0XHRcdFx0aW5wdXQuaWQgPSBpbnB1dC5uYW1lLnJlcGxhY2UoL1xcW1swLTldK10vZywgJycpLnJlcGxhY2UoL1xcWy9nLCAnXycpLnJlcGxhY2UoL10vZywgJycpICsgJ18nICsgaTtcblx0XHRcdFx0XHRcdFx0XHRpbnB1dC5nZXROZXh0KCdsYWJlbCcpLnNldCgnZm9yJywgaW5wdXQuaWQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bmV3IFNvcnRhYmxlcyh0Ym9keSwge1xuXHRcdFx0XHRcdGNvbnN0cmFpbjogdHJ1ZSxcblx0XHRcdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRcdFx0aGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcblx0XHRcdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRhZGRFdmVudHNUbyA9IGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRcdHZhciBjb21tYW5kLCBpbnB1dCwgbmV4dCwgbnRyLCBjaGlsZHJlbiwgaTtcblx0XHRcdFx0dHIuZ2V0RWxlbWVudHMoJ2J1dHRvbicpLmVhY2goZnVuY3Rpb24oYnQpIHtcblx0XHRcdFx0XHRpZiAoYnQuaGFzRXZlbnQoJ2NsaWNrJykpIHJldHVybjtcblx0XHRcdFx0XHRjb21tYW5kID0gYnQuZ2V0UHJvcGVydHkoJ2RhdGEtY29tbWFuZCcpO1xuXG5cdFx0XHRcdFx0c3dpdGNoIChjb21tYW5kKSB7XG5cdFx0XHRcdFx0XHRjYXNlICdjb3B5Jzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdG50ciA9IG5ldyBFbGVtZW50KCd0cicpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdHIuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0bmV4dCA9IGNoaWxkcmVuW2ldLmNsb25lKHRydWUpLmluamVjdChudHIsICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChpbnB1dCA9IGNoaWxkcmVuW2ldLmdldEZpcnN0KCdpbnB1dCcpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG5leHQuZ2V0Rmlyc3QoJ2lucHV0JykudmFsdWUgPSBpbnB1dC52YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGlucHV0LnR5cGUgPT0gJ2NoZWNrYm94Jykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdG5leHQuZ2V0Rmlyc3QoJ2lucHV0JykuY2hlY2tlZCA9IGlucHV0LmNoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJztcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRudHIuaW5qZWN0KHRyLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRhZGRFdmVudHNUbyhudHIpO1xuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0bnRyLmdldEZpcnN0KCd0ZCcpLmdldEZpcnN0KCdpbnB1dCcpLnNlbGVjdCgpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRib2R5LmdldENoaWxkcmVuKCkubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dHIuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlIG51bGw6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMzgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChudHIgPSB0ci5nZXRQcmV2aW91cygndHInKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QobnRyLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QodGJvZHksICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZS5ldmVudC5rZXlDb2RlID09IDQwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobnRyID0gdHIuZ2V0TmV4dCgndHInKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QobnRyLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdCh0Ym9keSwgJ3RvcCcpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH07XG5cblx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXG5cdFx0dGJvZHkuZ2V0Q2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRhZGRFdmVudHNUbyh0cik7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEtleS92YWx1ZSB3aXphcmRcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICovXG5cdGtleVZhbHVlV2l6YXJkOiBmdW5jdGlvbihpZCkge1xuXHRcdHZhciB0YWJsZSA9ICQoaWQpLFxuXHRcdFx0dGJvZHkgPSB0YWJsZS5nZXRFbGVtZW50KCd0Ym9keScpLFxuXHRcdFx0bWFrZVNvcnRhYmxlID0gZnVuY3Rpb24odGJvZHkpIHtcblx0XHRcdFx0dmFyIHJvd3MgPSB0Ym9keS5nZXRDaGlsZHJlbigpLFxuXHRcdFx0XHRcdGNoaWxkcmVuLCBpLCBqLCBpbnB1dDtcblxuXHRcdFx0XHRmb3IgKGk9MDsgaTxyb3dzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Y2hpbGRyZW4gPSByb3dzW2ldLmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0Zm9yIChqPTA7IGo8Y2hpbGRyZW4ubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdGlmIChpbnB1dCA9IGNoaWxkcmVuW2pdLmdldEZpcnN0KCdpbnB1dCcpKSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0Lm5hbWUgPSBpbnB1dC5uYW1lLnJlcGxhY2UoL1xcW1swLTldK10vZywgJ1snICsgaSArICddJylcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRuZXcgU29ydGFibGVzKHRib2R5LCB7XG5cdFx0XHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0XHRcdG9wYWNpdHk6IDAuNixcblx0XHRcdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdGFkZEV2ZW50c1RvID0gZnVuY3Rpb24odHIpIHtcblx0XHRcdFx0dmFyIGNvbW1hbmQsIGlucHV0LCBuZXh0LCBudHIsIGNoaWxkcmVuLCBpO1xuXHRcdFx0XHR0ci5nZXRFbGVtZW50cygnYnV0dG9uJykuZWFjaChmdW5jdGlvbihidCkge1xuXHRcdFx0XHRcdGlmIChidC5oYXNFdmVudCgnY2xpY2snKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGNvbW1hbmQgPSBidC5nZXRQcm9wZXJ0eSgnZGF0YS1jb21tYW5kJyk7XG5cblx0XHRcdFx0XHRzd2l0Y2ggKGNvbW1hbmQpIHtcblx0XHRcdFx0XHRcdGNhc2UgJ2NvcHknOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0bnRyID0gbmV3IEVsZW1lbnQoJ3RyJyk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0ci5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXh0ID0gY2hpbGRyZW5baV0uY2xvbmUodHJ1ZSkuaW5qZWN0KG50ciwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGlucHV0ID0gY2hpbGRyZW5baV0uZ2V0Rmlyc3QoJ2lucHV0JykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmV4dC5nZXRGaXJzdCgpLnZhbHVlID0gaW5wdXQudmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG50ci5pbmplY3QodHIsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdGFkZEV2ZW50c1RvKG50cik7XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHRudHIuZ2V0Rmlyc3QoJ3RkJykuZ2V0Rmlyc3QoJ2lucHV0Jykuc2VsZWN0KCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGJvZHkuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0ci5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgbnVsbDpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGUuZXZlbnQua2V5Q29kZSA9PSAzOCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG50ciA9IHRyLmdldFByZXZpb3VzKCd0cicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdChudHIsICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdCh0Ym9keSwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChlLmV2ZW50LmtleUNvZGUgPT0gNDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChudHIgPSB0ci5nZXROZXh0KCd0cicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdChudHIsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KHRib2R5LCAndG9wJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cblx0XHR0Ym9keS5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24odHIpIHtcblx0XHRcdGFkZEV2ZW50c1RvKHRyKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogQ2hlY2tib3ggd2l6YXJkXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHRjaGVja2JveFdpemFyZDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgY29udGFpbmVyID0gJChpZCkuZ2V0RWxlbWVudCgnLnNvcnRhYmxlJyksXG5cdFx0XHRtYWtlU29ydGFibGUgPSBmdW5jdGlvbihjb250YWluZXIpIHtcblx0XHRcdFx0bmV3IFNvcnRhYmxlcyhjb250YWluZXIsIHtcblx0XHRcdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRcdFx0b3BhY2l0eTogMC42LFxuXHRcdFx0XHRcdGhhbmRsZTogJy5kcmFnLWhhbmRsZSdcblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0YWRkRXZlbnRzVG8gPSBmdW5jdGlvbihzcGFuKSB7XG5cdFx0XHRcdHZhciBuc3Bhbjtcblx0XHRcdFx0c3Bhbi5nZXRFbGVtZW50cygnYnV0dG9uJykuZWFjaChmdW5jdGlvbihidCkge1xuXHRcdFx0XHRcdGlmIChidC5oYXNFdmVudCgnY2xpY2snKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0aWYgKGUuZXZlbnQua2V5Q29kZSA9PSAzOCkge1xuXHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdGlmICgobnNwYW4gPSBzcGFuLmdldFByZXZpb3VzKCdzcGFuJykpKSB7XG5cdFx0XHRcdFx0XHRcdFx0c3Bhbi5pbmplY3QobnNwYW4sICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRzcGFuLmluamVjdChjb250YWluZXIsICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChlLmV2ZW50LmtleUNvZGUgPT0gNDApIHtcblx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRpZiAobnNwYW4gPSBzcGFuLmdldE5leHQoJ3NwYW4nKSkge1xuXHRcdFx0XHRcdFx0XHRcdHNwYW4uaW5qZWN0KG5zcGFuLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRzcGFuLmluamVjdChjb250YWluZXIsICd0b3AnKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH07XG5cblx0XHRtYWtlU29ydGFibGUoY29udGFpbmVyKTtcblxuXHRcdGNvbnRhaW5lci5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oc3Bhbikge1xuXHRcdFx0YWRkRXZlbnRzVG8oc3Bhbik7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFVwZGF0ZSB0aGUgZmllbGRzIG9mIHRoZSBpbWFnZVNpemUgd2lkZ2V0IHVwb24gY2hhbmdlXG5cdCAqL1xuXHRlbmFibGVJbWFnZVNpemVXaWRnZXRzOiBmdW5jdGlvbigpIHtcblx0XHQkJCgnLnRsX2ltYWdlX3NpemUnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHR2YXIgc2VsZWN0ID0gZWwuZ2V0RWxlbWVudCgnc2VsZWN0JyksXG5cdFx0XHRcdHdpZHRoSW5wdXQgPSBlbC5nZXRDaGlsZHJlbignaW5wdXQnKVswXSxcblx0XHRcdFx0aGVpZ2h0SW5wdXQgPSBlbC5nZXRDaGlsZHJlbignaW5wdXQnKVsxXSxcblx0XHRcdFx0dXBkYXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0aWYgKHNlbGVjdC5nZXQoJ3ZhbHVlJykgPT09ICcnIHx8IHNlbGVjdC5nZXQoJ3ZhbHVlJykuaW5kZXhPZignXycpID09PSAwIHx8IHNlbGVjdC5nZXQoJ3ZhbHVlJykudG9JbnQoKS50b1N0cmluZygpID09PSBzZWxlY3QuZ2V0KCd2YWx1ZScpKSB7XG5cdFx0XHRcdFx0XHR3aWR0aElucHV0LnJlYWRPbmx5ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGhlaWdodElucHV0LnJlYWRPbmx5ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHZhciBkaW1lbnNpb25zID0gJChzZWxlY3QuZ2V0U2VsZWN0ZWQoKVswXSkuZ2V0KCd0ZXh0Jyk7XG5cdFx0XHRcdFx0XHRkaW1lbnNpb25zID0gZGltZW5zaW9ucy5zcGxpdCgnKCcpLmxlbmd0aCA+IDFcblx0XHRcdFx0XHRcdFx0PyBkaW1lbnNpb25zLnNwbGl0KCcoJykuZ2V0TGFzdCgpLnNwbGl0KCcpJylbMF0uc3BsaXQoJ3gnKVxuXHRcdFx0XHRcdFx0XHQ6IFsnJywgJyddO1xuXHRcdFx0XHRcdFx0d2lkdGhJbnB1dC5zZXQoJ3ZhbHVlJywgJycpLnNldCgncGxhY2Vob2xkZXInLCBkaW1lbnNpb25zWzBdICogMSB8fCAnJyk7XG5cdFx0XHRcdFx0XHRoZWlnaHRJbnB1dC5zZXQoJ3ZhbHVlJywgJycpLnNldCgncGxhY2Vob2xkZXInLCBkaW1lbnNpb25zWzFdICogMSB8fCAnJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHdpZHRoSW5wdXQuc2V0KCdwbGFjZWhvbGRlcicsICcnKTtcblx0XHRcdFx0XHRcdGhlaWdodElucHV0LnNldCgncGxhY2Vob2xkZXInLCAnJyk7XG5cdFx0XHRcdFx0XHR3aWR0aElucHV0LnJlYWRPbmx5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRoZWlnaHRJbnB1dC5yZWFkT25seSA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0O1xuXG5cdFx0XHR1cGRhdGUoKTtcblx0XHRcdHNlbGVjdC5hZGRFdmVudCgnY2hhbmdlJywgdXBkYXRlKTtcblx0XHRcdHNlbGVjdC5hZGRFdmVudCgna2V5dXAnLCB1cGRhdGUpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBBbGxvdyB0b2dnbGluZyBjaGVja2JveGVzIG9yIHJhZGlvIGJ1dHRvbnMgYnkgY2xpY2tpbmcgYSByb3dcblx0ICpcblx0ICogQGF1dGhvciBLYW1pbCBLdXptaW5za2lcblx0ICovXG5cdGVuYWJsZVRvZ2dsZVNlbGVjdDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNvbnRhaW5lciA9ICQoJ3RsX2xpc3RpbmcnKSxcblx0XHRcdHNoaWZ0VG9nZ2xlID0gZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0dGhpc0luZGV4ID0gY2hlY2tib3hlcy5pbmRleE9mKGVsKTtcblx0XHRcdFx0c3RhcnRJbmRleCA9IGNoZWNrYm94ZXMuaW5kZXhPZihzdGFydCk7XG5cdFx0XHRcdGZyb20gPSBNYXRoLm1pbih0aGlzSW5kZXgsIHN0YXJ0SW5kZXgpO1xuXHRcdFx0XHR0byA9IE1hdGgubWF4KHRoaXNJbmRleCwgc3RhcnRJbmRleCk7XG5cdFx0XHRcdHN0YXR1cyA9ICEhY2hlY2tib3hlc1tzdGFydEluZGV4XS5jaGVja2VkO1xuXG5cdFx0XHRcdGZvciAoZnJvbTsgZnJvbTw9dG87IGZyb20rKykge1xuXHRcdFx0XHRcdGNoZWNrYm94ZXNbZnJvbV0uY2hlY2tlZCA9IHN0YXR1cztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdGNsaWNrRXZlbnQgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdHZhciBpbnB1dCA9IHRoaXMuZ2V0RWxlbWVudCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdLGlucHV0W3R5cGU9XCJyYWRpb1wiXScpLFxuXHRcdFx0XHRcdGxpbWl0VG9nZ2xlciA9ICQoZS50YXJnZXQpLmdldFBhcmVudCgnLmxpbWl0X3RvZ2dsZXInKTtcblxuXHRcdFx0XHRpZiAoIWlucHV0IHx8IGlucHV0LmdldCgnZGlzYWJsZWQnKSB8fCBsaW1pdFRvZ2dsZXIgIT09IG51bGwpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBSYWRpbyBidXR0b25zXG5cdFx0XHRcdGlmIChpbnB1dC50eXBlID09ICdyYWRpbycpIHtcblx0XHRcdFx0XHRpZiAoIWlucHV0LmNoZWNrZWQpIHtcblx0XHRcdFx0XHRcdGlucHV0LmNoZWNrZWQgPSAnY2hlY2tlZCc7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2tib3hlc1xuXHRcdFx0XHRpZiAoZS5zaGlmdCAmJiBzdGFydCkge1xuXHRcdFx0XHRcdHNoaWZ0VG9nZ2xlKGlucHV0KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbnB1dC5jaGVja2VkID0gaW5wdXQuY2hlY2tlZCA/ICcnIDogJ2NoZWNrZWQnO1xuXG5cdFx0XHRcdFx0aWYgKGlucHV0LmdldCgnb25jbGljaycpID09ICdCYWNrZW5kLnRvZ2dsZUNoZWNrYm94ZXModGhpcyknKSB7XG5cdFx0XHRcdFx0XHRCYWNrZW5kLnRvZ2dsZUNoZWNrYm94ZXMoaW5wdXQpOyAvLyBzZWUgIzYzOTlcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzdGFydCA9IGlucHV0O1xuXHRcdFx0fSxcblx0XHRcdGNoZWNrYm94ZXMgPSBbXSwgc3RhcnQsIHRoaXNJbmRleCwgc3RhcnRJbmRleCwgc3RhdHVzLCBmcm9tLCB0bztcblxuXHRcdGlmIChjb250YWluZXIpIHtcblx0XHRcdGNoZWNrYm94ZXMgPSBjb250YWluZXIuZ2V0RWxlbWVudHMoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpO1xuXHRcdH1cblxuXHRcdC8vIFJvdyBjbGlja1xuXHRcdCQkKCcudG9nZ2xlX3NlbGVjdCcpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdHZhciBib3VuZEV2ZW50ID0gZWwucmV0cmlldmUoJ2JvdW5kRXZlbnQnKTtcblxuXHRcdFx0aWYgKGJvdW5kRXZlbnQpIHtcblx0XHRcdFx0ZWwucmVtb3ZlRXZlbnQoJ2NsaWNrJywgYm91bmRFdmVudCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIERvIG5vdCBwcm9wYWdhdGUgdGhlIGZvcm0gZmllbGQgY2xpY2sgZXZlbnRzXG5cdFx0XHRlbC5nZXRFbGVtZW50cygnbGFiZWwsaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdLGlucHV0W3R5cGU9XCJyYWRpb1wiXScpLmVhY2goZnVuY3Rpb24oaSkge1xuXHRcdFx0XHRpLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHRib3VuZEV2ZW50ID0gY2xpY2tFdmVudC5iaW5kKGVsKTtcblxuXHRcdFx0ZWwuYWRkRXZlbnQoJ2NsaWNrJywgYm91bmRFdmVudCk7XG5cdFx0XHRlbC5zdG9yZSgnYm91bmRFdmVudCcsIGJvdW5kRXZlbnQpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gQ2hlY2tib3ggY2xpY2tcblx0XHRjaGVja2JveGVzLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdGVsLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0aWYgKGUuc2hpZnQgJiYgc3RhcnQpIHtcblx0XHRcdFx0XHRzaGlmdFRvZ2dsZSh0aGlzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHN0YXJ0ID0gdGhpcztcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBBbGxvdyB0byBtYXJrIHRoZSBpbXBvcnRhbnQgcGFydCBvZiBhbiBpbWFnZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgVGhlIERPTSBlbGVtZW50XG5cdCAqL1xuXHRlZGl0UHJldmlld1dpemFyZDogZnVuY3Rpb24oZWwpIHtcblx0XHRlbCA9ICQoZWwpO1xuXHRcdHZhciBpbWFnZUVsZW1lbnQgPSBlbC5nZXRFbGVtZW50KCdpbWcnKSxcblx0XHRcdGlucHV0RWxlbWVudHMgPSB7fSxcblx0XHRcdGlzRHJhd2luZyA9IGZhbHNlLFxuXHRcdFx0cGFydEVsZW1lbnQsIHN0YXJ0UG9zLFxuXHRcdFx0Z2V0U2NhbGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHR4OiBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCkud2lkdGgsXG5cdFx0XHRcdFx0eTogaW1hZ2VFbGVtZW50LmdldENvbXB1dGVkU2l6ZSgpLmhlaWdodFxuXHRcdFx0XHR9O1xuXHRcdFx0fSxcblx0XHRcdHVwZGF0ZUltYWdlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzY2FsZSA9IGdldFNjYWxlKCksXG5cdFx0XHRcdFx0aW1hZ2VTaXplID0gaW1hZ2VFbGVtZW50LmdldENvbXB1dGVkU2l6ZSgpO1xuXHRcdFx0XHRwYXJ0RWxlbWVudC5zZXRTdHlsZXMoe1xuXHRcdFx0XHRcdHRvcDogaW1hZ2VTaXplLmNvbXB1dGVkVG9wICsgKGlucHV0RWxlbWVudHMueS5nZXQoJ3ZhbHVlJykgKiBzY2FsZS55KS5yb3VuZCgpICsgJ3B4Jyxcblx0XHRcdFx0XHRsZWZ0OiBpbWFnZVNpemUuY29tcHV0ZWRMZWZ0ICsgKGlucHV0RWxlbWVudHMueC5nZXQoJ3ZhbHVlJykgKiBzY2FsZS54KS5yb3VuZCgpICsgJ3B4Jyxcblx0XHRcdFx0XHR3aWR0aDogKGlucHV0RWxlbWVudHMud2lkdGguZ2V0KCd2YWx1ZScpICogc2NhbGUueCkucm91bmQoKSArICdweCcsXG5cdFx0XHRcdFx0aGVpZ2h0OiAoaW5wdXRFbGVtZW50cy5oZWlnaHQuZ2V0KCd2YWx1ZScpICogc2NhbGUueSkucm91bmQoKSArICdweCdcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICghaW5wdXRFbGVtZW50cy53aWR0aC5nZXQoJ3ZhbHVlJykudG9GbG9hdCgpIHx8ICFpbnB1dEVsZW1lbnRzLmhlaWdodC5nZXQoJ3ZhbHVlJykudG9GbG9hdCgpKSB7XG5cdFx0XHRcdFx0cGFydEVsZW1lbnQuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBhcnRFbGVtZW50LnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHR1cGRhdGVWYWx1ZXMgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHNjYWxlID0gZ2V0U2NhbGUoKSxcblx0XHRcdFx0XHRzdHlsZXMgPSBwYXJ0RWxlbWVudC5nZXRTdHlsZXMoJ3RvcCcsICdsZWZ0JywgJ3dpZHRoJywgJ2hlaWdodCcpLFxuXHRcdFx0XHRcdGltYWdlU2l6ZSA9IGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKSxcblx0XHRcdFx0XHR2YWx1ZXMgPSB7XG5cdFx0XHRcdFx0XHR4OiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCAoc3R5bGVzLmxlZnQudG9GbG9hdCgpIC0gaW1hZ2VTaXplLmNvbXB1dGVkTGVmdCkgLyBzY2FsZS54KSksXG5cdFx0XHRcdFx0XHR5OiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCAoc3R5bGVzLnRvcC50b0Zsb2F0KCkgLSBpbWFnZVNpemUuY29tcHV0ZWRUb3ApIC8gc2NhbGUueSkpXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0dmFsdWVzLndpZHRoID0gTWF0aC5taW4oMSAtIHZhbHVlcy54LCBzdHlsZXMud2lkdGgudG9GbG9hdCgpIC8gc2NhbGUueCk7XG5cdFx0XHRcdHZhbHVlcy5oZWlnaHQgPSBNYXRoLm1pbigxIC0gdmFsdWVzLnksIHN0eWxlcy5oZWlnaHQudG9GbG9hdCgpIC8gc2NhbGUueSk7XG5cdFx0XHRcdGlmICghdmFsdWVzLndpZHRoIHx8ICF2YWx1ZXMuaGVpZ2h0KSB7XG5cdFx0XHRcdFx0dmFsdWVzLnggPSB2YWx1ZXMueSA9IHZhbHVlcy53aWR0aCA9IHZhbHVlcy5oZWlnaHQgPSAnJztcblx0XHRcdFx0XHRwYXJ0RWxlbWVudC5zZXRTdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cGFydEVsZW1lbnQuc2V0U3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRPYmplY3QuZWFjaCh2YWx1ZXMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcblx0XHRcdFx0XHRpbnB1dEVsZW1lbnRzW2tleV0uc2V0KCd2YWx1ZScsIHZhbHVlID09PSAnJyA/ICcnIDogTnVtYmVyKHZhbHVlKS50b0ZpeGVkKDE1KSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdHN0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0aWYgKGlzRHJhd2luZykge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRpc0RyYXdpbmcgPSB0cnVlO1xuXHRcdFx0XHRzdGFydFBvcyA9IHtcblx0XHRcdFx0XHR4OiBldmVudC5wYWdlLnggLSBlbC5nZXRQb3NpdGlvbigpLnggLSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCkuY29tcHV0ZWRMZWZ0LFxuXHRcdFx0XHRcdHk6IGV2ZW50LnBhZ2UueSAtIGVsLmdldFBvc2l0aW9uKCkueSAtIGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKS5jb21wdXRlZFRvcFxuXHRcdFx0XHR9O1xuXHRcdFx0XHRtb3ZlKGV2ZW50KTtcblx0XHRcdH0sXG5cdFx0XHRtb3ZlID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0aWYgKCFpc0RyYXdpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dmFyIGltYWdlU2l6ZSA9IGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKTtcblx0XHRcdFx0dmFyIHJlY3QgPSB7XG5cdFx0XHRcdFx0eDogW1xuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgTWF0aC5taW4oaW1hZ2VTaXplLndpZHRoLCBzdGFydFBvcy54KSksXG5cdFx0XHRcdFx0XHRNYXRoLm1heCgwLCBNYXRoLm1pbihpbWFnZVNpemUud2lkdGgsIGV2ZW50LnBhZ2UueCAtIGVsLmdldFBvc2l0aW9uKCkueCAtIGltYWdlU2l6ZS5jb21wdXRlZExlZnQpKVxuXHRcdFx0XHRcdF0sXG5cdFx0XHRcdFx0eTogW1xuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgTWF0aC5taW4oaW1hZ2VTaXplLmhlaWdodCwgc3RhcnRQb3MueSkpLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgTWF0aC5taW4oaW1hZ2VTaXplLmhlaWdodCwgZXZlbnQucGFnZS55IC0gZWwuZ2V0UG9zaXRpb24oKS55IC0gaW1hZ2VTaXplLmNvbXB1dGVkVG9wKSlcblx0XHRcdFx0XHRdXG5cdFx0XHRcdH07XG5cdFx0XHRcdHBhcnRFbGVtZW50LnNldFN0eWxlcyh7XG5cdFx0XHRcdFx0dG9wOiBNYXRoLm1pbihyZWN0LnlbMF0sIHJlY3QueVsxXSkgKyBpbWFnZVNpemUuY29tcHV0ZWRUb3AgKyAncHgnLFxuXHRcdFx0XHRcdGxlZnQ6IE1hdGgubWluKHJlY3QueFswXSwgcmVjdC54WzFdKSArIGltYWdlU2l6ZS5jb21wdXRlZExlZnQgKyAncHgnLFxuXHRcdFx0XHRcdHdpZHRoOiBNYXRoLmFicyhyZWN0LnhbMF0gLSByZWN0LnhbMV0pICsgJ3B4Jyxcblx0XHRcdFx0XHRoZWlnaHQ6IE1hdGguYWJzKHJlY3QueVswXSAtIHJlY3QueVsxXSkgKyAncHgnXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR1cGRhdGVWYWx1ZXMoKTtcblx0XHRcdH0sXG5cdFx0XHRzdG9wID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0bW92ZShldmVudCk7XG5cdFx0XHRcdGlzRHJhd2luZyA9IGZhbHNlO1xuXHRcdFx0fSxcblx0XHRcdGluaXQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZWwuZ2V0UGFyZW50KCcudGxfdGJveCwudGxfYm94JykuZ2V0RWxlbWVudHMoJ2lucHV0W25hbWVePVwiaW1wb3J0YW50UGFydFwiXScpLmVhY2goZnVuY3Rpb24oaW5wdXQpIHtcblx0XHRcdFx0XHRbJ3gnLCAneScsICd3aWR0aCcsICdoZWlnaHQnXS5lYWNoKGZ1bmN0aW9uKGtleSkge1xuXHRcdFx0XHRcdFx0aWYgKGlucHV0LmdldCgnbmFtZScpLnN1YnN0cigxMywga2V5Lmxlbmd0aCkgPT09IGtleS5jYXBpdGFsaXplKCkpIHtcblx0XHRcdFx0XHRcdFx0aW5wdXRFbGVtZW50c1trZXldID0gaW5wdXQgPSAkKGlucHV0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmIChPYmplY3QuZ2V0TGVuZ3RoKGlucHV0RWxlbWVudHMpICE9PSA0KSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdE9iamVjdC5lYWNoKGlucHV0RWxlbWVudHMsIGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0XHRcdFx0aW5wdXQuZ2V0UGFyZW50KCkuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0ZWwuYWRkQ2xhc3MoJ3RsX2VkaXRfcHJldmlld19lbmFibGVkJyk7XG5cdFx0XHRcdHBhcnRFbGVtZW50ID0gbmV3IEVsZW1lbnQoJ2RpdicsIHtcblx0XHRcdFx0XHQnY2xhc3MnOiAndGxfZWRpdF9wcmV2aWV3X2ltcG9ydGFudF9wYXJ0J1xuXHRcdFx0XHR9KS5pbmplY3QoZWwpO1xuXHRcdFx0XHR1cGRhdGVJbWFnZSgpO1xuXHRcdFx0XHRpbWFnZUVsZW1lbnQuYWRkRXZlbnQoJ2xvYWQnLCB1cGRhdGVJbWFnZSk7XG5cdFx0XHRcdGVsLmFkZEV2ZW50cyh7XG5cdFx0XHRcdFx0bW91c2Vkb3duOiBzdGFydCxcblx0XHRcdFx0XHR0b3VjaHN0YXJ0OiBzdGFydFxuXHRcdFx0XHR9KTtcblx0XHRcdFx0JChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmFkZEV2ZW50cyh7XG5cdFx0XHRcdFx0bW91c2Vtb3ZlOiBtb3ZlLFxuXHRcdFx0XHRcdHRvdWNobW92ZTogbW92ZSxcblx0XHRcdFx0XHRtb3VzZXVwOiBzdG9wLFxuXHRcdFx0XHRcdHRvdWNoZW5kOiBzdG9wLFxuXHRcdFx0XHRcdHRvdWNoY2FuY2VsOiBzdG9wLFxuXHRcdFx0XHRcdHJlc2l6ZTogdXBkYXRlSW1hZ2Vcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0O1xuXG5cdFx0d2luZG93LmFkZEV2ZW50KCdkb21yZWFkeScsIGluaXQpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBFbmFibGUgZHJhZyBhbmQgZHJvcCBmaWxlIHVwbG9hZCBmb3IgdGhlIGZpbGUgdHJlZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gd3JhcCAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9uYWwgb3B0aW9ucyBvYmplY3Rcblx0ICovXG5cdGVuYWJsZUZpbGVUcmVlVXBsb2FkOiBmdW5jdGlvbih3cmFwLCBvcHRpb25zKSB7XG5cdFx0d3JhcCA9ICQod3JhcCk7XG5cblx0XHR2YXIgZmFsbGJhY2tVcmwgPSBvcHRpb25zLnVybCxcblx0XHRcdGR6RWxlbWVudCA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdCdjbGFzcyc6ICdkcm9wem9uZSBkcm9wem9uZS1maWxldHJlZScsXG5cdFx0XHRcdGh0bWw6ICc8c3BhbiBjbGFzcz1cImRyb3B6b25lLXByZXZpZXdzXCI+PC9zcGFuPidcblx0XHRcdH0pLmluamVjdCh3cmFwLCAndG9wJyksXG5cdFx0XHRjdXJyZW50SG92ZXIsIGN1cnJlbnRIb3ZlclRpbWUsIGV4cGFuZExpbms7XG5cblx0XHRvcHRpb25zLnByZXZpZXdzQ29udGFpbmVyID0gZHpFbGVtZW50LmdldEVsZW1lbnQoJy5kcm9wem9uZS1wcmV2aWV3cycpO1xuXHRcdG9wdGlvbnMuY2xpY2thYmxlID0gZmFsc2U7XG5cblx0XHR2YXIgZHogPSBuZXcgRHJvcHpvbmUod3JhcCwgb3B0aW9ucyk7XG5cblx0XHRkei5vbigncXVldWVjb21wbGV0ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuXHRcdH0pO1xuXG5cdFx0ZHoub24oJ2RyYWdvdmVyJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdGlmICghZXZlbnQuZGF0YVRyYW5zZmVyIHx8ICFldmVudC5kYXRhVHJhbnNmZXIudHlwZXMgfHwgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzLmluZGV4T2YoJ0ZpbGVzJykgPT09IC0xKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0d3JhcC5nZXRFbGVtZW50cygnLnRsX2ZvbGRlcl9kcm9wcGluZycpLnJlbW92ZUNsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblx0XHRcdHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQgJiYgJChldmVudC50YXJnZXQpO1xuXG5cdFx0XHRpZiAodGFyZ2V0KSB7XG5cdFx0XHRcdHZhciBmb2xkZXIgPSB0YXJnZXQubWF0Y2goJy50bF9mb2xkZXInKSA/IHRhcmdldCA6IHRhcmdldC5nZXRQYXJlbnQoJy50bF9mb2xkZXInKTtcblxuXHRcdFx0XHRpZiAoIWZvbGRlcikge1xuXHRcdFx0XHRcdGZvbGRlciA9IHRhcmdldC5nZXRQYXJlbnQoJy5wYXJlbnQnKTtcblx0XHRcdFx0XHRmb2xkZXIgPSBmb2xkZXIgJiYgZm9sZGVyLmdldFByZXZpb3VzKCcudGxfZm9sZGVyJyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoZm9sZGVyKSB7XG5cdFx0XHRcdFx0dmFyIGxpbmsgPSBmb2xkZXIuZ2V0RWxlbWVudCgnaW1nW3NyYyQ9XCIvaWNvbnMvbmV3LnN2Z1wiXScpO1xuXHRcdFx0XHRcdGxpbmsgPSBsaW5rICYmIGxpbmsuZ2V0UGFyZW50KCdhJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGxpbmsgJiYgbGluay5ocmVmKSB7XG5cdFx0XHRcdGR6Lm9wdGlvbnMudXJsID0gJycrbGluay5ocmVmO1xuXHRcdFx0XHRmb2xkZXIuYWRkQ2xhc3MoJ3RsX2ZvbGRlcl9kcm9wcGluZycpO1xuXG5cdFx0XHRcdGlmIChjdXJyZW50SG92ZXIgIT09IGZvbGRlcikge1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlciA9IGZvbGRlcjtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdFx0XHRcdFx0ZXhwYW5kTGluayA9IGZvbGRlci5nZXRFbGVtZW50KCdhLmZvbGRhYmxlJyk7XG5cblx0XHRcdFx0XHRpZiAoZXhwYW5kTGluayAmJiAhZXhwYW5kTGluay5oYXNDbGFzcygnZm9sZGFibGUtLW9wZW4nKSkge1xuXHRcdFx0XHRcdFx0Ly8gRXhwYW5kIHRoZSBmb2xkZXIgYWZ0ZXIgb25lIHNlY29uZCBob3ZlciB0aW1lXG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoY3VycmVudEhvdmVyID09PSBmb2xkZXIgJiYgY3VycmVudEhvdmVyVGltZSArIDkwMCA8IG5ldyBEYXRlKCkuZ2V0VGltZSgpKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcblx0XHRcdFx0XHRcdFx0XHRldmVudC5pbml0RXZlbnQoJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0ZXhwYW5kTGluay5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblx0XHRcdFx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSwgMTAwMCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkei5vcHRpb25zLnVybCA9IGZhbGxiYWNrVXJsO1xuXHRcdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRkei5vbignZHJvcCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoIWV2ZW50LmRhdGFUcmFuc2ZlciB8fCAhZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzIHx8IGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlcy5pbmRleE9mKCdGaWxlcycpID09PSAtMSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGR6RWxlbWVudC5hZGRDbGFzcygnZHJvcHpvbmUtZmlsZXRyZWUtZW5hYmxlZCcpO1xuXHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdH0pO1xuXG5cdFx0ZHoub24oJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0d3JhcC5nZXRFbGVtZW50cygnLnRsX2ZvbGRlcl9kcm9wcGluZycpLnJlbW92ZUNsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblx0XHRcdGN1cnJlbnRIb3ZlciA9IHVuZGVmaW5lZDtcblx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIENyYXdsIHRoZSB3ZWJzaXRlXG5cdCAqL1xuXHRjcmF3bDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRpbWVvdXQgPSAyMDAwLFxuXHRcdFx0Y3Jhd2wgPSAkKCd0bF9jcmF3bCcpLFxuXHRcdFx0cHJvZ3Jlc3NCYXIgPSBjcmF3bC5nZXRFbGVtZW50KCdkaXYucHJvZ3Jlc3MtYmFyJyksXG5cdFx0XHRwcm9ncmVzc0NvdW50ID0gY3Jhd2wuZ2V0RWxlbWVudCgncC5wcm9ncmVzcy1jb3VudCcpLFxuXHRcdFx0cmVzdWx0cyA9IGNyYXdsLmdldEVsZW1lbnQoJ2Rpdi5yZXN1bHRzJyksXG5cdFx0XHRkZWJ1Z0xvZyA9IGNyYXdsLmdldEVsZW1lbnQoJ3AuZGVidWctbG9nJyk7XG5cblx0XHRmdW5jdGlvbiB1cGRhdGVEYXRhKHJlc3BvbnNlKSB7XG5cdFx0XHR2YXIgdG90YWwgPSByZXNwb25zZS50b3RhbCxcblx0XHRcdFx0ZG9uZSA9IHRvdGFsIC0gcmVzcG9uc2UucGVuZGluZyxcblx0XHRcdFx0cGVyY2VudGFnZSA9IHRvdGFsID4gMCA/IHBhcnNlSW50KGRvbmUgLyB0b3RhbCAqIDEwMCwgMTApIDogMTAwLFxuXHRcdFx0XHRyZXN1bHQ7XG5cblx0XHRcdC8vIEluaXRpYWxpemUgdGhlIHN0YXR1cyBiYXIgYXQgMTAlXG5cdFx0XHRpZiAoZG9uZSA8IDEgJiYgcGVyY2VudGFnZSA8IDEpIHtcblx0XHRcdFx0ZG9uZSA9IDE7XG5cdFx0XHRcdHBlcmNlbnRhZ2UgPSAxMDtcblx0XHRcdFx0dG90YWwgPSAxMDtcblx0XHRcdH1cblxuXHRcdFx0cHJvZ3Jlc3NCYXIuc2V0U3R5bGUoJ3dpZHRoJywgcGVyY2VudGFnZSArICclJyk7XG5cdFx0XHRwcm9ncmVzc0Jhci5zZXQoJ2h0bWwnLCBwZXJjZW50YWdlICsgJyUnKTtcblx0XHRcdHByb2dyZXNzQmFyLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIHBlcmNlbnRhZ2UpO1xuXHRcdFx0cHJvZ3Jlc3NDb3VudC5zZXQoJ2h0bWwnLCBkb25lICsgJyAvICcgKyB0b3RhbCk7XG5cblx0XHRcdGlmIChyZXNwb25zZS5oYXNEZWJ1Z0xvZykge1xuXHRcdFx0XHRkZWJ1Z0xvZy5zZXRTdHlsZSgnZGlzcGxheScsICdibG9jaycpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAocmVzcG9uc2UuaGFzRGVidWdMb2cpIHtcblx0XHRcdFx0ZGVidWdMb2cuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFyZXNwb25zZS5maW5pc2hlZCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHByb2dyZXNzQmFyLnJlbW92ZUNsYXNzKCdydW5uaW5nJykuYWRkQ2xhc3MoJ2ZpbmlzaGVkJyk7XG5cdFx0XHRyZXN1bHRzLnJlbW92ZUNsYXNzKCdydW5uaW5nJykuYWRkQ2xhc3MoJ2ZpbmlzaGVkJyk7XG5cblx0XHRcdGZvciAocmVzdWx0IGluIHJlc3BvbnNlLnJlc3VsdHMpIHtcblx0XHRcdFx0aWYgKHJlc3BvbnNlLnJlc3VsdHMuaGFzT3duUHJvcGVydHkocmVzdWx0KSkge1xuXHRcdFx0XHRcdHZhciBzdW1tYXJ5ID0gcmVzdWx0cy5nZXRFbGVtZW50KCcucmVzdWx0W2RhdGEtc3Vic2NyaWJlcj1cIicgKyByZXN1bHQgKyAnXCJdIHAuc3VtbWFyeScpLFxuXHRcdFx0XHRcdFx0d2FybmluZyA9IHJlc3VsdHMuZ2V0RWxlbWVudCgnLnJlc3VsdFtkYXRhLXN1YnNjcmliZXI9XCInICsgcmVzdWx0ICsgJ1wiXSBwLndhcm5pbmcnKSxcblx0XHRcdFx0XHRcdGxvZyA9IHJlc3VsdHMuZ2V0RWxlbWVudCgnLnJlc3VsdFtkYXRhLXN1YnNjcmliZXI9XCInICsgcmVzdWx0ICsgJ1wiXSBwLnN1YnNjcmliZXItbG9nJyksXG5cdFx0XHRcdFx0XHRzdWJzY3JpYmVyUmVzdWx0cyA9IHJlc3BvbnNlLnJlc3VsdHNbcmVzdWx0XSxcblx0XHRcdFx0XHRcdHN1YnNjcmliZXJTdW1tYXJ5ID0gc3Vic2NyaWJlclJlc3VsdHMuc3VtbWFyeTtcblxuXHRcdFx0XHRcdGlmIChzdWJzY3JpYmVyUmVzdWx0cy53YXJuaW5nKSB7XG5cdFx0XHRcdFx0XHR3YXJuaW5nLnNldCgnaHRtbCcsIHN1YnNjcmliZXJSZXN1bHRzLndhcm5pbmcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChzdWJzY3JpYmVyUmVzdWx0cy5oYXNMb2cpIHtcblx0XHRcdFx0XHRcdGxvZy5zZXRTdHlsZSgnZGlzcGxheScsICdibG9jaycpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHN1bW1hcnkuYWRkQ2xhc3Moc3Vic2NyaWJlclJlc3VsdHMud2FzU3VjY2Vzc2Z1bCA/ICdzdWNjZXNzJyA6ICdmYWlsdXJlJyk7XG5cdFx0XHRcdFx0c3VtbWFyeS5zZXQoJ2h0bWwnLCBzdWJzY3JpYmVyU3VtbWFyeSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBleGVjUmVxdWVzdChvbmx5U3RhdHVzVXBkYXRlID0gZmFsc2UpIHtcblx0XHRcdG5ldyBSZXF1ZXN0KHtcblx0XHRcdFx0dXJsOiB3aW5kb3cubG9jYXRpb24uaHJlZixcblx0XHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcdCdPbmx5LVN0YXR1cy1VcGRhdGUnOiBvbmx5U3RhdHVzVXBkYXRlXG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uU3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2VUZXh0KSB7XG5cdFx0XHRcdFx0dmFyIHJlc3BvbnNlID0gSlNPTi5kZWNvZGUocmVzcG9uc2VUZXh0KTtcblxuXHRcdFx0XHRcdHVwZGF0ZURhdGEocmVzcG9uc2UpO1xuXG5cdFx0XHRcdFx0aWYgKCFyZXNwb25zZS5maW5pc2hlZCkge1xuXHRcdFx0XHRcdFx0c2V0VGltZW91dChleGVjUmVxdWVzdCwgdGltZW91dCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KS5zZW5kKCk7XG5cdFx0fVxuXG5cdFx0ZXhlY1JlcXVlc3QodHJ1ZSk7XG5cdH1cbn07XG5cbndpbmRvdy5UaGVtZSA9XG57XG5cdC8qKlxuXHQgKiBDaGVjayBmb3IgV2ViS2l0XG5cdCAqIEBtZW1iZXIge2Jvb2xlYW59XG4gXHQgKi9cblx0aXNXZWJraXQ6IChCcm93c2VyLmNocm9tZSB8fCBCcm93c2VyLnNhZmFyaSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8oPzp3ZWJraXR8a2h0bWwpL2kpKSxcblxuXHQvKipcblx0ICogU3RvcCB0aGUgcHJvcGFnYXRpb24gb2YgY2xpY2sgZXZlbnRzIG9mIGNlcnRhaW4gZWxlbWVudHNcblx0ICovXG5cdHN0b3BDbGlja1Byb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHtcblx0XHQvLyBEbyBub3QgcHJvcGFnYXRlIHRoZSBjbGljayBldmVudHMgb2YgdGhlIGljb25zXG5cdFx0JCQoJy5waWNrZXJfc2VsZWN0b3InKS5lYWNoKGZ1bmN0aW9uKHVsKSB7XG5cdFx0XHR1bC5nZXRFbGVtZW50cygnYScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0ZWwuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblx0XHQvLyBEbyBub3QgcHJvcGFnYXRlIHRoZSBjbGljayBldmVudHMgb2YgdGhlIGNoZWNrYm94ZXNcblx0XHQkJCgnLnBpY2tlcl9zZWxlY3RvciwuY2xpY2syZWRpdCcpLmVhY2goZnVuY3Rpb24odWwpIHtcblx0XHRcdHVsLmdldEVsZW1lbnRzKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdGVsLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBTZXQgdXAgdGhlIFtDdHJsXSArIGNsaWNrIHRvIGVkaXQgZnVuY3Rpb25hbGl0eVxuXHQgKi9cblx0c2V0dXBDdHJsQ2xpY2s6IGZ1bmN0aW9uKCkge1xuXHRcdCQkKCcuY2xpY2syZWRpdCcpLmVhY2goZnVuY3Rpb24oZWwpIHtcblxuXHRcdFx0Ly8gRG8gbm90IHByb3BhZ2F0ZSB0aGUgY2xpY2sgZXZlbnRzIG9mIHRoZSBkZWZhdWx0IGJ1dHRvbnMgKHNlZSAjNTczMSlcblx0XHRcdGVsLmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihhKSB7XG5cdFx0XHRcdGEuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIFNldCB1cCByZWd1bGFyIGNsaWNrIGV2ZW50cyBvbiB0b3VjaCBkZXZpY2VzXG5cdFx0XHRpZiAoQnJvd3Nlci5GZWF0dXJlcy5Ub3VjaCkge1xuXHRcdFx0XHRlbC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoIWVsLmdldEF0dHJpYnV0ZSgnZGF0YS12aXNpdGVkJykpIHtcblx0XHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZSgnZGF0YS12aXNpdGVkJywgJzEnKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZWwuZ2V0RWxlbWVudHMoJ2EnKS5lYWNoKGZ1bmN0aW9uKGEpIHtcblx0XHRcdFx0XHRcdFx0aWYgKGEuaGFzQ2xhc3MoJ2VkaXQnKSkge1xuXHRcdFx0XHRcdFx0XHRcdGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBhLmhyZWY7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0ZWwucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXZpc2l0ZWQnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWwuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdHZhciBrZXkgPSBCcm93c2VyLlBsYXRmb3JtLm1hYyA/IGUuZXZlbnQubWV0YUtleSA6IGUuZXZlbnQuY3RybEtleTtcblx0XHRcdFx0XHRpZiAoIWtleSkgcmV0dXJuO1xuXG5cdFx0XHRcdFx0aWYgKGUuZXZlbnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0XHRcdGVsLmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihhKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChhLmhhc0NsYXNzKCdjaGlsZHJlbicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGEuaHJlZjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGVsLmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihhKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChhLmhhc0NsYXNzKCdlZGl0JykpIHtcblx0XHRcdFx0XHRcdFx0XHRkb2N1bWVudC5sb2NhdGlvbi5ocmVmID0gYS5ocmVmO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBTZXQgdXAgdGhlIHRleHRhcmVhIHJlc2l6aW5nXG5cdCAqL1xuXHRzZXR1cFRleHRhcmVhUmVzaXppbmc6IGZ1bmN0aW9uKCkge1xuXHRcdCQkKCcudGxfdGV4dGFyZWEnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRpZiAoQnJvd3Nlci5pZTYgfHwgQnJvd3Nlci5pZTcgfHwgQnJvd3Nlci5pZTgpIHJldHVybjtcblx0XHRcdGlmIChlbC5oYXNDbGFzcygnbm9yZXNpemUnKSB8fCBlbC5yZXRyaWV2ZSgnYXV0b2dyb3cnKSkgcmV0dXJuO1xuXG5cdFx0XHQvLyBTZXQgdXAgdGhlIGR1bW15IGVsZW1lbnRcblx0XHRcdHZhciBkdW1teSA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdGh0bWw6ICdYJyxcblx0XHRcdFx0c3R5bGVzOiB7XG5cdFx0XHRcdFx0J3Bvc2l0aW9uJzonYWJzb2x1dGUnLFxuXHRcdFx0XHRcdCd0b3AnOjAsXG5cdFx0XHRcdFx0J2xlZnQnOictOTk5ZW0nLFxuXHRcdFx0XHRcdCdvdmVyZmxvdy14JzonaGlkZGVuJ1xuXHRcdFx0XHR9XG5cdFx0XHR9KS5zZXRTdHlsZXMoXG5cdFx0XHRcdGVsLmdldFN0eWxlcygnZm9udC1zaXplJywgJ2ZvbnQtZmFtaWx5JywgJ3dpZHRoJywgJ2xpbmUtaGVpZ2h0Jylcblx0XHRcdCkuaW5qZWN0KGRvY3VtZW50LmJvZHkpO1xuXG5cdFx0XHQvLyBBbHNvIGNvbnNpZGVyIHRoZSBib3gtc2l6aW5nXG5cdFx0XHRpZiAoZWwuZ2V0U3R5bGUoJy1tb3otYm94LXNpemluZycpID09ICdib3JkZXItYm94JyB8fCBlbC5nZXRTdHlsZSgnLXdlYmtpdC1ib3gtc2l6aW5nJykgPT0gJ2JvcmRlci1ib3gnIHx8IGVsLmdldFN0eWxlKCdib3gtc2l6aW5nJykgPT0gJ2JvcmRlci1ib3gnKSB7XG5cdFx0XHRcdGR1bW15LnNldFN0eWxlcyh7XG5cdFx0XHRcdFx0J3BhZGRpbmcnOiBlbC5nZXRTdHlsZSgncGFkZGluZycpLFxuXHRcdFx0XHRcdCdib3JkZXInOiBlbC5nZXRTdHlsZSgnYm9yZGVyLWxlZnQnKVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU2luZ2xlIGxpbmUgaGVpZ2h0XG5cdFx0XHR2YXIgbGluZSA9IE1hdGgubWF4KGR1bW15LmNsaWVudEhlaWdodCwgMzApO1xuXG5cdFx0XHQvLyBSZXNwb25kIHRvIHRoZSBcImlucHV0XCIgZXZlbnRcblx0XHRcdGVsLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkdW1teS5zZXQoJ2h0bWwnLCB0aGlzLmdldCgndmFsdWUnKVxuXHRcdFx0XHRcdC5yZXBsYWNlKC88L2csICcmbHQ7Jylcblx0XHRcdFx0XHQucmVwbGFjZSgvPi9nLCAnJmd0OycpXG5cdFx0XHRcdFx0LnJlcGxhY2UoL1xcbnxcXHJcXG4vZywgJzxicj5YJykpO1xuXHRcdFx0XHR2YXIgaGVpZ2h0ID0gTWF0aC5tYXgobGluZSwgZHVtbXkuZ2V0U2l6ZSgpLnkpO1xuXHRcdFx0XHRpZiAodGhpcy5jbGllbnRIZWlnaHQgIT0gaGVpZ2h0KSB0aGlzLnR3ZWVuKCdoZWlnaHQnLCBoZWlnaHQpO1xuXHRcdFx0fSkuc2V0KCd0d2VlbicsIHsgJ2R1cmF0aW9uJzoxMDAgfSkuc2V0U3R5bGUoJ2hlaWdodCcsIGxpbmUgKyAncHgnKTtcblxuXHRcdFx0Ly8gRmlyZSB0aGUgZXZlbnRcblx0XHRcdGVsLmZpcmVFdmVudCgnaW5wdXQnKTtcblx0XHRcdGVsLnN0b3JlKCdhdXRvZ3JvdycsIHRydWUpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBTZXQgdXAgdGhlIG1lbnUgdG9nZ2xlXG5cdCAqL1xuXHRzZXR1cE1lbnVUb2dnbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBidXJnZXIgPSAkKCdidXJnZXInKTtcblx0XHRpZiAoIWJ1cmdlcikgcmV0dXJuO1xuXG5cdFx0YnVyZ2VyXG5cdFx0XHQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkudG9nZ2xlQ2xhc3MoJ3Nob3ctbmF2aWdhdGlvbicpO1xuXHRcdFx0XHRidXJnZXIuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgZG9jdW1lbnQuYm9keS5oYXNDbGFzcygnc2hvdy1uYXZpZ2F0aW9uJykgPyAndHJ1ZScgOiAnZmFsc2UnKVxuXHRcdFx0fSlcblx0XHRcdC5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0aWYgKGUuZXZlbnQua2V5Q29kZSA9PSAyNykge1xuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ3Nob3ctbmF2aWdhdGlvbicpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdDtcblxuXHRcdGlmICh3aW5kb3cubWF0Y2hNZWRpYSkge1xuXHRcdFx0dmFyIG1hdGNoTWVkaWEgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKG1heC13aWR0aDo5OTFweCknKTtcblx0XHRcdHZhciBzZXRBcmlhQ29udHJvbHMgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKG1hdGNoTWVkaWEubWF0Y2hlcykge1xuXHRcdFx0XHRcdGJ1cmdlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCAnbGVmdCcpXG5cdFx0XHRcdFx0YnVyZ2VyLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGRvY3VtZW50LmJvZHkuaGFzQ2xhc3MoJ3Nob3ctbmF2aWdhdGlvbicpID8gJ3RydWUnIDogJ2ZhbHNlJylcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRidXJnZXIucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XG5cdFx0XHRcdFx0YnVyZ2VyLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0bWF0Y2hNZWRpYS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBzZXRBcmlhQ29udHJvbHMpO1xuXHRcdFx0c2V0QXJpYUNvbnRyb2xzKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBTZXQgdXAgdGhlIHByb2ZpbGUgdG9nZ2xlXG5cdCAqL1xuXHRzZXR1cFByb2ZpbGVUb2dnbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0bWVudSA9ICQoJ3RtZW51Jyk7XG5cdFx0aWYgKCF0bWVudSkgcmV0dXJuO1xuXG5cdFx0dmFyIGxpID0gdG1lbnUuZ2V0RWxlbWVudCgnLnN1Ym1lbnUnKSxcblx0XHRcdGJ1dHRvbiA9IGxpLmdldEZpcnN0KCdzcGFuJykuZ2V0Rmlyc3QoJ2J1dHRvbicpLFxuXHRcdFx0bWVudSA9IGxpLmdldEZpcnN0KCd1bCcpO1xuXHRcdGlmICghbGkgfHwgIWJ1dHRvbiB8fCAhbWVudSkgcmV0dXJuO1xuXG5cdFx0YnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsICd0bWVudV9fcHJvZmlsZScpO1xuXHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcblxuXHRcdG1lbnUuaWQgPSAndG1lbnVfX3Byb2ZpbGUnO1xuXG5cdFx0YnV0dG9uLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmIChsaS5oYXNDbGFzcygnYWN0aXZlJykpIHtcblx0XHRcdFx0bGkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsaS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuXHRcdFx0fVxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9KTtcblxuXHRcdCQoZG9jdW1lbnQuYm9keSkuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAobGkuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG5cdFx0XHRcdGxpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBzcGxpdCBidXR0b24gdG9nZ2xlXG5cdCAqL1xuXHRzZXR1cFNwbGl0QnV0dG9uVG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdG9nZ2xlID0gJCgnc2J0b2cnKTtcblx0XHRpZiAoIXRvZ2dsZSkgcmV0dXJuO1xuXG5cdFx0dmFyIHVsID0gdG9nZ2xlLmdldFBhcmVudCgnLnNwbGl0LWJ1dHRvbicpLmdldEVsZW1lbnQoJ3VsJyksXG5cdFx0XHR0YWIsIHRpbWVyO1xuXG5cdFx0dG9nZ2xlLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRhYiA9IGZhbHNlO1xuXHRcdFx0dWwudG9nZ2xlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXHRcdFx0dG9nZ2xlLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cblx0XHQkKGRvY3VtZW50LmJvZHkpLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGFiID0gZmFsc2U7XG5cdFx0XHR1bC5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG5cdFx0XHR0b2dnbGUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdH0pO1xuXG5cdFx0JChkb2N1bWVudC5ib2R5KS5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRhYiA9IChlLmV2ZW50LmtleUNvZGUgPT0gOSk7XG5cdFx0fSk7XG5cblx0XHRbdG9nZ2xlXS5hcHBlbmQodWwuZ2V0RWxlbWVudHMoJ2J1dHRvbicpKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRlbC5hZGRFdmVudCgnZm9jdXMnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCF0YWIpIHJldHVybjtcblx0XHRcdFx0dWwucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXHRcdFx0XHR0b2dnbGUuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGVsLmFkZEV2ZW50KCdibHVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghdGFiKSByZXR1cm47XG5cdFx0XHRcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR1bC5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG5cdFx0XHRcdFx0dG9nZ2xlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0dG9nZ2xlLnNldCgndGFiaW5kZXgnLCAnLTEnKTtcblx0fVxufTtcblxuLy8gSW5pdGlhbGl6ZSB0aGUgYmFjayBlbmQgc2NyaXB0XG53aW5kb3cuYWRkRXZlbnQoJ2RvbXJlYWR5JywgZnVuY3Rpb24oKSB7XG5cdCQoZG9jdW1lbnQuYm9keSkuYWRkQ2xhc3MoJ2pzJyk7XG5cblx0Ly8gTWFyayB0b3VjaCBkZXZpY2VzIChzZWUgIzU1NjMpXG5cdGlmIChCcm93c2VyLkZlYXR1cmVzLlRvdWNoKSB7XG5cdFx0JChkb2N1bWVudC5ib2R5KS5hZGRDbGFzcygndG91Y2gnKTtcblx0fVxuXG5cdEJhY2tlbmQudGFibGVXaXphcmRTZXRXaWR0aCgpO1xuXHRCYWNrZW5kLmVuYWJsZUltYWdlU2l6ZVdpZGdldHMoKTtcblx0QmFja2VuZC5lbmFibGVUb2dnbGVTZWxlY3QoKTtcblxuXHRUaGVtZS5zdG9wQ2xpY2tQcm9wYWdhdGlvbigpO1xuXHRUaGVtZS5zZXR1cEN0cmxDbGljaygpO1xuXHRUaGVtZS5zZXR1cFRleHRhcmVhUmVzaXppbmcoKTtcblx0VGhlbWUuc2V0dXBNZW51VG9nZ2xlKCk7XG5cdFRoZW1lLnNldHVwUHJvZmlsZVRvZ2dsZSgpO1xuXHRUaGVtZS5zZXR1cFNwbGl0QnV0dG9uVG9nZ2xlKCk7XG59KTtcblxuLy8gUmVzaXplIHRoZSB0YWJsZSB3aXphcmRcbndpbmRvdy5hZGRFdmVudCgncmVzaXplJywgZnVuY3Rpb24oKSB7XG5cdEJhY2tlbmQudGFibGVXaXphcmRTZXRXaWR0aCgpO1xufSk7XG5cbi8vIFJlLWFwcGx5IGNlcnRhaW4gY2hhbmdlcyB1cG9uIGFqYXhfY2hhbmdlXG53aW5kb3cuYWRkRXZlbnQoJ2FqYXhfY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cdEJhY2tlbmQuZW5hYmxlSW1hZ2VTaXplV2lkZ2V0cygpO1xuXHRCYWNrZW5kLmVuYWJsZVRvZ2dsZVNlbGVjdCgpO1xuXG5cdFRoZW1lLnN0b3BDbGlja1Byb3BhZ2F0aW9uKCk7XG5cdFRoZW1lLnNldHVwQ3RybENsaWNrKCk7XG5cdFRoZW1lLnNldHVwVGV4dGFyZWFSZXNpemluZygpO1xufSk7XG4iLCJ3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5saW1pdF9oZWlnaHQnKS5mb3JFYWNoKGZ1bmN0aW9uKGRpdikge1xuICAgICAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignVXNpbmcgXCJsaW1pdF9oZWlnaHRcIiBjbGFzcyBvbiBjaGlsZF9yZWNvcmRfY2FsbGJhY2sgaXMgZGVwcmVjYXRlZC4gU2V0IGEgbGlzdC5zb3J0aW5nLmxpbWl0SGVpZ2h0IGluIHlvdXIgRENBIGluc3RlYWQuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwYXJlbnQgPSBkaXYucGFyZW50Tm9kZS5jbG9zZXN0KCcudGxfY29udGVudCcpO1xuXG4gICAgICAgIC8vIFJldHVybiBpZiB0aGUgZWxlbWVudCBpcyBhIHdyYXBwZXJcbiAgICAgICAgaWYgKHBhcmVudCAmJiAocGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnd3JhcHBlcl9zdGFydCcpIHx8IHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3dyYXBwZXJfc3RvcCcpKSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGhndCA9IE51bWJlcihkaXYuY2xhc3NOYW1lLnJlcGxhY2UoL1teMC05XSovLCAnJykpO1xuXG4gICAgICAgIC8vIFJldHVybiBpZiB0aGVyZSBpcyBubyBoZWlnaHQgdmFsdWVcbiAgICAgICAgaWYgKCFoZ3QpIHJldHVybjtcblxuICAgICAgICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRpdiwgbnVsbCk7XG4gICAgICAgIGNvbnN0IHBhZGRpbmcgPSBwYXJzZUZsb2F0KHN0eWxlLnBhZGRpbmdUb3ApICsgcGFyc2VGbG9hdChzdHlsZS5wYWRkaW5nQm90dG9tKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gZGl2LmNsaWVudEhlaWdodCAtIHBhZGRpbmc7XG5cbiAgICAgICAgLy8gRG8gbm90IGFkZCB0aGUgdG9nZ2xlIGlmIHRoZSBwcmV2aWV3IGhlaWdodCBpcyBiZWxvdyB0aGUgbWF4LWhlaWdodFxuICAgICAgICBpZiAoaGVpZ2h0IDw9IGhndCkgcmV0dXJuO1xuXG4gICAgICAgIC8vIFJlc2l6ZSB0aGUgZWxlbWVudCBpZiBpdCBpcyBoaWdoZXIgdGhhbiB0aGUgbWF4aW11bSBoZWlnaHRcbiAgICAgICAgZGl2LnN0eWxlLmhlaWdodCA9IGhndCsncHgnO1xuXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24udGl0bGUgPSBDb250YW8ubGFuZy5leHBhbmQ7XG4gICAgICAgIGJ1dHRvbi5pbm5lckhUTUwgPSAnPHNwYW4+Li4uPC9zcGFuPic7XG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCd1bnNlbGVjdGFibGUnKTtcblxuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChkaXYuc3R5bGUuaGVpZ2h0ID09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5oZWlnaHQgPSBoZ3QrJ3B4JztcbiAgICAgICAgICAgICAgICBidXR0b24udGl0bGUgPSBDb250YW8ubGFuZy5leHBhbmQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnRpdGxlID0gQ29udGFvLmxhbmcuY29sbGFwc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHRvZ2dsZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdG9nZ2xlci5jbGFzc0xpc3QuYWRkKCdsaW1pdF90b2dnbGVyJyk7XG4gICAgICAgIHRvZ2dsZXIuYXBwZW5kKGJ1dHRvbik7XG5cbiAgICAgICAgZGl2LmFwcGVuZCh0b2dnbGVyKTtcbiAgICB9KTtcbn0pO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgY29uc3QgaW5pdGlhbGl6ZWRSb3dzID0gbmV3IFdlYWtNYXAoKTtcbiAgICBjb25zdCBzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQgPSBuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKTtcblxuICAgIGNvbnN0IGluaXQgPSAocm93KSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgcm93IGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGl6ZWRcbiAgICAgICAgaWYgKGluaXRpYWxpemVkUm93cy5oYXMocm93KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJvdyBoYXMgYWxsIG5lY2Vzc2FyeSBlbGVtZW50cyB0byBwcmV2ZW50IHRoZSBtdXRhdGlvbiBvYnNlcnZlclxuICAgICAgICAvLyBmcm9tIGluaXRpYWxpemluZyB0aGUgaW5jb21wbGV0ZSB3aWRnZXQuXG4gICAgICAgIGlmICghcm93LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbi5kcmFnLWhhbmRsZScpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpbml0aWFsaXplZFJvd3Muc2V0KHJvdywgdHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgdGJvZHkgPSByb3cuY2xvc2VzdCgndGJvZHknKTtcblxuICAgICAgICBjb25zdCBtYWtlU29ydGFibGUgPSAodGJvZHkpID0+IHtcbiAgICAgICAgICAgIEFycmF5LmZyb20odGJvZHkuY2hpbGRyZW4pLmZvckVhY2goKHRyLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHNlbGVjdCcpLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGVsLm5hbWUgPSBlbC5uYW1lLnJlcGxhY2UoL1xcW1swLTldK10vZywgJ1snICsgaSArICddJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVE9ETzogcmVwbGFjZSB0aGlzIHdpdGggYSB2YW5pbGxhIEpTIHNvbHV0aW9uXG4gICAgICAgICAgICBuZXcgU29ydGFibGVzKHRib2R5LCB7XG4gICAgICAgICAgICAgICAgY29uc3RyYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNixcbiAgICAgICAgICAgICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGFkZEV2ZW50c1RvID0gKHRyKSA9PiB7XG4gICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKS5mb3JFYWNoKChidCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBidC5kYXRhc2V0LmNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29weSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnRyID0gdHIuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdHMgPSB0ci5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuc2VsZWN0cyA9IG50ci5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3QnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGo9MDsgajxzZWxlY3RzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5zZWxlY3RzW2pdLnZhbHVlID0gc2VsZWN0c1tqXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudHIucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtb3JpZ2luYWwtdGl0bGVdJykuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCd0aXRsZScsIGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1vcmlnaW5hbC10aXRsZScpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXRpdGxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsaXplZFJvd3Muc2V0KG50ciwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobnRyLCB0ci5uZXh0U2libGluZyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIElEIG9mIHRoZSBzZWxlY3QgKHVzZWQgYnkgQ2hvc2VuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdCA9IG50ci5xdWVyeVNlbGVjdG9yKCdzZWxlY3QudGxfc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0LnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgZXhpc3RpbmcgQ2hvc2VuIGNvbnRhaW5lclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG50ci5xdWVyeVNlbGVjdG9yKCcuY2h6bi1jb250YWluZXInKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50c1RvKG50cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGJvZHkuY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB2YWx1ZXMgZm9yIGxhc3QgZWxlbWVudCAoIzY4OSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JykuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QudmFsdWUgPSBzZWxlY3QuY2hpbGRyZW5bMF0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VuYWJsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYnggPSBidC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNieC5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNieC5jaGVja2VkID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2J4LmNoZWNrZWQgPSAnY2hlY2tlZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0LmNsYXNzTGlzdC5jb250YWlucygnZHJhZy1oYW5kbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd1VwJyB8fCBldmVudC5rZXlDb2RlID09PSAzOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJyB8fCBldmVudC5rZXlDb2RlID09PSA0MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLm5leHRFbGVtZW50U2libGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLm5leHRFbGVtZW50U2libGluZy5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ID0gdHIucXVlcnlTZWxlY3RvcigndGQ6Zmlyc3QtY2hpbGQgc2VsZWN0Jyk7XG5cbiAgICAgICAgICAgIGlmICghc2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdHIucXVlcnlTZWxlY3RvcignYS5tb2R1bGVfbGluaycpO1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VzID0gdHIucXVlcnlTZWxlY3RvckFsbCgnaW1nLm1vZHVsZV9pbWFnZScpO1xuXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVMaW5rID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IGxpbmsuaHJlZi5yZXBsYWNlKC9pZD1bMC05XSsvLCAnaWQ9JyArIHNlbGVjdC52YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0LnZhbHVlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgICAgIGltYWdlcy5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VzLmZvckVhY2goKGltYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZUxpbmspO1xuXG4gICAgICAgICAgICAvLyBCYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIE1vb1Rvb2xzIFwiQ2hvc2VuXCIgc2NyaXB0IHRoYXQgZmlyZXMgbm9uLW5hdGl2ZSBjaGFuZ2UgZXZlbnRcbiAgICAgICAgICAgIHNlbGVjdC5hZGRFdmVudCgnY2hhbmdlJywgdXBkYXRlTGluayk7XG4gICAgICAgIH07XG5cbiAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgYWRkRXZlbnRzVG8ocm93KTtcbiAgICB9O1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRsX21vZHVsZXdpemFyZCB0cicpLmZvckVhY2goaW5pdCk7XG5cbiAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnNMaXN0KSB7XG4gICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xuICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgbXV0YXRpb24uYWRkZWROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQubWF0Y2hlcyAmJiBlbGVtZW50Lm1hdGNoZXMoJy50bF9tb2R1bGV3aXphcmQgdHIsIC50bF9tb2R1bGV3aXphcmQgdHIgKicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0KGVsZW1lbnQuY2xvc2VzdCgndHInKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSkub2JzZXJ2ZShkb2N1bWVudCwge1xuICAgICAgICBhdHRyaWJ1dGVzOiBmYWxzZSxcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgfSk7XG59KSgpO1xuIiwiLypcbi0tLVxuXG5uYW1lOiBSZXF1ZXN0LkNvbnRhb1xuXG5kZXNjcmlwdGlvbjogRXh0ZW5kcyB0aGUgTW9vVG9vbHMgUmVxdWVzdC5KU09OIGNsYXNzIHdpdGggQ29udGFvLXNwZWNpZmljIHJvdXRpbmVzLlxuXG5saWNlbnNlOiBMR1BMdjNcblxuYXV0aG9yczpcbiAtIExlbyBGZXllclxuXG5yZXF1aXJlczogW1JlcXVlc3QsIEpTT05dXG5cbnByb3ZpZGVzOiBSZXF1ZXN0LkNvbnRhb1xuXG4uLi5cbiovXG5cblJlcXVlc3QuQ29udGFvID0gbmV3IENsYXNzKFxue1xuXHRFeHRlbmRzOiBSZXF1ZXN0LkpTT04sXG5cblx0b3B0aW9uczoge1xuXHRcdGZvbGxvd1JlZGlyZWN0czogdHJ1ZSxcblx0XHR1cmw6IHdpbmRvdy5sb2NhdGlvbi5ocmVmXG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdGlmIChvcHRpb25zICYmICFvcHRpb25zLnVybCAmJiBvcHRpb25zLmZpZWxkICYmIG9wdGlvbnMuZmllbGQuZm9ybSAmJiBvcHRpb25zLmZpZWxkLmZvcm0uYWN0aW9uKSB7XG5cdFx0XHR0aGlzLm9wdGlvbnMudXJsID0gb3B0aW9ucy5maWVsZC5mb3JtLmFjdGlvbjtcblx0XHR9XG5cdFx0dGhpcy5wYXJlbnQob3B0aW9ucyk7XG5cdH0sXG5cblx0c3VjY2VzczogZnVuY3Rpb24odGV4dCkge1xuXHRcdHZhciB1cmwgPSB0aGlzLmdldEhlYWRlcignWC1BamF4LUxvY2F0aW9uJyksXG5cdFx0XHRqc29uO1xuXG5cdFx0aWYgKHVybCAmJiB0aGlzLm9wdGlvbnMuZm9sbG93UmVkaXJlY3RzKSB7XG5cdFx0XHRsb2NhdGlvbi5yZXBsYWNlKHVybCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gU3VwcG9ydCBib3RoIHBsYWluIHRleHQgYW5kIEpTT04gcmVzcG9uc2VzXG5cdFx0dHJ5IHtcblx0XHRcdGpzb24gPSB0aGlzLnJlc3BvbnNlLmpzb24gPSBKU09OLmRlY29kZSh0ZXh0LCB0aGlzLm9wdGlvbnMuc2VjdXJlKTtcblx0XHR9IGNhdGNoKGUpIHtcblx0XHRcdGpzb24gPSB7J2NvbnRlbnQnOnRleHR9O1xuXHRcdH1cblxuXHRcdC8vIEVtcHR5IHJlc3BvbnNlXG5cdFx0aWYgKGpzb24gPT09IG51bGwpIHtcblx0XHRcdGpzb24gPSB7J2NvbnRlbnQnOicnfTtcblx0XHR9IGVsc2UgaWYgKHR5cGVvZihqc29uKSAhPSAnb2JqZWN0Jykge1xuXHRcdFx0anNvbiA9IHsnY29udGVudCc6dGV4dH07XG5cdFx0fVxuXG5cdFx0Ly8gSXNvbGF0ZSBzY3JpcHRzIGFuZCBleGVjdXRlIHRoZW1cblx0XHRpZiAoanNvbi5jb250ZW50ICE9ICcnKSB7XG5cdFx0XHRqc29uLmNvbnRlbnQgPSBqc29uLmNvbnRlbnQuc3RyaXBTY3JpcHRzKGZ1bmN0aW9uKHNjcmlwdCkge1xuXHRcdFx0XHRqc29uLmphdmFzY3JpcHQgPSBzY3JpcHQucmVwbGFjZSgvPCEtLXxcXC9cXC8tLT58PCFcXFtDREFUQVxcW1xcL1xcLz58PCFdXT4vZywgJycpO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAoanNvbi5qYXZhc2NyaXB0ICYmIHRoaXMub3B0aW9ucy5ldmFsU2NyaXB0cykge1xuXHRcdFx0XHRCcm93c2VyLmV4ZWMoanNvbi5qYXZhc2NyaXB0KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLm9uU3VjY2Vzcyhqc29uLmNvbnRlbnQsIGpzb24pO1xuXHR9LFxuXG5cdGZhaWx1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB1cmwgPSB0aGlzLmdldEhlYWRlcignWC1BamF4LUxvY2F0aW9uJyk7XG5cblx0XHRpZiAodXJsICYmIDQwMSA9PT0gdGhpcy5zdGF0dXMpIHtcblx0XHRcdGxvY2F0aW9uLnJlcGxhY2UodXJsKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodXJsICYmIHRoaXMub3B0aW9ucy5mb2xsb3dSZWRpcmVjdHMgJiYgdGhpcy5zdGF0dXMgPj0gMzAwICYmIHRoaXMuc3RhdHVzIDwgNDAwKSB7XG5cdFx0XHRsb2NhdGlvbi5yZXBsYWNlKHVybCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5vbkZhaWx1cmUoKTtcblx0fVxufSk7XG5cblxuLypcbi0tLVxuXG5uYW1lOiBEcmFnXG5cbmRlc2NyaXB0aW9uOiBFeHRlbmRzIHRoZSBiYXNlIERyYWcgY2xhc3Mgd2l0aCB0b3VjaCBzdXBwb3J0LlxuXG5saWNlbnNlOiBMR1BMdjNcblxuYXV0aG9yczpcbiAtIEFuZHJlYXMgU2NoZW1wcFxuXG5yZXF1aXJlczogW0RyYWddXG5cbnByb3ZpZGVzOiBEcmFnXG5cbi4uLlxuKi9cblxuQ2xhc3MucmVmYWN0b3IoRHJhZyxcbntcblx0YXR0YWNoOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmhhbmRsZXMuYWRkRXZlbnQoJ3RvdWNoc3RhcnQnLCB0aGlzLmJvdW5kLnN0YXJ0KTtcblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdGRldGFjaDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5oYW5kbGVzLnJlbW92ZUV2ZW50KCd0b3VjaHN0YXJ0JywgdGhpcy5ib3VuZC5zdGFydCk7XG5cdFx0cmV0dXJuIHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRzKHtcblx0XHRcdHRvdWNobW92ZTogdGhpcy5ib3VuZC5jaGVjayxcblx0XHRcdHRvdWNoZW5kOiB0aGlzLmJvdW5kLmNhbmNlbFxuXHRcdH0pO1xuXHRcdHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRjaGVjazogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRpZiAodGhpcy5vcHRpb25zLnByZXZlbnREZWZhdWx0KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciBkaXN0YW5jZSA9IE1hdGgucm91bmQoTWF0aC5zcXJ0KE1hdGgucG93KGV2ZW50LnBhZ2UueCAtIHRoaXMubW91c2Uuc3RhcnQueCwgMikgKyBNYXRoLnBvdyhldmVudC5wYWdlLnkgLSB0aGlzLm1vdXNlLnN0YXJ0LnksIDIpKSk7XG5cdFx0aWYgKGRpc3RhbmNlID4gdGhpcy5vcHRpb25zLnNuYXApIHtcblx0XHRcdHRoaXMuY2FuY2VsKCk7XG5cdFx0XHR0aGlzLmRvY3VtZW50LmFkZEV2ZW50cyh7XG5cdFx0XHRcdG1vdXNlbW92ZTogdGhpcy5ib3VuZC5kcmFnLFxuXHRcdFx0XHRtb3VzZXVwOiB0aGlzLmJvdW5kLnN0b3Bcblx0XHRcdH0pO1xuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRzKHtcblx0XHRcdFx0dG91Y2htb3ZlOiB0aGlzLmJvdW5kLmRyYWcsXG5cdFx0XHRcdHRvdWNoZW5kOiB0aGlzLmJvdW5kLnN0b3Bcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy5maXJlRXZlbnQoJ3N0YXJ0JywgW3RoaXMuZWxlbWVudCwgZXZlbnRdKS5maXJlRXZlbnQoJ3NuYXAnLCB0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0fSxcblxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50cyh7XG5cdFx0XHR0b3VjaG1vdmU6IHRoaXMuYm91bmQuY2hlY2ssXG5cdFx0XHR0b3VjaGVuZDogdGhpcy5ib3VuZC5jYW5jZWxcblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdHN0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50cyh7XG5cdFx0XHR0b3VjaG1vdmU6IHRoaXMuYm91bmQuZHJhZyxcblx0XHRcdHRvdWNoZW5kOiB0aGlzLmJvdW5kLnN0b3Bcblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9XG59KTtcblxuLypcbi0tLVxuXG5uYW1lOiBTb3J0YWJsZXNcblxuZGVzY3JpcHRpb246IEV4dGVuZHMgdGhlIGJhc2UgU29ydGFibGVzIGNsYXNzIHdpdGggdG91Y2ggc3VwcG9ydC5cblxubGljZW5zZTogTEdQTHYzXG5cbmF1dGhvcnM6XG4gLSBBbmRyZWFzIFNjaGVtcHBcblxucmVxdWlyZXM6IFtTb3J0YWJsZXNdXG5cbnByb3ZpZGVzOiBTb3J0YWJsZXNcblxuLi4uXG4qL1xuXG5DbGFzcy5yZWZhY3RvcihTb3J0YWJsZXMsXG57XG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKGxpc3RzLCBvcHRpb25zKSB7XG5cdFx0b3B0aW9ucy5kcmFnT3B0aW9ucyA9IE9iamVjdC5tZXJnZShvcHRpb25zLmRyYWdPcHRpb25zIHx8IHt9LCB7IHByZXZlbnREZWZhdWx0OiAob3B0aW9ucy5kcmFnT3B0aW9ucyAmJiBvcHRpb25zLmRyYWdPcHRpb25zLnByZXZlbnREZWZhdWx0KSB8fCBCcm93c2VyLkZlYXR1cmVzLlRvdWNoIH0pO1xuXHRcdGlmIChvcHRpb25zLmRyYWdPcHRpb25zLnVuRHJhZ2dhYmxlVGFncyA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRvcHRpb25zLmRyYWdPcHRpb25zLnVuRHJhZ2dhYmxlVGFncyA9IHRoaXMub3B0aW9ucy51bkRyYWdnYWJsZVRhZ3MuZmlsdGVyKGZ1bmN0aW9uKHRhZykge1xuXHRcdFx0XHRyZXR1cm4gdGFnICE9ICdidXR0b24nO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnByZXZpb3VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0YWRkSXRlbXM6IGZ1bmN0aW9uKCkge1xuXHRcdEFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5lYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHRcdHRoaXMuZWxlbWVudHMucHVzaChlbGVtZW50KTtcblx0XHRcdHZhciBzdGFydCA9IGVsZW1lbnQucmV0cmlldmUoJ3NvcnRhYmxlczpzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdHRoaXMuc3RhcnQuY2FsbCh0aGlzLCBldmVudCwgZWxlbWVudCk7XG5cdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdFx0KHRoaXMub3B0aW9ucy5oYW5kbGUgPyBlbGVtZW50LmdldEVsZW1lbnQodGhpcy5vcHRpb25zLmhhbmRsZSkgfHwgZWxlbWVudCA6IGVsZW1lbnQpLmFkZEV2ZW50cyh7XG5cdFx0XHRcdG1vdXNlZG93bjogc3RhcnQsXG5cdFx0XHRcdHRvdWNoc3RhcnQ6IHN0YXJ0XG5cdFx0XHR9KTtcblx0XHR9LCB0aGlzKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZW1vdmVJdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICQkKEFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5tYXAoZnVuY3Rpb24oZWxlbWVudCkge1xuXHRcdFx0dGhpcy5lbGVtZW50cy5lcmFzZShlbGVtZW50KTtcblx0XHRcdHZhciBzdGFydCA9IGVsZW1lbnQucmV0cmlldmUoJ3NvcnRhYmxlczpzdGFydCcpO1xuXHRcdFx0KHRoaXMub3B0aW9ucy5oYW5kbGUgPyBlbGVtZW50LmdldEVsZW1lbnQodGhpcy5vcHRpb25zLmhhbmRsZSkgfHwgZWxlbWVudCA6IGVsZW1lbnQpLnJlbW92ZUV2ZW50cyh7XG5cdFx0XHRcdG1vdXNlZG93bjogc3RhcnQsXG5cdFx0XHRcdHRvdWNoZW5kOiBzdGFydFxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZWxlbWVudDtcblx0XHR9LCB0aGlzKSk7XG5cdH0sXG5cblx0Z2V0Q2xvbmU6IGZ1bmN0aW9uKGV2ZW50LCBlbGVtZW50KSB7XG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuY2xvbmUpIHJldHVybiBuZXcgRWxlbWVudChlbGVtZW50LnRhZ05hbWUpLmluamVjdChkb2N1bWVudC5ib2R5KTtcblx0XHRpZiAodHlwZU9mKHRoaXMub3B0aW9ucy5jbG9uZSkgPT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHRoaXMub3B0aW9ucy5jbG9uZS5jYWxsKHRoaXMsIGV2ZW50LCBlbGVtZW50LCB0aGlzLmxpc3QpO1xuXHRcdHZhciBjbG9uZSA9IHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRjbG9uZS5hZGRFdmVudCgndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRlbGVtZW50LmZpcmVFdmVudCgndG91Y2hzdGFydCcsIGV2ZW50KTtcblx0XHR9KTtcblx0XHRyZXR1cm4gY2xvbmU7XG5cdH1cbn0pO1xuXG4vKlxuLS0tXG5cbnNjcmlwdDogUmVxdWVzdC5RdWV1ZS5qc1xuXG5uYW1lOiBSZXF1ZXN0LlF1ZXVlXG5cbmRlc2NyaXB0aW9uOiBFeHRlbmRzIHRoZSBiYXNlIFJlcXVlc3QuUXVldWUgY2xhc3MgYW5kIGF0dGVtcHRzIHRvIGZpeCBzb21lIGlzc3Vlcy5cblxubGljZW5zZTogTUlULXN0eWxlIGxpY2Vuc2VcblxuYXV0aG9yczpcbiAtIExlbyBGZXllclxuXG5yZXF1aXJlczpcblx0LSBDb3JlL0VsZW1lbnRcblx0LSBDb3JlL1JlcXVlc3Rcblx0LSBDbGFzcy5CaW5kc1xuXG5wcm92aWRlczogW1JlcXVlc3QuUXVldWVdXG5cbi4uLlxuKi9cblxuQ2xhc3MucmVmYWN0b3IoUmVxdWVzdC5RdWV1ZSxcbntcblx0Ly8gRG8gbm90IGZpcmUgdGhlIFwiZW5kXCIgZXZlbnQgaGVyZVxuXHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMuZmlyZUV2ZW50KCdjb21wbGV0ZScsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0Ly8gQ2FsbCByZXN1bWUoKSBpbnN0ZWFkIG9mIHJ1bk5leHQoKVxuXHRvbkNhbmNlbDogZnVuY3Rpb24oKXtcblx0XHRpZiAodGhpcy5vcHRpb25zLmF1dG9BZHZhbmNlICYmICF0aGlzLmVycm9yKSB0aGlzLnJlc3VtZSgpO1xuXHRcdHRoaXMuZmlyZUV2ZW50KCdjYW5jZWwnLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdC8vIENhbGwgcmVzdW1lKCkgaW5zdGVhZCBvZiBydW5OZXh0KCkgYW5kIGZpcmUgdGhlIFwiZW5kXCIgZXZlbnRcblx0b25TdWNjZXNzOiBmdW5jdGlvbigpe1xuXHRcdGlmICh0aGlzLm9wdGlvbnMuYXV0b0FkdmFuY2UgJiYgIXRoaXMuZXJyb3IpIHRoaXMucmVzdW1lKCk7XG5cdFx0dGhpcy5maXJlRXZlbnQoJ3N1Y2Nlc3MnLCBhcmd1bWVudHMpO1xuXHRcdGlmICghdGhpcy5xdWV1ZS5sZW5ndGggJiYgIXRoaXMuaXNSdW5uaW5nKCkpIHRoaXMuZmlyZUV2ZW50KCdlbmQnKTtcblx0fSxcblxuXHQvLyBDYWxsIHJlc3VtZSgpIGluc3RlYWQgb2YgcnVuTmV4dCgpIGFuZCBmaXJlIHRoZSBcImVuZFwiIGV2ZW50XG5cdG9uRmFpbHVyZTogZnVuY3Rpb24oKXtcblx0XHR0aGlzLmVycm9yID0gdHJ1ZTtcblx0XHRpZiAoIXRoaXMub3B0aW9ucy5zdG9wT25GYWlsdXJlICYmIHRoaXMub3B0aW9ucy5hdXRvQWR2YW5jZSkgdGhpcy5yZXN1bWUoKTtcblx0XHR0aGlzLmZpcmVFdmVudCgnZmFpbHVyZScsIGFyZ3VtZW50cyk7XG5cdFx0aWYgKCF0aGlzLnF1ZXVlLmxlbmd0aCAmJiAhdGhpcy5pc1J1bm5pbmcoKSkgdGhpcy5maXJlRXZlbnQoJ2VuZCcpO1xuXHR9LFxuXG5cdC8vIENhbGwgcmVzdW1lKCkgaW5zdGVhZCBvZiBydW5OZXh0KClcblx0b25FeGNlcHRpb246IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5lcnJvciA9IHRydWU7XG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuc3RvcE9uRmFpbHVyZSAmJiB0aGlzLm9wdGlvbnMuYXV0b0FkdmFuY2UpIHRoaXMucmVzdW1lKCk7XG5cdFx0dGhpcy5maXJlRXZlbnQoJ2V4Y2VwdGlvbicsIGFyZ3VtZW50cyk7XG5cdH1cbn0pO1xuXG4vKlxuLS0tXG5cbm5hbWU6IENvbnRhby5TZXJwUHJldmlld1xuXG5kZXNjcmlwdGlvbjogR2VuZXJhdGVzIGEgU0VSUCBwcmV2aWV3XG5cbmxpY2Vuc2U6IExHUEx2M1xuXG5hdXRob3JzOlxuIC0gTGVvIEZleWVyXG5cbnJlcXVpcmVzOiBbUmVxdWVzdCwgSlNPTl1cblxucHJvdmlkZXM6IENvbnRhby5TZXJwUHJldmlld1xuXG4uLi5cbiovXG5cbkNvbnRhby5TZXJwUHJldmlldyA9IG5ldyBDbGFzcyhcbntcblx0b3B0aW9uczoge1xuXHRcdGlkOiAwLFxuXHRcdHRyYWlsOiBudWxsLFxuXHRcdHRpdGxlRmllbGQ6IG51bGwsXG5cdFx0dGl0bGVGYWxsYmFja0ZpZWxkOiBudWxsLFxuXHRcdGFsaWFzRmllbGQ6IG51bGwsXG5cdFx0ZGVzY3JpcHRpb25GaWVsZDogbnVsbCxcblx0XHRkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQ6IG51bGwsXG5cdFx0dGl0bGVUYWc6IG51bGxcblx0fSxcblxuXHRzaG9ydGVuOiBmdW5jdGlvbihzdHIsIG1heCkge1xuXHRcdGlmIChzdHIubGVuZ3RoIDw9IG1heCkge1xuXHRcdFx0cmV0dXJuIHN0cjtcblx0XHR9XG5cdFx0cmV0dXJuIHN0ci5zdWJzdHIoMCwgc3RyLmxhc3RJbmRleE9mKCcgJywgbWF4KSkgKyAnIOKApic7XG5cdH0sXG5cblx0aHRtbDJzdHJpbmc6IGZ1bmN0aW9uKGh0bWwpIHtcblx0XHRyZXR1cm4gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sLCAndGV4dC9odG1sJykuYm9keS50ZXh0Q29udGVudC5yZXBsYWNlKC9cXFstXS9nLCAnXFx4QUQnKS5yZXBsYWNlKC9cXFtuYnNwXS9nLCAnXFx4QTAnKTtcblx0fSxcblxuXHRnZXRUaW55bWNlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAod2luZG93LnRpbnlNQ0UgJiYgdGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCkge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy50aW55TUNFLmdldCh0aGlzLm9wdGlvbnMuZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkKTtcblx0XHR9XG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0VHVyYm8uY2FjaGUuZXhlbXB0UGFnZUZyb21DYWNoZSgpO1xuXG5cdFx0dGhpcy5vcHRpb25zID0gT2JqZWN0Lm1lcmdlLmFwcGx5KG51bGwsIFt7fSwgdGhpcy5vcHRpb25zXS5hcHBlbmQoYXJndW1lbnRzKSk7XG5cblx0XHR2YXIgc2VycFRpdGxlID0gJCgnc2VycF90aXRsZV8nICsgdGhpcy5vcHRpb25zLmlkKSxcblx0XHRcdHNlcnBVcmwgPSAkKCdzZXJwX3VybF8nICsgdGhpcy5vcHRpb25zLmlkKSxcblx0XHRcdHNlcnBEZXNjcmlwdGlvbiA9ICQoJ3NlcnBfZGVzY3JpcHRpb25fJyArIHRoaXMub3B0aW9ucy5pZCksXG5cdFx0XHR0aXRsZUZpZWxkID0gJCh0aGlzLm9wdGlvbnMudGl0bGVGaWVsZCksXG5cdFx0XHR0aXRsZUZhbGxiYWNrRmllbGQgPSAkKHRoaXMub3B0aW9ucy50aXRsZUZhbGxiYWNrRmllbGQpLFxuXHRcdFx0YWxpYXNGaWVsZCA9ICQodGhpcy5vcHRpb25zLmFsaWFzRmllbGQpLFxuXHRcdFx0ZGVzY3JpcHRpb25GaWVsZCA9ICQodGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uRmllbGQpLFxuXHRcdFx0ZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkID0gJCh0aGlzLm9wdGlvbnMuZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkKSxcblx0XHRcdGluZGV4RW1wdHkgPSB0aGlzLm9wdGlvbnMudHJhaWwuaW5kZXhPZign4oC6JykgPT09IC0xLFxuXHRcdFx0dGl0bGVUYWcgPSB0aGlzLm9wdGlvbnMudGl0bGVUYWcgfHwgJyVzJztcblxuXHRcdHRpdGxlRmllbGQgJiYgdGl0bGVGaWVsZC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aXRsZUZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBUaXRsZS5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh0aXRsZVRhZy5yZXBsYWNlKC8lcy8sIHRpdGxlRmllbGQudmFsdWUpKS5yZXBsYWNlKC8lJS9nLCAnJScpLCA2NCkpO1xuXHRcdFx0fSBlbHNlIGlmICh0aXRsZUZhbGxiYWNrRmllbGQgJiYgdGl0bGVGYWxsYmFja0ZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBUaXRsZS5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh0aXRsZVRhZy5yZXBsYWNlKC8lcy8sIHRpdGxlRmFsbGJhY2tGaWVsZC52YWx1ZSkpLnJlcGxhY2UoLyUlL2csICclJyksIDY0KSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXJwVGl0bGUuc2V0KCd0ZXh0JywgJycpO1xuXHRcdFx0fVxuXHRcdH0uYmluZCh0aGlzKSk7XG5cblx0XHR0aXRsZUZhbGxiYWNrRmllbGQgJiYgdGl0bGVGYWxsYmFja0ZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKHRpdGxlRmllbGQgJiYgdGl0bGVGaWVsZC52YWx1ZSkgcmV0dXJuO1xuXHRcdFx0c2VycFRpdGxlLnNldCgndGV4dCcsIHRoaXMuc2hvcnRlbih0aGlzLmh0bWwyc3RyaW5nKHRpdGxlVGFnLnJlcGxhY2UoLyVzLywgdGl0bGVGYWxsYmFja0ZpZWxkLnZhbHVlKSkucmVwbGFjZSgvJSUvZywgJyUnKSwgNjQpKTtcblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0YWxpYXNGaWVsZCAmJiBhbGlhc0ZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGFsaWFzRmllbGQudmFsdWUgPT0gJ2luZGV4JyAmJiBpbmRleEVtcHR5KSB7XG5cdFx0XHRcdHNlcnBVcmwuc2V0KCd0ZXh0JywgdGhpcy5vcHRpb25zLnRyYWlsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlcnBVcmwuc2V0KCd0ZXh0JywgdGhpcy5vcHRpb25zLnRyYWlsICsgJyDigLogJyArIChhbGlhc0ZpZWxkLnZhbHVlIHx8IHRoaXMub3B0aW9ucy5pZCkucmVwbGFjZSgvXFwvL2csICcg4oC6ICcpKTtcblx0XHRcdH1cblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0ZGVzY3JpcHRpb25GaWVsZCAmJiBkZXNjcmlwdGlvbkZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGRlc2NyaXB0aW9uRmllbGQudmFsdWUpIHtcblx0XHRcdFx0c2VycERlc2NyaXB0aW9uLnNldCgndGV4dCcsIHRoaXMuc2hvcnRlbihkZXNjcmlwdGlvbkZpZWxkLnZhbHVlLCAxNjApKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGVkaXRvciA9IHRoaXMuZ2V0VGlueW1jZSgpO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcoZWRpdG9yLmdldENvbnRlbnQoKSksIDE2MCkpO1xuXHRcdFx0fSBlbHNlIGlmIChkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQgJiYgZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyhkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQudmFsdWUpLCAxNjApKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCAnJyk7XG5cdFx0XHR9XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdGRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCAmJiBkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQuYWRkRXZlbnQoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoZGVzY3JpcHRpb25GaWVsZCAmJiBkZXNjcmlwdGlvbkZpZWxkLnZhbHVlKSByZXR1cm47XG5cdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcoZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkLnZhbHVlKSwgMTYwKSk7XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZWRpdG9yID0gdGhpcy5nZXRUaW55bWNlKCk7XG5cdFx0XHRlZGl0b3IgJiYgZWRpdG9yLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoZGVzY3JpcHRpb25GaWVsZCAmJiBkZXNjcmlwdGlvbkZpZWxkLnZhbHVlKSByZXR1cm47XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh3aW5kb3cudGlueU1DRS5hY3RpdmVFZGl0b3IuZ2V0Q29udGVudCgpKSwgMTYwKSk7XG5cdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdH0uYmluZCh0aGlzKSwgNCk7XG5cdH1cbn0pO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgY29uc3QgaW5pdGlhbGl6ZWRSb3dzID0gbmV3IFdlYWtNYXAoKTtcbiAgICBjb25zdCBzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQgPSBuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKTtcblxuICAgIGNvbnN0IGluaXQgPSAocm93KSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgcm93IGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGl6ZWRcbiAgICAgICAgaWYgKGluaXRpYWxpemVkUm93cy5oYXMocm93KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJvdyBoYXMgYWxsIG5lY2Vzc2FyeSBlbGVtZW50cyB0byBwcmV2ZW50IHRoZSBtdXRhdGlvbiBvYnNlcnZlclxuICAgICAgICAvLyBmcm9tIGluaXRpYWxpemluZyB0aGUgaW5jb21wbGV0ZSB3aWRnZXQuXG4gICAgICAgIGlmICghcm93LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbi5kcmFnLWhhbmRsZScpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpbml0aWFsaXplZFJvd3Muc2V0KHJvdywgdHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgdGJvZHkgPSByb3cuY2xvc2VzdCgndGJvZHknKTtcblxuICAgICAgICBjb25zdCBtYWtlU29ydGFibGUgPSAodGJvZHkpID0+IHtcbiAgICAgICAgICAgIEFycmF5LmZyb20odGJvZHkuY2hpbGRyZW4pLmZvckVhY2goKHRyLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHNlbGVjdCcpLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGVsLm5hbWUgPSBlbC5uYW1lLnJlcGxhY2UoL1xcW1swLTldK10vZywgJ1snICsgaSArICddJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVE9ETzogcmVwbGFjZSB0aGlzIHdpdGggYSB2YW5pbGxhIEpTIHNvbHV0aW9uXG4gICAgICAgICAgICBuZXcgU29ydGFibGVzKHRib2R5LCB7XG4gICAgICAgICAgICAgICAgY29uc3RyYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNixcbiAgICAgICAgICAgICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGFkZEV2ZW50c1RvID0gKHRyKSA9PiB7XG4gICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKS5mb3JFYWNoKChidCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBidC5kYXRhc2V0LmNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29weSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG50ciA9IHRyLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RzID0gdHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnNlbGVjdHMgPSBudHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaj0wOyBqPHNlbGVjdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnNlbGVjdHNbal0udmFsdWUgPSBzZWxlY3RzW2pdLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShudHIsIHRyLm5leHRTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudHNUbyhudHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0Ym9keS5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHZhbHVlcyBmb3IgbGFzdCBlbGVtZW50ICgjNjg5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3QnKS5mb3JFYWNoKChzZWxlY3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdC52YWx1ZSA9IHNlbGVjdC5jaGlsZHJlblswXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkcmFnLWhhbmRsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93VXAnIHx8IGV2ZW50LmtleUNvZGUgPT09IDM4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93RG93bicgfHwgZXZlbnQua2V5Q29kZSA9PT0gNDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHIubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIubmV4dEVsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIHRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICBhZGRFdmVudHNUbyhyb3cpO1xuICAgIH07XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGxfc2VjdGlvbndpemFyZCB0cicpLmZvckVhY2goaW5pdCk7XG5cbiAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnNMaXN0KSB7XG4gICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xuICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgbXV0YXRpb24uYWRkZWROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQubWF0Y2hlcyAmJiBlbGVtZW50Lm1hdGNoZXMoJy50bF9zZWN0aW9ud2l6YXJkIHRyLCAudGxfc2VjdGlvbndpemFyZCB0ciAqJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQoZWxlbWVudC5jbG9zZXN0KCd0cicpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KS5vYnNlcnZlKGRvY3VtZW50LCB7XG4gICAgICAgIGF0dHJpYnV0ZXM6IGZhbHNlLFxuICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgaW5pdGlhbGl6ZWQgPSBbXTtcblxuICAgIGNvbnN0IHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRpcC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAndG9vbHRpcCcpO1xuICAgIHRpcC5jbGFzc0xpc3QuYWRkKCd0aXAnKVxuICAgIHRpcC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICBjb25zdCBpbml0ID0gZnVuY3Rpb24oZWwsIHgsIHksIHVzZUNvbnRlbnQpIHtcbiAgICAgICAgaWYgKGluaXRpYWxpemVkLmluY2x1ZGVzKGVsKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5pdGlhbGl6ZWQucHVzaChlbCk7XG5cbiAgICAgICAgbGV0IHRleHQsIHRpbWVyO1xuXG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh1c2VDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdGV4dCA9IGVsLmlubmVySFRNTDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGV4dCA9IGVsLmdldEF0dHJpYnV0ZSgndGl0bGUnKTtcbiAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLCB0ZXh0KTtcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgICAgdGV4dCA9IHRleHQ/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgICAgICAgdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnZGlzcGxheSxjb250ZW50cyc7XG5cbiAgICAgICAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJ0bCA9IGdldENvbXB1dGVkU3R5bGUoZWwpLmRpcmVjdGlvbiA9PT0gJ3J0bCc7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xpZW50V2lkdGggPSBkb2N1bWVudC5odG1sLmNsaWVudFdpZHRoO1xuXG4gICAgICAgICAgICAgICAgaWYgKChydGwgJiYgcG9zaXRpb24ueCA8IDIwMCkgfHwgKCFydGwgJiYgcG9zaXRpb24ueCA8IChjbGllbnRXaWR0aCAtIDIwMCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpcC5zdHlsZS5sZWZ0ID0gYCR7KHdpbmRvdy5zY3JvbGxYICsgcG9zaXRpb24ubGVmdCArIHgpfXB4YDtcbiAgICAgICAgICAgICAgICAgICAgdGlwLnN0eWxlLnJpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgICAgICB0aXAuY2xhc3NMaXN0LnJlbW92ZSgndGlwLS1ydGwnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aXAuc3R5bGUubGVmdCA9ICdhdXRvJztcbiAgICAgICAgICAgICAgICAgICAgdGlwLnN0eWxlLnJpZ2h0ID0gYCR7KGNsaWVudFdpZHRoIC0gd2luZG93LnNjcm9sbFggLSBwb3NpdGlvbi5yaWdodCArIHgpfXB4YDtcbiAgICAgICAgICAgICAgICAgICAgdGlwLmNsYXNzTGlzdC5hZGQoJ3RpcC0tcnRsJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGlwLmlubmVySFRNTCA9IGA8ZGl2PiR7dGV4dH08L2Rpdj5gO1xuICAgICAgICAgICAgICAgIHRpcC5zdHlsZS50b3AgPSBgJHsod2luZG93LnNjcm9sbFkgKyBwb3NpdGlvbi50b3AgKyB5KX1weGA7XG4gICAgICAgICAgICAgICAgdGlwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgICAgIHRpcC5zdHlsZS53aWxsQ2hhbmdlID0gJ2F1dG8nO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0aXAucGFyZW50Tm9kZSAmJiBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kKHRpcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwMClcbiAgICAgICAgfSlcblxuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVsLmhhc0F0dHJpYnV0ZSgndGl0bGUnKSkge1xuICAgICAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1vcmlnaW5hbC10aXRsZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpXG4gICAgICAgICAgICB0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdhdXRvJztcblxuICAgICAgICAgICAgaWYgKHRpcC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7XG4gICAgICAgICAgICAgICAgdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnZGlzcGxheSc7XG4gICAgICAgICAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgfSwgMTAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IGVsLmNsb3Nlc3QoJ2J1dHRvbiwgYScpO1xuXG4gICAgICAgIC8vIEhpZGUgdG9vbHRpcCB3aGVuIGNsaWNraW5nIGEgYnV0dG9uICh1c3VhbGx5IGFuIG9wZXJhdGlvbiBpY29uIGluIGEgd2l6YXJkIHdpZGdldClcbiAgICAgICAgaWYgKGFjdGlvbikge1xuICAgICAgICAgICAgYWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgICAgICAgICB0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdhdXRvJztcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWxlY3Qobm9kZSwgc2VsZWN0b3IpIHtcbiAgICAgICAgaWYgKG5vZGUubWF0Y2hlcyhzZWxlY3RvcikpIHtcbiAgICAgICAgICAgIHJldHVybiBbbm9kZSwgLi4ubm9kZS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbm9kZS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXR1cChub2RlKSB7XG4gICAgICAgIHNlbGVjdChub2RlLCAncC50bF90aXAnKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICBpbml0KGVsLCAwLCAyMywgdHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlbGVjdChub2RlLCAnI2hvbWUnKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICBpbml0KGVsLCA2LCA0Mik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlbGVjdChub2RlLCAnI3RtZW51IGFbdGl0bGVdJykuZm9yRWFjaChmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgaW5pdChlbCwgMCwgNDIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZWxlY3Qobm9kZSwgJ2FbdGl0bGVdW2NsYXNzXj1cImdyb3VwLVwiXScpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgIGluaXQoZWwsIC02LCAyNyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlbGVjdChub2RlLCAnYVt0aXRsZV0ubmF2aWdhdGlvbicpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgIGluaXQoZWwsIDI1LCAzMik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlbGVjdChub2RlLCAnaW1nW3RpdGxlXScpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgIGluaXQoZWwsIC05LCBlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2dpbWFnZScpID8gNjAgOiAzMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNlbGVjdChub2RlLCAnYVt0aXRsZV0nKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdwaWNrZXItd2l6YXJkJykpIHtcbiAgICAgICAgICAgICAgICBpbml0KGVsLCAtNCwgMzApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbml0KGVsLCAtOSwgMzApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzZWxlY3Qobm9kZSwgJ2J1dHRvblt0aXRsZV0nKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd1bnNlbGVjdGFibGUnKSkge1xuICAgICAgICAgICAgICAgIGluaXQoZWwsIC00LCAyMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGluaXQoZWwsIC05LCAzMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIFsnaW5wdXRbdGl0bGVdJywgJ3RpbWVbdGl0bGVdJywgJ3NwYW5bdGl0bGVdJ10uZm9yRWFjaChmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgICAgICAgICAgc2VsZWN0KG5vZGUsIHNlbGVjdG9yKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICAgICAgaW5pdChlbCwgLTksICgoc2VsZWN0b3IgPT09ICd0aW1lW3RpdGxlXScgfHwgc2VsZWN0b3IgPT09ICdzcGFuW3RpdGxlXScpID8gMjYgOiAzMCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldHVwKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7XG5cbiAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnNMaXN0KSB7XG4gICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xuICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgbXV0YXRpb24uYWRkZWROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQubWF0Y2hlcyAmJiBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHVwKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgICAgYXR0cmlidXRlczogZmFsc2UsXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgIH0pO1xufSkoKTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJpbXBvcnQgeyBBcHBsaWNhdGlvbiB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5pbXBvcnQgeyBkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllciwgaWRlbnRpZmllckZvckNvbnRleHRLZXkgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzJztcbmltcG9ydCAqIGFzIFR1cmJvIGZyb20gXCJAaG90d2lyZWQvdHVyYm9cIlxuXG5pbXBvcnQgJy4vc2NyaXB0cy9tb290YW8uanMnO1xuaW1wb3J0ICcuL3NjcmlwdHMvY29yZS5qcyc7XG5pbXBvcnQgJy4vc2NyaXB0cy9saW1pdC1oZWlnaHQuanMnO1xuaW1wb3J0ICcuL3NjcmlwdHMvbW9kdWxld2l6YXJkLmpzJztcbmltcG9ydCAnLi9zY3JpcHRzL3NlY3Rpb253aXphcmQuanMnO1xuaW1wb3J0ICcuL3NjcmlwdHMvdGlwcy5qcyc7XG5cbi8vIFN0YXJ0IHRoZSBTdGltdWx1cyBhcHBsaWNhdGlvblxuY29uc3QgYXBwbGljYXRpb24gPSBBcHBsaWNhdGlvbi5zdGFydCgpO1xuYXBwbGljYXRpb24uZGVidWcgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcblxuLy8gUmVnaXN0ZXIgYWxsIGNvbnRyb2xsZXJzIHdpdGggYGNvbnRhby0tYCBwcmVmaXhcbmNvbnN0IGNvbnRleHQgPSByZXF1aXJlLmNvbnRleHQoJy4vY29udHJvbGxlcnMnLCB0cnVlLCAvXFwuanMkLyk7XG5hcHBsaWNhdGlvbi5sb2FkKGNvbnRleHQua2V5cygpXG4gICAgLm1hcCgoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IGlkZW50aWZpZXIgPSBpZGVudGlmaWVyRm9yQ29udGV4dEtleShrZXkpO1xuICAgICAgICBpZiAoaWRlbnRpZmllcikge1xuICAgICAgICAgICAgcmV0dXJuIGRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyKGNvbnRleHQoa2V5KSwgYGNvbnRhby0tJHsgaWRlbnRpZmllciB9YCk7XG4gICAgICAgIH1cbiAgICB9KS5maWx0ZXIoKHZhbHVlKSA9PiB2YWx1ZSlcbik7XG5cbi8vIENhbmNlbCBhbGwgcHJlZmV0Y2ggcmVxdWVzdHMgdGhhdCBjb250YWluIGEgcmVxdWVzdCB0b2tlblxuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOmJlZm9yZS1wcmVmZXRjaCcsIGUgPT4ge1xuICAgIGlmICgobmV3IFVSTFNlYXJjaFBhcmFtcyhlLnRhcmdldC5ocmVmKSkuaGFzKCdydCcpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy5zZi10b29sYmFyJykgIT09IG51bGwpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbn0pO1xuXG4vLyBNYWtlIHRoZSBNb29Ub29scyBzY3JpcHRzIHJlaW5pdGlhbGl6ZSB0aGVtc2VsdmVzXG5jb25zdCBtb29Eb21yZWFkeSA9ICgpID0+IHtcbiAgICBpZiAoIWRvY3VtZW50LmJvZHkubW9vRG9tcmVhZHlGaXJlZCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5Lm1vb0RvbXJlYWR5RmlyZWQgPSB0cnVlO1xuICAgICAgICB3aW5kb3cuZmlyZUV2ZW50KCdkb21yZWFkeScpO1xuICAgIH1cbn1cblxuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOnJlbmRlcicsIG1vb0RvbXJlYWR5KTtcbmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0dXJibzpmcmFtZS1yZW5kZXInLCBtb29Eb21yZWFkeSk7XG4iXSwibmFtZXMiOlsiQ29udHJvbGxlciIsIl9kZWZhdWx0IiwiX0NvbnRyb2xsZXIiLCJfY2xhc3NDYWxsQ2hlY2siLCJfY2FsbFN1cGVyIiwiYXJndW1lbnRzIiwiX2luaGVyaXRzIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidmFsdWUiLCJjb25uZWN0IiwiX3RoaXMiLCJfdGhpcyRlbGVtZW50IiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJlbGVtZW50IiwiY2xhc3NOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsIm5leHRTaWJsaW5nIiwic3R5bGUiLCJlZGl0b3IiLCJhY2UiLCJlZGl0IiwibWF4TGluZXMiLCJJbmZpbml0eSIsImdldFNlc3Npb24iLCJzZXRWYWx1ZSIsIm9uIiwid2luZG93IiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwiZ2V0VmFsdWUiLCJjb21tYW5kcyIsImJpbmRLZXkiLCJjb25maWdDYWxsYmFjayIsImRpc2Nvbm5lY3QiLCJkZXN0cm95IiwicmVtb3ZlIiwiX2RlZmluZVByb3BlcnR5IiwidHlwZSIsIlN0cmluZyIsInJlYWRPbmx5IiwiQm9vbGVhbiIsImRlZmF1bHQiLCJjaG9zZW4iLCJDaG9zZW4iLCJ3cml0ZSIsIm5hdmlnYXRvciIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsImNvbnRlbnRWYWx1ZSIsImNsaXBib2FyZEZhbGxiYWNrIiwiYmluZCIsImlucHV0IiwiYm9keSIsImFwcGVuZENoaWxkIiwic2VsZWN0Iiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJleGVjQ29tbWFuZCIsInJlbW92ZUNoaWxkIiwiY29udGVudCIsInByZWZlcnNEYXJrIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwic2V0Q29sb3JTY2hlbWUiLCJkb2N1bWVudEVsZW1lbnQiLCJkYXRhc2V0IiwiY29sb3JTY2hlbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5pdGlhbGl6ZSIsInRvZ2dsZSIsInNldExhYmVsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImlzRGFyayIsInJlbW92ZUl0ZW0iLCJzZXRJdGVtIiwic2V0VGltZW91dCIsImhhc0xhYmVsVGFyZ2V0IiwibGFiZWwiLCJpMThuVmFsdWUiLCJsYWJlbFRhcmdldCIsInRpdGxlIiwiaW5uZXJUZXh0IiwiaTE4biIsIk9iamVjdCIsImxpZ2h0IiwiZGFyayIsInVwZGF0ZVdpemFyZCIsIm9wZW5Nb2RhbCIsInF1ZXJ5U2VsZWN0b3IiLCJidXR0b24iLCJidXR0b25JbWFnZSIsImFwcGVuZCIsImNsYXNzTGlzdCIsImFkZCIsImFmdGVyIiwiY2FuRWRpdCIsImNvbmZpZ1ZhbHVlIiwiZGlzYWJsZWQiLCJzcmMiLCJpY29uIiwiaWNvbkRpc2FibGVkIiwiQmFja2VuZCIsIm9wZW5Nb2RhbElmcmFtZSIsInVybCIsImNvbmNhdCIsImhyZWYiLCJpZHMiLCJpbmNsdWRlcyIsIk51bWJlciIsImNvbmZpZyIsInJlYnVpbGROYXZpZ2F0aW9uIiwiY29ubmVjdGVkIiwic2VjdGlvblRhcmdldENvbm5lY3RlZCIsImhhc05hdmlnYXRpb25UYXJnZXQiLCJsaW5rcyIsInNlY3Rpb25UYXJnZXRzIiwiZm9yRWFjaCIsImVsIiwiYWN0aW9uIiwiZ2V0QXR0cmlidXRlIiwiaWRlbnRpZmllciIsImV2ZW50IiwiZGlzcGF0Y2giLCJ0YXJnZXQiLCJzY3JvbGxJbnRvVmlldyIsImxpIiwibmF2aWdhdGlvblRhcmdldCIsInJlcGxhY2VDaGlsZHJlbiIsIl9zdXBlclByb3BHZXQiLCJ0b2dnbGVyTWFwIiwiV2Vha01hcCIsIm5leHRJZCIsIm9wZXJhdGlvblRhcmdldENvbm5lY3RlZCIsInVwZGF0ZU9wZXJhdGlvbiIsIm5vZGVUYXJnZXRDb25uZWN0ZWQiLCJub2RlIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInBhZGRpbmciLCJwYXJzZUZsb2F0IiwicGFkZGluZ1RvcCIsInBhZGRpbmdCb3R0b20iLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJtYXhWYWx1ZSIsIm92ZXJmbG93IiwibWF4SGVpZ2h0Iiwic2V0QXR0cmlidXRlIiwiZXhwYW5kVmFsdWUiLCJpbm5lckhUTUwiLCJ0b2dnbGVyIiwic2V0Iiwibm9kZVRhcmdldERpc2Nvbm5lY3RlZCIsImhhcyIsImdldCIsImNvbGxhcHNlIiwiZXhwYW5kIiwiY29sbGFwc2VWYWx1ZSIsInRvZ2dsZUFsbCIsIl90aGlzMiIsImlzRXhwYW5kZWQiLCJoYXNFeHBhbmRlZCIsImFsdEtleSIsIm5vZGVUYXJnZXRzIiwia2V5cHJlc3MiLCJfdGhpczMiLCJoYXNPcGVyYXRpb25UYXJnZXQiLCJoYXNUb2dnbGVycyIsImZpbmQiLCJleHBhbmRlZCIsIm9wZXJhdGlvblRhcmdldCIsImRpc3BsYXkiLCJtYXAiLCJqb2luIiwiY29sbGFwc2VBbGxWYWx1ZSIsImNvbGxhcHNlQWxsVGl0bGVWYWx1ZSIsImV4cGFuZEFsbFZhbHVlIiwiZXhwYW5kQWxsVGl0bGVWYWx1ZSIsIl90aGlzNCIsIm1heCIsImV4cGFuZEFsbCIsImV4cGFuZEFsbFRpdGxlIiwiY29sbGFwc2VBbGwiLCJjb2xsYXBzZUFsbFRpdGxlIiwiZGVsZXRlIiwiaW5wdXRUYXJnZXRzIiwic3RvcmUiLCJvZmZzZXQiLCJzY3JvbGxUbyIsInRvcCIsImJlaGF2aW9yIiwiYmVoYXZpb3JWYWx1ZSIsImJsb2NrIiwiYmxvY2tWYWx1ZSIsInNjcm9sbFRvVGFyZ2V0Q29ubmVjdGVkIiwic2Nyb2xsVG9UYXJnZXQiLCJhdXRvRm9jdXNUYXJnZXRDb25uZWN0ZWQiLCJhdXRvRm9jdXMiLCJhdXRvRm9jdXNUYXJnZXQiLCJyZWFkb25seSIsIm9mZnNldFdpZHRoIiwib2Zmc2V0SGVpZ2h0IiwiY2xvc2VzdCIsImF1dG9jb21wbGV0ZSIsImZvY3VzIiwid2lkZ2V0RXJyb3JUYXJnZXRDb25uZWN0ZWQiLCJ3aWRnZXRFcnJvclRhcmdldCIsInNjcm9sbFRvcCIsImRpc2NhcmQiLCJzY3JvbGxUb1dpZGdldEVycm9yIiwiaGFzV2lkZ2V0RXJyb3JUYXJnZXQiLCJzZXNzaW9uU3RvcmFnZSIsInNlc3Npb25LZXlWYWx1ZSIsInBhcnNlSW50IiwidW5kZWZpbmVkIiwiYWZ0ZXJMb2FkIiwiYXBwbGljYXRpb24iLCJsb2FkRmFsbGJhY2siLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImNvbnRyb2xsZXIiLCJnZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIiLCJjb250cm9sbGVyQXR0cmlidXRlIiwic2NoZW1hIiwiaW5pdFNjcm9sbE9mZnNldCIsImNvbnNvbGUiLCJ3YXJuIiwiZ2V0U2Nyb2xsT2Zmc2V0IiwidGhlbiIsInNlc3Npb25LZXkiLCJUdXJibyIsImNhY2hlIiwiZXhlbXB0UGFnZUZyb21DYWNoZSIsIl90aW55bWNlIiwidGlueW1jZUNvbmZpZyIsImVycm9yIiwiZWxlbWVudElkIiwicmVtb3ZlQXR0cmlidXRlIiwidGlueW1jZSIsImluaXQiLCJlZGl0b3JzIiwiX2VkaXRvcnMkIiwiX2VkaXRvcnMkMiIsImVkaXRvcklkIiwiZGV0YWlsIiwiX3RpbnltY2UyIiwibGVhdmUiLCJfdGlueW1jZTMiLCJwbHVnaW5zIiwiaGFzT3duUHJvcGVydHkiLCJpc05vdERpcnR5IiwiZGVsZWdhdGUiLCJjcmVhdGVFdmVudCIsImluaXRFdmVudCIsImNvbmZpcm0iLCJyZXR1cm5WYWx1ZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJjb2xsYXBzZWRDbGFzcyIsImNvbnRhaW5zIiwib3BlbiIsImNsb3NlIiwic3RvcmVTdGF0ZSIsImZvcm0iLCJpIiwiY2hlY2tWYWxpZGl0eSIsImNsaWNrIiwic3RhdGUiLCJoYXNJZFZhbHVlIiwiaGFzVGFibGVWYWx1ZSIsImZldGNoIiwibG9jYXRpb24iLCJtZXRob2QiLCJoZWFkZXJzIiwiVVJMU2VhcmNoUGFyYW1zIiwiaWRWYWx1ZSIsInRhYmxlIiwidGFibGVWYWx1ZSIsImFkZENvbnRyb2xsZXIiLCJmcyIsIm1pZ3JhdGVMZWdhY3kiLCJfSlNPTiRwYXJzZSIsIkpTT04iLCJwYXJzZSIsIkFqYXhSZXF1ZXN0IiwidG9nZ2xlRmllbGRzZXQiLCJyZWFkeVN0YXRlIiwiX3JlZiIsImN1cnJlbnRUYXJnZXQiLCJjYXRlZ29yeSIsInBhcmFtcyIsImNvbGxhcHNlZCIsImV4cGFuZFRpdGxlVmFsdWUiLCJjb2xsYXBzZVRpdGxlVmFsdWUiLCJzZW5kUmVxdWVzdCIsInVybFZhbHVlIiwiUkVRVUVTVF9UT0tFTiIsInJlcXVlc3RUb2tlblZhbHVlIiwicmVxdWVzdFRva2VuIiwiZXhwYW5kVGl0bGUiLCJjb2xsYXBzZVRpdGxlIiwiX3JlZ2VuZXJhdG9yUnVudGltZSIsInQiLCJyIiwicHJvdG90eXBlIiwibiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsIlN5bWJvbCIsImEiLCJpdGVyYXRvciIsImMiLCJhc3luY0l0ZXJhdG9yIiwidSIsInRvU3RyaW5nVGFnIiwiZGVmaW5lIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwid3JhcCIsIkdlbmVyYXRvciIsImNyZWF0ZSIsIkNvbnRleHQiLCJtYWtlSW52b2tlTWV0aG9kIiwidHJ5Q2F0Y2giLCJhcmciLCJjYWxsIiwiaCIsImwiLCJmIiwicyIsInkiLCJHZW5lcmF0b3JGdW5jdGlvbiIsIkdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlIiwicCIsImQiLCJnZXRQcm90b3R5cGVPZiIsInYiLCJ2YWx1ZXMiLCJnIiwiZGVmaW5lSXRlcmF0b3JNZXRob2RzIiwiX2ludm9rZSIsIkFzeW5jSXRlcmF0b3IiLCJpbnZva2UiLCJfdHlwZW9mIiwiX19hd2FpdCIsImNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnIiwiRXJyb3IiLCJkb25lIiwibWF5YmVJbnZva2VEZWxlZ2F0ZSIsInNlbnQiLCJfc2VudCIsImRpc3BhdGNoRXhjZXB0aW9uIiwiYWJydXB0IiwiVHlwZUVycm9yIiwicmVzdWx0TmFtZSIsIm5leHQiLCJuZXh0TG9jIiwicHVzaFRyeUVudHJ5IiwidHJ5TG9jIiwiY2F0Y2hMb2MiLCJmaW5hbGx5TG9jIiwiYWZ0ZXJMb2MiLCJ0cnlFbnRyaWVzIiwicHVzaCIsInJlc2V0VHJ5RW50cnkiLCJjb21wbGV0aW9uIiwicmVzZXQiLCJpc05hTiIsImRpc3BsYXlOYW1lIiwiaXNHZW5lcmF0b3JGdW5jdGlvbiIsImNvbnN0cnVjdG9yIiwibmFtZSIsIm1hcmsiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsImF3cmFwIiwiYXN5bmMiLCJrZXlzIiwicmV2ZXJzZSIsInBvcCIsInByZXYiLCJjaGFyQXQiLCJzbGljZSIsInN0b3AiLCJydmFsIiwiaGFuZGxlIiwiY29tcGxldGUiLCJmaW5pc2giLCJfY2F0Y2giLCJkZWxlZ2F0ZVlpZWxkIiwiYXN5bmNHZW5lcmF0b3JTdGVwIiwiX2FzeW5jVG9HZW5lcmF0b3IiLCJhcHBseSIsIl9uZXh0IiwiX3Rocm93IiwiX2RlZmluZVByb3BlcnRpZXMiLCJfdG9Qcm9wZXJ0eUtleSIsIl9nZXRQcm90b3R5cGVPZiIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIlJlZmxlY3QiLCJjb25zdHJ1Y3QiLCJfYXNzZXJ0VGhpc0luaXRpYWxpemVkIiwiUmVmZXJlbmNlRXJyb3IiLCJ2YWx1ZU9mIiwiX3NldFByb3RvdHlwZU9mIiwiX3RvUHJpbWl0aXZlIiwidG9QcmltaXRpdmUiLCJjaGlsZFRhcmdldENvbm5lY3RlZCIsImJsdXIiLCJ0b2dnbGVUb2dnbGVyIiwibGV2ZWwiLCJmb2xkZXIiLCJpdGVtIiwic2hvd0NoaWxkIiwiZXhwYW5kVG9nZ2xlciIsInVwZGF0ZVN0YXRlIiwiaGlkZUNoaWxkIiwiY29sbGFwc2VUb2dnbGVyIiwiZmV0Y2hDaGlsZCIsImxvYWRUb2dnbGVyIiwiZW5hYmxlZCIsIl9mZXRjaENoaWxkIiwiX2NhbGxlZSIsInNlYXJjaCIsInJlc3BvbnNlIiwidHh0IiwidWwiLCJpc0ZvbGRlciIsInBhcmVudCIsIl9jYWxsZWUkIiwiX2NvbnRleHQiLCJVUkwiLCJzZWFyY2hQYXJhbXMiLCJyZWZlcmVySWRWYWx1ZSIsInRvU3RyaW5nIiwibG9hZEFjdGlvblZhbHVlIiwib2siLCJ0ZXh0IiwibW9kZVZhbHVlIiwidHlwZU9mIiwidGFnTmFtZSIsIm5leHRFbGVtZW50U2libGluZyIsImJlZm9yZSIsIkN1c3RvbUV2ZW50IiwiZmlyZUV2ZW50IiwiX3giLCJfeDIiLCJfeDMiLCJfeDQiLCJfdG9nZ2xlQWxsIiwiX2NhbGxlZTIiLCJwcm9taXNlcyIsIl9jYWxsZWUyJCIsIl9jb250ZXh0MiIsImhhc0V4cGFuZGVkUm9vdCIsInVwZGF0ZUFsbFN0YXRlIiwidG9nZ2xlVGFyZ2V0cyIsImNoaWxkVGFyZ2V0cyIsImFsbCIsIl94NSIsIl91cGRhdGVTdGF0ZSIsIl9jYWxsZWUzIiwiX2NhbGxlZTMkIiwiX2NvbnRleHQzIiwidG9nZ2xlQWN0aW9uVmFsdWUiLCJfeDYiLCJfeDciLCJfeDgiLCJfdXBkYXRlQWxsU3RhdGUiLCJfY2FsbGVlNCIsIl9jYWxsZWU0JCIsIl9jb250ZXh0NCIsIl94OSIsIl94MTAiLCJyb290Q2hpbGRUYXJnZXRzIiwibW9kZSIsInRvZ2dsZUFjdGlvbiIsImxvYWRBY3Rpb24iLCJyZWZlcmVySWQiLCJ0b2dnbGVOYXZpZ2F0aW9uIiwiJCIsImdldFBhcmVudCIsImhhc0NsYXNzIiwicmVtb3ZlQ2xhc3MiLCJDb250YW8iLCJsYW5nIiwiUmVxdWVzdCIsInBvc3QiLCJyZXF1ZXN0X3Rva2VuIiwiYWRkQ2xhc3MiLCJ0b2dnbGVTdHJ1Y3R1cmUiLCJnZXRTdHlsZSIsInNldFN0eWxlIiwiZmllbGQiLCJldmFsU2NyaXB0cyIsIm9uUmVxdWVzdCIsImRpc3BsYXlCb3giLCJsb2FkaW5nIiwib25TdWNjZXNzIiwiRWxlbWVudCIsImluamVjdCIsImdldE5leHQiLCJnZXRFbGVtZW50cyIsImVhY2giLCJyZXBsYWNlIiwicmVmZXJlcl9pZCIsImhpZGVCb3giLCJ0b2dnbGVGaWxlTWFuYWdlciIsInRvZ2dsZVN1YnBhbGV0dGUiLCJjaGVja2VkIiwidXBkYXRlVmVyc2lvbk51bWJlciIsImpzb24iLCJkaXYiLCJqYXZhc2NyaXB0Iiwic3RyIiwibWF0Y2giLCJBc3NldCIsIm9uTG9hZCIsIkJyb3dzZXIiLCJleGVjIiwiaHRtbCIsImZpZWxkcyIsImVsZW1lbnRzIiwiVkVSU0lPTl9OVU1CRVIiLCJ0b2dnbGVGaWVsZCIsInJvd0ljb24iLCJpbWciLCJpbWFnZXMiLCJwdWJsaXNoZWQiLCJwYSIsImdldFByZXZpb3VzIiwiZ2V0Rmlyc3QiLCJnZXRFbGVtZW50IiwiSFRNTEVsZW1lbnQiLCJub2RlTmFtZSIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsIm5ld1NyYyIsImxhc3RJbmRleE9mIiwiaW1hZ2UiLCJ0b2dnbGVDaGVja2JveEdyb3VwIiwibWVzc2FnZSIsImJveCIsIm92ZXJsYXkiLCJzY3JvbGwiLCJnZXRTY3JvbGwiLCJjdXJyZW50SWQiLCJwb3B1cFdpbmRvdyIsInRoZW1lUGF0aCIsInNjcmlwdF91cmwiLCJ0aGVtZSIsIm9wZW5Nb2RhbFdpbmRvdyIsIndpZHRoIiwiU2ltcGxlTW9kYWwiLCJvblNob3ciLCJvbkhpZGUiLCJzaG93Iiwib3Blbk1vZGFsSW1hZ2UiLCJvcHRpb25zIiwiX29wdCR0aXRsZSIsIm9wdCIsIm1heFdpZHRoIiwiZ2V0U2l6ZSIsIngiLCJ0b0ludCIsIk1hdGgiLCJtaW4iLCJNIiwiX29wdCR0aXRsZTIiLCJvcGVuTW9kYWxTZWxlY3RvciIsIl9vcHQkdGl0bGUzIiwiYWRkQnV0dG9uIiwiY2FuY2VsIiwiYnV0dG9ucyIsImhpZGUiLCJmcm0iLCJmcmFtZXMiLCJ2YWwiLCJpbnAiLCJwaWNrZXJWYWx1ZSIsInNJbmRleCIsImFsZXJ0IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInNwbGljZSIsImNhbGxiYWNrIiwib3Blbk1vZGFsQnJvd3NlciIsImZpZWxkX25hbWUiLCJ3aW4iLCJzb3VyY2UiLCJyb3V0ZXMiLCJiYWNrZW5kX3BpY2tlciIsImF1dG9TdWJtaXQiLCJoaWRkZW4iLCJzdWJtaXQiLCJ2U2Nyb2xsVG8iLCJhZGRFdmVudCIsInRvZ2dsZUNoZWNrYm94ZXMiLCJpdGVtcyIsIiQkIiwic3RhdHVzIiwic3Vic3RyIiwiY2xzIiwiY2J4IiwiY2hlY2tib3giLCJ0b2dnbGVDaGVja2JveEVsZW1lbnRzIiwibWFrZVBhcmVudFZpZXdTb3J0YWJsZSIsImRzIiwiU2Nyb2xsZXIiLCJvbkNoYW5nZSIsImxpc3QiLCJTb3J0YWJsZXMiLCJjb25zdHJhaW4iLCJvcGFjaXR5Iiwib25TdGFydCIsInN0YXJ0Iiwib25Db21wbGV0ZSIsIm9uU29ydCIsIndyYXBMZXZlbCIsImRpdnMiLCJnZXRDaGlsZHJlbiIsImFjdGl2ZSIsInBpZCIsInJlcSIsIm1ha2VNdWx0aVNyY1NvcnRhYmxlIiwib2lkIiwiZWxzIiwibGlzIiwic3BsaXQiLCJqIiwiZGlkIiwiZmlsdGVyIiwiZGlzcG9zZSIsImVuYWJsZUZpbGVUcmVlRHJhZ0FuZERyb3AiLCJkcmFnSGFuZGxlIiwiZHJhZ0VsZW1lbnQiLCJyaWdodENsaWNrIiwiY2xvbmVCYXNlIiwiY2xvbmUiLCJjdXJyZW50SG92ZXIiLCJjdXJyZW50SG92ZXJUaW1lIiwiZXhwYW5kTGluayIsInNldFBvc2l0aW9uIiwicGFnZSIsImdldE9mZnNldFBhcmVudCIsImdldFBvc2l0aW9uIiwibW92ZSIsIkRyYWciLCJNb3ZlIiwiZHJvcHBhYmxlcyIsInVuRHJhZ2dhYmxlVGFncyIsIm1vZGlmaWVycyIsIm9uRW50ZXIiLCJkcm9wcGFibGUiLCJmaXhEcm9wcGFibGUiLCJEYXRlIiwiZ2V0VGltZSIsIm9uQWpheCIsInJlbW92ZUV2ZW50Iiwib25DYW5jZWwiLCJvbktleXVwIiwib25Ecm9wIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwib25MZWF2ZSIsImxpc3RXaXphcmQiLCJtYWtlU29ydGFibGUiLCJhZGRFdmVudHNUbyIsImNvbW1hbmQiLCJwcmV2aW91cyIsImJ0IiwiaGFzRXZlbnQiLCJnZXRQcm9wZXJ0eSIsImtleUNvZGUiLCJ0YWJsZVdpemFyZCIsInRoZWFkIiwidGJvZHkiLCJyb3dzIiwidGV4dGFyZWEiLCJjaGlsZHJlbiIsInRyIiwiaGVhZCIsImN1cnJlbnQiLCJudHIiLCJpbmRleCIsImdldEluZGV4IiwiaGVhZEZpcnN0IiwiZ2V0TGFzdCIsInRkIiwiY29scyIsInRhYmxlV2l6YXJkUmVzaXplIiwiZmFjdG9yIiwic2l6ZSIsInJvdW5kIiwibGltaXQiLCJjaHVua3MiLCJ0YWJsZVdpemFyZFNldFdpZHRoIiwiZ2V0Q29tcHV0ZWRTaXplIiwib3B0aW9uc1dpemFyZCIsImtleVZhbHVlV2l6YXJkIiwiY2hlY2tib3hXaXphcmQiLCJzcGFuIiwibnNwYW4iLCJlbmFibGVJbWFnZVNpemVXaWRnZXRzIiwid2lkdGhJbnB1dCIsImhlaWdodElucHV0IiwidXBkYXRlIiwiZGltZW5zaW9ucyIsImdldFNlbGVjdGVkIiwiZW5hYmxlVG9nZ2xlU2VsZWN0Iiwic2hpZnRUb2dnbGUiLCJ0aGlzSW5kZXgiLCJjaGVja2JveGVzIiwic3RhcnRJbmRleCIsImZyb20iLCJ0byIsImNsaWNrRXZlbnQiLCJsaW1pdFRvZ2dsZXIiLCJzaGlmdCIsImJvdW5kRXZlbnQiLCJyZXRyaWV2ZSIsInN0b3BQcm9wYWdhdGlvbiIsImVkaXRQcmV2aWV3V2l6YXJkIiwiaW1hZ2VFbGVtZW50IiwiaW5wdXRFbGVtZW50cyIsImlzRHJhd2luZyIsInBhcnRFbGVtZW50Iiwic3RhcnRQb3MiLCJnZXRTY2FsZSIsInVwZGF0ZUltYWdlIiwic2NhbGUiLCJpbWFnZVNpemUiLCJzZXRTdHlsZXMiLCJjb21wdXRlZFRvcCIsImxlZnQiLCJjb21wdXRlZExlZnQiLCJ0b0Zsb2F0IiwidXBkYXRlVmFsdWVzIiwic3R5bGVzIiwiZ2V0U3R5bGVzIiwidG9GaXhlZCIsInJlY3QiLCJhYnMiLCJjYXBpdGFsaXplIiwiZ2V0TGVuZ3RoIiwiYWRkRXZlbnRzIiwibW91c2Vkb3duIiwidG91Y2hzdGFydCIsIm1vdXNlbW92ZSIsInRvdWNobW92ZSIsIm1vdXNldXAiLCJ0b3VjaGVuZCIsInRvdWNoY2FuY2VsIiwicmVzaXplIiwiZW5hYmxlRmlsZVRyZWVVcGxvYWQiLCJmYWxsYmFja1VybCIsImR6RWxlbWVudCIsInByZXZpZXdzQ29udGFpbmVyIiwiY2xpY2thYmxlIiwiZHoiLCJEcm9wem9uZSIsInJlbG9hZCIsImRhdGFUcmFuc2ZlciIsInR5cGVzIiwibGluayIsImNyYXdsIiwidGltZW91dCIsInByb2dyZXNzQmFyIiwicHJvZ3Jlc3NDb3VudCIsInJlc3VsdHMiLCJkZWJ1Z0xvZyIsInVwZGF0ZURhdGEiLCJ0b3RhbCIsInBlbmRpbmciLCJwZXJjZW50YWdlIiwicmVzdWx0IiwiaGFzRGVidWdMb2ciLCJmaW5pc2hlZCIsInN1bW1hcnkiLCJ3YXJuaW5nIiwibG9nIiwic3Vic2NyaWJlclJlc3VsdHMiLCJzdWJzY3JpYmVyU3VtbWFyeSIsImhhc0xvZyIsIndhc1N1Y2Nlc3NmdWwiLCJleGVjUmVxdWVzdCIsIm9ubHlTdGF0dXNVcGRhdGUiLCJyZXNwb25zZVRleHQiLCJkZWNvZGUiLCJzZW5kIiwiVGhlbWUiLCJpc1dlYmtpdCIsImNocm9tZSIsInNhZmFyaSIsInVzZXJBZ2VudCIsInN0b3BDbGlja1Byb3BhZ2F0aW9uIiwic2V0dXBDdHJsQ2xpY2siLCJGZWF0dXJlcyIsIlRvdWNoIiwiUGxhdGZvcm0iLCJtYWMiLCJtZXRhS2V5IiwiY3RybEtleSIsInNoaWZ0S2V5Iiwic2V0dXBUZXh0YXJlYVJlc2l6aW5nIiwiaWU2IiwiaWU3IiwiaWU4IiwiZHVtbXkiLCJsaW5lIiwidHdlZW4iLCJzZXR1cE1lbnVUb2dnbGUiLCJidXJnZXIiLCJ0b2dnbGVDbGFzcyIsInNldEFyaWFDb250cm9scyIsInNldHVwUHJvZmlsZVRvZ2dsZSIsInRtZW51IiwibWVudSIsInNldHVwU3BsaXRCdXR0b25Ub2dnbGUiLCJ0YWIiLCJ0aW1lciIsImNsZWFyVGltZW91dCIsImhndCIsImluaXRpYWxpemVkUm93cyIsInNhdmVTY3JvbGxPZmZzZXRFdmVudCIsInJvdyIsIkFycmF5IiwiY2xvbmVOb2RlIiwic2VsZWN0cyIsIm5zZWxlY3RzIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNvZGUiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ1cGRhdGVMaW5rIiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9uc0xpc3QiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsIl9zdGVwIiwibXV0YXRpb24iLCJhZGRlZE5vZGVzIiwiZXJyIiwib2JzZXJ2ZSIsImF0dHJpYnV0ZXMiLCJjaGlsZExpc3QiLCJzdWJ0cmVlIiwiQ2xhc3MiLCJFeHRlbmRzIiwiZm9sbG93UmVkaXJlY3RzIiwic3VjY2VzcyIsImdldEhlYWRlciIsInNlY3VyZSIsInN0cmlwU2NyaXB0cyIsInNjcmlwdCIsImZhaWx1cmUiLCJvbkZhaWx1cmUiLCJyZWZhY3RvciIsImF0dGFjaCIsImhhbmRsZXMiLCJib3VuZCIsImRldGFjaCIsImNoZWNrIiwiZGlzdGFuY2UiLCJzcXJ0IiwicG93IiwibW91c2UiLCJzbmFwIiwiZHJhZyIsInJlbW92ZUV2ZW50cyIsImxpc3RzIiwiZHJhZ09wdGlvbnMiLCJtZXJnZSIsInRhZyIsImFkZEl0ZW1zIiwiZmxhdHRlbiIsInJlbW92ZUl0ZW1zIiwiZXJhc2UiLCJnZXRDbG9uZSIsIlF1ZXVlIiwiYXV0b0FkdmFuY2UiLCJyZXN1bWUiLCJxdWV1ZSIsImlzUnVubmluZyIsInN0b3BPbkZhaWx1cmUiLCJvbkV4Y2VwdGlvbiIsIlNlcnBQcmV2aWV3IiwidHJhaWwiLCJ0aXRsZUZpZWxkIiwidGl0bGVGYWxsYmFja0ZpZWxkIiwiYWxpYXNGaWVsZCIsImRlc2NyaXB0aW9uRmllbGQiLCJkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQiLCJ0aXRsZVRhZyIsInNob3J0ZW4iLCJodG1sMnN0cmluZyIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsInRleHRDb250ZW50IiwiZ2V0VGlueW1jZSIsInRpbnlNQ0UiLCJzZXJwVGl0bGUiLCJzZXJwVXJsIiwic2VycERlc2NyaXB0aW9uIiwiaW5kZXhFbXB0eSIsImdldENvbnRlbnQiLCJhY3RpdmVFZGl0b3IiLCJpbml0aWFsaXplZCIsInRpcCIsInBvc2l0aW9uIiwidXNlQ29udGVudCIsIl90ZXh0Iiwid2lsbENoYW5nZSIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJ0bCIsImRpcmVjdGlvbiIsImNsaWVudFdpZHRoIiwic2Nyb2xsWCIsInJpZ2h0Iiwic2Nyb2xsWSIsImhhc0F0dHJpYnV0ZSIsInNlbGVjdG9yIiwiX3RvQ29uc3VtYWJsZUFycmF5Iiwic2V0dXAiLCJBcHBsaWNhdGlvbiIsImRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyIiwiaWRlbnRpZmllckZvckNvbnRleHRLZXkiLCJkZWJ1ZyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImNvbnRleHQiLCJyZXF1aXJlIiwibG9hZCIsIm1vb0RvbXJlYWR5IiwibW9vRG9tcmVhZHlGaXJlZCJdLCJzb3VyY2VSb290IjoiIn0=