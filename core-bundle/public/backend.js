/******/ (function() { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./core-bundle/assets/controllers sync recursive \\.js$":
/*!****************************************************!*\
  !*** ./core-bundle/assets/controllers/ sync \.js$ ***!
  \****************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

var map = {
	"./ace-controller.js": "./core-bundle/assets/controllers/ace-controller.js",
	"./backend-search-controller.js": "./core-bundle/assets/controllers/backend-search-controller.js",
	"./choices-controller.js": "./core-bundle/assets/controllers/choices-controller.js",
	"./clipboard-controller.js": "./core-bundle/assets/controllers/clipboard-controller.js",
	"./color-picker-controller.js": "./core-bundle/assets/controllers/color-picker-controller.js",
	"./color-scheme-controller.js": "./core-bundle/assets/controllers/color-scheme-controller.js",
	"./deeplink-controller.js": "./core-bundle/assets/controllers/deeplink-controller.js",
	"./image-size-controller.js": "./core-bundle/assets/controllers/image-size-controller.js",
	"./jump-targets-controller.js": "./core-bundle/assets/controllers/jump-targets-controller.js",
	"./limit-height-controller.js": "./core-bundle/assets/controllers/limit-height-controller.js",
	"./metawizard-controller.js": "./core-bundle/assets/controllers/metawizard-controller.js",
	"./operations-menu-controller.js": "./core-bundle/assets/controllers/operations-menu-controller.js",
	"./passkeys-controller.js": "./core-bundle/assets/controllers/passkeys-controller.js",
	"./profile-controller.js": "./core-bundle/assets/controllers/profile-controller.js",
	"./scroll-offset-controller.js": "./core-bundle/assets/controllers/scroll-offset-controller.js",
	"./tabs-controller.js": "./core-bundle/assets/controllers/tabs-controller.js",
	"./template-studio-controller.js": "./core-bundle/assets/controllers/template-studio-controller.js",
	"./tinymce-controller.js": "./core-bundle/assets/controllers/tinymce-controller.js",
	"./toggle-fieldset-controller.js": "./core-bundle/assets/controllers/toggle-fieldset-controller.js",
	"./toggle-navigation-controller.js": "./core-bundle/assets/controllers/toggle-navigation-controller.js",
	"./toggle-nodes-controller.js": "./core-bundle/assets/controllers/toggle-nodes-controller.js",
	"./tooltips-controller.js": "./core-bundle/assets/controllers/tooltips-controller.js",
	"./webauthn-error-controller.js": "./core-bundle/assets/controllers/webauthn-error-controller.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./core-bundle/assets/controllers sync recursive \\.js$";

/***/ }),

/***/ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js ***!
  \******************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   definitionForModuleAndIdentifier: function() { return /* binding */ definitionForModuleAndIdentifier; },
/* harmony export */   definitionForModuleWithContextAndKey: function() { return /* binding */ definitionForModuleWithContextAndKey; },
/* harmony export */   definitionsFromContext: function() { return /* binding */ definitionsFromContext; },
/* harmony export */   identifierForContextKey: function() { return /* binding */ identifierForContextKey; }
/* harmony export */ });
/*
Stimulus Webpack Helpers 1.0.0
Copyright © 2021 Basecamp, LLC
 */
function definitionsFromContext(context) {
    return context.keys()
        .map((key) => definitionForModuleWithContextAndKey(context, key))
        .filter((value) => value);
}
function definitionForModuleWithContextAndKey(context, key) {
    const identifier = identifierForContextKey(key);
    if (identifier) {
        return definitionForModuleAndIdentifier(context(key), identifier);
    }
}
function definitionForModuleAndIdentifier(module, identifier) {
    const controllerConstructor = module.default;
    if (typeof controllerConstructor == "function") {
        return { identifier, controllerConstructor };
    }
}
function identifierForContextKey(key) {
    const logicalName = (key.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/) || [])[1];
    if (logicalName) {
        return logicalName.replace(/_/g, "-").replace(/\//g, "--");
    }
}




/***/ }),

/***/ "./node_modules/@hotwired/stimulus/dist/stimulus.js":
/*!**********************************************************!*\
  !*** ./node_modules/@hotwired/stimulus/dist/stimulus.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Application: function() { return /* binding */ Application; },
/* harmony export */   AttributeObserver: function() { return /* binding */ AttributeObserver; },
/* harmony export */   Context: function() { return /* binding */ Context; },
/* harmony export */   Controller: function() { return /* binding */ Controller; },
/* harmony export */   ElementObserver: function() { return /* binding */ ElementObserver; },
/* harmony export */   IndexedMultimap: function() { return /* binding */ IndexedMultimap; },
/* harmony export */   Multimap: function() { return /* binding */ Multimap; },
/* harmony export */   SelectorObserver: function() { return /* binding */ SelectorObserver; },
/* harmony export */   StringMapObserver: function() { return /* binding */ StringMapObserver; },
/* harmony export */   TokenListObserver: function() { return /* binding */ TokenListObserver; },
/* harmony export */   ValueListObserver: function() { return /* binding */ ValueListObserver; },
/* harmony export */   add: function() { return /* binding */ add; },
/* harmony export */   defaultSchema: function() { return /* binding */ defaultSchema; },
/* harmony export */   del: function() { return /* binding */ del; },
/* harmony export */   fetch: function() { return /* binding */ fetch; },
/* harmony export */   prune: function() { return /* binding */ prune; }
/* harmony export */ });
/*
Stimulus 3.2.1
Copyright © 2023 Basecamp, LLC
 */
class EventListener {
    constructor(eventTarget, eventName, eventOptions) {
        this.eventTarget = eventTarget;
        this.eventName = eventName;
        this.eventOptions = eventOptions;
        this.unorderedBindings = new Set();
    }
    connect() {
        this.eventTarget.addEventListener(this.eventName, this, this.eventOptions);
    }
    disconnect() {
        this.eventTarget.removeEventListener(this.eventName, this, this.eventOptions);
    }
    bindingConnected(binding) {
        this.unorderedBindings.add(binding);
    }
    bindingDisconnected(binding) {
        this.unorderedBindings.delete(binding);
    }
    handleEvent(event) {
        const extendedEvent = extendEvent(event);
        for (const binding of this.bindings) {
            if (extendedEvent.immediatePropagationStopped) {
                break;
            }
            else {
                binding.handleEvent(extendedEvent);
            }
        }
    }
    hasBindings() {
        return this.unorderedBindings.size > 0;
    }
    get bindings() {
        return Array.from(this.unorderedBindings).sort((left, right) => {
            const leftIndex = left.index, rightIndex = right.index;
            return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0;
        });
    }
}
function extendEvent(event) {
    if ("immediatePropagationStopped" in event) {
        return event;
    }
    else {
        const { stopImmediatePropagation } = event;
        return Object.assign(event, {
            immediatePropagationStopped: false,
            stopImmediatePropagation() {
                this.immediatePropagationStopped = true;
                stopImmediatePropagation.call(this);
            },
        });
    }
}

class Dispatcher {
    constructor(application) {
        this.application = application;
        this.eventListenerMaps = new Map();
        this.started = false;
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.eventListeners.forEach((eventListener) => eventListener.connect());
        }
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.eventListeners.forEach((eventListener) => eventListener.disconnect());
        }
    }
    get eventListeners() {
        return Array.from(this.eventListenerMaps.values()).reduce((listeners, map) => listeners.concat(Array.from(map.values())), []);
    }
    bindingConnected(binding) {
        this.fetchEventListenerForBinding(binding).bindingConnected(binding);
    }
    bindingDisconnected(binding, clearEventListeners = false) {
        this.fetchEventListenerForBinding(binding).bindingDisconnected(binding);
        if (clearEventListeners)
            this.clearEventListenersForBinding(binding);
    }
    handleError(error, message, detail = {}) {
        this.application.handleError(error, `Error ${message}`, detail);
    }
    clearEventListenersForBinding(binding) {
        const eventListener = this.fetchEventListenerForBinding(binding);
        if (!eventListener.hasBindings()) {
            eventListener.disconnect();
            this.removeMappedEventListenerFor(binding);
        }
    }
    removeMappedEventListenerFor(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        eventListenerMap.delete(cacheKey);
        if (eventListenerMap.size == 0)
            this.eventListenerMaps.delete(eventTarget);
    }
    fetchEventListenerForBinding(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        return this.fetchEventListener(eventTarget, eventName, eventOptions);
    }
    fetchEventListener(eventTarget, eventName, eventOptions) {
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        let eventListener = eventListenerMap.get(cacheKey);
        if (!eventListener) {
            eventListener = this.createEventListener(eventTarget, eventName, eventOptions);
            eventListenerMap.set(cacheKey, eventListener);
        }
        return eventListener;
    }
    createEventListener(eventTarget, eventName, eventOptions) {
        const eventListener = new EventListener(eventTarget, eventName, eventOptions);
        if (this.started) {
            eventListener.connect();
        }
        return eventListener;
    }
    fetchEventListenerMapForEventTarget(eventTarget) {
        let eventListenerMap = this.eventListenerMaps.get(eventTarget);
        if (!eventListenerMap) {
            eventListenerMap = new Map();
            this.eventListenerMaps.set(eventTarget, eventListenerMap);
        }
        return eventListenerMap;
    }
    cacheKey(eventName, eventOptions) {
        const parts = [eventName];
        Object.keys(eventOptions)
            .sort()
            .forEach((key) => {
            parts.push(`${eventOptions[key] ? "" : "!"}${key}`);
        });
        return parts.join(":");
    }
}

const defaultActionDescriptorFilters = {
    stop({ event, value }) {
        if (value)
            event.stopPropagation();
        return true;
    },
    prevent({ event, value }) {
        if (value)
            event.preventDefault();
        return true;
    },
    self({ event, value, element }) {
        if (value) {
            return element === event.target;
        }
        else {
            return true;
        }
    },
};
const descriptorPattern = /^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;
function parseActionDescriptorString(descriptorString) {
    const source = descriptorString.trim();
    const matches = source.match(descriptorPattern) || [];
    let eventName = matches[2];
    let keyFilter = matches[3];
    if (keyFilter && !["keydown", "keyup", "keypress"].includes(eventName)) {
        eventName += `.${keyFilter}`;
        keyFilter = "";
    }
    return {
        eventTarget: parseEventTarget(matches[4]),
        eventName,
        eventOptions: matches[7] ? parseEventOptions(matches[7]) : {},
        identifier: matches[5],
        methodName: matches[6],
        keyFilter: matches[1] || keyFilter,
    };
}
function parseEventTarget(eventTargetName) {
    if (eventTargetName == "window") {
        return window;
    }
    else if (eventTargetName == "document") {
        return document;
    }
}
function parseEventOptions(eventOptions) {
    return eventOptions
        .split(":")
        .reduce((options, token) => Object.assign(options, { [token.replace(/^!/, "")]: !/^!/.test(token) }), {});
}
function stringifyEventTarget(eventTarget) {
    if (eventTarget == window) {
        return "window";
    }
    else if (eventTarget == document) {
        return "document";
    }
}

function camelize(value) {
    return value.replace(/(?:[_-])([a-z0-9])/g, (_, char) => char.toUpperCase());
}
function namespaceCamelize(value) {
    return camelize(value.replace(/--/g, "-").replace(/__/g, "_"));
}
function capitalize(value) {
    return value.charAt(0).toUpperCase() + value.slice(1);
}
function dasherize(value) {
    return value.replace(/([A-Z])/g, (_, char) => `-${char.toLowerCase()}`);
}
function tokenize(value) {
    return value.match(/[^\s]+/g) || [];
}

function isSomething(object) {
    return object !== null && object !== undefined;
}
function hasProperty(object, property) {
    return Object.prototype.hasOwnProperty.call(object, property);
}

const allModifiers = ["meta", "ctrl", "alt", "shift"];
class Action {
    constructor(element, index, descriptor, schema) {
        this.element = element;
        this.index = index;
        this.eventTarget = descriptor.eventTarget || element;
        this.eventName = descriptor.eventName || getDefaultEventNameForElement(element) || error("missing event name");
        this.eventOptions = descriptor.eventOptions || {};
        this.identifier = descriptor.identifier || error("missing identifier");
        this.methodName = descriptor.methodName || error("missing method name");
        this.keyFilter = descriptor.keyFilter || "";
        this.schema = schema;
    }
    static forToken(token, schema) {
        return new this(token.element, token.index, parseActionDescriptorString(token.content), schema);
    }
    toString() {
        const eventFilter = this.keyFilter ? `.${this.keyFilter}` : "";
        const eventTarget = this.eventTargetName ? `@${this.eventTargetName}` : "";
        return `${this.eventName}${eventFilter}${eventTarget}->${this.identifier}#${this.methodName}`;
    }
    shouldIgnoreKeyboardEvent(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filters = this.keyFilter.split("+");
        if (this.keyFilterDissatisfied(event, filters)) {
            return true;
        }
        const standardFilter = filters.filter((key) => !allModifiers.includes(key))[0];
        if (!standardFilter) {
            return false;
        }
        if (!hasProperty(this.keyMappings, standardFilter)) {
            error(`contains unknown key filter: ${this.keyFilter}`);
        }
        return this.keyMappings[standardFilter].toLowerCase() !== event.key.toLowerCase();
    }
    shouldIgnoreMouseEvent(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filters = [this.keyFilter];
        if (this.keyFilterDissatisfied(event, filters)) {
            return true;
        }
        return false;
    }
    get params() {
        const params = {};
        const pattern = new RegExp(`^data-${this.identifier}-(.+)-param$`, "i");
        for (const { name, value } of Array.from(this.element.attributes)) {
            const match = name.match(pattern);
            const key = match && match[1];
            if (key) {
                params[camelize(key)] = typecast(value);
            }
        }
        return params;
    }
    get eventTargetName() {
        return stringifyEventTarget(this.eventTarget);
    }
    get keyMappings() {
        return this.schema.keyMappings;
    }
    keyFilterDissatisfied(event, filters) {
        const [meta, ctrl, alt, shift] = allModifiers.map((modifier) => filters.includes(modifier));
        return event.metaKey !== meta || event.ctrlKey !== ctrl || event.altKey !== alt || event.shiftKey !== shift;
    }
}
const defaultEventNames = {
    a: () => "click",
    button: () => "click",
    form: () => "submit",
    details: () => "toggle",
    input: (e) => (e.getAttribute("type") == "submit" ? "click" : "input"),
    select: () => "change",
    textarea: () => "input",
};
function getDefaultEventNameForElement(element) {
    const tagName = element.tagName.toLowerCase();
    if (tagName in defaultEventNames) {
        return defaultEventNames[tagName](element);
    }
}
function error(message) {
    throw new Error(message);
}
function typecast(value) {
    try {
        return JSON.parse(value);
    }
    catch (o_O) {
        return value;
    }
}

class Binding {
    constructor(context, action) {
        this.context = context;
        this.action = action;
    }
    get index() {
        return this.action.index;
    }
    get eventTarget() {
        return this.action.eventTarget;
    }
    get eventOptions() {
        return this.action.eventOptions;
    }
    get identifier() {
        return this.context.identifier;
    }
    handleEvent(event) {
        const actionEvent = this.prepareActionEvent(event);
        if (this.willBeInvokedByEvent(event) && this.applyEventModifiers(actionEvent)) {
            this.invokeWithEvent(actionEvent);
        }
    }
    get eventName() {
        return this.action.eventName;
    }
    get method() {
        const method = this.controller[this.methodName];
        if (typeof method == "function") {
            return method;
        }
        throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`);
    }
    applyEventModifiers(event) {
        const { element } = this.action;
        const { actionDescriptorFilters } = this.context.application;
        const { controller } = this.context;
        let passes = true;
        for (const [name, value] of Object.entries(this.eventOptions)) {
            if (name in actionDescriptorFilters) {
                const filter = actionDescriptorFilters[name];
                passes = passes && filter({ name, value, event, element, controller });
            }
            else {
                continue;
            }
        }
        return passes;
    }
    prepareActionEvent(event) {
        return Object.assign(event, { params: this.action.params });
    }
    invokeWithEvent(event) {
        const { target, currentTarget } = event;
        try {
            this.method.call(this.controller, event);
            this.context.logDebugActivity(this.methodName, { event, target, currentTarget, action: this.methodName });
        }
        catch (error) {
            const { identifier, controller, element, index } = this;
            const detail = { identifier, controller, element, index, event };
            this.context.handleError(error, `invoking action "${this.action}"`, detail);
        }
    }
    willBeInvokedByEvent(event) {
        const eventTarget = event.target;
        if (event instanceof KeyboardEvent && this.action.shouldIgnoreKeyboardEvent(event)) {
            return false;
        }
        if (event instanceof MouseEvent && this.action.shouldIgnoreMouseEvent(event)) {
            return false;
        }
        if (this.element === eventTarget) {
            return true;
        }
        else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {
            return this.scope.containsElement(eventTarget);
        }
        else {
            return this.scope.containsElement(this.action.element);
        }
    }
    get controller() {
        return this.context.controller;
    }
    get methodName() {
        return this.action.methodName;
    }
    get element() {
        return this.scope.element;
    }
    get scope() {
        return this.context.scope;
    }
}

class ElementObserver {
    constructor(element, delegate) {
        this.mutationObserverInit = { attributes: true, childList: true, subtree: true };
        this.element = element;
        this.started = false;
        this.delegate = delegate;
        this.elements = new Set();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.refresh();
        }
    }
    pause(callback) {
        if (this.started) {
            this.mutationObserver.disconnect();
            this.started = false;
        }
        callback();
        if (!this.started) {
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.started = true;
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            const matches = new Set(this.matchElementsInTree());
            for (const element of Array.from(this.elements)) {
                if (!matches.has(element)) {
                    this.removeElement(element);
                }
            }
            for (const element of Array.from(matches)) {
                this.addElement(element);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        if (mutation.type == "attributes") {
            this.processAttributeChange(mutation.target, mutation.attributeName);
        }
        else if (mutation.type == "childList") {
            this.processRemovedNodes(mutation.removedNodes);
            this.processAddedNodes(mutation.addedNodes);
        }
    }
    processAttributeChange(element, attributeName) {
        if (this.elements.has(element)) {
            if (this.delegate.elementAttributeChanged && this.matchElement(element)) {
                this.delegate.elementAttributeChanged(element, attributeName);
            }
            else {
                this.removeElement(element);
            }
        }
        else if (this.matchElement(element)) {
            this.addElement(element);
        }
    }
    processRemovedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element) {
                this.processTree(element, this.removeElement);
            }
        }
    }
    processAddedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element && this.elementIsActive(element)) {
                this.processTree(element, this.addElement);
            }
        }
    }
    matchElement(element) {
        return this.delegate.matchElement(element);
    }
    matchElementsInTree(tree = this.element) {
        return this.delegate.matchElementsInTree(tree);
    }
    processTree(tree, processor) {
        for (const element of this.matchElementsInTree(tree)) {
            processor.call(this, element);
        }
    }
    elementFromNode(node) {
        if (node.nodeType == Node.ELEMENT_NODE) {
            return node;
        }
    }
    elementIsActive(element) {
        if (element.isConnected != this.element.isConnected) {
            return false;
        }
        else {
            return this.element.contains(element);
        }
    }
    addElement(element) {
        if (!this.elements.has(element)) {
            if (this.elementIsActive(element)) {
                this.elements.add(element);
                if (this.delegate.elementMatched) {
                    this.delegate.elementMatched(element);
                }
            }
        }
    }
    removeElement(element) {
        if (this.elements.has(element)) {
            this.elements.delete(element);
            if (this.delegate.elementUnmatched) {
                this.delegate.elementUnmatched(element);
            }
        }
    }
}

class AttributeObserver {
    constructor(element, attributeName, delegate) {
        this.attributeName = attributeName;
        this.delegate = delegate;
        this.elementObserver = new ElementObserver(element, this);
    }
    get element() {
        return this.elementObserver.element;
    }
    get selector() {
        return `[${this.attributeName}]`;
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get started() {
        return this.elementObserver.started;
    }
    matchElement(element) {
        return element.hasAttribute(this.attributeName);
    }
    matchElementsInTree(tree) {
        const match = this.matchElement(tree) ? [tree] : [];
        const matches = Array.from(tree.querySelectorAll(this.selector));
        return match.concat(matches);
    }
    elementMatched(element) {
        if (this.delegate.elementMatchedAttribute) {
            this.delegate.elementMatchedAttribute(element, this.attributeName);
        }
    }
    elementUnmatched(element) {
        if (this.delegate.elementUnmatchedAttribute) {
            this.delegate.elementUnmatchedAttribute(element, this.attributeName);
        }
    }
    elementAttributeChanged(element, attributeName) {
        if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {
            this.delegate.elementAttributeValueChanged(element, attributeName);
        }
    }
}

function add(map, key, value) {
    fetch(map, key).add(value);
}
function del(map, key, value) {
    fetch(map, key).delete(value);
    prune(map, key);
}
function fetch(map, key) {
    let values = map.get(key);
    if (!values) {
        values = new Set();
        map.set(key, values);
    }
    return values;
}
function prune(map, key) {
    const values = map.get(key);
    if (values != null && values.size == 0) {
        map.delete(key);
    }
}

class Multimap {
    constructor() {
        this.valuesByKey = new Map();
    }
    get keys() {
        return Array.from(this.valuesByKey.keys());
    }
    get values() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((values, set) => values.concat(Array.from(set)), []);
    }
    get size() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((size, set) => size + set.size, 0);
    }
    add(key, value) {
        add(this.valuesByKey, key, value);
    }
    delete(key, value) {
        del(this.valuesByKey, key, value);
    }
    has(key, value) {
        const values = this.valuesByKey.get(key);
        return values != null && values.has(value);
    }
    hasKey(key) {
        return this.valuesByKey.has(key);
    }
    hasValue(value) {
        const sets = Array.from(this.valuesByKey.values());
        return sets.some((set) => set.has(value));
    }
    getValuesForKey(key) {
        const values = this.valuesByKey.get(key);
        return values ? Array.from(values) : [];
    }
    getKeysForValue(value) {
        return Array.from(this.valuesByKey)
            .filter(([_key, values]) => values.has(value))
            .map(([key, _values]) => key);
    }
}

class IndexedMultimap extends Multimap {
    constructor() {
        super();
        this.keysByValue = new Map();
    }
    get values() {
        return Array.from(this.keysByValue.keys());
    }
    add(key, value) {
        super.add(key, value);
        add(this.keysByValue, value, key);
    }
    delete(key, value) {
        super.delete(key, value);
        del(this.keysByValue, value, key);
    }
    hasValue(value) {
        return this.keysByValue.has(value);
    }
    getKeysForValue(value) {
        const set = this.keysByValue.get(value);
        return set ? Array.from(set) : [];
    }
}

class SelectorObserver {
    constructor(element, selector, delegate, details) {
        this._selector = selector;
        this.details = details;
        this.elementObserver = new ElementObserver(element, this);
        this.delegate = delegate;
        this.matchesByElement = new Multimap();
    }
    get started() {
        return this.elementObserver.started;
    }
    get selector() {
        return this._selector;
    }
    set selector(selector) {
        this._selector = selector;
        this.refresh();
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get element() {
        return this.elementObserver.element;
    }
    matchElement(element) {
        const { selector } = this;
        if (selector) {
            const matches = element.matches(selector);
            if (this.delegate.selectorMatchElement) {
                return matches && this.delegate.selectorMatchElement(element, this.details);
            }
            return matches;
        }
        else {
            return false;
        }
    }
    matchElementsInTree(tree) {
        const { selector } = this;
        if (selector) {
            const match = this.matchElement(tree) ? [tree] : [];
            const matches = Array.from(tree.querySelectorAll(selector)).filter((match) => this.matchElement(match));
            return match.concat(matches);
        }
        else {
            return [];
        }
    }
    elementMatched(element) {
        const { selector } = this;
        if (selector) {
            this.selectorMatched(element, selector);
        }
    }
    elementUnmatched(element) {
        const selectors = this.matchesByElement.getKeysForValue(element);
        for (const selector of selectors) {
            this.selectorUnmatched(element, selector);
        }
    }
    elementAttributeChanged(element, _attributeName) {
        const { selector } = this;
        if (selector) {
            const matches = this.matchElement(element);
            const matchedBefore = this.matchesByElement.has(selector, element);
            if (matches && !matchedBefore) {
                this.selectorMatched(element, selector);
            }
            else if (!matches && matchedBefore) {
                this.selectorUnmatched(element, selector);
            }
        }
    }
    selectorMatched(element, selector) {
        this.delegate.selectorMatched(element, selector, this.details);
        this.matchesByElement.add(selector, element);
    }
    selectorUnmatched(element, selector) {
        this.delegate.selectorUnmatched(element, selector, this.details);
        this.matchesByElement.delete(selector, element);
    }
}

class StringMapObserver {
    constructor(element, delegate) {
        this.element = element;
        this.delegate = delegate;
        this.started = false;
        this.stringMap = new Map();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, { attributes: true, attributeOldValue: true });
            this.refresh();
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            for (const attributeName of this.knownAttributeNames) {
                this.refreshAttribute(attributeName, null);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        const attributeName = mutation.attributeName;
        if (attributeName) {
            this.refreshAttribute(attributeName, mutation.oldValue);
        }
    }
    refreshAttribute(attributeName, oldValue) {
        const key = this.delegate.getStringMapKeyForAttribute(attributeName);
        if (key != null) {
            if (!this.stringMap.has(attributeName)) {
                this.stringMapKeyAdded(key, attributeName);
            }
            const value = this.element.getAttribute(attributeName);
            if (this.stringMap.get(attributeName) != value) {
                this.stringMapValueChanged(value, key, oldValue);
            }
            if (value == null) {
                const oldValue = this.stringMap.get(attributeName);
                this.stringMap.delete(attributeName);
                if (oldValue)
                    this.stringMapKeyRemoved(key, attributeName, oldValue);
            }
            else {
                this.stringMap.set(attributeName, value);
            }
        }
    }
    stringMapKeyAdded(key, attributeName) {
        if (this.delegate.stringMapKeyAdded) {
            this.delegate.stringMapKeyAdded(key, attributeName);
        }
    }
    stringMapValueChanged(value, key, oldValue) {
        if (this.delegate.stringMapValueChanged) {
            this.delegate.stringMapValueChanged(value, key, oldValue);
        }
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        if (this.delegate.stringMapKeyRemoved) {
            this.delegate.stringMapKeyRemoved(key, attributeName, oldValue);
        }
    }
    get knownAttributeNames() {
        return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)));
    }
    get currentAttributeNames() {
        return Array.from(this.element.attributes).map((attribute) => attribute.name);
    }
    get recordedAttributeNames() {
        return Array.from(this.stringMap.keys());
    }
}

class TokenListObserver {
    constructor(element, attributeName, delegate) {
        this.attributeObserver = new AttributeObserver(element, attributeName, this);
        this.delegate = delegate;
        this.tokensByElement = new Multimap();
    }
    get started() {
        return this.attributeObserver.started;
    }
    start() {
        this.attributeObserver.start();
    }
    pause(callback) {
        this.attributeObserver.pause(callback);
    }
    stop() {
        this.attributeObserver.stop();
    }
    refresh() {
        this.attributeObserver.refresh();
    }
    get element() {
        return this.attributeObserver.element;
    }
    get attributeName() {
        return this.attributeObserver.attributeName;
    }
    elementMatchedAttribute(element) {
        this.tokensMatched(this.readTokensForElement(element));
    }
    elementAttributeValueChanged(element) {
        const [unmatchedTokens, matchedTokens] = this.refreshTokensForElement(element);
        this.tokensUnmatched(unmatchedTokens);
        this.tokensMatched(matchedTokens);
    }
    elementUnmatchedAttribute(element) {
        this.tokensUnmatched(this.tokensByElement.getValuesForKey(element));
    }
    tokensMatched(tokens) {
        tokens.forEach((token) => this.tokenMatched(token));
    }
    tokensUnmatched(tokens) {
        tokens.forEach((token) => this.tokenUnmatched(token));
    }
    tokenMatched(token) {
        this.delegate.tokenMatched(token);
        this.tokensByElement.add(token.element, token);
    }
    tokenUnmatched(token) {
        this.delegate.tokenUnmatched(token);
        this.tokensByElement.delete(token.element, token);
    }
    refreshTokensForElement(element) {
        const previousTokens = this.tokensByElement.getValuesForKey(element);
        const currentTokens = this.readTokensForElement(element);
        const firstDifferingIndex = zip(previousTokens, currentTokens).findIndex(([previousToken, currentToken]) => !tokensAreEqual(previousToken, currentToken));
        if (firstDifferingIndex == -1) {
            return [[], []];
        }
        else {
            return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)];
        }
    }
    readTokensForElement(element) {
        const attributeName = this.attributeName;
        const tokenString = element.getAttribute(attributeName) || "";
        return parseTokenString(tokenString, element, attributeName);
    }
}
function parseTokenString(tokenString, element, attributeName) {
    return tokenString
        .trim()
        .split(/\s+/)
        .filter((content) => content.length)
        .map((content, index) => ({ element, attributeName, content, index }));
}
function zip(left, right) {
    const length = Math.max(left.length, right.length);
    return Array.from({ length }, (_, index) => [left[index], right[index]]);
}
function tokensAreEqual(left, right) {
    return left && right && left.index == right.index && left.content == right.content;
}

class ValueListObserver {
    constructor(element, attributeName, delegate) {
        this.tokenListObserver = new TokenListObserver(element, attributeName, this);
        this.delegate = delegate;
        this.parseResultsByToken = new WeakMap();
        this.valuesByTokenByElement = new WeakMap();
    }
    get started() {
        return this.tokenListObserver.started;
    }
    start() {
        this.tokenListObserver.start();
    }
    stop() {
        this.tokenListObserver.stop();
    }
    refresh() {
        this.tokenListObserver.refresh();
    }
    get element() {
        return this.tokenListObserver.element;
    }
    get attributeName() {
        return this.tokenListObserver.attributeName;
    }
    tokenMatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).set(token, value);
            this.delegate.elementMatchedValue(element, value);
        }
    }
    tokenUnmatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).delete(token);
            this.delegate.elementUnmatchedValue(element, value);
        }
    }
    fetchParseResultForToken(token) {
        let parseResult = this.parseResultsByToken.get(token);
        if (!parseResult) {
            parseResult = this.parseToken(token);
            this.parseResultsByToken.set(token, parseResult);
        }
        return parseResult;
    }
    fetchValuesByTokenForElement(element) {
        let valuesByToken = this.valuesByTokenByElement.get(element);
        if (!valuesByToken) {
            valuesByToken = new Map();
            this.valuesByTokenByElement.set(element, valuesByToken);
        }
        return valuesByToken;
    }
    parseToken(token) {
        try {
            const value = this.delegate.parseValueForToken(token);
            return { value };
        }
        catch (error) {
            return { error };
        }
    }
}

class BindingObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.bindingsByAction = new Map();
    }
    start() {
        if (!this.valueListObserver) {
            this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this);
            this.valueListObserver.start();
        }
    }
    stop() {
        if (this.valueListObserver) {
            this.valueListObserver.stop();
            delete this.valueListObserver;
            this.disconnectAllActions();
        }
    }
    get element() {
        return this.context.element;
    }
    get identifier() {
        return this.context.identifier;
    }
    get actionAttribute() {
        return this.schema.actionAttribute;
    }
    get schema() {
        return this.context.schema;
    }
    get bindings() {
        return Array.from(this.bindingsByAction.values());
    }
    connectAction(action) {
        const binding = new Binding(this.context, action);
        this.bindingsByAction.set(action, binding);
        this.delegate.bindingConnected(binding);
    }
    disconnectAction(action) {
        const binding = this.bindingsByAction.get(action);
        if (binding) {
            this.bindingsByAction.delete(action);
            this.delegate.bindingDisconnected(binding);
        }
    }
    disconnectAllActions() {
        this.bindings.forEach((binding) => this.delegate.bindingDisconnected(binding, true));
        this.bindingsByAction.clear();
    }
    parseValueForToken(token) {
        const action = Action.forToken(token, this.schema);
        if (action.identifier == this.identifier) {
            return action;
        }
    }
    elementMatchedValue(element, action) {
        this.connectAction(action);
    }
    elementUnmatchedValue(element, action) {
        this.disconnectAction(action);
    }
}

class ValueObserver {
    constructor(context, receiver) {
        this.context = context;
        this.receiver = receiver;
        this.stringMapObserver = new StringMapObserver(this.element, this);
        this.valueDescriptorMap = this.controller.valueDescriptorMap;
    }
    start() {
        this.stringMapObserver.start();
        this.invokeChangedCallbacksForDefaultValues();
    }
    stop() {
        this.stringMapObserver.stop();
    }
    get element() {
        return this.context.element;
    }
    get controller() {
        return this.context.controller;
    }
    getStringMapKeyForAttribute(attributeName) {
        if (attributeName in this.valueDescriptorMap) {
            return this.valueDescriptorMap[attributeName].name;
        }
    }
    stringMapKeyAdded(key, attributeName) {
        const descriptor = this.valueDescriptorMap[attributeName];
        if (!this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), descriptor.writer(descriptor.defaultValue));
        }
    }
    stringMapValueChanged(value, name, oldValue) {
        const descriptor = this.valueDescriptorNameMap[name];
        if (value === null)
            return;
        if (oldValue === null) {
            oldValue = descriptor.writer(descriptor.defaultValue);
        }
        this.invokeChangedCallback(name, value, oldValue);
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        const descriptor = this.valueDescriptorNameMap[key];
        if (this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), oldValue);
        }
        else {
            this.invokeChangedCallback(key, descriptor.writer(descriptor.defaultValue), oldValue);
        }
    }
    invokeChangedCallbacksForDefaultValues() {
        for (const { key, name, defaultValue, writer } of this.valueDescriptors) {
            if (defaultValue != undefined && !this.controller.data.has(key)) {
                this.invokeChangedCallback(name, writer(defaultValue), undefined);
            }
        }
    }
    invokeChangedCallback(name, rawValue, rawOldValue) {
        const changedMethodName = `${name}Changed`;
        const changedMethod = this.receiver[changedMethodName];
        if (typeof changedMethod == "function") {
            const descriptor = this.valueDescriptorNameMap[name];
            try {
                const value = descriptor.reader(rawValue);
                let oldValue = rawOldValue;
                if (rawOldValue) {
                    oldValue = descriptor.reader(rawOldValue);
                }
                changedMethod.call(this.receiver, value, oldValue);
            }
            catch (error) {
                if (error instanceof TypeError) {
                    error.message = `Stimulus Value "${this.context.identifier}.${descriptor.name}" - ${error.message}`;
                }
                throw error;
            }
        }
    }
    get valueDescriptors() {
        const { valueDescriptorMap } = this;
        return Object.keys(valueDescriptorMap).map((key) => valueDescriptorMap[key]);
    }
    get valueDescriptorNameMap() {
        const descriptors = {};
        Object.keys(this.valueDescriptorMap).forEach((key) => {
            const descriptor = this.valueDescriptorMap[key];
            descriptors[descriptor.name] = descriptor;
        });
        return descriptors;
    }
    hasValue(attributeName) {
        const descriptor = this.valueDescriptorNameMap[attributeName];
        const hasMethodName = `has${capitalize(descriptor.name)}`;
        return this.receiver[hasMethodName];
    }
}

class TargetObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.targetsByName = new Multimap();
    }
    start() {
        if (!this.tokenListObserver) {
            this.tokenListObserver = new TokenListObserver(this.element, this.attributeName, this);
            this.tokenListObserver.start();
        }
    }
    stop() {
        if (this.tokenListObserver) {
            this.disconnectAllTargets();
            this.tokenListObserver.stop();
            delete this.tokenListObserver;
        }
    }
    tokenMatched({ element, content: name }) {
        if (this.scope.containsElement(element)) {
            this.connectTarget(element, name);
        }
    }
    tokenUnmatched({ element, content: name }) {
        this.disconnectTarget(element, name);
    }
    connectTarget(element, name) {
        var _a;
        if (!this.targetsByName.has(name, element)) {
            this.targetsByName.add(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetConnected(element, name));
        }
    }
    disconnectTarget(element, name) {
        var _a;
        if (this.targetsByName.has(name, element)) {
            this.targetsByName.delete(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetDisconnected(element, name));
        }
    }
    disconnectAllTargets() {
        for (const name of this.targetsByName.keys) {
            for (const element of this.targetsByName.getValuesForKey(name)) {
                this.disconnectTarget(element, name);
            }
        }
    }
    get attributeName() {
        return `data-${this.context.identifier}-target`;
    }
    get element() {
        return this.context.element;
    }
    get scope() {
        return this.context.scope;
    }
}

function readInheritableStaticArrayValues(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return Array.from(ancestors.reduce((values, constructor) => {
        getOwnStaticArrayValues(constructor, propertyName).forEach((name) => values.add(name));
        return values;
    }, new Set()));
}
function readInheritableStaticObjectPairs(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return ancestors.reduce((pairs, constructor) => {
        pairs.push(...getOwnStaticObjectPairs(constructor, propertyName));
        return pairs;
    }, []);
}
function getAncestorsForConstructor(constructor) {
    const ancestors = [];
    while (constructor) {
        ancestors.push(constructor);
        constructor = Object.getPrototypeOf(constructor);
    }
    return ancestors.reverse();
}
function getOwnStaticArrayValues(constructor, propertyName) {
    const definition = constructor[propertyName];
    return Array.isArray(definition) ? definition : [];
}
function getOwnStaticObjectPairs(constructor, propertyName) {
    const definition = constructor[propertyName];
    return definition ? Object.keys(definition).map((key) => [key, definition[key]]) : [];
}

class OutletObserver {
    constructor(context, delegate) {
        this.started = false;
        this.context = context;
        this.delegate = delegate;
        this.outletsByName = new Multimap();
        this.outletElementsByName = new Multimap();
        this.selectorObserverMap = new Map();
        this.attributeObserverMap = new Map();
    }
    start() {
        if (!this.started) {
            this.outletDefinitions.forEach((outletName) => {
                this.setupSelectorObserverForOutlet(outletName);
                this.setupAttributeObserverForOutlet(outletName);
            });
            this.started = true;
            this.dependentContexts.forEach((context) => context.refresh());
        }
    }
    refresh() {
        this.selectorObserverMap.forEach((observer) => observer.refresh());
        this.attributeObserverMap.forEach((observer) => observer.refresh());
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.disconnectAllOutlets();
            this.stopSelectorObservers();
            this.stopAttributeObservers();
        }
    }
    stopSelectorObservers() {
        if (this.selectorObserverMap.size > 0) {
            this.selectorObserverMap.forEach((observer) => observer.stop());
            this.selectorObserverMap.clear();
        }
    }
    stopAttributeObservers() {
        if (this.attributeObserverMap.size > 0) {
            this.attributeObserverMap.forEach((observer) => observer.stop());
            this.attributeObserverMap.clear();
        }
    }
    selectorMatched(element, _selector, { outletName }) {
        const outlet = this.getOutlet(element, outletName);
        if (outlet) {
            this.connectOutlet(outlet, element, outletName);
        }
    }
    selectorUnmatched(element, _selector, { outletName }) {
        const outlet = this.getOutletFromMap(element, outletName);
        if (outlet) {
            this.disconnectOutlet(outlet, element, outletName);
        }
    }
    selectorMatchElement(element, { outletName }) {
        const selector = this.selector(outletName);
        const hasOutlet = this.hasOutlet(element, outletName);
        const hasOutletController = element.matches(`[${this.schema.controllerAttribute}~=${outletName}]`);
        if (selector) {
            return hasOutlet && hasOutletController && element.matches(selector);
        }
        else {
            return false;
        }
    }
    elementMatchedAttribute(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    elementAttributeValueChanged(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    elementUnmatchedAttribute(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    connectOutlet(outlet, element, outletName) {
        var _a;
        if (!this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.add(outletName, outlet);
            this.outletElementsByName.add(outletName, element);
            (_a = this.selectorObserverMap.get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletConnected(outlet, element, outletName));
        }
    }
    disconnectOutlet(outlet, element, outletName) {
        var _a;
        if (this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.delete(outletName, outlet);
            this.outletElementsByName.delete(outletName, element);
            (_a = this.selectorObserverMap
                .get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletDisconnected(outlet, element, outletName));
        }
    }
    disconnectAllOutlets() {
        for (const outletName of this.outletElementsByName.keys) {
            for (const element of this.outletElementsByName.getValuesForKey(outletName)) {
                for (const outlet of this.outletsByName.getValuesForKey(outletName)) {
                    this.disconnectOutlet(outlet, element, outletName);
                }
            }
        }
    }
    updateSelectorObserverForOutlet(outletName) {
        const observer = this.selectorObserverMap.get(outletName);
        if (observer) {
            observer.selector = this.selector(outletName);
        }
    }
    setupSelectorObserverForOutlet(outletName) {
        const selector = this.selector(outletName);
        const selectorObserver = new SelectorObserver(document.body, selector, this, { outletName });
        this.selectorObserverMap.set(outletName, selectorObserver);
        selectorObserver.start();
    }
    setupAttributeObserverForOutlet(outletName) {
        const attributeName = this.attributeNameForOutletName(outletName);
        const attributeObserver = new AttributeObserver(this.scope.element, attributeName, this);
        this.attributeObserverMap.set(outletName, attributeObserver);
        attributeObserver.start();
    }
    selector(outletName) {
        return this.scope.outlets.getSelectorForOutletName(outletName);
    }
    attributeNameForOutletName(outletName) {
        return this.scope.schema.outletAttributeForScope(this.identifier, outletName);
    }
    getOutletNameFromOutletAttributeName(attributeName) {
        return this.outletDefinitions.find((outletName) => this.attributeNameForOutletName(outletName) === attributeName);
    }
    get outletDependencies() {
        const dependencies = new Multimap();
        this.router.modules.forEach((module) => {
            const constructor = module.definition.controllerConstructor;
            const outlets = readInheritableStaticArrayValues(constructor, "outlets");
            outlets.forEach((outlet) => dependencies.add(outlet, module.identifier));
        });
        return dependencies;
    }
    get outletDefinitions() {
        return this.outletDependencies.getKeysForValue(this.identifier);
    }
    get dependentControllerIdentifiers() {
        return this.outletDependencies.getValuesForKey(this.identifier);
    }
    get dependentContexts() {
        const identifiers = this.dependentControllerIdentifiers;
        return this.router.contexts.filter((context) => identifiers.includes(context.identifier));
    }
    hasOutlet(element, outletName) {
        return !!this.getOutlet(element, outletName) || !!this.getOutletFromMap(element, outletName);
    }
    getOutlet(element, outletName) {
        return this.application.getControllerForElementAndIdentifier(element, outletName);
    }
    getOutletFromMap(element, outletName) {
        return this.outletsByName.getValuesForKey(outletName).find((outlet) => outlet.element === element);
    }
    get scope() {
        return this.context.scope;
    }
    get schema() {
        return this.context.schema;
    }
    get identifier() {
        return this.context.identifier;
    }
    get application() {
        return this.context.application;
    }
    get router() {
        return this.application.router;
    }
}

class Context {
    constructor(module, scope) {
        this.logDebugActivity = (functionName, detail = {}) => {
            const { identifier, controller, element } = this;
            detail = Object.assign({ identifier, controller, element }, detail);
            this.application.logDebugActivity(this.identifier, functionName, detail);
        };
        this.module = module;
        this.scope = scope;
        this.controller = new module.controllerConstructor(this);
        this.bindingObserver = new BindingObserver(this, this.dispatcher);
        this.valueObserver = new ValueObserver(this, this.controller);
        this.targetObserver = new TargetObserver(this, this);
        this.outletObserver = new OutletObserver(this, this);
        try {
            this.controller.initialize();
            this.logDebugActivity("initialize");
        }
        catch (error) {
            this.handleError(error, "initializing controller");
        }
    }
    connect() {
        this.bindingObserver.start();
        this.valueObserver.start();
        this.targetObserver.start();
        this.outletObserver.start();
        try {
            this.controller.connect();
            this.logDebugActivity("connect");
        }
        catch (error) {
            this.handleError(error, "connecting controller");
        }
    }
    refresh() {
        this.outletObserver.refresh();
    }
    disconnect() {
        try {
            this.controller.disconnect();
            this.logDebugActivity("disconnect");
        }
        catch (error) {
            this.handleError(error, "disconnecting controller");
        }
        this.outletObserver.stop();
        this.targetObserver.stop();
        this.valueObserver.stop();
        this.bindingObserver.stop();
    }
    get application() {
        return this.module.application;
    }
    get identifier() {
        return this.module.identifier;
    }
    get schema() {
        return this.application.schema;
    }
    get dispatcher() {
        return this.application.dispatcher;
    }
    get element() {
        return this.scope.element;
    }
    get parentElement() {
        return this.element.parentElement;
    }
    handleError(error, message, detail = {}) {
        const { identifier, controller, element } = this;
        detail = Object.assign({ identifier, controller, element }, detail);
        this.application.handleError(error, `Error ${message}`, detail);
    }
    targetConnected(element, name) {
        this.invokeControllerMethod(`${name}TargetConnected`, element);
    }
    targetDisconnected(element, name) {
        this.invokeControllerMethod(`${name}TargetDisconnected`, element);
    }
    outletConnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletConnected`, outlet, element);
    }
    outletDisconnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletDisconnected`, outlet, element);
    }
    invokeControllerMethod(methodName, ...args) {
        const controller = this.controller;
        if (typeof controller[methodName] == "function") {
            controller[methodName](...args);
        }
    }
}

function bless(constructor) {
    return shadow(constructor, getBlessedProperties(constructor));
}
function shadow(constructor, properties) {
    const shadowConstructor = extend(constructor);
    const shadowProperties = getShadowProperties(constructor.prototype, properties);
    Object.defineProperties(shadowConstructor.prototype, shadowProperties);
    return shadowConstructor;
}
function getBlessedProperties(constructor) {
    const blessings = readInheritableStaticArrayValues(constructor, "blessings");
    return blessings.reduce((blessedProperties, blessing) => {
        const properties = blessing(constructor);
        for (const key in properties) {
            const descriptor = blessedProperties[key] || {};
            blessedProperties[key] = Object.assign(descriptor, properties[key]);
        }
        return blessedProperties;
    }, {});
}
function getShadowProperties(prototype, properties) {
    return getOwnKeys(properties).reduce((shadowProperties, key) => {
        const descriptor = getShadowedDescriptor(prototype, properties, key);
        if (descriptor) {
            Object.assign(shadowProperties, { [key]: descriptor });
        }
        return shadowProperties;
    }, {});
}
function getShadowedDescriptor(prototype, properties, key) {
    const shadowingDescriptor = Object.getOwnPropertyDescriptor(prototype, key);
    const shadowedByValue = shadowingDescriptor && "value" in shadowingDescriptor;
    if (!shadowedByValue) {
        const descriptor = Object.getOwnPropertyDescriptor(properties, key).value;
        if (shadowingDescriptor) {
            descriptor.get = shadowingDescriptor.get || descriptor.get;
            descriptor.set = shadowingDescriptor.set || descriptor.set;
        }
        return descriptor;
    }
}
const getOwnKeys = (() => {
    if (typeof Object.getOwnPropertySymbols == "function") {
        return (object) => [...Object.getOwnPropertyNames(object), ...Object.getOwnPropertySymbols(object)];
    }
    else {
        return Object.getOwnPropertyNames;
    }
})();
const extend = (() => {
    function extendWithReflect(constructor) {
        function extended() {
            return Reflect.construct(constructor, arguments, new.target);
        }
        extended.prototype = Object.create(constructor.prototype, {
            constructor: { value: extended },
        });
        Reflect.setPrototypeOf(extended, constructor);
        return extended;
    }
    function testReflectExtension() {
        const a = function () {
            this.a.call(this);
        };
        const b = extendWithReflect(a);
        b.prototype.a = function () { };
        return new b();
    }
    try {
        testReflectExtension();
        return extendWithReflect;
    }
    catch (error) {
        return (constructor) => class extended extends constructor {
        };
    }
})();

function blessDefinition(definition) {
    return {
        identifier: definition.identifier,
        controllerConstructor: bless(definition.controllerConstructor),
    };
}

class Module {
    constructor(application, definition) {
        this.application = application;
        this.definition = blessDefinition(definition);
        this.contextsByScope = new WeakMap();
        this.connectedContexts = new Set();
    }
    get identifier() {
        return this.definition.identifier;
    }
    get controllerConstructor() {
        return this.definition.controllerConstructor;
    }
    get contexts() {
        return Array.from(this.connectedContexts);
    }
    connectContextForScope(scope) {
        const context = this.fetchContextForScope(scope);
        this.connectedContexts.add(context);
        context.connect();
    }
    disconnectContextForScope(scope) {
        const context = this.contextsByScope.get(scope);
        if (context) {
            this.connectedContexts.delete(context);
            context.disconnect();
        }
    }
    fetchContextForScope(scope) {
        let context = this.contextsByScope.get(scope);
        if (!context) {
            context = new Context(this, scope);
            this.contextsByScope.set(scope, context);
        }
        return context;
    }
}

class ClassMap {
    constructor(scope) {
        this.scope = scope;
    }
    has(name) {
        return this.data.has(this.getDataKey(name));
    }
    get(name) {
        return this.getAll(name)[0];
    }
    getAll(name) {
        const tokenString = this.data.get(this.getDataKey(name)) || "";
        return tokenize(tokenString);
    }
    getAttributeName(name) {
        return this.data.getAttributeNameForKey(this.getDataKey(name));
    }
    getDataKey(name) {
        return `${name}-class`;
    }
    get data() {
        return this.scope.data;
    }
}

class DataMap {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.getAttribute(name);
    }
    set(key, value) {
        const name = this.getAttributeNameForKey(key);
        this.element.setAttribute(name, value);
        return this.get(key);
    }
    has(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.hasAttribute(name);
    }
    delete(key) {
        if (this.has(key)) {
            const name = this.getAttributeNameForKey(key);
            this.element.removeAttribute(name);
            return true;
        }
        else {
            return false;
        }
    }
    getAttributeNameForKey(key) {
        return `data-${this.identifier}-${dasherize(key)}`;
    }
}

class Guide {
    constructor(logger) {
        this.warnedKeysByObject = new WeakMap();
        this.logger = logger;
    }
    warn(object, key, message) {
        let warnedKeys = this.warnedKeysByObject.get(object);
        if (!warnedKeys) {
            warnedKeys = new Set();
            this.warnedKeysByObject.set(object, warnedKeys);
        }
        if (!warnedKeys.has(key)) {
            warnedKeys.add(key);
            this.logger.warn(message, object);
        }
    }
}

function attributeValueContainsToken(attributeName, token) {
    return `[${attributeName}~="${token}"]`;
}

class TargetSet {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(targetName) {
        return this.find(targetName) != null;
    }
    find(...targetNames) {
        return targetNames.reduce((target, targetName) => target || this.findTarget(targetName) || this.findLegacyTarget(targetName), undefined);
    }
    findAll(...targetNames) {
        return targetNames.reduce((targets, targetName) => [
            ...targets,
            ...this.findAllTargets(targetName),
            ...this.findAllLegacyTargets(targetName),
        ], []);
    }
    findTarget(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findElement(selector);
    }
    findAllTargets(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findAllElements(selector);
    }
    getSelectorForTargetName(targetName) {
        const attributeName = this.schema.targetAttributeForScope(this.identifier);
        return attributeValueContainsToken(attributeName, targetName);
    }
    findLegacyTarget(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.deprecate(this.scope.findElement(selector), targetName);
    }
    findAllLegacyTargets(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.scope.findAllElements(selector).map((element) => this.deprecate(element, targetName));
    }
    getLegacySelectorForTargetName(targetName) {
        const targetDescriptor = `${this.identifier}.${targetName}`;
        return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor);
    }
    deprecate(element, targetName) {
        if (element) {
            const { identifier } = this;
            const attributeName = this.schema.targetAttribute;
            const revisedAttributeName = this.schema.targetAttributeForScope(identifier);
            this.guide.warn(element, `target:${targetName}`, `Please replace ${attributeName}="${identifier}.${targetName}" with ${revisedAttributeName}="${targetName}". ` +
                `The ${attributeName} attribute is deprecated and will be removed in a future version of Stimulus.`);
        }
        return element;
    }
    get guide() {
        return this.scope.guide;
    }
}

class OutletSet {
    constructor(scope, controllerElement) {
        this.scope = scope;
        this.controllerElement = controllerElement;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(outletName) {
        return this.find(outletName) != null;
    }
    find(...outletNames) {
        return outletNames.reduce((outlet, outletName) => outlet || this.findOutlet(outletName), undefined);
    }
    findAll(...outletNames) {
        return outletNames.reduce((outlets, outletName) => [...outlets, ...this.findAllOutlets(outletName)], []);
    }
    getSelectorForOutletName(outletName) {
        const attributeName = this.schema.outletAttributeForScope(this.identifier, outletName);
        return this.controllerElement.getAttribute(attributeName);
    }
    findOutlet(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        if (selector)
            return this.findElement(selector, outletName);
    }
    findAllOutlets(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        return selector ? this.findAllElements(selector, outletName) : [];
    }
    findElement(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName))[0];
    }
    findAllElements(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName));
    }
    matchesElement(element, selector, outletName) {
        const controllerAttribute = element.getAttribute(this.scope.schema.controllerAttribute) || "";
        return element.matches(selector) && controllerAttribute.split(" ").includes(outletName);
    }
}

class Scope {
    constructor(schema, element, identifier, logger) {
        this.targets = new TargetSet(this);
        this.classes = new ClassMap(this);
        this.data = new DataMap(this);
        this.containsElement = (element) => {
            return element.closest(this.controllerSelector) === this.element;
        };
        this.schema = schema;
        this.element = element;
        this.identifier = identifier;
        this.guide = new Guide(logger);
        this.outlets = new OutletSet(this.documentScope, element);
    }
    findElement(selector) {
        return this.element.matches(selector) ? this.element : this.queryElements(selector).find(this.containsElement);
    }
    findAllElements(selector) {
        return [
            ...(this.element.matches(selector) ? [this.element] : []),
            ...this.queryElements(selector).filter(this.containsElement),
        ];
    }
    queryElements(selector) {
        return Array.from(this.element.querySelectorAll(selector));
    }
    get controllerSelector() {
        return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier);
    }
    get isDocumentScope() {
        return this.element === document.documentElement;
    }
    get documentScope() {
        return this.isDocumentScope
            ? this
            : new Scope(this.schema, document.documentElement, this.identifier, this.guide.logger);
    }
}

class ScopeObserver {
    constructor(element, schema, delegate) {
        this.element = element;
        this.schema = schema;
        this.delegate = delegate;
        this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this);
        this.scopesByIdentifierByElement = new WeakMap();
        this.scopeReferenceCounts = new WeakMap();
    }
    start() {
        this.valueListObserver.start();
    }
    stop() {
        this.valueListObserver.stop();
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    parseValueForToken(token) {
        const { element, content: identifier } = token;
        return this.parseValueForElementAndIdentifier(element, identifier);
    }
    parseValueForElementAndIdentifier(element, identifier) {
        const scopesByIdentifier = this.fetchScopesByIdentifierForElement(element);
        let scope = scopesByIdentifier.get(identifier);
        if (!scope) {
            scope = this.delegate.createScopeForElementAndIdentifier(element, identifier);
            scopesByIdentifier.set(identifier, scope);
        }
        return scope;
    }
    elementMatchedValue(element, value) {
        const referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1;
        this.scopeReferenceCounts.set(value, referenceCount);
        if (referenceCount == 1) {
            this.delegate.scopeConnected(value);
        }
    }
    elementUnmatchedValue(element, value) {
        const referenceCount = this.scopeReferenceCounts.get(value);
        if (referenceCount) {
            this.scopeReferenceCounts.set(value, referenceCount - 1);
            if (referenceCount == 1) {
                this.delegate.scopeDisconnected(value);
            }
        }
    }
    fetchScopesByIdentifierForElement(element) {
        let scopesByIdentifier = this.scopesByIdentifierByElement.get(element);
        if (!scopesByIdentifier) {
            scopesByIdentifier = new Map();
            this.scopesByIdentifierByElement.set(element, scopesByIdentifier);
        }
        return scopesByIdentifier;
    }
}

class Router {
    constructor(application) {
        this.application = application;
        this.scopeObserver = new ScopeObserver(this.element, this.schema, this);
        this.scopesByIdentifier = new Multimap();
        this.modulesByIdentifier = new Map();
    }
    get element() {
        return this.application.element;
    }
    get schema() {
        return this.application.schema;
    }
    get logger() {
        return this.application.logger;
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    get modules() {
        return Array.from(this.modulesByIdentifier.values());
    }
    get contexts() {
        return this.modules.reduce((contexts, module) => contexts.concat(module.contexts), []);
    }
    start() {
        this.scopeObserver.start();
    }
    stop() {
        this.scopeObserver.stop();
    }
    loadDefinition(definition) {
        this.unloadIdentifier(definition.identifier);
        const module = new Module(this.application, definition);
        this.connectModule(module);
        const afterLoad = definition.controllerConstructor.afterLoad;
        if (afterLoad) {
            afterLoad.call(definition.controllerConstructor, definition.identifier, this.application);
        }
    }
    unloadIdentifier(identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            this.disconnectModule(module);
        }
    }
    getContextForElementAndIdentifier(element, identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            return module.contexts.find((context) => context.element == element);
        }
    }
    proposeToConnectScopeForElementAndIdentifier(element, identifier) {
        const scope = this.scopeObserver.parseValueForElementAndIdentifier(element, identifier);
        if (scope) {
            this.scopeObserver.elementMatchedValue(scope.element, scope);
        }
        else {
            console.error(`Couldn't find or create scope for identifier: "${identifier}" and element:`, element);
        }
    }
    handleError(error, message, detail) {
        this.application.handleError(error, message, detail);
    }
    createScopeForElementAndIdentifier(element, identifier) {
        return new Scope(this.schema, element, identifier, this.logger);
    }
    scopeConnected(scope) {
        this.scopesByIdentifier.add(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.connectContextForScope(scope);
        }
    }
    scopeDisconnected(scope) {
        this.scopesByIdentifier.delete(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.disconnectContextForScope(scope);
        }
    }
    connectModule(module) {
        this.modulesByIdentifier.set(module.identifier, module);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.connectContextForScope(scope));
    }
    disconnectModule(module) {
        this.modulesByIdentifier.delete(module.identifier);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.disconnectContextForScope(scope));
    }
}

const defaultSchema = {
    controllerAttribute: "data-controller",
    actionAttribute: "data-action",
    targetAttribute: "data-target",
    targetAttributeForScope: (identifier) => `data-${identifier}-target`,
    outletAttributeForScope: (identifier, outlet) => `data-${identifier}-${outlet}-outlet`,
    keyMappings: Object.assign(Object.assign({ enter: "Enter", tab: "Tab", esc: "Escape", space: " ", up: "ArrowUp", down: "ArrowDown", left: "ArrowLeft", right: "ArrowRight", home: "Home", end: "End", page_up: "PageUp", page_down: "PageDown" }, objectFromEntries("abcdefghijklmnopqrstuvwxyz".split("").map((c) => [c, c]))), objectFromEntries("0123456789".split("").map((n) => [n, n]))),
};
function objectFromEntries(array) {
    return array.reduce((memo, [k, v]) => (Object.assign(Object.assign({}, memo), { [k]: v })), {});
}

class Application {
    constructor(element = document.documentElement, schema = defaultSchema) {
        this.logger = console;
        this.debug = false;
        this.logDebugActivity = (identifier, functionName, detail = {}) => {
            if (this.debug) {
                this.logFormattedMessage(identifier, functionName, detail);
            }
        };
        this.element = element;
        this.schema = schema;
        this.dispatcher = new Dispatcher(this);
        this.router = new Router(this);
        this.actionDescriptorFilters = Object.assign({}, defaultActionDescriptorFilters);
    }
    static start(element, schema) {
        const application = new this(element, schema);
        application.start();
        return application;
    }
    async start() {
        await domReady();
        this.logDebugActivity("application", "starting");
        this.dispatcher.start();
        this.router.start();
        this.logDebugActivity("application", "start");
    }
    stop() {
        this.logDebugActivity("application", "stopping");
        this.dispatcher.stop();
        this.router.stop();
        this.logDebugActivity("application", "stop");
    }
    register(identifier, controllerConstructor) {
        this.load({ identifier, controllerConstructor });
    }
    registerActionOption(name, filter) {
        this.actionDescriptorFilters[name] = filter;
    }
    load(head, ...rest) {
        const definitions = Array.isArray(head) ? head : [head, ...rest];
        definitions.forEach((definition) => {
            if (definition.controllerConstructor.shouldLoad) {
                this.router.loadDefinition(definition);
            }
        });
    }
    unload(head, ...rest) {
        const identifiers = Array.isArray(head) ? head : [head, ...rest];
        identifiers.forEach((identifier) => this.router.unloadIdentifier(identifier));
    }
    get controllers() {
        return this.router.contexts.map((context) => context.controller);
    }
    getControllerForElementAndIdentifier(element, identifier) {
        const context = this.router.getContextForElementAndIdentifier(element, identifier);
        return context ? context.controller : null;
    }
    handleError(error, message, detail) {
        var _a;
        this.logger.error(`%s\n\n%o\n\n%o`, message, error, detail);
        (_a = window.onerror) === null || _a === void 0 ? void 0 : _a.call(window, message, "", 0, 0, error);
    }
    logFormattedMessage(identifier, functionName, detail = {}) {
        detail = Object.assign({ application: this }, detail);
        this.logger.groupCollapsed(`${identifier} #${functionName}`);
        this.logger.log("details:", Object.assign({}, detail));
        this.logger.groupEnd();
    }
}
function domReady() {
    return new Promise((resolve) => {
        if (document.readyState == "loading") {
            document.addEventListener("DOMContentLoaded", () => resolve());
        }
        else {
            resolve();
        }
    });
}

function ClassPropertiesBlessing(constructor) {
    const classes = readInheritableStaticArrayValues(constructor, "classes");
    return classes.reduce((properties, classDefinition) => {
        return Object.assign(properties, propertiesForClassDefinition(classDefinition));
    }, {});
}
function propertiesForClassDefinition(key) {
    return {
        [`${key}Class`]: {
            get() {
                const { classes } = this;
                if (classes.has(key)) {
                    return classes.get(key);
                }
                else {
                    const attribute = classes.getAttributeName(key);
                    throw new Error(`Missing attribute "${attribute}"`);
                }
            },
        },
        [`${key}Classes`]: {
            get() {
                return this.classes.getAll(key);
            },
        },
        [`has${capitalize(key)}Class`]: {
            get() {
                return this.classes.has(key);
            },
        },
    };
}

function OutletPropertiesBlessing(constructor) {
    const outlets = readInheritableStaticArrayValues(constructor, "outlets");
    return outlets.reduce((properties, outletDefinition) => {
        return Object.assign(properties, propertiesForOutletDefinition(outletDefinition));
    }, {});
}
function getOutletController(controller, element, identifier) {
    return controller.application.getControllerForElementAndIdentifier(element, identifier);
}
function getControllerAndEnsureConnectedScope(controller, element, outletName) {
    let outletController = getOutletController(controller, element, outletName);
    if (outletController)
        return outletController;
    controller.application.router.proposeToConnectScopeForElementAndIdentifier(element, outletName);
    outletController = getOutletController(controller, element, outletName);
    if (outletController)
        return outletController;
}
function propertiesForOutletDefinition(name) {
    const camelizedName = namespaceCamelize(name);
    return {
        [`${camelizedName}Outlet`]: {
            get() {
                const outletElement = this.outlets.find(name);
                const selector = this.outlets.getSelectorForOutletName(name);
                if (outletElement) {
                    const outletController = getControllerAndEnsureConnectedScope(this, outletElement, name);
                    if (outletController)
                        return outletController;
                    throw new Error(`The provided outlet element is missing an outlet controller "${name}" instance for host controller "${this.identifier}"`);
                }
                throw new Error(`Missing outlet element "${name}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${selector}".`);
            },
        },
        [`${camelizedName}Outlets`]: {
            get() {
                const outlets = this.outlets.findAll(name);
                if (outlets.length > 0) {
                    return outlets
                        .map((outletElement) => {
                        const outletController = getControllerAndEnsureConnectedScope(this, outletElement, name);
                        if (outletController)
                            return outletController;
                        console.warn(`The provided outlet element is missing an outlet controller "${name}" instance for host controller "${this.identifier}"`, outletElement);
                    })
                        .filter((controller) => controller);
                }
                return [];
            },
        },
        [`${camelizedName}OutletElement`]: {
            get() {
                const outletElement = this.outlets.find(name);
                const selector = this.outlets.getSelectorForOutletName(name);
                if (outletElement) {
                    return outletElement;
                }
                else {
                    throw new Error(`Missing outlet element "${name}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${selector}".`);
                }
            },
        },
        [`${camelizedName}OutletElements`]: {
            get() {
                return this.outlets.findAll(name);
            },
        },
        [`has${capitalize(camelizedName)}Outlet`]: {
            get() {
                return this.outlets.has(name);
            },
        },
    };
}

function TargetPropertiesBlessing(constructor) {
    const targets = readInheritableStaticArrayValues(constructor, "targets");
    return targets.reduce((properties, targetDefinition) => {
        return Object.assign(properties, propertiesForTargetDefinition(targetDefinition));
    }, {});
}
function propertiesForTargetDefinition(name) {
    return {
        [`${name}Target`]: {
            get() {
                const target = this.targets.find(name);
                if (target) {
                    return target;
                }
                else {
                    throw new Error(`Missing target element "${name}" for "${this.identifier}" controller`);
                }
            },
        },
        [`${name}Targets`]: {
            get() {
                return this.targets.findAll(name);
            },
        },
        [`has${capitalize(name)}Target`]: {
            get() {
                return this.targets.has(name);
            },
        },
    };
}

function ValuePropertiesBlessing(constructor) {
    const valueDefinitionPairs = readInheritableStaticObjectPairs(constructor, "values");
    const propertyDescriptorMap = {
        valueDescriptorMap: {
            get() {
                return valueDefinitionPairs.reduce((result, valueDefinitionPair) => {
                    const valueDescriptor = parseValueDefinitionPair(valueDefinitionPair, this.identifier);
                    const attributeName = this.data.getAttributeNameForKey(valueDescriptor.key);
                    return Object.assign(result, { [attributeName]: valueDescriptor });
                }, {});
            },
        },
    };
    return valueDefinitionPairs.reduce((properties, valueDefinitionPair) => {
        return Object.assign(properties, propertiesForValueDefinitionPair(valueDefinitionPair));
    }, propertyDescriptorMap);
}
function propertiesForValueDefinitionPair(valueDefinitionPair, controller) {
    const definition = parseValueDefinitionPair(valueDefinitionPair, controller);
    const { key, name, reader: read, writer: write } = definition;
    return {
        [name]: {
            get() {
                const value = this.data.get(key);
                if (value !== null) {
                    return read(value);
                }
                else {
                    return definition.defaultValue;
                }
            },
            set(value) {
                if (value === undefined) {
                    this.data.delete(key);
                }
                else {
                    this.data.set(key, write(value));
                }
            },
        },
        [`has${capitalize(name)}`]: {
            get() {
                return this.data.has(key) || definition.hasCustomDefaultValue;
            },
        },
    };
}
function parseValueDefinitionPair([token, typeDefinition], controller) {
    return valueDescriptorForTokenAndTypeDefinition({
        controller,
        token,
        typeDefinition,
    });
}
function parseValueTypeConstant(constant) {
    switch (constant) {
        case Array:
            return "array";
        case Boolean:
            return "boolean";
        case Number:
            return "number";
        case Object:
            return "object";
        case String:
            return "string";
    }
}
function parseValueTypeDefault(defaultValue) {
    switch (typeof defaultValue) {
        case "boolean":
            return "boolean";
        case "number":
            return "number";
        case "string":
            return "string";
    }
    if (Array.isArray(defaultValue))
        return "array";
    if (Object.prototype.toString.call(defaultValue) === "[object Object]")
        return "object";
}
function parseValueTypeObject(payload) {
    const { controller, token, typeObject } = payload;
    const hasType = isSomething(typeObject.type);
    const hasDefault = isSomething(typeObject.default);
    const fullObject = hasType && hasDefault;
    const onlyType = hasType && !hasDefault;
    const onlyDefault = !hasType && hasDefault;
    const typeFromObject = parseValueTypeConstant(typeObject.type);
    const typeFromDefaultValue = parseValueTypeDefault(payload.typeObject.default);
    if (onlyType)
        return typeFromObject;
    if (onlyDefault)
        return typeFromDefaultValue;
    if (typeFromObject !== typeFromDefaultValue) {
        const propertyPath = controller ? `${controller}.${token}` : token;
        throw new Error(`The specified default value for the Stimulus Value "${propertyPath}" must match the defined type "${typeFromObject}". The provided default value of "${typeObject.default}" is of type "${typeFromDefaultValue}".`);
    }
    if (fullObject)
        return typeFromObject;
}
function parseValueTypeDefinition(payload) {
    const { controller, token, typeDefinition } = payload;
    const typeObject = { controller, token, typeObject: typeDefinition };
    const typeFromObject = parseValueTypeObject(typeObject);
    const typeFromDefaultValue = parseValueTypeDefault(typeDefinition);
    const typeFromConstant = parseValueTypeConstant(typeDefinition);
    const type = typeFromObject || typeFromDefaultValue || typeFromConstant;
    if (type)
        return type;
    const propertyPath = controller ? `${controller}.${typeDefinition}` : token;
    throw new Error(`Unknown value type "${propertyPath}" for "${token}" value`);
}
function defaultValueForDefinition(typeDefinition) {
    const constant = parseValueTypeConstant(typeDefinition);
    if (constant)
        return defaultValuesByType[constant];
    const hasDefault = hasProperty(typeDefinition, "default");
    const hasType = hasProperty(typeDefinition, "type");
    const typeObject = typeDefinition;
    if (hasDefault)
        return typeObject.default;
    if (hasType) {
        const { type } = typeObject;
        const constantFromType = parseValueTypeConstant(type);
        if (constantFromType)
            return defaultValuesByType[constantFromType];
    }
    return typeDefinition;
}
function valueDescriptorForTokenAndTypeDefinition(payload) {
    const { token, typeDefinition } = payload;
    const key = `${dasherize(token)}-value`;
    const type = parseValueTypeDefinition(payload);
    return {
        type,
        key,
        name: camelize(key),
        get defaultValue() {
            return defaultValueForDefinition(typeDefinition);
        },
        get hasCustomDefaultValue() {
            return parseValueTypeDefault(typeDefinition) !== undefined;
        },
        reader: readers[type],
        writer: writers[type] || writers.default,
    };
}
const defaultValuesByType = {
    get array() {
        return [];
    },
    boolean: false,
    number: 0,
    get object() {
        return {};
    },
    string: "",
};
const readers = {
    array(value) {
        const array = JSON.parse(value);
        if (!Array.isArray(array)) {
            throw new TypeError(`expected value of type "array" but instead got value "${value}" of type "${parseValueTypeDefault(array)}"`);
        }
        return array;
    },
    boolean(value) {
        return !(value == "0" || String(value).toLowerCase() == "false");
    },
    number(value) {
        return Number(value.replace(/_/g, ""));
    },
    object(value) {
        const object = JSON.parse(value);
        if (object === null || typeof object != "object" || Array.isArray(object)) {
            throw new TypeError(`expected value of type "object" but instead got value "${value}" of type "${parseValueTypeDefault(object)}"`);
        }
        return object;
    },
    string(value) {
        return value;
    },
};
const writers = {
    default: writeString,
    array: writeJSON,
    object: writeJSON,
};
function writeJSON(value) {
    return JSON.stringify(value);
}
function writeString(value) {
    return `${value}`;
}

class Controller {
    constructor(context) {
        this.context = context;
    }
    static get shouldLoad() {
        return true;
    }
    static afterLoad(_identifier, _application) {
        return;
    }
    get application() {
        return this.context.application;
    }
    get scope() {
        return this.context.scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get targets() {
        return this.scope.targets;
    }
    get outlets() {
        return this.scope.outlets;
    }
    get classes() {
        return this.scope.classes;
    }
    get data() {
        return this.scope.data;
    }
    initialize() {
    }
    connect() {
    }
    disconnect() {
    }
    dispatch(eventName, { target = this.element, detail = {}, prefix = this.identifier, bubbles = true, cancelable = true, } = {}) {
        const type = prefix ? `${prefix}:${eventName}` : eventName;
        const event = new CustomEvent(type, { detail, bubbles, cancelable });
        target.dispatchEvent(event);
        return event;
    }
}
Controller.blessings = [
    ClassPropertiesBlessing,
    TargetPropertiesBlessing,
    ValuePropertiesBlessing,
    OutletPropertiesBlessing,
];
Controller.targets = [];
Controller.outlets = [];
Controller.values = {};




/***/ }),

/***/ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js":
/*!***************************************************************!*\
  !*** ./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FetchEnctype: function() { return /* binding */ FetchEnctype; },
/* harmony export */   FetchMethod: function() { return /* binding */ FetchMethod; },
/* harmony export */   FetchRequest: function() { return /* binding */ FetchRequest; },
/* harmony export */   FetchResponse: function() { return /* binding */ FetchResponse; },
/* harmony export */   FrameElement: function() { return /* binding */ FrameElement; },
/* harmony export */   FrameLoadingStyle: function() { return /* binding */ FrameLoadingStyle; },
/* harmony export */   FrameRenderer: function() { return /* binding */ FrameRenderer; },
/* harmony export */   PageRenderer: function() { return /* binding */ PageRenderer; },
/* harmony export */   PageSnapshot: function() { return /* binding */ PageSnapshot; },
/* harmony export */   StreamActions: function() { return /* binding */ StreamActions; },
/* harmony export */   StreamElement: function() { return /* binding */ StreamElement; },
/* harmony export */   StreamSourceElement: function() { return /* binding */ StreamSourceElement; },
/* harmony export */   cache: function() { return /* binding */ cache; },
/* harmony export */   clearCache: function() { return /* binding */ clearCache; },
/* harmony export */   config: function() { return /* binding */ config; },
/* harmony export */   connectStreamSource: function() { return /* binding */ connectStreamSource; },
/* harmony export */   disconnectStreamSource: function() { return /* binding */ disconnectStreamSource; },
/* harmony export */   fetch: function() { return /* binding */ fetchWithTurboHeaders; },
/* harmony export */   fetchEnctypeFromString: function() { return /* binding */ fetchEnctypeFromString; },
/* harmony export */   fetchMethodFromString: function() { return /* binding */ fetchMethodFromString; },
/* harmony export */   isSafe: function() { return /* binding */ isSafe; },
/* harmony export */   navigator: function() { return /* binding */ navigator$1; },
/* harmony export */   registerAdapter: function() { return /* binding */ registerAdapter; },
/* harmony export */   renderStreamMessage: function() { return /* binding */ renderStreamMessage; },
/* harmony export */   session: function() { return /* binding */ session; },
/* harmony export */   setConfirmMethod: function() { return /* binding */ setConfirmMethod; },
/* harmony export */   setFormMode: function() { return /* binding */ setFormMode; },
/* harmony export */   setProgressBarDelay: function() { return /* binding */ setProgressBarDelay; },
/* harmony export */   start: function() { return /* binding */ start; },
/* harmony export */   visit: function() { return /* binding */ visit; }
/* harmony export */ });
/*!
Turbo 8.0.12
Copyright © 2024 37signals LLC
 */
/**
 * The MIT License (MIT)
 *
 * Copyright (c) 2019 Javan Makhmali
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

(function (prototype) {
  if (typeof prototype.requestSubmit == "function") return

  prototype.requestSubmit = function (submitter) {
    if (submitter) {
      validateSubmitter(submitter, this);
      submitter.click();
    } else {
      submitter = document.createElement("input");
      submitter.type = "submit";
      submitter.hidden = true;
      this.appendChild(submitter);
      submitter.click();
      this.removeChild(submitter);
    }
  };

  function validateSubmitter(submitter, form) {
    submitter instanceof HTMLElement || raise(TypeError, "parameter 1 is not of type 'HTMLElement'");
    submitter.type == "submit" || raise(TypeError, "The specified element is not a submit button");
    submitter.form == form ||
      raise(DOMException, "The specified element is not owned by this form element", "NotFoundError");
  }

  function raise(errorConstructor, message, name) {
    throw new errorConstructor("Failed to execute 'requestSubmit' on 'HTMLFormElement': " + message + ".", name)
  }
})(HTMLFormElement.prototype);

const submittersByForm = new WeakMap();

function findSubmitterFromClickTarget(target) {
  const element = target instanceof Element ? target : target instanceof Node ? target.parentElement : null;
  const candidate = element ? element.closest("input, button") : null;
  return candidate?.type == "submit" ? candidate : null
}

function clickCaptured(event) {
  const submitter = findSubmitterFromClickTarget(event.target);

  if (submitter && submitter.form) {
    submittersByForm.set(submitter.form, submitter);
  }
}

(function () {
  if ("submitter" in Event.prototype) return

  let prototype = window.Event.prototype;
  // Certain versions of Safari 15 have a bug where they won't
  // populate the submitter. This hurts TurboDrive's enable/disable detection.
  // See https://bugs.webkit.org/show_bug.cgi?id=229660
  if ("SubmitEvent" in window) {
    const prototypeOfSubmitEvent = window.SubmitEvent.prototype;

    if (/Apple Computer/.test(navigator.vendor) && !("submitter" in prototypeOfSubmitEvent)) {
      prototype = prototypeOfSubmitEvent;
    } else {
      return // polyfill not needed
    }
  }

  addEventListener("click", clickCaptured, true);

  Object.defineProperty(prototype, "submitter", {
    get() {
      if (this.type == "submit" && this.target instanceof HTMLFormElement) {
        return submittersByForm.get(this.target)
      }
    }
  });
})();

const FrameLoadingStyle = {
  eager: "eager",
  lazy: "lazy"
};

/**
 * Contains a fragment of HTML which is updated based on navigation within
 * it (e.g. via links or form submissions).
 *
 * @customElement turbo-frame
 * @example
 *   <turbo-frame id="messages">
 *     <a href="/messages/expanded">
 *       Show all expanded messages in this frame.
 *     </a>
 *
 *     <form action="/messages">
 *       Show response from this form within this frame.
 *     </form>
 *   </turbo-frame>
 */
class FrameElement extends HTMLElement {
  static delegateConstructor = undefined

  loaded = Promise.resolve()

  static get observedAttributes() {
    return ["disabled", "loading", "src"]
  }

  constructor() {
    super();
    this.delegate = new FrameElement.delegateConstructor(this);
  }

  connectedCallback() {
    this.delegate.connect();
  }

  disconnectedCallback() {
    this.delegate.disconnect();
  }

  reload() {
    return this.delegate.sourceURLReloaded()
  }

  attributeChangedCallback(name) {
    if (name == "loading") {
      this.delegate.loadingStyleChanged();
    } else if (name == "src") {
      this.delegate.sourceURLChanged();
    } else if (name == "disabled") {
      this.delegate.disabledChanged();
    }
  }

  /**
   * Gets the URL to lazily load source HTML from
   */
  get src() {
    return this.getAttribute("src")
  }

  /**
   * Sets the URL to lazily load source HTML from
   */
  set src(value) {
    if (value) {
      this.setAttribute("src", value);
    } else {
      this.removeAttribute("src");
    }
  }

  /**
   * Gets the refresh mode for the frame.
   */
  get refresh() {
    return this.getAttribute("refresh")
  }

  /**
   * Sets the refresh mode for the frame.
   */
  set refresh(value) {
    if (value) {
      this.setAttribute("refresh", value);
    } else {
      this.removeAttribute("refresh");
    }
  }

  get shouldReloadWithMorph() {
    return this.src && this.refresh === "morph"
  }

  /**
   * Determines if the element is loading
   */
  get loading() {
    return frameLoadingStyleFromString(this.getAttribute("loading") || "")
  }

  /**
   * Sets the value of if the element is loading
   */
  set loading(value) {
    if (value) {
      this.setAttribute("loading", value);
    } else {
      this.removeAttribute("loading");
    }
  }

  /**
   * Gets the disabled state of the frame.
   *
   * If disabled, no requests will be intercepted by the frame.
   */
  get disabled() {
    return this.hasAttribute("disabled")
  }

  /**
   * Sets the disabled state of the frame.
   *
   * If disabled, no requests will be intercepted by the frame.
   */
  set disabled(value) {
    if (value) {
      this.setAttribute("disabled", "");
    } else {
      this.removeAttribute("disabled");
    }
  }

  /**
   * Gets the autoscroll state of the frame.
   *
   * If true, the frame will be scrolled into view automatically on update.
   */
  get autoscroll() {
    return this.hasAttribute("autoscroll")
  }

  /**
   * Sets the autoscroll state of the frame.
   *
   * If true, the frame will be scrolled into view automatically on update.
   */
  set autoscroll(value) {
    if (value) {
      this.setAttribute("autoscroll", "");
    } else {
      this.removeAttribute("autoscroll");
    }
  }

  /**
   * Determines if the element has finished loading
   */
  get complete() {
    return !this.delegate.isLoading
  }

  /**
   * Gets the active state of the frame.
   *
   * If inactive, source changes will not be observed.
   */
  get isActive() {
    return this.ownerDocument === document && !this.isPreview
  }

  /**
   * Sets the active state of the frame.
   *
   * If inactive, source changes will not be observed.
   */
  get isPreview() {
    return this.ownerDocument?.documentElement?.hasAttribute("data-turbo-preview")
  }
}

function frameLoadingStyleFromString(style) {
  switch (style.toLowerCase()) {
    case "lazy":
      return FrameLoadingStyle.lazy
    default:
      return FrameLoadingStyle.eager
  }
}

const drive = {
  enabled: true,
  progressBarDelay: 500,
  unvisitableExtensions: new Set(
    [
      ".7z", ".aac", ".apk", ".avi", ".bmp", ".bz2", ".css", ".csv", ".deb", ".dmg", ".doc",
      ".docx", ".exe", ".gif", ".gz", ".heic", ".heif", ".ico", ".iso", ".jpeg", ".jpg",
      ".js", ".json", ".m4a", ".mkv", ".mov", ".mp3", ".mp4", ".mpeg", ".mpg", ".msi",
      ".ogg", ".ogv", ".pdf", ".pkg", ".png", ".ppt", ".pptx", ".rar", ".rtf",
      ".svg", ".tar", ".tif", ".tiff", ".txt", ".wav", ".webm", ".webp", ".wma", ".wmv",
      ".xls", ".xlsx", ".xml", ".zip"
    ]
  )
};

function activateScriptElement(element) {
  if (element.getAttribute("data-turbo-eval") == "false") {
    return element
  } else {
    const createdScriptElement = document.createElement("script");
    const cspNonce = getCspNonce();
    if (cspNonce) {
      createdScriptElement.nonce = cspNonce;
    }
    createdScriptElement.textContent = element.textContent;
    createdScriptElement.async = false;
    copyElementAttributes(createdScriptElement, element);
    return createdScriptElement
  }
}

function copyElementAttributes(destinationElement, sourceElement) {
  for (const { name, value } of sourceElement.attributes) {
    destinationElement.setAttribute(name, value);
  }
}

function createDocumentFragment(html) {
  const template = document.createElement("template");
  template.innerHTML = html;
  return template.content
}

function dispatch(eventName, { target, cancelable, detail } = {}) {
  const event = new CustomEvent(eventName, {
    cancelable,
    bubbles: true,
    composed: true,
    detail
  });

  if (target && target.isConnected) {
    target.dispatchEvent(event);
  } else {
    document.documentElement.dispatchEvent(event);
  }

  return event
}

function cancelEvent(event) {
  event.preventDefault();
  event.stopImmediatePropagation();
}

function nextRepaint() {
  if (document.visibilityState === "hidden") {
    return nextEventLoopTick()
  } else {
    return nextAnimationFrame()
  }
}

function nextAnimationFrame() {
  return new Promise((resolve) => requestAnimationFrame(() => resolve()))
}

function nextEventLoopTick() {
  return new Promise((resolve) => setTimeout(() => resolve(), 0))
}

function nextMicrotask() {
  return Promise.resolve()
}

function parseHTMLDocument(html = "") {
  return new DOMParser().parseFromString(html, "text/html")
}

function unindent(strings, ...values) {
  const lines = interpolate(strings, values).replace(/^\n/, "").split("\n");
  const match = lines[0].match(/^\s+/);
  const indent = match ? match[0].length : 0;
  return lines.map((line) => line.slice(indent)).join("\n")
}

function interpolate(strings, values) {
  return strings.reduce((result, string, i) => {
    const value = values[i] == undefined ? "" : values[i];
    return result + string + value
  }, "")
}

function uuid() {
  return Array.from({ length: 36 })
    .map((_, i) => {
      if (i == 8 || i == 13 || i == 18 || i == 23) {
        return "-"
      } else if (i == 14) {
        return "4"
      } else if (i == 19) {
        return (Math.floor(Math.random() * 4) + 8).toString(16)
      } else {
        return Math.floor(Math.random() * 15).toString(16)
      }
    })
    .join("")
}

function getAttribute(attributeName, ...elements) {
  for (const value of elements.map((element) => element?.getAttribute(attributeName))) {
    if (typeof value == "string") return value
  }

  return null
}

function hasAttribute(attributeName, ...elements) {
  return elements.some((element) => element && element.hasAttribute(attributeName))
}

function markAsBusy(...elements) {
  for (const element of elements) {
    if (element.localName == "turbo-frame") {
      element.setAttribute("busy", "");
    }
    element.setAttribute("aria-busy", "true");
  }
}

function clearBusyState(...elements) {
  for (const element of elements) {
    if (element.localName == "turbo-frame") {
      element.removeAttribute("busy");
    }

    element.removeAttribute("aria-busy");
  }
}

function waitForLoad(element, timeoutInMilliseconds = 2000) {
  return new Promise((resolve) => {
    const onComplete = () => {
      element.removeEventListener("error", onComplete);
      element.removeEventListener("load", onComplete);
      resolve();
    };

    element.addEventListener("load", onComplete, { once: true });
    element.addEventListener("error", onComplete, { once: true });
    setTimeout(resolve, timeoutInMilliseconds);
  })
}

function getHistoryMethodForAction(action) {
  switch (action) {
    case "replace":
      return history.replaceState
    case "advance":
    case "restore":
      return history.pushState
  }
}

function isAction(action) {
  return action == "advance" || action == "replace" || action == "restore"
}

function getVisitAction(...elements) {
  const action = getAttribute("data-turbo-action", ...elements);

  return isAction(action) ? action : null
}

function getMetaElement(name) {
  return document.querySelector(`meta[name="${name}"]`)
}

function getMetaContent(name) {
  const element = getMetaElement(name);
  return element && element.content
}

function getCspNonce() {
  const element = getMetaElement("csp-nonce");

  if (element) {
    const { nonce, content } = element;
    return nonce == "" ? content : nonce
  }
}

function setMetaContent(name, content) {
  let element = getMetaElement(name);

  if (!element) {
    element = document.createElement("meta");
    element.setAttribute("name", name);

    document.head.appendChild(element);
  }

  element.setAttribute("content", content);

  return element
}

function findClosestRecursively(element, selector) {
  if (element instanceof Element) {
    return (
      element.closest(selector) || findClosestRecursively(element.assignedSlot || element.getRootNode()?.host, selector)
    )
  }
}

function elementIsFocusable(element) {
  const inertDisabledOrHidden = "[inert], :disabled, [hidden], details:not([open]), dialog:not([open])";

  return !!element && element.closest(inertDisabledOrHidden) == null && typeof element.focus == "function"
}

function queryAutofocusableElement(elementOrDocumentFragment) {
  return Array.from(elementOrDocumentFragment.querySelectorAll("[autofocus]")).find(elementIsFocusable)
}

async function around(callback, reader) {
  const before = reader();

  callback();

  await nextAnimationFrame();

  const after = reader();

  return [before, after]
}

function doesNotTargetIFrame(name) {
  if (name === "_blank") {
    return false
  } else if (name) {
    for (const element of document.getElementsByName(name)) {
      if (element instanceof HTMLIFrameElement) return false
    }

    return true
  } else {
    return true
  }
}

function findLinkFromClickTarget(target) {
  return findClosestRecursively(target, "a[href]:not([target^=_]):not([download])")
}

function getLocationForLink(link) {
  return expandURL(link.getAttribute("href") || "")
}

function debounce(fn, delay) {
  let timeoutId = null;

  return (...args) => {
    const callback = () => fn.apply(this, args);
    clearTimeout(timeoutId);
    timeoutId = setTimeout(callback, delay);
  }
}

const submitter = {
  "aria-disabled": {
    beforeSubmit: submitter => {
      submitter.setAttribute("aria-disabled", "true");
      submitter.addEventListener("click", cancelEvent);
    },

    afterSubmit: submitter => {
      submitter.removeAttribute("aria-disabled");
      submitter.removeEventListener("click", cancelEvent);
    }
  },

  "disabled": {
    beforeSubmit: submitter => submitter.disabled = true,
    afterSubmit: submitter => submitter.disabled = false
  }
};

class Config {
  #submitter = null

  constructor(config) {
    Object.assign(this, config);
  }

  get submitter() {
    return this.#submitter
  }

  set submitter(value) {
    this.#submitter = submitter[value] || value;
  }
}

const forms = new Config({
  mode: "on",
  submitter: "disabled"
});

const config = {
  drive,
  forms
};

function expandURL(locatable) {
  return new URL(locatable.toString(), document.baseURI)
}

function getAnchor(url) {
  let anchorMatch;
  if (url.hash) {
    return url.hash.slice(1)
    // eslint-disable-next-line no-cond-assign
  } else if ((anchorMatch = url.href.match(/#(.*)$/))) {
    return anchorMatch[1]
  }
}

function getAction$1(form, submitter) {
  const action = submitter?.getAttribute("formaction") || form.getAttribute("action") || form.action;

  return expandURL(action)
}

function getExtension(url) {
  return (getLastPathComponent(url).match(/\.[^.]*$/) || [])[0] || ""
}

function isPrefixedBy(baseURL, url) {
  const prefix = getPrefix(url);
  return baseURL.href === expandURL(prefix).href || baseURL.href.startsWith(prefix)
}

function locationIsVisitable(location, rootLocation) {
  return isPrefixedBy(location, rootLocation) && !config.drive.unvisitableExtensions.has(getExtension(location))
}

function getRequestURL(url) {
  const anchor = getAnchor(url);
  return anchor != null ? url.href.slice(0, -(anchor.length + 1)) : url.href
}

function toCacheKey(url) {
  return getRequestURL(url)
}

function urlsAreEqual(left, right) {
  return expandURL(left).href == expandURL(right).href
}

function getPathComponents(url) {
  return url.pathname.split("/").slice(1)
}

function getLastPathComponent(url) {
  return getPathComponents(url).slice(-1)[0]
}

function getPrefix(url) {
  return addTrailingSlash(url.origin + url.pathname)
}

function addTrailingSlash(value) {
  return value.endsWith("/") ? value : value + "/"
}

class FetchResponse {
  constructor(response) {
    this.response = response;
  }

  get succeeded() {
    return this.response.ok
  }

  get failed() {
    return !this.succeeded
  }

  get clientError() {
    return this.statusCode >= 400 && this.statusCode <= 499
  }

  get serverError() {
    return this.statusCode >= 500 && this.statusCode <= 599
  }

  get redirected() {
    return this.response.redirected
  }

  get location() {
    return expandURL(this.response.url)
  }

  get isHTML() {
    return this.contentType && this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)
  }

  get statusCode() {
    return this.response.status
  }

  get contentType() {
    return this.header("Content-Type")
  }

  get responseText() {
    return this.response.clone().text()
  }

  get responseHTML() {
    if (this.isHTML) {
      return this.response.clone().text()
    } else {
      return Promise.resolve(undefined)
    }
  }

  header(name) {
    return this.response.headers.get(name)
  }
}

class LimitedSet extends Set {
  constructor(maxSize) {
    super();
    this.maxSize = maxSize;
  }

  add(value) {
    if (this.size >= this.maxSize) {
      const iterator = this.values();
      const oldestValue = iterator.next().value;
      this.delete(oldestValue);
    }
    super.add(value);
  }
}

const recentRequests = new LimitedSet(20);

const nativeFetch = window.fetch;

function fetchWithTurboHeaders(url, options = {}) {
  const modifiedHeaders = new Headers(options.headers || {});
  const requestUID = uuid();
  recentRequests.add(requestUID);
  modifiedHeaders.append("X-Turbo-Request-Id", requestUID);

  return nativeFetch(url, {
    ...options,
    headers: modifiedHeaders
  })
}

function fetchMethodFromString(method) {
  switch (method.toLowerCase()) {
    case "get":
      return FetchMethod.get
    case "post":
      return FetchMethod.post
    case "put":
      return FetchMethod.put
    case "patch":
      return FetchMethod.patch
    case "delete":
      return FetchMethod.delete
  }
}

const FetchMethod = {
  get: "get",
  post: "post",
  put: "put",
  patch: "patch",
  delete: "delete"
};

function fetchEnctypeFromString(encoding) {
  switch (encoding.toLowerCase()) {
    case FetchEnctype.multipart:
      return FetchEnctype.multipart
    case FetchEnctype.plain:
      return FetchEnctype.plain
    default:
      return FetchEnctype.urlEncoded
  }
}

const FetchEnctype = {
  urlEncoded: "application/x-www-form-urlencoded",
  multipart: "multipart/form-data",
  plain: "text/plain"
};

class FetchRequest {
  abortController = new AbortController()
  #resolveRequestPromise = (_value) => {}

  constructor(delegate, method, location, requestBody = new URLSearchParams(), target = null, enctype = FetchEnctype.urlEncoded) {
    const [url, body] = buildResourceAndBody(expandURL(location), method, requestBody, enctype);

    this.delegate = delegate;
    this.url = url;
    this.target = target;
    this.fetchOptions = {
      credentials: "same-origin",
      redirect: "follow",
      method: method.toUpperCase(),
      headers: { ...this.defaultHeaders },
      body: body,
      signal: this.abortSignal,
      referrer: this.delegate.referrer?.href
    };
    this.enctype = enctype;
  }

  get method() {
    return this.fetchOptions.method
  }

  set method(value) {
    const fetchBody = this.isSafe ? this.url.searchParams : this.fetchOptions.body || new FormData();
    const fetchMethod = fetchMethodFromString(value) || FetchMethod.get;

    this.url.search = "";

    const [url, body] = buildResourceAndBody(this.url, fetchMethod, fetchBody, this.enctype);

    this.url = url;
    this.fetchOptions.body = body;
    this.fetchOptions.method = fetchMethod.toUpperCase();
  }

  get headers() {
    return this.fetchOptions.headers
  }

  set headers(value) {
    this.fetchOptions.headers = value;
  }

  get body() {
    if (this.isSafe) {
      return this.url.searchParams
    } else {
      return this.fetchOptions.body
    }
  }

  set body(value) {
    this.fetchOptions.body = value;
  }

  get location() {
    return this.url
  }

  get params() {
    return this.url.searchParams
  }

  get entries() {
    return this.body ? Array.from(this.body.entries()) : []
  }

  cancel() {
    this.abortController.abort();
  }

  async perform() {
    const { fetchOptions } = this;
    this.delegate.prepareRequest(this);
    const event = await this.#allowRequestToBeIntercepted(fetchOptions);
    try {
      this.delegate.requestStarted(this);

      if (event.detail.fetchRequest) {
        this.response = event.detail.fetchRequest.response;
      } else {
        this.response = fetchWithTurboHeaders(this.url.href, fetchOptions);
      }

      const response = await this.response;
      return await this.receive(response)
    } catch (error) {
      if (error.name !== "AbortError") {
        if (this.#willDelegateErrorHandling(error)) {
          this.delegate.requestErrored(this, error);
        }
        throw error
      }
    } finally {
      this.delegate.requestFinished(this);
    }
  }

  async receive(response) {
    const fetchResponse = new FetchResponse(response);
    const event = dispatch("turbo:before-fetch-response", {
      cancelable: true,
      detail: { fetchResponse },
      target: this.target
    });
    if (event.defaultPrevented) {
      this.delegate.requestPreventedHandlingResponse(this, fetchResponse);
    } else if (fetchResponse.succeeded) {
      this.delegate.requestSucceededWithResponse(this, fetchResponse);
    } else {
      this.delegate.requestFailedWithResponse(this, fetchResponse);
    }
    return fetchResponse
  }

  get defaultHeaders() {
    return {
      Accept: "text/html, application/xhtml+xml"
    }
  }

  get isSafe() {
    return isSafe(this.method)
  }

  get abortSignal() {
    return this.abortController.signal
  }

  acceptResponseType(mimeType) {
    this.headers["Accept"] = [mimeType, this.headers["Accept"]].join(", ");
  }

  async #allowRequestToBeIntercepted(fetchOptions) {
    const requestInterception = new Promise((resolve) => (this.#resolveRequestPromise = resolve));
    const event = dispatch("turbo:before-fetch-request", {
      cancelable: true,
      detail: {
        fetchOptions,
        url: this.url,
        resume: this.#resolveRequestPromise
      },
      target: this.target
    });
    this.url = event.detail.url;
    if (event.defaultPrevented) await requestInterception;

    return event
  }

  #willDelegateErrorHandling(error) {
    const event = dispatch("turbo:fetch-request-error", {
      target: this.target,
      cancelable: true,
      detail: { request: this, error: error }
    });

    return !event.defaultPrevented
  }
}

function isSafe(fetchMethod) {
  return fetchMethodFromString(fetchMethod) == FetchMethod.get
}

function buildResourceAndBody(resource, method, requestBody, enctype) {
  const searchParams =
    Array.from(requestBody).length > 0 ? new URLSearchParams(entriesExcludingFiles(requestBody)) : resource.searchParams;

  if (isSafe(method)) {
    return [mergeIntoURLSearchParams(resource, searchParams), null]
  } else if (enctype == FetchEnctype.urlEncoded) {
    return [resource, searchParams]
  } else {
    return [resource, requestBody]
  }
}

function entriesExcludingFiles(requestBody) {
  const entries = [];

  for (const [name, value] of requestBody) {
    if (value instanceof File) continue
    else entries.push([name, value]);
  }

  return entries
}

function mergeIntoURLSearchParams(url, requestBody) {
  const searchParams = new URLSearchParams(entriesExcludingFiles(requestBody));

  url.search = searchParams.toString();

  return url
}

class AppearanceObserver {
  started = false

  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
    this.intersectionObserver = new IntersectionObserver(this.intersect);
  }

  start() {
    if (!this.started) {
      this.started = true;
      this.intersectionObserver.observe(this.element);
    }
  }

  stop() {
    if (this.started) {
      this.started = false;
      this.intersectionObserver.unobserve(this.element);
    }
  }

  intersect = (entries) => {
    const lastEntry = entries.slice(-1)[0];
    if (lastEntry?.isIntersecting) {
      this.delegate.elementAppearedInViewport(this.element);
    }
  }
}

class StreamMessage {
  static contentType = "text/vnd.turbo-stream.html"

  static wrap(message) {
    if (typeof message == "string") {
      return new this(createDocumentFragment(message))
    } else {
      return message
    }
  }

  constructor(fragment) {
    this.fragment = importStreamElements(fragment);
  }
}

function importStreamElements(fragment) {
  for (const element of fragment.querySelectorAll("turbo-stream")) {
    const streamElement = document.importNode(element, true);

    for (const inertScriptElement of streamElement.templateElement.content.querySelectorAll("script")) {
      inertScriptElement.replaceWith(activateScriptElement(inertScriptElement));
    }

    element.replaceWith(streamElement);
  }

  return fragment
}

const PREFETCH_DELAY = 100;

class PrefetchCache {
  #prefetchTimeout = null
  #prefetched = null

  get(url) {
    if (this.#prefetched && this.#prefetched.url === url && this.#prefetched.expire > Date.now()) {
      return this.#prefetched.request
    }
  }

  setLater(url, request, ttl) {
    this.clear();

    this.#prefetchTimeout = setTimeout(() => {
      request.perform();
      this.set(url, request, ttl);
      this.#prefetchTimeout = null;
    }, PREFETCH_DELAY);
  }

  set(url, request, ttl) {
    this.#prefetched = { url, request, expire: new Date(new Date().getTime() + ttl) };
  }

  clear() {
    if (this.#prefetchTimeout) clearTimeout(this.#prefetchTimeout);
    this.#prefetched = null;
  }
}

const cacheTtl = 10 * 1000;
const prefetchCache = new PrefetchCache();

const FormSubmissionState = {
  initialized: "initialized",
  requesting: "requesting",
  waiting: "waiting",
  receiving: "receiving",
  stopping: "stopping",
  stopped: "stopped"
};

class FormSubmission {
  state = FormSubmissionState.initialized

  static confirmMethod(message) {
    return Promise.resolve(confirm(message))
  }

  constructor(delegate, formElement, submitter, mustRedirect = false) {
    const method = getMethod(formElement, submitter);
    const action = getAction(getFormAction(formElement, submitter), method);
    const body = buildFormData(formElement, submitter);
    const enctype = getEnctype(formElement, submitter);

    this.delegate = delegate;
    this.formElement = formElement;
    this.submitter = submitter;
    this.fetchRequest = new FetchRequest(this, method, action, body, formElement, enctype);
    this.mustRedirect = mustRedirect;
  }

  get method() {
    return this.fetchRequest.method
  }

  set method(value) {
    this.fetchRequest.method = value;
  }

  get action() {
    return this.fetchRequest.url.toString()
  }

  set action(value) {
    this.fetchRequest.url = expandURL(value);
  }

  get body() {
    return this.fetchRequest.body
  }

  get enctype() {
    return this.fetchRequest.enctype
  }

  get isSafe() {
    return this.fetchRequest.isSafe
  }

  get location() {
    return this.fetchRequest.url
  }

  // The submission process

  async start() {
    const { initialized, requesting } = FormSubmissionState;
    const confirmationMessage = getAttribute("data-turbo-confirm", this.submitter, this.formElement);

    if (typeof confirmationMessage === "string") {
      const confirmMethod = typeof config.forms.confirm === "function" ?
        config.forms.confirm :
        FormSubmission.confirmMethod;

      const answer = await confirmMethod(confirmationMessage, this.formElement, this.submitter);
      if (!answer) {
        return
      }
    }

    if (this.state == initialized) {
      this.state = requesting;
      return this.fetchRequest.perform()
    }
  }

  stop() {
    const { stopping, stopped } = FormSubmissionState;
    if (this.state != stopping && this.state != stopped) {
      this.state = stopping;
      this.fetchRequest.cancel();
      return true
    }
  }

  // Fetch request delegate

  prepareRequest(request) {
    if (!request.isSafe) {
      const token = getCookieValue(getMetaContent("csrf-param")) || getMetaContent("csrf-token");
      if (token) {
        request.headers["X-CSRF-Token"] = token;
      }
    }

    if (this.requestAcceptsTurboStreamResponse(request)) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted(_request) {
    this.state = FormSubmissionState.waiting;
    if (this.submitter) config.forms.submitter.beforeSubmit(this.submitter);
    this.setSubmitsWith();
    markAsBusy(this.formElement);
    dispatch("turbo:submit-start", {
      target: this.formElement,
      detail: { formSubmission: this }
    });
    this.delegate.formSubmissionStarted(this);
  }

  requestPreventedHandlingResponse(request, response) {
    prefetchCache.clear();

    this.result = { success: response.succeeded, fetchResponse: response };
  }

  requestSucceededWithResponse(request, response) {
    if (response.clientError || response.serverError) {
      this.delegate.formSubmissionFailedWithResponse(this, response);
      return
    }

    prefetchCache.clear();

    if (this.requestMustRedirect(request) && responseSucceededWithoutRedirect(response)) {
      const error = new Error("Form responses must redirect to another location");
      this.delegate.formSubmissionErrored(this, error);
    } else {
      this.state = FormSubmissionState.receiving;
      this.result = { success: true, fetchResponse: response };
      this.delegate.formSubmissionSucceededWithResponse(this, response);
    }
  }

  requestFailedWithResponse(request, response) {
    this.result = { success: false, fetchResponse: response };
    this.delegate.formSubmissionFailedWithResponse(this, response);
  }

  requestErrored(request, error) {
    this.result = { success: false, error };
    this.delegate.formSubmissionErrored(this, error);
  }

  requestFinished(_request) {
    this.state = FormSubmissionState.stopped;
    if (this.submitter) config.forms.submitter.afterSubmit(this.submitter);
    this.resetSubmitterText();
    clearBusyState(this.formElement);
    dispatch("turbo:submit-end", {
      target: this.formElement,
      detail: { formSubmission: this, ...this.result }
    });
    this.delegate.formSubmissionFinished(this);
  }

  // Private

  setSubmitsWith() {
    if (!this.submitter || !this.submitsWith) return

    if (this.submitter.matches("button")) {
      this.originalSubmitText = this.submitter.innerHTML;
      this.submitter.innerHTML = this.submitsWith;
    } else if (this.submitter.matches("input")) {
      const input = this.submitter;
      this.originalSubmitText = input.value;
      input.value = this.submitsWith;
    }
  }

  resetSubmitterText() {
    if (!this.submitter || !this.originalSubmitText) return

    if (this.submitter.matches("button")) {
      this.submitter.innerHTML = this.originalSubmitText;
    } else if (this.submitter.matches("input")) {
      const input = this.submitter;
      input.value = this.originalSubmitText;
    }
  }

  requestMustRedirect(request) {
    return !request.isSafe && this.mustRedirect
  }

  requestAcceptsTurboStreamResponse(request) {
    return !request.isSafe || hasAttribute("data-turbo-stream", this.submitter, this.formElement)
  }

  get submitsWith() {
    return this.submitter?.getAttribute("data-turbo-submits-with")
  }
}

function buildFormData(formElement, submitter) {
  const formData = new FormData(formElement);
  const name = submitter?.getAttribute("name");
  const value = submitter?.getAttribute("value");

  if (name) {
    formData.append(name, value || "");
  }

  return formData
}

function getCookieValue(cookieName) {
  if (cookieName != null) {
    const cookies = document.cookie ? document.cookie.split("; ") : [];
    const cookie = cookies.find((cookie) => cookie.startsWith(cookieName));
    if (cookie) {
      const value = cookie.split("=").slice(1).join("=");
      return value ? decodeURIComponent(value) : undefined
    }
  }
}

function responseSucceededWithoutRedirect(response) {
  return response.statusCode == 200 && !response.redirected
}

function getFormAction(formElement, submitter) {
  const formElementAction = typeof formElement.action === "string" ? formElement.action : null;

  if (submitter?.hasAttribute("formaction")) {
    return submitter.getAttribute("formaction") || ""
  } else {
    return formElement.getAttribute("action") || formElementAction || ""
  }
}

function getAction(formAction, fetchMethod) {
  const action = expandURL(formAction);

  if (isSafe(fetchMethod)) {
    action.search = "";
  }

  return action
}

function getMethod(formElement, submitter) {
  const method = submitter?.getAttribute("formmethod") || formElement.getAttribute("method") || "";
  return fetchMethodFromString(method.toLowerCase()) || FetchMethod.get
}

function getEnctype(formElement, submitter) {
  return fetchEnctypeFromString(submitter?.getAttribute("formenctype") || formElement.enctype)
}

class Snapshot {
  constructor(element) {
    this.element = element;
  }

  get activeElement() {
    return this.element.ownerDocument.activeElement
  }

  get children() {
    return [...this.element.children]
  }

  hasAnchor(anchor) {
    return this.getElementForAnchor(anchor) != null
  }

  getElementForAnchor(anchor) {
    return anchor ? this.element.querySelector(`[id='${anchor}'], a[name='${anchor}']`) : null
  }

  get isConnected() {
    return this.element.isConnected
  }

  get firstAutofocusableElement() {
    return queryAutofocusableElement(this.element)
  }

  get permanentElements() {
    return queryPermanentElementsAll(this.element)
  }

  getPermanentElementById(id) {
    return getPermanentElementById(this.element, id)
  }

  getPermanentElementMapForSnapshot(snapshot) {
    const permanentElementMap = {};

    for (const currentPermanentElement of this.permanentElements) {
      const { id } = currentPermanentElement;
      const newPermanentElement = snapshot.getPermanentElementById(id);
      if (newPermanentElement) {
        permanentElementMap[id] = [currentPermanentElement, newPermanentElement];
      }
    }

    return permanentElementMap
  }
}

function getPermanentElementById(node, id) {
  return node.querySelector(`#${id}[data-turbo-permanent]`)
}

function queryPermanentElementsAll(node) {
  return node.querySelectorAll("[id][data-turbo-permanent]")
}

class FormSubmitObserver {
  started = false

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (!this.started) {
      this.eventTarget.addEventListener("submit", this.submitCaptured, true);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      this.eventTarget.removeEventListener("submit", this.submitCaptured, true);
      this.started = false;
    }
  }

  submitCaptured = () => {
    this.eventTarget.removeEventListener("submit", this.submitBubbled, false);
    this.eventTarget.addEventListener("submit", this.submitBubbled, false);
  }

  submitBubbled = (event) => {
    if (!event.defaultPrevented) {
      const form = event.target instanceof HTMLFormElement ? event.target : undefined;
      const submitter = event.submitter || undefined;

      if (
        form &&
        submissionDoesNotDismissDialog(form, submitter) &&
        submissionDoesNotTargetIFrame(form, submitter) &&
        this.delegate.willSubmitForm(form, submitter)
      ) {
        event.preventDefault();
        event.stopImmediatePropagation();
        this.delegate.formSubmitted(form, submitter);
      }
    }
  }
}

function submissionDoesNotDismissDialog(form, submitter) {
  const method = submitter?.getAttribute("formmethod") || form.getAttribute("method");

  return method != "dialog"
}

function submissionDoesNotTargetIFrame(form, submitter) {
  const target = submitter?.getAttribute("formtarget") || form.getAttribute("target");

  return doesNotTargetIFrame(target)
}

class View {
  #resolveRenderPromise = (_value) => {}
  #resolveInterceptionPromise = (_value) => {}

  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
  }

  // Scrolling

  scrollToAnchor(anchor) {
    const element = this.snapshot.getElementForAnchor(anchor);
    if (element) {
      this.scrollToElement(element);
      this.focusElement(element);
    } else {
      this.scrollToPosition({ x: 0, y: 0 });
    }
  }

  scrollToAnchorFromLocation(location) {
    this.scrollToAnchor(getAnchor(location));
  }

  scrollToElement(element) {
    element.scrollIntoView();
  }

  focusElement(element) {
    if (element instanceof HTMLElement) {
      if (element.hasAttribute("tabindex")) {
        element.focus();
      } else {
        element.setAttribute("tabindex", "-1");
        element.focus();
        element.removeAttribute("tabindex");
      }
    }
  }

  scrollToPosition({ x, y }) {
    this.scrollRoot.scrollTo(x, y);
  }

  scrollToTop() {
    this.scrollToPosition({ x: 0, y: 0 });
  }

  get scrollRoot() {
    return window
  }

  // Rendering

  async render(renderer) {
    const { isPreview, shouldRender, willRender, newSnapshot: snapshot } = renderer;

    // A workaround to ignore tracked element mismatch reloads when performing
    // a promoted Visit from a frame navigation
    const shouldInvalidate = willRender;

    if (shouldRender) {
      try {
        this.renderPromise = new Promise((resolve) => (this.#resolveRenderPromise = resolve));
        this.renderer = renderer;
        await this.prepareToRenderSnapshot(renderer);

        const renderInterception = new Promise((resolve) => (this.#resolveInterceptionPromise = resolve));
        const options = { resume: this.#resolveInterceptionPromise, render: this.renderer.renderElement, renderMethod: this.renderer.renderMethod };
        const immediateRender = this.delegate.allowsImmediateRender(snapshot, options);
        if (!immediateRender) await renderInterception;

        await this.renderSnapshot(renderer);
        this.delegate.viewRenderedSnapshot(snapshot, isPreview, this.renderer.renderMethod);
        this.delegate.preloadOnLoadLinksForView(this.element);
        this.finishRenderingSnapshot(renderer);
      } finally {
        delete this.renderer;
        this.#resolveRenderPromise(undefined);
        delete this.renderPromise;
      }
    } else if (shouldInvalidate) {
      this.invalidate(renderer.reloadReason);
    }
  }

  invalidate(reason) {
    this.delegate.viewInvalidated(reason);
  }

  async prepareToRenderSnapshot(renderer) {
    this.markAsPreview(renderer.isPreview);
    await renderer.prepareToRender();
  }

  markAsPreview(isPreview) {
    if (isPreview) {
      this.element.setAttribute("data-turbo-preview", "");
    } else {
      this.element.removeAttribute("data-turbo-preview");
    }
  }

  markVisitDirection(direction) {
    this.element.setAttribute("data-turbo-visit-direction", direction);
  }

  unmarkVisitDirection() {
    this.element.removeAttribute("data-turbo-visit-direction");
  }

  async renderSnapshot(renderer) {
    await renderer.render();
  }

  finishRenderingSnapshot(renderer) {
    renderer.finishRendering();
  }
}

class FrameView extends View {
  missing() {
    this.element.innerHTML = `<strong class="turbo-frame-error">Content missing</strong>`;
  }

  get snapshot() {
    return new Snapshot(this.element)
  }
}

class LinkInterceptor {
  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
  }

  start() {
    this.element.addEventListener("click", this.clickBubbled);
    document.addEventListener("turbo:click", this.linkClicked);
    document.addEventListener("turbo:before-visit", this.willVisit);
  }

  stop() {
    this.element.removeEventListener("click", this.clickBubbled);
    document.removeEventListener("turbo:click", this.linkClicked);
    document.removeEventListener("turbo:before-visit", this.willVisit);
  }

  clickBubbled = (event) => {
    if (this.clickEventIsSignificant(event)) {
      this.clickEvent = event;
    } else {
      delete this.clickEvent;
    }
  }

  linkClicked = (event) => {
    if (this.clickEvent && this.clickEventIsSignificant(event)) {
      if (this.delegate.shouldInterceptLinkClick(event.target, event.detail.url, event.detail.originalEvent)) {
        this.clickEvent.preventDefault();
        event.preventDefault();
        this.delegate.linkClickIntercepted(event.target, event.detail.url, event.detail.originalEvent);
      }
    }
    delete this.clickEvent;
  }

  willVisit = (_event) => {
    delete this.clickEvent;
  }

  clickEventIsSignificant(event) {
    const target = event.composed ? event.target?.parentElement : event.target;
    const element = findLinkFromClickTarget(target) || target;

    return element instanceof Element && element.closest("turbo-frame, html") == this.element
  }
}

class LinkClickObserver {
  started = false

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (!this.started) {
      this.eventTarget.addEventListener("click", this.clickCaptured, true);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      this.eventTarget.removeEventListener("click", this.clickCaptured, true);
      this.started = false;
    }
  }

  clickCaptured = () => {
    this.eventTarget.removeEventListener("click", this.clickBubbled, false);
    this.eventTarget.addEventListener("click", this.clickBubbled, false);
  }

  clickBubbled = (event) => {
    if (event instanceof MouseEvent && this.clickEventIsSignificant(event)) {
      const target = (event.composedPath && event.composedPath()[0]) || event.target;
      const link = findLinkFromClickTarget(target);
      if (link && doesNotTargetIFrame(link.target)) {
        const location = getLocationForLink(link);
        if (this.delegate.willFollowLinkToLocation(link, location, event)) {
          event.preventDefault();
          this.delegate.followedLinkToLocation(link, location);
        }
      }
    }
  }

  clickEventIsSignificant(event) {
    return !(
      (event.target && event.target.isContentEditable) ||
      event.defaultPrevented ||
      event.which > 1 ||
      event.altKey ||
      event.ctrlKey ||
      event.metaKey ||
      event.shiftKey
    )
  }
}

class FormLinkClickObserver {
  constructor(delegate, element) {
    this.delegate = delegate;
    this.linkInterceptor = new LinkClickObserver(this, element);
  }

  start() {
    this.linkInterceptor.start();
  }

  stop() {
    this.linkInterceptor.stop();
  }

  // Link hover observer delegate

  canPrefetchRequestToLocation(link, location) {
    return false
  }

  prefetchAndCacheRequestToLocation(link, location) {
    return
  }

  // Link click observer delegate

  willFollowLinkToLocation(link, location, originalEvent) {
    return (
      this.delegate.willSubmitFormLinkToLocation(link, location, originalEvent) &&
      (link.hasAttribute("data-turbo-method") || link.hasAttribute("data-turbo-stream"))
    )
  }

  followedLinkToLocation(link, location) {
    const form = document.createElement("form");

    const type = "hidden";
    for (const [name, value] of location.searchParams) {
      form.append(Object.assign(document.createElement("input"), { type, name, value }));
    }

    const action = Object.assign(location, { search: "" });
    form.setAttribute("data-turbo", "true");
    form.setAttribute("action", action.href);
    form.setAttribute("hidden", "");

    const method = link.getAttribute("data-turbo-method");
    if (method) form.setAttribute("method", method);

    const turboFrame = link.getAttribute("data-turbo-frame");
    if (turboFrame) form.setAttribute("data-turbo-frame", turboFrame);

    const turboAction = getVisitAction(link);
    if (turboAction) form.setAttribute("data-turbo-action", turboAction);

    const turboConfirm = link.getAttribute("data-turbo-confirm");
    if (turboConfirm) form.setAttribute("data-turbo-confirm", turboConfirm);

    const turboStream = link.hasAttribute("data-turbo-stream");
    if (turboStream) form.setAttribute("data-turbo-stream", "");

    this.delegate.submittedFormLinkToLocation(link, location, form);

    document.body.appendChild(form);
    form.addEventListener("turbo:submit-end", () => form.remove(), { once: true });
    requestAnimationFrame(() => form.requestSubmit());
  }
}

class Bardo {
  static async preservingPermanentElements(delegate, permanentElementMap, callback) {
    const bardo = new this(delegate, permanentElementMap);
    bardo.enter();
    await callback();
    bardo.leave();
  }

  constructor(delegate, permanentElementMap) {
    this.delegate = delegate;
    this.permanentElementMap = permanentElementMap;
  }

  enter() {
    for (const id in this.permanentElementMap) {
      const [currentPermanentElement, newPermanentElement] = this.permanentElementMap[id];
      this.delegate.enteringBardo(currentPermanentElement, newPermanentElement);
      this.replaceNewPermanentElementWithPlaceholder(newPermanentElement);
    }
  }

  leave() {
    for (const id in this.permanentElementMap) {
      const [currentPermanentElement] = this.permanentElementMap[id];
      this.replaceCurrentPermanentElementWithClone(currentPermanentElement);
      this.replacePlaceholderWithPermanentElement(currentPermanentElement);
      this.delegate.leavingBardo(currentPermanentElement);
    }
  }

  replaceNewPermanentElementWithPlaceholder(permanentElement) {
    const placeholder = createPlaceholderForPermanentElement(permanentElement);
    permanentElement.replaceWith(placeholder);
  }

  replaceCurrentPermanentElementWithClone(permanentElement) {
    const clone = permanentElement.cloneNode(true);
    permanentElement.replaceWith(clone);
  }

  replacePlaceholderWithPermanentElement(permanentElement) {
    const placeholder = this.getPlaceholderById(permanentElement.id);
    placeholder?.replaceWith(permanentElement);
  }

  getPlaceholderById(id) {
    return this.placeholders.find((element) => element.content == id)
  }

  get placeholders() {
    return [...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]
  }
}

function createPlaceholderForPermanentElement(permanentElement) {
  const element = document.createElement("meta");
  element.setAttribute("name", "turbo-permanent-placeholder");
  element.setAttribute("content", permanentElement.id);
  return element
}

class Renderer {
  #activeElement = null

  static renderElement(currentElement, newElement) {
    // Abstract method
  }

  constructor(currentSnapshot, newSnapshot, isPreview, willRender = true) {
    this.currentSnapshot = currentSnapshot;
    this.newSnapshot = newSnapshot;
    this.isPreview = isPreview;
    this.willRender = willRender;
    this.renderElement = this.constructor.renderElement;
    this.promise = new Promise((resolve, reject) => (this.resolvingFunctions = { resolve, reject }));
  }

  get shouldRender() {
    return true
  }

  get shouldAutofocus() {
    return true
  }

  get reloadReason() {
    return
  }

  prepareToRender() {
    return
  }

  render() {
    // Abstract method
  }

  finishRendering() {
    if (this.resolvingFunctions) {
      this.resolvingFunctions.resolve();
      delete this.resolvingFunctions;
    }
  }

  async preservingPermanentElements(callback) {
    await Bardo.preservingPermanentElements(this, this.permanentElementMap, callback);
  }

  focusFirstAutofocusableElement() {
    if (this.shouldAutofocus) {
      const element = this.connectedSnapshot.firstAutofocusableElement;
      if (element) {
        element.focus();
      }
    }
  }

  // Bardo delegate

  enteringBardo(currentPermanentElement) {
    if (this.#activeElement) return

    if (currentPermanentElement.contains(this.currentSnapshot.activeElement)) {
      this.#activeElement = this.currentSnapshot.activeElement;
    }
  }

  leavingBardo(currentPermanentElement) {
    if (currentPermanentElement.contains(this.#activeElement) && this.#activeElement instanceof HTMLElement) {
      this.#activeElement.focus();

      this.#activeElement = null;
    }
  }

  get connectedSnapshot() {
    return this.newSnapshot.isConnected ? this.newSnapshot : this.currentSnapshot
  }

  get currentElement() {
    return this.currentSnapshot.element
  }

  get newElement() {
    return this.newSnapshot.element
  }

  get permanentElementMap() {
    return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)
  }

  get renderMethod() {
    return "replace"
  }
}

class FrameRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    const destinationRange = document.createRange();
    destinationRange.selectNodeContents(currentElement);
    destinationRange.deleteContents();

    const frameElement = newElement;
    const sourceRange = frameElement.ownerDocument?.createRange();
    if (sourceRange) {
      sourceRange.selectNodeContents(frameElement);
      currentElement.appendChild(sourceRange.extractContents());
    }
  }

  constructor(delegate, currentSnapshot, newSnapshot, renderElement, isPreview, willRender = true) {
    super(currentSnapshot, newSnapshot, renderElement, isPreview, willRender);
    this.delegate = delegate;
  }

  get shouldRender() {
    return true
  }

  async render() {
    await nextRepaint();
    this.preservingPermanentElements(() => {
      this.loadFrameElement();
    });
    this.scrollFrameIntoView();
    await nextRepaint();
    this.focusFirstAutofocusableElement();
    await nextRepaint();
    this.activateScriptElements();
  }

  loadFrameElement() {
    this.delegate.willRenderFrame(this.currentElement, this.newElement);
    this.renderElement(this.currentElement, this.newElement);
  }

  scrollFrameIntoView() {
    if (this.currentElement.autoscroll || this.newElement.autoscroll) {
      const element = this.currentElement.firstElementChild;
      const block = readScrollLogicalPosition(this.currentElement.getAttribute("data-autoscroll-block"), "end");
      const behavior = readScrollBehavior(this.currentElement.getAttribute("data-autoscroll-behavior"), "auto");

      if (element) {
        element.scrollIntoView({ block, behavior });
        return true
      }
    }
    return false
  }

  activateScriptElements() {
    for (const inertScriptElement of this.newScriptElements) {
      const activatedScriptElement = activateScriptElement(inertScriptElement);
      inertScriptElement.replaceWith(activatedScriptElement);
    }
  }

  get newScriptElements() {
    return this.currentElement.querySelectorAll("script")
  }
}

function readScrollLogicalPosition(value, defaultValue) {
  if (value == "end" || value == "start" || value == "center" || value == "nearest") {
    return value
  } else {
    return defaultValue
  }
}

function readScrollBehavior(value, defaultValue) {
  if (value == "auto" || value == "smooth") {
    return value
  } else {
    return defaultValue
  }
}

// base IIFE to define idiomorph
var Idiomorph = (function () {

        //=============================================================================
        // AND NOW IT BEGINS...
        //=============================================================================
        let EMPTY_SET = new Set();

        // default configuration values, updatable by users now
        let defaults = {
            morphStyle: "outerHTML",
            callbacks : {
                beforeNodeAdded: noOp,
                afterNodeAdded: noOp,
                beforeNodeMorphed: noOp,
                afterNodeMorphed: noOp,
                beforeNodeRemoved: noOp,
                afterNodeRemoved: noOp,
                beforeAttributeUpdated: noOp,

            },
            head: {
                style: 'merge',
                shouldPreserve: function (elt) {
                    return elt.getAttribute("im-preserve") === "true";
                },
                shouldReAppend: function (elt) {
                    return elt.getAttribute("im-re-append") === "true";
                },
                shouldRemove: noOp,
                afterHeadMorphed: noOp,
            }
        };

        //=============================================================================
        // Core Morphing Algorithm - morph, morphNormalizedContent, morphOldNodeTo, morphChildren
        //=============================================================================
        function morph(oldNode, newContent, config = {}) {

            if (oldNode instanceof Document) {
                oldNode = oldNode.documentElement;
            }

            if (typeof newContent === 'string') {
                newContent = parseContent(newContent);
            }

            let normalizedContent = normalizeContent(newContent);

            let ctx = createMorphContext(oldNode, normalizedContent, config);

            return morphNormalizedContent(oldNode, normalizedContent, ctx);
        }

        function morphNormalizedContent(oldNode, normalizedNewContent, ctx) {
            if (ctx.head.block) {
                let oldHead = oldNode.querySelector('head');
                let newHead = normalizedNewContent.querySelector('head');
                if (oldHead && newHead) {
                    let promises = handleHeadElement(newHead, oldHead, ctx);
                    // when head promises resolve, call morph again, ignoring the head tag
                    Promise.all(promises).then(function () {
                        morphNormalizedContent(oldNode, normalizedNewContent, Object.assign(ctx, {
                            head: {
                                block: false,
                                ignore: true
                            }
                        }));
                    });
                    return;
                }
            }

            if (ctx.morphStyle === "innerHTML") {

                // innerHTML, so we are only updating the children
                morphChildren(normalizedNewContent, oldNode, ctx);
                return oldNode.children;

            } else if (ctx.morphStyle === "outerHTML" || ctx.morphStyle == null) {
                // otherwise find the best element match in the new content, morph that, and merge its siblings
                // into either side of the best match
                let bestMatch = findBestNodeMatch(normalizedNewContent, oldNode, ctx);

                // stash the siblings that will need to be inserted on either side of the best match
                let previousSibling = bestMatch?.previousSibling;
                let nextSibling = bestMatch?.nextSibling;

                // morph it
                let morphedNode = morphOldNodeTo(oldNode, bestMatch, ctx);

                if (bestMatch) {
                    // if there was a best match, merge the siblings in too and return the
                    // whole bunch
                    return insertSiblings(previousSibling, morphedNode, nextSibling);
                } else {
                    // otherwise nothing was added to the DOM
                    return []
                }
            } else {
                throw "Do not understand how to morph style " + ctx.morphStyle;
            }
        }


        /**
         * @param possibleActiveElement
         * @param ctx
         * @returns {boolean}
         */
        function ignoreValueOfActiveElement(possibleActiveElement, ctx) {
            return ctx.ignoreActiveValue && possibleActiveElement === document.activeElement && possibleActiveElement !== document.body;
        }

        /**
         * @param oldNode root node to merge content into
         * @param newContent new content to merge
         * @param ctx the merge context
         * @returns {Element} the element that ended up in the DOM
         */
        function morphOldNodeTo(oldNode, newContent, ctx) {
            if (ctx.ignoreActive && oldNode === document.activeElement) ; else if (newContent == null) {
                if (ctx.callbacks.beforeNodeRemoved(oldNode) === false) return oldNode;

                oldNode.remove();
                ctx.callbacks.afterNodeRemoved(oldNode);
                return null;
            } else if (!isSoftMatch(oldNode, newContent)) {
                if (ctx.callbacks.beforeNodeRemoved(oldNode) === false) return oldNode;
                if (ctx.callbacks.beforeNodeAdded(newContent) === false) return oldNode;

                oldNode.parentElement.replaceChild(newContent, oldNode);
                ctx.callbacks.afterNodeAdded(newContent);
                ctx.callbacks.afterNodeRemoved(oldNode);
                return newContent;
            } else {
                if (ctx.callbacks.beforeNodeMorphed(oldNode, newContent) === false) return oldNode;

                if (oldNode instanceof HTMLHeadElement && ctx.head.ignore) ; else if (oldNode instanceof HTMLHeadElement && ctx.head.style !== "morph") {
                    handleHeadElement(newContent, oldNode, ctx);
                } else {
                    syncNodeFrom(newContent, oldNode, ctx);
                    if (!ignoreValueOfActiveElement(oldNode, ctx)) {
                        morphChildren(newContent, oldNode, ctx);
                    }
                }
                ctx.callbacks.afterNodeMorphed(oldNode, newContent);
                return oldNode;
            }
        }

        /**
         * This is the core algorithm for matching up children.  The idea is to use id sets to try to match up
         * nodes as faithfully as possible.  We greedily match, which allows us to keep the algorithm fast, but
         * by using id sets, we are able to better match up with content deeper in the DOM.
         *
         * Basic algorithm is, for each node in the new content:
         *
         * - if we have reached the end of the old parent, append the new content
         * - if the new content has an id set match with the current insertion point, morph
         * - search for an id set match
         * - if id set match found, morph
         * - otherwise search for a "soft" match
         * - if a soft match is found, morph
         * - otherwise, prepend the new node before the current insertion point
         *
         * The two search algorithms terminate if competing node matches appear to outweigh what can be achieved
         * with the current node.  See findIdSetMatch() and findSoftMatch() for details.
         *
         * @param {Element} newParent the parent element of the new content
         * @param {Element } oldParent the old content that we are merging the new content into
         * @param ctx the merge context
         */
        function morphChildren(newParent, oldParent, ctx) {

            let nextNewChild = newParent.firstChild;
            let insertionPoint = oldParent.firstChild;
            let newChild;

            // run through all the new content
            while (nextNewChild) {

                newChild = nextNewChild;
                nextNewChild = newChild.nextSibling;

                // if we are at the end of the exiting parent's children, just append
                if (insertionPoint == null) {
                    if (ctx.callbacks.beforeNodeAdded(newChild) === false) return;

                    oldParent.appendChild(newChild);
                    ctx.callbacks.afterNodeAdded(newChild);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // if the current node has an id set match then morph
                if (isIdSetMatch(newChild, insertionPoint, ctx)) {
                    morphOldNodeTo(insertionPoint, newChild, ctx);
                    insertionPoint = insertionPoint.nextSibling;
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // otherwise search forward in the existing old children for an id set match
                let idSetMatch = findIdSetMatch(newParent, oldParent, newChild, insertionPoint, ctx);

                // if we found a potential match, remove the nodes until that point and morph
                if (idSetMatch) {
                    insertionPoint = removeNodesBetween(insertionPoint, idSetMatch, ctx);
                    morphOldNodeTo(idSetMatch, newChild, ctx);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // no id set match found, so scan forward for a soft match for the current node
                let softMatch = findSoftMatch(newParent, oldParent, newChild, insertionPoint, ctx);

                // if we found a soft match for the current node, morph
                if (softMatch) {
                    insertionPoint = removeNodesBetween(insertionPoint, softMatch, ctx);
                    morphOldNodeTo(softMatch, newChild, ctx);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // abandon all hope of morphing, just insert the new child before the insertion point
                // and move on
                if (ctx.callbacks.beforeNodeAdded(newChild) === false) return;

                oldParent.insertBefore(newChild, insertionPoint);
                ctx.callbacks.afterNodeAdded(newChild);
                removeIdsFromConsideration(ctx, newChild);
            }

            // remove any remaining old nodes that didn't match up with new content
            while (insertionPoint !== null) {

                let tempNode = insertionPoint;
                insertionPoint = insertionPoint.nextSibling;
                removeNode(tempNode, ctx);
            }
        }

        //=============================================================================
        // Attribute Syncing Code
        //=============================================================================

        /**
         * @param attr {String} the attribute to be mutated
         * @param to {Element} the element that is going to be updated
         * @param updateType {("update"|"remove")}
         * @param ctx the merge context
         * @returns {boolean} true if the attribute should be ignored, false otherwise
         */
        function ignoreAttribute(attr, to, updateType, ctx) {
            if(attr === 'value' && ctx.ignoreActiveValue && to === document.activeElement){
                return true;
            }
            return ctx.callbacks.beforeAttributeUpdated(attr, to, updateType) === false;
        }

        /**
         * syncs a given node with another node, copying over all attributes and
         * inner element state from the 'from' node to the 'to' node
         *
         * @param {Element} from the element to copy attributes & state from
         * @param {Element} to the element to copy attributes & state to
         * @param ctx the merge context
         */
        function syncNodeFrom(from, to, ctx) {
            let type = from.nodeType;

            // if is an element type, sync the attributes from the
            // new node into the new node
            if (type === 1 /* element type */) {
                const fromAttributes = from.attributes;
                const toAttributes = to.attributes;
                for (const fromAttribute of fromAttributes) {
                    if (ignoreAttribute(fromAttribute.name, to, 'update', ctx)) {
                        continue;
                    }
                    if (to.getAttribute(fromAttribute.name) !== fromAttribute.value) {
                        to.setAttribute(fromAttribute.name, fromAttribute.value);
                    }
                }
                // iterate backwards to avoid skipping over items when a delete occurs
                for (let i = toAttributes.length - 1; 0 <= i; i--) {
                    const toAttribute = toAttributes[i];
                    if (ignoreAttribute(toAttribute.name, to, 'remove', ctx)) {
                        continue;
                    }
                    if (!from.hasAttribute(toAttribute.name)) {
                        to.removeAttribute(toAttribute.name);
                    }
                }
            }

            // sync text nodes
            if (type === 8 /* comment */ || type === 3 /* text */) {
                if (to.nodeValue !== from.nodeValue) {
                    to.nodeValue = from.nodeValue;
                }
            }

            if (!ignoreValueOfActiveElement(to, ctx)) {
                // sync input values
                syncInputValue(from, to, ctx);
            }
        }

        /**
         * @param from {Element} element to sync the value from
         * @param to {Element} element to sync the value to
         * @param attributeName {String} the attribute name
         * @param ctx the merge context
         */
        function syncBooleanAttribute(from, to, attributeName, ctx) {
            if (from[attributeName] !== to[attributeName]) {
                let ignoreUpdate = ignoreAttribute(attributeName, to, 'update', ctx);
                if (!ignoreUpdate) {
                    to[attributeName] = from[attributeName];
                }
                if (from[attributeName]) {
                    if (!ignoreUpdate) {
                        to.setAttribute(attributeName, from[attributeName]);
                    }
                } else {
                    if (!ignoreAttribute(attributeName, to, 'remove', ctx)) {
                        to.removeAttribute(attributeName);
                    }
                }
            }
        }

        /**
         * NB: many bothans died to bring us information:
         *
         *  https://github.com/patrick-steele-idem/morphdom/blob/master/src/specialElHandlers.js
         *  https://github.com/choojs/nanomorph/blob/master/lib/morph.jsL113
         *
         * @param from {Element} the element to sync the input value from
         * @param to {Element} the element to sync the input value to
         * @param ctx the merge context
         */
        function syncInputValue(from, to, ctx) {
            if (from instanceof HTMLInputElement &&
                to instanceof HTMLInputElement &&
                from.type !== 'file') {

                let fromValue = from.value;
                let toValue = to.value;

                // sync boolean attributes
                syncBooleanAttribute(from, to, 'checked', ctx);
                syncBooleanAttribute(from, to, 'disabled', ctx);

                if (!from.hasAttribute('value')) {
                    if (!ignoreAttribute('value', to, 'remove', ctx)) {
                        to.value = '';
                        to.removeAttribute('value');
                    }
                } else if (fromValue !== toValue) {
                    if (!ignoreAttribute('value', to, 'update', ctx)) {
                        to.setAttribute('value', fromValue);
                        to.value = fromValue;
                    }
                }
            } else if (from instanceof HTMLOptionElement) {
                syncBooleanAttribute(from, to, 'selected', ctx);
            } else if (from instanceof HTMLTextAreaElement && to instanceof HTMLTextAreaElement) {
                let fromValue = from.value;
                let toValue = to.value;
                if (ignoreAttribute('value', to, 'update', ctx)) {
                    return;
                }
                if (fromValue !== toValue) {
                    to.value = fromValue;
                }
                if (to.firstChild && to.firstChild.nodeValue !== fromValue) {
                    to.firstChild.nodeValue = fromValue;
                }
            }
        }

        //=============================================================================
        // the HEAD tag can be handled specially, either w/ a 'merge' or 'append' style
        //=============================================================================
        function handleHeadElement(newHeadTag, currentHead, ctx) {

            let added = [];
            let removed = [];
            let preserved = [];
            let nodesToAppend = [];

            let headMergeStyle = ctx.head.style;

            // put all new head elements into a Map, by their outerHTML
            let srcToNewHeadNodes = new Map();
            for (const newHeadChild of newHeadTag.children) {
                srcToNewHeadNodes.set(newHeadChild.outerHTML, newHeadChild);
            }

            // for each elt in the current head
            for (const currentHeadElt of currentHead.children) {

                // If the current head element is in the map
                let inNewContent = srcToNewHeadNodes.has(currentHeadElt.outerHTML);
                let isReAppended = ctx.head.shouldReAppend(currentHeadElt);
                let isPreserved = ctx.head.shouldPreserve(currentHeadElt);
                if (inNewContent || isPreserved) {
                    if (isReAppended) {
                        // remove the current version and let the new version replace it and re-execute
                        removed.push(currentHeadElt);
                    } else {
                        // this element already exists and should not be re-appended, so remove it from
                        // the new content map, preserving it in the DOM
                        srcToNewHeadNodes.delete(currentHeadElt.outerHTML);
                        preserved.push(currentHeadElt);
                    }
                } else {
                    if (headMergeStyle === "append") {
                        // we are appending and this existing element is not new content
                        // so if and only if it is marked for re-append do we do anything
                        if (isReAppended) {
                            removed.push(currentHeadElt);
                            nodesToAppend.push(currentHeadElt);
                        }
                    } else {
                        // if this is a merge, we remove this content since it is not in the new head
                        if (ctx.head.shouldRemove(currentHeadElt) !== false) {
                            removed.push(currentHeadElt);
                        }
                    }
                }
            }

            // Push the remaining new head elements in the Map into the
            // nodes to append to the head tag
            nodesToAppend.push(...srcToNewHeadNodes.values());

            let promises = [];
            for (const newNode of nodesToAppend) {
                let newElt = document.createRange().createContextualFragment(newNode.outerHTML).firstChild;
                if (ctx.callbacks.beforeNodeAdded(newElt) !== false) {
                    if (newElt.href || newElt.src) {
                        let resolve = null;
                        let promise = new Promise(function (_resolve) {
                            resolve = _resolve;
                        });
                        newElt.addEventListener('load', function () {
                            resolve();
                        });
                        promises.push(promise);
                    }
                    currentHead.appendChild(newElt);
                    ctx.callbacks.afterNodeAdded(newElt);
                    added.push(newElt);
                }
            }

            // remove all removed elements, after we have appended the new elements to avoid
            // additional network requests for things like style sheets
            for (const removedElement of removed) {
                if (ctx.callbacks.beforeNodeRemoved(removedElement) !== false) {
                    currentHead.removeChild(removedElement);
                    ctx.callbacks.afterNodeRemoved(removedElement);
                }
            }

            ctx.head.afterHeadMorphed(currentHead, {added: added, kept: preserved, removed: removed});
            return promises;
        }

        function noOp() {
        }

        /*
          Deep merges the config object and the Idiomoroph.defaults object to
          produce a final configuration object
         */
        function mergeDefaults(config) {
            let finalConfig = {};
            // copy top level stuff into final config
            Object.assign(finalConfig, defaults);
            Object.assign(finalConfig, config);

            // copy callbacks into final config (do this to deep merge the callbacks)
            finalConfig.callbacks = {};
            Object.assign(finalConfig.callbacks, defaults.callbacks);
            Object.assign(finalConfig.callbacks, config.callbacks);

            // copy head config into final config  (do this to deep merge the head)
            finalConfig.head = {};
            Object.assign(finalConfig.head, defaults.head);
            Object.assign(finalConfig.head, config.head);
            return finalConfig;
        }

        function createMorphContext(oldNode, newContent, config) {
            config = mergeDefaults(config);
            return {
                target: oldNode,
                newContent: newContent,
                config: config,
                morphStyle: config.morphStyle,
                ignoreActive: config.ignoreActive,
                ignoreActiveValue: config.ignoreActiveValue,
                idMap: createIdMap(oldNode, newContent),
                deadIds: new Set(),
                callbacks: config.callbacks,
                head: config.head
            }
        }

        function isIdSetMatch(node1, node2, ctx) {
            if (node1 == null || node2 == null) {
                return false;
            }
            if (node1.nodeType === node2.nodeType && node1.tagName === node2.tagName) {
                if (node1.id !== "" && node1.id === node2.id) {
                    return true;
                } else {
                    return getIdIntersectionCount(ctx, node1, node2) > 0;
                }
            }
            return false;
        }

        function isSoftMatch(node1, node2) {
            if (node1 == null || node2 == null) {
                return false;
            }
            return node1.nodeType === node2.nodeType && node1.tagName === node2.tagName
        }

        function removeNodesBetween(startInclusive, endExclusive, ctx) {
            while (startInclusive !== endExclusive) {
                let tempNode = startInclusive;
                startInclusive = startInclusive.nextSibling;
                removeNode(tempNode, ctx);
            }
            removeIdsFromConsideration(ctx, endExclusive);
            return endExclusive.nextSibling;
        }

        //=============================================================================
        // Scans forward from the insertionPoint in the old parent looking for a potential id match
        // for the newChild.  We stop if we find a potential id match for the new child OR
        // if the number of potential id matches we are discarding is greater than the
        // potential id matches for the new child
        //=============================================================================
        function findIdSetMatch(newContent, oldParent, newChild, insertionPoint, ctx) {

            // max id matches we are willing to discard in our search
            let newChildPotentialIdCount = getIdIntersectionCount(ctx, newChild, oldParent);

            let potentialMatch = null;

            // only search forward if there is a possibility of an id match
            if (newChildPotentialIdCount > 0) {
                let potentialMatch = insertionPoint;
                // if there is a possibility of an id match, scan forward
                // keep track of the potential id match count we are discarding (the
                // newChildPotentialIdCount must be greater than this to make it likely
                // worth it)
                let otherMatchCount = 0;
                while (potentialMatch != null) {

                    // If we have an id match, return the current potential match
                    if (isIdSetMatch(newChild, potentialMatch, ctx)) {
                        return potentialMatch;
                    }

                    // computer the other potential matches of this new content
                    otherMatchCount += getIdIntersectionCount(ctx, potentialMatch, newContent);
                    if (otherMatchCount > newChildPotentialIdCount) {
                        // if we have more potential id matches in _other_ content, we
                        // do not have a good candidate for an id match, so return null
                        return null;
                    }

                    // advanced to the next old content child
                    potentialMatch = potentialMatch.nextSibling;
                }
            }
            return potentialMatch;
        }

        //=============================================================================
        // Scans forward from the insertionPoint in the old parent looking for a potential soft match
        // for the newChild.  We stop if we find a potential soft match for the new child OR
        // if we find a potential id match in the old parents children OR if we find two
        // potential soft matches for the next two pieces of new content
        //=============================================================================
        function findSoftMatch(newContent, oldParent, newChild, insertionPoint, ctx) {

            let potentialSoftMatch = insertionPoint;
            let nextSibling = newChild.nextSibling;
            let siblingSoftMatchCount = 0;

            while (potentialSoftMatch != null) {

                if (getIdIntersectionCount(ctx, potentialSoftMatch, newContent) > 0) {
                    // the current potential soft match has a potential id set match with the remaining new
                    // content so bail out of looking
                    return null;
                }

                // if we have a soft match with the current node, return it
                if (isSoftMatch(newChild, potentialSoftMatch)) {
                    return potentialSoftMatch;
                }

                if (isSoftMatch(nextSibling, potentialSoftMatch)) {
                    // the next new node has a soft match with this node, so
                    // increment the count of future soft matches
                    siblingSoftMatchCount++;
                    nextSibling = nextSibling.nextSibling;

                    // If there are two future soft matches, bail to allow the siblings to soft match
                    // so that we don't consume future soft matches for the sake of the current node
                    if (siblingSoftMatchCount >= 2) {
                        return null;
                    }
                }

                // advanced to the next old content child
                potentialSoftMatch = potentialSoftMatch.nextSibling;
            }

            return potentialSoftMatch;
        }

        function parseContent(newContent) {
            let parser = new DOMParser();

            // remove svgs to avoid false-positive matches on head, etc.
            let contentWithSvgsRemoved = newContent.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim, '');

            // if the newContent contains a html, head or body tag, we can simply parse it w/o wrapping
            if (contentWithSvgsRemoved.match(/<\/html>/) || contentWithSvgsRemoved.match(/<\/head>/) || contentWithSvgsRemoved.match(/<\/body>/)) {
                let content = parser.parseFromString(newContent, "text/html");
                // if it is a full HTML document, return the document itself as the parent container
                if (contentWithSvgsRemoved.match(/<\/html>/)) {
                    content.generatedByIdiomorph = true;
                    return content;
                } else {
                    // otherwise return the html element as the parent container
                    let htmlElement = content.firstChild;
                    if (htmlElement) {
                        htmlElement.generatedByIdiomorph = true;
                        return htmlElement;
                    } else {
                        return null;
                    }
                }
            } else {
                // if it is partial HTML, wrap it in a template tag to provide a parent element and also to help
                // deal with touchy tags like tr, tbody, etc.
                let responseDoc = parser.parseFromString("<body><template>" + newContent + "</template></body>", "text/html");
                let content = responseDoc.body.querySelector('template').content;
                content.generatedByIdiomorph = true;
                return content
            }
        }

        function normalizeContent(newContent) {
            if (newContent == null) {
                // noinspection UnnecessaryLocalVariableJS
                const dummyParent = document.createElement('div');
                return dummyParent;
            } else if (newContent.generatedByIdiomorph) {
                // the template tag created by idiomorph parsing can serve as a dummy parent
                return newContent;
            } else if (newContent instanceof Node) {
                // a single node is added as a child to a dummy parent
                const dummyParent = document.createElement('div');
                dummyParent.append(newContent);
                return dummyParent;
            } else {
                // all nodes in the array or HTMLElement collection are consolidated under
                // a single dummy parent element
                const dummyParent = document.createElement('div');
                for (const elt of [...newContent]) {
                    dummyParent.append(elt);
                }
                return dummyParent;
            }
        }

        function insertSiblings(previousSibling, morphedNode, nextSibling) {
            let stack = [];
            let added = [];
            while (previousSibling != null) {
                stack.push(previousSibling);
                previousSibling = previousSibling.previousSibling;
            }
            while (stack.length > 0) {
                let node = stack.pop();
                added.push(node); // push added preceding siblings on in order and insert
                morphedNode.parentElement.insertBefore(node, morphedNode);
            }
            added.push(morphedNode);
            while (nextSibling != null) {
                stack.push(nextSibling);
                added.push(nextSibling); // here we are going in order, so push on as we scan, rather than add
                nextSibling = nextSibling.nextSibling;
            }
            while (stack.length > 0) {
                morphedNode.parentElement.insertBefore(stack.pop(), morphedNode.nextSibling);
            }
            return added;
        }

        function findBestNodeMatch(newContent, oldNode, ctx) {
            let currentElement;
            currentElement = newContent.firstChild;
            let bestElement = currentElement;
            let score = 0;
            while (currentElement) {
                let newScore = scoreElement(currentElement, oldNode, ctx);
                if (newScore > score) {
                    bestElement = currentElement;
                    score = newScore;
                }
                currentElement = currentElement.nextSibling;
            }
            return bestElement;
        }

        function scoreElement(node1, node2, ctx) {
            if (isSoftMatch(node1, node2)) {
                return .5 + getIdIntersectionCount(ctx, node1, node2);
            }
            return 0;
        }

        function removeNode(tempNode, ctx) {
            removeIdsFromConsideration(ctx, tempNode);
            if (ctx.callbacks.beforeNodeRemoved(tempNode) === false) return;

            tempNode.remove();
            ctx.callbacks.afterNodeRemoved(tempNode);
        }

        //=============================================================================
        // ID Set Functions
        //=============================================================================

        function isIdInConsideration(ctx, id) {
            return !ctx.deadIds.has(id);
        }

        function idIsWithinNode(ctx, id, targetNode) {
            let idSet = ctx.idMap.get(targetNode) || EMPTY_SET;
            return idSet.has(id);
        }

        function removeIdsFromConsideration(ctx, node) {
            let idSet = ctx.idMap.get(node) || EMPTY_SET;
            for (const id of idSet) {
                ctx.deadIds.add(id);
            }
        }

        function getIdIntersectionCount(ctx, node1, node2) {
            let sourceSet = ctx.idMap.get(node1) || EMPTY_SET;
            let matchCount = 0;
            for (const id of sourceSet) {
                // a potential match is an id in the source and potentialIdsSet, but
                // that has not already been merged into the DOM
                if (isIdInConsideration(ctx, id) && idIsWithinNode(ctx, id, node2)) {
                    ++matchCount;
                }
            }
            return matchCount;
        }

        /**
         * A bottom up algorithm that finds all elements with ids inside of the node
         * argument and populates id sets for those nodes and all their parents, generating
         * a set of ids contained within all nodes for the entire hierarchy in the DOM
         *
         * @param node {Element}
         * @param {Map<Node, Set<String>>} idMap
         */
        function populateIdMapForNode(node, idMap) {
            let nodeParent = node.parentElement;
            // find all elements with an id property
            let idElements = node.querySelectorAll('[id]');
            for (const elt of idElements) {
                let current = elt;
                // walk up the parent hierarchy of that element, adding the id
                // of element to the parent's id set
                while (current !== nodeParent && current != null) {
                    let idSet = idMap.get(current);
                    // if the id set doesn't exist, create it and insert it in the  map
                    if (idSet == null) {
                        idSet = new Set();
                        idMap.set(current, idSet);
                    }
                    idSet.add(elt.id);
                    current = current.parentElement;
                }
            }
        }

        /**
         * This function computes a map of nodes to all ids contained within that node (inclusive of the
         * node).  This map can be used to ask if two nodes have intersecting sets of ids, which allows
         * for a looser definition of "matching" than tradition id matching, and allows child nodes
         * to contribute to a parent nodes matching.
         *
         * @param {Element} oldContent  the old content that will be morphed
         * @param {Element} newContent  the new content to morph to
         * @returns {Map<Node, Set<String>>} a map of nodes to id sets for the
         */
        function createIdMap(oldContent, newContent) {
            let idMap = new Map();
            populateIdMapForNode(oldContent, idMap);
            populateIdMapForNode(newContent, idMap);
            return idMap;
        }

        //=============================================================================
        // This is what ends up becoming the Idiomorph global object
        //=============================================================================
        return {
            morph,
            defaults
        }
    })();

function morphElements(currentElement, newElement, { callbacks, ...options } = {}) {
  Idiomorph.morph(currentElement, newElement, {
    ...options,
    callbacks: new DefaultIdiomorphCallbacks(callbacks)
  });
}

function morphChildren(currentElement, newElement) {
  morphElements(currentElement, newElement.children, {
    morphStyle: "innerHTML"
  });
}

class DefaultIdiomorphCallbacks {
  #beforeNodeMorphed

  constructor({ beforeNodeMorphed } = {}) {
    this.#beforeNodeMorphed = beforeNodeMorphed || (() => true);
  }

  beforeNodeAdded = (node) => {
    return !(node.id && node.hasAttribute("data-turbo-permanent") && document.getElementById(node.id))
  }

  beforeNodeMorphed = (currentElement, newElement) => {
    if (currentElement instanceof Element) {
      if (!currentElement.hasAttribute("data-turbo-permanent") && this.#beforeNodeMorphed(currentElement, newElement)) {
        const event = dispatch("turbo:before-morph-element", {
          cancelable: true,
          target: currentElement,
          detail: { currentElement, newElement }
        });

        return !event.defaultPrevented
      } else {
        return false
      }
    }
  }

  beforeAttributeUpdated = (attributeName, target, mutationType) => {
    const event = dispatch("turbo:before-morph-attribute", {
      cancelable: true,
      target,
      detail: { attributeName, mutationType }
    });

    return !event.defaultPrevented
  }

  beforeNodeRemoved = (node) => {
    return this.beforeNodeMorphed(node)
  }

  afterNodeMorphed = (currentElement, newElement) => {
    if (currentElement instanceof Element) {
      dispatch("turbo:morph-element", {
        target: currentElement,
        detail: { currentElement, newElement }
      });
    }
  }
}

class MorphingFrameRenderer extends FrameRenderer {
  static renderElement(currentElement, newElement) {
    dispatch("turbo:before-frame-morph", {
      target: currentElement,
      detail: { currentElement, newElement }
    });

    morphChildren(currentElement, newElement);
  }

  async preservingPermanentElements(callback) {
    return await callback()
  }
}

class ProgressBar {
  static animationDuration = 300 /*ms*/

  static get defaultCSS() {
    return unindent`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${ProgressBar.animationDuration}ms ease-out,
          opacity ${ProgressBar.animationDuration / 2}ms ${ProgressBar.animationDuration / 2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `
  }

  hiding = false
  value = 0
  visible = false

  constructor() {
    this.stylesheetElement = this.createStylesheetElement();
    this.progressElement = this.createProgressElement();
    this.installStylesheetElement();
    this.setValue(0);
  }

  show() {
    if (!this.visible) {
      this.visible = true;
      this.installProgressElement();
      this.startTrickling();
    }
  }

  hide() {
    if (this.visible && !this.hiding) {
      this.hiding = true;
      this.fadeProgressElement(() => {
        this.uninstallProgressElement();
        this.stopTrickling();
        this.visible = false;
        this.hiding = false;
      });
    }
  }

  setValue(value) {
    this.value = value;
    this.refresh();
  }

  // Private

  installStylesheetElement() {
    document.head.insertBefore(this.stylesheetElement, document.head.firstChild);
  }

  installProgressElement() {
    this.progressElement.style.width = "0";
    this.progressElement.style.opacity = "1";
    document.documentElement.insertBefore(this.progressElement, document.body);
    this.refresh();
  }

  fadeProgressElement(callback) {
    this.progressElement.style.opacity = "0";
    setTimeout(callback, ProgressBar.animationDuration * 1.5);
  }

  uninstallProgressElement() {
    if (this.progressElement.parentNode) {
      document.documentElement.removeChild(this.progressElement);
    }
  }

  startTrickling() {
    if (!this.trickleInterval) {
      this.trickleInterval = window.setInterval(this.trickle, ProgressBar.animationDuration);
    }
  }

  stopTrickling() {
    window.clearInterval(this.trickleInterval);
    delete this.trickleInterval;
  }

  trickle = () => {
    this.setValue(this.value + Math.random() / 100);
  }

  refresh() {
    requestAnimationFrame(() => {
      this.progressElement.style.width = `${10 + this.value * 90}%`;
    });
  }

  createStylesheetElement() {
    const element = document.createElement("style");
    element.type = "text/css";
    element.textContent = ProgressBar.defaultCSS;
    const cspNonce = getCspNonce();
    if (cspNonce) {
      element.nonce = cspNonce;
    }
    return element
  }

  createProgressElement() {
    const element = document.createElement("div");
    element.className = "turbo-progress-bar";
    return element
  }
}

class HeadSnapshot extends Snapshot {
  detailsByOuterHTML = this.children
    .filter((element) => !elementIsNoscript(element))
    .map((element) => elementWithoutNonce(element))
    .reduce((result, element) => {
      const { outerHTML } = element;
      const details =
        outerHTML in result
          ? result[outerHTML]
          : {
              type: elementType(element),
              tracked: elementIsTracked(element),
              elements: []
            };
      return {
        ...result,
        [outerHTML]: {
          ...details,
          elements: [...details.elements, element]
        }
      }
    }, {})

  get trackedElementSignature() {
    return Object.keys(this.detailsByOuterHTML)
      .filter((outerHTML) => this.detailsByOuterHTML[outerHTML].tracked)
      .join("")
  }

  getScriptElementsNotInSnapshot(snapshot) {
    return this.getElementsMatchingTypeNotInSnapshot("script", snapshot)
  }

  getStylesheetElementsNotInSnapshot(snapshot) {
    return this.getElementsMatchingTypeNotInSnapshot("stylesheet", snapshot)
  }

  getElementsMatchingTypeNotInSnapshot(matchedType, snapshot) {
    return Object.keys(this.detailsByOuterHTML)
      .filter((outerHTML) => !(outerHTML in snapshot.detailsByOuterHTML))
      .map((outerHTML) => this.detailsByOuterHTML[outerHTML])
      .filter(({ type }) => type == matchedType)
      .map(({ elements: [element] }) => element)
  }

  get provisionalElements() {
    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {
      const { type, tracked, elements } = this.detailsByOuterHTML[outerHTML];
      if (type == null && !tracked) {
        return [...result, ...elements]
      } else if (elements.length > 1) {
        return [...result, ...elements.slice(1)]
      } else {
        return result
      }
    }, [])
  }

  getMetaValue(name) {
    const element = this.findMetaElementByName(name);
    return element ? element.getAttribute("content") : null
  }

  findMetaElementByName(name) {
    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {
      const {
        elements: [element]
      } = this.detailsByOuterHTML[outerHTML];
      return elementIsMetaElementWithName(element, name) ? element : result
    }, undefined | undefined)
  }
}

function elementType(element) {
  if (elementIsScript(element)) {
    return "script"
  } else if (elementIsStylesheet(element)) {
    return "stylesheet"
  }
}

function elementIsTracked(element) {
  return element.getAttribute("data-turbo-track") == "reload"
}

function elementIsScript(element) {
  const tagName = element.localName;
  return tagName == "script"
}

function elementIsNoscript(element) {
  const tagName = element.localName;
  return tagName == "noscript"
}

function elementIsStylesheet(element) {
  const tagName = element.localName;
  return tagName == "style" || (tagName == "link" && element.getAttribute("rel") == "stylesheet")
}

function elementIsMetaElementWithName(element, name) {
  const tagName = element.localName;
  return tagName == "meta" && element.getAttribute("name") == name
}

function elementWithoutNonce(element) {
  if (element.hasAttribute("nonce")) {
    element.setAttribute("nonce", "");
  }

  return element
}

class PageSnapshot extends Snapshot {
  static fromHTMLString(html = "") {
    return this.fromDocument(parseHTMLDocument(html))
  }

  static fromElement(element) {
    return this.fromDocument(element.ownerDocument)
  }

  static fromDocument({ documentElement, body, head }) {
    return new this(documentElement, body, new HeadSnapshot(head))
  }

  constructor(documentElement, body, headSnapshot) {
    super(body);
    this.documentElement = documentElement;
    this.headSnapshot = headSnapshot;
  }

  clone() {
    const clonedElement = this.element.cloneNode(true);

    const selectElements = this.element.querySelectorAll("select");
    const clonedSelectElements = clonedElement.querySelectorAll("select");

    for (const [index, source] of selectElements.entries()) {
      const clone = clonedSelectElements[index];
      for (const option of clone.selectedOptions) option.selected = false;
      for (const option of source.selectedOptions) clone.options[option.index].selected = true;
    }

    for (const clonedPasswordInput of clonedElement.querySelectorAll('input[type="password"]')) {
      clonedPasswordInput.value = "";
    }

    return new PageSnapshot(this.documentElement, clonedElement, this.headSnapshot)
  }

  get lang() {
    return this.documentElement.getAttribute("lang")
  }

  get headElement() {
    return this.headSnapshot.element
  }

  get rootLocation() {
    const root = this.getSetting("root") ?? "/";
    return expandURL(root)
  }

  get cacheControlValue() {
    return this.getSetting("cache-control")
  }

  get isPreviewable() {
    return this.cacheControlValue != "no-preview"
  }

  get isCacheable() {
    return this.cacheControlValue != "no-cache"
  }

  get isVisitable() {
    return this.getSetting("visit-control") != "reload"
  }

  get prefersViewTransitions() {
    return this.headSnapshot.getMetaValue("view-transition") === "same-origin"
  }

  get shouldMorphPage() {
    return this.getSetting("refresh-method") === "morph"
  }

  get shouldPreserveScrollPosition() {
    return this.getSetting("refresh-scroll") === "preserve"
  }

  // Private

  getSetting(name) {
    return this.headSnapshot.getMetaValue(`turbo-${name}`)
  }
}

class ViewTransitioner {
  #viewTransitionStarted = false
  #lastOperation = Promise.resolve()

  renderChange(useViewTransition, render) {
    if (useViewTransition && this.viewTransitionsAvailable && !this.#viewTransitionStarted) {
      this.#viewTransitionStarted = true;
      this.#lastOperation = this.#lastOperation.then(async () => {
        await document.startViewTransition(render).finished;
      });
    } else {
      this.#lastOperation = this.#lastOperation.then(render);
    }

    return this.#lastOperation
  }

  get viewTransitionsAvailable() {
    return document.startViewTransition
  }
}

const defaultOptions = {
  action: "advance",
  historyChanged: false,
  visitCachedSnapshot: () => {},
  willRender: true,
  updateHistory: true,
  shouldCacheSnapshot: true,
  acceptsStreamResponse: false
};

const TimingMetric = {
  visitStart: "visitStart",
  requestStart: "requestStart",
  requestEnd: "requestEnd",
  visitEnd: "visitEnd"
};

const VisitState = {
  initialized: "initialized",
  started: "started",
  canceled: "canceled",
  failed: "failed",
  completed: "completed"
};

const SystemStatusCode = {
  networkFailure: 0,
  timeoutFailure: -1,
  contentTypeMismatch: -2
};

const Direction = {
  advance: "forward",
  restore: "back",
  replace: "none"
};

class Visit {
  identifier = uuid() // Required by turbo-ios
  timingMetrics = {}

  followedRedirect = false
  historyChanged = false
  scrolled = false
  shouldCacheSnapshot = true
  acceptsStreamResponse = false
  snapshotCached = false
  state = VisitState.initialized
  viewTransitioner = new ViewTransitioner()

  constructor(delegate, location, restorationIdentifier, options = {}) {
    this.delegate = delegate;
    this.location = location;
    this.restorationIdentifier = restorationIdentifier || uuid();

    const {
      action,
      historyChanged,
      referrer,
      snapshot,
      snapshotHTML,
      response,
      visitCachedSnapshot,
      willRender,
      updateHistory,
      shouldCacheSnapshot,
      acceptsStreamResponse,
      direction
    } = {
      ...defaultOptions,
      ...options
    };
    this.action = action;
    this.historyChanged = historyChanged;
    this.referrer = referrer;
    this.snapshot = snapshot;
    this.snapshotHTML = snapshotHTML;
    this.response = response;
    this.isSamePage = this.delegate.locationWithActionIsSamePage(this.location, this.action);
    this.isPageRefresh = this.view.isPageRefresh(this);
    this.visitCachedSnapshot = visitCachedSnapshot;
    this.willRender = willRender;
    this.updateHistory = updateHistory;
    this.scrolled = !willRender;
    this.shouldCacheSnapshot = shouldCacheSnapshot;
    this.acceptsStreamResponse = acceptsStreamResponse;
    this.direction = direction || Direction[action];
  }

  get adapter() {
    return this.delegate.adapter
  }

  get view() {
    return this.delegate.view
  }

  get history() {
    return this.delegate.history
  }

  get restorationData() {
    return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)
  }

  get silent() {
    return this.isSamePage
  }

  start() {
    if (this.state == VisitState.initialized) {
      this.recordTimingMetric(TimingMetric.visitStart);
      this.state = VisitState.started;
      this.adapter.visitStarted(this);
      this.delegate.visitStarted(this);
    }
  }

  cancel() {
    if (this.state == VisitState.started) {
      if (this.request) {
        this.request.cancel();
      }
      this.cancelRender();
      this.state = VisitState.canceled;
    }
  }

  complete() {
    if (this.state == VisitState.started) {
      this.recordTimingMetric(TimingMetric.visitEnd);
      this.adapter.visitCompleted(this);
      this.state = VisitState.completed;
      this.followRedirect();

      if (!this.followedRedirect) {
        this.delegate.visitCompleted(this);
      }
    }
  }

  fail() {
    if (this.state == VisitState.started) {
      this.state = VisitState.failed;
      this.adapter.visitFailed(this);
      this.delegate.visitCompleted(this);
    }
  }

  changeHistory() {
    if (!this.historyChanged && this.updateHistory) {
      const actionForHistory = this.location.href === this.referrer?.href ? "replace" : this.action;
      const method = getHistoryMethodForAction(actionForHistory);
      this.history.update(method, this.location, this.restorationIdentifier);
      this.historyChanged = true;
    }
  }

  issueRequest() {
    if (this.hasPreloadedResponse()) {
      this.simulateRequest();
    } else if (this.shouldIssueRequest() && !this.request) {
      this.request = new FetchRequest(this, FetchMethod.get, this.location);
      this.request.perform();
    }
  }

  simulateRequest() {
    if (this.response) {
      this.startRequest();
      this.recordResponse();
      this.finishRequest();
    }
  }

  startRequest() {
    this.recordTimingMetric(TimingMetric.requestStart);
    this.adapter.visitRequestStarted(this);
  }

  recordResponse(response = this.response) {
    this.response = response;
    if (response) {
      const { statusCode } = response;
      if (isSuccessful(statusCode)) {
        this.adapter.visitRequestCompleted(this);
      } else {
        this.adapter.visitRequestFailedWithStatusCode(this, statusCode);
      }
    }
  }

  finishRequest() {
    this.recordTimingMetric(TimingMetric.requestEnd);
    this.adapter.visitRequestFinished(this);
  }

  loadResponse() {
    if (this.response) {
      const { statusCode, responseHTML } = this.response;
      this.render(async () => {
        if (this.shouldCacheSnapshot) this.cacheSnapshot();
        if (this.view.renderPromise) await this.view.renderPromise;

        if (isSuccessful(statusCode) && responseHTML != null) {
          const snapshot = PageSnapshot.fromHTMLString(responseHTML);
          await this.renderPageSnapshot(snapshot, false);

          this.adapter.visitRendered(this);
          this.complete();
        } else {
          await this.view.renderError(PageSnapshot.fromHTMLString(responseHTML), this);
          this.adapter.visitRendered(this);
          this.fail();
        }
      });
    }
  }

  getCachedSnapshot() {
    const snapshot = this.view.getCachedSnapshotForLocation(this.location) || this.getPreloadedSnapshot();

    if (snapshot && (!getAnchor(this.location) || snapshot.hasAnchor(getAnchor(this.location)))) {
      if (this.action == "restore" || snapshot.isPreviewable) {
        return snapshot
      }
    }
  }

  getPreloadedSnapshot() {
    if (this.snapshotHTML) {
      return PageSnapshot.fromHTMLString(this.snapshotHTML)
    }
  }

  hasCachedSnapshot() {
    return this.getCachedSnapshot() != null
  }

  loadCachedSnapshot() {
    const snapshot = this.getCachedSnapshot();
    if (snapshot) {
      const isPreview = this.shouldIssueRequest();
      this.render(async () => {
        this.cacheSnapshot();
        if (this.isSamePage || this.isPageRefresh) {
          this.adapter.visitRendered(this);
        } else {
          if (this.view.renderPromise) await this.view.renderPromise;

          await this.renderPageSnapshot(snapshot, isPreview);

          this.adapter.visitRendered(this);
          if (!isPreview) {
            this.complete();
          }
        }
      });
    }
  }

  followRedirect() {
    if (this.redirectedToLocation && !this.followedRedirect && this.response?.redirected) {
      this.adapter.visitProposedToLocation(this.redirectedToLocation, {
        action: "replace",
        response: this.response,
        shouldCacheSnapshot: false,
        willRender: false
      });
      this.followedRedirect = true;
    }
  }

  goToSamePageAnchor() {
    if (this.isSamePage) {
      this.render(async () => {
        this.cacheSnapshot();
        this.performScroll();
        this.changeHistory();
        this.adapter.visitRendered(this);
      });
    }
  }

  // Fetch request delegate

  prepareRequest(request) {
    if (this.acceptsStreamResponse) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted() {
    this.startRequest();
  }

  requestPreventedHandlingResponse(_request, _response) {}

  async requestSucceededWithResponse(request, response) {
    const responseHTML = await response.responseHTML;
    const { redirected, statusCode } = response;
    if (responseHTML == undefined) {
      this.recordResponse({
        statusCode: SystemStatusCode.contentTypeMismatch,
        redirected
      });
    } else {
      this.redirectedToLocation = response.redirected ? response.location : undefined;
      this.recordResponse({ statusCode: statusCode, responseHTML, redirected });
    }
  }

  async requestFailedWithResponse(request, response) {
    const responseHTML = await response.responseHTML;
    const { redirected, statusCode } = response;
    if (responseHTML == undefined) {
      this.recordResponse({
        statusCode: SystemStatusCode.contentTypeMismatch,
        redirected
      });
    } else {
      this.recordResponse({ statusCode: statusCode, responseHTML, redirected });
    }
  }

  requestErrored(_request, _error) {
    this.recordResponse({
      statusCode: SystemStatusCode.networkFailure,
      redirected: false
    });
  }

  requestFinished() {
    this.finishRequest();
  }

  // Scrolling

  performScroll() {
    if (!this.scrolled && !this.view.forceReloaded && !this.view.shouldPreserveScrollPosition(this)) {
      if (this.action == "restore") {
        this.scrollToRestoredPosition() || this.scrollToAnchor() || this.view.scrollToTop();
      } else {
        this.scrollToAnchor() || this.view.scrollToTop();
      }
      if (this.isSamePage) {
        this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation, this.location);
      }

      this.scrolled = true;
    }
  }

  scrollToRestoredPosition() {
    const { scrollPosition } = this.restorationData;
    if (scrollPosition) {
      this.view.scrollToPosition(scrollPosition);
      return true
    }
  }

  scrollToAnchor() {
    const anchor = getAnchor(this.location);
    if (anchor != null) {
      this.view.scrollToAnchor(anchor);
      return true
    }
  }

  // Instrumentation

  recordTimingMetric(metric) {
    this.timingMetrics[metric] = new Date().getTime();
  }

  getTimingMetrics() {
    return { ...this.timingMetrics }
  }

  // Private

  getHistoryMethodForAction(action) {
    switch (action) {
      case "replace":
        return history.replaceState
      case "advance":
      case "restore":
        return history.pushState
    }
  }

  hasPreloadedResponse() {
    return typeof this.response == "object"
  }

  shouldIssueRequest() {
    if (this.isSamePage) {
      return false
    } else if (this.action == "restore") {
      return !this.hasCachedSnapshot()
    } else {
      return this.willRender
    }
  }

  cacheSnapshot() {
    if (!this.snapshotCached) {
      this.view.cacheSnapshot(this.snapshot).then((snapshot) => snapshot && this.visitCachedSnapshot(snapshot));
      this.snapshotCached = true;
    }
  }

  async render(callback) {
    this.cancelRender();
    await new Promise((resolve) => {
      this.frame =
        document.visibilityState === "hidden" ? setTimeout(() => resolve(), 0) : requestAnimationFrame(() => resolve());
    });
    await callback();
    delete this.frame;
  }

  async renderPageSnapshot(snapshot, isPreview) {
    await this.viewTransitioner.renderChange(this.view.shouldTransitionTo(snapshot), async () => {
      await this.view.renderPage(snapshot, isPreview, this.willRender, this);
      this.performScroll();
    });
  }

  cancelRender() {
    if (this.frame) {
      cancelAnimationFrame(this.frame);
      delete this.frame;
    }
  }
}

function isSuccessful(statusCode) {
  return statusCode >= 200 && statusCode < 300
}

class BrowserAdapter {
  progressBar = new ProgressBar()

  constructor(session) {
    this.session = session;
  }

  visitProposedToLocation(location, options) {
    if (locationIsVisitable(location, this.navigator.rootLocation)) {
      this.navigator.startVisit(location, options?.restorationIdentifier || uuid(), options);
    } else {
      window.location.href = location.toString();
    }
  }

  visitStarted(visit) {
    this.location = visit.location;
    visit.loadCachedSnapshot();
    visit.issueRequest();
    visit.goToSamePageAnchor();
  }

  visitRequestStarted(visit) {
    this.progressBar.setValue(0);
    if (visit.hasCachedSnapshot() || visit.action != "restore") {
      this.showVisitProgressBarAfterDelay();
    } else {
      this.showProgressBar();
    }
  }

  visitRequestCompleted(visit) {
    visit.loadResponse();
  }

  visitRequestFailedWithStatusCode(visit, statusCode) {
    switch (statusCode) {
      case SystemStatusCode.networkFailure:
      case SystemStatusCode.timeoutFailure:
      case SystemStatusCode.contentTypeMismatch:
        return this.reload({
          reason: "request_failed",
          context: {
            statusCode
          }
        })
      default:
        return visit.loadResponse()
    }
  }

  visitRequestFinished(_visit) {}

  visitCompleted(_visit) {
    this.progressBar.setValue(1);
    this.hideVisitProgressBar();
  }

  pageInvalidated(reason) {
    this.reload(reason);
  }

  visitFailed(_visit) {
    this.progressBar.setValue(1);
    this.hideVisitProgressBar();
  }

  visitRendered(_visit) {}

  // Form Submission Delegate

  formSubmissionStarted(_formSubmission) {
    this.progressBar.setValue(0);
    this.showFormProgressBarAfterDelay();
  }

  formSubmissionFinished(_formSubmission) {
    this.progressBar.setValue(1);
    this.hideFormProgressBar();
  }

  // Private

  showVisitProgressBarAfterDelay() {
    this.visitProgressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay);
  }

  hideVisitProgressBar() {
    this.progressBar.hide();
    if (this.visitProgressBarTimeout != null) {
      window.clearTimeout(this.visitProgressBarTimeout);
      delete this.visitProgressBarTimeout;
    }
  }

  showFormProgressBarAfterDelay() {
    if (this.formProgressBarTimeout == null) {
      this.formProgressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay);
    }
  }

  hideFormProgressBar() {
    this.progressBar.hide();
    if (this.formProgressBarTimeout != null) {
      window.clearTimeout(this.formProgressBarTimeout);
      delete this.formProgressBarTimeout;
    }
  }

  showProgressBar = () => {
    this.progressBar.show();
  }

  reload(reason) {
    dispatch("turbo:reload", { detail: reason });

    window.location.href = this.location?.toString() || window.location.href;
  }

  get navigator() {
    return this.session.navigator
  }
}

class CacheObserver {
  selector = "[data-turbo-temporary]"
  deprecatedSelector = "[data-turbo-cache=false]"

  started = false

  start() {
    if (!this.started) {
      this.started = true;
      addEventListener("turbo:before-cache", this.removeTemporaryElements, false);
    }
  }

  stop() {
    if (this.started) {
      this.started = false;
      removeEventListener("turbo:before-cache", this.removeTemporaryElements, false);
    }
  }

  removeTemporaryElements = (_event) => {
    for (const element of this.temporaryElements) {
      element.remove();
    }
  }

  get temporaryElements() {
    return [...document.querySelectorAll(this.selector), ...this.temporaryElementsWithDeprecation]
  }

  get temporaryElementsWithDeprecation() {
    const elements = document.querySelectorAll(this.deprecatedSelector);

    if (elements.length) {
      console.warn(
        `The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`
      );
    }

    return [...elements]
  }
}

class FrameRedirector {
  constructor(session, element) {
    this.session = session;
    this.element = element;
    this.linkInterceptor = new LinkInterceptor(this, element);
    this.formSubmitObserver = new FormSubmitObserver(this, element);
  }

  start() {
    this.linkInterceptor.start();
    this.formSubmitObserver.start();
  }

  stop() {
    this.linkInterceptor.stop();
    this.formSubmitObserver.stop();
  }

  // Link interceptor delegate

  shouldInterceptLinkClick(element, _location, _event) {
    return this.#shouldRedirect(element)
  }

  linkClickIntercepted(element, url, event) {
    const frame = this.#findFrameElement(element);
    if (frame) {
      frame.delegate.linkClickIntercepted(element, url, event);
    }
  }

  // Form submit observer delegate

  willSubmitForm(element, submitter) {
    return (
      element.closest("turbo-frame") == null &&
      this.#shouldSubmit(element, submitter) &&
      this.#shouldRedirect(element, submitter)
    )
  }

  formSubmitted(element, submitter) {
    const frame = this.#findFrameElement(element, submitter);
    if (frame) {
      frame.delegate.formSubmitted(element, submitter);
    }
  }

  #shouldSubmit(form, submitter) {
    const action = getAction$1(form, submitter);
    const meta = this.element.ownerDocument.querySelector(`meta[name="turbo-root"]`);
    const rootLocation = expandURL(meta?.content ?? "/");

    return this.#shouldRedirect(form, submitter) && locationIsVisitable(action, rootLocation)
  }

  #shouldRedirect(element, submitter) {
    const isNavigatable =
      element instanceof HTMLFormElement
        ? this.session.submissionIsNavigatable(element, submitter)
        : this.session.elementIsNavigatable(element);

    if (isNavigatable) {
      const frame = this.#findFrameElement(element, submitter);
      return frame ? frame != element.closest("turbo-frame") : false
    } else {
      return false
    }
  }

  #findFrameElement(element, submitter) {
    const id = submitter?.getAttribute("data-turbo-frame") || element.getAttribute("data-turbo-frame");
    if (id && id != "_top") {
      const frame = this.element.querySelector(`#${id}:not([disabled])`);
      if (frame instanceof FrameElement) {
        return frame
      }
    }
  }
}

class History {
  location
  restorationIdentifier = uuid()
  restorationData = {}
  started = false
  pageLoaded = false
  currentIndex = 0

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      addEventListener("popstate", this.onPopState, false);
      addEventListener("load", this.onPageLoad, false);
      this.currentIndex = history.state?.turbo?.restorationIndex || 0;
      this.started = true;
      this.replace(new URL(window.location.href));
    }
  }

  stop() {
    if (this.started) {
      removeEventListener("popstate", this.onPopState, false);
      removeEventListener("load", this.onPageLoad, false);
      this.started = false;
    }
  }

  push(location, restorationIdentifier) {
    this.update(history.pushState, location, restorationIdentifier);
  }

  replace(location, restorationIdentifier) {
    this.update(history.replaceState, location, restorationIdentifier);
  }

  update(method, location, restorationIdentifier = uuid()) {
    if (method === history.pushState) ++this.currentIndex;

    const state = { turbo: { restorationIdentifier, restorationIndex: this.currentIndex } };
    method.call(history, state, "", location.href);
    this.location = location;
    this.restorationIdentifier = restorationIdentifier;
  }

  // Restoration data

  getRestorationDataForIdentifier(restorationIdentifier) {
    return this.restorationData[restorationIdentifier] || {}
  }

  updateRestorationData(additionalData) {
    const { restorationIdentifier } = this;
    const restorationData = this.restorationData[restorationIdentifier];
    this.restorationData[restorationIdentifier] = {
      ...restorationData,
      ...additionalData
    };
  }

  // Scroll restoration

  assumeControlOfScrollRestoration() {
    if (!this.previousScrollRestoration) {
      this.previousScrollRestoration = history.scrollRestoration ?? "auto";
      history.scrollRestoration = "manual";
    }
  }

  relinquishControlOfScrollRestoration() {
    if (this.previousScrollRestoration) {
      history.scrollRestoration = this.previousScrollRestoration;
      delete this.previousScrollRestoration;
    }
  }

  // Event handlers

  onPopState = (event) => {
    if (this.shouldHandlePopState()) {
      const { turbo } = event.state || {};
      if (turbo) {
        this.location = new URL(window.location.href);
        const { restorationIdentifier, restorationIndex } = turbo;
        this.restorationIdentifier = restorationIdentifier;
        const direction = restorationIndex > this.currentIndex ? "forward" : "back";
        this.delegate.historyPoppedToLocationWithRestorationIdentifierAndDirection(this.location, restorationIdentifier, direction);
        this.currentIndex = restorationIndex;
      }
    }
  }

  onPageLoad = async (_event) => {
    await nextMicrotask();
    this.pageLoaded = true;
  }

  // Private

  shouldHandlePopState() {
    // Safari dispatches a popstate event after window's load event, ignore it
    return this.pageIsLoaded()
  }

  pageIsLoaded() {
    return this.pageLoaded || document.readyState == "complete"
  }
}

class LinkPrefetchObserver {
  started = false
  #prefetchedLink = null

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (this.started) return

    if (this.eventTarget.readyState === "loading") {
      this.eventTarget.addEventListener("DOMContentLoaded", this.#enable, { once: true });
    } else {
      this.#enable();
    }
  }

  stop() {
    if (!this.started) return

    this.eventTarget.removeEventListener("mouseenter", this.#tryToPrefetchRequest, {
      capture: true,
      passive: true
    });
    this.eventTarget.removeEventListener("mouseleave", this.#cancelRequestIfObsolete, {
      capture: true,
      passive: true
    });

    this.eventTarget.removeEventListener("turbo:before-fetch-request", this.#tryToUsePrefetchedRequest, true);
    this.started = false;
  }

  #enable = () => {
    this.eventTarget.addEventListener("mouseenter", this.#tryToPrefetchRequest, {
      capture: true,
      passive: true
    });
    this.eventTarget.addEventListener("mouseleave", this.#cancelRequestIfObsolete, {
      capture: true,
      passive: true
    });

    this.eventTarget.addEventListener("turbo:before-fetch-request", this.#tryToUsePrefetchedRequest, true);
    this.started = true;
  }

  #tryToPrefetchRequest = (event) => {
    if (getMetaContent("turbo-prefetch") === "false") return

    const target = event.target;
    const isLink = target.matches && target.matches("a[href]:not([target^=_]):not([download])");

    if (isLink && this.#isPrefetchable(target)) {
      const link = target;
      const location = getLocationForLink(link);

      if (this.delegate.canPrefetchRequestToLocation(link, location)) {
        this.#prefetchedLink = link;

        const fetchRequest = new FetchRequest(
          this,
          FetchMethod.get,
          location,
          new URLSearchParams(),
          target
        );

        prefetchCache.setLater(location.toString(), fetchRequest, this.#cacheTtl);
      }
    }
  }

  #cancelRequestIfObsolete = (event) => {
    if (event.target === this.#prefetchedLink) this.#cancelPrefetchRequest();
  }

  #cancelPrefetchRequest = () => {
    prefetchCache.clear();
    this.#prefetchedLink = null;
  }

  #tryToUsePrefetchedRequest = (event) => {
    if (event.target.tagName !== "FORM" && event.detail.fetchOptions.method === "GET") {
      const cached = prefetchCache.get(event.detail.url.toString());

      if (cached) {
        // User clicked link, use cache response
        event.detail.fetchRequest = cached;
      }

      prefetchCache.clear();
    }
  }

  prepareRequest(request) {
    const link = request.target;

    request.headers["X-Sec-Purpose"] = "prefetch";

    const turboFrame = link.closest("turbo-frame");
    const turboFrameTarget = link.getAttribute("data-turbo-frame") || turboFrame?.getAttribute("target") || turboFrame?.id;

    if (turboFrameTarget && turboFrameTarget !== "_top") {
      request.headers["Turbo-Frame"] = turboFrameTarget;
    }
  }

  // Fetch request interface

  requestSucceededWithResponse() {}

  requestStarted(fetchRequest) {}

  requestErrored(fetchRequest) {}

  requestFinished(fetchRequest) {}

  requestPreventedHandlingResponse(fetchRequest, fetchResponse) {}

  requestFailedWithResponse(fetchRequest, fetchResponse) {}

  get #cacheTtl() {
    return Number(getMetaContent("turbo-prefetch-cache-time")) || cacheTtl
  }

  #isPrefetchable(link) {
    const href = link.getAttribute("href");

    if (!href) return false

    if (unfetchableLink(link)) return false
    if (linkToTheSamePage(link)) return false
    if (linkOptsOut(link)) return false
    if (nonSafeLink(link)) return false
    if (eventPrevented(link)) return false

    return true
  }
}

const unfetchableLink = (link) => {
  return link.origin !== document.location.origin || !["http:", "https:"].includes(link.protocol) || link.hasAttribute("target")
};

const linkToTheSamePage = (link) => {
  return (link.pathname + link.search === document.location.pathname + document.location.search) || link.href.startsWith("#")
};

const linkOptsOut = (link) => {
  if (link.getAttribute("data-turbo-prefetch") === "false") return true
  if (link.getAttribute("data-turbo") === "false") return true

  const turboPrefetchParent = findClosestRecursively(link, "[data-turbo-prefetch]");
  if (turboPrefetchParent && turboPrefetchParent.getAttribute("data-turbo-prefetch") === "false") return true

  return false
};

const nonSafeLink = (link) => {
  const turboMethod = link.getAttribute("data-turbo-method");
  if (turboMethod && turboMethod.toLowerCase() !== "get") return true

  if (isUJS(link)) return true
  if (link.hasAttribute("data-turbo-confirm")) return true
  if (link.hasAttribute("data-turbo-stream")) return true

  return false
};

const isUJS = (link) => {
  return link.hasAttribute("data-remote") || link.hasAttribute("data-behavior") || link.hasAttribute("data-confirm") || link.hasAttribute("data-method")
};

const eventPrevented = (link) => {
  const event = dispatch("turbo:before-prefetch", { target: link, cancelable: true });
  return event.defaultPrevented
};

class Navigator {
  constructor(delegate) {
    this.delegate = delegate;
  }

  proposeVisit(location, options = {}) {
    if (this.delegate.allowsVisitingLocationWithAction(location, options.action)) {
      this.delegate.visitProposedToLocation(location, options);
    }
  }

  startVisit(locatable, restorationIdentifier, options = {}) {
    this.stop();
    this.currentVisit = new Visit(this, expandURL(locatable), restorationIdentifier, {
      referrer: this.location,
      ...options
    });
    this.currentVisit.start();
  }

  submitForm(form, submitter) {
    this.stop();
    this.formSubmission = new FormSubmission(this, form, submitter, true);

    this.formSubmission.start();
  }

  stop() {
    if (this.formSubmission) {
      this.formSubmission.stop();
      delete this.formSubmission;
    }

    if (this.currentVisit) {
      this.currentVisit.cancel();
      delete this.currentVisit;
    }
  }

  get adapter() {
    return this.delegate.adapter
  }

  get view() {
    return this.delegate.view
  }

  get rootLocation() {
    return this.view.snapshot.rootLocation
  }

  get history() {
    return this.delegate.history
  }

  // Form submission delegate

  formSubmissionStarted(formSubmission) {
    // Not all adapters implement formSubmissionStarted
    if (typeof this.adapter.formSubmissionStarted === "function") {
      this.adapter.formSubmissionStarted(formSubmission);
    }
  }

  async formSubmissionSucceededWithResponse(formSubmission, fetchResponse) {
    if (formSubmission == this.formSubmission) {
      const responseHTML = await fetchResponse.responseHTML;
      if (responseHTML) {
        const shouldCacheSnapshot = formSubmission.isSafe;
        if (!shouldCacheSnapshot) {
          this.view.clearSnapshotCache();
        }

        const { statusCode, redirected } = fetchResponse;
        const action = this.#getActionForFormSubmission(formSubmission, fetchResponse);
        const visitOptions = {
          action,
          shouldCacheSnapshot,
          response: { statusCode, responseHTML, redirected }
        };
        this.proposeVisit(fetchResponse.location, visitOptions);
      }
    }
  }

  async formSubmissionFailedWithResponse(formSubmission, fetchResponse) {
    const responseHTML = await fetchResponse.responseHTML;

    if (responseHTML) {
      const snapshot = PageSnapshot.fromHTMLString(responseHTML);
      if (fetchResponse.serverError) {
        await this.view.renderError(snapshot, this.currentVisit);
      } else {
        await this.view.renderPage(snapshot, false, true, this.currentVisit);
      }
      if(!snapshot.shouldPreserveScrollPosition) {
        this.view.scrollToTop();
      }
      this.view.clearSnapshotCache();
    }
  }

  formSubmissionErrored(formSubmission, error) {
    console.error(error);
  }

  formSubmissionFinished(formSubmission) {
    // Not all adapters implement formSubmissionFinished
    if (typeof this.adapter.formSubmissionFinished === "function") {
      this.adapter.formSubmissionFinished(formSubmission);
    }
  }

  // Visit delegate

  visitStarted(visit) {
    this.delegate.visitStarted(visit);
  }

  visitCompleted(visit) {
    this.delegate.visitCompleted(visit);
    delete this.currentVisit;
  }

  locationWithActionIsSamePage(location, action) {
    const anchor = getAnchor(location);
    const currentAnchor = getAnchor(this.view.lastRenderedLocation);
    const isRestorationToTop = action === "restore" && typeof anchor === "undefined";

    return (
      action !== "replace" &&
      getRequestURL(location) === getRequestURL(this.view.lastRenderedLocation) &&
      (isRestorationToTop || (anchor != null && anchor !== currentAnchor))
    )
  }

  visitScrolledToSamePageLocation(oldURL, newURL) {
    this.delegate.visitScrolledToSamePageLocation(oldURL, newURL);
  }

  // Visits

  get location() {
    return this.history.location
  }

  get restorationIdentifier() {
    return this.history.restorationIdentifier
  }

  #getActionForFormSubmission(formSubmission, fetchResponse) {
    const { submitter, formElement } = formSubmission;
    return getVisitAction(submitter, formElement) || this.#getDefaultAction(fetchResponse)
  }

  #getDefaultAction(fetchResponse) {
    const sameLocationRedirect = fetchResponse.redirected && fetchResponse.location.href === this.location?.href;
    return sameLocationRedirect ? "replace" : "advance"
  }
}

const PageStage = {
  initial: 0,
  loading: 1,
  interactive: 2,
  complete: 3
};

class PageObserver {
  stage = PageStage.initial
  started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      if (this.stage == PageStage.initial) {
        this.stage = PageStage.loading;
      }
      document.addEventListener("readystatechange", this.interpretReadyState, false);
      addEventListener("pagehide", this.pageWillUnload, false);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      document.removeEventListener("readystatechange", this.interpretReadyState, false);
      removeEventListener("pagehide", this.pageWillUnload, false);
      this.started = false;
    }
  }

  interpretReadyState = () => {
    const { readyState } = this;
    if (readyState == "interactive") {
      this.pageIsInteractive();
    } else if (readyState == "complete") {
      this.pageIsComplete();
    }
  }

  pageIsInteractive() {
    if (this.stage == PageStage.loading) {
      this.stage = PageStage.interactive;
      this.delegate.pageBecameInteractive();
    }
  }

  pageIsComplete() {
    this.pageIsInteractive();
    if (this.stage == PageStage.interactive) {
      this.stage = PageStage.complete;
      this.delegate.pageLoaded();
    }
  }

  pageWillUnload = () => {
    this.delegate.pageWillUnload();
  }

  get readyState() {
    return document.readyState
  }
}

class ScrollObserver {
  started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      addEventListener("scroll", this.onScroll, false);
      this.onScroll();
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      removeEventListener("scroll", this.onScroll, false);
      this.started = false;
    }
  }

  onScroll = () => {
    this.updatePosition({ x: window.pageXOffset, y: window.pageYOffset });
  }

  // Private

  updatePosition(position) {
    this.delegate.scrollPositionChanged(position);
  }
}

class StreamMessageRenderer {
  render({ fragment }) {
    Bardo.preservingPermanentElements(this, getPermanentElementMapForFragment(fragment), () => {
      withAutofocusFromFragment(fragment, () => {
        withPreservedFocus(() => {
          document.documentElement.appendChild(fragment);
        });
      });
    });
  }

  // Bardo delegate

  enteringBardo(currentPermanentElement, newPermanentElement) {
    newPermanentElement.replaceWith(currentPermanentElement.cloneNode(true));
  }

  leavingBardo() {}
}

function getPermanentElementMapForFragment(fragment) {
  const permanentElementsInDocument = queryPermanentElementsAll(document.documentElement);
  const permanentElementMap = {};
  for (const permanentElementInDocument of permanentElementsInDocument) {
    const { id } = permanentElementInDocument;

    for (const streamElement of fragment.querySelectorAll("turbo-stream")) {
      const elementInStream = getPermanentElementById(streamElement.templateElement.content, id);

      if (elementInStream) {
        permanentElementMap[id] = [permanentElementInDocument, elementInStream];
      }
    }
  }

  return permanentElementMap
}

async function withAutofocusFromFragment(fragment, callback) {
  const generatedID = `turbo-stream-autofocus-${uuid()}`;
  const turboStreams = fragment.querySelectorAll("turbo-stream");
  const elementWithAutofocus = firstAutofocusableElementInStreams(turboStreams);
  let willAutofocusId = null;

  if (elementWithAutofocus) {
    if (elementWithAutofocus.id) {
      willAutofocusId = elementWithAutofocus.id;
    } else {
      willAutofocusId = generatedID;
    }

    elementWithAutofocus.id = willAutofocusId;
  }

  callback();
  await nextRepaint();

  const hasNoActiveElement = document.activeElement == null || document.activeElement == document.body;

  if (hasNoActiveElement && willAutofocusId) {
    const elementToAutofocus = document.getElementById(willAutofocusId);

    if (elementIsFocusable(elementToAutofocus)) {
      elementToAutofocus.focus();
    }
    if (elementToAutofocus && elementToAutofocus.id == generatedID) {
      elementToAutofocus.removeAttribute("id");
    }
  }
}

async function withPreservedFocus(callback) {
  const [activeElementBeforeRender, activeElementAfterRender] = await around(callback, () => document.activeElement);

  const restoreFocusTo = activeElementBeforeRender && activeElementBeforeRender.id;

  if (restoreFocusTo) {
    const elementToFocus = document.getElementById(restoreFocusTo);

    if (elementIsFocusable(elementToFocus) && elementToFocus != activeElementAfterRender) {
      elementToFocus.focus();
    }
  }
}

function firstAutofocusableElementInStreams(nodeListOfStreamElements) {
  for (const streamElement of nodeListOfStreamElements) {
    const elementWithAutofocus = queryAutofocusableElement(streamElement.templateElement.content);

    if (elementWithAutofocus) return elementWithAutofocus
  }

  return null
}

class StreamObserver {
  sources = new Set()
  #started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.#started) {
      this.#started = true;
      addEventListener("turbo:before-fetch-response", this.inspectFetchResponse, false);
    }
  }

  stop() {
    if (this.#started) {
      this.#started = false;
      removeEventListener("turbo:before-fetch-response", this.inspectFetchResponse, false);
    }
  }

  connectStreamSource(source) {
    if (!this.streamSourceIsConnected(source)) {
      this.sources.add(source);
      source.addEventListener("message", this.receiveMessageEvent, false);
    }
  }

  disconnectStreamSource(source) {
    if (this.streamSourceIsConnected(source)) {
      this.sources.delete(source);
      source.removeEventListener("message", this.receiveMessageEvent, false);
    }
  }

  streamSourceIsConnected(source) {
    return this.sources.has(source)
  }

  inspectFetchResponse = (event) => {
    const response = fetchResponseFromEvent(event);
    if (response && fetchResponseIsStream(response)) {
      event.preventDefault();
      this.receiveMessageResponse(response);
    }
  }

  receiveMessageEvent = (event) => {
    if (this.#started && typeof event.data == "string") {
      this.receiveMessageHTML(event.data);
    }
  }

  async receiveMessageResponse(response) {
    const html = await response.responseHTML;
    if (html) {
      this.receiveMessageHTML(html);
    }
  }

  receiveMessageHTML(html) {
    this.delegate.receivedMessageFromStream(StreamMessage.wrap(html));
  }
}

function fetchResponseFromEvent(event) {
  const fetchResponse = event.detail?.fetchResponse;
  if (fetchResponse instanceof FetchResponse) {
    return fetchResponse
  }
}

function fetchResponseIsStream(response) {
  const contentType = response.contentType ?? "";
  return contentType.startsWith(StreamMessage.contentType)
}

class ErrorRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    const { documentElement, body } = document;

    documentElement.replaceChild(newElement, body);
  }

  async render() {
    this.replaceHeadAndBody();
    this.activateScriptElements();
  }

  replaceHeadAndBody() {
    const { documentElement, head } = document;
    documentElement.replaceChild(this.newHead, head);
    this.renderElement(this.currentElement, this.newElement);
  }

  activateScriptElements() {
    for (const replaceableElement of this.scriptElements) {
      const parentNode = replaceableElement.parentNode;
      if (parentNode) {
        const element = activateScriptElement(replaceableElement);
        parentNode.replaceChild(element, replaceableElement);
      }
    }
  }

  get newHead() {
    return this.newSnapshot.headSnapshot.element
  }

  get scriptElements() {
    return document.documentElement.querySelectorAll("script")
  }
}

class PageRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    if (document.body && newElement instanceof HTMLBodyElement) {
      document.body.replaceWith(newElement);
    } else {
      document.documentElement.appendChild(newElement);
    }
  }

  get shouldRender() {
    return this.newSnapshot.isVisitable && this.trackedElementsAreIdentical
  }

  get reloadReason() {
    if (!this.newSnapshot.isVisitable) {
      return {
        reason: "turbo_visit_control_is_reload"
      }
    }

    if (!this.trackedElementsAreIdentical) {
      return {
        reason: "tracked_element_mismatch"
      }
    }
  }

  async prepareToRender() {
    this.#setLanguage();
    await this.mergeHead();
  }

  async render() {
    if (this.willRender) {
      await this.replaceBody();
    }
  }

  finishRendering() {
    super.finishRendering();
    if (!this.isPreview) {
      this.focusFirstAutofocusableElement();
    }
  }

  get currentHeadSnapshot() {
    return this.currentSnapshot.headSnapshot
  }

  get newHeadSnapshot() {
    return this.newSnapshot.headSnapshot
  }

  get newElement() {
    return this.newSnapshot.element
  }

  #setLanguage() {
    const { documentElement } = this.currentSnapshot;
    const { lang } = this.newSnapshot;

    if (lang) {
      documentElement.setAttribute("lang", lang);
    } else {
      documentElement.removeAttribute("lang");
    }
  }

  async mergeHead() {
    const mergedHeadElements = this.mergeProvisionalElements();
    const newStylesheetElements = this.copyNewHeadStylesheetElements();
    this.copyNewHeadScriptElements();

    await mergedHeadElements;
    await newStylesheetElements;

    if (this.willRender) {
      this.removeUnusedDynamicStylesheetElements();
    }
  }

  async replaceBody() {
    await this.preservingPermanentElements(async () => {
      this.activateNewBody();
      await this.assignNewBody();
    });
  }

  get trackedElementsAreIdentical() {
    return this.currentHeadSnapshot.trackedElementSignature == this.newHeadSnapshot.trackedElementSignature
  }

  async copyNewHeadStylesheetElements() {
    const loadingElements = [];

    for (const element of this.newHeadStylesheetElements) {
      loadingElements.push(waitForLoad(element));

      document.head.appendChild(element);
    }

    await Promise.all(loadingElements);
  }

  copyNewHeadScriptElements() {
    for (const element of this.newHeadScriptElements) {
      document.head.appendChild(activateScriptElement(element));
    }
  }

  removeUnusedDynamicStylesheetElements() {
    for (const element of this.unusedDynamicStylesheetElements) {
      document.head.removeChild(element);
    }
  }

  async mergeProvisionalElements() {
    const newHeadElements = [...this.newHeadProvisionalElements];

    for (const element of this.currentHeadProvisionalElements) {
      if (!this.isCurrentElementInElementList(element, newHeadElements)) {
        document.head.removeChild(element);
      }
    }

    for (const element of newHeadElements) {
      document.head.appendChild(element);
    }
  }

  isCurrentElementInElementList(element, elementList) {
    for (const [index, newElement] of elementList.entries()) {
      // if title element...
      if (element.tagName == "TITLE") {
        if (newElement.tagName != "TITLE") {
          continue
        }
        if (element.innerHTML == newElement.innerHTML) {
          elementList.splice(index, 1);
          return true
        }
      }

      // if any other element...
      if (newElement.isEqualNode(element)) {
        elementList.splice(index, 1);
        return true
      }
    }

    return false
  }

  removeCurrentHeadProvisionalElements() {
    for (const element of this.currentHeadProvisionalElements) {
      document.head.removeChild(element);
    }
  }

  copyNewHeadProvisionalElements() {
    for (const element of this.newHeadProvisionalElements) {
      document.head.appendChild(element);
    }
  }

  activateNewBody() {
    document.adoptNode(this.newElement);
    this.activateNewBodyScriptElements();
  }

  activateNewBodyScriptElements() {
    for (const inertScriptElement of this.newBodyScriptElements) {
      const activatedScriptElement = activateScriptElement(inertScriptElement);
      inertScriptElement.replaceWith(activatedScriptElement);
    }
  }

  async assignNewBody() {
    await this.renderElement(this.currentElement, this.newElement);
  }

  get unusedDynamicStylesheetElements() {
    return this.oldHeadStylesheetElements.filter((element) => {
      return element.getAttribute("data-turbo-track") === "dynamic"
    })
  }

  get oldHeadStylesheetElements() {
    return this.currentHeadSnapshot.getStylesheetElementsNotInSnapshot(this.newHeadSnapshot)
  }

  get newHeadStylesheetElements() {
    return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)
  }

  get newHeadScriptElements() {
    return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)
  }

  get currentHeadProvisionalElements() {
    return this.currentHeadSnapshot.provisionalElements
  }

  get newHeadProvisionalElements() {
    return this.newHeadSnapshot.provisionalElements
  }

  get newBodyScriptElements() {
    return this.newElement.querySelectorAll("script")
  }
}

class MorphingPageRenderer extends PageRenderer {
  static renderElement(currentElement, newElement) {
    morphElements(currentElement, newElement, {
      callbacks: {
        beforeNodeMorphed: element => !canRefreshFrame(element)
      }
    });

    for (const frame of currentElement.querySelectorAll("turbo-frame")) {
      if (canRefreshFrame(frame)) frame.reload();
    }

    dispatch("turbo:morph", { detail: { currentElement, newElement } });
  }

  async preservingPermanentElements(callback) {
    return await callback()
  }

  get renderMethod() {
    return "morph"
  }

  get shouldAutofocus() {
    return false
  }
}

function canRefreshFrame(frame) {
  return frame instanceof FrameElement &&
    frame.src &&
    frame.refresh === "morph" &&
    !frame.closest("[data-turbo-permanent]")
}

class SnapshotCache {
  keys = []
  snapshots = {}

  constructor(size) {
    this.size = size;
  }

  has(location) {
    return toCacheKey(location) in this.snapshots
  }

  get(location) {
    if (this.has(location)) {
      const snapshot = this.read(location);
      this.touch(location);
      return snapshot
    }
  }

  put(location, snapshot) {
    this.write(location, snapshot);
    this.touch(location);
    return snapshot
  }

  clear() {
    this.snapshots = {};
  }

  // Private

  read(location) {
    return this.snapshots[toCacheKey(location)]
  }

  write(location, snapshot) {
    this.snapshots[toCacheKey(location)] = snapshot;
  }

  touch(location) {
    const key = toCacheKey(location);
    const index = this.keys.indexOf(key);
    if (index > -1) this.keys.splice(index, 1);
    this.keys.unshift(key);
    this.trim();
  }

  trim() {
    for (const key of this.keys.splice(this.size)) {
      delete this.snapshots[key];
    }
  }
}

class PageView extends View {
  snapshotCache = new SnapshotCache(10)
  lastRenderedLocation = new URL(location.href)
  forceReloaded = false

  shouldTransitionTo(newSnapshot) {
    return this.snapshot.prefersViewTransitions && newSnapshot.prefersViewTransitions
  }

  renderPage(snapshot, isPreview = false, willRender = true, visit) {
    const shouldMorphPage = this.isPageRefresh(visit) && this.snapshot.shouldMorphPage;
    const rendererClass = shouldMorphPage ? MorphingPageRenderer : PageRenderer;

    const renderer = new rendererClass(this.snapshot, snapshot, isPreview, willRender);

    if (!renderer.shouldRender) {
      this.forceReloaded = true;
    } else {
      visit?.changeHistory();
    }

    return this.render(renderer)
  }

  renderError(snapshot, visit) {
    visit?.changeHistory();
    const renderer = new ErrorRenderer(this.snapshot, snapshot, false);
    return this.render(renderer)
  }

  clearSnapshotCache() {
    this.snapshotCache.clear();
  }

  async cacheSnapshot(snapshot = this.snapshot) {
    if (snapshot.isCacheable) {
      this.delegate.viewWillCacheSnapshot();
      const { lastRenderedLocation: location } = this;
      await nextEventLoopTick();
      const cachedSnapshot = snapshot.clone();
      this.snapshotCache.put(location, cachedSnapshot);
      return cachedSnapshot
    }
  }

  getCachedSnapshotForLocation(location) {
    return this.snapshotCache.get(location)
  }

  isPageRefresh(visit) {
    return !visit || (this.lastRenderedLocation.pathname === visit.location.pathname && visit.action === "replace")
  }

  shouldPreserveScrollPosition(visit) {
    return this.isPageRefresh(visit) && this.snapshot.shouldPreserveScrollPosition
  }

  get snapshot() {
    return PageSnapshot.fromElement(this.element)
  }
}

class Preloader {
  selector = "a[data-turbo-preload]"

  constructor(delegate, snapshotCache) {
    this.delegate = delegate;
    this.snapshotCache = snapshotCache;
  }

  start() {
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", this.#preloadAll);
    } else {
      this.preloadOnLoadLinksForView(document.body);
    }
  }

  stop() {
    document.removeEventListener("DOMContentLoaded", this.#preloadAll);
  }

  preloadOnLoadLinksForView(element) {
    for (const link of element.querySelectorAll(this.selector)) {
      if (this.delegate.shouldPreloadLink(link)) {
        this.preloadURL(link);
      }
    }
  }

  async preloadURL(link) {
    const location = new URL(link.href);

    if (this.snapshotCache.has(location)) {
      return
    }

    const fetchRequest = new FetchRequest(this, FetchMethod.get, location, new URLSearchParams(), link);
    await fetchRequest.perform();
  }

  // Fetch request delegate

  prepareRequest(fetchRequest) {
    fetchRequest.headers["X-Sec-Purpose"] = "prefetch";
  }

  async requestSucceededWithResponse(fetchRequest, fetchResponse) {
    try {
      const responseHTML = await fetchResponse.responseHTML;
      const snapshot = PageSnapshot.fromHTMLString(responseHTML);

      this.snapshotCache.put(fetchRequest.url, snapshot);
    } catch (_) {
      // If we cannot preload that is ok!
    }
  }

  requestStarted(fetchRequest) {}

  requestErrored(fetchRequest) {}

  requestFinished(fetchRequest) {}

  requestPreventedHandlingResponse(fetchRequest, fetchResponse) {}

  requestFailedWithResponse(fetchRequest, fetchResponse) {}

  #preloadAll = () => {
    this.preloadOnLoadLinksForView(document.body);
  }
}

class Cache {
  constructor(session) {
    this.session = session;
  }

  clear() {
    this.session.clearCache();
  }

  resetCacheControl() {
    this.#setCacheControl("");
  }

  exemptPageFromCache() {
    this.#setCacheControl("no-cache");
  }

  exemptPageFromPreview() {
    this.#setCacheControl("no-preview");
  }

  #setCacheControl(value) {
    setMetaContent("turbo-cache-control", value);
  }
}

class Session {
  navigator = new Navigator(this)
  history = new History(this)
  view = new PageView(this, document.documentElement)
  adapter = new BrowserAdapter(this)

  pageObserver = new PageObserver(this)
  cacheObserver = new CacheObserver()
  linkPrefetchObserver = new LinkPrefetchObserver(this, document)
  linkClickObserver = new LinkClickObserver(this, window)
  formSubmitObserver = new FormSubmitObserver(this, document)
  scrollObserver = new ScrollObserver(this)
  streamObserver = new StreamObserver(this)
  formLinkClickObserver = new FormLinkClickObserver(this, document.documentElement)
  frameRedirector = new FrameRedirector(this, document.documentElement)
  streamMessageRenderer = new StreamMessageRenderer()
  cache = new Cache(this)

  enabled = true
  started = false
  #pageRefreshDebouncePeriod = 150

  constructor(recentRequests) {
    this.recentRequests = recentRequests;
    this.preloader = new Preloader(this, this.view.snapshotCache);
    this.debouncedRefresh = this.refresh;
    this.pageRefreshDebouncePeriod = this.pageRefreshDebouncePeriod;
  }

  start() {
    if (!this.started) {
      this.pageObserver.start();
      this.cacheObserver.start();
      this.linkPrefetchObserver.start();
      this.formLinkClickObserver.start();
      this.linkClickObserver.start();
      this.formSubmitObserver.start();
      this.scrollObserver.start();
      this.streamObserver.start();
      this.frameRedirector.start();
      this.history.start();
      this.preloader.start();
      this.started = true;
      this.enabled = true;
    }
  }

  disable() {
    this.enabled = false;
  }

  stop() {
    if (this.started) {
      this.pageObserver.stop();
      this.cacheObserver.stop();
      this.linkPrefetchObserver.stop();
      this.formLinkClickObserver.stop();
      this.linkClickObserver.stop();
      this.formSubmitObserver.stop();
      this.scrollObserver.stop();
      this.streamObserver.stop();
      this.frameRedirector.stop();
      this.history.stop();
      this.preloader.stop();
      this.started = false;
    }
  }

  registerAdapter(adapter) {
    this.adapter = adapter;
  }

  visit(location, options = {}) {
    const frameElement = options.frame ? document.getElementById(options.frame) : null;

    if (frameElement instanceof FrameElement) {
      const action = options.action || getVisitAction(frameElement);

      frameElement.delegate.proposeVisitIfNavigatedWithAction(frameElement, action);
      frameElement.src = location.toString();
    } else {
      this.navigator.proposeVisit(expandURL(location), options);
    }
  }

  refresh(url, requestId) {
    const isRecentRequest = requestId && this.recentRequests.has(requestId);
    if (!isRecentRequest && !this.navigator.currentVisit) {
      this.visit(url, { action: "replace", shouldCacheSnapshot: false });
    }
  }

  connectStreamSource(source) {
    this.streamObserver.connectStreamSource(source);
  }

  disconnectStreamSource(source) {
    this.streamObserver.disconnectStreamSource(source);
  }

  renderStreamMessage(message) {
    this.streamMessageRenderer.render(StreamMessage.wrap(message));
  }

  clearCache() {
    this.view.clearSnapshotCache();
  }

  setProgressBarDelay(delay) {
    console.warn(
      "Please replace `session.setProgressBarDelay(delay)` with `session.progressBarDelay = delay`. The function is deprecated and will be removed in a future version of Turbo.`"
    );

    this.progressBarDelay = delay;
  }

  set progressBarDelay(delay) {
    config.drive.progressBarDelay = delay;
  }

  get progressBarDelay() {
    return config.drive.progressBarDelay
  }

  set drive(value) {
    config.drive.enabled = value;
  }

  get drive() {
    return config.drive.enabled
  }

  set formMode(value) {
    config.forms.mode = value;
  }

  get formMode() {
    return config.forms.mode
  }

  get location() {
    return this.history.location
  }

  get restorationIdentifier() {
    return this.history.restorationIdentifier
  }

  get pageRefreshDebouncePeriod() {
    return this.#pageRefreshDebouncePeriod
  }

  set pageRefreshDebouncePeriod(value) {
    this.refresh = debounce(this.debouncedRefresh.bind(this), value);
    this.#pageRefreshDebouncePeriod = value;
  }

  // Preloader delegate

  shouldPreloadLink(element) {
    const isUnsafe = element.hasAttribute("data-turbo-method");
    const isStream = element.hasAttribute("data-turbo-stream");
    const frameTarget = element.getAttribute("data-turbo-frame");
    const frame = frameTarget == "_top" ?
      null :
      document.getElementById(frameTarget) || findClosestRecursively(element, "turbo-frame:not([disabled])");

    if (isUnsafe || isStream || frame instanceof FrameElement) {
      return false
    } else {
      const location = new URL(element.href);

      return this.elementIsNavigatable(element) && locationIsVisitable(location, this.snapshot.rootLocation)
    }
  }

  // History delegate

  historyPoppedToLocationWithRestorationIdentifierAndDirection(location, restorationIdentifier, direction) {
    if (this.enabled) {
      this.navigator.startVisit(location, restorationIdentifier, {
        action: "restore",
        historyChanged: true,
        direction
      });
    } else {
      this.adapter.pageInvalidated({
        reason: "turbo_disabled"
      });
    }
  }

  // Scroll observer delegate

  scrollPositionChanged(position) {
    this.history.updateRestorationData({ scrollPosition: position });
  }

  // Form click observer delegate

  willSubmitFormLinkToLocation(link, location) {
    return this.elementIsNavigatable(link) && locationIsVisitable(location, this.snapshot.rootLocation)
  }

  submittedFormLinkToLocation() {}

  // Link hover observer delegate

  canPrefetchRequestToLocation(link, location) {
    return (
      this.elementIsNavigatable(link) &&
        locationIsVisitable(location, this.snapshot.rootLocation)
    )
  }

  // Link click observer delegate

  willFollowLinkToLocation(link, location, event) {
    return (
      this.elementIsNavigatable(link) &&
      locationIsVisitable(location, this.snapshot.rootLocation) &&
      this.applicationAllowsFollowingLinkToLocation(link, location, event)
    )
  }

  followedLinkToLocation(link, location) {
    const action = this.getActionForLink(link);
    const acceptsStreamResponse = link.hasAttribute("data-turbo-stream");

    this.visit(location.href, { action, acceptsStreamResponse });
  }

  // Navigator delegate

  allowsVisitingLocationWithAction(location, action) {
    return this.locationWithActionIsSamePage(location, action) || this.applicationAllowsVisitingLocation(location)
  }

  visitProposedToLocation(location, options) {
    extendURLWithDeprecatedProperties(location);
    this.adapter.visitProposedToLocation(location, options);
  }

  // Visit delegate

  visitStarted(visit) {
    if (!visit.acceptsStreamResponse) {
      markAsBusy(document.documentElement);
      this.view.markVisitDirection(visit.direction);
    }
    extendURLWithDeprecatedProperties(visit.location);
    if (!visit.silent) {
      this.notifyApplicationAfterVisitingLocation(visit.location, visit.action);
    }
  }

  visitCompleted(visit) {
    this.view.unmarkVisitDirection();
    clearBusyState(document.documentElement);
    this.notifyApplicationAfterPageLoad(visit.getTimingMetrics());
  }

  locationWithActionIsSamePage(location, action) {
    return this.navigator.locationWithActionIsSamePage(location, action)
  }

  visitScrolledToSamePageLocation(oldURL, newURL) {
    this.notifyApplicationAfterVisitingSamePageLocation(oldURL, newURL);
  }

  // Form submit observer delegate

  willSubmitForm(form, submitter) {
    const action = getAction$1(form, submitter);

    return (
      this.submissionIsNavigatable(form, submitter) &&
      locationIsVisitable(expandURL(action), this.snapshot.rootLocation)
    )
  }

  formSubmitted(form, submitter) {
    this.navigator.submitForm(form, submitter);
  }

  // Page observer delegate

  pageBecameInteractive() {
    this.view.lastRenderedLocation = this.location;
    this.notifyApplicationAfterPageLoad();
  }

  pageLoaded() {
    this.history.assumeControlOfScrollRestoration();
  }

  pageWillUnload() {
    this.history.relinquishControlOfScrollRestoration();
  }

  // Stream observer delegate

  receivedMessageFromStream(message) {
    this.renderStreamMessage(message);
  }

  // Page view delegate

  viewWillCacheSnapshot() {
    if (!this.navigator.currentVisit?.silent) {
      this.notifyApplicationBeforeCachingSnapshot();
    }
  }

  allowsImmediateRender({ element }, options) {
    const event = this.notifyApplicationBeforeRender(element, options);
    const {
      defaultPrevented,
      detail: { render }
    } = event;

    if (this.view.renderer && render) {
      this.view.renderer.renderElement = render;
    }

    return !defaultPrevented
  }

  viewRenderedSnapshot(_snapshot, _isPreview, renderMethod) {
    this.view.lastRenderedLocation = this.history.location;
    this.notifyApplicationAfterRender(renderMethod);
  }

  preloadOnLoadLinksForView(element) {
    this.preloader.preloadOnLoadLinksForView(element);
  }

  viewInvalidated(reason) {
    this.adapter.pageInvalidated(reason);
  }

  // Frame element

  frameLoaded(frame) {
    this.notifyApplicationAfterFrameLoad(frame);
  }

  frameRendered(fetchResponse, frame) {
    this.notifyApplicationAfterFrameRender(fetchResponse, frame);
  }

  // Application events

  applicationAllowsFollowingLinkToLocation(link, location, ev) {
    const event = this.notifyApplicationAfterClickingLinkToLocation(link, location, ev);
    return !event.defaultPrevented
  }

  applicationAllowsVisitingLocation(location) {
    const event = this.notifyApplicationBeforeVisitingLocation(location);
    return !event.defaultPrevented
  }

  notifyApplicationAfterClickingLinkToLocation(link, location, event) {
    return dispatch("turbo:click", {
      target: link,
      detail: { url: location.href, originalEvent: event },
      cancelable: true
    })
  }

  notifyApplicationBeforeVisitingLocation(location) {
    return dispatch("turbo:before-visit", {
      detail: { url: location.href },
      cancelable: true
    })
  }

  notifyApplicationAfterVisitingLocation(location, action) {
    return dispatch("turbo:visit", { detail: { url: location.href, action } })
  }

  notifyApplicationBeforeCachingSnapshot() {
    return dispatch("turbo:before-cache")
  }

  notifyApplicationBeforeRender(newBody, options) {
    return dispatch("turbo:before-render", {
      detail: { newBody, ...options },
      cancelable: true
    })
  }

  notifyApplicationAfterRender(renderMethod) {
    return dispatch("turbo:render", { detail: { renderMethod } })
  }

  notifyApplicationAfterPageLoad(timing = {}) {
    return dispatch("turbo:load", {
      detail: { url: this.location.href, timing }
    })
  }

  notifyApplicationAfterVisitingSamePageLocation(oldURL, newURL) {
    dispatchEvent(
      new HashChangeEvent("hashchange", {
        oldURL: oldURL.toString(),
        newURL: newURL.toString()
      })
    );
  }

  notifyApplicationAfterFrameLoad(frame) {
    return dispatch("turbo:frame-load", { target: frame })
  }

  notifyApplicationAfterFrameRender(fetchResponse, frame) {
    return dispatch("turbo:frame-render", {
      detail: { fetchResponse },
      target: frame,
      cancelable: true
    })
  }

  // Helpers

  submissionIsNavigatable(form, submitter) {
    if (config.forms.mode == "off") {
      return false
    } else {
      const submitterIsNavigatable = submitter ? this.elementIsNavigatable(submitter) : true;

      if (config.forms.mode == "optin") {
        return submitterIsNavigatable && form.closest('[data-turbo="true"]') != null
      } else {
        return submitterIsNavigatable && this.elementIsNavigatable(form)
      }
    }
  }

  elementIsNavigatable(element) {
    const container = findClosestRecursively(element, "[data-turbo]");
    const withinFrame = findClosestRecursively(element, "turbo-frame");

    // Check if Drive is enabled on the session or we're within a Frame.
    if (config.drive.enabled || withinFrame) {
      // Element is navigatable by default, unless `data-turbo="false"`.
      if (container) {
        return container.getAttribute("data-turbo") != "false"
      } else {
        return true
      }
    } else {
      // Element isn't navigatable by default, unless `data-turbo="true"`.
      if (container) {
        return container.getAttribute("data-turbo") == "true"
      } else {
        return false
      }
    }
  }

  // Private

  getActionForLink(link) {
    return getVisitAction(link) || "advance"
  }

  get snapshot() {
    return this.view.snapshot
  }
}

// Older versions of the Turbo Native adapters referenced the
// `Location#absoluteURL` property in their implementations of
// the `Adapter#visitProposedToLocation()` and `#visitStarted()`
// methods. The Location class has since been removed in favor
// of the DOM URL API, and accordingly all Adapter methods now
// receive URL objects.
//
// We alias #absoluteURL to #toString() here to avoid crashing
// older adapters which do not expect URL objects. We should
// consider removing this support at some point in the future.

function extendURLWithDeprecatedProperties(url) {
  Object.defineProperties(url, deprecatedLocationPropertyDescriptors);
}

const deprecatedLocationPropertyDescriptors = {
  absoluteURL: {
    get() {
      return this.toString()
    }
  }
};

const session = new Session(recentRequests);
const { cache, navigator: navigator$1 } = session;

/**
 * Starts the main session.
 * This initialises any necessary observers such as those to monitor
 * link interactions.
 */
function start() {
  session.start();
}

/**
 * Registers an adapter for the main session.
 *
 * @param adapter Adapter to register
 */
function registerAdapter(adapter) {
  session.registerAdapter(adapter);
}

/**
 * Performs an application visit to the given location.
 *
 * @param location Location to visit (a URL or path)
 * @param options Options to apply
 * @param options.action Type of history navigation to apply ("restore",
 * "replace" or "advance")
 * @param options.historyChanged Specifies whether the browser history has
 * already been changed for this visit or not
 * @param options.referrer Specifies the referrer of this visit such that
 * navigations to the same page will not result in a new history entry.
 * @param options.snapshotHTML Cached snapshot to render
 * @param options.response Response of the specified location
 */
function visit(location, options) {
  session.visit(location, options);
}

/**
 * Connects a stream source to the main session.
 *
 * @param source Stream source to connect
 */
function connectStreamSource(source) {
  session.connectStreamSource(source);
}

/**
 * Disconnects a stream source from the main session.
 *
 * @param source Stream source to disconnect
 */
function disconnectStreamSource(source) {
  session.disconnectStreamSource(source);
}

/**
 * Renders a stream message to the main session by appending it to the
 * current document.
 *
 * @param message Message to render
 */
function renderStreamMessage(message) {
  session.renderStreamMessage(message);
}

/**
 * Removes all entries from the Turbo Drive page cache.
 * Call this when state has changed on the server that may affect cached pages.
 *
 * @deprecated since version 7.2.0 in favor of `Turbo.cache.clear()`
 */
function clearCache() {
  console.warn(
    "Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  session.clearCache();
}

/**
 * Sets the delay after which the progress bar will appear during navigation.
 *
 * The progress bar appears after 500ms by default.
 *
 * Note that this method has no effect when used with the iOS or Android
 * adapters.
 *
 * @param delay Time to delay in milliseconds
 */
function setProgressBarDelay(delay) {
  console.warn(
    "Please replace `Turbo.setProgressBarDelay(delay)` with `Turbo.config.drive.progressBarDelay = delay`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  config.drive.progressBarDelay = delay;
}

function setConfirmMethod(confirmMethod) {
  console.warn(
    "Please replace `Turbo.setConfirmMethod(confirmMethod)` with `Turbo.config.forms.confirm = confirmMethod`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  config.forms.confirm = confirmMethod;
}

function setFormMode(mode) {
  console.warn(
    "Please replace `Turbo.setFormMode(mode)` with `Turbo.config.forms.mode = mode`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  config.forms.mode = mode;
}

var Turbo = /*#__PURE__*/Object.freeze({
  __proto__: null,
  navigator: navigator$1,
  session: session,
  cache: cache,
  PageRenderer: PageRenderer,
  PageSnapshot: PageSnapshot,
  FrameRenderer: FrameRenderer,
  fetch: fetchWithTurboHeaders,
  config: config,
  start: start,
  registerAdapter: registerAdapter,
  visit: visit,
  connectStreamSource: connectStreamSource,
  disconnectStreamSource: disconnectStreamSource,
  renderStreamMessage: renderStreamMessage,
  clearCache: clearCache,
  setProgressBarDelay: setProgressBarDelay,
  setConfirmMethod: setConfirmMethod,
  setFormMode: setFormMode
});

class TurboFrameMissingError extends Error {}

class FrameController {
  fetchResponseLoaded = (_fetchResponse) => Promise.resolve()
  #currentFetchRequest = null
  #resolveVisitPromise = () => {}
  #connected = false
  #hasBeenLoaded = false
  #ignoredAttributes = new Set()
  #shouldMorphFrame = false
  action = null

  constructor(element) {
    this.element = element;
    this.view = new FrameView(this, this.element);
    this.appearanceObserver = new AppearanceObserver(this, this.element);
    this.formLinkClickObserver = new FormLinkClickObserver(this, this.element);
    this.linkInterceptor = new LinkInterceptor(this, this.element);
    this.restorationIdentifier = uuid();
    this.formSubmitObserver = new FormSubmitObserver(this, this.element);
  }

  // Frame delegate

  connect() {
    if (!this.#connected) {
      this.#connected = true;
      if (this.loadingStyle == FrameLoadingStyle.lazy) {
        this.appearanceObserver.start();
      } else {
        this.#loadSourceURL();
      }
      this.formLinkClickObserver.start();
      this.linkInterceptor.start();
      this.formSubmitObserver.start();
    }
  }

  disconnect() {
    if (this.#connected) {
      this.#connected = false;
      this.appearanceObserver.stop();
      this.formLinkClickObserver.stop();
      this.linkInterceptor.stop();
      this.formSubmitObserver.stop();
    }
  }

  disabledChanged() {
    if (this.loadingStyle == FrameLoadingStyle.eager) {
      this.#loadSourceURL();
    }
  }

  sourceURLChanged() {
    if (this.#isIgnoringChangesTo("src")) return

    if (this.element.isConnected) {
      this.complete = false;
    }

    if (this.loadingStyle == FrameLoadingStyle.eager || this.#hasBeenLoaded) {
      this.#loadSourceURL();
    }
  }

  sourceURLReloaded() {
    const { refresh, src } = this.element;

    this.#shouldMorphFrame = src && refresh === "morph";

    this.element.removeAttribute("complete");
    this.element.src = null;
    this.element.src = src;
    return this.element.loaded
  }

  loadingStyleChanged() {
    if (this.loadingStyle == FrameLoadingStyle.lazy) {
      this.appearanceObserver.start();
    } else {
      this.appearanceObserver.stop();
      this.#loadSourceURL();
    }
  }

  async #loadSourceURL() {
    if (this.enabled && this.isActive && !this.complete && this.sourceURL) {
      this.element.loaded = this.#visit(expandURL(this.sourceURL));
      this.appearanceObserver.stop();
      await this.element.loaded;
      this.#hasBeenLoaded = true;
    }
  }

  async loadResponse(fetchResponse) {
    if (fetchResponse.redirected || (fetchResponse.succeeded && fetchResponse.isHTML)) {
      this.sourceURL = fetchResponse.response.url;
    }

    try {
      const html = await fetchResponse.responseHTML;
      if (html) {
        const document = parseHTMLDocument(html);
        const pageSnapshot = PageSnapshot.fromDocument(document);

        if (pageSnapshot.isVisitable) {
          await this.#loadFrameResponse(fetchResponse, document);
        } else {
          await this.#handleUnvisitableFrameResponse(fetchResponse);
        }
      }
    } finally {
      this.#shouldMorphFrame = false;
      this.fetchResponseLoaded = () => Promise.resolve();
    }
  }

  // Appearance observer delegate

  elementAppearedInViewport(element) {
    this.proposeVisitIfNavigatedWithAction(element, getVisitAction(element));
    this.#loadSourceURL();
  }

  // Form link click observer delegate

  willSubmitFormLinkToLocation(link) {
    return this.#shouldInterceptNavigation(link)
  }

  submittedFormLinkToLocation(link, _location, form) {
    const frame = this.#findFrameElement(link);
    if (frame) form.setAttribute("data-turbo-frame", frame.id);
  }

  // Link interceptor delegate

  shouldInterceptLinkClick(element, _location, _event) {
    return this.#shouldInterceptNavigation(element)
  }

  linkClickIntercepted(element, location) {
    this.#navigateFrame(element, location);
  }

  // Form submit observer delegate

  willSubmitForm(element, submitter) {
    return element.closest("turbo-frame") == this.element && this.#shouldInterceptNavigation(element, submitter)
  }

  formSubmitted(element, submitter) {
    if (this.formSubmission) {
      this.formSubmission.stop();
    }

    this.formSubmission = new FormSubmission(this, element, submitter);
    const { fetchRequest } = this.formSubmission;
    this.prepareRequest(fetchRequest);
    this.formSubmission.start();
  }

  // Fetch request delegate

  prepareRequest(request) {
    request.headers["Turbo-Frame"] = this.id;

    if (this.currentNavigationElement?.hasAttribute("data-turbo-stream")) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted(_request) {
    markAsBusy(this.element);
  }

  requestPreventedHandlingResponse(_request, _response) {
    this.#resolveVisitPromise();
  }

  async requestSucceededWithResponse(request, response) {
    await this.loadResponse(response);
    this.#resolveVisitPromise();
  }

  async requestFailedWithResponse(request, response) {
    await this.loadResponse(response);
    this.#resolveVisitPromise();
  }

  requestErrored(request, error) {
    console.error(error);
    this.#resolveVisitPromise();
  }

  requestFinished(_request) {
    clearBusyState(this.element);
  }

  // Form submission delegate

  formSubmissionStarted({ formElement }) {
    markAsBusy(formElement, this.#findFrameElement(formElement));
  }

  formSubmissionSucceededWithResponse(formSubmission, response) {
    const frame = this.#findFrameElement(formSubmission.formElement, formSubmission.submitter);

    frame.delegate.proposeVisitIfNavigatedWithAction(frame, getVisitAction(formSubmission.submitter, formSubmission.formElement, frame));
    frame.delegate.loadResponse(response);

    if (!formSubmission.isSafe) {
      session.clearCache();
    }
  }

  formSubmissionFailedWithResponse(formSubmission, fetchResponse) {
    this.element.delegate.loadResponse(fetchResponse);
    session.clearCache();
  }

  formSubmissionErrored(formSubmission, error) {
    console.error(error);
  }

  formSubmissionFinished({ formElement }) {
    clearBusyState(formElement, this.#findFrameElement(formElement));
  }

  // View delegate

  allowsImmediateRender({ element: newFrame }, options) {
    const event = dispatch("turbo:before-frame-render", {
      target: this.element,
      detail: { newFrame, ...options },
      cancelable: true
    });

    const {
      defaultPrevented,
      detail: { render }
    } = event;

    if (this.view.renderer && render) {
      this.view.renderer.renderElement = render;
    }

    return !defaultPrevented
  }

  viewRenderedSnapshot(_snapshot, _isPreview, _renderMethod) {}

  preloadOnLoadLinksForView(element) {
    session.preloadOnLoadLinksForView(element);
  }

  viewInvalidated() {}

  // Frame renderer delegate

  willRenderFrame(currentElement, _newElement) {
    this.previousFrameElement = currentElement.cloneNode(true);
  }

  visitCachedSnapshot = ({ element }) => {
    const frame = element.querySelector("#" + this.element.id);

    if (frame && this.previousFrameElement) {
      frame.replaceChildren(...this.previousFrameElement.children);
    }

    delete this.previousFrameElement;
  }

  // Private

  async #loadFrameResponse(fetchResponse, document) {
    const newFrameElement = await this.extractForeignFrameElement(document.body);
    const rendererClass = this.#shouldMorphFrame ? MorphingFrameRenderer : FrameRenderer;

    if (newFrameElement) {
      const snapshot = new Snapshot(newFrameElement);
      const renderer = new rendererClass(this, this.view.snapshot, snapshot, false, false);
      if (this.view.renderPromise) await this.view.renderPromise;
      this.changeHistory();

      await this.view.render(renderer);
      this.complete = true;
      session.frameRendered(fetchResponse, this.element);
      session.frameLoaded(this.element);
      await this.fetchResponseLoaded(fetchResponse);
    } else if (this.#willHandleFrameMissingFromResponse(fetchResponse)) {
      this.#handleFrameMissingFromResponse(fetchResponse);
    }
  }

  async #visit(url) {
    const request = new FetchRequest(this, FetchMethod.get, url, new URLSearchParams(), this.element);

    this.#currentFetchRequest?.cancel();
    this.#currentFetchRequest = request;

    return new Promise((resolve) => {
      this.#resolveVisitPromise = () => {
        this.#resolveVisitPromise = () => {};
        this.#currentFetchRequest = null;
        resolve();
      };
      request.perform();
    })
  }

  #navigateFrame(element, url, submitter) {
    const frame = this.#findFrameElement(element, submitter);

    frame.delegate.proposeVisitIfNavigatedWithAction(frame, getVisitAction(submitter, element, frame));

    this.#withCurrentNavigationElement(element, () => {
      frame.src = url;
    });
  }

  proposeVisitIfNavigatedWithAction(frame, action = null) {
    this.action = action;

    if (this.action) {
      const pageSnapshot = PageSnapshot.fromElement(frame).clone();
      const { visitCachedSnapshot } = frame.delegate;

      frame.delegate.fetchResponseLoaded = async (fetchResponse) => {
        if (frame.src) {
          const { statusCode, redirected } = fetchResponse;
          const responseHTML = await fetchResponse.responseHTML;
          const response = { statusCode, redirected, responseHTML };
          const options = {
            response,
            visitCachedSnapshot,
            willRender: false,
            updateHistory: false,
            restorationIdentifier: this.restorationIdentifier,
            snapshot: pageSnapshot
          };

          if (this.action) options.action = this.action;

          session.visit(frame.src, options);
        }
      };
    }
  }

  changeHistory() {
    if (this.action) {
      const method = getHistoryMethodForAction(this.action);
      session.history.update(method, expandURL(this.element.src || ""), this.restorationIdentifier);
    }
  }

  async #handleUnvisitableFrameResponse(fetchResponse) {
    console.warn(
      `The response (${fetchResponse.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`
    );

    await this.#visitResponse(fetchResponse.response);
  }

  #willHandleFrameMissingFromResponse(fetchResponse) {
    this.element.setAttribute("complete", "");

    const response = fetchResponse.response;
    const visit = async (url, options) => {
      if (url instanceof Response) {
        this.#visitResponse(url);
      } else {
        session.visit(url, options);
      }
    };

    const event = dispatch("turbo:frame-missing", {
      target: this.element,
      detail: { response, visit },
      cancelable: true
    });

    return !event.defaultPrevented
  }

  #handleFrameMissingFromResponse(fetchResponse) {
    this.view.missing();
    this.#throwFrameMissingError(fetchResponse);
  }

  #throwFrameMissingError(fetchResponse) {
    const message = `The response (${fetchResponse.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;
    throw new TurboFrameMissingError(message)
  }

  async #visitResponse(response) {
    const wrapped = new FetchResponse(response);
    const responseHTML = await wrapped.responseHTML;
    const { location, redirected, statusCode } = wrapped;

    return session.visit(location, { response: { redirected, statusCode, responseHTML } })
  }

  #findFrameElement(element, submitter) {
    const id = getAttribute("data-turbo-frame", submitter, element) || this.element.getAttribute("target");
    return getFrameElementById(id) ?? this.element
  }

  async extractForeignFrameElement(container) {
    let element;
    const id = CSS.escape(this.id);

    try {
      element = activateElement(container.querySelector(`turbo-frame#${id}`), this.sourceURL);
      if (element) {
        return element
      }

      element = activateElement(container.querySelector(`turbo-frame[src][recurse~=${id}]`), this.sourceURL);
      if (element) {
        await element.loaded;
        return await this.extractForeignFrameElement(element)
      }
    } catch (error) {
      console.error(error);
      return new FrameElement()
    }

    return null
  }

  #formActionIsVisitable(form, submitter) {
    const action = getAction$1(form, submitter);

    return locationIsVisitable(expandURL(action), this.rootLocation)
  }

  #shouldInterceptNavigation(element, submitter) {
    const id = getAttribute("data-turbo-frame", submitter, element) || this.element.getAttribute("target");

    if (element instanceof HTMLFormElement && !this.#formActionIsVisitable(element, submitter)) {
      return false
    }

    if (!this.enabled || id == "_top") {
      return false
    }

    if (id) {
      const frameElement = getFrameElementById(id);
      if (frameElement) {
        return !frameElement.disabled
      }
    }

    if (!session.elementIsNavigatable(element)) {
      return false
    }

    if (submitter && !session.elementIsNavigatable(submitter)) {
      return false
    }

    return true
  }

  // Computed properties

  get id() {
    return this.element.id
  }

  get enabled() {
    return !this.element.disabled
  }

  get sourceURL() {
    if (this.element.src) {
      return this.element.src
    }
  }

  set sourceURL(sourceURL) {
    this.#ignoringChangesToAttribute("src", () => {
      this.element.src = sourceURL ?? null;
    });
  }

  get loadingStyle() {
    return this.element.loading
  }

  get isLoading() {
    return this.formSubmission !== undefined || this.#resolveVisitPromise() !== undefined
  }

  get complete() {
    return this.element.hasAttribute("complete")
  }

  set complete(value) {
    if (value) {
      this.element.setAttribute("complete", "");
    } else {
      this.element.removeAttribute("complete");
    }
  }

  get isActive() {
    return this.element.isActive && this.#connected
  }

  get rootLocation() {
    const meta = this.element.ownerDocument.querySelector(`meta[name="turbo-root"]`);
    const root = meta?.content ?? "/";
    return expandURL(root)
  }

  #isIgnoringChangesTo(attributeName) {
    return this.#ignoredAttributes.has(attributeName)
  }

  #ignoringChangesToAttribute(attributeName, callback) {
    this.#ignoredAttributes.add(attributeName);
    callback();
    this.#ignoredAttributes.delete(attributeName);
  }

  #withCurrentNavigationElement(element, callback) {
    this.currentNavigationElement = element;
    callback();
    delete this.currentNavigationElement;
  }
}

function getFrameElementById(id) {
  if (id != null) {
    const element = document.getElementById(id);
    if (element instanceof FrameElement) {
      return element
    }
  }
}

function activateElement(element, currentURL) {
  if (element) {
    const src = element.getAttribute("src");
    if (src != null && currentURL != null && urlsAreEqual(src, currentURL)) {
      throw new Error(`Matching <turbo-frame id="${element.id}"> element has a source URL which references itself`)
    }
    if (element.ownerDocument !== document) {
      element = document.importNode(element, true);
    }

    if (element instanceof FrameElement) {
      element.connectedCallback();
      element.disconnectedCallback();
      return element
    }
  }
}

const StreamActions = {
  after() {
    this.targetElements.forEach((e) => e.parentElement?.insertBefore(this.templateContent, e.nextSibling));
  },

  append() {
    this.removeDuplicateTargetChildren();
    this.targetElements.forEach((e) => e.append(this.templateContent));
  },

  before() {
    this.targetElements.forEach((e) => e.parentElement?.insertBefore(this.templateContent, e));
  },

  prepend() {
    this.removeDuplicateTargetChildren();
    this.targetElements.forEach((e) => e.prepend(this.templateContent));
  },

  remove() {
    this.targetElements.forEach((e) => e.remove());
  },

  replace() {
    const method = this.getAttribute("method");

    this.targetElements.forEach((targetElement) => {
      if (method === "morph") {
        morphElements(targetElement, this.templateContent);
      } else {
        targetElement.replaceWith(this.templateContent);
      }
    });
  },

  update() {
    const method = this.getAttribute("method");

    this.targetElements.forEach((targetElement) => {
      if (method === "morph") {
        morphChildren(targetElement, this.templateContent);
      } else {
        targetElement.innerHTML = "";
        targetElement.append(this.templateContent);
      }
    });
  },

  refresh() {
    session.refresh(this.baseURI, this.requestId);
  }
};

// <turbo-stream action=replace target=id><template>...

/**
 * Renders updates to the page from a stream of messages.
 *
 * Using the `action` attribute, this can be configured one of eight ways:
 *
 * - `after` - inserts the result after the target
 * - `append` - appends the result to the target
 * - `before` - inserts the result before the target
 * - `prepend` - prepends the result to the target
 * - `refresh` - initiates a page refresh
 * - `remove` - removes the target
 * - `replace` - replaces the outer HTML of the target
 * - `update` - replaces the inner HTML of the target
 *
 * @customElement turbo-stream
 * @example
 *   <turbo-stream action="append" target="dom_id">
 *     <template>
 *       Content to append to target designated with the dom_id.
 *     </template>
 *   </turbo-stream>
 */
class StreamElement extends HTMLElement {
  static async renderElement(newElement) {
    await newElement.performAction();
  }

  async connectedCallback() {
    try {
      await this.render();
    } catch (error) {
      console.error(error);
    } finally {
      this.disconnect();
    }
  }

  async render() {
    return (this.renderPromise ??= (async () => {
      const event = this.beforeRenderEvent;

      if (this.dispatchEvent(event)) {
        await nextRepaint();
        await event.detail.render(this);
      }
    })())
  }

  disconnect() {
    try {
      this.remove();
      // eslint-disable-next-line no-empty
    } catch {}
  }

  /**
   * Removes duplicate children (by ID)
   */
  removeDuplicateTargetChildren() {
    this.duplicateChildren.forEach((c) => c.remove());
  }

  /**
   * Gets the list of duplicate children (i.e. those with the same ID)
   */
  get duplicateChildren() {
    const existingChildren = this.targetElements.flatMap((e) => [...e.children]).filter((c) => !!c.id);
    const newChildrenIds = [...(this.templateContent?.children || [])].filter((c) => !!c.id).map((c) => c.id);

    return existingChildren.filter((c) => newChildrenIds.includes(c.id))
  }

  /**
   * Gets the action function to be performed.
   */
  get performAction() {
    if (this.action) {
      const actionFunction = StreamActions[this.action];
      if (actionFunction) {
        return actionFunction
      }
      this.#raise("unknown action");
    }
    this.#raise("action attribute is missing");
  }

  /**
   * Gets the target elements which the template will be rendered to.
   */
  get targetElements() {
    if (this.target) {
      return this.targetElementsById
    } else if (this.targets) {
      return this.targetElementsByQuery
    } else {
      this.#raise("target or targets attribute is missing");
    }
  }

  /**
   * Gets the contents of the main `<template>`.
   */
  get templateContent() {
    return this.templateElement.content.cloneNode(true)
  }

  /**
   * Gets the main `<template>` used for rendering
   */
  get templateElement() {
    if (this.firstElementChild === null) {
      const template = this.ownerDocument.createElement("template");
      this.appendChild(template);
      return template
    } else if (this.firstElementChild instanceof HTMLTemplateElement) {
      return this.firstElementChild
    }
    this.#raise("first child element must be a <template> element");
  }

  /**
   * Gets the current action.
   */
  get action() {
    return this.getAttribute("action")
  }

  /**
   * Gets the current target (an element ID) to which the result will
   * be rendered.
   */
  get target() {
    return this.getAttribute("target")
  }

  /**
   * Gets the current "targets" selector (a CSS selector)
   */
  get targets() {
    return this.getAttribute("targets")
  }

  /**
   * Reads the request-id attribute
   */
  get requestId() {
    return this.getAttribute("request-id")
  }

  #raise(message) {
    throw new Error(`${this.description}: ${message}`)
  }

  get description() {
    return (this.outerHTML.match(/<[^>]+>/) ?? [])[0] ?? "<turbo-stream>"
  }

  get beforeRenderEvent() {
    return new CustomEvent("turbo:before-stream-render", {
      bubbles: true,
      cancelable: true,
      detail: { newStream: this, render: StreamElement.renderElement }
    })
  }

  get targetElementsById() {
    const element = this.ownerDocument?.getElementById(this.target);

    if (element !== null) {
      return [element]
    } else {
      return []
    }
  }

  get targetElementsByQuery() {
    const elements = this.ownerDocument?.querySelectorAll(this.targets);

    if (elements.length !== 0) {
      return Array.prototype.slice.call(elements)
    } else {
      return []
    }
  }
}

class StreamSourceElement extends HTMLElement {
  streamSource = null

  connectedCallback() {
    this.streamSource = this.src.match(/^ws{1,2}:/) ? new WebSocket(this.src) : new EventSource(this.src);

    connectStreamSource(this.streamSource);
  }

  disconnectedCallback() {
    if (this.streamSource) {
      this.streamSource.close();

      disconnectStreamSource(this.streamSource);
    }
  }

  get src() {
    return this.getAttribute("src") || ""
  }
}

FrameElement.delegateConstructor = FrameController;

if (customElements.get("turbo-frame") === undefined) {
  customElements.define("turbo-frame", FrameElement);
}

if (customElements.get("turbo-stream") === undefined) {
  customElements.define("turbo-stream", StreamElement);
}

if (customElements.get("turbo-stream-source") === undefined) {
  customElements.define("turbo-stream-source", StreamSourceElement);
}

(() => {
  let element = document.currentScript;
  if (!element) return
  if (element.hasAttribute("data-turbo-suppress-warning")) return

  element = element.parentElement;
  while (element) {
    if (element == document.body) {
      return console.warn(
        unindent`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,
        element.outerHTML
      )
    }

    element = element.parentElement;
  }
})();

window.Turbo = { ...Turbo, StreamActions };
start();




/***/ }),

/***/ "./node_modules/@simonwep/pickr/dist/pickr.min.js":
/*!********************************************************!*\
  !*** ./node_modules/@simonwep/pickr/dist/pickr.min.js ***!
  \********************************************************/
/***/ (function(module) {

/*! Pickr 1.9.0 MIT | https://github.com/Simonwep/pickr */
!function(t,e){ true?module.exports=e():0}(self,(()=>(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.d(e,{default:()=>E});var o={};function n(t,e,o,n,i={}){e instanceof HTMLCollection||e instanceof NodeList?e=Array.from(e):Array.isArray(e)||(e=[e]),Array.isArray(o)||(o=[o]);for(const s of e)for(const e of o)s[t](e,n,{capture:!1,...i});return Array.prototype.slice.call(arguments,1)}t.r(o),t.d(o,{adjustableInputNumbers:()=>p,createElementFromString:()=>r,createFromTemplate:()=>a,eventPath:()=>l,off:()=>s,on:()=>i,resolveElement:()=>c});const i=n.bind(null,"addEventListener"),s=n.bind(null,"removeEventListener");function r(t){const e=document.createElement("div");return e.innerHTML=t.trim(),e.firstElementChild}function a(t){const e=(t,e)=>{const o=t.getAttribute(e);return t.removeAttribute(e),o},o=(t,n={})=>{const i=e(t,":obj"),s=e(t,":ref"),r=i?n[i]={}:n;s&&(n[s]=t);for(const n of Array.from(t.children)){const t=e(n,":arr"),i=o(n,t?{}:r);t&&(r[t]||(r[t]=[])).push(Object.keys(i).length?i:n)}return n};return o(r(t))}function l(t){let e=t.path||t.composedPath&&t.composedPath();if(e)return e;let o=t.target.parentElement;for(e=[t.target,o];o=o.parentElement;)e.push(o);return e.push(document,window),e}function c(t){return t instanceof Element?t:"string"==typeof t?t.split(/>>/g).reduce(((t,e,o,n)=>(t=t.querySelector(e),o<n.length-1?t.shadowRoot:t)),document):null}function p(t,e=(t=>t)){function o(o){const n=[.001,.01,.1][Number(o.shiftKey||2*o.ctrlKey)]*(o.deltaY<0?1:-1);let i=0,s=t.selectionStart;t.value=t.value.replace(/[\d.]+/g,((t,o)=>o<=s&&o+t.length>=s?(s=o,e(Number(t),n,i)):(i++,t))),t.focus(),t.setSelectionRange(s,s),o.preventDefault(),t.dispatchEvent(new Event("input"))}i(t,"focus",(()=>i(window,"wheel",o,{passive:!1}))),i(t,"blur",(()=>s(window,"wheel",o)))}const{min:u,max:h,floor:d,round:m}=Math;function f(t,e,o){e/=100,o/=100;const n=d(t=t/360*6),i=t-n,s=o*(1-e),r=o*(1-i*e),a=o*(1-(1-i)*e),l=n%6;return[255*[o,r,s,s,a,o][l],255*[a,o,o,r,s,s][l],255*[s,s,a,o,o,r][l]]}function v(t,e,o){const n=(2-(e/=100))*(o/=100)/2;return 0!==n&&(e=1===n?0:n<.5?e*o/(2*n):e*o/(2-2*n)),[t,100*e,100*n]}function b(t,e,o){const n=u(t/=255,e/=255,o/=255),i=h(t,e,o),s=i-n;let r,a;if(0===s)r=a=0;else{a=s/i;const n=((i-t)/6+s/2)/s,l=((i-e)/6+s/2)/s,c=((i-o)/6+s/2)/s;t===i?r=c-l:e===i?r=1/3+n-c:o===i&&(r=2/3+l-n),r<0?r+=1:r>1&&(r-=1)}return[360*r,100*a,100*i]}function y(t,e,o,n){e/=100,o/=100;return[...b(255*(1-u(1,(t/=100)*(1-(n/=100))+n)),255*(1-u(1,e*(1-n)+n)),255*(1-u(1,o*(1-n)+n)))]}function g(t,e,o){e/=100;const n=2*(e*=(o/=100)<.5?o:1-o)/(o+e)*100,i=100*(o+e);return[t,isNaN(n)?0:n,i]}function _(t){return b(...t.match(/.{2}/g).map((t=>parseInt(t,16))))}function w(t){t=t.match(/^[a-zA-Z]+$/)?function(t){if("black"===t.toLowerCase())return"#000";const e=document.createElement("canvas").getContext("2d");return e.fillStyle=t,"#000"===e.fillStyle?null:e.fillStyle}(t):t;const e={cmyk:/^cmyk\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)/i,rgba:/^rgba?\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D*?(([\d.]+)(%?)|$)/i,hsla:/^hsla?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hsva:/^hsva?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},o=t=>t.map((t=>/^(|\d+)\.\d+|\d+$/.test(t)?Number(t):void 0));let n;t:for(const i in e)if(n=e[i].exec(t))switch(i){case"cmyk":{const[,t,e,s,r]=o(n);if(t>100||e>100||s>100||r>100)break t;return{values:y(t,e,s,r),type:i}}case"rgba":{let[,t,,e,,s,,,r]=o(n);if(t="%"===n[2]?t/100*255:t,e="%"===n[4]?e/100*255:e,s="%"===n[6]?s/100*255:s,r="%"===n[9]?r/100:r,t>255||e>255||s>255||r<0||r>1)break t;return{values:[...b(t,e,s),r],a:r,type:i}}case"hexa":{let[,t]=n;4!==t.length&&3!==t.length||(t=t.split("").map((t=>t+t)).join(""));const e=t.substring(0,6);let o=t.substring(6);return o=o?parseInt(o,16)/255:void 0,{values:[..._(e),o],a:o,type:i}}case"hsla":{let[,t,e,s,,r]=o(n);if(r="%"===n[6]?r/100:r,t>360||e>100||s>100||r<0||r>1)break t;return{values:[...g(t,e,s),r],a:r,type:i}}case"hsva":{let[,t,e,s,,r]=o(n);if(r="%"===n[6]?r/100:r,t>360||e>100||s>100||r<0||r>1)break t;return{values:[t,e,s,r],a:r,type:i}}}return{values:null,type:null}}function A(t=0,e=0,o=0,n=1){const i=(t,e)=>(o=-1)=>e(~o?t.map((t=>Number(t.toFixed(o)))):t),s={h:t,s:e,v:o,a:n,toHSVA(){const t=[s.h,s.s,s.v,s.a];return t.toString=i(t,(t=>`hsva(${t[0]}, ${t[1]}%, ${t[2]}%, ${s.a})`)),t},toHSLA(){const t=[...v(s.h,s.s,s.v),s.a];return t.toString=i(t,(t=>`hsla(${t[0]}, ${t[1]}%, ${t[2]}%, ${s.a})`)),t},toRGBA(){const t=[...f(s.h,s.s,s.v),s.a];return t.toString=i(t,(t=>`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${s.a})`)),t},toCMYK(){const t=function(t,e,o){const n=f(t,e,o),i=n[0]/255,s=n[1]/255,r=n[2]/255,a=u(1-i,1-s,1-r);return[100*(1===a?0:(1-i-a)/(1-a)),100*(1===a?0:(1-s-a)/(1-a)),100*(1===a?0:(1-r-a)/(1-a)),100*a]}(s.h,s.s,s.v);return t.toString=i(t,(t=>`cmyk(${t[0]}%, ${t[1]}%, ${t[2]}%, ${t[3]}%)`)),t},toHEXA(){const t=function(t,e,o){return f(t,e,o).map((t=>m(t).toString(16).padStart(2,"0")))}(s.h,s.s,s.v),e=s.a>=1?"":Number((255*s.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return e&&t.push(e),t.toString=()=>`#${t.join("").toUpperCase()}`,t},clone:()=>A(s.h,s.s,s.v,s.a)};return s}const $=t=>Math.max(Math.min(t,1),0);function C(t){const e={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},t),_keyboard(t){const{options:o}=e,{type:n,key:i}=t;if(document.activeElement===o.wrapper){const{lock:o}=e.options,s="ArrowUp"===i,r="ArrowRight"===i,a="ArrowDown"===i,l="ArrowLeft"===i;if("keydown"===n&&(s||r||a||l)){let n=0,i=0;"v"===o?n=s||r?1:-1:"h"===o?n=s||r?-1:1:(i=s?-1:a?1:0,n=l?-1:r?1:0),e.update($(e.cache.x+.01*n),$(e.cache.y+.01*i)),t.preventDefault()}else i.startsWith("Arrow")&&(e.options.onstop(),t.preventDefault())}},_tapstart(t){i(document,["mouseup","touchend","touchcancel"],e._tapstop),i(document,["mousemove","touchmove"],e._tapmove),t.cancelable&&t.preventDefault(),e._tapmove(t)},_tapmove(t){const{options:o,cache:n}=e,{lock:i,element:s,wrapper:r}=o,a=r.getBoundingClientRect();let l=0,c=0;if(t){const e=t&&t.touches&&t.touches[0];l=t?(e||t).clientX:0,c=t?(e||t).clientY:0,l<a.left?l=a.left:l>a.left+a.width&&(l=a.left+a.width),c<a.top?c=a.top:c>a.top+a.height&&(c=a.top+a.height),l-=a.left,c-=a.top}else n&&(l=n.x*a.width,c=n.y*a.height);"h"!==i&&(s.style.left=`calc(${l/a.width*100}% - ${s.offsetWidth/2}px)`),"v"!==i&&(s.style.top=`calc(${c/a.height*100}% - ${s.offsetHeight/2}px)`),e.cache={x:l/a.width,y:c/a.height};const p=$(l/a.width),u=$(c/a.height);switch(i){case"v":return o.onchange(p);case"h":return o.onchange(u);default:return o.onchange(p,u)}},_tapstop(){e.options.onstop(),s(document,["mouseup","touchend","touchcancel"],e._tapstop),s(document,["mousemove","touchmove"],e._tapmove)},trigger(){e._tapmove()},update(t=0,o=0){const{left:n,top:i,width:s,height:r}=e.options.wrapper.getBoundingClientRect();"h"===e.options.lock&&(o=t),e._tapmove({clientX:n+s*t,clientY:i+r*o})},destroy(){const{options:t,_tapstart:o,_keyboard:n}=e;s(document,["keydown","keyup"],n),s([t.wrapper,t.element],"mousedown",o),s([t.wrapper,t.element],"touchstart",o,{passive:!1})}},{options:o,_tapstart:n,_keyboard:r}=e;return i([o.wrapper,o.element],"mousedown",n),i([o.wrapper,o.element],"touchstart",n,{passive:!1}),i(document,["keydown","keyup"],r),e}function k(t={}){t=Object.assign({onchange:()=>0,className:"",elements:[]},t);const e=i(t.elements,"click",(e=>{t.elements.forEach((o=>o.classList[e.target===o?"add":"remove"](t.className))),t.onchange(e),e.stopPropagation()}));return{destroy:()=>s(...e)}}const S={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},O=(t,e,o)=>{const n="object"!=typeof t||t instanceof HTMLElement?{reference:t,popper:e,...o}:t;return{update(t=n){const{reference:e,popper:o}=Object.assign(n,t);if(!o||!e)throw new Error("Popper- or reference-element missing.");return((t,e,o)=>{const{container:n,arrow:i,margin:s,padding:r,position:a,variantFlipOrder:l,positionFlipOrder:c}={container:document.documentElement.getBoundingClientRect(),...S,...o},{left:p,top:u}=e.style;e.style.left="0",e.style.top="0";const h=t.getBoundingClientRect(),d=e.getBoundingClientRect(),m={t:h.top-d.height-s,b:h.bottom+s,r:h.right+s,l:h.left-d.width-s},f={vs:h.left,vm:h.left+h.width/2-d.width/2,ve:h.left+h.width-d.width,hs:h.top,hm:h.bottom-h.height/2-d.height/2,he:h.bottom-d.height},[v,b="middle"]=a.split("-"),y=c[v],g=l[b],{top:_,left:w,bottom:A,right:$}=n;for(const t of y){const o="t"===t||"b"===t;let n=m[t];const[s,a]=o?["top","left"]:["left","top"],[l,c]=o?[d.height,d.width]:[d.width,d.height],[p,u]=o?[A,$]:[$,A],[v,b]=o?[_,w]:[w,_];if(!(n<v||n+l+r>p))for(const p of g){let m=f[(o?"v":"h")+p];if(!(m<b||m+c+r>u)){if(m-=d[a],n-=d[s],e.style[a]=`${m}px`,e.style[s]=`${n}px`,i){const t=o?h.width/2:h.height/2,e=2*t<c?h[a]+t:m+c/2;n<h[s]&&(n+=l),i.style[a]=`${e}px`,i.style[s]=`${n}px`}return t+p}}}return e.style.left=p,e.style.top=u,null})(e,o,n)}}};class E{static utils=o;static version="1.9.0";static I18N_DEFAULTS={"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"};static DEFAULT_OPTIONS={appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"};_initializingActive=!0;_recalc=!0;_nanopop=null;_root=null;_color=A();_lastColor=A();_swatchColors=[];_setupAnimationFrame=null;_eventListener={init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]};constructor(t){this.options=t=Object.assign({...E.DEFAULT_OPTIONS},t);const{swatches:e,components:o,theme:n,sliders:i,lockOpacity:s,padding:r}=t;["nano","monolith"].includes(n)&&!i&&(t.sliders="h"),o.interaction||(o.interaction={});const{preview:a,opacity:l,hue:c,palette:p}=o;o.opacity=!s&&l,o.palette=p||a||l||c,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),e&&e.length&&e.forEach((t=>this.addSwatch(t)));const{button:u,app:h}=this._root;this._nanopop=O(u,h,{margin:r}),u.setAttribute("role","button"),u.setAttribute("aria-label",this._t("btn:toggle"));const d=this;this._setupAnimationFrame=requestAnimationFrame((function e(){if(!h.offsetWidth)return requestAnimationFrame(e);d.setColor(t.default),d._rePositioningPicker(),t.defaultRepresentation&&(d._representation=t.defaultRepresentation,d.setColorRepresentation(d._representation)),t.showAlways&&d.show(),d._initializingActive=!1,d._emit("init")}))}static create=t=>new E(t);_preBuild(){const{options:t}=this;for(const e of["el","container"])t[e]=c(t[e]);this._root=(t=>{const{components:e,useAsButton:o,inline:n,appClass:i,theme:s,lockOpacity:r}=t.options,l=t=>t?"":'style="display:none" hidden',c=e=>t._t(e),p=a(`\n      <div :ref="root" class="pickr">\n\n        ${o?"":'<button type="button" :ref="button" class="pcr-button"></button>'}\n\n        <div :ref="app" class="pcr-app ${i||""}" data-theme="${s}" ${n?'style="position: unset"':""} aria-label="${c("ui:dialog")}" role="window">\n          <div class="pcr-selection" ${l(e.palette)}>\n            <div :obj="preview" class="pcr-color-preview" ${l(e.preview)}>\n              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${c("btn:last-color")}"></button>\n              <div :ref="currentColor" class="pcr-current-color"></div>\n            </div>\n\n            <div :obj="palette" class="pcr-color-palette">\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${c("aria:palette")}" role="listbox"></div>\n            </div>\n\n            <div :obj="hue" class="pcr-color-chooser" ${l(e.hue)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${c("aria:hue")}" role="slider"></div>\n            </div>\n\n            <div :obj="opacity" class="pcr-color-opacity" ${l(e.opacity)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${c("aria:opacity")}" role="slider"></div>\n            </div>\n          </div>\n\n          <div class="pcr-swatches ${e.palette?"":"pcr-last"}" :ref="swatches"></div>\n\n          <div :obj="interaction" class="pcr-interaction" ${l(Object.keys(e.interaction).length)}>\n            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${l(e.interaction.input)} aria-label="${c("aria:input")}">\n\n            <input :arr="options" class="pcr-type" data-type="HEXA" value="${r?"HEX":"HEXA"}" type="button" ${l(e.interaction.hex)}>\n            <input :arr="options" class="pcr-type" data-type="RGBA" value="${r?"RGB":"RGBA"}" type="button" ${l(e.interaction.rgba)}>\n            <input :arr="options" class="pcr-type" data-type="HSLA" value="${r?"HSL":"HSLA"}" type="button" ${l(e.interaction.hsla)}>\n            <input :arr="options" class="pcr-type" data-type="HSVA" value="${r?"HSV":"HSVA"}" type="button" ${l(e.interaction.hsva)}>\n            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${l(e.interaction.cmyk)}>\n\n            <input :ref="save" class="pcr-save" value="${c("btn:save")}" type="button" ${l(e.interaction.save)} aria-label="${c("aria:btn:save")}">\n            <input :ref="cancel" class="pcr-cancel" value="${c("btn:cancel")}" type="button" ${l(e.interaction.cancel)} aria-label="${c("aria:btn:cancel")}">\n            <input :ref="clear" class="pcr-clear" value="${c("btn:clear")}" type="button" ${l(e.interaction.clear)} aria-label="${c("aria:btn:clear")}">\n          </div>\n        </div>\n      </div>\n    `),u=p.interaction;return u.options.find((t=>!t.hidden&&!t.classList.add("active"))),u.type=()=>u.options.find((t=>t.classList.contains("active"))),p})(this),t.useAsButton&&(this._root.button=t.el),t.container.appendChild(this._root.root)}_finalBuild(){const t=this.options,e=this._root;if(t.container.removeChild(e.root),t.inline){const o=t.el.parentElement;t.el.nextSibling?o.insertBefore(e.app,t.el.nextSibling):o.appendChild(e.app)}else t.container.appendChild(e.app);t.useAsButton?t.inline&&t.el.remove():t.el.parentNode.replaceChild(e.root,t.el),t.disabled&&this.disable(),t.comparison||(e.button.style.transition="none",t.useAsButton||(e.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const t=this,e=this.options.components,o=(t.options.sliders||"v").repeat(2),[n,i]=o.match(/^[vh]+$/g)?o:[],s=()=>this._color||(this._color=this._lastColor.clone()),r={palette:C({element:t._root.palette.picker,wrapper:t._root.palette.palette,onstop:()=>t._emit("changestop","slider",t),onchange(o,n){if(!e.palette)return;const i=s(),{_root:r,options:a}=t,{lastColor:l,currentColor:c}=r.preview;t._recalc&&(i.s=100*o,i.v=100-100*n,i.v<0&&(i.v=0),t._updateOutput("slider"));const p=i.toRGBA().toString(0);this.element.style.background=p,this.wrapper.style.background=`\n                        linear-gradient(to top, rgba(0, 0, 0, ${i.a}), transparent),\n                        linear-gradient(to left, hsla(${i.h}, 100%, 50%, ${i.a}), rgba(255, 255, 255, ${i.a}))\n                    `,a.comparison?a.useAsButton||t._lastColor||l.style.setProperty("--pcr-color",p):(r.button.style.setProperty("--pcr-color",p),r.button.classList.remove("clear"));const u=i.toHEXA().toString();for(const{el:e,color:o}of t._swatchColors)e.classList[u===o.toHEXA().toString()?"add":"remove"]("pcr-active");c.style.setProperty("--pcr-color",p)}}),hue:C({lock:"v"===i?"h":"v",element:t._root.hue.picker,wrapper:t._root.hue.slider,onstop:()=>t._emit("changestop","slider",t),onchange(o){if(!e.hue||!e.palette)return;const n=s();t._recalc&&(n.h=360*o),this.element.style.backgroundColor=`hsl(${n.h}, 100%, 50%)`,r.palette.trigger()}}),opacity:C({lock:"v"===n?"h":"v",element:t._root.opacity.picker,wrapper:t._root.opacity.slider,onstop:()=>t._emit("changestop","slider",t),onchange(o){if(!e.opacity||!e.palette)return;const n=s();t._recalc&&(n.a=Math.round(100*o)/100),this.element.style.background=`rgba(0, 0, 0, ${n.a})`,r.palette.trigger()}}),selectable:k({elements:t._root.interaction.options,className:"active",onchange(e){t._representation=e.target.getAttribute("data-type").toUpperCase(),t._recalc&&t._updateOutput("swatch")}})};this._components=r}_bindEvents(){const{_root:t,options:e}=this,o=[i(t.interaction.clear,"click",(()=>this._clearColor())),i([t.interaction.cancel,t.preview.lastColor],"click",(()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")})),i(t.interaction.save,"click",(()=>{!this.applyColor()&&!e.showAlways&&this.hide()})),i(t.interaction.result,["keyup","input"],(t=>{this.setColor(t.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),t.stopImmediatePropagation()})),i(t.interaction.result,["focus","blur"],(t=>{this._recalc="blur"===t.type,this._recalc&&this._updateOutput(null)})),i([t.palette.palette,t.palette.picker,t.hue.slider,t.hue.picker,t.opacity.slider,t.opacity.picker],["mousedown","touchstart"],(()=>this._recalc=!0),{passive:!0})];if(!e.showAlways){const n=e.closeWithKey;o.push(i(t.button,"click",(()=>this.isOpen()?this.hide():this.show())),i(document,"keyup",(t=>this.isOpen()&&(t.key===n||t.code===n)&&this.hide())),i(document,["touchstart","mousedown"],(e=>{this.isOpen()&&!l(e).some((e=>e===t.app||e===t.button))&&this.hide()}),{capture:!0}))}if(e.adjustableNumbers){const e={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};p(t.interaction.result,((t,o,n)=>{const i=e[this.getColorRepresentation().toLowerCase()];if(i){const e=i[n],s=t+(e>=100?1e3*o:o);return s<=0?0:Number((s<e?s:e).toPrecision(3))}return t}))}if(e.autoReposition&&!e.inline){let t=null;const n=this;o.push(i(window,["scroll","resize"],(()=>{n.isOpen()&&(e.closeOnScroll&&n.hide(),null===t?(t=setTimeout((()=>t=null),100),requestAnimationFrame((function e(){n._rePositioningPicker(),null!==t&&requestAnimationFrame(e)}))):(clearTimeout(t),t=setTimeout((()=>t=null),100)))}),{capture:!0}))}this._eventBindings=o}_rePositioningPicker(){const{options:t}=this;if(!t.inline){if(!this._nanopop.update({container:document.body.getBoundingClientRect(),position:t.position})){const t=this._root.app,e=t.getBoundingClientRect();t.style.top=(window.innerHeight-e.height)/2+"px",t.style.left=(window.innerWidth-e.width)/2+"px"}}}_updateOutput(t){const{_root:e,_color:o,options:n}=this;if(e.interaction.type()){const t=`to${e.interaction.type().getAttribute("data-type")}`;e.interaction.result.value="function"==typeof o[t]?o[t]().toString(n.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",o,t,this)}_clearColor(t=!1){const{_root:e,options:o}=this;o.useAsButton||e.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),e.button.classList.add("clear"),o.showAlways||this.hide(),this._lastColor=null,this._initializingActive||t||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(t){const{values:e,type:o,a:n}=w(t),{lockOpacity:i}=this.options,s=void 0!==n&&1!==n;return e&&3===e.length&&(e[3]=void 0),{values:!e||i&&s?null:e,type:o}}_t(t){return this.options.i18n[t]||E.I18N_DEFAULTS[t]}_emit(t,...e){this._eventListener[t].forEach((t=>t(...e,this)))}on(t,e){return this._eventListener[t].push(e),this}off(t,e){const o=this._eventListener[t]||[],n=o.indexOf(e);return~n&&o.splice(n,1),this}addSwatch(t){const{values:e}=this._parseLocalColor(t);if(e){const{_swatchColors:t,_root:o}=this,n=A(...e),s=r(`<button type="button" style="--pcr-color: ${n.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return o.swatches.appendChild(s),t.push({el:s,color:n}),this._eventBindings.push(i(s,"click",(()=>{this.setHSVA(...n.toHSVA(),!0),this._emit("swatchselect",n),this._emit("change",n,"swatch",this)}))),!0}return!1}removeSwatch(t){const e=this._swatchColors[t];if(e){const{el:o}=e;return this._root.swatches.removeChild(o),this._swatchColors.splice(t,1),!0}return!1}applyColor(t=!1){const{preview:e,button:o}=this._root,n=this._color.toRGBA().toString(0);return e.lastColor.style.setProperty("--pcr-color",n),this.options.useAsButton||o.style.setProperty("--pcr-color",n),o.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||t||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach((t=>s(...t))),Object.keys(this._components).forEach((t=>this._components[t].destroy()))}destroyAndRemove(){this.destroy();const{root:t,app:e}=this._root;t.parentElement&&t.parentElement.removeChild(t),e.parentElement.removeChild(e),Object.keys(this).forEach((t=>this[t]=null))}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(t=360,e=0,o=0,n=1,i=!1){const s=this._recalc;if(this._recalc=!1,t<0||t>360||e<0||e>100||o<0||o>100||n<0||n>1)return!1;this._color=A(t,e,o,n);const{hue:r,opacity:a,palette:l}=this._components;return r.update(t/360),a.update(n),l.update(e/100,1-o/100),i||this.applyColor(),s&&this._updateOutput(),this._recalc=s,!0}setColor(t,e=!1){if(null===t)return this._clearColor(e),!0;const{values:o,type:n}=this._parseLocalColor(t);if(o){const t=n.toUpperCase(),{options:i}=this._root.interaction,s=i.find((e=>e.getAttribute("data-type")===t));if(s&&!s.hidden)for(const t of i)t.classList[t===s?"add":"remove"]("active");return!!this.setHSVA(...o,e)&&this.setColorRepresentation(t)}return!1}setColorRepresentation(t){return t=t.toUpperCase(),!!this._root.interaction.options.find((e=>e.getAttribute("data-type").startsWith(t)&&!e.click()))}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}}return e=e.default})()));
//# sourceMappingURL=pickr.min.js.map

/***/ }),

/***/ "./core-bundle/assets/controllers/ace-controller.js":
/*!**********************************************************!*\
  !*** ./core-bundle/assets/controllers/ace-controller.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    type: String,
    readOnly: Boolean
  }))();
  connect() {
    // Create a div to apply the editor to
    this.container = document.createElement('div');
    this.container.id = this.element.id + '_div';
    this.container.className = this.element.className;
    this.element.parentNode.insertBefore(this.container, this.element.nextSibling);

    // Hide the textarea
    this.element.style['display'] = 'none';

    // Instantiate the editor
    this.editor = ace.edit(this.container);
    this.editor.getSession().setValue(this.element.value);
    this.editor.on('focus', () => {
      window.dispatchEvent(new Event('store-scroll-offset'));
    });
    this.editor.getSession().on('change', () => {
      this.element.value = this.editor.getValue();
    });

    // Disable command conflicts with AltGr (see #5792)
    this.editor.commands.bindKey('Ctrl-alt-a|Ctrl-alt-e|Ctrl-alt-h|Ctrl-alt-l|Ctrl-alt-s', null);

    // Execute the config callback
    this.element?.configCallback(this.editor);
    this.setMaxLines();
    window.addEventListener('resize', this.setMaxLines.bind(this));
  }
  disconnect() {
    this.editor?.destroy();
    this.container?.remove();
  }
  beforeCache() {
    // Remove the element container before Turbo caches the page. It will
    // be recreated when the connect() call happens on the restored page.
    this.disconnect();
  }
  colorChange(event) {
    this.editor.setTheme(`ace/theme/${event.detail.mode === 'dark' ? 'twilight' : 'clouds'}`);
  }
  setMaxLines() {
    this.editor.setOption('maxLines', Math.floor((window.innerHeight - 320) / Math.floor(12 * this.editor.container.style.lineHeight)));
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/backend-search-controller.js":
/*!*********************************************************************!*\
  !*** ./core-bundle/assets/controllers/backend-search-controller.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ BackendSearchController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class BackendSearchController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ["input", "results"];
  static values = (() => ({
    route: String,
    minCharacters: {
      type: Number,
      default: 3
    },
    delay: {
      type: Number,
      default: 150
    }
  }))();
  static classes = ["hidden", "initial", "loading", "invalid", "results", "error"];
  connect() {
    this.active = false;
    this.timeout = null;
    this.setState("hidden");
  }
  performSearch() {
    if (this.inputTarget.value.length < this.minCharactersValue) {
      return this.setState("invalid");
    }
    clearTimeout(this.timeout);
    this.timeout = setTimeout(() => {
      this.loadResults();
    }, this.delayValue);
  }
  loadResults() {
    this.setState("loading");
    fetch(this.searchRoute).then(res => {
      if (!res.ok) {
        throw new Error(res.statusText);
      }
      return res.text();
    }).then(html => {
      this.resultsTarget.innerHTML = html;
      this.setState("results");
    }).catch(e => {
      this.setState("error");
    });
  }
  open() {
    if (!this.active) {
      this.setState("initial");
      this.active = true;
    }
  }
  close() {
    this.inputTarget.blur();
    this.inputTarget.value = "";
    this.active = false;
    this.timeout = null;
    this.setState("hidden");
    this._resetFocusableResults();
  }
  inputBlur() {
    if ("results" === this.state) {
      return;
    }
    this.close();
  }
  focusTrapNext(event) {
    if ("results" === this.state && document.activeElement === this.lastFocus) {
      event.preventDefault();
      this.firstFocus?.focus();
    }
  }
  focusTrapPrev(event) {
    if ("results" === this.state && document.activeElement === this.firstFocus) {
      event.preventDefault();
      this.lastFocus?.focus();
    }
  }
  _resetFocusableResults() {
    this.firstFocus = null;
    this.lastFocus = null;
  }
  _setFocusableResults() {
    const elements = [this.inputTarget, ...this.resultsTarget.querySelectorAll('a[href]:not([disabled]), button:not([disabled])')];
    this.firstFocus = elements[0] ?? [];
    this.lastFocus = elements[elements.length - 1] ?? [];
  }
  documentClick(event) {
    if (this.element.contains(event.target)) {
      return;
    }
    this.close();
  }
  setState(state) {
    this.state = state;
    if (state === "results") {
      this._setFocusableResults();
    } else {
      this._resetFocusableResults();
    }
    BackendSearchController.classes.forEach(className => {
      this.element.classList.toggle(this[`${className}Class`], className === state);
    });
  }
  get searchRoute() {
    return this.routeValue + this.inputTarget.value;
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/choices-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/choices-controller.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ ChoicesController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class ChoicesController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  mutationGuard = false;
  connect() {
    if (this._isGuarded()) {
      return;
    }

    // Choices wraps the element multiple times during initialization, leading to
    // multiple disconnects/reconnects of the controller that we need to ignore.
    this._setGuard();
    const select = this.element;
    this.choices = new Choices(select, {
      shouldSort: false,
      duplicateItemsAllowed: false,
      allowHTML: false,
      removeItemButton: true,
      searchEnabled: select.options.length > 7,
      classNames: {
        containerOuter: ['choices', ...Array.from(select.classList)],
        flippedState: ''
      },
      fuseOptions: {
        includeScore: true,
        threshold: 0.4
      },
      callbackOnInit: () => {
        const choices = select.closest('.choices')?.querySelector('.choices__list--dropdown > .choices__list');
        if (choices && select.dataset.placeholder) {
          choices.dataset.placeholder = select.dataset.placeholder;
        }
        this._resetGuard();
      },
      loadingText: Contao.lang.loading,
      noResultsText: Contao.lang.noResults,
      noChoicesText: Contao.lang.noOptions,
      removeItemLabelText: function (value) {
        return Contao.lang.removeItem.concat(' ').concat(value);
      }
    });
  }
  disconnect() {
    if (this._isGuarded()) {
      return;
    }
    this._removeChoices();
  }
  beforeCache() {
    // Let choices unwrap the element container before Turbo caches the
    // page. It will be recreated, when the connect() call happens on the
    // restored page.
    this._removeChoices();
  }
  _removeChoices() {
    // Safely unwrap the element by preventing disconnect/connect calls
    // during the process.
    this._setGuard();
    this.choices?.destroy();
    this.choices = null;
    this._resetGuard();
  }
  _setGuard() {
    this.mutationGuard = true;
  }
  _resetGuard() {
    // Reset guard as soon as the call stack has cleared.
    setTimeout(() => {
      this.mutationGuard = false;
    }, 0);
  }
  _isGuarded() {
    return this.mutationGuard;
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/clipboard-controller.js":
/*!****************************************************************!*\
  !*** ./core-bundle/assets/controllers/clipboard-controller.js ***!
  \****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    content: String
  }))();
  write() {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(this.contentValue).catch(this.clipboardFallback.bind(this));
    } else {
      this.clipboardFallback();
    }
  }
  clipboardFallback() {
    const input = document.createElement('input');
    input.value = this.contentValue;
    document.body.appendChild(input);
    input.select();
    input.setSelectionRange(0, 99999);
    document.execCommand('copy');
    document.body.removeChild(input);
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/color-picker-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/color-picker-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _stimulus_components_color_picker__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @stimulus-components/color-picker */ "./node_modules/@stimulus-components/color-picker/dist/stimulus-color-picker.mjs");

/* harmony default export */ __webpack_exports__["default"] = (class extends _stimulus_components_color_picker__WEBPACK_IMPORTED_MODULE_0__["default"] {
  // Override the onSave function to strip the leading `#`
  onSave(color) {
    this.inputTarget.value = null;
    if (color) {
      let value = color.toHEXA().toString();
      if ('#' === value.charAt(0)) {
        value = value.substring(1);
      }
      this.inputTarget.value = value.toLowerCase();
    }
    this.picker.hide();
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/color-scheme-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/color-scheme-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

const prefersDark = () => {
  const prefersDark = localStorage.getItem('contao--prefers-dark');
  if (null === prefersDark) {
    return !!window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return prefersDark === 'true';
};
const setColorScheme = () => {
  document.documentElement.dataset.colorScheme = prefersDark() ? 'dark' : 'light';
};
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setColorScheme);
setColorScheme();
/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['label'];
  static values = (() => ({
    i18n: {
      type: Object,
      default: {
        light: 'Disable dark mode',
        dark: 'Enable dark mode'
      }
    }
  }))();
  initialize() {
    this.setLabel = this.setLabel.bind(this);
  }
  connect() {
    this.matchMedia = window.matchMedia('(prefers-color-scheme: dark)');
    this.matchMedia.addEventListener('change', this.setLabel);
    this.setLabel();
  }
  disconnect() {
    this.matchMedia.removeEventListener('change', this.setLabel);
  }
  toggle(e) {
    e.preventDefault();
    const isDark = !prefersDark();
    if (isDark === this.matchMedia.matches) {
      localStorage.removeItem('contao--prefers-dark');
    } else {
      localStorage.setItem('contao--prefers-dark', String(isDark));
    }
    setColorScheme();
    this.dispatch('change', {
      detail: {
        mode: isDark ? 'dark' : 'light'
      }
    });

    // Change the label after the dropdown is hidden
    setTimeout(this.setLabel, 300);
  }
  setLabel() {
    if (!this.hasLabelTarget) {
      return;
    }
    const label = this.i18nValue[prefersDark() ? 'light' : 'dark'];
    this.labelTarget.title = label;
    this.labelTarget.innerText = label;
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/deeplink-controller.js":
/*!***************************************************************!*\
  !*** ./core-bundle/assets/controllers/deeplink-controller.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hotwired/turbo */ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js");


/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['primary', 'secondary'];
  static afterLoad(identifier) {
    const setupController = () => {
      document.querySelectorAll('.click2edit').forEach(el => {
        el.classList.remove('click2edit');
        const primary = el.querySelector('a.edit');
        const secondary = el.querySelector('a.children');
        if (primary) {
          primary.setAttribute(`data-${identifier}-target`, "primary");
        }
        if (secondary) {
          secondary.setAttribute(`data-${identifier}-target`, "secondary");
        }
        el.dataset.controller = `${el.dataset.controller || ''} ${identifier}`;
      });
    };
    document.addEventListener('DOMContentLoaded', setupController);
    document.addEventListener('ajax_change', setupController);
    document.addEventListener('turbo:render', setupController);
    document.addEventListener('turbo:frame-render', setupController);
    setupController();
    Theme.setupCtrlClick = () => {
      if (window.console) {
        console.warn('Using Theme.setupCtrlClick() is deprecated and will be removed in Contao 6. Apply the Stimulus actions instead.');
      }
      setupController();
    };
  }
  initialize() {
    this.handle = this.handle.bind(this);
  }
  connect() {
    this.element.addEventListener('click', this.handle);
  }
  handle(event) {
    // Ignore clicks on anchor elements
    if (!this.isValid(event.target)) {
      return;
    }
    const primaryKey = window.navigator.platform?.startsWith('Mac') ? 'metaKey' : 'ctrlKey';
    if (event[primaryKey] && !event.shiftKey && this.hasPrimaryTarget && this.primaryTarget.href) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.primaryTarget.href);
      return;
    }
    if (event[primaryKey] && event.shiftKey && this.hasSecondaryTarget && this.secondaryTarget.href) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.secondaryTarget.href);
      return;
    }
    if (event.pointerType === 'mouse' || !this.hasPrimaryTarget || !this.primaryTarget.href) {
      return;
    }
    clearTimeout(this.$timer);
    if (!this.element.getAttribute('data-visited')) {
      this.element.setAttribute('data-visited', '1');
      this.$timer = setTimeout(() => {
        this.element.removeAttribute('data-visited');
      }, 2000);
    } else {
      this.element.removeAttribute('data-visited');
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.primaryTarget.href);
    }
  }
  visitPrimary(event) {
    if (this.hasPrimaryTarget && this.primaryTarget.href && this.isValid(event.target)) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.primaryTarget.href);
    }
  }
  visitSecondary(event) {
    if (this.hasSecondaryTarget && this.secondaryTarget.href && this.isValid(event.target)) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.secondaryTarget.href);
    }
  }
  isValid(element) {
    return 'a' !== element.tagName && !element.closest('a, button');
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/image-size-controller.js":
/*!*****************************************************************!*\
  !*** ./core-bundle/assets/controllers/image-size-controller.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['select', 'button', 'image'];
  static values = (() => ({
    config: Object
  }))();
  connect() {
    this.updateWizard();
  }
  updateWizard() {
    if (this.canEdit()) {
      this.buttonTarget.title = this.configValue.title;
      this.buttonTarget.disabled = false;
      this.imageTargets.forEach(img => {
        img.src = this.configValue.icon;
      });
    } else {
      this.buttonTarget.title = '';
      this.buttonTarget.disabled = true;
      this.imageTargets.forEach(img => {
        img.src = this.configValue.iconDisabled;
      });
    }
  }
  openModal() {
    Backend.openModalIframe({
      title: this.configValue.title,
      url: `${this.configValue.href}&id=${this.selectTarget.value}`
    });
  }
  canEdit() {
    return this.configValue.ids.includes(Number(this.selectTarget.value));
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/jump-targets-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/jump-targets-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['navigation', 'section'];
  sectionTargetConnected() {
    this.rebuildNavigation();
  }
  sectionTargetDisconnected() {
    this.rebuildNavigation();
  }
  rebuildNavigation() {
    if (!this.hasNavigationTarget) {
      return;
    }
    const links = document.createElement('ul');
    this.sectionTargets.forEach(el => {
      const action = document.createElement('button');
      action.innerText = el.getAttribute(`data-${this.identifier}-label-value`);
      action.addEventListener('click', event => {
        event.preventDefault();
        this.dispatch('scrollto', {
          target: el
        });
        el.scrollIntoView();
      });
      const li = document.createElement('li');
      li.append(action);
      links.append(li);
    });
    this.navigationTarget.replaceChildren(links);
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/limit-height-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/limit-height-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    max: Number,
    expand: String,
    collapse: String,
    expandAll: String,
    expandAllTitle: String,
    collapseAll: String,
    collapseAllTitle: String
  }))();
  static targets = ['operation', 'node'];
  initialize() {
    super.initialize();
    this.togglerMap = new WeakMap();
    this.nextId = 1;
  }
  operationTargetConnected() {
    this.updateOperation();
  }
  nodeTargetConnected(node) {
    const style = window.getComputedStyle(node, null);
    const padding = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);
    const height = node.clientHeight - padding;

    // Resize the element if it is higher than the maximum height
    if (this.maxValue > height) {
      return;
    }
    if (!node.id) {
      node.id = `limit-height-${this.nextId++}`;
    }
    node.style.overflow = 'hidden';
    node.style.maxHeight = `${this.maxValue}px`;
    const button = document.createElement('button');
    button.setAttribute('type', 'button');
    button.title = this.expandValue;
    button.innerHTML = '<span>...</span>';
    button.classList.add('unselectable');
    button.setAttribute('aria-expanded', 'false');
    button.setAttribute('aria-controls', node.id);
    button.addEventListener('click', event => {
      event.preventDefault();
      this.toggle(node);
      this.updateOperation(event);
    });
    const toggler = document.createElement('div');
    toggler.classList.add('limit_toggler');
    toggler.append(button);
    this.togglerMap.set(node, toggler);
    node.append(toggler);
    this.updateOperation();
  }
  nodeTargetDisconnected(node) {
    if (!this.togglerMap.has(node)) {
      return;
    }
    this.togglerMap.get(node).remove();
    this.togglerMap.delete(node);
    node.style.overflow = '';
    node.style.maxHeight = '';
  }
  toggle(node) {
    if (node.style.maxHeight === '') {
      this.collapse(node);
    } else {
      this.expand(node);
    }
  }
  expand(node) {
    if (!this.togglerMap.has(node)) {
      return;
    }
    node.style.maxHeight = '';
    const button = this.togglerMap.get(node).querySelector('button');
    button.title = this.collapseValue;
    button.setAttribute('aria-expanded', 'true');
  }
  collapse(node) {
    if (!this.togglerMap.has(node)) {
      return;
    }
    node.style.maxHeight = `${this.maxValue}px`;
    const button = this.togglerMap.get(node).querySelector('button');
    button.title = this.expandValue;
    button.setAttribute('aria-expanded', 'false');
  }
  toggleAll(event) {
    event.preventDefault();
    const isExpanded = this.hasExpanded() ^ event.altKey;
    this.nodeTargets.forEach(node => {
      if (isExpanded) {
        this.collapse(node);
      } else {
        this.expand(node);
      }
    });
    this.updateOperation(event);
  }
  keypress(event) {
    this.updateOperation(event);
  }
  updateOperation(event) {
    if (!this.hasOperationTarget) {
      return;
    }
    const hasTogglers = !!this.nodeTargets.find(el => this.togglerMap.has(el));
    const expanded = this.hasExpanded();
    this.operationTarget.style.display = hasTogglers ? '' : 'none';
    this.operationTarget.setAttribute('aria-controls', this.nodeTargets.map(el => el.id).join(' '));
    this.operationTarget.setAttribute('aria-expanded', expanded ? 'true' : 'false');
    if (expanded ^ (event ? event.altKey : false)) {
      this.operationTarget.innerText = this.collapseAllValue;
      this.operationTarget.title = this.collapseAllTitleValue;
    } else {
      this.operationTarget.innerText = this.expandAllValue;
      this.operationTarget.title = this.expandAllTitleValue;
    }
  }
  hasExpanded() {
    return !!this.nodeTargets.find(el => this.togglerMap.has(el) && el.style.maxHeight === '');
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/metawizard-controller.js":
/*!*****************************************************************!*\
  !*** ./core-bundle/assets/controllers/metawizard-controller.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['input'];
  delete() {
    this.inputTargets.forEach(input => {
      input.value = '';
    });
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/operations-menu-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/operations-menu-controller.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ OperationsMenuController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var accessible_menu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! accessible-menu */ "./node_modules/accessible-menu/dist/accessible-menu.es.js");


class OperationsMenuController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['menu', 'submenu', 'controller', 'title'];
  connect() {
    if (!this.hasControllerTarget || !this.hasMenuTarget) {
      return;
    }
    this.$menu = new accessible_menu__WEBPACK_IMPORTED_MODULE_1__["default"].DisclosureMenu({
      menuElement: this.menuTarget,
      menuLinkSelector: 'a,button,img'
    });
    this.controllerTarget?.addEventListener('accessibleMenuExpand', () => {
      Object.values(window.AccessibleMenu.menus).forEach(menu => {
        if (menu !== this.$menu && menu.elements.submenuToggles[0].isOpen) {
          menu.elements.submenuToggles[0].close();
        }
      });
      this.setFixedPosition();
      this.element.classList.add('hover');
    });
    this.controllerTarget?.addEventListener('accessibleMenuCollapse', () => {
      this.element.classList.remove('hover');
    });
  }
  disconnect() {
    // Cleanup menu instance, otherwise we would leak memory
    for (const [key, value] of Object.entries(window.AccessibleMenu.menus)) {
      if (value === this.$menu) {
        delete window.AccessibleMenu.menus[key];
      }
    }
  }
  titleTargetConnected(el) {
    el.removeAttribute(`data-${this.identifier}-target`);
    const link = el.querySelector('a[title]');
    if (link && '' !== link.getAttribute('title')) {
      link.append(link.getAttribute('title'));
      return;
    }
    const img = el.querySelector('img[alt]');
    if (img && '' !== img.getAttribute('alt')) {
      img.parentNode.append(img.getAttribute('alt'));
    }
  }
  open(event) {
    if (!this.hasControllerTarget || !this.hasMenuTarget || this.isInteractive(event.target)) {
      return;
    }
    event.preventDefault();
    event.stopPropagation();
    this.$menu.elements.submenuToggles[0].open();
    this.setFixedPosition(event);
  }
  setFixedPosition(event) {
    const rect = this.submenuTarget.getBoundingClientRect();
    let x,
      y,
      offset = 0;
    if (event) {
      x = event.clientX;
      y = event.clientY;
    } else {
      const r = this.controllerTarget.getBoundingClientRect();
      x = r.x;
      y = r.y;
      offset = 20;
    }
    this.submenuTarget.style.position = 'fixed';
    this.submenuTarget.style.right = 'auto';
    if (window.innerHeight < y + rect.height) {
      this.submenuTarget.style.top = `${y - rect.height}px`;
    } else {
      this.submenuTarget.style.top = `${y + offset}px`;
    }
    if (window.innerWidth < x + rect.width) {
      this.submenuTarget.style.left = `${x - rect.width + offset}px`;
    } else {
      this.submenuTarget.style.left = `${x + offset}px`;
    }
  }
  isInteractive(el) {
    if (el instanceof HTMLImageElement || el instanceof HTMLAnchorElement || el instanceof HTMLButtonElement) {
      return true;
    }

    // Also check the parent element if el is not interactive
    const parent = el.parentElement;
    return parent instanceof HTMLImageElement || parent instanceof HTMLAnchorElement || parent instanceof HTMLButtonElement;
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/passkeys-controller.js":
/*!***************************************************************!*\
  !*** ./core-bundle/assets/controllers/passkeys-controller.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['form', 'nameInput'];
  nameInputTargetConnected(el) {
    el.focus();
    el.select();
  }
  cancelEdit(e) {
    this.nameInputTarget.value = this.nameInputTarget.getAttribute('value');
    this.formTarget.requestSubmit();
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/profile-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/profile-controller.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['button', 'menu'];
  static values = (() => ({
    name: {
      type: String,
      default: 'tmenu__profile'
    }
  }))();
  buttonTargetConnected(button) {
    button.setAttribute('aria-controls', this.nameValue);
    button.setAttribute('aria-expanded', 'false');
  }
  menuTargetConnected(menu) {
    menu.setAttribute('id', this.nameValue);
  }
  toggle(event) {
    this.menuTarget.classList.toggle('active');
    if (this.menuTarget.classList.contains('active')) {
      this.buttonTarget.setAttribute('aria-expanded', 'true');
    } else {
      this.buttonTarget.setAttribute('aria-expanded', 'false');
    }
  }
  close() {
    this.menuTarget.classList.remove('active');
    this.buttonTarget.setAttribute('aria-expanded', 'false');
  }
  documentClick(event) {
    if (this.buttonTarget.contains(event.target)) {
      return;
    }
    this.close();
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/scroll-offset-controller.js":
/*!********************************************************************!*\
  !*** ./core-bundle/assets/controllers/scroll-offset-controller.js ***!
  \********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['scrollTo', 'autoFocus', 'widgetError'];
  static values = (() => ({
    sessionKey: {
      type: String,
      default: 'contao_backend_offset'
    },
    behavior: {
      type: String,
      default: 'instant'
    },
    block: {
      type: String,
      default: 'center'
    }
  }))();

  // Backwards compatibility: automatically register the Stimulus controller if the legacy methods are used
  static afterLoad(identifier, application) {
    const loadFallback = () => {
      return new Promise((resolve, reject) => {
        const controller = application.getControllerForElementAndIdentifier(document.documentElement, identifier);
        if (controller) {
          resolve(controller);
          return;
        }
        const {
          controllerAttribute
        } = application.schema;
        document.documentElement.setAttribute(controllerAttribute, `${document.documentElement.getAttribute(controllerAttribute) || ''} ${identifier}`);
        setTimeout(() => {
          const controller = application.getControllerForElementAndIdentifier(document.documentElement, identifier);
          controller && resolve(controller) || reject(controller);
        }, 100);
      });
    };
    if (window.Backend && !window.Backend.initScrollOffset) {
      window.Backend.initScrollOffset = () => {
        if (window.console) {
          console.warn('Backend.initScrollOffset() is deprecated. Please use the Stimulus controller instead.');
        }
        loadFallback();
      };
    }
    if (window.Backend && !window.Backend.getScrollOffset) {
      window.Backend.getScrollOffset = () => {
        if (window.console) {
          console.warn('Backend.getScrollOffset() is deprecated. Please use the Stimulus controller instead.');
        }
        loadFallback().then(controller => controller.discard());
      };
    }
  }
  initialize() {
    this.store = this.store.bind(this);
  }
  connect() {
    this.restore();
  }
  async restore() {
    if (!this.offset) return;

    // Execute scroll restore after Turbo scrolled to top
    await new Promise(requestAnimationFrame);
    window.scrollTo({
      top: this.offset,
      behavior: this.behaviorValue,
      block: this.blockValue
    });
    this.offset = null;
  }
  scrollToTargetConnected() {
    this.scrollToTarget.scrollIntoView({
      behavior: this.behaviorValue,
      block: this.blockValue
    });
  }
  autoFocusTargetConnected() {
    if (this.offset || this.autoFocus) return;
    const input = this.autoFocusTarget;
    if (input.disabled || input.readonly || !input.offsetWidth || !input.offsetHeight || input.closest('.chzn-search') || input.autocomplete && input.autocomplete !== 'off') {
      return;
    }
    this.autoFocus = true;
    input.focus();
  }
  widgetErrorTargetConnected() {
    this.widgetErrorTarget.scrollIntoView({
      behavior: 'smooth',
      block: 'start'
    });
  }
  store() {
    this.offset = this.element.scrollTop;
  }
  discard() {
    this.offset = null;
  }
  scrollToWidgetError() {
    if (this.hasWidgetErrorTarget) {
      this.widgetErrorTargetConnected();
    }
  }
  get offset() {
    const value = window.sessionStorage.getItem(this.sessionKeyValue);
    return value ? parseInt(value) : null;
  }
  set offset(value) {
    if (value === null || value === undefined) {
      window.sessionStorage.removeItem(this.sessionKeyValue);
    } else {
      window.sessionStorage.setItem(this.sessionKeyValue, String(value));
    }
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/tabs-controller.js":
/*!***********************************************************!*\
  !*** ./core-bundle/assets/controllers/tabs-controller.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ TabsController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class TabsController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    closeLabel: String
  }))();
  static targets = ['navigation', 'panel'];
  activeTab = null;
  panelTargetConnected(panel) {
    // When the DOM is already set up, just set the panel ID and
    // install the event listeners, otherwise create the elements first.
    const isRestore = 'tabpanel' === panel.getAttribute('role');
    const tabId = isRestore ? panel.dataset.tabId : (Math.random() + 1).toString(36).substring(7);
    const containerId = this.element.id;
    const panelReference = panel.id || `tab-panel_${containerId}_${tabId}`;
    const controlReference = `tab-control_${containerId}_${tabId}`;

    // Create navigation elements
    const selectButton = isRestore ? this.navigationTarget.querySelector(`button.select[aria-controls="${panelReference}"]`) : (() => {
      const button = document.createElement('button');
      button.id = controlReference;
      button.className = 'select';
      button.innerText = panel.dataset.label;
      button.setAttribute('type', 'button');
      button.setAttribute('role', 'tab');
      button.setAttribute('aria-controls', panelReference);
      return button;
    })();
    selectButton.addEventListener('click', () => {
      this.selectTab(panel);
    });
    const closeButton = isRestore ? this.navigationTarget.querySelector(`button.close[aria-controls="${panelReference}"]`) : (() => {
      const button = document.createElement('button');
      button.className = 'close';
      button.innerText = '×';
      button.setAttribute('type', 'button');
      button.setAttribute('aria-controls', panelReference);
      button.setAttribute('aria-label', this.closeLabelValue);
      return button;
    })();
    closeButton.addEventListener('click', () => {
      // Remove the panel and let the disconnect handler do the rest
      panel.remove();
    });
    if (!isRestore) {
      // Enhance panel container
      panel.dataset.tabId = tabId;
      panel.id = panelReference;
      panel.setAttribute('role', 'tabpanel');
      panel.setAttribute('aria-labelledby', controlReference);

      // Add navigation element
      const li = document.createElement('li');
      li.setAttribute('role', 'presentation');
      li.append(selectButton);
      li.append(closeButton);
      this.navigationTarget.append(li);
    }

    // Activate tab
    this.selectTab(panel);
  }
  panelTargetDisconnected(panel) {
    // Remove controls
    document.getElementById(panel.getAttribute('aria-labelledby'))?.parentElement?.remove();

    // Select the first tab/no tab if the current tab was active before closing.
    if (panel === this.activeTab) {
      if (this.hasPanelTarget) {
        this.selectTab(this.panelTarget);
      } else {
        this.activeTab = null;
      }
    }
  }
  selectTab(panel) {
    this.panelTargets.forEach(el => {
      const isTarget = el === panel;
      el.toggleAttribute('aria-selected', isTarget);
      el.toggleAttribute('data-active', isTarget);
      el.style.display = isTarget ? 'revert' : 'none';

      // Re-enable/disable the button access keys
      if (isTarget) {
        el.querySelectorAll('button[data-disabled-accesskey]').forEach(button => {
          button.setAttribute('accesskey', button.getAttribute('data-disabled-accesskey'));
          button.removeAttribute('data-disabled-accesskey');
        });
      } else {
        el.querySelectorAll('button[accesskey]').forEach(button => {
          button.setAttribute('data-disabled-accesskey', button.getAttribute('accesskey'));
          button.removeAttribute('accesskey');
        });
      }
      const selectButton = document.getElementById(el.getAttribute('aria-labelledby'));
      selectButton?.toggleAttribute('aria-selected', isTarget);
      selectButton?.parentElement.toggleAttribute('data-active', isTarget);
    });
    this.activeTab = panel;
  }
  getActiveTab() {
    return this.activeTab;
  }
  getTabs() {
    return this.panelTargets.reduce((result, panel) => {
      result[panel.id] = panel;
      return result;
    }, {});
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/template-studio-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/template-studio-controller.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _modules_twig_editor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/twig-editor */ "./core-bundle/assets/modules/twig-editor.js");


/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  editors = (() => new Map())();
  static values = (() => ({
    followUrl: String,
    blockInfoUrl: String
  }))();
  static targets = ['themeSelector', 'tabs', 'editor', 'editorAnnotations', 'dialog'];
  connect() {
    // Subscribe to events dispatched by the editors
    this.element.addEventListener('twig-editor:lens:follow', event => {
      this._visit(this.followUrlValue, {
        name: event.detail.name
      });
    });
    this.element.addEventListener('twig-editor:lens:block-info', event => {
      this._visit(this.blockInfoUrlValue, event.detail);
    });
    this.element.addEventListener('turbo:submit-start', event => {
      // Add the currently open editor tabs to the request when selecting a theme
      if (event.target === this.themeSelectorTarget) {
        this._addOpenEditorTabsToRequest(event);
      }

      // Include the active editor's content when the save operation was triggered
      if (event.detail.formSubmission.submitter?.dataset?.operation === 'save') {
        this._addEditorContentToRequest(event);
        this._getActiveMutableEditor()?.focus();
      }
    });
  }
  beforeCache() {
    // Destroy editor instances before Turbo caches the page. They will be
    // recreated when the editorTargetConnected() calls happens on the
    // restored page.
    for (const [key, editor] of this.editors) {
      editor.destroy();
      delete this.editors[key];
    }
  }
  close(event) {
    document.getElementById(event.target.getAttribute('aria-controls')).innerText = '';
  }
  editorTargetConnected(el) {
    this.editors.set(el, new _modules_twig_editor__WEBPACK_IMPORTED_MODULE_1__.TwigEditor(el.querySelector('textarea')));
  }
  editorTargetDisconnected(el) {
    this.editors.get(el).destroy();
    this.editors.delete(el);
  }
  editorAnnotationsTargetConnected(el) {
    this.editors.get(el.closest('*[data-contao--template-studio-target="editor"]'))?.setAnnotationsData(JSON.parse(el.innerText));
  }
  dialogTargetConnected(el) {
    el.showModal();
    el.querySelector('input')?.focus();
    el.querySelector('input[type="text"]')?.select();
    el.querySelector('form')?.addEventListener('submit', () => {
      el.remove();
    });
  }
  colorChange(event) {
    this.editors.forEach(editor => {
      editor.setColorScheme(event.detail.mode);
    });
  }
  _addOpenEditorTabsToRequest(event) {
    const searchParams = event.detail.formSubmission.location.searchParams;
    const tabs = this.application.getControllerForElementAndIdentifier(this.tabsTarget, 'contao--tabs').getTabs();
    Object.keys(tabs).forEach(tabId => {
      // Extract identifier from tabId "template-studio--tab_<identifier>"
      searchParams.append('open_tab[]', tabId.substring(21));
    });
  }
  _addEditorContentToRequest(event) {
    event.detail.formSubmission.fetchRequest.body.append('code', this._getActiveMutableEditor()?.getContent() ?? '');
  }
  _getActiveMutableEditor() {
    const editorElementsOnActiveTab = this.application.getControllerForElementAndIdentifier(this.tabsTarget, 'contao--tabs').getActiveTab()?.querySelectorAll('*[data-contao--template-studio-target="editor"]');
    for (const el of editorElementsOnActiveTab ?? []) {
      const editor = this.editors.get(el);
      if (editor && editor.isEditable()) {
        return editor;
      }
    }
    return null;
  }
  async _visit(url, params) {
    if (params !== null) {
      url += '?' + new URLSearchParams(params).toString();
    }
    const response = await fetch(url, {
      method: 'get',
      headers: {
        'Accept': 'text/vnd.turbo-stream.html'
      }
    });
    if (response.redirected) {
      document.location = response.url;
      return;
    }
    if (!response.headers.get('content-type').startsWith('text/vnd.turbo-stream.html') || response.status >= 300) {
      if (window.console) {
        console.error(`There was an error processing the Turbo stream response from "${url}"`);
      }
      return;
    }
    const html = await response.text();
    Turbo.renderStreamMessage(html);
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/tinymce-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/tinymce-controller.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  connect() {
    if (!this.element.tinymceConfig) {
      if (window.console) {
        console.error('No TinyMCE config was attached to the DOM element, expected an expando property called "tinymceConfig".', this.element);
      }
      return;
    }
    const config = this.element.tinymceConfig;
    config.target = this.element;
    tinymce?.init(config).then(editors => {
      this.editorId = editors[0]?.id;

      // Fire a custom event when the editor finished initializing.
      this.dispatch('editor-loaded', {
        detail: {
          content: editors[0] ?? null
        }
      });
    });
  }
  disconnect() {
    tinymce?.get(this.editorId)?.remove();
  }
  beforeCache() {
    // Destroy TinyMCE before Turbo caches the page. It will be recreated
    // when the connect() call happens on the restored page.
    this.disconnect();

    // Remove the controller attribute. They will be re-added in the init
    // script of the be_tinyMCE.html5 template.
    this.element.removeAttribute('data-controller');
  }
  leave(event) {
    const editor = tinymce?.get(this.editorId);
    if (!editor || !editor.plugins.hasOwnProperty('autosave') || editor.isNotDirty) {
      return;
    }

    // Trigger a beforeunload event like when navigating away to capture the TinyMCE autosave message
    const delegate = document.createEvent('BeforeUnloadEvent');
    delegate.initEvent('beforeunload', false, true);
    if (!window.dispatchEvent(delegate) && !confirm(delegate.returnValue)) {
      event.preventDefault();
    }
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-fieldset-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-fieldset-controller.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    id: String,
    table: String
  }))();
  static classes = ['collapsed'];
  static afterLoad(identifier, application) {
    const addController = (el, id, table) => {
      const fs = el.parentNode;
      fs.dataset.controller = `${fs.dataset.controller || ''} ${identifier}`;
      fs.setAttribute(`data-${identifier}-id-value`, id);
      fs.setAttribute(`data-${identifier}-table-value`, table);
      fs.setAttribute(`data-${identifier}-collapsed-class`, 'collapsed');
      el.setAttribute('tabindex', 0);
      el.setAttribute('data-action', `click->${identifier}#toggle keydown.enter->${identifier}#toggle keydown.space->${identifier}#prevent:prevent keyup.space->${identifier}#toggle:prevent`);
    };
    const migrateLegacy = () => {
      document.querySelectorAll('legend[data-toggle-fieldset]').forEach(function (el) {
        if (window.console) {
          console.warn(`Using the "data-toggle-fieldset" attribute on fieldset legends is deprecated and will be removed in Contao 6. Apply the "${identifier}" Stimulus controller instead.`);
        }
        const {
          id,
          table
        } = JSON.parse(el.getAttribute('data-toggle-fieldset'));
        addController(el, id, table);
      });
      AjaxRequest.toggleFieldset = (el, id, table) => {
        const fs = el.parentNode;

        // Already clicked, Stimulus controller was added dynamically
        if (application.getControllerForElementAndIdentifier(fs, identifier)) {
          return;
        }
        if (window.console) {
          console.warn('Using AjaxRequest.toggleFieldset() is deprecated and will be removed in Contao 6. Apply the Stimulus actions instead.');
        }
        addController(el, id, table);

        // Optimistically wait until Stimulus has registered the new controller
        setTimeout(() => {
          application.getControllerForElementAndIdentifier(fs, identifier).toggle();
        }, 100);
      };
    };

    // Called as soon as registered, so DOM may not have been loaded yet
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", migrateLegacy);
    } else {
      migrateLegacy();
    }
  }
  connect() {
    if (this.element.querySelectorAll('label.error, label.mandatory').length) {
      this.element.classList.remove(this.collapsedClass);
    } else if (this.element.classList.contains('hide')) {
      if (window.console) {
        console.warn(`Using class "hide" on a fieldset is deprecated and will be removed in Contao 6. Use class "${this.collapsedClass}" instead.`);
      }
      this.element.classList.add(this.collapsedClass);
    }
    if (this.element.classList.contains(this.collapsedClass)) {
      this.setAriaExpanded(false);
    } else {
      this.setAriaExpanded(true);
    }
  }
  toggle() {
    if (this.element.classList.contains(this.collapsedClass)) {
      this.open();
      this.setAriaExpanded(true);
    } else {
      this.close();
      this.setAriaExpanded(false);
    }
  }
  open() {
    if (!this.element.classList.contains(this.collapsedClass)) {
      return;
    }
    this.element.classList.remove(this.collapsedClass);
    this.storeState(1);
  }
  close() {
    if (this.element.classList.contains(this.collapsedClass)) {
      return;
    }
    const form = this.element.closest('form');
    const input = this.element.querySelectorAll('[required]');
    let collapse = true;
    for (let i = 0; i < input.length; i++) {
      if (!input[i].value) {
        collapse = false;
        break;
      }
    }
    if (!collapse) {
      if (typeof form.checkValidity == 'function') {
        form.querySelector('button[type="submit"]').click();
      }
    } else {
      this.element.classList.add(this.collapsedClass);
      this.storeState(0);
    }
  }
  storeState(state) {
    if (!this.hasIdValue || !this.hasTableValue) {
      return;
    }
    fetch(window.location.href, {
      method: 'POST',
      headers: {
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        action: 'toggleFieldset',
        id: this.idValue,
        table: this.tableValue,
        state: state
      })
    });
  }
  setAriaExpanded(state) {
    const button = this.element.querySelector('button');
    if (button) {
      button.ariaExpanded = state;
    }
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-navigation-controller.js":
/*!************************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-navigation-controller.js ***!
  \************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static classes = ['collapsed'];
  static values = (() => ({
    url: String,
    requestToken: String,
    expandTitle: String,
    collapseTitle: String
  }))();
  toggle(_ref) {
    let {
      currentTarget,
      params: {
        category
      }
    } = _ref;
    const el = currentTarget.parentNode;
    const collapsed = el.classList.toggle(this.collapsedClass);
    currentTarget.setAttribute('aria-expanded', collapsed ? 'false' : 'true');
    currentTarget.setAttribute('title', collapsed ? this.expandTitleValue : this.collapseTitleValue);
    this.sendRequest(category, collapsed);
  }
  sendRequest(category, collapsed) {
    fetch(this.urlValue, {
      method: 'POST',
      headers: {
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        action: 'toggleNavigation',
        id: category,
        state: collapsed ? 0 : 1,
        REQUEST_TOKEN: this.requestTokenValue
      })
    });
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-nodes-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-nodes-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    mode: {
      type: Number,
      default: 5
    },
    toggleAction: String,
    loadAction: String,
    requestToken: String,
    refererId: String,
    expand: String,
    collapse: String,
    expandAll: String,
    expandAllTitle: String,
    collapseAll: String,
    collapseAllTitle: String
  }))();
  static targets = ['operation', 'node', 'toggle', 'child', 'rootChild'];
  operationTargetConnected() {
    this.updateOperation();
  }
  childTargetConnected() {
    this.updateOperation();
  }
  toggle(event) {
    const el = event.currentTarget;
    this.toggleToggler(el, event.params.id, event.params.level, event.params.folder);
  }
  toggleToggler(el, id, level, folder) {
    const item = document.id(id);
    if (item && item.style.display === 'none') {
      this.showChild(item);
      this.expandToggler(el);
      this.updateState(el, id, 1);
    } else if (item) {
      this.hideChild(item);
      this.collapseToggler(el);
      this.updateState(el, id, 0);
    } else {
      this.fetchChild(el, id, level, folder);
    }
    this.updateOperation();
  }
  expandToggler(el) {
    el.classList.add('foldable--open');
    if (el.hasAttribute('title')) {
      el.title = this.collapseValue;
    }
    el.getElements('img')?.forEach(image => {
      image.alt = this.collapseValue;
    });
  }
  collapseToggler(el) {
    el.classList.remove('foldable--open');
    if (el.hasAttribute('title')) {
      el.title = this.expandValue;
    }
    el.getElements('img')?.forEach(image => {
      image.alt = this.expandValue;
    });
  }
  loadToggler(el, enabled) {
    el.classList[enabled ? 'add' : 'remove']('foldable--loading');
  }
  showChild(item) {
    item.style.display = '';
  }
  hideChild(item) {
    item.style.display = 'none';
  }
  async fetchChild(el, id, level, folder) {
    this.loadToggler(el, true);
    const url = new URL(location.href);
    const search = url.searchParams;
    search.set('ref', this.refererIdValue);
    url.search = search.toString();
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        'action': this.loadActionValue,
        'id': id,
        'level': level,
        'folder': folder,
        'state': 1,
        'REQUEST_TOKEN': this.requestTokenValue
      })
    });
    if (response.ok) {
      const txt = await response.text();
      const li = document.createElement('li');
      li.id = id;
      li.classList.add('parent');
      li.style.display = 'inline';
      li.setAttribute(`data-${this.identifier}-target`, level === 0 ? 'child rootChild' : 'child');
      const ul = document.createElement('ul');
      ul.classList.add('level_' + level);
      ul.innerHTML = txt;
      li.append(ul);
      if (this.modeValue === 5) {
        el.closest('li').after(li);
      } else {
        let isFolder = false,
          parent = el.closest('li'),
          next;
        while (typeOf(parent) === 'element' && parent.tagName === 'LI' && (next = parent.nextElementSibling)) {
          parent = next;
          if (parent.classList.contains('tl_folder')) {
            isFolder = true;
            break;
          }
        }
        if (isFolder) {
          parent.before(li);
        } else {
          parent.after(li);
        }
      }
      window.dispatchEvent(new CustomEvent('structure'));
      this.expandToggler(el);

      // HOOK (see #6752)
      window.fireEvent('ajax_change');
    }
    this.loadToggler(el, false);
  }
  async toggleAll(event) {
    const href = event.currentTarget.href;
    if (this.hasExpandedRoot() ^ (event ? event.altKey : false)) {
      this.updateAllState(href, 0);
      this.toggleTargets.forEach(el => this.collapseToggler(el));
      this.childTargets.forEach(item => item.style.display = 'none');
    } else {
      this.childTargets.forEach(el => el.remove());
      this.toggleTargets.forEach(el => this.loadToggler(el, true));
      await this.updateAllState(href, 1);
      const promises = [];
      this.toggleTargets.forEach(el => {
        promises.push(this.fetchChild(el, el.getAttribute(`data-${this.identifier}-id-param`), 0, el.getAttribute(`data-${this.identifier}-folder-param`)));
      });
      await Promise.all(promises);
    }
    this.updateOperation();
  }
  keypress(event) {
    this.updateOperation(event);
  }
  async updateState(el, id, state) {
    await fetch(location.href, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        'action': this.toggleActionValue,
        'id': id,
        'state': state,
        'REQUEST_TOKEN': this.requestTokenValue
      })
    });
  }
  async updateAllState(href, state) {
    await fetch(`${href}&state=${state}`);
  }
  updateOperation(event) {
    if (!this.hasOperationTarget) {
      return;
    }
    if (this.hasExpandedRoot() ^ (event ? event.altKey : false)) {
      this.operationTarget.innerText = this.collapseAllValue;
      this.operationTarget.title = this.collapseAllTitleValue;
    } else {
      this.operationTarget.innerText = this.expandAllValue;
      this.operationTarget.title = this.expandAllTitleValue;
    }
  }
  hasExpandedRoot() {
    return !!this.rootChildTargets.find(el => el.style.display !== 'none');
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/tooltips-controller.js":
/*!***************************************************************!*\
  !*** ./core-bundle/assets/controllers/tooltips-controller.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ TooltipsController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class TooltipsController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static defaultOptionsMap = (() => ({
    'a img[alt]': {
      x: -9,
      y: 30
    },
    '.sgallery img[alt]': {
      x: 0,
      y: 75
    },
    'p.tl_tip': {
      x: 0,
      y: 23,
      useContent: true
    },
    '#home[title]': {
      x: 6,
      y: 42
    },
    '#tmenu a[title]': {
      x: 0,
      y: 42
    },
    'a[title][class^="group-"]': {
      x: -6,
      y: 27
    },
    'a[title].navigation': {
      x: 25,
      y: 32
    },
    'img[title].gimage': {
      x: -9,
      y: 60
    },
    'img[title]:not(.gimage)': {
      x: -9,
      y: 30
    },
    'a[title].picker-wizard': {
      x: -4,
      y: 30
    },
    'button img[alt]': {
      x: -9,
      y: 30
    },
    '.tl_panel button[title]': {
      x: 0,
      y: 36
    },
    'button[title].unselectable': {
      x: -4,
      y: 20
    },
    'button[title]:not(.unselectable)': {
      x: -9,
      y: 30
    },
    'a[title]:not(.picker-wizard)': {
      x: -9,
      y: 30
    },
    'input[title]': {
      x: -9,
      y: 30
    },
    'time[title]': {
      x: -9,
      y: 26
    },
    'span[title]': {
      x: -9,
      y: 26
    }
  }))();
  activeTargets = (() => new Set())();
  removeClickTargetHandlerDelegates = (() => new Map())();

  /**
   * There is one controller handling multiple tooltip targets. The tooltip
   * DOM element is shared across targets.
   */
  connect() {
    this.tooltip = document.body.querySelector('body > div[role="tooltip"]') ?? this._createTipContainer();
  }
  disconnect() {
    this.tooltip.remove();
  }
  tooltipTargetConnected(el) {
    el.addEventListener('mouseenter', e => this._showTooltip(e.target, 1000));
    el.addEventListener('touchend', e => this._showTooltip(e.target));
    el.addEventListener('mouseleave', e => this._hideTooltip(e.target));

    // In case the tooltip target is inside a link or button, also close it
    // when a click happened
    const clickTarget = el.closest('button, a');
    if (clickTarget) {
      const handler = () => this._hideTooltip(el);
      clickTarget.addEventListener('click', handler);
      this.removeClickTargetHandlerDelegates.set(el, () => el.removeEventListener('click', handler));
    }
  }
  tooltipTargetDisconnected(el) {
    if (this.activeTargets.has(el)) {
      this._hideTooltip(el);
    }
    if (this.removeClickTargetHandlerDelegates.has(el)) {
      this.removeClickTargetHandlerDelegates.get(el)();
      this.removeClickTargetHandlerDelegates.delete(el);
    }
  }
  _createTipContainer() {
    const tooltip = document.createElement('div');
    tooltip.setAttribute('role', 'tooltip');
    tooltip.classList.add('tip');
    tooltip.style.position = 'absolute';
    tooltip.style.display = 'none';
    document.body.appendChild(tooltip);
    return tooltip;
  }
  touchStart = e => {
    [...this.activeTargets].filter(el => !el.contains(e.target)).forEach(this._hideTooltip.bind(this));
  };
  _showTooltip(el) {
    let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    const options = this._getOptionsForElement(el);
    let text;
    if (options.useContent) {
      text = el.innerHTML;
    } else if (el instanceof HTMLImageElement) {
      text = el.getAttribute('alt');
      text = text?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;');
    } else {
      text = el.getAttribute('title');
      el.setAttribute('data-original-title', text);
      el.removeAttribute('title');
      text = text?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;');
    }
    if (!text) {
      return;
    }
    clearTimeout(this.timer);
    this.tooltip.style.willChange = 'display,contents';
    this.timer = setTimeout(() => {
      this.activeTargets.add(el);
      const position = el.getBoundingClientRect();
      const rtl = getComputedStyle(el).direction === 'rtl';
      const clientWidth = document.documentElement.clientWidth;
      if (rtl && position.x < 200 || !rtl && position.x < clientWidth - 200) {
        this.tooltip.style.left = `${window.scrollX + position.left + options.x}px`;
        this.tooltip.style.right = 'auto';
        this.tooltip.classList.remove('tip--rtl');
      } else {
        this.tooltip.style.left = 'auto';
        this.tooltip.style.right = `${clientWidth - window.scrollX - position.right + options.x}px`;
        this.tooltip.classList.add('tip--rtl');
      }
      this.tooltip.innerHTML = `<div>${text}</div>`;
      this.tooltip.style.top = `${window.scrollY + position.top + options.y}px`;
      this.tooltip.style.display = 'block';
      this.tooltip.style.willChange = 'auto';
    }, delay);
  }
  _hideTooltip(el) {
    let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    if (el.hasAttribute('data-original-title')) {
      if (!el.hasAttribute('title')) {
        el.setAttribute('title', el.getAttribute('data-original-title'));
      }
      el.removeAttribute('data-original-title');
    }
    clearTimeout(this.timer);
    this.tooltip.style.willChange = 'auto';
    if (this.tooltip.style.display === 'block') {
      this.activeTargets.delete(el);
      this.tooltip.style.willChange = 'display';
      this.timer = setTimeout(() => {
        this.tooltip.style.display = 'none';
        this.tooltip.style.willChange = 'auto';
      }, delay);
    }
  }
  _getOptionsForElement(el) {
    for (const [criteria, defaultOptions] of Object.entries(TooltipsController.defaultOptionsMap)) {
      if (el.match(criteria)) {
        return defaultOptions;
      }
    }
    return {
      x: -9,
      y: 30
    };
  }

  /**
   * Migrate legacy targets to proper controller targets.
   */
  static afterLoad(identifier, application) {
    const targetSelectors = Object.keys(TooltipsController.defaultOptionsMap);
    const migrateTarget = el => {
      targetSelectors.forEach(target => {
        if (!el.hasAttribute(`data-${identifier}-target`) && el.match(target)) {
          el.setAttribute(`data-${identifier}-target`, 'tooltip');
        }
        el.querySelectorAll(target).forEach(sel => {
          if (!sel.hasAttribute(`data-${identifier}-target`)) {
            sel.setAttribute(`data-${identifier}-target`, 'tooltip');
          }
        });
      });
    };
    new MutationObserver(function (mutationsList) {
      for (const mutation of mutationsList) {
        if (mutation.type !== 'childList') {
          continue;
        }
        for (let node of mutation.addedNodes) {
          if (!(node instanceof HTMLElement)) {
            continue;
          }
          migrateTarget(node);
        }
      }
    }).observe(document, {
      childList: true,
      subtree: true
    });

    // Initially migrate all targets that are already in the DOM
    document.querySelectorAll(targetSelectors.join(',')).forEach(el => migrateTarget(el));
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/webauthn-error-controller.js":
/*!*********************************************************************!*\
  !*** ./core-bundle/assets/controllers/webauthn-error-controller.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['message'];
  static values = (() => ({
    unsupportedMessage: String,
    assertionFailureMessage: String,
    attestationFailureMessage: String,
    optionsFailureMessage: String,
    csrfUrl: String
  }))();
  handleUnsupported() {
    this.messageTarget.innerHTML = this.renderMessage(this.unsupportedMessageValue);
  }
  handleAssertionFailure(e) {
    this.messageTarget.innerHTML = this.renderMessage(this.assertionFailureMessageValue);
  }
  handleAttestationFailure() {
    this.messageTarget.innerHTML = this.renderMessage(this.attestationFailureMessageValue);
  }
  handleOptionsFailure() {
    this.messageTarget.innerHTML = this.renderMessage(this.optionsFailureMessageValue);
  }
  loadCsrf() {
    if (this.csrfScript || !this.csrfUrlValue) {
      return;
    }

    // Make sure we always have the correct request token and cookie
    this.csrfScript = document.createElement('script');
    this.csrfScript.src = this.csrfUrlValue;
    this.csrfScript.async = true;
    document.body.append(this.csrfScript);
  }
  renderMessage(message, type) {
    type = type ?? 'error';
    return `<p class="tl_${type}">${message}</p>`;
  }
});

/***/ }),

/***/ "./core-bundle/assets/modules/twig-editor.js":
/*!***************************************************!*\
  !*** ./core-bundle/assets/modules/twig-editor.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TwigEditor: function() { return /* binding */ TwigEditor; }
/* harmony export */ });
class TwigEditor {
  constructor(element) {
    this.containerBackup = element.cloneNode();
    this.name = element.dataset.name;
    this.resourceUrl = element.dataset.resourceUrl;
    this.editor = ace.edit(element, {
      mode: 'ace/mode/twig',
      maxLines: 100,
      wrap: true,
      useSoftTabs: false,
      autoScrollEditorIntoView: true,
      readOnly: element.hasAttribute('readonly'),
      enableLiveAutocompletion: true,
      enableKeyboardAccessibility: true
    });
    this.setColorScheme(document.documentElement.dataset.colorScheme);
    this.editor.container.style.lineHeight = '1.45';
    const whitespace = ace.require('ace/ext/whitespace');
    whitespace.detectIndentation(this.editor.getSession());

    // Register commands
    this.editor.commands.addCommand({
      name: 'lens:block-info',
      readOnly: true,
      exec: (editor, args) => {
        editor.container.dispatchEvent(new CustomEvent('twig-editor:lens:block-info', {
          bubbles: true,
          detail: {
            name: this.name,
            block: args[0]
          }
        }));
      }
    });
    this.editor.commands.addCommand({
      name: 'lens:follow',
      readOnly: true,
      exec: (editor, args) => {
        editor.container.dispatchEvent(new CustomEvent('twig-editor:lens:follow', {
          bubbles: true,
          detail: {
            name: args[0]
          }
        }));
      }
    });

    // Setup code lenses
    this.editor.getSession().once('tokenizerUpdate', () => {
      this.registerCodeLensProvider();
    });
  }
  registerCodeLensProvider() {
    const codeLens = ace.require('ace/ext/code_lens');
    codeLens.registerCodeLensProvider(this.editor, {
      provideCodeLenses: (session, callback) => {
        if (session.destroyed) {
          return;
        }
        let payload = [];
        this.analyzeReferences().forEach(reference => {
          payload.push({
            start: {
              row: reference.row,
              column: reference.column
            },
            command: {
              id: 'lens:follow',
              title: reference.name,
              arguments: [reference.name]
            }
          });
        });
        this.analyzeBlocks().forEach(block => {
          payload.push({
            start: {
              row: block.row,
              column: block.column
            },
            command: {
              id: 'lens:block-info',
              title: `Block "${block.name}"`,
              arguments: [block.name]
            }
          });
        });
        callback(null, payload);
      }
    });
  }
  analyzeReferences() {
    let references = [];
    for (let row = 0; row < this.editor.getSession().getLength(); row++) {
      const tokens = this.editor.getSession().getTokens(row);
      for (let i = 0; i < tokens.length; i++) {
        if (tokens[i].type === 'meta.tag.twig' && /^{%-?$/.test(tokens[i].value) && tokens[i + 2]?.type === 'keyword.control.twig' && ['extends', 'use'].includes(tokens[i + 2].value) && tokens[i + 4]?.type === 'string') {
          const name = tokens[i + 4].value.replace(/["']/g, '');
          if (/^@Contao(_.+)?\//.test(name)) {
            references.push({
              name,
              row,
              column: tokens[i].start
            });
          }
        }
      }
    }
    return references;
  }
  analyzeBlocks() {
    let blocks = [];
    for (let row = 0; row < this.editor.getSession().getLength(); row++) {
      const tokens = this.editor.getSession().getTokens(row);
      for (let i = 0; i < tokens.length; i++) {
        if (tokens[i].type === 'meta.tag.twig' && /^{%-?$/.test(tokens[i].value) && tokens[i + 2]?.type === 'keyword.control.twig' && tokens[i + 2].value === 'block' && tokens[i + 4]?.type === 'identifier') {
          blocks.push({
            name: tokens[i + 4].value,
            row,
            column: tokens[i].start
          });
        }
      }
    }
    return blocks;
  }
  setAnnotationsData(data) {
    this.editor.completers = [{
      getCompletions: function (editor, session, pos, prefix, callback) {
        callback(null, data.autocomplete);
      }
    }];
    if ('error' in data) {
      this.editor.getSession().setAnnotations([{
        row: data.error.line - 1,
        type: data.error.type || 'error',
        text: ` ${data.error.message}`
      }]);
    }
  }
  setColorScheme(mode) {
    this.editor.setTheme(mode === 'dark' ? 'ace/theme/twilight' : 'ace/theme/clouds');
  }
  isEditable() {
    return !this.editor.getReadOnly();
  }
  getContent() {
    return this.editor.getValue();
  }
  focus() {
    this.editor.focus();
  }
  destroy() {
    // Destroying the ACE instance does not fully reset the HTML, so we
    // manually restore the container by using the cloned backup with
    // updated content.
    this.containerBackup.textContent = this.getContent();
    this.editor.container.replaceWith(this.containerBackup);
    this.editor.destroy();
  }
}

/***/ }),

/***/ "./core-bundle/assets/scripts/core.js":
/*!********************************************!*\
  !*** ./core-bundle/assets/scripts/core.js ***!
  \********************************************/
/***/ (function() {

/**
 * Provide methods to handle Ajax requests.
 *
 * @author Leo Feyer <https://github.com/leofeyer>
 */
window.AjaxRequest = {
  /**
   * Toggle the navigation menu
   *
   * @param {object} el  The DOM element
   * @param {string} id  The ID of the menu item
   * @param {string} url The Ajax URL
   *
   * @returns {boolean}
   */
  toggleNavigation: function (el, id, url) {
    if (window.console) {
      console.warn('AjaxRequest.toggleNavigation() is deprecated. Please use the stimulus controller instead.');
    }
    var item = $(id),
      parent = $(el).getParent('li');
    if (item) {
      if (parent.hasClass('collapsed')) {
        parent.removeClass('collapsed');
        $(el).setAttribute('aria-expanded', 'true');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          url: url
        }).post({
          'action': 'toggleNavigation',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        parent.addClass('collapsed');
        $(el).setAttribute('aria-expanded', 'false');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          url: url
        }).post({
          'action': 'toggleNavigation',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    return false;
  },
  /**
   * Toggle the page tree
   *
   * @param {object} el    The DOM element
   * @param {string} id    The ID of the target element
   * @param {int}    level The indentation level
   * @param {int}    mode  The insert mode
   *
   * @returns {boolean}
   */
  toggleStructure: function (el, id, level, mode) {
    if (window.console) {
      console.warn('AjaxRequest.toggleStructure() is deprecated. Please use the stimulus controller instead.');
    }
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleStructure',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleStructure',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    new Request.Contao({
      field: el,
      evalScripts: true,
      onRequest: function () {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function (txt) {
        var li = new Element('li', {
          'id': id,
          'class': 'parent',
          'styles': {
            'display': 'inline'
          }
        });
        new Element('ul', {
          'class': 'level_' + level,
          'html': txt
        }).inject(li, 'bottom');
        if (mode == 5) {
          li.inject($(el).getParent('li'), 'after');
        } else {
          var folder = false,
            parent = $(el).getParent('li'),
            next;
          while (typeOf(parent) == 'element' && (next = parent.getNext('li'))) {
            parent = next;
            if (parent.hasClass('tl_folder')) {
              folder = true;
              break;
            }
          }
          if (folder) {
            li.inject(parent, 'before');
          } else {
            li.inject(parent, 'after');
          }
        }

        // Update the referer ID
        li.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        window.fireEvent('structure');
        AjaxRequest.hideBox();

        // HOOK
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'loadStructure',
      'id': id,
      'level': level,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    return false;
  },
  /**
   * Toggle the file tree
   *
   * @param {object} el     The DOM element
   * @param {string} id     The ID of the target element
   * @param {string} folder The folder's path
   * @param {int}    level  The indentation level
   *
   * @returns {boolean}
   */
  toggleFileManager: function (el, id, folder, level) {
    if (window.console) {
      console.warn('AjaxRequest.toggleFileManager() is deprecated. Please use the stimulus controller instead.');
    }
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleFileManager',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleFileManager',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    new Request.Contao({
      field: el,
      evalScripts: true,
      onRequest: function () {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function (txt) {
        var li = new Element('li', {
          'id': id,
          'class': 'parent',
          'styles': {
            'display': 'inline'
          }
        });
        new Element('ul', {
          'class': 'level_' + level,
          'html': txt
        }).inject(li, 'bottom');
        li.inject($(el).getParent('li'), 'after');

        // Update the referer ID
        li.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        AjaxRequest.hideBox();

        // HOOK
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'loadFileManager',
      'id': id,
      'level': level,
      'folder': folder,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    return false;
  },
  /**
   * Toggle sub-palettes in edit mode
   *
   * @param {object} el    The DOM element
   * @param {string} id    The ID of the target element
   * @param {string} field The field name
   */
  toggleSubpalette: function (el, id, field) {
    var item = $(id);
    if (item) {
      if (!el.value) {
        el.value = 1;
        el.checked = 'checked';
        item.setStyle('display', null);
        item.getElements('[data-required]').each(function (el) {
          el.set('required', '').set('data-required', null);
        });
        new Request.Contao({
          field: el,
          onSuccess: updateVersionNumber
        }).post({
          'action': 'toggleSubpalette',
          'id': id,
          'field': field,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        el.value = '';
        el.checked = '';
        item.setStyle('display', 'none');
        item.getElements('[required]').each(function (el) {
          el.set('required', null).set('data-required', '');
        });
        new Request.Contao({
          field: el,
          onSuccess: updateVersionNumber
        }).post({
          'action': 'toggleSubpalette',
          'id': id,
          'field': field,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return;
    }
    new Request.Contao({
      field: el,
      evalScripts: false,
      onRequest: function () {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function (txt, json) {
        var div = new Element('div', {
          'id': id,
          'class': 'subpal widget-group',
          'html': txt
        }).inject($(el).getParent('div').getParent('div'), 'after');

        // Execute scripts after the DOM has been updated
        if (json.javascript) {
          // Use Asset.javascript() instead of document.write() to load a
          // JavaScript file and re-execute the code after it has been loaded
          document.write = function (str) {
            var src = '';
            str.replace(/<script src="([^"]+)"/i, function (all, match) {
              src = match;
            });
            src && Asset.javascript(src, {
              onLoad: function () {
                Browser.exec(json.javascript);
              }
            });
          };
          Browser.exec(json.javascript);
        }
        el.value = 1;
        el.checked = 'checked';

        // Update the referer ID
        div.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        updateVersionNumber(txt);
        AjaxRequest.hideBox();
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'toggleSubpalette',
      'id': id,
      'field': field,
      'load': 1,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    function updateVersionNumber(html) {
      var fields = el.form.elements.VERSION_NUMBER || [];
      if (!fields.forEach) {
        fields = [fields];
      }
      fields.forEach(function (field) {
        field.value = /<input\s+[^>]*?name="VERSION_NUMBER"\s+[^>]*?value="([^"]*)"/i.exec(html)[1];
      });
    }
  },
  /**
   * Toggle the state of a checkbox field
   *
   * @param {object}  el       The DOM element
   * @param {boolean} rowIcon  Whether the row icon should be toggled as well
   * @param {boolean} iconOnly If only the icon should be toggled (without sending a request)
   *
   * @returns {boolean}
   */
  toggleField: function (el, rowIcon) {
    let iconOnly = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var img = null,
      images = $(el).getElements('img'),
      published = images[0].get('data-state') == 1,
      div,
      next,
      pa,
      title;
    if (rowIcon && !iconOnly) {
      // Find the icon depending on the view (tree view, list view, parent view)
      if (div = el.closest('.tl_right')) {
        img = div.getPrevious('div').getElements('img');
      } else if ((div = el.closest('.tl_content_right')) && (next = div.getNext('div'))) {
        if (next.hasClass('cte_type')) {
          img = next;
        }
        if (img === null) {
          // newsletter recipients
          img = next.getFirst('div.list_icon');
        }
      } else if (el.closest('.tl_listing_container') && el.getParent('tr')) {
        img = el.getParent('td').getPrevious('td').getFirst('div.list_icon');
        if (img === null) {
          // comments
          img = el.getParent('td').getPrevious('td').getElement('div.cte_type');
        }
        if (img === null) {
          // showColumns
          img = el.getParent('tr').getFirst('td').getElement('div.list_icon_new');
        }
      }

      // Change the row icon
      if (img !== null) {
        // Tree view
        if (!(img instanceof HTMLElement) && img.forEach) {
          img.forEach(img => {
            if (img instanceof HTMLImageElement) {
              if (!img.getParent('ul.tl_listing').hasClass('tl_tree_xtnd')) {
                pa = img.getParent('a');
                if (pa && pa.href.indexOf('contao/preview') == -1) {
                  if (next = pa.getNext('a')) {
                    img = next.getElement('img');
                  } else {
                    img = new Element('img'); // no icons used (see #2286)
                  }
                }
              }
              const newSrc = !published ? img.get('data-icon') : img.get('data-icon-disabled');
              img.src = img.src.includes('/') && !newSrc.includes('/') ? img.src.slice(0, img.src.lastIndexOf('/') + 1) + newSrc : newSrc;
            }
          });
        }
        // Parent view
        else if (img.hasClass('cte_type')) {
          if (!published) {
            img.addClass('published');
            img.removeClass('unpublished');
          } else {
            img.addClass('unpublished');
            img.removeClass('published');
          }
        }
        // List view
        else {
          img.setStyle('background-image', 'url(' + (!published ? img.get('data-icon') : img.get('data-icon-disabled')) + ')');
        }
      }
    }

    // Send request
    images.forEach(function (image) {
      const newSrc = !published ? image.get('data-icon') : image.get('data-icon-disabled');
      image.src = image.src.includes('/') && !newSrc.includes('/') ? image.src.slice(0, image.src.lastIndexOf('/') + 1) + newSrc : newSrc;
      image.alt = title = !published ? image.get('data-alt') : image.get('data-alt-disabled');
      image.set('data-state', !published ? 1 : 0);
    });
    if (!published && $(el).get('data-title')) {
      el.title = title = $(el).get('data-title');
    } else if (published && $(el).get('data-title-disabled')) {
      el.title = title = $(el).get('data-title-disabled');
    }
    if (title) {
      el.childNodes.forEach(child => {
        if (child instanceof Text && child.nodeValue.trim()) {
          child.replaceWith(new Text(title));
        }
      });
    }
    if (!iconOnly) {
      document.body.querySelectorAll(`a[href="${el.getAttribute('href')}"]`).forEach(clone => {
        if (el !== clone) {
          AjaxRequest.toggleField(clone, rowIcon, true);
        }
      });
      new Request.Contao({
        'url': el.href,
        'followRedirects': false
      }).get();
    }

    // Return false to stop the click event on link
    return false;
  },
  /**
   * Toggle a group of a multi-checkbox field
   *
   * @param {object} el The DOM element
   * @param {string} id The ID of the target element
   *
   * @returns {boolean}
   */
  toggleCheckboxGroup: function (el, id) {
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        new Request.Contao().post({
          'action': 'toggleCheckboxGroup',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        new Request.Contao().post({
          'action': 'toggleCheckboxGroup',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return true;
    }
    return false;
  },
  /**
   * Display the "loading data" message
   *
   * @param {string} message The message text
   */
  displayBox: function (message) {
    var box = $('tl_ajaxBox'),
      overlay = $('tl_ajaxOverlay'),
      scroll = window.getScroll();
    if (overlay === null) {
      overlay = new Element('div', {
        'id': 'tl_ajaxOverlay'
      }).inject($(document.body), 'bottom');
    }
    overlay.set({
      'styles': {
        'display': 'block',
        'top': scroll.y + 'px'
      }
    });
    if (box === null) {
      box = new Element('div', {
        'id': 'tl_ajaxBox'
      }).inject($(document.body), 'bottom');
    }
    box.set({
      'html': message,
      'styles': {
        'display': 'block',
        'top': scroll.y + 100 + 'px'
      }
    });
  },
  /**
   * Hide the "loading data" message
   */
  hideBox: function () {
    var box = $('tl_ajaxBox'),
      overlay = $('tl_ajaxOverlay');
    if (overlay) {
      overlay.setStyle('display', 'none');
    }
    if (box) {
      box.setStyle('display', 'none');
    }
  }
};

/**
 * Provide methods to handle back end tasks.
 *
 * @author Leo Feyer <https://github.com/leofeyer>
 */
window.Backend = {
  /**
   * The current ID
   * @member {(string|null)}
   */
  currentId: null,
  /**
   * The popup window
   * @member {object}
   */
  popupWindow: null,
  /**
   * The theme path
   * @member {string}
   */
  themePath: Contao.script_url + 'system/themes/' + Contao.theme + '/',
  /**
   * Open a modal window
   *
   * @param {int}    width   The width in pixels
   * @param {string} title   The window's title
   * @param {string} content The window's content
   */
  openModalWindow: function (width, title, content) {
    new SimpleModal({
      'width': width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'overlayClick': false,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    }).show({
      'title': title,
      'contents': content
    });
  },
  /**
   * Open an image in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalImage: function (options) {
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt();
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    var M = new SimpleModal({
      'width': opt.width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.show({
      'title': opt.title?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<img src="' + opt.url + '" alt="">'
    });
  },
  /**
   * Open an iframe in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalIframe: function (options) {
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt(),
      maxHeight = (window.getSize().y - 137).toInt();
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    if (!opt.height || opt.height > maxHeight) opt.height = maxHeight;
    var M = new SimpleModal({
      'width': opt.width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'overlayClick': false,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.show({
      'title': opt.title?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<iframe src="' + opt.url + '" width="100%" height="' + opt.height + '" frameborder="0"></iframe>',
      'model': 'modal'
    });
  },
  /**
   * Open a selector page in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalSelector: function (options) {
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt(),
      maxHeight = (window.getSize().y - 192).toInt();
    if (!opt.id) opt.id = 'tl_select';
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    if (!opt.height || opt.height > maxHeight) opt.height = maxHeight;
    var M = new SimpleModal({
      'width': opt.width,
      'draggable': false,
      'overlayOpacity': .7,
      'overlayClick': false,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.addButton(Contao.lang.cancel, 'btn', function () {
      if (this.buttons[0].hasClass('btn-disabled')) {
        return;
      }
      this.hide();
    });
    M.addButton(Contao.lang.apply, 'btn primary', function () {
      if (this.buttons[1].hasClass('btn-disabled')) {
        return;
      }
      var frm = window.frames['simple-modal-iframe'],
        val = [],
        ul,
        inp,
        i,
        pickerValue,
        sIndex;
      if (frm === undefined) {
        alert('Could not find the SimpleModal frame');
        return;
      }
      ul = frm.document.getElementById(opt.id);
      // Load the previous values (#1816)
      if (pickerValue = ul.get('data-picker-value')) {
        val = JSON.parse(pickerValue);
      }
      inp = ul.getElementsByTagName('input');
      for (i = 0; i < inp.length; i++) {
        if (inp[i].id.match(/^(check_all_|reset_)/)) {
          continue;
        }
        // Add currently selected value, otherwise remove (#1816)
        sIndex = val.indexOf(inp[i].get('value'));
        if (inp[i].checked) {
          if (sIndex == -1) {
            val.push(inp[i].get('value'));
          }
        } else if (sIndex != -1) {
          val.splice(sIndex, 1);
        }
      }
      opt.callback(ul.get('data-table'), val);
      this.hide();
    });
    M.show({
      'title': opt.title?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<iframe src="' + opt.url + '" name="simple-modal-iframe" width="100%" height="' + opt.height + '" frameborder="0"></iframe>',
      'model': 'modal'
    });
  },
  /**
   * Open a TinyMCE file browser in a modal window
   *
   * @param {string} field_name The field name
   * @param {string} url        The URL
   * @param {string} type       The picker type
   * @param {object} win        The window object
   * @param {string} source     The source record
   */
  openModalBrowser: function (field_name, url, type, win, source) {
    Backend.openModalSelector({
      'id': 'tl_listing',
      'title': win.document.getElement('div.mce-title').get('text'),
      'url': Contao.routes.backend_picker + '?context=' + (type == 'file' ? 'link' : 'file') + '&amp;extras[fieldType]=radio&amp;extras[filesOnly]=true&amp;extras[source]=' + source + '&amp;value=' + url + '&amp;popup=1',
      'callback': function (table, value) {
        win.document.getElementById(field_name).value = value.join(',');
      }
    });
  },
  /**
   * Automatically submit a form
   *
   * @param {object} el The DOM element
   */
  autoSubmit: function (el) {
    window.dispatchEvent(new Event('store-scroll-offset'));
    var hidden = new Element('input', {
      'type': 'hidden',
      'name': 'SUBMIT_TYPE',
      'value': 'auto'
    });
    var form = $(el) || el;
    hidden.inject(form, 'bottom');
    form.submit();
  },
  /**
   * Scroll the window to a certain vertical position
   *
   * @param {int} offset The offset to scroll to
   */
  vScrollTo: function (offset) {
    if (window.console) {
      console.warn('Backend.vScrollTo() is deprecated. Please use the Stimulus controller instead.');
    }
    window.addEvent('load', function () {
      window.scrollTo(null, parseInt(offset));
    });
  },
  /**
   * Toggle checkboxes
   *
   * @param {object} el   The DOM element
   * @param {string} [id] The ID of the target element
   */
  toggleCheckboxes: function (el, id) {
    var items = $$('input'),
      status = $(el).checked ? 'checked' : '';
    for (var i = 0; i < items.length; i++) {
      if (items[i].type.toLowerCase() != 'checkbox') {
        continue;
      }
      if (id !== undefined && id != items[i].id.substr(0, id.length)) {
        continue;
      }
      items[i].checked = status;
    }
  },
  /**
   * Toggle a checkbox group
   *
   * @param {object} el The DOM element
   * @param {string} id The ID of the target element
   */
  toggleCheckboxGroup: function (el, id) {
    var cls = $(el).className,
      status = $(el).checked ? 'checked' : '';
    if (cls == 'tl_checkbox') {
      var cbx = $(id) ? $$('#' + id + ' .tl_checkbox') : $(el).getParent('fieldset').getElements('.tl_checkbox');
      cbx.each(function (checkbox) {
        checkbox.checked = status;
      });
    } else if (cls == 'tl_tree_checkbox') {
      $$('#' + id + ' .parent .tl_tree_checkbox').each(function (checkbox) {
        checkbox.checked = status;
      });
    }
    window.dispatchEvent(new Event('store-scroll-offset'));
  },
  /**
   * Toggle checkbox elements
   *
   * @param {string} el  The DOM element
   * @param {string} cls The CSS class name
   */
  toggleCheckboxElements: function (el, cls) {
    var status = $(el).checked ? 'checked' : '';
    $$('.' + cls).each(function (checkbox) {
      if (checkbox.hasClass('tl_checkbox')) {
        checkbox.checked = status;
      }
    });
    window.dispatchEvent(new Event('store-scroll-offset'));
  },
  /**
   * Make parent view items sortable
   *
   * @param {object} ul The DOM element
   *
   * @author Joe Ray Gregory
   * @author Martin Auswöger
   */
  makeParentViewSortable: function (ul) {
    var ds = new Scroller(document.getElement('body'), {
      onChange: function (x, y) {
        this.element.scrollTo(this.element.getScroll().x, y);
      }
    });
    var list = new Sortables(ul, {
      constrain: true,
      opacity: 0.6,
      onStart: function () {
        ds.start();
      },
      onComplete: function () {
        ds.stop();
      },
      onSort: function (el) {
        var ul = el.getParent('ul'),
          wrapLevel = 0,
          divs,
          i;
        if (!ul) return;
        divs = ul.getChildren('li > div:first-child');
        if (!divs) return;
        for (i = 0; i < divs.length; i++) {
          if (divs[i].hasClass('wrapper_stop') && wrapLevel > 0) {
            wrapLevel--;
          }
          divs[i].className = divs[i].className.replace(/(^|\s)indent[^\s]*/g, '');
          if (wrapLevel > 0) {
            divs[i].addClass('indent').addClass('indent_' + wrapLevel);
          }
          if (divs[i].hasClass('wrapper_start')) {
            wrapLevel++;
          }
          divs[i].removeClass('indent_first');
          divs[i].removeClass('indent_last');
          if (divs[i - 1] && divs[i - 1].hasClass('wrapper_start')) {
            divs[i].addClass('indent_first');
          }
          if (divs[i + 1] && divs[i + 1].hasClass('wrapper_stop')) {
            divs[i].addClass('indent_last');
          }
        }
      },
      handle: '.drag-handle'
    });
    list.active = false;
    list.addEvent('start', function () {
      list.active = true;
    });
    list.addEvent('complete', function (el) {
      if (!list.active) return;
      var id,
        pid,
        url = new URL(window.location.href);
      url.searchParams.set('rt', Contao.request_token);
      url.searchParams.set('act', 'cut');
      if (el.getPrevious('li')) {
        id = el.get('id').replace(/li_/, '');
        pid = el.getPrevious('li').get('id').replace(/li_/, '');
        url.searchParams.set('id', id);
        url.searchParams.set('pid', pid);
        url.searchParams.set('mode', 1);
        new Request.Contao({
          'url': url.toString(),
          'followRedirects': false
        }).get();
      } else if (el.getParent('ul')) {
        id = el.get('id').replace(/li_/, '');
        pid = el.getParent('ul').get('id').replace(/ul_/, '');
        url.searchParams.set('id', id);
        url.searchParams.set('pid', pid);
        url.searchParams.set('mode', 2);
        new Request.Contao({
          'url': url.toString(),
          'followRedirects': false
        }).get();
      }
    });
  },
  /**
   * Make multiSRC items sortable
   *
   * @param {string} id  The ID of the target element
   * @param {string} oid The order field
   * @param {string} val The value field
   */
  makeMultiSrcSortable: function (id, oid, val) {
    var list = new Sortables($(id), {
      constrain: true,
      opacity: 0.6
    }).addEvent('complete', function () {
      var els = [],
        lis = $(id).getChildren('[data-id]'),
        i;
      for (i = 0; i < lis.length; i++) {
        els.push(lis[i].get('data-id'));
      }
      if (oid === val) {
        $(val).value.split(',').forEach(function (j) {
          if (els.indexOf(j) === -1) {
            els.push(j);
          }
        });
      }
      $(oid).value = els.join(',');
    });
    $(id).getElements('.gimage').each(function (el) {
      if (el.hasClass('removable')) {
        new Element('button', {
          type: 'button',
          html: '&times;',
          'class': 'tl_red'
        }).addEvent('click', function () {
          var li = el.getParent('li'),
            did = li.get('data-id');
          $(val).value = $(val).value.split(',').filter(function (j) {
            return j != did;
          }).join(',');
          $(oid).value = $(oid).value.split(',').filter(function (j) {
            return j != did;
          }).join(',');
          li.dispose();
        }).inject(el, 'after');
      } else {
        new Element('button', {
          type: 'button',
          html: '&times',
          disabled: true
        }).inject(el, 'after');
      }
    });
    list.fireEvent("complete"); // Initial sorting
  },
  /**
   * Enable drag and drop for the file tree
   *
   * @param {object} ul      The DOM element
   * @param {object} options An optional options object
   */
  enableFileTreeDragAndDrop: function (ul, options) {
    var ds = new Scroller(document.getElement('body'), {
      onChange: function (x, y) {
        this.element.scrollTo(this.element.getScroll().x, y);
      }
    });
    ul.addEvent('mousedown', function (event) {
      var dragHandle = event.target.hasClass('drag-handle') ? event.target : event.target.getParent('.drag-handle');
      var dragElement = event.target.getParent('.tl_file,.tl_folder');
      if (!dragHandle || !dragElement || event.rightClick) {
        return;
      }
      ds.start();
      ul.addClass('tl_listing_dragging');
      var cloneBase = dragElement.getElements('.tl_left')[0] || dragElement,
        clone = cloneBase.clone(true).inject(ul).addClass('tl_left_dragging'),
        currentHover,
        currentHoverTime,
        expandLink;
      clone.setPosition({
        x: event.page.x - cloneBase.getOffsetParent().getPosition().x - clone.getSize().x,
        y: cloneBase.getPosition(cloneBase.getOffsetParent()).y
      }).setStyle('display', 'none');
      var move = new Drag.Move(clone, {
        droppables: $$([ul]).append(ul.getElements('.tl_folder,li.parent,.tl_folder_top')),
        unDraggableTags: [],
        modifiers: {
          x: 'left',
          y: 'top'
        },
        onStart: function () {
          clone.setStyle('display', '');
        },
        onEnter: function (element, droppable) {
          droppable = fixDroppable(droppable);
          droppable.addClass('tl_folder_dropping');
          if (droppable.hasClass('tl_folder') && currentHover !== droppable) {
            currentHover = droppable;
            currentHoverTime = new Date().getTime();
            expandLink = droppable.getElement('a.foldable');
            if (expandLink && !expandLink.hasClass('foldable--open')) {
              // Expand the folder after one second hover time
              setTimeout(function () {
                if (currentHover === droppable && currentHoverTime + 900 < new Date().getTime()) {
                  var event = document.createEvent('HTMLEvents');
                  event.initEvent('click', true, true);
                  expandLink.dispatchEvent(event);
                  currentHover = undefined;
                  currentHoverTime = undefined;
                  window.addEvent('ajax_change', function onAjax() {
                    if (move && move.droppables && ul && ul.getElements) {
                      move.droppables = $$([ul]).append(ul.getElements('.tl_folder,li.parent'));
                    }
                    window.removeEvent('ajax_change', onAjax);
                  });
                }
              }, 1000);
            }
          }
        },
        onCancel: function () {
          currentHover = undefined;
          currentHoverTime = undefined;
          ds.stop();
          clone.destroy();
          window.removeEvent('keyup', onKeyup);
          ul.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
          ul.removeClass('tl_listing_dragging');
        },
        onDrop: function (element, droppable) {
          currentHover = undefined;
          currentHoverTime = undefined;
          ds.stop();
          clone.destroy();
          window.removeEvent('keyup', onKeyup);
          ul.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
          ul.removeClass('tl_listing_dragging');
          droppable = fixDroppable(droppable);
          if (!droppable) {
            return;
          }
          var id = dragElement.get('data-id'),
            pid = droppable.get('data-id') || decodeURIComponent(options.url.split(/[?&]pid=/)[1].split('&')[0]);

          // Ignore invalid move operations
          if (id && pid && ((pid + '/').indexOf(id + '/') === 0 || pid + '/' === id.replace(/[^/]+$/, ''))) {
            return;
          }
          window.dispatchEvent(new Event('store-scroll-offset'));
          document.location.href = options.url + '&id=' + encodeURIComponent(id) + '&pid=' + encodeURIComponent(pid);
        },
        onLeave: function (element, droppable) {
          droppable = fixDroppable(droppable);
          droppable.removeClass('tl_folder_dropping');
          currentHover = undefined;
          currentHoverTime = undefined;
        }
      });
      move.start(event);
      window.addEvent('keyup', onKeyup);
      function onKeyup(event) {
        if (event.key === 'esc' && move && move.stop) {
          move.droppables = $$([]);
          move.stop();
        }
      }
    });
    function fixDroppable(droppable) {
      if (droppable && droppable.hasClass('parent') && droppable.getPrevious('.tl_folder')) {
        return droppable.getPrevious('.tl_folder');
      }
      return droppable;
    }
  },
  /**
   * List wizard
   *
   * @param {string} id The ID of the target element
   */
  listWizard: function (id) {
    var ul = $(id),
      makeSortable = function (ul) {
        new Sortables(ul, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle'
        });
      },
      addEventsTo = function (li) {
        var command, clone, input, previous, next;
        li.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                clone = li.clone(true).inject(li, 'before');
                if (input = li.getFirst('input')) {
                  clone.getFirst('input').value = input.value;
                }
                addEventsTo(clone);
                input.select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (ul.getChildren().length > 1) {
                  li.destroy();
                }
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (previous = li.getPrevious('li')) {
                    li.inject(previous, 'before');
                  } else {
                    li.inject(ul, 'bottom');
                  }
                  bt.focus();
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (next = li.getNext('li')) {
                    li.inject(next, 'after');
                  } else {
                    li.inject(ul.getFirst('li'), 'before');
                  }
                  bt.focus();
                }
              });
              break;
          }
        });
      };
    makeSortable(ul);
    ul.getChildren().each(function (li) {
      addEventsTo(li);
    });
  },
  /**
   * Table wizard
   *
   * @param {string} id The ID of the target element
   */
  tableWizard: function (id) {
    var table = $(id),
      thead = table.getElement('thead'),
      tbody = table.getElement('tbody'),
      makeSortable = function (tbody) {
        var rows = tbody.getChildren(),
          textarea,
          children,
          i,
          j;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (textarea = children[j].getFirst('textarea')) {
              textarea.name = textarea.name.replace(/\[[0-9]+][[0-9]+]/g, '[' + i + '][' + j + ']');
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function () {
            makeSortable(tbody);
          }
        });
      },
      addEventsTo = function (tr) {
        var head = thead.getFirst('tr'),
          command,
          textarea,
          current,
          next,
          ntr,
          children,
          index,
          i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'rcopy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (textarea = children[i].getFirst('textarea')) {
                    next.getFirst('textarea').value = textarea.value;
                  }
                }
                ntr.inject(tr, 'after');
                addEventsTo(ntr);
                makeSortable(tbody);
                ntr.getFirst('td').getFirst('textarea').select();
              });
              break;
            case 'rdelete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                makeSortable(tbody);
              });
              break;
            case 'ccopy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                for (i = 0; i < children.length; i++) {
                  current = children[i].getChildren()[index];
                  next = current.clone(true).inject(current, 'after');
                  if (textarea = current.getFirst('textarea')) {
                    next.getFirst('textarea').value = textarea.value;
                  }
                  addEventsTo(next);
                }
                var headFirst = head.getFirst('td');
                next = headFirst.clone(true).inject(head.getLast('td'), 'before');
                addEventsTo(next);
                makeSortable(tbody);
                children[0].getChildren()[index + 1].getFirst('textarea').select();
              });
              break;
            case 'cmovel':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (index > 0) {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(current.getPrevious(), 'before');
                  }
                } else {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(children[i].getLast(), 'before');
                  }
                }
                makeSortable(tbody);
              });
              break;
            case 'cmover':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (index < tr.getChildren().length - 2) {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(current.getNext(), 'after');
                  }
                } else {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(children[i].getFirst(), 'before');
                  }
                }
                makeSortable(tbody);
              });
              break;
            case 'cdelete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (tr.getChildren().length > 2) {
                  for (i = 0; i < children.length; i++) {
                    children[i].getChildren()[index].destroy();
                  }
                  head.getFirst('td').destroy();
                }
                makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
              break;
          }
        });
      },
      getIndex = function (bt) {
        var td = $(bt).getParent('td'),
          tr = td.getParent('tr'),
          cols = tr.getChildren(),
          index = 0,
          i;
        for (i = 0; i < cols.length; i++) {
          if (cols[i] == td) {
            break;
          }
          index++;
        }
        return index;
      };
    makeSortable(tbody);
    thead.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
    tbody.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
    Backend.tableWizardResize();
  },
  /**
   * Resize the table wizard fields on focus
   *
   * @param {float} [factor] The resize factor
   */
  tableWizardResize: function (factor) {
    var size = window.localStorage.getItem('contao_table_wizard_cell_size');
    if (factor !== undefined) {
      size = '';
      $$('.tl_tablewizard textarea').each(function (el) {
        el.setStyle('width', (el.getStyle('width').toInt() * factor).round().limit(142, 284));
        el.setStyle('height', (el.getStyle('height').toInt() * factor).round().limit(66, 132));
        if (size == '') {
          size = el.getStyle('width') + '|' + el.getStyle('height');
        }
      });
      window.localStorage.setItem('contao_table_wizard_cell_size', size);
    } else if (size !== null) {
      var chunks = size.split('|');
      $$('.tl_tablewizard textarea').each(function (el) {
        el.setStyle('width', chunks[0]);
        el.setStyle('height', chunks[1]);
      });
    }
  },
  /**
   * Set the width of the table wizard
   */
  tableWizardSetWidth: function () {
    var wrap = $('tl_tablewizard');
    if (!wrap) return;
    wrap.setStyle('width', Math.round(wrap.getParent('.tl_formbody_edit').getComputedSize().width * 0.96));
  },
  /**
   * Options wizard
   *
   * @param {string} id The ID of the target element
   */
  optionsWizard: function (id) {
    var table = $(id),
      tbody = table.getElement('tbody'),
      makeSortable = function (tbody) {
        var rows = tbody.getChildren(),
          children,
          i,
          j,
          input;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (input = children[j].getFirst('input')) {
              input.name = input.name.replace(/\[[0-9]+]/g, '[' + i + ']');
              if (input.type == 'checkbox') {
                input.id = input.name.replace(/\[[0-9]+]/g, '').replace(/\[/g, '_').replace(/]/g, '') + '_' + i;
                input.getNext('label').set('for', input.id);
              }
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function () {
            makeSortable(tbody);
          }
        });
      },
      addEventsTo = function (tr) {
        var command, input, next, ntr, children, i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (input = children[i].getFirst('input')) {
                    next.getFirst('input').value = input.value;
                    if (input.type == 'checkbox') {
                      next.getFirst('input').checked = input.checked ? 'checked' : '';
                    }
                  }
                }
                ntr.inject(tr, 'after');
                addEventsTo(ntr);
                makeSortable(tbody);
                ntr.getFirst('td').getFirst('input').select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
              break;
          }
        });
      };
    makeSortable(tbody);
    tbody.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
  },
  /**
   * Key/value wizard
   *
   * @param {string} id The ID of the target element
   */
  keyValueWizard: function (id) {
    var table = $(id),
      tbody = table.getElement('tbody'),
      makeSortable = function (tbody) {
        var rows = tbody.getChildren(),
          children,
          i,
          j,
          input;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (input = children[j].getFirst('input')) {
              input.name = input.name.replace(/\[[0-9]+]/g, '[' + i + ']');
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function () {
            makeSortable(tbody);
          }
        });
      },
      addEventsTo = function (tr) {
        var command, input, next, ntr, children, i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (input = children[i].getFirst('input')) {
                    next.getFirst().value = input.value;
                  }
                }
                ntr.inject(tr, 'after');
                addEventsTo(ntr);
                makeSortable(tbody);
                ntr.getFirst('td').getFirst('input').select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
              break;
          }
        });
      };
    makeSortable(tbody);
    tbody.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
  },
  /**
   * Checkbox wizard
   *
   * @param {string} id The ID of the target element
   */
  checkboxWizard: function (id) {
    var container = $(id).getElement('.sortable'),
      makeSortable = function (container) {
        new Sortables(container, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle'
        });
      },
      addEventsTo = function (span) {
        var nspan;
        span.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          bt.addEvent('keydown', function (e) {
            if (e.event.keyCode == 38) {
              e.preventDefault();
              if (nspan = span.getPrevious('span')) {
                span.inject(nspan, 'before');
              } else {
                span.inject(container, 'bottom');
              }
              bt.focus();
            } else if (e.event.keyCode == 40) {
              e.preventDefault();
              if (nspan = span.getNext('span')) {
                span.inject(nspan, 'after');
              } else {
                span.inject(container, 'top');
              }
              bt.focus();
            }
          });
        });
      };
    makeSortable(container);
    container.getChildren().each(function (span) {
      addEventsTo(span);
    });
  },
  /**
   * Update the fields of the imageSize widget upon change
   */
  enableImageSizeWidgets: function () {
    $$('.tl_image_size').each(function (el) {
      var select = el.getElement('select'),
        widthInput = el.getChildren('input')[0],
        heightInput = el.getChildren('input')[1],
        update = function () {
          if (select.get('value') === '' || select.get('value').indexOf('_') === 0 || select.get('value').toInt().toString() === select.get('value')) {
            widthInput.readOnly = true;
            heightInput.readOnly = true;
            var dimensions = $(select.getSelected()[0]).get('text');
            dimensions = dimensions.split('(').length > 1 ? dimensions.split('(').getLast().split(')')[0].split('x') : ['', ''];
            widthInput.set('value', '').set('placeholder', dimensions[0] * 1 || '');
            heightInput.set('value', '').set('placeholder', dimensions[1] * 1 || '');
          } else {
            widthInput.set('placeholder', '');
            heightInput.set('placeholder', '');
            widthInput.readOnly = false;
            heightInput.readOnly = false;
          }
        };
      update();
      select.addEvent('change', update);
      select.addEvent('keyup', update);
    });
  },
  /**
   * Allow toggling checkboxes or radio buttons by clicking a row
   *
   * @author Kamil Kuzminski
   */
  enableToggleSelect: function () {
    var container = $('tl_listing'),
      shiftToggle = function (el) {
        thisIndex = checkboxes.indexOf(el);
        startIndex = checkboxes.indexOf(start);
        from = Math.min(thisIndex, startIndex);
        to = Math.max(thisIndex, startIndex);
        status = !!checkboxes[startIndex].checked;
        for (from; from <= to; from++) {
          checkboxes[from].checked = status;
        }
      },
      clickEvent = function (e) {
        if (e.target instanceof HTMLImageElement || e.target instanceof HTMLAnchorElement || e.target instanceof HTMLButtonElement) {
          return;
        }
        var input = this.getElement('input[type="checkbox"],input[type="radio"]'),
          limitToggler = $(e.target).getParent('.limit_toggler');
        if (!input || input.get('disabled') || limitToggler !== null) {
          return;
        }

        // Radio buttons
        if (input.type == 'radio') {
          if (!input.checked) {
            input.checked = 'checked';
          }
          return;
        }

        // Checkboxes
        if (e.shift && start) {
          shiftToggle(input);
        } else {
          input.checked = input.checked ? '' : 'checked';
          if (input.get('onclick') == 'Backend.toggleCheckboxes(this)') {
            Backend.toggleCheckboxes(input); // see #6399
          }
        }
        start = input;
      },
      checkboxes = [],
      start,
      thisIndex,
      startIndex,
      status,
      from,
      to;
    if (container) {
      checkboxes = container.getElements('input[type="checkbox"]');
    }

    // Row click
    $$('.toggle_select').each(function (el) {
      var boundEvent = el.retrieve('boundEvent');
      if (boundEvent) {
        el.removeEvent('click', boundEvent);
      }

      // Do not propagate the form field click events
      el.getElements('label,input[type="checkbox"],input[type="radio"]').each(function (i) {
        i.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
      boundEvent = clickEvent.bind(el);
      el.addEvent('click', boundEvent);
      el.store('boundEvent', boundEvent);
    });

    // Checkbox click
    checkboxes.each(function (el) {
      el.addEvent('click', function (e) {
        if (e.shift && start) {
          shiftToggle(this);
        }
        start = this;
      });
    });
  },
  /**
   * Allow to mark the important part of an image
   *
   * @param {object} el The DOM element
   */
  editPreviewWizard: function (el) {
    el = $(el);
    var imageElement = el.getElement('img'),
      inputElements = {},
      isDrawing = false,
      partElement,
      startPos,
      getScale = function () {
        return {
          x: imageElement.getComputedSize().width,
          y: imageElement.getComputedSize().height
        };
      },
      updateImage = function () {
        var scale = getScale(),
          imageSize = imageElement.getComputedSize();
        partElement.setStyles({
          top: imageSize.computedTop + (inputElements.y.get('value') * scale.y).round() + 'px',
          left: imageSize.computedLeft + (inputElements.x.get('value') * scale.x).round() + 'px',
          width: (inputElements.width.get('value') * scale.x).round() + 'px',
          height: (inputElements.height.get('value') * scale.y).round() + 'px'
        });
        if (!inputElements.width.get('value').toFloat() || !inputElements.height.get('value').toFloat()) {
          partElement.setStyle('display', 'none');
        } else {
          partElement.setStyle('display', null);
        }
      },
      updateValues = function () {
        var scale = getScale(),
          styles = partElement.getStyles('top', 'left', 'width', 'height'),
          imageSize = imageElement.getComputedSize(),
          values = {
            x: Math.max(0, Math.min(1, (styles.left.toFloat() - imageSize.computedLeft) / scale.x)),
            y: Math.max(0, Math.min(1, (styles.top.toFloat() - imageSize.computedTop) / scale.y))
          };
        values.width = Math.min(1 - values.x, styles.width.toFloat() / scale.x);
        values.height = Math.min(1 - values.y, styles.height.toFloat() / scale.y);
        if (!values.width || !values.height) {
          values.x = values.y = values.width = values.height = '';
          partElement.setStyle('display', 'none');
        } else {
          partElement.setStyle('display', null);
        }
        Object.each(values, function (value, key) {
          inputElements[key].set('value', value === '' ? '' : Number(value).toFixed(15));
        });
      },
      start = function (event) {
        event.preventDefault();
        if (isDrawing) {
          return;
        }
        isDrawing = true;
        startPos = {
          x: event.page.x - el.getPosition().x - imageElement.getComputedSize().computedLeft,
          y: event.page.y - el.getPosition().y - imageElement.getComputedSize().computedTop
        };
        move(event);
      },
      move = function (event) {
        if (!isDrawing) {
          return;
        }
        event.preventDefault();
        var imageSize = imageElement.getComputedSize();
        var rect = {
          x: [Math.max(0, Math.min(imageSize.width, startPos.x)), Math.max(0, Math.min(imageSize.width, event.page.x - el.getPosition().x - imageSize.computedLeft))],
          y: [Math.max(0, Math.min(imageSize.height, startPos.y)), Math.max(0, Math.min(imageSize.height, event.page.y - el.getPosition().y - imageSize.computedTop))]
        };
        partElement.setStyles({
          top: Math.min(rect.y[0], rect.y[1]) + imageSize.computedTop + 'px',
          left: Math.min(rect.x[0], rect.x[1]) + imageSize.computedLeft + 'px',
          width: Math.abs(rect.x[0] - rect.x[1]) + 'px',
          height: Math.abs(rect.y[0] - rect.y[1]) + 'px'
        });
        updateValues();
      },
      stop = function (event) {
        move(event);
        isDrawing = false;
      },
      init = function () {
        el.getParent('.tl_tbox,.tl_box').getElements('input[name^="importantPart"]').each(function (input) {
          ['x', 'y', 'width', 'height'].each(function (key) {
            if (input.get('name').substr(13, key.length) === key.capitalize()) {
              inputElements[key] = input = $(input);
            }
          });
        });
        if (Object.getLength(inputElements) !== 4) {
          return;
        }
        Object.each(inputElements, function (input) {
          input.getParent().setStyle('display', 'none');
        });
        el.addClass('tl_edit_preview_enabled');
        partElement = new Element('div', {
          'class': 'tl_edit_preview_important_part'
        }).inject(el);
        updateImage();
        imageElement.addEvent('load', updateImage);
        el.addEvents({
          mousedown: start,
          touchstart: start
        });
        $(document.documentElement).addEvents({
          mousemove: move,
          touchmove: move,
          mouseup: stop,
          touchend: stop,
          touchcancel: stop,
          resize: updateImage
        });
      };
    window.addEvent('domready', init);
  },
  /**
   * Enable drag and drop file upload for the file tree
   *
   * @param {object} wrap    The DOM element
   * @param {object} options An optional options object
   */
  enableFileTreeUpload: function (wrap, options) {
    wrap = $(wrap);
    var fallbackUrl = options.url,
      dzElement = new Element('div', {
        'class': 'dropzone dropzone-filetree',
        html: '<span class="dropzone-previews"></span>'
      }).inject(wrap, 'top'),
      currentHover,
      currentHoverTime,
      expandLink;
    options.previewsContainer = dzElement.getElement('.dropzone-previews');
    options.clickable = false;
    var dz = new Dropzone(wrap, options);
    dz.on('queuecomplete', function () {
      window.location.reload();
    });
    dz.on('dragover', function (event) {
      if (!event.dataTransfer || !event.dataTransfer.types || event.dataTransfer.types.indexOf('Files') === -1) {
        return;
      }
      wrap.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
      var target = event.target && $(event.target);
      if (target) {
        var folder = target.match('.tl_folder') ? target : target.getParent('.tl_folder');
        if (!folder) {
          folder = target.getParent('.parent');
          folder = folder && folder.getPrevious('.tl_folder');
        }
        if (folder) {
          var link = folder.getElement('img[src$="/icons/new.svg"]');
          link = link && link.getParent('a');
        }
      }
      if (link && link.href) {
        dz.options.url = '' + link.href;
        folder.addClass('tl_folder_dropping');
        if (currentHover !== folder) {
          currentHover = folder;
          currentHoverTime = new Date().getTime();
          expandLink = folder.getElement('a.foldable');
          if (expandLink && !expandLink.hasClass('foldable--open')) {
            // Expand the folder after one second hover time
            setTimeout(function () {
              if (currentHover === folder && currentHoverTime + 900 < new Date().getTime()) {
                var event = document.createEvent('HTMLEvents');
                event.initEvent('click', true, true);
                expandLink.dispatchEvent(event);
                currentHover = undefined;
                currentHoverTime = undefined;
              }
            }, 1000);
          }
        }
      } else {
        dz.options.url = fallbackUrl;
        currentHover = undefined;
        currentHoverTime = undefined;
      }
    });
    dz.on('drop', function (event) {
      if (!event.dataTransfer || !event.dataTransfer.types || event.dataTransfer.types.indexOf('Files') === -1) {
        return;
      }
      dzElement.addClass('dropzone-filetree-enabled');
      window.dispatchEvent(new Event('store-scroll-offset'));
    });
    dz.on('dragleave', function () {
      wrap.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
      currentHover = undefined;
      currentHoverTime = undefined;
    });
  },
  /**
   * Crawl the website
   */
  crawl: function () {
    var timeout = 2000,
      crawl = $('tl_crawl'),
      progressBar = crawl.getElement('div.progress-bar'),
      progressCount = crawl.getElement('p.progress-count'),
      results = crawl.getElement('div.results'),
      debugLog = crawl.getElement('p.debug-log');
    function updateData(response) {
      var total = response.total,
        done = total - response.pending,
        percentage = total > 0 ? parseInt(done / total * 100, 10) : 100,
        result;

      // Initialize the status bar at 10%
      if (done < 1 && percentage < 1) {
        done = 1;
        percentage = 10;
        total = 10;
      }
      progressBar.setStyle('width', percentage + '%');
      progressBar.set('html', percentage + '%');
      progressBar.setAttribute('aria-valuenow', percentage);
      progressCount.set('html', done + ' / ' + total);
      if (response.hasDebugLog) {
        debugLog.setStyle('display', 'block');
      }
      if (response.hasDebugLog) {
        debugLog.setStyle('display', 'block');
      }
      if (!response.finished) {
        return;
      }
      progressBar.removeClass('running').addClass('finished');
      results.removeClass('running').addClass('finished');
      for (result in response.results) {
        if (response.results.hasOwnProperty(result)) {
          var summary = results.getElement('.result[data-subscriber="' + result + '"] p.summary'),
            warning = results.getElement('.result[data-subscriber="' + result + '"] p.warning'),
            log = results.getElement('.result[data-subscriber="' + result + '"] p.subscriber-log'),
            subscriberResults = response.results[result],
            subscriberSummary = subscriberResults.summary;
          if (subscriberResults.warning) {
            warning.set('html', subscriberResults.warning);
          }
          if (subscriberResults.hasLog) {
            log.setStyle('display', 'block');
          }
          summary.addClass(subscriberResults.wasSuccessful ? 'success' : 'failure');
          summary.set('html', subscriberSummary);
        }
      }
    }
    function execRequest() {
      let onlyStatusUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      new Request({
        url: window.location.href,
        headers: {
          'Only-Status-Update': onlyStatusUpdate
        },
        onSuccess: function (responseText) {
          var response = JSON.decode(responseText);
          updateData(response);
          if (!response.finished) {
            setTimeout(execRequest, timeout);
          }
        }
      }).send();
    }
    execRequest(true);
  }
};
window.Theme = {
  /**
   * Check for WebKit
   * @member {boolean}
  	 */
  isWebkit: Browser.chrome || Browser.safari || navigator.userAgent.match(/(?:webkit|khtml)/i),
  /**
   * Stop the propagation of click events of certain elements
   */
  stopClickPropagation: function () {
    // Do not propagate the click events of the icons
    $$('.picker_selector').each(function (ul) {
      ul.getElements('a').each(function (el) {
        el.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
    });

    // Do not propagate the click events of the checkboxes
    $$('.picker_selector,.click2edit').each(function (ul) {
      ul.getElements('input[type="checkbox"]').each(function (el) {
        el.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
    });
  },
  /**
   * Set up the textarea resizing
   */
  setupTextareaResizing: function () {
    $$('.tl_textarea').each(function (el) {
      if (Browser.ie6 || Browser.ie7 || Browser.ie8) return;
      if (el.hasClass('noresize') || el.retrieve('autogrow')) return;

      // Set up the dummy element
      var dummy = new Element('div', {
        html: 'X',
        styles: {
          'position': 'absolute',
          'top': 0,
          'left': '-999em',
          'overflow-x': 'hidden'
        }
      }).setStyles(el.getStyles('font-size', 'font-family', 'width', 'line-height')).inject(document.body);

      // Also consider the box-sizing
      if (el.getStyle('-moz-box-sizing') == 'border-box' || el.getStyle('-webkit-box-sizing') == 'border-box' || el.getStyle('box-sizing') == 'border-box') {
        dummy.setStyles({
          'padding': el.getStyle('padding'),
          'border': el.getStyle('border-left')
        });
      }

      // Single line height
      var line = Math.max(dummy.clientHeight, 30);

      // Respond to the "input" event
      el.addEvent('input', function () {
        dummy.set('html', this.get('value').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n|\r\n/g, '<br>X'));
        var height = Math.max(line, dummy.getSize().y);
        if (this.clientHeight != height) this.tween('height', height);
      }).set('tween', {
        'duration': 100
      }).setStyle('height', line + 'px');

      // Fire the event
      el.fireEvent('input');
      el.store('autogrow', true);
    });
  },
  /**
   * Set up the menu toggle
   */
  setupMenuToggle: function () {
    var burger = $('burger');
    if (!burger) return;
    burger.addEvent('click', function () {
      document.body.toggleClass('show-navigation');
      burger.setAttribute('aria-expanded', document.body.hasClass('show-navigation') ? 'true' : 'false');
    }).addEvent('keydown', function (e) {
      if (e.event.keyCode == 27) {
        document.body.removeClass('show-navigation');
      }
    });
    if (window.matchMedia) {
      var matchMedia = window.matchMedia('(max-width:991px)');
      var setAriaControls = function () {
        if (matchMedia.matches) {
          burger.setAttribute('aria-controls', 'left');
          burger.setAttribute('aria-expanded', document.body.hasClass('show-navigation') ? 'true' : 'false');
        } else {
          burger.removeAttribute('aria-controls');
          burger.removeAttribute('aria-expanded');
        }
      };
      matchMedia.addEventListener('change', setAriaControls);
      setAriaControls();
    }
  },
  /**
   * Set up the profile toggle
   */
  setupProfileToggle: function () {
    if (window.console) {
      console.warn('Theme.setupProfileToggle() is deprecated. Please use the stimulus controller instead.');
    }
    var tmenu = $('tmenu');
    if (!tmenu) return;
    var li = tmenu.getElement('.submenu'),
      button = li.getFirst('span').getFirst('button'),
      menu = li.getFirst('ul');
    if (!li || !button || !menu) return;
    button.setAttribute('aria-controls', 'tmenu__profile');
    button.setAttribute('aria-expanded', 'false');
    menu.id = 'tmenu__profile';
    button.addEvent('click', function (e) {
      if (li.hasClass('active')) {
        li.removeClass('active');
        button.setAttribute('aria-expanded', 'false');
      } else {
        li.addClass('active');
        button.setAttribute('aria-expanded', 'true');
      }
      e.stopPropagation();
    });
    $(document.body).addEvent('click', function () {
      if (li.hasClass('active')) {
        li.removeClass('active');
      }
    });
  },
  /**
   * Set up the split button toggle
   */
  setupSplitButtonToggle: function () {
    var toggle = $('sbtog');
    if (!toggle) return;
    var ul = toggle.getParent('.split-button').getElement('ul'),
      tab,
      timer;
    toggle.addEvent('click', function (e) {
      tab = false;
      ul.toggleClass('invisible');
      toggle.toggleClass('active');
      e.stopPropagation();
    });
    $(document.body).addEvent('click', function () {
      tab = false;
      ul.addClass('invisible');
      toggle.removeClass('active');
    });
    $(document.body).addEvent('keydown', function (e) {
      tab = e.event.keyCode == 9;
    });
    [toggle].append(ul.getElements('button')).each(function (el) {
      el.addEvent('focus', function () {
        if (!tab) return;
        ul.removeClass('invisible');
        toggle.addClass('active');
        clearTimeout(timer);
      });
      el.addEvent('blur', function () {
        if (!tab) return;
        timer = setTimeout(function () {
          ul.addClass('invisible');
          toggle.removeClass('active');
        }, 100);
      });
    });
    toggle.set('tabindex', '-1');
  }
};

// Initialize the back end script
window.addEvent('domready', function () {
  $(document.body).addClass('js');

  // Mark touch devices (see #5563)
  if (Browser.Features.Touch) {
    $(document.body).addClass('touch');
  }
  Backend.tableWizardSetWidth();
  Backend.enableImageSizeWidgets();
  Backend.enableToggleSelect();
  Theme.stopClickPropagation();
  Theme.setupTextareaResizing();
  Theme.setupMenuToggle();
  Theme.setupSplitButtonToggle();
});

// Resize the table wizard
window.addEvent('resize', function () {
  Backend.tableWizardSetWidth();
});

// Re-apply certain changes upon ajax_change
window.addEvent('ajax_change', function () {
  Backend.enableImageSizeWidgets();
  Backend.enableToggleSelect();
  Theme.stopClickPropagation();
  Theme.setupTextareaResizing();
});

/***/ }),

/***/ "./core-bundle/assets/scripts/limit-height.js":
/*!****************************************************!*\
  !*** ./core-bundle/assets/scripts/limit-height.js ***!
  \****************************************************/
/***/ (function() {

window.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('div.limit_height').forEach(function (div) {
    if (window.console) {
      console.warn('Using "limit_height" class on child_record_callback is deprecated. Set a list.sorting.limitHeight in your DCA instead.');
    }
    const parent = div.parentNode.closest('.tl_content');

    // Return if the element is a wrapper
    if (parent && (parent.classList.contains('wrapper_start') || parent.classList.contains('wrapper_stop'))) return;
    const hgt = Number(div.className.replace(/[^0-9]*/, ''));

    // Return if there is no height value
    if (!hgt) return;
    const style = window.getComputedStyle(div, null);
    const padding = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);
    const height = div.clientHeight - padding;

    // Do not add the toggle if the preview height is below the max-height
    if (height <= hgt) return;

    // Resize the element if it is higher than the maximum height
    div.style.height = hgt + 'px';
    const button = document.createElement('button');
    button.setAttribute('type', 'button');
    button.title = Contao.lang.expand;
    button.innerHTML = '<span>...</span>';
    button.classList.add('unselectable');
    button.addEventListener('click', function () {
      if (div.style.height == 'auto') {
        div.style.height = hgt + 'px';
        button.title = Contao.lang.expand;
      } else {
        div.style.height = 'auto';
        button.title = Contao.lang.collapse;
      }
    });
    const toggler = document.createElement('div');
    toggler.classList.add('limit_toggler');
    toggler.append(button);
    div.append(toggler);
  });
});

/***/ }),

/***/ "./core-bundle/assets/scripts/modulewizard.js":
/*!****************************************************!*\
  !*** ./core-bundle/assets/scripts/modulewizard.js ***!
  \****************************************************/
/***/ (function() {

(function () {
  'use strict';

  const initializedRows = new WeakMap();
  const saveScrollOffsetEvent = new Event('store-scroll-offset');
  const init = row => {
    // Check if this row has already been initialized
    if (initializedRows.has(row)) {
      return;
    }

    // Check if the row has all necessary elements to prevent the mutation observer
    // from initializing the incomplete widget.
    if (!row.querySelector('button.drag-handle')) {
      return;
    }
    initializedRows.set(row, true);
    const tbody = row.closest('tbody');
    const makeSortable = tbody => {
      Array.from(tbody.children).forEach((tr, i) => {
        tr.querySelectorAll('input, select').forEach(el => {
          el.name = el.name.replace(/\[[0-9]+]/g, '[' + i + ']');
        });
      });

      // TODO: replace this with a vanilla JS solution
      new Sortables(tbody, {
        constrain: true,
        opacity: 0.6,
        handle: '.drag-handle',
        onComplete: function () {
          makeSortable(tbody);
        }
      });
    };
    const addEventsTo = tr => {
      tr.querySelectorAll('button').forEach(bt => {
        const command = bt.dataset.command;
        switch (command) {
          case 'copy':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              const ntr = tr.cloneNode(true);
              const selects = tr.querySelectorAll('select');
              const nselects = ntr.querySelectorAll('select');
              for (let j = 0; j < selects.length; j++) {
                nselects[j].value = selects[j].value;
              }
              ntr.querySelectorAll('[data-original-title]').forEach(el => {
                el.setAttribute('title', el.getAttribute('data-original-title'));
                el.removeAttribute('data-original-title');
              });
              initializedRows.set(ntr, true);
              tr.parentNode.insertBefore(ntr, tr.nextSibling);
              addEventsTo(ntr);
              makeSortable(tbody);
            });
            break;
          case 'delete':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              if (tbody.children.length > 1) {
                tr.remove();
              } else {
                // Reset values for last element (#689)
                tr.querySelectorAll('select').forEach(select => {
                  select.value = select.children[0].value;
                });
              }
              makeSortable(tbody);
            });
            break;
          case 'enable':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              const cbx = bt.previousElementSibling;
              if (cbx.checked) {
                cbx.checked = '';
              } else {
                cbx.checked = 'checked';
              }
            });
            break;
          default:
            if (bt.classList.contains('drag-handle')) {
              bt.addEventListener('keydown', event => {
                if (event.code === 'ArrowUp' || event.keyCode === 38) {
                  event.preventDefault();
                  if (tr.previousElementSibling) {
                    tr.previousElementSibling.insertAdjacentElement('beforebegin', tr);
                  } else {
                    tbody.insertAdjacentElement('beforeend', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (event.code === 'ArrowDown' || event.keyCode === 40) {
                  event.preventDefault();
                  if (tr.nextElementSibling) {
                    tr.nextElementSibling.insertAdjacentElement('afterend', tr);
                  } else {
                    tbody.insertAdjacentElement('afterbegin', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
            }
            break;
        }
      });
      const select = tr.querySelector('td:first-child select');
      if (!select) {
        return;
      }
      const link = tr.querySelector('a.module_link');
      const images = tr.querySelectorAll('img.module_image');
      const updateLink = () => {
        link.href = link.href.replace(/id=[0-9]+/, 'id=' + select.value);
        if (select.value > 0) {
          link.classList.remove('hidden');
          images.forEach(image => {
            image.classList.add('hidden');
          });
        } else {
          link.classList.add('hidden');
          images.forEach(image => {
            image.classList.remove('hidden');
          });
        }
      };
      select.addEventListener('change', updateLink);
    };
    makeSortable(tbody);
    addEventsTo(row);
  };
  document.querySelectorAll('.tl_modulewizard tr').forEach(init);
  new MutationObserver(function (mutationsList) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'childList') {
        mutation.addedNodes.forEach(function (element) {
          if (element.matches && element.matches('.tl_modulewizard tr, .tl_modulewizard tr *')) {
            init(element.closest('tr'));
          }
        });
      }
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ }),

/***/ "./core-bundle/assets/scripts/mootao.js":
/*!**********************************************!*\
  !*** ./core-bundle/assets/scripts/mootao.js ***!
  \**********************************************/
/***/ (function() {

/*
---

name: Request.Contao

description: Extends the MooTools Request.JSON class with Contao-specific routines.

license: LGPLv3

authors:
 - Leo Feyer

requires: [Request, JSON]

provides: Request.Contao

...
*/

Request.Contao = new Class({
  Extends: Request.JSON,
  options: {
    followRedirects: true
  },
  initialize: function (options) {
    if (!options) {
      options = {};
    }
    if (!options.url && options.field && options.field.form && options.field.form.action) {
      options.url = options.field.form.action;
    }
    if (!options.url) {
      options.url = window.location.href;
    }
    this.parent(options);
  },
  success: function (text) {
    var url = this.getHeader('X-Ajax-Location'),
      json;
    if (url && this.options.followRedirects) {
      location.replace(url);
      return;
    }

    // Support both plain text and JSON responses
    try {
      json = this.response.json = JSON.decode(text, this.options.secure);
    } catch (e) {
      json = {
        'content': text
      };
    }

    // Empty response
    if (json === null) {
      json = {
        'content': ''
      };
    } else if (typeof json != 'object') {
      json = {
        'content': text
      };
    }

    // Isolate scripts and execute them
    if (json.content != '') {
      json.content = json.content.stripScripts(function (script) {
        json.javascript = script.replace(/<!--|\/\/-->|<!\[CDATA\[\/\/>|<!]]>/g, '');
      });
      if (json.javascript && this.options.evalScripts) {
        Browser.exec(json.javascript);
      }
    }
    this.onSuccess(json.content, json);
  },
  failure: function () {
    var url = this.getHeader('X-Ajax-Location');
    if (url && 401 === this.status) {
      location.replace(url);
      return;
    }
    if (url && this.options.followRedirects && this.status >= 300 && this.status < 400) {
      location.replace(url);
      return;
    }
    this.onFailure();
  }
});

/*
---

name: Drag

description: Extends the base Drag class with touch support.

license: LGPLv3

authors:
 - Andreas Schempp

requires: [Drag]

provides: Drag

...
*/

Class.refactor(Drag, {
  attach: function () {
    this.handles.addEvent('touchstart', this.bound.start);
    return this.previous.apply(this, arguments);
  },
  detach: function () {
    this.handles.removeEvent('touchstart', this.bound.start);
    return this.previous.apply(this, arguments);
  },
  start: function () {
    document.addEvents({
      touchmove: this.bound.check,
      touchend: this.bound.cancel
    });
    this.previous.apply(this, arguments);
  },
  check: function (event) {
    if (this.options.preventDefault) event.preventDefault();
    var distance = Math.round(Math.sqrt(Math.pow(event.page.x - this.mouse.start.x, 2) + Math.pow(event.page.y - this.mouse.start.y, 2)));
    if (distance > this.options.snap) {
      this.cancel();
      this.document.addEvents({
        mousemove: this.bound.drag,
        mouseup: this.bound.stop
      });
      document.addEvents({
        touchmove: this.bound.drag,
        touchend: this.bound.stop
      });
      this.fireEvent('start', [this.element, event]).fireEvent('snap', this.element);
    }
  },
  cancel: function () {
    document.removeEvents({
      touchmove: this.bound.check,
      touchend: this.bound.cancel
    });
    return this.previous.apply(this, arguments);
  },
  stop: function () {
    document.removeEvents({
      touchmove: this.bound.drag,
      touchend: this.bound.stop
    });
    return this.previous.apply(this, arguments);
  }
});

/*
---

name: Sortables

description: Extends the base Sortables class with touch support.

license: LGPLv3

authors:
 - Andreas Schempp

requires: [Sortables]

provides: Sortables

...
*/

Class.refactor(Sortables, {
  initialize: function (lists, options) {
    options.dragOptions = Object.merge(options.dragOptions || {}, {
      preventDefault: options.dragOptions && options.dragOptions.preventDefault || Browser.Features.Touch
    });
    if (options.dragOptions.unDraggableTags === undefined) {
      options.dragOptions.unDraggableTags = this.options.unDraggableTags.filter(function (tag) {
        return tag != 'button';
      });
    }
    return this.previous.apply(this, arguments);
  },
  addItems: function () {
    Array.flatten(arguments).each(function (element) {
      this.elements.push(element);
      var start = element.retrieve('sortables:start', function (event) {
        this.start.call(this, event, element);
      }.bind(this));
      (this.options.handle ? element.getElement(this.options.handle) || element : element).addEvents({
        mousedown: start,
        touchstart: start
      });
    }, this);
    return this;
  },
  removeItems: function () {
    return $$(Array.flatten(arguments).map(function (element) {
      this.elements.erase(element);
      var start = element.retrieve('sortables:start');
      (this.options.handle ? element.getElement(this.options.handle) || element : element).removeEvents({
        mousedown: start,
        touchend: start
      });
      return element;
    }, this));
  },
  getClone: function (event, element) {
    if (!this.options.clone) return new Element(element.tagName).inject(document.body);
    if (typeOf(this.options.clone) == 'function') return this.options.clone.call(this, event, element, this.list);
    var clone = this.previous.apply(this, arguments);
    clone.addEvent('touchstart', function (event) {
      element.fireEvent('touchstart', event);
    });
    return clone;
  }
});

/*
---

script: Request.Queue.js

name: Request.Queue

description: Extends the base Request.Queue class and attempts to fix some issues.

license: MIT-style license

authors:
 - Leo Feyer

requires:
	- Core/Element
	- Core/Request
	- Class.Binds

provides: [Request.Queue]

...
*/

Class.refactor(Request.Queue, {
  // Do not fire the "end" event here
  onComplete: function () {
    this.fireEvent('complete', arguments);
  },
  // Call resume() instead of runNext()
  onCancel: function () {
    if (this.options.autoAdvance && !this.error) this.resume();
    this.fireEvent('cancel', arguments);
  },
  // Call resume() instead of runNext() and fire the "end" event
  onSuccess: function () {
    if (this.options.autoAdvance && !this.error) this.resume();
    this.fireEvent('success', arguments);
    if (!this.queue.length && !this.isRunning()) this.fireEvent('end');
  },
  // Call resume() instead of runNext() and fire the "end" event
  onFailure: function () {
    this.error = true;
    if (!this.options.stopOnFailure && this.options.autoAdvance) this.resume();
    this.fireEvent('failure', arguments);
    if (!this.queue.length && !this.isRunning()) this.fireEvent('end');
  },
  // Call resume() instead of runNext()
  onException: function () {
    this.error = true;
    if (!this.options.stopOnFailure && this.options.autoAdvance) this.resume();
    this.fireEvent('exception', arguments);
  }
});

/*
---

name: Contao.SerpPreview

description: Generates a SERP preview

license: LGPLv3

authors:
 - Leo Feyer

requires: [Request, JSON]

provides: Contao.SerpPreview

...
*/

Contao.SerpPreview = new Class({
  options: {
    id: 0,
    trail: null,
    titleField: null,
    titleFallbackField: null,
    aliasField: null,
    descriptionField: null,
    descriptionFallbackField: null,
    titleTag: null
  },
  shorten: function (str, max) {
    if (str.length <= max) {
      return str;
    }
    return str.substr(0, str.lastIndexOf(' ', max)) + ' …';
  },
  html2string: function (html) {
    return new DOMParser().parseFromString(html, 'text/html').body.textContent.replace(/\[-]/g, '\xAD').replace(/\[nbsp]/g, '\xA0');
  },
  getTinymce: function () {
    if (window.tinyMCE && this.options.descriptionFallbackField) {
      return window.tinyMCE.get(this.options.descriptionFallbackField);
    }
  },
  initialize: function () {
    Turbo.cache.exemptPageFromCache();
    this.options = Object.merge.apply(null, [{}, this.options].append(arguments));
    var serpTitle = $('serp_title_' + this.options.id),
      serpUrl = $('serp_url_' + this.options.id),
      serpDescription = $('serp_description_' + this.options.id),
      titleField = $(this.options.titleField),
      titleFallbackField = $(this.options.titleFallbackField),
      aliasField = $(this.options.aliasField),
      descriptionField = $(this.options.descriptionField),
      descriptionFallbackField = $(this.options.descriptionFallbackField),
      indexEmpty = this.options.trail.indexOf('›') === -1,
      titleTag = this.options.titleTag || '%s';
    titleField && titleField.addEvent('input', function () {
      if (titleField.value) {
        serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleField.value)).replace(/%%/g, '%'), 64));
      } else if (titleFallbackField && titleFallbackField.value) {
        serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleFallbackField.value)).replace(/%%/g, '%'), 64));
      } else {
        serpTitle.set('text', '');
      }
    }.bind(this));
    titleFallbackField && titleFallbackField.addEvent('input', function () {
      if (titleField && titleField.value) return;
      serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleFallbackField.value)).replace(/%%/g, '%'), 64));
    }.bind(this));
    aliasField && aliasField.addEvent('input', function () {
      if (aliasField.value == 'index' && indexEmpty) {
        serpUrl.set('text', this.options.trail);
      } else {
        serpUrl.set('text', this.options.trail + ' › ' + (aliasField.value || this.options.id).replace(/\//g, ' › '));
      }
    }.bind(this));
    descriptionField && descriptionField.addEvent('input', function () {
      if (descriptionField.value) {
        serpDescription.set('text', this.shorten(descriptionField.value, 160));
        return;
      }
      var editor = this.getTinymce();
      if (editor) {
        serpDescription.set('text', this.shorten(this.html2string(editor.getContent()), 160));
      } else if (descriptionFallbackField && descriptionFallbackField.value) {
        serpDescription.set('text', this.shorten(this.html2string(descriptionFallbackField.value), 160));
      } else {
        serpDescription.set('text', '');
      }
    }.bind(this));
    descriptionFallbackField && descriptionFallbackField.addEvent('input', function () {
      if (descriptionField && descriptionField.value) return;
      serpDescription.set('text', this.shorten(this.html2string(descriptionFallbackField.value), 160));
    }.bind(this));
    setTimeout(function () {
      var editor = this.getTinymce();
      editor && editor.on('keyup', function () {
        if (descriptionField && descriptionField.value) return;
        serpDescription.set('text', this.shorten(this.html2string(window.tinyMCE.activeEditor.getContent()), 160));
      }.bind(this));
    }.bind(this), 4);
  }
});

/***/ }),

/***/ "./core-bundle/assets/scripts/sectionwizard.js":
/*!*****************************************************!*\
  !*** ./core-bundle/assets/scripts/sectionwizard.js ***!
  \*****************************************************/
/***/ (function() {

(function () {
  'use strict';

  const initializedRows = new WeakMap();
  const saveScrollOffsetEvent = new Event('store-scroll-offset');
  const init = row => {
    // Check if this row has already been initialized
    if (initializedRows.has(row)) {
      return;
    }

    // Check if the row has all necessary elements to prevent the mutation observer
    // from initializing the incomplete widget.
    if (!row.querySelector('button.drag-handle')) {
      return;
    }
    initializedRows.set(row, true);
    const tbody = row.closest('tbody');
    const makeSortable = tbody => {
      Array.from(tbody.children).forEach((tr, i) => {
        tr.querySelectorAll('input, select').forEach(el => {
          el.name = el.name.replace(/\[[0-9]+]/g, '[' + i + ']');
        });
      });

      // TODO: replace this with a vanilla JS solution
      new Sortables(tbody, {
        constrain: true,
        opacity: 0.6,
        handle: '.drag-handle',
        onComplete: function () {
          makeSortable(tbody);
        }
      });
    };
    const addEventsTo = tr => {
      tr.querySelectorAll('button').forEach(bt => {
        const command = bt.dataset.command;
        switch (command) {
          case 'copy':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              const ntr = tr.cloneNode(true);
              const selects = tr.querySelectorAll('select');
              const nselects = ntr.querySelectorAll('select');
              for (let j = 0; j < selects.length; j++) {
                nselects[j].value = selects[j].value;
              }
              tr.parentNode.insertBefore(ntr, tr.nextSibling);
              addEventsTo(ntr);
              makeSortable(tbody);
            });
            break;
          case 'delete':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              if (tbody.children.length > 1) {
                tr.remove();
              } else {
                // Reset values for last element (#689)
                tr.querySelectorAll('input').forEach(input => {
                  input.value = '';
                });
                tr.querySelectorAll('select').forEach(select => {
                  select.value = select.children[0].value;
                });
              }
              makeSortable(tbody);
            });
            break;
          default:
            if (bt.classList.contains('drag-handle')) {
              bt.addEventListener('keydown', event => {
                if (event.code === 'ArrowUp' || event.keyCode === 38) {
                  event.preventDefault();
                  if (tr.previousElementSibling) {
                    tr.previousElementSibling.insertAdjacentElement('beforebegin', tr);
                  } else {
                    tbody.insertAdjacentElement('beforeend', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (event.code === 'ArrowDown' || event.keyCode === 40) {
                  event.preventDefault();
                  if (tr.nextElementSibling) {
                    tr.nextElementSibling.insertAdjacentElement('afterend', tr);
                  } else {
                    tbody.insertAdjacentElement('afterbegin', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
            }
            break;
        }
      });
    };
    makeSortable(tbody);
    addEventsTo(row);
  };
  document.querySelectorAll('.tl_sectionwizard tr').forEach(init);
  new MutationObserver(function (mutationsList) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'childList') {
        mutation.addedNodes.forEach(function (element) {
          if (element.matches && element.matches('.tl_sectionwizard tr, .tl_sectionwizard tr *')) {
            init(element.closest('tr'));
          }
        });
      }
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ }),

/***/ "./vendor/web-auth/webauthn-stimulus/assets/dist/controller.js":
/*!*********************************************************************!*\
  !*** ./vendor/web-auth/webauthn-stimulus/assets/dist/controller.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ default_1; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @simplewebauthn/browser */ "./node_modules/@simplewebauthn/browser/esm/index.js");


class default_1 extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  constructor() {
    super(...arguments);
    this.connect = async () => {
      var _a, _b;
      const options = {
        requestResultUrl: this.requestResultUrlValue,
        requestOptionsUrl: this.requestOptionsUrlValue,
        requestSuccessRedirectUri: (_a = this.requestSuccessRedirectUriValue) !== null && _a !== undefined ? _a : null,
        creationResultUrl: this.creationResultUrlValue,
        creationOptionsUrl: this.creationOptionsUrlValue,
        creationSuccessRedirectUri: (_b = this.creationSuccessRedirectUriValue) !== null && _b !== undefined ? _b : null
      };
      this._dispatchEvent('webauthn:connect', {
        options
      });
      const supportAutofill = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.browserSupportsWebAuthnAutofill)();
      if (supportAutofill && this.useBrowserAutofillValue) {
        const optionsResponseJson = await this._getPublicKeyCredentialRequestOptions({});
        if (!optionsResponseJson) {
          return;
        }
        this._processSignin(optionsResponseJson, true);
      }
    };
  }
  async signin(event) {
    if (!(0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.browserSupportsWebAuthn)()) {
      this._dispatchEvent('webauthn:unsupported', {});
      return;
    }
    event.preventDefault();
    const optionsResponseJson = await this._getPublicKeyCredentialRequestOptions(null);
    if (!optionsResponseJson) {
      return;
    }
    this._processSignin(optionsResponseJson, false);
  }
  async _processSignin(optionsResponseJson, useBrowserAutofill) {
    try {
      const authenticatorResponse = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.startAuthentication)(optionsResponseJson, useBrowserAutofill);
      this._dispatchEvent('webauthn:authenticator:response', {
        response: authenticatorResponse
      });
      const assertionResponse = await this._getAssertionResponse(authenticatorResponse);
      if (assertionResponse !== false && this.requestSuccessRedirectUriValue) {
        window.location.replace(this.requestSuccessRedirectUriValue);
      }
    } catch (e) {
      this._dispatchEvent('webauthn:assertion:failure', {
        exception: e,
        assertionResponse: null
      });
      return;
    }
  }
  async signup(event) {
    try {
      if (!(0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.browserSupportsWebAuthn)()) {
        this._dispatchEvent('webauthn:unsupported', {});
        return;
      }
      event.preventDefault();
      const optionsResponseJson = await this._getPublicKeyCredentialCreationOptions(null);
      if (!optionsResponseJson) {
        return;
      }
      const authenticatorResponse = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.startRegistration)(optionsResponseJson);
      this._dispatchEvent('webauthn:authenticator:response', {
        response: authenticatorResponse
      });
      const attestationResponseJSON = await this._getAttestationResponse(authenticatorResponse);
      if (attestationResponseJSON !== false && this.creationSuccessRedirectUriValue) {
        window.location.replace(this.creationSuccessRedirectUriValue);
      }
    } catch (e) {
      this._dispatchEvent('webauthn:attestation:failure', {
        exception: e,
        assertionResponse: null
      });
      return;
    }
  }
  _dispatchEvent(name, payload) {
    this.element.dispatchEvent(new CustomEvent(name, {
      detail: payload,
      bubbles: true
    }));
  }
  _getData() {
    let data = new FormData();
    try {
      this.element.reportValidity();
      if (!this.element.checkValidity()) {
        return;
      }
      data = new FormData(this.element);
    } catch (e) {}
    function removeEmpty(obj) {
      return Object.entries(obj).filter(_ref => {
        let [, v] = _ref;
        return v !== null && v !== '';
      }).reduce((acc, _ref2) => {
        let [k, v] = _ref2;
        return Object.assign(Object.assign({}, acc), {
          [k]: v === Object(v) ? removeEmpty(v) : v
        });
      }, {});
    }
    return removeEmpty({
      username: data.get(this.usernameFieldValue),
      displayName: data.get(this.displayNameFieldValue),
      attestation: data.get(this.attestationFieldValue),
      userVerification: data.get(this.userVerificationFieldValue),
      residentKey: data.get(this.residentKeyFieldValue),
      authenticatorAttachment: data.get(this.authenticatorAttachmentFieldValue)
    });
  }
  async _getPublicKeyCredentialRequestOptions(formData) {
    return this._getOptions(this.requestOptionsUrlValue, formData);
  }
  async _getPublicKeyCredentialCreationOptions(formData) {
    return this._getOptions(this.creationOptionsUrlValue, formData);
  }
  async _getOptions(url, formData) {
    const data = formData || this._getData();
    if (!data) {
      return false;
    }
    this._dispatchEvent('webauthn:options:request', {
      data
    });
    const optionsResponse = await fetch(url, {
      headers: Object.assign({}, this.requestHeadersValue),
      method: 'POST',
      body: JSON.stringify(data)
    });
    if (!optionsResponse.ok) {
      this._dispatchEvent('webauthn:options:failure', {
        exception: null,
        optionsResponse
      });
      return false;
    }
    const options = await optionsResponse.json();
    this._dispatchEvent('webauthn:options:success', {
      data: options
    });
    return options;
  }
  async _getAttestationResponse(authenticatorResponse) {
    return this._getResult(this.creationResultUrlValue, 'webauthn:attestation:', authenticatorResponse);
  }
  async _getAssertionResponse(authenticatorResponse) {
    return this._getResult(this.requestResultUrlValue, 'webauthn:assertion:', authenticatorResponse);
  }
  async _getResult(url, eventPrefix, authenticatorResponse) {
    const attestationResponse = await fetch(url, {
      headers: Object.assign({}, this.requestHeadersValue),
      method: 'POST',
      body: JSON.stringify(authenticatorResponse)
    });
    if (!attestationResponse.ok) {
      this._dispatchEvent(eventPrefix + 'failure', {});
      return false;
    }
    const attestationResponseJSON = await attestationResponse.json();
    this._dispatchEvent(eventPrefix + 'success', {
      data: attestationResponseJSON
    });
    return attestationResponseJSON;
  }
}
default_1.values = {
  requestResultUrl: {
    type: String,
    default: '/request'
  },
  requestOptionsUrl: {
    type: String,
    default: '/request/options'
  },
  requestSuccessRedirectUri: String,
  creationResultUrl: {
    type: String,
    default: '/creation'
  },
  creationOptionsUrl: {
    type: String,
    default: '/creation/options'
  },
  creationSuccessRedirectUri: String,
  usernameField: {
    type: String,
    default: 'username'
  },
  displayNameField: {
    type: String,
    default: 'displayName'
  },
  attestationField: {
    type: String,
    default: 'attestation'
  },
  userVerificationField: {
    type: String,
    default: 'userVerification'
  },
  residentKeyField: {
    type: String,
    default: 'residentKey'
  },
  authenticatorAttachmentField: {
    type: String,
    default: 'authenticatorAttachment'
  },
  useBrowserAutofill: {
    type: Boolean,
    default: false
  },
  requestHeaders: {
    type: Object,
    default: {
      'Content-Type': 'application/json',
      'Accept': 'application/json',
      'mode': 'no-cors',
      'credentials': 'include'
    }
  }
};


/***/ }),

/***/ "./core-bundle/assets/styles/backend.pcss":
/*!************************************************!*\
  !*** ./core-bundle/assets/styles/backend.pcss ***!
  \************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js ***!
  \*************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   base64URLStringToBuffer: function() { return /* binding */ base64URLStringToBuffer; }
/* harmony export */ });
/**
 * Convert from a Base64URL-encoded string to an Array Buffer. Best used when converting a
 * credential ID from a JSON string to an ArrayBuffer, like in allowCredentials or
 * excludeCredentials
 *
 * Helper method to compliment `bufferToBase64URLString`
 */
function base64URLStringToBuffer(base64URLString) {
    // Convert from Base64URL to Base64
    const base64 = base64URLString.replace(/-/g, '+').replace(/_/g, '/');
    /**
     * Pad with '=' until it's a multiple of four
     * (4 - (85 % 4 = 1) = 3) % 4 = 3 padding
     * (4 - (86 % 4 = 2) = 2) % 4 = 2 padding
     * (4 - (87 % 4 = 3) = 1) % 4 = 1 padding
     * (4 - (88 % 4 = 0) = 4) % 4 = 0 padding
     */
    const padLength = (4 - (base64.length % 4)) % 4;
    const padded = base64.padEnd(base64.length + padLength, '=');
    // Convert to a binary string
    const binary = atob(padded);
    // Convert binary string to buffer
    const buffer = new ArrayBuffer(binary.length);
    const bytes = new Uint8Array(buffer);
    for (let i = 0; i < binary.length; i++) {
        bytes[i] = binary.charCodeAt(i);
    }
    return buffer;
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js ***!
  \*************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   _browserSupportsWebAuthnInternals: function() { return /* binding */ _browserSupportsWebAuthnInternals; },
/* harmony export */   browserSupportsWebAuthn: function() { return /* binding */ browserSupportsWebAuthn; }
/* harmony export */ });
/**
 * Determine if the browser is capable of Webauthn
 */
function browserSupportsWebAuthn() {
    return _browserSupportsWebAuthnInternals.stubThis(globalThis?.PublicKeyCredential !== undefined &&
        typeof globalThis.PublicKeyCredential === 'function');
}
/**
 * Make it possible to stub the return value during testing
 * @ignore Don't include this in docs output
 */
const _browserSupportsWebAuthnInternals = {
    stubThis: (value) => value,
};


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthnAutofill.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthnAutofill.js ***!
  \*********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   _browserSupportsWebAuthnAutofillInternals: function() { return /* binding */ _browserSupportsWebAuthnAutofillInternals; },
/* harmony export */   browserSupportsWebAuthnAutofill: function() { return /* binding */ browserSupportsWebAuthnAutofill; }
/* harmony export */ });
/* harmony import */ var _browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./browserSupportsWebAuthn.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js");

/**
 * Determine if the browser supports conditional UI, so that WebAuthn credentials can
 * be shown to the user in the browser's typical password autofill popup.
 */
function browserSupportsWebAuthnAutofill() {
    if (!(0,_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_0__.browserSupportsWebAuthn)()) {
        return _browserSupportsWebAuthnAutofillInternals.stubThis(new Promise((resolve) => resolve(false)));
    }
    /**
     * I don't like the `as unknown` here but there's a `declare var PublicKeyCredential` in
     * TS' DOM lib that's making it difficult for me to just go `as PublicKeyCredentialFuture` as I
     * want. I think I'm fine with this for now since it's _supposed_ to be temporary, until TS types
     * have a chance to catch up.
     */
    const globalPublicKeyCredential = globalThis
        .PublicKeyCredential;
    if (globalPublicKeyCredential?.isConditionalMediationAvailable === undefined) {
        return _browserSupportsWebAuthnAutofillInternals.stubThis(new Promise((resolve) => resolve(false)));
    }
    return _browserSupportsWebAuthnAutofillInternals.stubThis(globalPublicKeyCredential.isConditionalMediationAvailable());
}
// Make it possible to stub the return value during testing
const _browserSupportsWebAuthnAutofillInternals = {
    stubThis: (value) => value,
};


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/bufferToBase64URLString.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/bufferToBase64URLString.js ***!
  \*************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   bufferToBase64URLString: function() { return /* binding */ bufferToBase64URLString; }
/* harmony export */ });
/**
 * Convert the given array buffer into a Base64URL-encoded string. Ideal for converting various
 * credential response ArrayBuffers to string for sending back to the server as JSON.
 *
 * Helper method to compliment `base64URLStringToBuffer`
 */
function bufferToBase64URLString(buffer) {
    const bytes = new Uint8Array(buffer);
    let str = '';
    for (const charCode of bytes) {
        str += String.fromCharCode(charCode);
    }
    const base64String = btoa(str);
    return base64String.replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/identifyAuthenticationError.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/identifyAuthenticationError.js ***!
  \*****************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   identifyAuthenticationError: function() { return /* binding */ identifyAuthenticationError; }
/* harmony export */ });
/* harmony import */ var _isValidDomain_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isValidDomain.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/isValidDomain.js");
/* harmony import */ var _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./webAuthnError.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnError.js");


/**
 * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.get()`
 */
function identifyAuthenticationError({ error, options, }) {
    const { publicKey } = options;
    if (!publicKey) {
        throw Error('options was missing required publicKey property');
    }
    if (error.name === 'AbortError') {
        if (options.signal instanceof AbortSignal) {
            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'Authentication ceremony was sent an abort signal',
                code: 'ERROR_CEREMONY_ABORTED',
                cause: error,
            });
        }
    }
    else if (error.name === 'NotAllowedError') {
        /**
         * Pass the error directly through. Platforms are overloading this error beyond what the spec
         * defines and we don't want to overwrite potentially useful error messages.
         */
        return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
            message: error.message,
            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',
            cause: error,
        });
    }
    else if (error.name === 'SecurityError') {
        const effectiveDomain = globalThis.location.hostname;
        if (!(0,_isValidDomain_js__WEBPACK_IMPORTED_MODULE_0__.isValidDomain)(effectiveDomain)) {
            // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 5)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: `${globalThis.location.hostname} is an invalid domain`,
                code: 'ERROR_INVALID_DOMAIN',
                cause: error,
            });
        }
        else if (publicKey.rpId !== effectiveDomain) {
            // https://www.w3.org/TR/webauthn-2/#sctn-discover-from-external-source (Step 6)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: `The RP ID "${publicKey.rpId}" is invalid for this domain`,
                code: 'ERROR_INVALID_RP_ID',
                cause: error,
            });
        }
    }
    else if (error.name === 'UnknownError') {
        // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 1)
        // https://www.w3.org/TR/webauthn-2/#sctn-op-get-assertion (Step 12)
        return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
            message: 'The authenticator was unable to process the specified options, or could not create a new assertion signature',
            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',
            cause: error,
        });
    }
    return error;
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/identifyRegistrationError.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/identifyRegistrationError.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   identifyRegistrationError: function() { return /* binding */ identifyRegistrationError; }
/* harmony export */ });
/* harmony import */ var _isValidDomain_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isValidDomain.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/isValidDomain.js");
/* harmony import */ var _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./webAuthnError.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnError.js");


/**
 * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.create()`
 */
function identifyRegistrationError({ error, options, }) {
    const { publicKey } = options;
    if (!publicKey) {
        throw Error('options was missing required publicKey property');
    }
    if (error.name === 'AbortError') {
        if (options.signal instanceof AbortSignal) {
            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'Registration ceremony was sent an abort signal',
                code: 'ERROR_CEREMONY_ABORTED',
                cause: error,
            });
        }
    }
    else if (error.name === 'ConstraintError') {
        if (publicKey.authenticatorSelection?.requireResidentKey === true) {
            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 4)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'Discoverable credentials were required but no available authenticator supported it',
                code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',
                cause: error,
            });
        }
        else if (
        // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024
        options.mediation === 'conditional' &&
            publicKey.authenticatorSelection?.userVerification === 'required') {
            // https://w3c.github.io/webauthn/#sctn-createCredential (Step 22.4)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'User verification was required during automatic registration but it could not be performed',
                code: 'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',
                cause: error,
            });
        }
        else if (publicKey.authenticatorSelection?.userVerification === 'required') {
            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 5)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'User verification was required but no available authenticator supported it',
                code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',
                cause: error,
            });
        }
    }
    else if (error.name === 'InvalidStateError') {
        // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 20)
        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 3)
        return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
            message: 'The authenticator was previously registered',
            code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',
            cause: error,
        });
    }
    else if (error.name === 'NotAllowedError') {
        /**
         * Pass the error directly through. Platforms are overloading this error beyond what the spec
         * defines and we don't want to overwrite potentially useful error messages.
         */
        return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
            message: error.message,
            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',
            cause: error,
        });
    }
    else if (error.name === 'NotSupportedError') {
        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter((param) => param.type === 'public-key');
        if (validPubKeyCredParams.length === 0) {
            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 10)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'No entry in pubKeyCredParams was of type "public-key"',
                code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',
                cause: error,
            });
        }
        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 2)
        return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
            message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',
            code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',
            cause: error,
        });
    }
    else if (error.name === 'SecurityError') {
        const effectiveDomain = globalThis.location.hostname;
        if (!(0,_isValidDomain_js__WEBPACK_IMPORTED_MODULE_0__.isValidDomain)(effectiveDomain)) {
            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 7)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: `${globalThis.location.hostname} is an invalid domain`,
                code: 'ERROR_INVALID_DOMAIN',
                cause: error,
            });
        }
        else if (publicKey.rp.id !== effectiveDomain) {
            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 8)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: `The RP ID "${publicKey.rp.id}" is invalid for this domain`,
                code: 'ERROR_INVALID_RP_ID',
                cause: error,
            });
        }
    }
    else if (error.name === 'TypeError') {
        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {
            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 5)
            return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
                message: 'User ID was not between 1 and 64 characters',
                code: 'ERROR_INVALID_USER_ID_LENGTH',
                cause: error,
            });
        }
    }
    else if (error.name === 'UnknownError') {
        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 1)
        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 8)
        return new _webAuthnError_js__WEBPACK_IMPORTED_MODULE_1__.WebAuthnError({
            message: 'The authenticator was unable to process the specified options, or could not create a new credential',
            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',
            cause: error,
        });
    }
    return error;
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/isValidDomain.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/isValidDomain.js ***!
  \***************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isValidDomain: function() { return /* binding */ isValidDomain; }
/* harmony export */ });
/**
 * A simple test to determine if a hostname is a properly-formatted domain name
 *
 * A "valid domain" is defined here: https://url.spec.whatwg.org/#valid-domain
 *
 * Regex sourced from here:
 * https://www.oreilly.com/library/view/regular-expressions-cookbook/9781449327453/ch08s15.html
 */
function isValidDomain(hostname) {
    return (
    // Consider localhost valid as well since it's okay wrt Secure Contexts
    hostname === 'localhost' ||
        /^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(hostname));
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/platformAuthenticatorIsAvailable.js":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/platformAuthenticatorIsAvailable.js ***!
  \**********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   platformAuthenticatorIsAvailable: function() { return /* binding */ platformAuthenticatorIsAvailable; }
/* harmony export */ });
/* harmony import */ var _browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./browserSupportsWebAuthn.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js");

/**
 * Determine whether the browser can communicate with a built-in authenticator, like
 * Touch ID, Android fingerprint scanner, or Windows Hello.
 *
 * This method will _not_ be able to tell you the name of the platform authenticator.
 */
function platformAuthenticatorIsAvailable() {
    if (!(0,_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_0__.browserSupportsWebAuthn)()) {
        return new Promise((resolve) => resolve(false));
    }
    return PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/toAuthenticatorAttachment.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/toAuthenticatorAttachment.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   toAuthenticatorAttachment: function() { return /* binding */ toAuthenticatorAttachment; }
/* harmony export */ });
const attachments = ['cross-platform', 'platform'];
/**
 * If possible coerce a `string` value into a known `AuthenticatorAttachment`
 */
function toAuthenticatorAttachment(attachment) {
    if (!attachment) {
        return;
    }
    if (attachments.indexOf(attachment) < 0) {
        return;
    }
    return attachment;
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/toPublicKeyCredentialDescriptor.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/toPublicKeyCredentialDescriptor.js ***!
  \*********************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   toPublicKeyCredentialDescriptor: function() { return /* binding */ toPublicKeyCredentialDescriptor; }
/* harmony export */ });
/* harmony import */ var _base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base64URLStringToBuffer.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js");

function toPublicKeyCredentialDescriptor(descriptor) {
    const { id } = descriptor;
    return {
        ...descriptor,
        id: (0,_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_0__.base64URLStringToBuffer)(id),
        /**
         * `descriptor.transports` is an array of our `AuthenticatorTransportFuture` that includes newer
         * transports that TypeScript's DOM lib is ignorant of. Convince TS that our list of transports
         * are fine to pass to WebAuthn since browsers will recognize the new value.
         */
        transports: descriptor.transports,
    };
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnAbortService.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnAbortService.js ***!
  \**********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WebAuthnAbortService: function() { return /* binding */ WebAuthnAbortService; }
/* harmony export */ });
class BaseWebAuthnAbortService {
    constructor() {
        Object.defineProperty(this, "controller", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
    }
    createNewAbortSignal() {
        // Abort any existing calls to navigator.credentials.create() or navigator.credentials.get()
        if (this.controller) {
            const abortError = new Error('Cancelling existing WebAuthn API call for new one');
            abortError.name = 'AbortError';
            this.controller.abort(abortError);
        }
        const newController = new AbortController();
        this.controller = newController;
        return newController.signal;
    }
    cancelCeremony() {
        if (this.controller) {
            const abortError = new Error('Manually cancelling existing WebAuthn API call');
            abortError.name = 'AbortError';
            this.controller.abort(abortError);
            this.controller = undefined;
        }
    }
}
/**
 * A service singleton to help ensure that only a single WebAuthn ceremony is active at a time.
 *
 * Users of **@simplewebauthn/browser** shouldn't typically need to use this, but it can help e.g.
 * developers building projects that use client-side routing to better control the behavior of
 * their UX in response to router navigation events.
 */
const WebAuthnAbortService = new BaseWebAuthnAbortService();


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnError.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnError.js ***!
  \***************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WebAuthnError: function() { return /* binding */ WebAuthnError; }
/* harmony export */ });
/**
 * A custom Error used to return a more nuanced error detailing _why_ one of the eight documented
 * errors in the spec was raised after calling `navigator.credentials.create()` or
 * `navigator.credentials.get()`:
 *
 * - `AbortError`
 * - `ConstraintError`
 * - `InvalidStateError`
 * - `NotAllowedError`
 * - `NotSupportedError`
 * - `SecurityError`
 * - `TypeError`
 * - `UnknownError`
 *
 * Error messages were determined through investigation of the spec to determine under which
 * scenarios a given error would be raised.
 */
class WebAuthnError extends Error {
    constructor({ message, code, cause, name, }) {
        // @ts-ignore: help Rollup understand that `cause` is okay to set
        super(message, { cause });
        Object.defineProperty(this, "code", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.name = name ?? cause.name;
        this.code = code;
    }
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/index.js":
/*!***********************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/index.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WebAuthnAbortService: function() { return /* reexport safe */ _helpers_webAuthnAbortService_js__WEBPACK_IMPORTED_MODULE_7__.WebAuthnAbortService; },
/* harmony export */   WebAuthnError: function() { return /* reexport safe */ _helpers_webAuthnError_js__WEBPACK_IMPORTED_MODULE_8__.WebAuthnError; },
/* harmony export */   _browserSupportsWebAuthnAutofillInternals: function() { return /* reexport safe */ _helpers_browserSupportsWebAuthnAutofill_js__WEBPACK_IMPORTED_MODULE_4__._browserSupportsWebAuthnAutofillInternals; },
/* harmony export */   _browserSupportsWebAuthnInternals: function() { return /* reexport safe */ _helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__._browserSupportsWebAuthnInternals; },
/* harmony export */   base64URLStringToBuffer: function() { return /* reexport safe */ _helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_5__.base64URLStringToBuffer; },
/* harmony export */   browserSupportsWebAuthn: function() { return /* reexport safe */ _helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__.browserSupportsWebAuthn; },
/* harmony export */   browserSupportsWebAuthnAutofill: function() { return /* reexport safe */ _helpers_browserSupportsWebAuthnAutofill_js__WEBPACK_IMPORTED_MODULE_4__.browserSupportsWebAuthnAutofill; },
/* harmony export */   bufferToBase64URLString: function() { return /* reexport safe */ _helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_6__.bufferToBase64URLString; },
/* harmony export */   platformAuthenticatorIsAvailable: function() { return /* reexport safe */ _helpers_platformAuthenticatorIsAvailable_js__WEBPACK_IMPORTED_MODULE_3__.platformAuthenticatorIsAvailable; },
/* harmony export */   startAuthentication: function() { return /* reexport safe */ _methods_startAuthentication_js__WEBPACK_IMPORTED_MODULE_1__.startAuthentication; },
/* harmony export */   startRegistration: function() { return /* reexport safe */ _methods_startRegistration_js__WEBPACK_IMPORTED_MODULE_0__.startRegistration; }
/* harmony export */ });
/* harmony import */ var _methods_startRegistration_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./methods/startRegistration.js */ "./node_modules/@simplewebauthn/browser/esm/methods/startRegistration.js");
/* harmony import */ var _methods_startAuthentication_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./methods/startAuthentication.js */ "./node_modules/@simplewebauthn/browser/esm/methods/startAuthentication.js");
/* harmony import */ var _helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./helpers/browserSupportsWebAuthn.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js");
/* harmony import */ var _helpers_platformAuthenticatorIsAvailable_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./helpers/platformAuthenticatorIsAvailable.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/platformAuthenticatorIsAvailable.js");
/* harmony import */ var _helpers_browserSupportsWebAuthnAutofill_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./helpers/browserSupportsWebAuthnAutofill.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthnAutofill.js");
/* harmony import */ var _helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./helpers/base64URLStringToBuffer.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js");
/* harmony import */ var _helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helpers/bufferToBase64URLString.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/bufferToBase64URLString.js");
/* harmony import */ var _helpers_webAuthnAbortService_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./helpers/webAuthnAbortService.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnAbortService.js");
/* harmony import */ var _helpers_webAuthnError_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./helpers/webAuthnError.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnError.js");
/* harmony import */ var _types_index_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./types/index.js */ "./node_modules/@simplewebauthn/browser/esm/types/index.js");












/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/methods/startAuthentication.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/methods/startAuthentication.js ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   startAuthentication: function() { return /* binding */ startAuthentication; }
/* harmony export */ });
/* harmony import */ var _helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/bufferToBase64URLString.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/bufferToBase64URLString.js");
/* harmony import */ var _helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/base64URLStringToBuffer.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js");
/* harmony import */ var _helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/browserSupportsWebAuthn.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js");
/* harmony import */ var _helpers_browserSupportsWebAuthnAutofill_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/browserSupportsWebAuthnAutofill.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthnAutofill.js");
/* harmony import */ var _helpers_toPublicKeyCredentialDescriptor_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/toPublicKeyCredentialDescriptor.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/toPublicKeyCredentialDescriptor.js");
/* harmony import */ var _helpers_identifyAuthenticationError_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/identifyAuthenticationError.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/identifyAuthenticationError.js");
/* harmony import */ var _helpers_webAuthnAbortService_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/webAuthnAbortService.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnAbortService.js");
/* harmony import */ var _helpers_toAuthenticatorAttachment_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../helpers/toAuthenticatorAttachment.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/toAuthenticatorAttachment.js");








/**
 * Begin authenticator "login" via WebAuthn assertion
 *
 * @param optionsJSON Output from **@simplewebauthn/server**'s `generateAuthenticationOptions()`
 * @param useBrowserAutofill (Optional) Initialize conditional UI to enable logging in via browser autofill prompts. Defaults to `false`.
 * @param verifyBrowserAutofillInput (Optional) Ensure a suitable `<input>` element is present when `useBrowserAutofill` is `true`. Defaults to `true`.
 */
async function startAuthentication(options) {
    // @ts-ignore: Intentionally check for old call structure to warn about improper API call
    if (!options.optionsJSON && options.challenge) {
        console.warn('startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information.');
        // @ts-ignore: Reassign the options, passed in as a positional argument, to the expected variable
        options = { optionsJSON: options };
    }
    const { optionsJSON, useBrowserAutofill = false, verifyBrowserAutofillInput = true, } = options;
    if (!(0,_helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__.browserSupportsWebAuthn)()) {
        throw new Error('WebAuthn is not supported in this browser');
    }
    // We need to avoid passing empty array to avoid blocking retrieval
    // of public key
    let allowCredentials;
    if (optionsJSON.allowCredentials?.length !== 0) {
        allowCredentials = optionsJSON.allowCredentials?.map(_helpers_toPublicKeyCredentialDescriptor_js__WEBPACK_IMPORTED_MODULE_4__.toPublicKeyCredentialDescriptor);
    }
    // We need to convert some values to Uint8Arrays before passing the credentials to the navigator
    const publicKey = {
        ...optionsJSON,
        challenge: (0,_helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_1__.base64URLStringToBuffer)(optionsJSON.challenge),
        allowCredentials,
    };
    // Prepare options for `.get()`
    const getOptions = {};
    /**
     * Set up the page to prompt the user to select a credential for authentication via the browser's
     * input autofill mechanism.
     */
    if (useBrowserAutofill) {
        if (!(await (0,_helpers_browserSupportsWebAuthnAutofill_js__WEBPACK_IMPORTED_MODULE_3__.browserSupportsWebAuthnAutofill)())) {
            throw Error('Browser does not support WebAuthn autofill');
        }
        // Check for an <input> with "webauthn" in its `autocomplete` attribute
        const eligibleInputs = document.querySelectorAll("input[autocomplete$='webauthn']");
        // WebAuthn autofill requires at least one valid input
        if (eligibleInputs.length < 1 && verifyBrowserAutofillInput) {
            throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');
        }
        // `CredentialMediationRequirement` doesn't know about "conditional" yet as of
        // typescript@4.6.3
        getOptions.mediation = 'conditional';
        // Conditional UI requires an empty allow list
        publicKey.allowCredentials = [];
    }
    // Finalize options
    getOptions.publicKey = publicKey;
    // Set up the ability to cancel this request if the user attempts another
    getOptions.signal = _helpers_webAuthnAbortService_js__WEBPACK_IMPORTED_MODULE_6__.WebAuthnAbortService.createNewAbortSignal();
    // Wait for the user to complete assertion
    let credential;
    try {
        credential = (await navigator.credentials.get(getOptions));
    }
    catch (err) {
        throw (0,_helpers_identifyAuthenticationError_js__WEBPACK_IMPORTED_MODULE_5__.identifyAuthenticationError)({ error: err, options: getOptions });
    }
    if (!credential) {
        throw new Error('Authentication was not completed');
    }
    const { id, rawId, response, type } = credential;
    let userHandle = undefined;
    if (response.userHandle) {
        userHandle = (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.userHandle);
    }
    // Convert values to base64 to make it easier to send back to the server
    return {
        id,
        rawId: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(rawId),
        response: {
            authenticatorData: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.authenticatorData),
            clientDataJSON: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.clientDataJSON),
            signature: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.signature),
            userHandle,
        },
        type,
        clientExtensionResults: credential.getClientExtensionResults(),
        authenticatorAttachment: (0,_helpers_toAuthenticatorAttachment_js__WEBPACK_IMPORTED_MODULE_7__.toAuthenticatorAttachment)(credential.authenticatorAttachment),
    };
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/methods/startRegistration.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/methods/startRegistration.js ***!
  \*******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   startRegistration: function() { return /* binding */ startRegistration; }
/* harmony export */ });
/* harmony import */ var _helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/bufferToBase64URLString.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/bufferToBase64URLString.js");
/* harmony import */ var _helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/base64URLStringToBuffer.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/base64URLStringToBuffer.js");
/* harmony import */ var _helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/browserSupportsWebAuthn.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/browserSupportsWebAuthn.js");
/* harmony import */ var _helpers_toPublicKeyCredentialDescriptor_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/toPublicKeyCredentialDescriptor.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/toPublicKeyCredentialDescriptor.js");
/* harmony import */ var _helpers_identifyRegistrationError_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/identifyRegistrationError.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/identifyRegistrationError.js");
/* harmony import */ var _helpers_webAuthnAbortService_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/webAuthnAbortService.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/webAuthnAbortService.js");
/* harmony import */ var _helpers_toAuthenticatorAttachment_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/toAuthenticatorAttachment.js */ "./node_modules/@simplewebauthn/browser/esm/helpers/toAuthenticatorAttachment.js");







/**
 * Begin authenticator "registration" via WebAuthn attestation
 *
 * @param optionsJSON Output from **@simplewebauthn/server**'s `generateRegistrationOptions()`
 * @param useAutoRegister (Optional) Try to silently create a passkey with the password manager that the user just signed in with. Defaults to `false`.
 */
async function startRegistration(options) {
    // @ts-ignore: Intentionally check for old call structure to warn about improper API call
    if (!options.optionsJSON && options.challenge) {
        console.warn('startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information.');
        // @ts-ignore: Reassign the options, passed in as a positional argument, to the expected variable
        options = { optionsJSON: options };
    }
    const { optionsJSON, useAutoRegister = false } = options;
    if (!(0,_helpers_browserSupportsWebAuthn_js__WEBPACK_IMPORTED_MODULE_2__.browserSupportsWebAuthn)()) {
        throw new Error('WebAuthn is not supported in this browser');
    }
    // We need to convert some values to Uint8Arrays before passing the credentials to the navigator
    const publicKey = {
        ...optionsJSON,
        challenge: (0,_helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_1__.base64URLStringToBuffer)(optionsJSON.challenge),
        user: {
            ...optionsJSON.user,
            id: (0,_helpers_base64URLStringToBuffer_js__WEBPACK_IMPORTED_MODULE_1__.base64URLStringToBuffer)(optionsJSON.user.id),
        },
        excludeCredentials: optionsJSON.excludeCredentials?.map(_helpers_toPublicKeyCredentialDescriptor_js__WEBPACK_IMPORTED_MODULE_3__.toPublicKeyCredentialDescriptor),
    };
    // Prepare options for `.create()`
    const createOptions = {};
    /**
     * Try to use conditional create to register a passkey for the user with the password manager
     * the user just used to authenticate with. The user won't be shown any prominent UI by the
     * browser.
     */
    if (useAutoRegister) {
        // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024
        createOptions.mediation = 'conditional';
    }
    // Finalize options
    createOptions.publicKey = publicKey;
    // Set up the ability to cancel this request if the user attempts another
    createOptions.signal = _helpers_webAuthnAbortService_js__WEBPACK_IMPORTED_MODULE_5__.WebAuthnAbortService.createNewAbortSignal();
    // Wait for the user to complete attestation
    let credential;
    try {
        credential = (await navigator.credentials.create(createOptions));
    }
    catch (err) {
        throw (0,_helpers_identifyRegistrationError_js__WEBPACK_IMPORTED_MODULE_4__.identifyRegistrationError)({ error: err, options: createOptions });
    }
    if (!credential) {
        throw new Error('Registration was not completed');
    }
    const { id, rawId, response, type } = credential;
    // Continue to play it safe with `getTransports()` for now, even when L3 types say it's required
    let transports = undefined;
    if (typeof response.getTransports === 'function') {
        transports = response.getTransports();
    }
    // L3 says this is required, but browser and webview support are still not guaranteed.
    let responsePublicKeyAlgorithm = undefined;
    if (typeof response.getPublicKeyAlgorithm === 'function') {
        try {
            responsePublicKeyAlgorithm = response.getPublicKeyAlgorithm();
        }
        catch (error) {
            warnOnBrokenImplementation('getPublicKeyAlgorithm()', error);
        }
    }
    let responsePublicKey = undefined;
    if (typeof response.getPublicKey === 'function') {
        try {
            const _publicKey = response.getPublicKey();
            if (_publicKey !== null) {
                responsePublicKey = (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(_publicKey);
            }
        }
        catch (error) {
            warnOnBrokenImplementation('getPublicKey()', error);
        }
    }
    // L3 says this is required, but browser and webview support are still not guaranteed.
    let responseAuthenticatorData;
    if (typeof response.getAuthenticatorData === 'function') {
        try {
            responseAuthenticatorData = (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.getAuthenticatorData());
        }
        catch (error) {
            warnOnBrokenImplementation('getAuthenticatorData()', error);
        }
    }
    return {
        id,
        rawId: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(rawId),
        response: {
            attestationObject: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.attestationObject),
            clientDataJSON: (0,_helpers_bufferToBase64URLString_js__WEBPACK_IMPORTED_MODULE_0__.bufferToBase64URLString)(response.clientDataJSON),
            transports,
            publicKeyAlgorithm: responsePublicKeyAlgorithm,
            publicKey: responsePublicKey,
            authenticatorData: responseAuthenticatorData,
        },
        type,
        clientExtensionResults: credential.getClientExtensionResults(),
        authenticatorAttachment: (0,_helpers_toAuthenticatorAttachment_js__WEBPACK_IMPORTED_MODULE_6__.toAuthenticatorAttachment)(credential.authenticatorAttachment),
    };
}
/**
 * Visibly warn when we detect an issue related to a passkey provider intercepting WebAuthn API
 * calls
 */
function warnOnBrokenImplementation(methodName, cause) {
    console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${methodName}. You should report this error to them.\n`, cause);
}


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/esm/types/index.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/esm/types/index.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./node_modules/@stimulus-components/color-picker/dist/stimulus-color-picker.mjs":
/*!***************************************************************************************!*\
  !*** ./node_modules/@stimulus-components/color-picker/dist/stimulus-color-picker.mjs ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ ColorPicker; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _simonwep_pickr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @simonwep/pickr */ "./node_modules/@simonwep/pickr/dist/pickr.min.js");


const _ColorPicker = class _ColorPicker extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  initialize() {
    this.onSave = this.onSave.bind(this);
  }
  connect() {
    this.picker = _simonwep_pickr__WEBPACK_IMPORTED_MODULE_1__.create({
      el: this.buttonTarget,
      theme: this.themeValue,
      default: this.inputTarget.value,
      swatches: this.swatches,
      components: this.componentOptions
    }), this.picker.on("save", this.onSave);
  }
  disconnect() {
    this.picker.destroy();
  }
  onSave(color) {
    this.inputTarget.value = null, color && (this.inputTarget.value = color.toHEXA().toString()), this.picker.hide();
  }
  get componentOptions() {
    return {
      preview: !0,
      hue: !0,
      interaction: {
        input: !0,
        clear: !0,
        save: !0
      }
    };
  }
  get swatches() {
    return [
      "#A0AEC0",
      "#F56565",
      "#ED8936",
      "#ECC94B",
      "#48BB78",
      "#38B2AC",
      "#4299E1",
      "#667EEA",
      "#9F7AEA",
      "#ED64A6"
    ];
  }
};
_ColorPicker.targets = ["button", "input"], _ColorPicker.values = {
  theme: {
    type: String,
    default: "classic"
  }
};
let ColorPicker = _ColorPicker;



/***/ }),

/***/ "./node_modules/accessible-menu/dist/accessible-menu.es.js":
/*!*****************************************************************!*\
  !*** ./node_modules/accessible-menu/dist/accessible-menu.es.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ se; }
/* harmony export */ });
var P = Object.defineProperty;
var R = (r, e, t) => e in r ? P(r, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) : r[e] = t;
var u = (r, e, t) => R(r, typeof e != "symbol" ? e + "" : e, t);
function S(r, e) {
  r === "" || r.length === 0 || (typeof r == "string" ? e.classList.add(r) : e.classList.add(...r));
}
function D(r, e) {
  r === "" || r.length === 0 || (typeof r == "string" ? e.classList.remove(r) : e.classList.remove(...r));
}
function A(r, e) {
  try {
    if (typeof e != "object") {
      const t = typeof e;
      throw new TypeError(
        `Elements given to isValidInstance() must be inside of an object. "${t}" given.`
      );
    }
    for (const t in e)
      if (!(e[t] instanceof r)) {
        const s = typeof e[t];
        throw new TypeError(
          `${t} must be an instance of ${r.name}. "${s}" given.`
        );
      }
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function c(r, e) {
  try {
    if (typeof e != "object") {
      const t = typeof e;
      throw new TypeError(
        `Values given to isValidType() must be inside of an object. "${t}" given.`
      );
    }
    for (const t in e) {
      const s = typeof e[t];
      if (s !== r)
        throw new TypeError(`${t} must be a ${r}. "${s}" given.`);
    }
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function x(r) {
  try {
    if (typeof r != "object") {
      const e = typeof r;
      throw new TypeError(
        `Values given to isQuerySelector() must be inside of an object. "${e}" given.`
      );
    }
    for (const e in r)
      try {
        if (r[e] === null)
          throw new Error();
        document.querySelector(r[e]);
      } catch {
        throw new TypeError(
          `${e} must be a valid query selector. "${r[e]}" given.`
        );
      }
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function k(r) {
  try {
    if (typeof r != "object" || Array.isArray(r)) {
      const e = typeof r;
      throw new TypeError(
        `Values given to isValidClassList() must be inside of an object. "${e}" given.`
      );
    }
    for (const e in r) {
      const t = typeof r[e];
      if (t !== "string")
        if (Array.isArray(r[e]))
          r[e].forEach((s) => {
            if (typeof s != "string")
              throw new TypeError(
                `${e} must be a string or an array of strings. An array containing non-strings given.`
              );
          });
        else
          throw new TypeError(
            `${e} must be a string or an array of strings. "${t}" given.`
          );
      else {
        const s = {};
        s[e] = r[e], x(s);
      }
    }
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function U(r) {
  try {
    if (typeof r != "object") {
      const t = typeof r;
      throw new TypeError(
        `Values given to isValidState() must be inside of an object. "${t}" given.`
      );
    }
    const e = ["none", "self", "child"];
    for (const t in r)
      if (!e.includes(r[t]))
        throw new TypeError(
          `${t} must be one of the following values: ${e.join(
            ", "
          )}. "${r[t]}" given.`
        );
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function W(r) {
  try {
    if (typeof r != "object") {
      const t = typeof r;
      throw new TypeError(
        `Values given to isValidEvent() must be inside of an object. "${t}" given.`
      );
    }
    const e = ["none", "mouse", "keyboard", "character"];
    for (const t in r)
      if (!e.includes(r[t]))
        throw new TypeError(
          `${t} must be one of the following values: ${e.join(
            ", "
          )}. "${r[t]}" given.`
        );
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function N(r) {
  try {
    if (typeof r != "object") {
      const t = typeof r;
      throw new TypeError(
        `Values given to isValidHoverType() must be inside of an object. "${t}" given.`
      );
    }
    const e = ["off", "on", "dynamic"];
    for (const t in r)
      if (!e.includes(r[t]))
        throw new TypeError(
          `${t} must be one of the following values: ${e.join(
            ", "
          )}. "${r[t]}" given.`
        );
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function F(r, e) {
  if (c("string", { tagName: r }).status && A(HTMLElement, e).status) {
    const t = r.toLowerCase();
    let s = !0;
    for (const n in e)
      e[n].tagName.toLowerCase() !== t && (s = !1);
    return s;
  } else
    return !1;
}
class L {
  /**
   * Constructs a new `BaseMenuToggle`.
   *
   * @param {object}      options                     - The options for generating the menu toggle.
   * @param {HTMLElement} options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement} options.parentElement       - The element containing the controlled menu.
   * @param {BaseMenu}    options.controlledMenu      - The menu controlled by this toggle.
   * @param {?BaseMenu}   [options.parentMenu = null] - The menu containing this toggle.
   */
  constructor({
    menuToggleElement: e,
    parentElement: t,
    controlledMenu: s,
    parentMenu: n = null
  }) {
    /**
     * The DOM elements within the menu toggle.
     *
     * @protected
     *
     * @type {Object<HTMLElement>}
     *
     * @property {HTMLElement} toggle - The menu toggle.
     * @property {HTMLElement} parent - The menu containing this toggle.
     */
    u(this, "_dom", {
      toggle: null,
      parent: null
    });
    /**
     * The declared accessible-menu elements within the menu toggle.
     *
     * @protected
     *
     * @type {Object<BaseMenu>}
     *
     * @property {BaseMenu} controlledMenu - The menu controlled by this toggle.
     * @property {BaseMenu} parentMenu     - The menu containing this toggle.
     */
    u(this, "_elements", {
      controlledMenu: null,
      parentMenu: null
    });
    /**
     * The open state of the menu toggle.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_open", !1);
    /**
     * The event that is triggered when the menu toggle expands.
     *
     * @protected
     *
     * @event accessibleMenuExpand
     *
     * @type {CustomEvent}
     *
     * @property {boolean}                bubbles - A flag to bubble the event.
     * @property {Object<BaseMenuToggle>} details - The details object containing the BaseMenuToggle itself.
     */
    u(this, "_expandEvent", new CustomEvent("accessibleMenuExpand", {
      bubbles: !0,
      detail: { toggle: this }
    }));
    /**
     * The event that is triggered when the menu toggle collapses.
     *
     * @protected
     *
     * @event accessibleMenuCollapse
     *
     * @type {CustomEvent}
     *
     * @property {boolean}                bubbles - A flag to bubble the event.
     * @property {Object<BaseMenuToggle>} details - The details object containing the BaseMenuToggle itself.
     */
    u(this, "_collapseEvent", new CustomEvent("accessibleMenuCollapse", {
      bubbles: !0,
      detail: { toggle: this }
    }));
    this._dom.toggle = e, this._dom.parent = t, this._elements.controlledMenu = s, this._elements.parentMenu = n;
  }
  /**
   * Initializes the menu toggle.
   *
   * The first steps are to ensure that the toggle and controlled menu have IDs
   * using the setIds method, and to set the ARIA attributes on the toggle
   * and controlled menu using the setAriaAttributes method.
   *
   * Then the collapse method is called to make sure the submenu is closed.
   */
  initialize() {
    this._setIds(), this._setAriaAttributes(), this._collapse(!1);
  }
  /**
   * The DOM elements within the toggle.
   *
   * @readonly
   *
   * @type {Object<HTMLElement>}
   *
   * @see _dom
   */
  get dom() {
    return this._dom;
  }
  /**
   * The declared accessible-menu elements within the toggle.
   *
   * @readonly
   *
   * @type {Object<BaseMenu>}
   *
   * @see _elements
   */
  get elements() {
    return this._elements;
  }
  /**
   * The open state on the toggle.
   *
   * @type {boolean}
   *
   * @see _open
   */
  get isOpen() {
    return this._open;
  }
  set isOpen(e) {
    c("boolean", { value: e }), this._open = e;
  }
  /**
   * Sets unique IDs for the toggle and controlled menu.
   *
   * If the toggle and controlled menu do not have IDs, the following steps take place:
   * - Generate a random string 1-10 characters long,
   * - Get the innerText of the toggle,
   * - Set the toggle's ID to: `menu-button-${toggle-inner-text}-${the-random-string}`
   * - Set the menu's ID to: `menu-${toggle-inner-text}-${the-random-string}`
   *
   * @protected
   */
  _setIds() {
    var e;
    if (this.dom.toggle.id === "" || this.elements.controlledMenu.dom.menu.id === "") {
      const t = Math.random().toString(36).replace(/[^a-z]+/g, "").substring(0, 10);
      let s = ((e = this.dom.toggle.innerText) == null ? void 0 : e.replace(/[^a-zA-Z0-9\s]/g, "")) || "", n = t;
      !s.replace(/\s/g, "").length && this.dom.toggle.getAttribute("aria-label") && (s = this.dom.toggle.getAttribute("aria-label").replace(/[^a-zA-Z0-9\s]/g, "")), s.replace(/\s/g, "").length > 0 && (s = s.toLowerCase().replace(/\s+/g, "-"), s.startsWith("-") && (s = s.substring(1)), s.endsWith("-") && (s = s.slice(0, -1)), n = `${s}-${n}`), this.dom.toggle.id = this.dom.toggle.id || `menu-button-${n}`, this.elements.controlledMenu.dom.menu.id = this.elements.controlledMenu.dom.menu.id || `menu-${n}`;
    }
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * The first steps are to ensure that the toggle has `aria-expanded`
   * is initially set to "false".
   *
   * Then using the toggle and menu's IDs, the menu's `aria-labelledby` is set to
   * the toggle's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    this.dom.toggle.setAttribute("aria-expanded", "false"), this.elements.controlledMenu.dom.menu.setAttribute(
      "aria-labelledby",
      this.dom.toggle.id
    );
  }
  /**
   * Expands the controlled menu.
   *
   * Sets the toggle's `aria-expanded` to "true", adds the
   * open class to the toggle's parent menu item
   * and controlled menu, and removes the closed class
   * from the toggle's parent menu item and controlled menu.
   *
   * If `emit` is set to `true`, this will also emit a custom event
   * called accessibleMenuExpand
   *
   * @protected
   *
   * @fires accessibleMenuExpand
   *
   * @param {boolean} [emit = true] - A toggle to emit the expand event once expanded.
   */
  _expand(e = !0) {
    const { closeClass: t, openClass: s, transitionClass: n, openDuration: i } = this.elements.controlledMenu;
    this.dom.toggle.setAttribute("aria-expanded", "true"), this.elements.controlledMenu.elements.rootMenu.hasOpened = !0, n !== "" ? (S(n, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
      D(t, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
        S(s, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
          setTimeout(() => {
            D(
              n,
              this.elements.controlledMenu.dom.menu
            );
          }, i);
        });
      });
    })) : (S(s, this.elements.controlledMenu.dom.menu), D(t, this.elements.controlledMenu.dom.menu)), e && this.dom.toggle.dispatchEvent(this._expandEvent);
  }
  /**
   * Collapses the controlled menu.
   *
   * Sets the toggle's `aria-expanded` to "false", adds the
   * closed class to the toggle's parent menu item
   * and controlled menu, and removes the open class
   * from the toggle's parent menu item and controlled menu.
   *
   * If `emit` is set to `true`, this will also emit a custom event
   * called accessibleMenuCollapse
   *
   * @protected
   *
   * @fires accessibleMenuCollapse
   *
   * @param {boolean} [emit = true] - A toggle to emit the collapse event once collapsed.
   */
  _collapse(e = !0) {
    const { closeClass: t, openClass: s, transitionClass: n, closeDuration: i } = this.elements.controlledMenu;
    this.dom.toggle.setAttribute("aria-expanded", "false"), n !== "" ? (S(n, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
      D(s, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
        S(t, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
          setTimeout(() => {
            D(
              n,
              this.elements.controlledMenu.dom.menu
            );
          }, i);
        });
      });
    })) : (S(t, this.elements.controlledMenu.dom.menu), D(s, this.elements.controlledMenu.dom.menu)), e && this.dom.toggle.dispatchEvent(this._collapseEvent);
  }
  /**
   * Opens the controlled menu.
   *
   * Sets the controlled menu's focus state to "self"
   * and the parent menu's focus state to "child", calls expand,
   * and sets the isOpen value to `true`.
   *
   * @public
   */
  open() {
    this.elements.controlledMenu.focusState = "self", this.isOpen || (this._expand(), this.isOpen = !0);
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Sets the controlled menu's focus state to "self"
   * and the parent menu's focus state to "child",
   * and calls expand.
   *
   * @public
   */
  preview() {
    this.elements.parentMenu && (this.elements.parentMenu.focusState = "self"), this.isOpen || (this._expand(), this.isOpen = !0);
  }
  /**
   * Closes the controlled menu.
   *
   * Sets the controlled menu's focus state to "none"
   * and the parent menu's focus state to "self", blurs the controlled menu
   * and sets it's current child index to 0,
   * calls collapse, and sets
   * the isOpen value to `false`.
   *
   * @public
   */
  close() {
    this.isOpen && (this.elements.controlledMenu.blur(), this.elements.parentMenu && (this.elements.parentMenu.focusState = "self"), this._collapse(), this.isOpen = !1);
  }
  /**
   * Toggles the open state of the controlled menu between `true` and `false`.
   *
   * @public
   */
  toggle() {
    this.isOpen ? this.close() : this.open();
  }
  /**
   * Closes all sibling menus.
   *
   * @public
   */
  closeSiblings() {
    this.elements.parentMenu && this.elements.parentMenu.elements.submenuToggles.forEach((e) => {
      e !== this && e.close();
    });
  }
  /**
   * Closes all child menus.
   *
   * @public
   */
  closeChildren() {
    this.elements.controlledMenu.elements.submenuToggles.forEach(
      (e) => e.close()
    );
  }
}
class O {
  /**
   * Constructs a new `BaseMenuItem`.
   *
   * @param {object}          options                         - The options for generating the menu item.
   * @param {HTMLElement}     options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}     options.menuLinkElement         - The menu item's link in the DOM.
   * @param {BaseMenu}        options.parentMenu              - The parent menu.
   * @param {boolean}         [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?BaseMenu}       [options.childMenu = null]      - The child menu.
   * @param {?BaseMenuToggle} [options.toggle = null]         - The controller for the child menu.
   */
  constructor({
    menuItemElement: e,
    menuLinkElement: t,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: l = null
  }) {
    /**
     * The DOM elements within the menu item.
     *
     * @protected
     *
     * @type {Object<HTMLElement>}
     *
     * @property {HTMLElement} item - The menu item.
     * @property {HTMLElement} link - The menu item's link.
     */
    u(this, "_dom", {
      item: null,
      link: null
    });
    /**
     * The declared accessible-menu elements within the menu item.
     *
     * @protected
     *
     * @type {Object<BaseMenu, BaseMenuToggle>}
     *
     * @property {BaseMenu}        parentMenu - The menu containing this menu item.
     * @property {?BaseMenu}       childMenu  - The menu contained within this menu item.
     * @property {?BaseMenuToggle} toggle     - The menu toggle within this menu item that controls the `childMenu`.
     */
    u(this, "_elements", {
      parentMenu: null,
      childMenu: null,
      toggle: null
    });
    /**
     * A flag marking a submenu item.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_submenu", !1);
    this._dom.item = e, this._dom.link = t, this._elements.parentMenu = s, this._elements.childMenu = i, this._elements.toggle = l, this._submenu = n;
  }
  /**
   * Initialize the menu item.
   */
  initialize() {
  }
  /**
   * The DOM elements within the menu item.
   *
   * @readonly
   *
   * @type {Object<HTMLElement>}
   *
   * @see _dom
   */
  get dom() {
    return this._dom;
  }
  /**
   * The declared accessible-menu elements within the menu item.
   *
   * @readonly
   *
   * @type {Object<BaseMenu, BaseMenuToggle>}
   *
   * @see _elements
   */
  get elements() {
    return this._elements;
  }
  /**
   * A flag marking a submenu item.
   *
   * @readonly
   *
   * @type {boolean}
   *
   * @see _submenu
   */
  get isSubmenuItem() {
    return this._submenu;
  }
  /**
   * Focuses the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * @public
   */
  focus() {
    this.elements.parentMenu.shouldFocus && requestAnimationFrame(() => {
      this.dom.link.focus();
    });
  }
  /**
   * Blurs the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * @public
   */
  blur() {
    this.elements.parentMenu.shouldFocus && requestAnimationFrame(() => {
      this.dom.link.blur();
    });
  }
}
function _(r) {
  try {
    const e = r.key || r.keyCode, t = {
      Enter: e === "Enter" || e === 13,
      Space: e === " " || e === "Spacebar" || e === 32,
      Escape: e === "Escape" || e === "Esc" || e === 27,
      ArrowUp: e === "ArrowUp" || e === "Up" || e === 38,
      ArrowRight: e === "ArrowRight" || e === "Right" || e === 39,
      ArrowDown: e === "ArrowDown" || e === "Down" || e === 40,
      ArrowLeft: e === "ArrowLeft" || e === "Left" || e === 37,
      Home: e === "Home" || e === 36,
      End: e === "End" || e === 35,
      Character: isNaN(e) && !!e.match(/^[a-zA-Z]{1}$/),
      Tab: e === "Tab" || e === 9,
      Asterisk: e === "*" || e === 56
    };
    return Object.keys(t).find((s) => t[s] === !0) || "";
  } catch {
    return "";
  }
}
function o(r) {
  r.preventDefault(), r.stopPropagation();
}
class w {
  /**
   * Constructs a new `BaseMenu`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = a]        - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {number}             [options.transitionDuration = 250]         - The duration of the transition between "open" and "closed" states (in milliseconds).
   * @param {boolean}            [options.openDuration = -1]                - The duration of the transition from "closed" to "open" states (in milliseconds).
   * @param {boolean}            [options.closeDuration = -1]               - The duration of the transition from "open" to "closed" states (in milliseconds).
   * @param {boolean}            [options.isTopLevel = false]               - A flag to mark the root menu.
   * @param {?BaseMenu}          [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in milliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening menus if the menu is hoverable (in milliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing menus if the menu is hoverable (in milliseconds).
   * @param {?string}            [options.prefix = am-]                     - The prefix to use for CSS custom properties.
   */
  constructor({
    menuElement: e,
    menuItemSelector: t = "li",
    menuLinkSelector: s = "a",
    submenuItemSelector: n = "li:has(ul)",
    submenuToggleSelector: i = "a",
    submenuSelector: l = "ul",
    controllerElement: h = null,
    containerElement: m = null,
    openClass: a = "show",
    closeClass: f = "hide",
    transitionClass: p = "transitioning",
    transitionDuration: g = 250,
    openDuration: d = -1,
    closeDuration: M = -1,
    isTopLevel: y = !0,
    parentMenu: b = null,
    hoverType: C = "off",
    hoverDelay: T = 250,
    enterDelay: E = -1,
    leaveDelay: I = -1,
    prefix: v = "am-"
  }) {
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof BaseMenu}
     */
    u(this, "_MenuType", w);
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof BaseMenuItem}
     */
    u(this, "_MenuItemType", O);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof BaseMenuToggle}
     */
    u(this, "_MenuToggleType", L);
    /**
     * The DOM elements within the menu.
     *
     * @protected
     *
     * @type {Object<HTMLElement, HTMLElement[]>}
     *
     * @property {HTMLElement}   menu           - The menu element.
     * @property {HTMLElement[]} menuItems      - An array of menu items.
     * @property {HTMLElement[]} submenuItems   - An array of menu items that also contain submenu elements.
     * @property {HTMLElement[]} submenuToggles - An array of menu links that function as submenu toggles.
     * @property {HTMLElement[]} submenus       - An array of submenu elements.
     * @property {HTMLElement}   controller     - The toggle for this menu.
     * @property {HTMLElement}   container      - The container for this menu.
     */
    u(this, "_dom", {
      menu: null,
      menuItems: [],
      submenuItems: [],
      submenuToggles: [],
      submenus: [],
      controller: null,
      container: null
    });
    /**
     * The query selectors used by the menu to populate the dom.
     *
     * @protected
     *
     * @type {Object<string>}
     *
     * @property {string} menuItems      - The query selector for menu items.
     * @property {string} menuLinks      - The query selector for menu links.
     * @property {string} submenuItems   - The query selector for menu items containing submenus.
     * @property {string} submenuToggles - The query selector for menu links that function as submenu toggles.
     * @property {string} submenus       - The query selector for for submenus.
     */
    u(this, "_selectors", {
      menuItems: "",
      menuLinks: "",
      submenuItems: "",
      submenuToggles: "",
      submenus: ""
    });
    /**
     * The declared accessible-menu elements within the menu.
     *
     * @protected
     *
     * @type {Object<BaseMenu, BaseMenuToggle, BaseMenuItem[], BaseMenuToggle[]>}
     *
     * @property {BaseMenuItem[]}   menuItems      - An array of menu items.
     * @property {BaseMenuToggle[]} submenuToggles - An array of menu toggles.
     * @property {?BaseMenuToggle}  controller     - A menu toggle that controls this menu.
     * @property {?BaseMenu}        parentMenu     - The parent menu.
     * @property {?BaseMenu}        rootMenu       - The root menu of the menu tree.
     */
    u(this, "_elements", {
      menuItems: [],
      submenuToggles: [],
      controller: null,
      parentMenu: null,
      rootMenu: null
    });
    /**
     * The class(es) to apply when the menu is open.
     *
     * @protected
     *
     * @type {string|string[]}
     */
    u(this, "_openClass", "show");
    /**
     * The class(es) to apply when the menu is closed.
     *
     * @protected
     *
     * @type {string|string[]}
     */
    u(this, "_closeClass", "hide");
    /**
     * The class(es) to apply when the menu is transitioning between states.
     *
     * @protected
     *
     * @type {string|string[]}
     */
    u(this, "_transitionClass", "transitioning");
    /**
     * The duration time (in milliseconds) for the transition between open and closed states.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_transitionDuration", 250);
    /**
     * The duration time (in milliseconds) for the transition from closed to open states.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_openDuration", -1);
    /**
     * The duration time (in milliseconds) for the transition from open to closed states.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_closeDuration", -1);
    /**
     * A flag marking the root menu.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_root", !0);
    /**
     * The index of the currently selected menu item in the menu.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_currentChild", 0);
    /**
     * The current state of the menu's focus.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_focusState", "none");
    /**
     * This last event triggered on the menu.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_currentEvent", "none");
    /**
     * The type of hoverability for the menu.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_hoverType", "off");
    /**
     * The delay time (in milliseconds) used for pointerenter/pointerleave events to take place.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_hoverDelay", 250);
    /**
     * The delay time (in milliseconds) used for pointerenter events to take place.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_enterDelay", -1);
    /**
     * The delay time (in milliseconds) used for pointerleave events to take place.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_leaveDelay", -1);
    /**
     * The prefix to use for CSS custom properties.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_prefix", "am-");
    /**
     * A variable to hold the hover timeout function.
     *
     * @protected
     *
     * @type {?Function}
     */
    u(this, "_hoverTimeout", null);
    /**
     * A flag to check if the menu can dynamically hover based on if a menu has been opened already.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_hasOpened", !1);
    /**
     * An array of error messages generated by the menu.
     *
     * @protected
     *
     * @type {string[]}
     */
    u(this, "_errors", []);
    this._dom.menu = e, this._dom.controller = h, this._dom.container = m, this._selectors.menuItems = t, this._selectors.menuLinks = s, this._selectors.submenuItems = n, this._selectors.submenuToggles = i, this._selectors.submenus = l, this._elements.menuItems = [], this._elements.submenuToggles = [], this._elements.controller = null, this._elements.parentMenu = b, this._elements.rootMenu = y ? this : null, this._openClass = a || "", this._closeClass = f || "", this._transitionClass = p || "", this._transitionDuration = g, this._openDuration = d, this._closeDuration = M, this._prefix = v || "", this._root = y, this._hoverType = C, this._hoverDelay = T, this._enterDelay = E, this._leaveDelay = I;
  }
  /**
   * Initializes the menu.
   *
   * The following steps will be taken to initialize the menu:
   * - Validate that the menu can initialize.
   * - Find the root menu of the menu tree if it isn't already set.
   * - Populate all DOM elements within the dom.
   * - If the current menu is the root menu _and_ has a controller, initialize
   *   the controller.
   * - Populate the menu elements within the elements.
   * - Set the transition duration custom prop for the menu.
   *
   * @public
   *
   * @throws {Error} Will throw an Error if validate returns `false`.
   */
  initialize() {
    if (!this._validate())
      throw new Error(
        `AccessibleMenu: cannot initialize menu. The following errors have been found:
 - ${this.errors.join(
          `
 - `
        )}`
      );
    if (this.elements.rootMenu === null && this._findRootMenu(this), this._setDOMElements(), this.isTopLevel && this.dom.controller && this.dom.container) {
      const e = new this._MenuToggleType({
        menuToggleElement: this.dom.controller,
        parentElement: this.dom.container,
        controlledMenu: this
      });
      F("button", { toggle: e.dom.toggle }) || e.dom.toggle.setAttribute("role", "button"), e.dom.toggle.setAttribute("aria-controls", this.dom.menu.id), this._elements.controller = e;
    }
    this._createChildElements(), this._setTransitionDurations(), this.isTopLevel && (window.AccessibleMenu = window.AccessibleMenu || {
      menus: {}
    }, window.AccessibleMenu.menus[this.dom.menu.id] = this);
  }
  /**
   * The DOM elements within the menu.
   *
   * @readonly
   *
   * @type {Object<HTMLElement, HTMLElement[]>}
   *
   * @see _dom
   */
  get dom() {
    return this._dom;
  }
  /**
   * The query selectors used by the menu to populate the dom.
   *
   * @readonly
   *
   * @type {Object<string>}
   *
   * @see _selectors
   */
  get selectors() {
    return this._selectors;
  }
  /**
   * The declared accessible-menu elements within the menu.
   *
   * @readonly
   *
   * @type {Object<BaseMenu, BaseMenuToggle, BaseMenuItem[], BaseMenuToggle[]>}
   *
   * @see _elements
   */
  get elements() {
    return this._elements;
  }
  /**
   * The flag marking the root menu.
   *
   * @readonly
   *
   * @type {boolean}
   *
   * @see _root
   */
  get isTopLevel() {
    return this._root;
  }
  /**
   * The class(es) to apply when the menu is open.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's open class(es).
   *
   * @type {string|string[]}
   *
   * @see _openClass
   */
  get openClass() {
    return this.isTopLevel ? this._openClass : this.elements.rootMenu.openClass;
  }
  /**
   * The class(es) to apply when the menu is closed.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's close class(es).
   *
   * @type {string|string[]}
   *
   * @see _closeClass
   */
  get closeClass() {
    return this.isTopLevel ? this._closeClass : this.elements.rootMenu.closeClass;
  }
  /**
   * The class(es) to apply when the menu is transitioning between open and closed.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's transition class(es).
   *
   * @type {string|string[]}
   *
   * @see _transitionClass
   */
  get transitionClass() {
    return this.isTopLevel ? this._transitionClass : this.elements.rootMenu.transitionClass;
  }
  /**
   * The duration time (in milliseconds) for the transition between open and closed states.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's transition duration.
   *
   * Setting this value will also set the --am-transition-duration CSS custom property on the menu.
   *
   * @type {number}
   *
   * @see _transitionDuration
   */
  get transitionDuration() {
    return this.isTopLevel ? this._transitionDuration : this.elements.rootMenu.transitionDuration;
  }
  /**
   * The duration time (in milliseconds) for the transition from closed to open states.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's openDuration.
   *
   * If openDuration is set to -1, the transitionDuration value will be used instead.
   *
   * Setting this value will also set the --am-open-transition-duration CSS custom property on the menu.
   *
   * @type {number}
   *
   * @see _openDuration
   */
  get openDuration() {
    return this._openDuration === -1 ? this.transitionDuration : this.isTopLevel ? this._openDuration : this.elements.rootMenu.openDuration;
  }
  /**
   * The duration time (in milliseconds) for the transition from open to closed states.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's closeDuration.
   *
   * If closeDuration is set to -1, the transitionDuration value will be used instead.
   *
   * Setting this value will also set the --am-close-transition-duration CSS custom property on the menu.
   *
   * @type {number}
   *
   * @see _closeDuration
   */
  get closeDuration() {
    return this._closeDuration === -1 ? this.transitionDuration : this.isTopLevel ? this._closeDuration : this.elements.rootMenu.closeDuration;
  }
  /**
   * The index of the currently selected menu item in the menu.
   *
   * - Attempting to set a value less than -1 will set the current child to -1.
   * - Attempting to set a value greater than or equal to the number of menu items
   *   will set the current child to the index of the last menu item in the menu.
   *
   * If the current menu has a parent menu _and_ the menu's
   * current event is "mouse", The parent menu
   * will have it's current child updated as well to help with transitioning
   * between mouse and keyboard navigation.
   *
   * @type {number}
   *
   * @see _currentChild
   */
  get currentChild() {
    return this._currentChild;
  }
  /**
   * The current state of the menu's focus.
   *
   * - If the menu has submenus, setting the focus state to "none" or "self" will
   *   update all child menus to have the focus state of "none".
   * - If the menu has a parent menu, setting the focus state to "self" or "child"
   *   will update all parent menus to have the focus state of "child".
   *
   * @type {string}
   *
   * @see _focusState
   */
  get focusState() {
    return this._focusState;
  }
  /**
   * The last event triggered on the menu.
   *
   * @type {string}
   *
   * @see _currentEvent
   */
  get currentEvent() {
    return this._currentEvent;
  }
  /**
   * The currently selected menu item.
   *
   * @readonly
   *
   * @type {BaseMenuItem}
   */
  get currentMenuItem() {
    return this.elements.menuItems[this.currentChild];
  }
  /**
   * The type of hoverability for the menu.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's hoverability.
   *
   * @type {string}
   *
   * @see _hoverType
   */
  get hoverType() {
    return this._root ? this._hoverType : this.elements.rootMenu.hoverType;
  }
  /**
   * The delay time (in milliseconds) used for pointerenter/pointerleave events to take place.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's hover delay.
   *
   * @type {number}
   *
   * @see _hoverDelay
   */
  get hoverDelay() {
    return this._root ? this._hoverDelay : this.elements.rootMenu.hoverDelay;
  }
  /**
   * The delay time (in milliseconds) used for pointerenter events to take place.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's enter delay.
   *
   * If enterDelay is set to -1, the hoverDelay value will be used instead.
   *
   * @type {number}
   *
   * @see _enterDelay
   */
  get enterDelay() {
    return this._enterDelay === -1 ? this.hoverDelay : this._root ? this._enterDelay : this.elements.rootMenu.enterDelay;
  }
  /**
   * The delay time (in milliseconds) used for pointerleave events to take place.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's leave delay.
   *
   * If leaveDelay is set to -1, the hoverDelay value will be used instead.
   *
   * @type {number}
   *
   * @see _leaveDelay
   */
  get leaveDelay() {
    return this._leaveDelay === -1 ? this.hoverDelay : this._root ? this._leaveDelay : this.elements.rootMenu.leaveDelay;
  }
  /**
   * The prefix to use for CSS custom properties.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's prefix.
   *
   * @type {string}
   *
   * @see _prefix
   */
  get prefix() {
    return this._root ? this._prefix : this.elements.rootMenu.prefix;
  }
  /**
   * A flag to check if the menu's focus methods should _actually_ move the focus in the DOM.
   *
   * This will be `false` unless any of the following criteria are met:
   * - The menu's current event is "keyboard".
   * - The menu's current event is "character".
   * - The menu's current event is "mouse" _and_ the menu's
   *   hover type is "dynamic".
   *
   * @readonly
   *
   * @type {boolean}
   */
  get shouldFocus() {
    let e = !1;
    return (this.currentEvent === "keyboard" || this.currentEvent === "character") && (e = !0), this.currentEvent === "mouse" && this.hoverType === "dynamic" && (e = !0), e;
  }
  /**
   * A flag to check if the menu can dynamically hover.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's hasOpened.
   *
   * @type {boolean}
   *
   * @see _hasOpened
   */
  get hasOpened() {
    return this._root ? this._hasOpened : this.elements.rootMenu.hasOpened;
  }
  /**
   * An array of error messages generated by the menu.
   *
   * @readonly
   *
   * @type {string[]}
   *
   * @see _errors
   */
  get errors() {
    return this._errors;
  }
  set openClass(e) {
    k({ openClass: e }), this._openClass !== e && (this._openClass = e);
  }
  set closeClass(e) {
    k({ closeClass: e }), this._closeClass !== e && (this._closeClass = e);
  }
  set transitionClass(e) {
    k({ transitionClass: e }), this._transitionClass !== e && (this._transitionClass = e);
  }
  set transitionDuration(e) {
    c("number", { value: e }), this._transitionDuration !== e && (this._transitionDuration = e, this._setTransitionDurations());
  }
  set openDuration(e) {
    c("number", { value: e }), this._openDuration !== e && (this._openDuration = e, this._setTransitionDurations());
  }
  set closeDuration(e) {
    c("number", { value: e }), this._closeDuration !== e && (this._closeDuration = e, this._setTransitionDurations());
  }
  set currentChild(e) {
    c("number", { value: e });
    function t(s) {
      if (["mouse", "character"].includes(s.currentEvent) && s.elements.parentMenu) {
        let i = 0, l = !1;
        for (; !l && i < s.elements.parentMenu.elements.menuItems.length; ) {
          const h = s.elements.parentMenu.elements.menuItems[i];
          h.isSubmenuItem && h.elements.toggle.elements.controlledMenu === s && (l = !0, s.elements.parentMenu.currentEvent = s.currentEvent, s.elements.parentMenu.currentChild = i), i++;
        }
      }
    }
    e < -1 ? (this._currentChild = -1, t(this)) : e >= this.elements.menuItems.length ? (this._currentChild = this.elements.menuItems.length - 1, t(this)) : this.focusChild !== e && (this._currentChild = e, t(this));
  }
  set focusState(e) {
    U({ value: e }), this._focusState !== e && (this._focusState = e), this.elements.submenuToggles.length > 0 && (e === "self" || e === "none") && this.elements.submenuToggles.forEach((t) => {
      t.elements.controlledMenu.focusState = "none";
    }), this.elements.parentMenu && (e === "self" || e === "child") && (this.elements.parentMenu.focusState = "child");
  }
  set currentEvent(e) {
    W({ value: e }), this._currentEvent !== e && (this._currentEvent = e, this.elements.submenuToggles.length > 0 && this.elements.submenuToggles.forEach((t) => {
      t.elements.controlledMenu.currentEvent = e;
    }));
  }
  set hoverType(e) {
    N({ value: e }), this._hoverType !== e && (this._hoverType = e);
  }
  set hoverDelay(e) {
    c("number", { value: e }), this._hoverDelay !== e && (this._hoverDelay = e);
  }
  set enterDelay(e) {
    c("number", { value: e }), this._enterDelay !== e && (this._enterDelay = e);
  }
  set leaveDelay(e) {
    c("number", { value: e }), this._leaveDelay !== e && (this._leaveDelay = e);
  }
  set prefix(e) {
    c("string", { value: e }), this._prefix !== e && (this._prefix = e);
  }
  set hasOpened(e) {
    c("boolean", { value: e }), this._hasOpened !== e && (this._hasOpened = e);
  }
  /**
   * Validates all aspects of the menu to ensure proper functionality.
   *
   * @protected
   *
   * @return {boolean} - The result of the validation.
   */
  _validate() {
    let e = !0, t;
    this._dom.container !== null || this._dom.controller !== null ? t = A(HTMLElement, {
      menuElement: this._dom.menu,
      controllerElement: this._dom.controller,
      containerElement: this._dom.container
    }) : t = A(HTMLElement, {
      menuElement: this._dom.menu
    }), t.status || (this._errors.push(t.error.message), e = !1);
    let s;
    if (this._selectors.submenuItems !== "" ? s = x({
      menuItemSelector: this._selectors.menuItems,
      menuLinkSelector: this._selectors.menuLinks,
      submenuItemSelector: this._selectors.submenuItems,
      submenuToggleSelector: this._selectors.submenuToggles,
      submenuSelector: this._selectors.submenus
    }) : s = x({
      menuItemSelector: this._selectors.menuItems,
      menuLinkSelector: this._selectors.menuLinks
    }), s.status || (this._errors.push(s.error.message), e = !1), this._openClass !== "") {
      const d = k({ openClass: this._openClass });
      d.status || (this._errors.push(d.error.message), e = !1);
    }
    if (this._closeClass !== "") {
      const d = k({
        closeClass: this._closeClass
      });
      d.status || (this._errors.push(d.error.message), e = !1);
    }
    if (this._transitionClass !== "") {
      const d = k({
        transitionClass: this._transitionClass
      });
      d.status || (this._errors.push(d.error.message), e = !1);
    }
    const n = c("number", {
      transitionDuration: this._transitionDuration
    });
    n.status || (this._errors.push(n.error.message), e = !1);
    const i = c("number", {
      openDuration: this._openDuration
    });
    i.status || (this._errors.push(i.error.message), e = !1);
    const l = c("number", {
      closeDuration: this._closeDuration
    });
    l.status || (this._errors.push(l.error.message), e = !1);
    const h = c("boolean", { isTopLevel: this._root });
    if (h.status || (this._errors.push(h.error.message), e = !1), this._elements.parentMenu !== null) {
      const d = A(w, {
        parentMenu: this._elements.parentMenu
      });
      d.status || (this._errors.push(d.error.message), e = !1);
    }
    const m = N({ hoverType: this._hoverType });
    m.status || (this._errors.push(m.error.message), e = !1);
    const a = c("number", {
      hoverDelay: this._hoverDelay
    });
    a.status || (this._errors.push(a.error.message), e = !1);
    const f = c("number", {
      enterDelay: this._enterDelay
    });
    f.status || (this._errors.push(f.error.message), e = !1);
    const p = c("number", {
      leaveDelay: this._leaveDelay
    });
    p.status || (this._errors.push(p.error.message), e = !1);
    const g = c("string", { prefix: this._prefix });
    return g.status || (this._errors.push(g.error.message), e = !1), e;
  }
  /**
   * Sets DOM elements within the menu.
   *
   * Elements that are not stored inside an array cannot be set through this method.
   *
   * @protected
   *
   * @param {string}      elementType            - The type of element to populate.
   * @param {HTMLElement} [base = this.dom.menu] - The element used as the base for the querySelect.
   * @param {boolean}     [overwrite = true]     - A flag to set if the existing elements will be overwritten.
   */
  _setDOMElementType(e, t = this.dom.menu, s = !0) {
    if (typeof this.selectors[e] == "string") {
      if (!Array.isArray(this.dom[e]))
        throw new Error(
          `AccessibleMenu: The "${e}" element cannot be set through _setDOMElementType.`
        );
      t !== this.dom.menu && A(HTMLElement, { base: t });
      const i = Array.from(
        t.querySelectorAll(this.selectors[e])
      ).filter(
        (l) => l.parentElement === t
      );
      s ? this._dom[e] = i : this._dom[e] = [
        ...this._dom[e],
        ...i
      ];
    } else
      throw new Error(
        `AccessibleMenu: "${e}" is not a valid element type within the menu.`
      );
  }
  /**
   * Resets DOM elements within the menu.
   *
   * Elements that are not stored inside an array cannot be reset through this method.
   *
   * @protected
   *
   * @param {string} elementType - The type of element to clear.
   */
  _resetDOMElementType(e) {
    if (typeof this.dom[e] < "u") {
      if (!Array.isArray(this.dom[e]))
        throw new Error(
          `AccessibleMenu: The "${e}" element cannot be reset through _resetDOMElementType.`
        );
      this._dom[e] = [];
    } else
      throw new Error(
        `AccessibleMenu: "${e}" is not a valid element type within the menu.`
      );
  }
  /**
   * Sets all DOM elements within the menu.
   *
   * Utilizes _setDOMElementType and
   * _resetDOMElementType.
   *
   * @protected
   */
  _setDOMElements() {
    this._setDOMElementType("menuItems"), this.selectors.submenuItems !== "" && (this._setDOMElementType("submenuItems"), this._resetDOMElementType("submenuToggles"), this._resetDOMElementType("submenus"), this.dom.submenuItems.forEach((e) => {
      this._setDOMElementType("submenuToggles", e, !1), this._setDOMElementType("submenus", e, !1);
    }));
  }
  /**
   * Finds the root menu element.
   *
   * @protected
   *
   * @param {BaseMenu} menu - The menu to check.
   */
  _findRootMenu(e) {
    if (e.isTopLevel)
      this._elements.rootMenu = e;
    else if (e.elements.parentMenu !== null)
      this._findRootMenu(e.elements.parentMenu);
    else
      throw new Error("Cannot find root menu.");
  }
  /**
   * Creates and initializes all menu items and submenus.
   *
   * @protected
   */
  _createChildElements() {
    this.dom.menuItems.forEach((e) => {
      let t;
      if (this.dom.submenuItems.includes(e)) {
        const s = e.querySelector(this.selectors.submenuToggles), n = e.querySelector(this.selectors.submenus), i = new this._MenuType({
          menuElement: n,
          menuItemSelector: this.selectors.menuItems,
          menuLinkSelector: this.selectors.menuLinks,
          submenuItemSelector: this.selectors.submenuItems,
          submenuToggleSelector: this.selectors.submenuToggles,
          submenuSelector: this.selectors.submenus,
          openClass: this.openClass,
          closeClass: this.closeClass,
          transitionClass: this.transitionClass,
          transitionDuration: this.transitionDuration,
          openDuration: this.openDuration,
          closeDuration: this.closeDuration,
          isTopLevel: !1,
          parentMenu: this,
          hoverType: this.hoverType,
          hoverDelay: this.hoverDelay,
          enterDelay: this.enterDelay,
          leaveDelay: this.leaveDelay
        }), l = new this._MenuToggleType({
          menuToggleElement: s,
          parentElement: e,
          controlledMenu: i,
          parentMenu: this
        });
        this._elements.submenuToggles.push(l), t = new this._MenuItemType({
          menuItemElement: e,
          menuLinkElement: s,
          parentMenu: this,
          isSubmenuItem: !0,
          childMenu: i,
          toggle: l
        });
      } else {
        const s = e.querySelector(this.selectors.menuLinks);
        t = new this._MenuItemType({
          menuItemElement: e,
          menuLinkElement: s,
          parentMenu: this
        });
      }
      this._elements.menuItems.push(t);
    });
  }
  /**
   * Clears the hover timeout.
   *
   * @protected
   */
  _clearTimeout() {
    clearTimeout(this._hoverTimeout);
  }
  /**
   * Sets the hover timeout.
   *
   * @protected
   *
   * @param {Function} callback - The callback function to execute.
   * @param {number}   delay    - The delay time in milliseconds.
   */
  _setTimeout(e, t) {
    c("function", { callback: e }), c("number", { delay: t }), this._hoverTimeout = setTimeout(e, t);
  }
  /**
   * Handles focus events throughout the menu for proper menu use.
   *
   * - Adds a `focus` listener to every menu item so when it gains focus,
   *   it will set the item's containing menu's focus state
   *   to "self".
   * - Adds a `focusout` listener to the menu so when the menu loses focus,
   *   it will close.
   *
   * @protected
   */
  _handleFocus() {
    this.elements.menuItems.forEach((e, t) => {
      e.dom.link.addEventListener("focus", () => {
        this.focusState = "self", this.currentChild = t;
      });
    }), this.dom.menu.addEventListener("focusout", (e) => {
      this.currentEvent !== "keyboard" || e.relatedTarget === null || this.dom.menu.contains(e.relatedTarget) || (this.focusState = "none", this.closeChildren());
    });
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds a `pointerdown` listener to every menu item that will blur
   *   all menu items in the entire menu structure (starting at the root menu) and
   *   then properly focus the clicked item.
   * - Adds a `pointerup` listener to every submenu item that will properly
   *   toggle the submenu open/closed.
   * - Adds a `pointerup` listener to the menu's controller
   *   (if the menu is the root menu) so when it is clicked it will properly
   *   toggle open/closed.
   *
   * @protected
   */
  _handleClick() {
    function e(t, s, n) {
      o(n), n.button === 0 && (s.toggle(), s.isOpen && (t.focusState = "self", s.elements.controlledMenu.focusState = "none"));
    }
    this.elements.menuItems.forEach((t, s) => {
      t.dom.link.addEventListener(
        "pointerdown",
        () => {
          this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this._clearTimeout(), this.focusChild(s);
        },
        { passive: !0 }
      ), t.isSubmenuItem && t.elements.toggle.dom.toggle.addEventListener(
        "pointerup",
        (n) => {
          this.currentEvent = "mouse", e(this, t.elements.toggle, n);
        }
      );
    }), this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.addEventListener(
      "pointerup",
      (t) => {
        this.currentEvent = "mouse", e(this, this.elements.controller, t);
      }
    ), document.addEventListener("pointerup", (t) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(t.target) && !this.dom.menu !== t.target && (this.elements.rootMenu.hasOpened = this.elements.submenuToggles.some(
        (s) => s.isOpen
      )));
    });
  }
  /**
   * Handles hover events throughout the menu for proper use.
   *
   * Adds `pointerenter` listeners to all menu items and `pointerleave` listeners
   * to all submenu items which function differently depending on
   * the menu's hover type.
   *
   * Before executing anything, the event is checked to make sure the event wasn't
   * triggered by a pen or touch.
   *
   * <strong>Hover Type "on"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *    current child value will change to that
   *   menu item.
   * - When a `pointerenter` event triggers on a submenu item the
   *   preview method for the submenu item's
   *   toggle will be called.
   * - When a `pointerleave` event triggers on an open submenu item the
   *   close method for the submenu item's toggle
   *   will be called after a delay set by the menu's hover delay.
   *
   * <strong>Hover Type "dynamic"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *   current child value will change to that menu item.
   * - When a `pointerenter` event triggers on any menu item, and the menu's
   *   focus state is not "none", the menu item
   *   will be focused.
   * - When a `pointerenter` event triggers on a submenu item, and a submenu is
   *   already open, the preview method for the submenu item's toggle will be called.
   * - When a `pointerenter` event triggers on a non-submenu item, and a submenu
   *   is already open, the closeChildren method for the menu will be called.
   * - When a `pointerenter` event triggers on a submenu item, and no submenu is
   *   open, no submenu-specific methods will be called.
   * - When a `pointerleave` event triggers on an open submenu item that is not a
   *   root-level submenu item the close method for the submenu item's toggle
   *   will be called and the submenu item will be focused after a delay set by
   *   the menu's hover delay.
   * - When a `pointerleave` event triggers on an open submenu item that is a
   *   root-level submenu item no submenu-specific methods will be called.
   *
   * <strong>Hover Type "off"</strong>
   * All `pointerenter` and `pointerleave` events are ignored.
   *
   * @protected
   */
  _handleHover() {
    this.elements.menuItems.forEach((e, t) => {
      e.dom.link.addEventListener("pointerenter", (s) => {
        s.pointerType === "pen" || s.pointerType === "touch" || (this.hoverType === "on" ? (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusChild(t), e.isSubmenuItem && (this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          e.elements.toggle.preview();
        }, this.enterDelay)) : e.elements.toggle.preview())) : this.hoverType === "dynamic" && (this.currentChild = t, (!this.isTopLevel || this.focusState !== "none") && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild()), (!this.isTopLevel || this.hasOpened) && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild(), e.isSubmenuItem ? this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          e.elements.toggle.preview();
        }, this.enterDelay)) : e.elements.toggle.preview() : this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.closeChildren();
        }, this.enterDelay)) : this.closeChildren())));
      }), e.isSubmenuItem && (e.dom.item.addEventListener("pointerleave", (s) => {
        s.pointerType === "pen" || s.pointerType === "touch" || (this.hoverType === "on" ? this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse", e.elements.toggle.close();
        }, this.leaveDelay)) : (this.currentEvent = "mouse", e.elements.toggle.close()) : this.hoverType === "dynamic" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse";
        }, this.leaveDelay)) : this.currentEvent = "mouse"));
      }), e.dom.item.addEventListener("pointerenter", (s) => {
        s.pointerType === "pen" || s.pointerType === "touch" || e.isSubmenuItem && (this.hoverType === "on" || this.hoverType === "dynamic") && this.leaveDelay > 0 && this._clearTimeout();
      }));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   *
   * - Adds a `keydown` listener to the menu's controller (if the menu is the root menu).
   *   - Blocks propagation on "Space", "Enter", and "Escape" keys.
   *
   * @protected
   */
  _handleKeydown() {
    this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.addEventListener(
      "keydown",
      (e) => {
        this.currentEvent = "keyboard";
        const t = _(e);
        (t === "Space" || t === "Enter") && o(e);
      }
    );
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * - Adds a `keyup` listener to the menu's controller (if the menu is the root menu).
   *   - Toggles the menu when the user hits "Space" or "Enter".
   *
   * @protected
   */
  _handleKeyup() {
    this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.addEventListener("keyup", (e) => {
      this.currentEvent = "keyboard";
      const t = _(e);
      (t === "Space" || t === "Enter") && (o(e), this.elements.controller.toggle(), this.elements.controller.isOpen && this.focusFirstChild());
    });
  }
  /**
   * Sets the transition durations of the menu as a CSS custom properties.
   *
   * The custom properties are:
   *   - `--am-transition-duration`,
   *   - `--am-open-transition-duration`, and
   *   - `--am-close-transition-duration`.
   *
   * The prefix of `am-` can be changed by setting the menu's prefix value.
   *
   * @protected
   */
  _setTransitionDurations() {
    this.dom.menu.style.setProperty(
      `--${this.prefix}transition-duration`,
      `${this.transitionDuration}ms`
    ), this.dom.menu.style.setProperty(
      `--${this.prefix}open-transition-duration`,
      `${this.openDuration}ms`
    ), this.dom.menu.style.setProperty(
      `--${this.prefix}close-transition-duration`,
      `${this.closeDuration}ms`
    );
  }
  /**
   * Focus the menu.
   *
   * Sets the menu's focus state to "self" and
   * focusses the menu if the menu's shouldFocus
   * value is `true`.
   *
   * @public
   */
  focus() {
    this.focusState = "self", this.shouldFocus && this.dom.menu.focus();
  }
  /**
   * Unfocus the menu.
   *
   * Sets the menu's focus state to "none"
   * and blurs the menu if the menu's shouldFocus
   * value is `true`.
   *
   * @public
   */
  blur() {
    this.focusState = "none", this.shouldFocus && this.dom.menu.blur();
  }
  /**
   * Focus the menu's current child.
   *
   * @public
   */
  focusCurrentChild() {
    this.focusState = "self", this.currentChild !== -1 && this.currentMenuItem.focus();
  }
  /**
   * Focuses the menu's child at a given index.
   *
   * @public
   *
   * @param {number} index - The index of the child to focus.
   */
  focusChild(e) {
    this.blurCurrentChild(), this.currentChild = e, this.focusCurrentChild();
  }
  /**
   * Focuses the menu's first child.
   *
   * @public
   */
  focusFirstChild() {
    this.focusChild(0);
  }
  /**
   * Focus the menu's last child.
   *
   * @public
   */
  focusLastChild() {
    this.focusChild(this.elements.menuItems.length - 1);
  }
  /**
   * Focus the menu's next child.
   *
   * @public
   */
  focusNextChild() {
    this.currentChild < this.elements.menuItems.length - 1 ? this.focusChild(this.currentChild + 1) : this.focusCurrentChild();
  }
  /**
   * Focus the menu's previous child.
   *
   * @public
   */
  focusPreviousChild() {
    this.currentChild > 0 ? this.focusChild(this.currentChild - 1) : this.focusCurrentChild();
  }
  /**
   * Blurs the menu's current child.
   *
   * @public
   */
  blurCurrentChild() {
    this.focusState = "none", this.currentChild !== -1 && this.currentMenuItem.blur();
  }
  /**
   * Focus the menu's controller.
   *
   * @public
   */
  focusController() {
    this.dom.controller && (this.shouldFocus && this.dom.controller.focus(), this.focusState = "none");
  }
  /**
   * Focus the menu's container.
   *
   * @public
   */
  focusContainer() {
    this.dom.container && (this.shouldFocus && this.dom.container.focus(), this.focusState = "none");
  }
  /**
   * Close all submenu children.
   *
   * @public
   */
  closeChildren() {
    this.elements.submenuToggles.forEach((e) => e.close());
  }
  /**
   * Blurs all children and submenu's children.
   *
   * @public
   */
  blurChildren() {
    this.elements.menuItems.forEach((e) => {
      e.blur(), e.isSubmenuItem && e.elements.childMenu.blurChildren();
    });
  }
}
class Z extends O {
  /**
   * Constructs a new `DisclosureMenuItem`.
   *
   * @param {object}                options                         - The options for generating the menu item.
   * @param {HTMLElement}           options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}           options.menuLinkElement         - The menu item's link in the DOM.
   * @param {DisclosureMenu}        options.parentMenu              - The parent menu.
   * @param {boolean}               [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?DisclosureMenu}       [options.childMenu = null]      - The child menu.
   * @param {?DisclosureMenuToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}               [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   */
  constructor({
    menuItemElement: e,
    menuLinkElement: t,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: l = null,
    initialize: h = !0
  }) {
    super({
      menuItemElement: e,
      menuLinkElement: t,
      parentMenu: s,
      isSubmenuItem: n,
      childMenu: i,
      toggle: l
    }), h && this.initialize();
  }
}
class Q extends L {
  /**
   * Constructs a new `DisclosureMenuToggle`.
   *
   * @param {object}          options                     - The options for generating the menu toggle.
   * @param {HTMLElement}     options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement}     options.parentElement       - The element containing the controlled menu.
   * @param {DisclosureMenu}  options.controlledMenu      - The menu controlled by this toggle.
   * @param {?DisclosureMenu} [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}         [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: e,
    parentElement: t,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: e,
      parentElement: t,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * Calls the BaseMenuToggle's _setAriaAttributes method.
   *
   * Ensures the toggle element has a `role` of "button" if it is not
   * already a button.
   *
   * Then using the toggle and menu's IDs, the toggle's `aria-controls`
   * is set to the menu's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    super._setAriaAttributes(), F("button", { toggle: this.dom.toggle }) || this.dom.toggle.setAttribute("role", "button"), this.dom.toggle.setAttribute(
      "aria-controls",
      this.elements.controlledMenu.dom.menu.id
    );
  }
  /**
   * Opens the controlled menu.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's open method.
   *
   * @public
   */
  open() {
    this.closeSiblings(), super.open();
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's preview method.
   *
   * @public
   */
  preview() {
    this.closeSiblings(), super.preview();
  }
  /**
   * Closes the controlled menu.
   *
   * Calls the  closeChildren method
   * and _then_ BaseMenuToggle's close method.
   *
   * @public
   */
  close() {
    this.isOpen && this.closeChildren(), super.close();
  }
}
class z extends w {
  /**
   * Constructs a new `DisclosureMenu`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = button]   - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {number}             [options.transitionDuration = 250]         - The duration of the transition between "open" and "closed" states (in milliseconds).
   * @param {boolean}            [options.openDuration = -1]                - The duration of the transition from "closed" to "open" states (in milliseconds).
   * @param {boolean}            [options.closeDuration = -1]               - The duration of the transition from "open" to "closed" states (in milliseconds).
   * @param {boolean}            [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?DisclosureMenu}    [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in milliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in milliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in milliseconds).
   * @param {boolean}            [options.optionalKeySupport = false]       - A flag to add optional keyboard support (Arrow keys, Home, and End) to the menu.
   * @param {?string}            [options.prefix = am-]                     - The prefix to use for CSS custom properties.
   * @param {boolean}            [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: t,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: l = "button",
    submenuSelector: h = "ul",
    controllerElement: m = null,
    containerElement: a = null,
    openClass: f = "show",
    closeClass: p = "hide",
    transitionClass: g = "transitioning",
    transitionDuration: d = 250,
    openDuration: M = -1,
    closeDuration: y = -1,
    isTopLevel: b = !0,
    parentMenu: C = null,
    hoverType: T = "off",
    hoverDelay: E = 250,
    enterDelay: I = -1,
    leaveDelay: v = -1,
    optionalKeySupport: K = !1,
    prefix: $ = "am-",
    initialize: V = !0
  }) {
    super({
      menuElement: t,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuToggleSelector: l,
      submenuSelector: h,
      controllerElement: m,
      containerElement: a,
      openClass: f,
      closeClass: p,
      transitionClass: g,
      transitionDuration: d,
      openDuration: M,
      closeDuration: y,
      isTopLevel: b,
      parentMenu: C,
      hoverType: T,
      hoverDelay: E,
      enterDelay: I,
      leaveDelay: v,
      prefix: $
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof DisclosureMenu}
     */
    u(this, "_MenuType", z);
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof DisclosureMenuItem}
     */
    u(this, "_MenuItemType", Z);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof DisclosureMenuToggle}
     */
    u(this, "_MenuToggleType", Q);
    /**
     * The index of the currently selected menu item in the menu.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_currentChild", -1);
    /**
     * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_optionalSupport", !1);
    this._optionalSupport = K, V && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup();
    } catch (t) {
      console.error(t);
    }
  }
  /**
   * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's optionalKeySupport.
   *
   * @type {boolean}
   *
   * @see _optionalSupport
   */
  get optionalKeySupport() {
    return this.isTopLevel ? this._optionalSupport : this.elements.rootMenu.optionalKeySupport;
  }
  set optionalKeySupport(t) {
    c("boolean", { optionalKeySupport: t }), this._optionalSupport = t;
  }
  /**
   * Validates all aspects of the menu to ensure proper functionality.
   *
   * @protected
   *
   * @return {boolean} - The result of the validation.
   */
  _validate() {
    let t = super._validate();
    const s = c("boolean", {
      optionalKeySupport: this._optionalSupport
    });
    return s.status || (this._errors.push(s.error.message), t = !1), t;
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds all event listeners listed in
   *   BaseMenu's _handleClick method.
   * - Adds a `pointerup` listener to the `document` so if the user
   *   clicks outside of the menu it will close if it is open.
   *
   * @protected
   */
  _handleClick() {
    super._handleClick(), document.addEventListener("pointerup", (t) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(t.target) && !this.dom.menu !== t.target && (this.closeChildren(), this.blur(), this.elements.controller && this.elements.controller.close(), this.elements.rootMenu.hasOpened = !1));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "Space", "Enter", and "Escape".
   *   - _If_ optional keyboard support
   *     is enabled, blocks propagation on the following keys:
   *     "ArrowUp", "ArrowRight", "ArrowDown", "ArrowLeft", "Home", and "End".
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t);
      if (this.focusState === "self") {
        const n = ["Space", "Enter"], i = ["Escape"], l = ["Escape"];
        this.optionalKeySupport ? [
          "ArrowUp",
          "ArrowRight",
          "ArrowDown",
          "ArrowLeft",
          "Home",
          "End"
        ].includes(s) && o(t) : (this.currentMenuItem.isSubmenuItem && n.includes(s) || this.elements.controller && i.includes(s) || this.elements.parentMenu && l.includes(s)) && o(t);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * WAI ARIA Practices Example Disclosure for Navigation Menus):
   *
   * | Key | Function |
   * | --- | --- |
   * | _Tab_ or _Shift + Tab_ | Move keyboard focus among top-level buttons, and if a dropdown is open, into and through links in the dropdown. |
   * | _Space_ or _Enter_ | <ul><li>If focus is on a disclosure button, activates the button, which toggles the visibility of the dropdown.</li><li>If focus is on a link:<ul><li>If any link has aria-current set, removes it.</li><li>Sets aria-current="page" on the focused link.</li><li>Activates the focused link.</li></ul></li></ul> |
   * | _Escape_ | If a dropdown is open, closes it and sets focus on the button that controls that dropdown. |
   * | _Down Arrow_ or _Right Arrow_ (Optional}) | <ul><li>If focus is on a button and its dropdown is collapsed, and it is not the last button, moves focus to the next button.</li><li>if focus is on a button and its dropdown is expanded, moves focus to the first link in the dropdown.</li><li>If focus is on a link, and it is not the last link, moves focus to the next link.</li></ul> |
   * | _Up Arrow_ or _Left Arrow_ (Optional}) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the previous button.</li><li>If focus is on a link, and it is not the first link, moves focus to the previous link.</li></ul> |
   * | _Home_ (Optional) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the first button.</li><li>If focus is on a link, and it is not the first link, moves focus to the first link.</li></ul> |
   * | _End_ (Optional) | <ul><li>If focus is on a button, and it is not the last button, moves focus to the last button.</li><li>If focus is on a link, and it is not the last link, moves focus to the last link.</li></ul> |
   *
   * The optional keybindings are controlled by the menu's optionalKeySupport value.
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t);
      this.focusState === "self" && (s === "Space" || s === "Enter" ? this.currentMenuItem.isSubmenuItem ? (o(t), this.currentMenuItem.elements.toggle.isOpen ? this.currentMenuItem.elements.toggle.close() : this.currentMenuItem.elements.toggle.preview()) : this.currentMenuItem.dom.link.click() : s === "Escape" ? this.elements.submenuToggles.some(
        (i) => i.isOpen
      ) ? (o(t), this.closeChildren()) : this.elements.parentMenu ? (o(t), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.closeChildren(), this.elements.parentMenu.focusCurrentChild()) : this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (this.elements.controller.close(), this.focusController()) : this.optionalKeySupport && (s === "ArrowDown" || s === "ArrowRight" ? (o(t), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.childMenu.focusFirstChild()) : this.focusNextChild()) : s === "ArrowUp" || s === "ArrowLeft" ? (o(t), this.focusPreviousChild()) : s === "Home" ? (o(t), this.focusFirstChild()) : s === "End" && (o(t), this.focusLastChild())));
    });
  }
}
class B extends O {
  /**
   * Constructs a new `MenubarItem`.
   *
   * @param {object}         options                         - The options for generating the menu item.
   * @param {HTMLElement}    options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}    options.menuLinkElement         - The menu item's link in the DOM.
   * @param {Menubar}        options.parentMenu              - The parent menu.
   * @param {boolean}        [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?Menubar}       [options.childMenu = null]      - The child menu.
   * @param {?MenubarToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}        [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   */
  constructor({
    menuItemElement: e,
    menuLinkElement: t,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: l = null,
    initialize: h = !0
  }) {
    super({
      menuItemElement: e,
      menuLinkElement: t,
      parentMenu: s,
      isSubmenuItem: n,
      childMenu: i,
      toggle: l
    }), h && this.initialize();
  }
  /**
   * Initialize the menu item.
   *
   * Initialize will call the BaseMenuItem's initialize method
   * as well as set the menu item's `role` to "none",
   * the menu link's `role` to "menuitem", and
   * the menu link's `tabIndex` to -1 in the DOM.
   */
  initialize() {
    super.initialize(), this.dom.item.setAttribute("role", "none"), this.dom.link.setAttribute("role", "menuitem"), this.dom.link.tabIndex = -1;
  }
  /**
   * Focuses the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's focus method
   * as well as set the menu link's `tabIndex` to 0 if the parent menu
   * is the root menu.
   *
   * @public
   */
  focus() {
    super.focus(), this.elements.parentMenu.isTopLevel && (this.dom.link.tabIndex = 0);
  }
  /**
   * Blurs the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's blur method
   * as well as set the menu link's `tabIndex` to -1 if the parent menu
   * is the root menu.
   *
   * @public
   */
  blur() {
    super.blur(), this.elements.parentMenu.isTopLevel && (this.dom.link.tabIndex = -1);
  }
}
class G extends L {
  /**
   * Constructs a new `MenubarToggle`.
   *
   * @param {object}      options                     - The options for generating the menu toggle.
   * @param {HTMLElement} options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement} options.parentElement       - The element containing the controlled menu.
   * @param {Menubar}     options.controlledMenu      - The menu controlled by this toggle.
   * @param {?Menubar}    [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}     [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: e,
    parentElement: t,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: e,
      parentElement: t,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * Calls the BaseMenuToggle's _setAriaAttributes method.
   *
   * Then sets the toggle's `aria-haspopup` attribute to "true".
   *
   * @protected
   */
  _setAriaAttributes() {
    super._setAriaAttributes(), this.dom.toggle.setAttribute("aria-haspopup", "true");
  }
  /**
   * Opens the controlled menu.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's open method.
   *
   * @public
   */
  open() {
    this.closeSiblings(), super.open();
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's preview method.
   *
   * @public
   */
  preview() {
    this.closeSiblings(), super.preview();
  }
  /**
   * Closes the controlled menu.
   *
   * Calls the  closeChildren method
   * and _then_ BaseMenuToggle's close method.
   *
   * @public
   */
  close() {
    this.isOpen && (this.closeChildren(), this.elements.parentMenu && this.elements.parentMenu.focusCurrentChild()), super.close();
  }
}
class H extends w {
  /**
   * Constructs a new `Menubar`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = a]        - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {number}             [options.transitionDuration = 250]         - The duration of the transition between "open" and "closed" states (in milliseconds).
   * @param {boolean}            [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?Menubar}           [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in milliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in milliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in milliseconds).
   * @param {?string}            [options.prefix = am-]                     - The prefix to use for CSS custom properties.
   * @param {boolean}            [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: t,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: l = "a",
    submenuSelector: h = "ul",
    controllerElement: m = null,
    containerElement: a = null,
    openClass: f = "show",
    closeClass: p = "hide",
    transitionClass: g = "transitioning",
    transitionDuration: d = 250,
    isTopLevel: M = !0,
    parentMenu: y = null,
    hoverType: b = "off",
    hoverDelay: C = 250,
    enterDelay: T = -1,
    leaveDelay: E = -1,
    prefix: I = "am-",
    initialize: v = !0
  }) {
    super({
      menuElement: t,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuToggleSelector: l,
      submenuSelector: h,
      controllerElement: m,
      containerElement: a,
      openClass: f,
      closeClass: p,
      transitionClass: g,
      transitionDuration: d,
      isTopLevel: M,
      parentMenu: y,
      hoverType: b,
      hoverDelay: C,
      enterDelay: T,
      leaveDelay: E,
      prefix: I
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof Menubar}
     */
    u(this, "_MenuType", H);
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof MenubarItem}
     */
    u(this, "_MenuItemType", B);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof MenubarToggle}
     */
    u(this, "_MenuToggleType", G);
    v && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call the BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * This will also set the menu's `role` to "menubar" in the DOM.
   *
   * If the menu is a root menu the first menu item's `tabIndex` will be set to
   * 0 in the DOM.
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this.isTopLevel ? this.dom.menu.setAttribute("role", "menubar") : this.dom.menu.setAttribute("role", "menu"), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup(), this.isTopLevel && (this.elements.menuItems[0].dom.link.tabIndex = 0, this.elements.controller && this.elements.controller.dom.toggle.removeAttribute("aria-haspopup"));
    } catch (t) {
      console.error(t);
    }
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds all event listeners listed in
   *   BaseMenu's _handleClick method.
   * - Adds a `pointerup` listener to the `document` so if the user
   *   clicks outside of the menu it will close if it is open.
   *
   * @protected
   */
  _handleClick() {
    super._handleClick(), document.addEventListener("pointerup", (t) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(t.target) && !this.dom.menu !== t.target && (this.closeChildren(), this.blur(), this.elements.controller && this.elements.controller.close(), this.elements.rootMenu.hasOpened = !1));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "ArrowUp", "ArrowRight",
   *     "ArrowDown", "ArrowLeft", "Home", "End", "Space", "Enter", "Escape",
   *     and "A" through "Z".
   *   - Completely closes the menu and moves focus out if the "Tab" key is pressed.
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t);
      if (s === "Tab" && (this.elements.rootMenu.focusState !== "none" ? (this.elements.rootMenu.blur(), this.elements.rootMenu.closeChildren()) : this.elements.rootMenu.focus()), s === "Character")
        o(t);
      else if (this.isTopLevel) {
        if (this.focusState === "self") {
          const n = ["ArrowRight", "ArrowLeft", "Home", "End"], i = ["Space", "Enter", "ArrowDown", "ArrowUp"], l = ["Escape"];
          (n.includes(s) || this.currentMenuItem.isSubmenuItem && i.includes(s) || this.elements.controller && l.includes(s)) && o(t);
        }
      } else {
        const n = [
          "Escape",
          "ArrowRight",
          "ArrowLeft",
          "ArrowDown",
          "ArrowUp",
          "Home",
          "End"
        ], i = ["Space", "Enter"];
        (n.includes(s) || this.currentMenuItem.isSubmenuItem && i.includes(s)) && o(t);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * Navigation Menubar Example):
   *
   * <strong>Menubar</strong>
   *
   * | Key | Function |
   * | --- | --- |
   * | _Space_ or _Enter_ | Opens submenu and moves focus to first item in the submenu. |
   * | _Right Arrow_ | <ul><li>Moves focus to the next item in the menubar.</li><li>If focus is on the last item, moves focus to the first item.</li></ul> |
   * | _Left Arrow_ | <ul><li>Moves focus to the previous item in the menubar.</li><li>If focus is on the first item, moves focus to the last item.</li></ul> |
   * | _Down Arrow_ | Opens submenu and moves focus to first item in the submenu. |
   * | _Up Arrow_ | Opens submenu and moves focus to last item in the submenu. |
   * | _Home_ | Moves focus to first item in the menubar. |
   * | _End_ | Moves focus to last item in the menubar. |
   * | _Character_ | <ul><li>Moves focus to next item in the menubar having a name that starts with the typed character.</li><li>If none of the items have a name starting with the typed character, focus does not move.</li></ul> |
   *
   * <strong>Submenu</strong>
   *
   * | Key | Function |
   * | --- | --- |
   * | _Space_ or _Enter_ | <ul><li>Activates menu item, causing the link to be activated.</li><li>NOTE: the links go to dummy pages; use the browser go-back function to return to this menubar example page.</li></ul> |
   * | _Escape_ | <ul><li>Closes submenu.</li><li>Moves focus to parent menubar item.</li></ul> |
   * | _Right Arrow_ | <ul><li>If focus is on an item with a submenu, opens the submenu and places focus on the first item.</li><li>If focus is on an item that does not have a submenu:<ul><li>Closes submenu.</li><li>Moves focus to next item in the menubar.</li><li>Opens submenu of newly focused menubar item, keeping focus on that parent menubar item.</li></ul></li></ul> |
   * | _Left Arrow_ | <ul><li>Closes submenu and moves focus to parent menu item.</li><li>If parent menu item is in the menubar, also:<ul><li>moves focus to previous item in the menubar.</li><li>Opens submenu of newly focused menubar item, keeping focus on that parent menubar item.</li></ul></li></ul> |
   * | _Down Arrow_ | <ul><li>Moves focus to the next item in the submenu.</li><li>If focus is on the last item, moves focus to the first item.</li></ul> |
   * | _Up Arrow_ | <ul><li>Moves focus to previous item in the submenu.</li><li>If focus is on the first item, moves focus to the last item.</li></ul> |
   * | Home | Moves focus to the first item in the submenu. |
   * | End | Moves focus to the last item in the submenu. |
   * | _Character_ | <ul><li>Moves focus to the next item having a name that starts with the typed character.</li><li>If none of the items have a name starting with the typed character, focus does not move.</li></ul> |
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t), { altKey: n, crtlKey: i, metaKey: l } = t;
      if (s === "Character" && !(n || i || l))
        o(t), this.elements.rootMenu.currentEvent = "character", this.focusNextChildWithCharacter(t.key);
      else if (this.isTopLevel) {
        if (this.focusState === "self")
          if (s === "Space" || s === "Enter")
            this.currentMenuItem.isSubmenuItem ? (o(t), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
              this.currentMenuItem.elements.childMenu.focusFirstChild();
            })) : this.currentMenuItem.dom.link.click();
          else if (s === "ArrowRight") {
            o(t);
            const m = this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen;
            this.focusNextChild(), m && (this.currentMenuItem.isSubmenuItem ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.preview()) : this.closeChildren());
          } else if (s === "ArrowLeft") {
            o(t);
            const m = this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen;
            this.focusPreviousChild(), m && (this.currentMenuItem.isSubmenuItem ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.preview()) : this.closeChildren());
          } else s === "ArrowDown" ? this.currentMenuItem.isSubmenuItem && (o(t), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
            this.currentMenuItem.elements.childMenu.focusFirstChild();
          })) : s === "ArrowUp" ? this.currentMenuItem.isSubmenuItem && (o(t), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
            this.currentMenuItem.elements.childMenu.focusLastChild();
          })) : s === "Home" ? (o(t), this.focusFirstChild()) : s === "End" ? (o(t), this.focusLastChild()) : s === "Escape" && (this.elements.submenuToggles.some(
            (a) => a.isOpen
          ) ? (o(t), this.closeChildren()) : this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (o(t), this.elements.controller.close(), this.focusController()));
      } else
        s === "Space" || s === "Enter" ? this.currentMenuItem.isSubmenuItem ? (o(t), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
          this.currentMenuItem.elements.childMenu.focusFirstChild();
        })) : this.currentMenuItem.dom.link.click() : s === "Escape" ? (o(t), this.elements.rootMenu.closeChildren(), this.elements.rootMenu.focusCurrentChild()) : s === "ArrowRight" ? this.currentMenuItem.isSubmenuItem ? (o(t), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
          this.currentMenuItem.elements.childMenu.focusFirstChild();
        })) : (o(t), this.elements.rootMenu.closeChildren(), this.elements.rootMenu.focusNextChild(), this.elements.rootMenu.currentMenuItem.isSubmenuItem && this.elements.rootMenu.currentMenuItem.elements.toggle.preview()) : s === "ArrowLeft" ? this.elements.parentMenu.currentMenuItem.isSubmenuItem && (o(t), this.elements.parentMenu.currentMenuItem.elements.toggle.close(), this.elements.parentMenu.focusCurrentChild(), this.elements.parentMenu === this.elements.rootMenu && (this.elements.rootMenu.closeChildren(), this.elements.rootMenu.focusPreviousChild(), this.elements.rootMenu.currentMenuItem.isSubmenuItem && (this.elements.rootMenu.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.elements.rootMenu.currentMenuItem.elements.toggle.preview()))) : s === "ArrowDown" ? (o(t), this.focusNextChild()) : s === "ArrowUp" ? (o(t), this.focusPreviousChild()) : s === "Home" ? (o(t), this.focusFirstChild()) : s === "End" && (o(t), this.focusLastChild());
    });
  }
  /**
   * Focus the menu's next child.
   *
   * If the currently focussed child in the menu is the last child then this will
   * focus the first child in the menu.
   *
   * @public
   */
  focusNextChild() {
    this.currentChild === this.elements.menuItems.length - 1 ? this.focusFirstChild() : this.focusChild(this.currentChild + 1);
  }
  /**
   * Focus the menu's previous child.
   *
   * If the currently focussed child in the menu is the first child then this will
   * focus the last child in the menu.
   *
   * @public
   */
  focusPreviousChild() {
    this.currentChild === 0 ? this.focusLastChild() : this.focusChild(this.currentChild - 1);
  }
  /**
   * Focus the menu's next child starting with a specific letter.
   *
   * @public
   *
   * @param {string} char - The character to look for.
   */
  focusNextChildWithCharacter(t) {
    const s = t.toLowerCase();
    let n = this.currentChild + 1, i = !1;
    for (; !i && n < this.elements.menuItems.length; ) {
      let l = "";
      this.elements.menuItems[n].dom.item.innerText ? l = this.elements.menuItems[n].dom.item.innerText : l = this.elements.menuItems[n].dom.item.textContent, l = l.replace(/[\s]/g, "").toLowerCase().charAt(0), l === s && (i = !0, this.focusChild(n)), n++;
    }
  }
}
class J extends O {
  /**
   * Constructs a new `TopLinkDisclosureMenuItem`.
   *
   * @param {object}                       options                         - The options for generating the menu item.
   * @param {HTMLElement}                  options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}                  options.menuLinkElement         - The menu item's link in the DOM.
   * @param {TopLinkDisclosureMenu}        options.parentMenu              - The parent menu.
   * @param {boolean}                      [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?TopLinkDisclosureMenu}       [options.childMenu = null]      - The child menu.
   * @param {?TopLinkDisclosureMenuToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}                      [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   * @param {?TopLinkDisclosureMenuItem}   [options.submenuSibling = null] - The sibling menu item that controls a submenu.
   */
  constructor({
    menuItemElement: t,
    menuLinkElement: s,
    parentMenu: n,
    isSubmenuItem: i = !1,
    childMenu: l = null,
    toggle: h = null,
    initialize: m = !0,
    submenuSibling: a = null
  }) {
    super({
      menuItemElement: t,
      menuLinkElement: s,
      parentMenu: n,
      isSubmenuItem: i,
      childMenu: l,
      toggle: h
    });
    /**
     * The declared accessible-menu elements within the menu item.
     *
     * @type {Object<TopLinkDisclosureMenu, TopLinkDisclosureMenuToggle>}
     *
     * @protected
     *
     * @property {TopLinkDisclosureMenu}                   parentMenu - The menu containing this menu item.
     * @property {?TopLinkDisclosureMenu}                  childMenu  - The menu contained within this menu item.
     * @property {?TopLinkDisclosureMenuToggle}            toggle     - The menu toggle within this menu item that controls the `childMenu`.
     * @property {?TopLinkDisclosureMenuItem}              sibling    - The sibling menu item that is a submenu item.
     */
    u(this, "_elements", {
      parentMenu: null,
      childMenu: null,
      toggle: null,
      sibling: null
    });
    this._elements.parentMenu = n, this._elements.childMenu = l, this._elements.toggle = h, this._elements.sibling = a, m && this.initialize();
  }
}
class X extends L {
  /**
   * Constructs a new `TopLinkDisclosureMenuToggle`.
   *
   * @param {object}                 options                     - The options for generating the menu toggle.
   * @param {HTMLElement}            options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement}            options.parentElement       - The element containing the controlled menu.
   * @param {TopLinkDisclosureMenu}  options.controlledMenu      - The menu controlled by this toggle.
   * @param {?TopLinkDisclosureMenu} [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}                [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: e,
    parentElement: t,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: e,
      parentElement: t,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * Calls the BaseMenuToggle's _setAriaAttributes method.
   *
   * Ensures the toggle element has a `role` of "button" if it is not
   * already a button.
   *
   * Then using the toggle and menu's IDs, the toggle's `aria-controls`
   * is set to the menu's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    super._setAriaAttributes(), F("button", { toggle: this.dom.toggle }) || this.dom.toggle.setAttribute("role", "button"), this.dom.toggle.setAttribute(
      "aria-controls",
      this.elements.controlledMenu.dom.menu.id
    );
  }
  /**
   * Opens the controlled menu.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's open method.
   */
  open() {
    this.closeSiblings(), super.open();
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's preview method.
   */
  preview() {
    this.closeSiblings(), super.preview();
  }
  /**
   * Closes the controlled menu.
   *
   * Calls the  closeChildren method
   * and _then_ BaseMenuToggle's close method.
   */
  close() {
    this.isOpen && this.closeChildren(), super.close();
  }
}
class q extends w {
  /**
   * Constructs a new `TopLinkDisclosureMenu`.
   *
   * @param {object}                 options                                    - The options for generating the menu.
   * @param {HTMLElement}            options.menuElement                        - The menu element in the DOM.
   * @param {string}                 [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}                 [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}                 [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}                 [options.submenuToggleSelector = button]   - The query selector string for submenu toggle buttons/links.
   * @param {string}                 [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {string}                 [options.submenuSubtoggleSelector = a]     - The query selector string for submenu toggle buttons/links below the top level.
   * @param {?HTMLElement}           [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}           [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])}     [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])}     [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])}     [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {number}                 [options.transitionDuration = 250]         - The duration of the transition between "open" and "closed" states (in milliseconds).
   * @param {boolean}                [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?TopLinkDisclosureMenu} [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}                 [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}                 [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in milliseconds).
   * @param {number}                 [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in milliseconds).
   * @param {number}                 [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in milliseconds).
   * @param {boolean}                [options.optionalKeySupport = false]       - A flag to add optional keyboard support (Arrow keys, Home, and End) to the menu.
   * @param {?string}                [options.prefix = am-]                     - The prefix to use for CSS custom properties.
   * @param {boolean}                [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: t,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: l = "button",
    submenuSelector: h = "ul",
    submenuSubtoggleSelector: m = "a",
    controllerElement: a = null,
    containerElement: f = null,
    openClass: p = "show",
    closeClass: g = "hide",
    transitionClass: d = "transitioning",
    transitionDuration: M = 250,
    isTopLevel: y = !0,
    parentMenu: b = null,
    hoverType: C = "off",
    hoverDelay: T = 250,
    enterDelay: E = -1,
    leaveDelay: I = -1,
    optionalKeySupport: v = !1,
    prefix: K = "am-",
    initialize: $ = !0
  }) {
    super({
      menuElement: t,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuSelector: h,
      submenuToggleSelector: l,
      controllerElement: a,
      containerElement: f,
      openClass: p,
      closeClass: g,
      transitionClass: d,
      transitionDuration: M,
      isTopLevel: y,
      parentMenu: b,
      hoverType: C,
      hoverDelay: T,
      enterDelay: E,
      leaveDelay: I,
      prefix: K
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof TopLinkDisclosureMenu}
     */
    u(this, "_MenuType", q);
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof TopLinkDisclosureMenuItem}
     */
    u(this, "_MenuItemType", J);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof TopLinkDisclosureMenuToggle}
     */
    u(this, "_MenuToggleType", X);
    /**
     * The index of the currently selected menu item in the menu.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_currentChild", -1);
    /**
     * The query selectors used by the menu to populate the dom.
     *
     * @protected
     *
     * @type {Object<string>}
     *
     * @property {string} menuItems         - The query selector for menu items.
     * @property {string} menuLinks         - The query selector for menu links.
     * @property {string} submenuItems      - The query selector for menu items containing submenus.
     * @property {string} submenuToggles    - The query selector for menu links that function as submenu toggles.
     * @property {string} submenus          - The query selector for for submenus.
     * @property {string} submenuSubtoggles - The query selector for menu links that function as submenu toggles below the top level.
     */
    u(this, "_selectors", {
      menuItems: "",
      menuLinks: "",
      submenuItems: "",
      submenuToggles: "",
      submenus: "",
      submenuSubtoggles: ""
    });
    /**
     * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_optionalSupport", !1);
    this._optionalSupport = v, this._selectors.menuItems = s, this._selectors.submenuItems = i, this._selectors.submenuToggles = l, this._selectors.submenus = h, this._selectors.submenuSubtoggles = m, this._selectors.menuLinks = [
      .../* @__PURE__ */ new Set([n, l])
    ].join(","), $ && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call the BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup();
    } catch (t) {
      console.error(t);
    }
  }
  /**
   * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's optionalKeySupport.
   *
   * @type {boolean}
   *
   * @see _optionalSupport
   */
  get optionalKeySupport() {
    return this.isTopLevel ? this._optionalSupport : this.elements.rootMenu.optionalKeySupport;
  }
  set optionalKeySupport(t) {
    c("boolean", { optionalKeySupport: t }), this._optionalSupport = t;
  }
  /**
   * Creates and initializes all menu items and submenus.
   *
   * @protected
   */
  _createChildElements() {
    this.dom.menuItems.forEach((t) => {
      let s, n;
      const i = t.querySelector(this.selectors.menuLinks);
      if (this.dom.submenuItems.includes(t)) {
        const l = t.querySelector(this.selectors.submenuToggles), h = t.querySelector(this.selectors.submenus), m = new this._MenuType({
          menuElement: h,
          menuItemSelector: this.selectors.menuItems,
          menuLinkSelector: this.selectors.menuLinks,
          submenuItemSelector: this.selectors.submenuItems,
          submenuToggleSelector: this.selectors.submenuSubtoggles,
          submenuSelector: this.selectors.submenus,
          submenuSubtoggleSelector: this.selectors.submenuSubtoggles,
          openClass: this.openClass,
          closeClass: this.closeClass,
          transitionClass: this.transitionClass,
          isTopLevel: !1,
          parentMenu: this,
          hoverType: this.hoverType,
          hoverDelay: this.hoverDelay,
          enterDelay: this.enterDelay,
          leaveDelay: this.leaveDelay
        }), a = new this._MenuToggleType({
          menuToggleElement: l,
          parentElement: t,
          controlledMenu: m,
          parentMenu: this
        });
        this._elements.submenuToggles.push(a), l !== i ? (n = new this._MenuItemType({
          menuItemElement: t,
          menuLinkElement: l,
          parentMenu: this,
          isSubmenuItem: !0,
          childMenu: m,
          toggle: a
        }), s = new this._MenuItemType({
          menuItemElement: t,
          menuLinkElement: i,
          parentMenu: this,
          submenuSibling: n
        })) : s = new this._MenuItemType({
          menuItemElement: t,
          menuLinkElement: i,
          parentMenu: this,
          isSubmenuItem: !0,
          childMenu: m,
          toggle: a
        });
      } else
        s = new this._MenuItemType({
          menuItemElement: t,
          menuLinkElement: i,
          parentMenu: this
        });
      this._elements.menuItems.push(s), typeof n < "u" && this._elements.menuItems.push(n);
    });
  }
  /**
   * Validates all aspects of the menu to ensure proper functionality.
   *
   * @protected
   *
   * @return {boolean} - The result of the validation.
   */
  _validate() {
    let t = super._validate();
    const s = x({
      submenuSubtoggleSelector: this._selectors.submenuSubtoggles
    });
    s.status || (this._errors.push(s.error.message), t = !1);
    const n = c("boolean", {
      optionalKeySupport: this._optionalSupport
    });
    return n.status || (this._errors.push(n.error.message), t = !1), t;
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds all event listeners listed in
   *   BaseMenu's _handleClick method, and
   * - adds a `pointerup` listener to the `document` so if the user
   *   clicks outside of the menu it will close if it is open.
   *
   * @protected
   */
  _handleClick() {
    super._handleClick(), document.addEventListener("pointerup", (t) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(t.target) && !this.dom.menu !== t.target && (this.closeChildren(), this.blur(), this.elements.controller && this.elements.controller.close(), this.elements.rootMenu.hasOpened = !1));
    });
  }
  /**
   * Handles hover events throughout the menu for proper use.
   *
   * Adds `pointerenter` listeners to all menu items and `pointerleave` listeners
   * to all submenu items which function differently depending on
   * the menu's hover type.
   *
   * Before executing anything, the event is checked to make sure the event wasn't
   * triggered by a pen or touch.
   *
   * <strong>Hover Type "on"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *    current child value will change to that
   *   menu item.
   * - When a `pointerenter` event triggers on a submenu item the
   *   preview method for the submenu item's
   *   toggle will be called.
   * - When a `pointerleave` event triggers on an open submenu item the
   *   close method for the submenu item's toggle
   *   will be called after a delay set by the menu's hover delay.
   *
   * <strong>Hover Type "dynamic"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *   current child value will change to that menu item.
   * - When a `pointerenter` event triggers on any menu item, and the menu's
   *   focus state is not "none", the menu item
   *   will be focused.
   * - When a `pointerenter` event triggers on a submenu item, and a submenu is
   *   already open, the preview method for the submenu item's toggle will be called.
   * - When a `pointerenter` event triggers on a non-submenu item, and a submenu
   *   is already open, the closeChildren method for the menu will be called.
   * - When a `pointerenter` event triggers on a submenu item, and no submenu is
   *   open, no submenu-specific methods will be called.
   * - When a `pointerleave` event triggers on an open submenu item that is not a
   *   root-level submenu item the close method for the submenu item's toggle
   *   will be called and the submenu item will be focused after a delay set by
   *   the menu's hover delay.
   * - When a `pointerleave` event triggers on an open submenu item that is a
   *   root-level submenu item no submenu-specific methods will be called.
   *
   * <strong>Hover Type "off"</strong>
   * All `pointerenter` and `pointerleave` events are ignored.
   *
   * @protected
   */
  _handleHover() {
    this.elements.menuItems.forEach((t, s) => {
      t.dom.link.addEventListener("pointerenter", (n) => {
        if (!(n.pointerType === "pen" || n.pointerType === "touch")) {
          if (this.hoverType === "on") {
            this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusChild(s);
            let i = t.isSubmenuItem ? t.elements.toggle : null;
            if (t.elements.sibling !== null && (i = t.elements.sibling.elements.toggle), i === null) return;
            this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
              i.preview();
            }, this.enterDelay)) : i.preview();
          } else if (this.hoverType === "dynamic" && (this.currentChild = s, (!this.isTopLevel || this.focusState !== "none") && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild()), !this.isTopLevel || this.hasOpened)) {
            this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild();
            let i = t.isSubmenuItem ? t.elements.toggle : null;
            t.elements.sibling !== null && (i = t.elements.sibling.elements.toggle), i !== null ? this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
              i.preview();
            }, this.enterDelay)) : i.preview() : this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
              this.closeChildren();
            }, this.enterDelay)) : this.closeChildren();
          }
        }
      }), t.isSubmenuItem && (t.dom.item.addEventListener("pointerleave", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || (this.hoverType === "on" ? this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse", t.elements.toggle.close();
        }, this.leaveDelay)) : (this.currentEvent = "mouse", t.elements.toggle.close()) : this.hoverType === "dynamic" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse";
        }, this.leaveDelay)) : this.currentEvent = "mouse"));
      }), t.dom.item.addEventListener("pointerenter", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || t.isSubmenuItem && (this.hoverType === "on" || this.hoverType === "dynamic") && this.leaveDelay > 0 && this._clearTimeout();
      }));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "Space", "Enter", and "Escape".
   *   - _If_ optional keyboard support
   *     is enabled, blocks propagation on the following keys:
   *     "ArrowUp", "ArrowRight", "ArrowDown", "ArrowLeft", "Home", and "End".
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t);
      if (this.focusState === "self") {
        const n = ["Space", "Enter"], i = ["Escape"], l = ["Escape"];
        this.optionalKeySupport ? [
          "ArrowUp",
          "ArrowRight",
          "ArrowDown",
          "ArrowLeft",
          "Home",
          "End"
        ].includes(s) && o(t) : (this.currentMenuItem.isSubmenuItem && n.includes(s) || this.elements.controller && i.includes(s) || this.elements.parentMenu && l.includes(s)) && o(t);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * WAI ARIA Practices Example Disclosure for Navigation Menus):
   *
   * | Key | Function |
   * | --- | --- |
   * | _Tab_ or _Shift + Tab_ | Move keyboard focus among top-level buttons, and if a dropdown is open, into and through links in the dropdown. |
   * | _Space_ or _Enter_ | <ul><li>If focus is on a disclosure button, activates the button, which toggles the visibility of the dropdown.</li><li>If focus is on a link:<ul><li>If any link has aria-current set, removes it.</li><li>Sets aria-current="page" on the focused link.</li><li>Activates the focused link.</li></ul></li></ul> |
   * | _Escape_ | If a dropdown is open, closes it and sets focus on the button that controls that dropdown. |
   * | _Down Arrow_ or _Right Arrow_ (Optional}) | <ul><li>If focus is on a button and its dropdown is collapsed, and it is not the last button, moves focus to the next button.</li><li>if focus is on a button and its dropdown is expanded, moves focus to the first link in the dropdown.</li><li>If focus is on a link, and it is not the last link, moves focus to the next link.</li></ul> |
   * | _Up Arrow_ or _Left Arrow_ (Optional}) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the previous button.</li><li>If focus is on a link, and it is not the first link, moves focus to the previous link.</li></ul> |
   * | _Home_ (Optional}) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the first button.</li><li>If focus is on a link, and it is not the first link, moves focus to the first link.</li></ul> |
   * | _End_ (Optional}) | <ul><li>If focus is on a button, and it is not the last button, moves focus to the last button.</li><li>If focus is on a link, and it is not the last link, moves focus to the last link.</li></ul> |
   *
   * The optional keybindings are controlled by the menu's optionalKeySupport value.
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t);
      this.focusState === "self" && (s === "Space" || s === "Enter" ? this.currentMenuItem.isSubmenuItem ? (o(t), this.currentMenuItem.elements.toggle.isOpen ? this.currentMenuItem.elements.toggle.close() : this.currentMenuItem.elements.toggle.preview()) : this.currentMenuItem.dom.link.click() : s === "Escape" ? this.elements.submenuToggles.some(
        (i) => i.isOpen
      ) ? (o(t), this.closeChildren()) : this.elements.parentMenu ? (o(t), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.closeChildren(), this.elements.parentMenu.focusCurrentChild()) : this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (this.elements.controller.close(), this.focusController()) : this.optionalKeySupport && (s === "ArrowDown" || s === "ArrowRight" ? (o(t), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.childMenu.focusFirstChild()) : this.focusNextChild()) : s === "ArrowUp" || s === "ArrowLeft" ? (o(t), this.focusPreviousChild()) : s === "Home" ? (o(t), this.focusFirstChild()) : s === "End" && (o(t), this.focusLastChild())));
    });
  }
}
class Y extends O {
  /**
   * Constructs a new `TreeviewItem`.
   *
   * @param {object}          options                         - The options for generating the menu item.
   * @param {HTMLElement}     options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}     options.menuLinkElement         - The menu item's link in the DOM.
   * @param {Treeview}        options.parentMenu              - The parent menu.
   * @param {boolean}         [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?Treeview}       [options.childMenu = null]      - The child menu.
   * @param {?TreeviewToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}         [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   */
  constructor({
    menuItemElement: e,
    menuLinkElement: t,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: l = null,
    initialize: h = !0
  }) {
    super({
      menuItemElement: e,
      menuLinkElement: t,
      parentMenu: s,
      isSubmenuItem: n,
      childMenu: i,
      toggle: l
    }), h && this.initialize();
  }
  /**
   * Initialize the menu item.
   *
   * Initialize will call the BaseMenuItem's initialize method
   * as well as set the menu item's `role` to "none",
   * the menu link's `role` to "treeitem", and
   * the menu link's `tabIndex` to -1 in the DOM.
   */
  initialize() {
    super.initialize(), this.dom.item.setAttribute("role", "none"), this.dom.link.setAttribute("role", "treeitem"), this.dom.link.tabIndex = -1;
  }
  /**
   * Focuses the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's focus method
   * as well as set the menu link's `tabIndex` to 0.
   */
  focus() {
    super.focus(), this.dom.link.tabIndex = 0;
  }
  /**
   * Blurs the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's blur method
   * as well as set the menu link's `tabIndex` to -1.
   */
  blur() {
    super.blur(), this.dom.link.tabIndex = -1;
  }
}
class ee extends L {
  /**
   * Constructs a new `TreeviewToggle`.
   *
   * @param {object}      options                     - The options for generating the menu toggle.
   * @param {HTMLElement} options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement} options.parentElement       - The element containing the controlled menu.
   * @param {Treeview}    options.controlledMenu      - The menu controlled by this toggle.
   * @param {?Treeview}   [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}     [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: e,
    parentElement: t,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: e,
      parentElement: t,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Initializes the menu toggle.
   *
   * The first steps are to ensure that the toggle and controlled menu have IDs
   * using the setIds method, and to set the ARIA attributes on the toggle
   * and controlled menu using the setAriaAttributes method.
   *
   * Then the open or collapse method is called based on the state of the
   * toggle's aria-expanded attribute.
   */
  initialize() {
    this._setIds(), this._setAriaAttributes(), this.dom.toggle.getAttribute("aria-expanded") === "true" ? this.open() : this._collapse(!1);
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * The first steps are to ensure that the toggle has `aria-expanded`
   * set to "false" if it's not already set explicitly to "true".
   *
   * Then using the toggle and menu's IDs, the menu's `aria-labelledby` is set to
   * the toggle's ID, and the toggle's `aria-owns` is set to the menu's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    this.dom.toggle.getAttribute("aria-expanded") !== "true" && this.dom.toggle.setAttribute("aria-expanded", "false"), this.elements.controlledMenu.dom.menu.setAttribute(
      "aria-labelledby",
      this.dom.toggle.id
    ), this.dom.toggle.setAttribute(
      "aria-owns",
      this.elements.controlledMenu.dom.menu.id
    );
  }
}
class j extends w {
  /**
   * Constructs a new `Treeview`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = a]        - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {number}             [options.transitionDuration = 250]         - The duration of the transition between "open" and "closed" states (in milliseconds).
   * @param {boolean}            [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?Treeview}          [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in milliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in milliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in milliseconds).
   * @param {?string}            [options.prefix = am-]                     - The prefix to use for CSS custom properties.
   * @param {boolean}            [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: t,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: l = "a",
    submenuSelector: h = "ul",
    controllerElement: m = null,
    containerElement: a = null,
    openClass: f = "show",
    closeClass: p = "hide",
    transitionClass: g = "transitioning",
    transitionDuration: d = 250,
    isTopLevel: M = !0,
    parentMenu: y = null,
    hoverType: b = "off",
    hoverDelay: C = 250,
    enterDelay: T = -1,
    leaveDelay: E = -1,
    prefix: I = "am-",
    initialize: v = !0
  }) {
    super({
      menuElement: t,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuToggleSelector: l,
      submenuSelector: h,
      controllerElement: m,
      containerElement: a,
      openClass: f,
      closeClass: p,
      transitionClass: g,
      transitionDuration: d,
      isTopLevel: M,
      parentMenu: y,
      hoverType: b,
      hoverDelay: C,
      enterDelay: T,
      leaveDelay: E,
      prefix: I
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof Treeview}
     */
    u(this, "_MenuType", j);
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof TreeviewItem}
     */
    u(this, "_MenuItemType", Y);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof TreeviewToggle}
     */
    u(this, "_MenuToggleType", ee);
    v && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call the BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * If the menu is a root menu it's `role` will be set to "tree" and the first
   * menu item's `tabIndex` will be set to 0 in the DOM.
   *
   * If the menu is _not_ a root menu it's `role` will be set to "group".
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this.isTopLevel ? (this.dom.menu.setAttribute("role", "tree"), this.elements.menuItems[0].dom.link.tabIndex = 0) : this.dom.menu.setAttribute("role", "group"), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup(), this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.removeAttribute("aria-owns");
    } catch (t) {
      console.error(t);
    }
  }
  /**
   * Handles hover events throughout the menu for proper use.
   *
   * Adds `pointerenter` listeners to all menu items and `pointerleave` listeners
   * to all submenu items which function differently depending on
   * the menu's hover type.
   *
   * Before executing anything, the event is checked to make sure the event wasn't
   * triggered by a pen or touch.
   *
   * <strong>Hover Type "on"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *    current child value will change to that
   *   menu item.
   * - When a `pointerenter` event triggers on a submenu item the
   *   preview method for the submenu item's
   *   toggle will be called.
   * - When a `pointerleave` event triggers on the menu itself the
   *   closeChildren method will be called after a delay
   *   set by the menu's hover delay.
   *
   * <strong>Hover Type "dynamic"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *   current child value will change to that menu item.
   * - When a `pointerenter` event triggers on any menu item, and the menu's
   *   focus state is not "none", the menu item
   *   will be focused.
   * - When a `pointerenter` event triggers on a submenu item, and a submenu is
   *   already open, the preview method for the submenu item's toggle will be called.
   * - When a `pointerenter` event triggers on a non-submenu item, and a submenu
   *   is already open, the closeChildren method for the menu will be called.
   * - When a `pointerenter` event triggers on a submenu item, and no submenu is
   *   open, no submenu-specific methods will be called.
   *
   * <strong>Hover Type "off"</strong>
   * All `pointerenter` and `pointerleave` events are ignored.
   *
   * @protected
   */
  _handleHover() {
    this.elements.menuItems.forEach((t, s) => {
      t.dom.link.addEventListener("pointerenter", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || (this.hoverType === "on" ? (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusChild(s), t.isSubmenuItem && (this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          t.elements.toggle.preview();
        }, this.enterDelay)) : t.elements.toggle.preview())) : this.hoverType === "dynamic" && (this.currentChild = s, (!this.isTopLevel || this.focusState !== "none") && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild()), (!this.isTopLevel || this.hasOpened) && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild(), t.isSubmenuItem ? this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          t.elements.toggle.preview();
        }, this.enterDelay)) : t.elements.toggle.preview() : this.enterDelay > 0 && this._clearTimeout())));
      }), t.isSubmenuItem && (t.dom.item.addEventListener("pointerleave", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || (this.hoverType === "on" ? this.leaveDelay > 0 && this._clearTimeout() : this.hoverType === "dynamic" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse";
        }, this.leaveDelay)) : this.currentEvent = "mouse"));
      }), t.dom.item.addEventListener("pointerenter", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || t.isSubmenuItem && (this.hoverType === "on" || this.hoverType === "dynamic") && this.leaveDelay > 0 && this._clearTimeout();
      })), this.isTopLevel && this.dom.menu.addEventListener("pointerleave", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || this.hoverType === "on" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.closeChildren(), this.blur();
        }, this.leaveDelay)) : (this.closeChildren(), this.blur()));
      });
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "ArrowUp", "ArrowRight",
   *     "ArrowDown", "ArrowLeft", "Home", "End", "Space", "Enter", "Escape",
   *     "*" (asterisk), and "A" through "Z".
   *   - Moves focus out if the "Tab" key is pressed.
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t);
      if (s === "Tab" && (this.elements.rootMenu.focusState !== "none" ? this.elements.rootMenu.blur() : this.elements.rootMenu.focus()), this.focusState === "self") {
        const n = [
          "Space",
          "ArrowUp",
          "ArrowDown",
          "ArrowLeft",
          "Asterisk",
          "Home",
          "End"
        ], i = ["Enter", "ArrowRight"], l = ["Escape"];
        (n.includes(s) || this.currentMenuItem.isSubmenuItem && i.includes(s) || this.elements.controller && l.includes(s)) && o(t);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * Navigation Treeview Example Using Computed Properties):
   *
   * | Key | Function |
   * | --- | --- |
   * | _Enter_ or _Space_ | Performs the default action (e.g. onclick event) for the focused node. |
   * | _Down arrow_ | <ul><li>Moves focus to the next node that is focusable without opening or closing a node.</li><li>If focus is on the last node, does nothing.</li></ul> |
   * | _Up arrow_ | <ul><li>Moves focus to the previous node that is focusable without opening or closing a node.</li><li>If focus is on the first node, does nothing.</li></ul> |
   * | _Right arrow_ | <ul><li>When focus is on a closed node, opens the node; focus does not move.</li><li>When focus is on a open node, moves focus to the first child node.</li><li>When focus is on an end node, does nothing.</li></ul> |
   * | _Left arrow_ | <ul><li>When focus is on an open node, closes the node.</li><li>When focus is on a child node that is also either an end node or a closed node, moves focus to its parent node.</li><li>When focus is on a root node that is also either an end node or a closed node, does nothing.</li></ul> |
   * | _Home_ | Moves focus to first node without opening or closing a node. |
   * | _End_ | Moves focus to the last node that can be focused without expanding any nodes that are closed. |
   * | _a-z_, _A-Z_ | <ul><li>Focus moves to the next node with a name that starts with the typed character.</li><li>Search wraps to first node if a matching name is not found among the nodes that follow the focused node.</li><li>Search ignores nodes that are descendants of closed nodes.</li></ul> |
   * | _* (asterisk)_ | <ul><li>Expands all closed sibling nodes that are at the same level as the focused node.</li><li>Focus does not move.</li></ul> |
   * | _Escape_ | If the root menu is collapsible, collapses the menu and focuses the menu's controlling element. |
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (t) => {
      this.currentEvent = "keyboard";
      const s = _(t), { altKey: n, crtlKey: i, metaKey: l } = t;
      if (s === "Character" && !(n || i || l))
        o(t), this.elements.rootMenu.currentEvent = "character", this.focusNextNodeWithCharacter(t.key);
      else if (this.focusState === "self")
        if (s === "Enter" || s === "Space")
          o(t), this.currentMenuItem.isSubmenuItem ? this.currentMenuItem.elements.toggle.isOpen ? this.currentMenuItem.elements.toggle.close() : this.currentMenuItem.elements.toggle.preview() : this.currentMenuItem.dom.link.click();
        else if (s === "Escape")
          this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (this.elements.controller.close(), this.focusController());
        else if (s === "ArrowDown")
          o(t), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.blurCurrentChild(), this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.currentMenuItem.elements.childMenu.focusFirstChild()) : !this.isTopLevel && this.currentChild === this.elements.menuItems.length - 1 ? this.focusParentsNextChild() : this.focusNextChild();
        else if (s === "ArrowUp") {
          o(t);
          const m = this.elements.menuItems[this.currentChild - 1];
          m && m.isSubmenuItem && m.elements.toggle.isOpen ? (this.blurCurrentChild(), this.currentChild = this.currentChild - 1, this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.focusChildsLastNode()) : !this.isTopLevel && this.currentChild === 0 ? (this.blurCurrentChild(), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.focusCurrentChild()) : this.focusPreviousChild();
        } else s === "ArrowRight" ? this.currentMenuItem.isSubmenuItem && (o(t), this.currentMenuItem.elements.toggle.isOpen ? (this.blurCurrentChild(), this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.currentMenuItem.elements.childMenu.focusFirstChild()) : this.currentMenuItem.elements.toggle.preview()) : s === "ArrowLeft" ? (o(t), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.currentMenuItem.elements.childMenu.blurCurrentChild(), this.currentMenuItem.elements.toggle.close()) : this.isTopLevel || (this.blurCurrentChild(), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.focusCurrentChild())) : s === "Home" ? (o(t), this.blurCurrentChild(), this.elements.rootMenu.focusFirstChild()) : s === "End" ? (o(t), this.blurCurrentChild(), this.elements.rootMenu.focusLastNode()) : s === "Asterisk" && (o(t), this.openChildren());
    });
  }
  /**
   * Focus the menu's last node of the entire expanded menu.
   *
   * This includes all _open_ child menu items.
   *
   * @public
   */
  focusLastNode() {
    const t = this.elements.menuItems.length - 1, s = this.elements.menuItems[t];
    s.isSubmenuItem && s.elements.toggle.isOpen ? (this.currentChild = t, s.elements.childMenu.currentEvent = this.currentEvent, s.elements.childMenu.focusLastNode()) : this.focusLastChild();
  }
  /**
   * Open all submenu children.
   *
   * @public
   */
  openChildren() {
    this.elements.submenuToggles.forEach((t) => t.preview());
  }
  /**
   * Focus the menu's next node starting with a specific letter.
   *
   * This includes all _open_ child menu items.
   *
   * Wraps to the first node if no match is found after the current node.
   *
   * @public
   *
   * @param {string} char - The character to look for.
   */
  focusNextNodeWithCharacter(t) {
    function s(f) {
      let p = [];
      return f.elements.menuItems.forEach((g) => {
        p.push(g), g.isSubmenuItem && g.elements.toggle.isOpen && (p = [
          ...p,
          ...s(
            g.elements.toggle.elements.controlledMenu
          )
        ]);
      }), p;
    }
    const n = t.toLowerCase(), i = s(this.elements.rootMenu), l = i.indexOf(this.currentMenuItem) + 1, h = [
      ...i.slice(l),
      ...i.slice(0, l)
    ];
    let m = 0, a = !1;
    for (; !a && m < h.length; ) {
      let f = "";
      if (h[m].dom.item.innerText ? f = h[m].dom.item.innerText : f = h[m].dom.item.textContent, f = f.replace(/[\s]/g, "").toLowerCase().charAt(0), f === n) {
        a = !0;
        const p = h[m].elements.parentMenu, g = p.elements.menuItems.indexOf(h[m]);
        this.elements.rootMenu.blurChildren(), p.focusChild(g);
      }
      m++;
    }
  }
  /**
   * Focus the parent menu's next child.
   *
   * This will cascade up through to the root menu.
   *
   * @public
   */
  focusParentsNextChild() {
    this.elements.parentMenu && (this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.currentChild === this.elements.parentMenu.elements.menuItems.length - 1 ? (this.elements.parentMenu.blurCurrentChild(), this.elements.parentMenu.focusParentsNextChild()) : (this.blurChildren(), this.elements.parentMenu.focusNextChild()));
  }
  /**
   * Focus the last child of the current child's submenu.
   *
   * This will cascade down through to the last open menu.
   *
   * @public
   */
  focusChildsLastNode() {
    this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.currentMenuItem.elements.childMenu.focusLastChild(), this.currentMenuItem.elements.childMenu.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.childMenu.currentMenuItem.elements.toggle.isOpen && (this.currentMenuItem.elements.childMenu.blurCurrentChild(), this.currentMenuItem.elements.childMenu.focusChildsLastNode());
  }
}
const se = {
  DisclosureMenu: z,
  Menubar: H,
  TopLinkDisclosureMenu: q,
  Treeview: j
};



/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	!function() {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = function(module) {
/******/ 			var getter = module && module.__esModule ?
/******/ 				function() { return module['default']; } :
/******/ 				function() { return module; };
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
!function() {
"use strict";
/*!***************************************!*\
  !*** ./core-bundle/assets/backend.js ***!
  \***************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hotwired/stimulus-webpack-helpers */ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js");
/* harmony import */ var _hotwired_turbo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @hotwired/turbo */ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js");
/* harmony import */ var _web_auth_webauthn_stimulus__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @web-auth/webauthn-stimulus */ "./vendor/web-auth/webauthn-stimulus/assets/dist/controller.js");
/* harmony import */ var _scripts_mootao_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./scripts/mootao.js */ "./core-bundle/assets/scripts/mootao.js");
/* harmony import */ var _scripts_mootao_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_scripts_mootao_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _scripts_core_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./scripts/core.js */ "./core-bundle/assets/scripts/core.js");
/* harmony import */ var _scripts_core_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_scripts_core_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./scripts/limit-height.js */ "./core-bundle/assets/scripts/limit-height.js");
/* harmony import */ var _scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scripts/modulewizard.js */ "./core-bundle/assets/scripts/modulewizard.js");
/* harmony import */ var _scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./scripts/sectionwizard.js */ "./core-bundle/assets/scripts/sectionwizard.js");
/* harmony import */ var _scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _styles_backend_pcss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./styles/backend.pcss */ "./core-bundle/assets/styles/backend.pcss");











// Start the Stimulus application
const application = _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Application.start();
application.debug = "development" === 'development';

// Register all controllers with `contao--` prefix
const context = __webpack_require__("./core-bundle/assets/controllers sync recursive \\.js$");
application.load(context.keys().map(key => {
  const identifier = (0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.identifierForContextKey)(key);
  if (identifier) {
    return (0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.definitionForModuleAndIdentifier)(context(key), `contao--${identifier}`);
  }
}).filter(value => value));
application.register('contao--webauthn', _web_auth_webauthn_stimulus__WEBPACK_IMPORTED_MODULE_3__["default"]);

// Cancel all prefetch requests that contain a request token or are related to
// the Symfony toolbar
document.documentElement.addEventListener('turbo:before-prefetch', e => {
  console.debug(e.target, e.target.search);
  if (e.target.search && new URLSearchParams(e.target.search).has('rt') || e.target.classList.contains('header_back') || e.target.closest('.sf-toolbar') !== null || e.target.matches('[onclick^="Backend.openModalIframe("]')) {
    e.preventDefault();
  }
});

// Make the MooTools scripts reinitialize themselves
const mooDomready = () => {
  if (!document.body.mooDomreadyFired) {
    document.body.mooDomreadyFired = true;
    if (Element.Events.removeEvents) {
      Element.Events.removeEvents();
    }
    window.fireEvent('domready');
  }
};
document.documentElement.addEventListener('turbo:render', mooDomready);
document.documentElement.addEventListener('turbo:frame-render', mooDomready);

// Always break out of a missing frame (#7501)
document.documentElement.addEventListener('turbo:frame-missing', e => {
  if (window.console) {
    console.warn('Turbo frame #' + e.target.id + ' is missing.');
  }

  // Do not break out of frames that load their content via src
  if (e.target.hasAttribute('src')) {
    return;
  }
  e.preventDefault();
  e.detail.visit(e.detail.response);
});

// Call the beforeCache() function on all controllers implementing it. This
// allows controllers to tear down things before the page gets put into cache.
// Note that Stimulus' disconnect() function will not fire at this point and
// thus cannot be used for this task.
document.documentElement.addEventListener('turbo:before-cache', e => {
  application.controllers.forEach(controller => {
    if ('function' === typeof controller.beforeCache) {
      controller.beforeCache(e);
    }
  });

  // Remove the Symfony toolbar
  e.target.querySelector('.sf-toolbar')?.remove();
});
}();
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtQkFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixXQUFXO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsMkNBQTJDO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msd0NBQXdDO0FBQzVFO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVGQUF1RixZQUFZO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMERBQTBEO0FBQzFELG9CQUFvQixrQ0FBa0M7QUFDdEQscUNBQXFDLGlDQUFpQztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q3ZLLHVCQUF1QixlQUFlO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsK0JBQStCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtDQUFrQyxpRUFBaUUsSUFBSTtBQUNqSSxpQ0FBaUMsT0FBTyxHQUFHLFVBQVU7QUFDckQsOENBQThDLDZCQUE2QjtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNk47Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2xnRjdOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLGNBQWM7QUFDN0I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsK0JBQStCLDZCQUE2QixJQUFJO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBLHNCQUFzQixZQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtREFBbUQsWUFBWTtBQUMvRCxvREFBb0QsWUFBWTtBQUNoRTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QyxLQUFLO0FBQ25EOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGlCQUFpQjtBQUM3QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUVBQXVFO0FBQ3ZFOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsZ0RBQWdEO0FBQ2hELDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix3QkFBd0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGVBQWU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSx5QkFBeUI7QUFDekI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLFlBQVksMEJBQTBCO0FBQ3RDOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksb0JBQW9CO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVEQUF1RCxPQUFPLGNBQWMsT0FBTztBQUNuRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGNBQWMsS0FBSztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdDQUFnQyxHQUFHO0FBQ25DOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTiw4QkFBOEIsWUFBWTtBQUMxQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFCQUFxQixNQUFNO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEIsWUFBWTtBQUN4Qzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxZQUFZLDZEQUE2RDs7QUFFekU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtRUFBbUUsbUJBQW1CO0FBQ3RGOztBQUVBLDZDQUE2QyxZQUFZO0FBQ3pEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxxRUFBcUUsWUFBWTtBQUNqRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRixpQkFBaUI7QUFDbEc7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlDQUFpQyxpQkFBaUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx1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RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFF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QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0JBQXdCLDZCQUE2QjtBQUNyRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxtREFBbUQsS0FBSztBQUN4RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYyxhQUFhO0FBQzNCO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGNBQWMsMkJBQTJCO0FBQ3pDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxZQUFZLHlCQUF5QjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQSw0QkFBNEIsa0RBQWtEO0FBQzlFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVkseUJBQXlCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTiw0QkFBNEIsa0RBQWtEO0FBQzlFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSxpQkFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLGdCQUFnQjs7QUFFL0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLHlCQUF5QixzRUFBc0UsZUFBZTtBQUM3SDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsR0FBRztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGNBQWMsUUFBUTtBQUN0QjtBQUNBO0FBQ0EsZ0JBQWdCLDBDQUEwQztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDRFQUE0RSxZQUFZO0FBQ3hGLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9EQUFvRCxnQ0FBZ0M7QUFDcEY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0IseUJBQXlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVkseUJBQXlCO0FBQ3JDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksYUFBYTtBQUN6QjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDBCQUEwQiw4Q0FBOEM7QUFDeEU7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLFVBQVU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksS0FBSzs7QUFFakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxnREFBZ0QsT0FBTztBQUN2RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVksd0JBQXdCOztBQUVwQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSxrQkFBa0I7QUFDOUIsWUFBWSxPQUFPOztBQUVuQjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBLDhCQUE4QixVQUFVLDhCQUE4QjtBQUN0RTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUNBQWlDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEs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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxRQUFRLGdDQUFnQzs7QUFFeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGVBQWU7O0FBRTNCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGVBQWU7QUFDM0I7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsMEJBQTBCLGFBQWE7QUFDdkM7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDJCQUEyQixhQUFhO0FBQ3hDO0FBQ0E7O0FBRUE7O0FBRUEsMEJBQTBCLG1CQUFtQjtBQUM3QztBQUNBO0FBQ0EsZ0JBQWdCLHNCQUFzQjtBQUN0QztBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixNQUFNOztBQUVOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsMkJBQTJCLFNBQVM7QUFDcEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxjQUFjLHNCQUFzQjs7QUFFcEM7QUFDQTtBQUNBLGtCQUFrQix5QkFBeUI7QUFDM0M7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQXVCLHlCQUF5QiwwQkFBMEIsZ0JBQWdCO0FBQzFGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQixpQkFBaUI7QUFDakM7QUFDQSxLQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxxQ0FBcUMseUJBQXlCLGtEQUFrRCxnQkFBZ0I7QUFDaEk7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLG1DQUFtQzs7QUFFL0MscUNBQXFDLFlBQVksd0NBQXdDO0FBQ3pGOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVFQUF1RSxHQUFHO0FBQzFFO0FBQ0E7QUFDQTs7QUFFQSxxRkFBcUYsR0FBRztBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELFdBQVc7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsRUFBRTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBLGtCQUFrQixlQUFlO0FBQ2pDLGtCQUFrQixlQUFlO0FBQ2pDLGtCQUFrQixlQUFlO0FBQ2pDLGtCQUFrQixlQUFlO0FBQ2pDLGtCQUFrQixlQUFlO0FBQ2pDLGtCQUFrQixlQUFlO0FBQ2pDLGtCQUFrQixlQUFlO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0Esa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBLGtCQUFrQixrQkFBa0I7QUFDcEMsa0JBQWtCLGtCQUFrQjtBQUNwQyxrQkFBa0Isa0JBQWtCO0FBQ3BDLGtCQUFrQixrQkFBa0I7QUFDcEMsa0JBQWtCLGtCQUFrQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxjQUFjO0FBQ3RCO0FBQ0E7QUFDQSxRQUFRLGVBQWU7QUFDdkI7QUFDQTtBQUNBLFFBQVEsb0JBQW9CO0FBQzVCO0FBQ0E7QUFDQSxrQkFBa0IsVUFBVTtBQUM1QjtBQUNBO0FBQ0Esa0JBQWtCLFVBQVU7QUFDNUI7QUFDQTtBQUNBLGtCQUFrQixVQUFVO0FBQzVCO0FBQ0E7QUFDQSxrQkFBa0IsVUFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQSxlQUFlLDJEQUEyRDtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxVQUFVO0FBQ2xCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxRQUFRLFVBQVU7QUFDbEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFFBQVEsVUFBVTtBQUNsQjtBQUNBO0FBQ0Esa0JBQWtCLFVBQVU7QUFDNUI7QUFDQTtBQUNBLGtCQUFrQixVQUFVO0FBQzVCO0FBQ0E7QUFDQSxrQkFBa0IsVUFBVTtBQUM1QjtBQUNBO0FBQ0Esa0JBQWtCLFVBQVU7QUFDNUI7QUFDQTtBQUNBLG1CQUFtQixVQUFVO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsU0FBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLG9CQUFvQiw0QkFBNEI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSw2QkFBNkIsd0JBQXdCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0Esa0JBQWtCLDRCQUE0QjtBQUM5QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDRCQUE0QixzQkFBc0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxFQUFFO0FBQ3BDO0FBQ0EsOENBQThDLFNBQVM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsNEJBQTRCLEVBQUU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsRUFBRTtBQUNwQztBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsNEJBQTRCLEVBQUU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxVQUFVO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsVUFBVTtBQUN2QixhQUFhLFVBQVU7QUFDdkI7QUFDQTtBQUNBLG9CQUFvQixhQUFhLGlCQUFpQixVQUFVO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsWUFBWTtBQUN2QixTQUFTLHdCQUF3QjtBQUNqQztBQUNBLFdBQVcsWUFBWTtBQUN2QixTQUFTLGtCQUFrQjtBQUMzQjtBQUNBLFdBQVcsWUFBWTtBQUN2QixTQUFTLG1CQUFtQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHlCQUF5QjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHVCQUF1QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFNBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCLGFBQWEsZ0JBQWdCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNJQUFzSTtBQUN0STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9DQUFvQztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQSxXQUFXO0FBQ1g7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMENBQTBDO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDLGFBQWEsOEJBQThCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IseUNBQXlDO0FBQzNELGtCQUFrQix5Q0FBeUM7QUFDM0Qsa0JBQWtCLHlDQUF5QztBQUMzRCxrQkFBa0IseUNBQXlDO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsd0JBQXdCO0FBQ3JDLGFBQWEsd0JBQXdCO0FBQ3JDLGFBQWEsd0JBQXdCO0FBQ3JDLGFBQWEsd0JBQXdCO0FBQ3JDLGFBQWEsd0JBQXdCO0FBQ3JDLGFBQWEsd0JBQXdCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHlCQUF5QjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQyxhQUFhLHdCQUF3QjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0Esa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUIsa0JBQWtCLFFBQVE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFNBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQyw0Q0FBNEM7QUFDNUMsd0JBQXdCO0FBQ3hCLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUIsYUFBYSxpQkFBaUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Q0FBQyxJQUFLO0VBQ3BFLElBQUl2RCxNQUFNLENBQUNnTCxPQUFPLEVBQUU7SUFDaEJBLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLGVBQWUsR0FBQzFILENBQUMsQ0FBQ21CLE1BQU0sQ0FBQ3hGLEVBQUUsR0FBQyxjQUFjLENBQUM7RUFDNUQ7O0VBRUE7RUFDQSxJQUFJcUUsQ0FBQyxDQUFDbUIsTUFBTSxDQUFDb2EsWUFBWSxDQUFDLEtBQUssQ0FBQyxFQUFFO0lBQzlCO0VBQ0o7RUFFQXZiLENBQUMsQ0FBQ1UsY0FBYyxDQUFDLENBQUM7RUFDbEJWLENBQUMsQ0FBQ3RDLE1BQU0sQ0FBQzBLLEtBQUssQ0FBQ3BJLENBQUMsQ0FBQ3RDLE1BQU0sQ0FBQzJaLFFBQVEsQ0FBQztBQUNyQyxDQUFDLENBQUM7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTViLFFBQVEsQ0FBQ21LLGVBQWUsQ0FBQzNJLGdCQUFnQixDQUFDLG9CQUFvQixFQUFHK0MsQ0FBQyxJQUFLO0VBQ25Fc1IsV0FBVyxDQUFDdXZCLFdBQVcsQ0FBQ3ovQixPQUFPLENBQUNrRyxVQUFVLElBQUk7SUFDMUMsSUFBSSxVQUFVLEtBQUssT0FBT0EsVUFBVSxDQUFDaEssV0FBVyxFQUFFO01BQzlDZ0ssVUFBVSxDQUFDaEssV0FBVyxDQUFDMEMsQ0FBQyxDQUFDO0lBQzdCO0VBQ0osQ0FBQyxDQUFDOztFQUVGO0VBQ0FBLENBQUMsQ0FBQ21CLE1BQU0sQ0FBQzRCLGFBQWEsQ0FBQyxhQUFhLENBQUMsRUFBRTFGLE1BQU0sQ0FBQyxDQUFDO0FBQ25ELENBQUMsQ0FBQyxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzLyBzeW5jIFxcLmpzJCIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGhvdHdpcmVkL3N0aW11bHVzLXdlYnBhY2staGVscGVycy9kaXN0L3N0aW11bHVzLXdlYnBhY2staGVscGVycy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGhvdHdpcmVkL3N0aW11bHVzL2Rpc3Qvc3RpbXVsdXMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0Bob3R3aXJlZC90dXJiby9kaXN0L3R1cmJvLmVzMjAxNy1lc20uanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1vbndlcC9waWNrci9kaXN0L3BpY2tyLm1pbi5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvYWNlLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2JhY2tlbmQtc2VhcmNoLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2Nob2ljZXMtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY2xpcGJvYXJkLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2NvbG9yLXBpY2tlci1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9jb2xvci1zY2hlbWUtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvZGVlcGxpbmstY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvaW1hZ2Utc2l6ZS1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9qdW1wLXRhcmdldHMtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvbGltaXQtaGVpZ2h0LWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL21ldGF3aXphcmQtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvb3BlcmF0aW9ucy1tZW51LWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Bhc3NrZXlzLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Byb2ZpbGUtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90YWJzLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RlbXBsYXRlLXN0dWRpby1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90aW55bWNlLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RvZ2dsZS1maWVsZHNldC1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b2dnbGUtbmF2aWdhdGlvbi1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b2dnbGUtbm9kZXMtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9vbHRpcHMtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvd2ViYXV0aG4tZXJyb3ItY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvbW9kdWxlcy90d2lnLWVkaXRvci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvc2NyaXB0cy9jb3JlLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9zY3JpcHRzL2xpbWl0LWhlaWdodC5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvc2NyaXB0cy9tb2R1bGV3aXphcmQuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL3NjcmlwdHMvbW9vdGFvLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9zY3JpcHRzL3NlY3Rpb253aXphcmQuanMiLCJ3ZWJwYWNrOi8vLy4vdmVuZG9yL3dlYi1hdXRoL3dlYmF1dGhuLXN0aW11bHVzL2Fzc2V0cy9kaXN0L2NvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL3N0eWxlcy9iYWNrZW5kLnBjc3MiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9oZWxwZXJzL2Jhc2U2NFVSTFN0cmluZ1RvQnVmZmVyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9Ac2ltcGxld2ViYXV0aG4vYnJvd3Nlci9lc20vaGVscGVycy9icm93c2VyU3VwcG9ydHNXZWJBdXRobi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZXNtL2hlbHBlcnMvYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZXNtL2hlbHBlcnMvYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9oZWxwZXJzL2lkZW50aWZ5QXV0aGVudGljYXRpb25FcnJvci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZXNtL2hlbHBlcnMvaWRlbnRpZnlSZWdpc3RyYXRpb25FcnJvci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZXNtL2hlbHBlcnMvaXNWYWxpZERvbWFpbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZXNtL2hlbHBlcnMvcGxhdGZvcm1BdXRoZW50aWNhdG9ySXNBdmFpbGFibGUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9oZWxwZXJzL3RvQXV0aGVudGljYXRvckF0dGFjaG1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9oZWxwZXJzL3RvUHVibGljS2V5Q3JlZGVudGlhbERlc2NyaXB0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9oZWxwZXJzL3dlYkF1dGhuQWJvcnRTZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9Ac2ltcGxld2ViYXV0aG4vYnJvd3Nlci9lc20vaGVscGVycy93ZWJBdXRobkVycm9yLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9Ac2ltcGxld2ViYXV0aG4vYnJvd3Nlci9lc20vaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9tZXRob2RzL3N0YXJ0QXV0aGVudGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzaW1wbGV3ZWJhdXRobi9icm93c2VyL2VzbS9tZXRob2RzL3N0YXJ0UmVnaXN0cmF0aW9uLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9Ac2ltcGxld2ViYXV0aG4vYnJvd3Nlci9lc20vdHlwZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzdGltdWx1cy1jb21wb25lbnRzL2NvbG9yLXBpY2tlci9kaXN0L3N0aW11bHVzLWNvbG9yLXBpY2tlci5tanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2FjY2Vzc2libGUtbWVudS9kaXN0L2FjY2Vzc2libGUtbWVudS5lcy5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2JhY2tlbmQuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIG1hcCA9IHtcblx0XCIuL2FjZS1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvYWNlLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2JhY2tlbmQtc2VhcmNoLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9iYWNrZW5kLXNlYXJjaC1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9jaG9pY2VzLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9jaG9pY2VzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2NsaXBib2FyZC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY2xpcGJvYXJkLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2NvbG9yLXBpY2tlci1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY29sb3ItcGlja2VyLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2NvbG9yLXNjaGVtZS1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY29sb3Itc2NoZW1lLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2RlZXBsaW5rLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9kZWVwbGluay1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2p1bXAtdGFyZ2V0cy1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvanVtcC10YXJnZXRzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2xpbWl0LWhlaWdodC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvbGltaXQtaGVpZ2h0LWNvbnRyb2xsZXIuanNcIixcblx0XCIuL21ldGF3aXphcmQtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL21ldGF3aXphcmQtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vb3BlcmF0aW9ucy1tZW51LWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9vcGVyYXRpb25zLW1lbnUtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vcGFzc2tleXMtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Bhc3NrZXlzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3Byb2ZpbGUtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Byb2ZpbGUtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi90YWJzLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90YWJzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RlbXBsYXRlLXN0dWRpby1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdGVtcGxhdGUtc3R1ZGlvLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RpbnltY2UtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RpbnltY2UtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vdG9nZ2xlLWZpZWxkc2V0LWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b2dnbGUtZmllbGRzZXQtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vdG9nZ2xlLW5hdmlnYXRpb24tY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RvZ2dsZS1uYXZpZ2F0aW9uLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RvZ2dsZS1ub2Rlcy1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9nZ2xlLW5vZGVzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3Rvb2x0aXBzLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b29sdGlwcy1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi93ZWJhdXRobi1lcnJvci1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvd2ViYXV0aG4tZXJyb3ItY29udHJvbGxlci5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1hcCwgcmVxKSkge1xuXHRcdHZhciBlID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIHJlcSArIFwiJ1wiKTtcblx0XHRlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG5cdFx0dGhyb3cgZTtcblx0fVxuXHRyZXR1cm4gbWFwW3JlcV07XG59XG53ZWJwYWNrQ29udGV4dC5rZXlzID0gZnVuY3Rpb24gd2VicGFja0NvbnRleHRLZXlzKCkge1xuXHRyZXR1cm4gT2JqZWN0LmtleXMobWFwKTtcbn07XG53ZWJwYWNrQ29udGV4dC5yZXNvbHZlID0gd2VicGFja0NvbnRleHRSZXNvbHZlO1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrQ29udGV4dDtcbndlYnBhY2tDb250ZXh0LmlkID0gXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycyBzeW5jIHJlY3Vyc2l2ZSBcXFxcLmpzJFwiOyIsIi8qXG5TdGltdWx1cyBXZWJwYWNrIEhlbHBlcnMgMS4wLjBcbkNvcHlyaWdodCDCqSAyMDIxIEJhc2VjYW1wLCBMTENcbiAqL1xuZnVuY3Rpb24gZGVmaW5pdGlvbnNGcm9tQ29udGV4dChjb250ZXh0KSB7XG4gICAgcmV0dXJuIGNvbnRleHQua2V5cygpXG4gICAgICAgIC5tYXAoKGtleSkgPT4gZGVmaW5pdGlvbkZvck1vZHVsZVdpdGhDb250ZXh0QW5kS2V5KGNvbnRleHQsIGtleSkpXG4gICAgICAgIC5maWx0ZXIoKHZhbHVlKSA9PiB2YWx1ZSk7XG59XG5mdW5jdGlvbiBkZWZpbml0aW9uRm9yTW9kdWxlV2l0aENvbnRleHRBbmRLZXkoY29udGV4dCwga2V5KSB7XG4gICAgY29uc3QgaWRlbnRpZmllciA9IGlkZW50aWZpZXJGb3JDb250ZXh0S2V5KGtleSk7XG4gICAgaWYgKGlkZW50aWZpZXIpIHtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyKGNvbnRleHQoa2V5KSwgaWRlbnRpZmllcik7XG4gICAgfVxufVxuZnVuY3Rpb24gZGVmaW5pdGlvbkZvck1vZHVsZUFuZElkZW50aWZpZXIobW9kdWxlLCBpZGVudGlmaWVyKSB7XG4gICAgY29uc3QgY29udHJvbGxlckNvbnN0cnVjdG9yID0gbW9kdWxlLmRlZmF1bHQ7XG4gICAgaWYgKHR5cGVvZiBjb250cm9sbGVyQ29uc3RydWN0b3IgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXJDb25zdHJ1Y3RvciB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlkZW50aWZpZXJGb3JDb250ZXh0S2V5KGtleSkge1xuICAgIGNvbnN0IGxvZ2ljYWxOYW1lID0gKGtleS5tYXRjaCgvXig/OlxcLlxcLyk/KC4rKSg/OltfLV1jb250cm9sbGVyXFwuLis/KSQvKSB8fCBbXSlbMV07XG4gICAgaWYgKGxvZ2ljYWxOYW1lKSB7XG4gICAgICAgIHJldHVybiBsb2dpY2FsTmFtZS5yZXBsYWNlKC9fL2csIFwiLVwiKS5yZXBsYWNlKC9cXC8vZywgXCItLVwiKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IGRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyLCBkZWZpbml0aW9uRm9yTW9kdWxlV2l0aENvbnRleHRBbmRLZXksIGRlZmluaXRpb25zRnJvbUNvbnRleHQsIGlkZW50aWZpZXJGb3JDb250ZXh0S2V5IH07XG4iLCIvKlxuU3RpbXVsdXMgMy4yLjFcbkNvcHlyaWdodCDCqSAyMDIzIEJhc2VjYW1wLCBMTENcbiAqL1xuY2xhc3MgRXZlbnRMaXN0ZW5lciB7XG4gICAgY29uc3RydWN0b3IoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBldmVudE5hbWU7XG4gICAgICAgIHRoaXMuZXZlbnRPcHRpb25zID0gZXZlbnRPcHRpb25zO1xuICAgICAgICB0aGlzLnVub3JkZXJlZEJpbmRpbmdzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMsIHRoaXMuZXZlbnRPcHRpb25zKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuZXZlbnROYW1lLCB0aGlzLCB0aGlzLmV2ZW50T3B0aW9ucyk7XG4gICAgfVxuICAgIGJpbmRpbmdDb25uZWN0ZWQoYmluZGluZykge1xuICAgICAgICB0aGlzLnVub3JkZXJlZEJpbmRpbmdzLmFkZChiaW5kaW5nKTtcbiAgICB9XG4gICAgYmluZGluZ0Rpc2Nvbm5lY3RlZChiaW5kaW5nKSB7XG4gICAgICAgIHRoaXMudW5vcmRlcmVkQmluZGluZ3MuZGVsZXRlKGJpbmRpbmcpO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBleHRlbmRlZEV2ZW50ID0gZXh0ZW5kRXZlbnQoZXZlbnQpO1xuICAgICAgICBmb3IgKGNvbnN0IGJpbmRpbmcgb2YgdGhpcy5iaW5kaW5ncykge1xuICAgICAgICAgICAgaWYgKGV4dGVuZGVkRXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nLmhhbmRsZUV2ZW50KGV4dGVuZGVkRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGhhc0JpbmRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy51bm9yZGVyZWRCaW5kaW5ncy5zaXplID4gMDtcbiAgICB9XG4gICAgZ2V0IGJpbmRpbmdzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnVub3JkZXJlZEJpbmRpbmdzKS5zb3J0KChsZWZ0LCByaWdodCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGVmdEluZGV4ID0gbGVmdC5pbmRleCwgcmlnaHRJbmRleCA9IHJpZ2h0LmluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIGxlZnRJbmRleCA8IHJpZ2h0SW5kZXggPyAtMSA6IGxlZnRJbmRleCA+IHJpZ2h0SW5kZXggPyAxIDogMDtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXh0ZW5kRXZlbnQoZXZlbnQpIHtcbiAgICBpZiAoXCJpbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWRcIiBpbiBldmVudCkge1xuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB7IHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiB9ID0gZXZlbnQ7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGV2ZW50LCB7XG4gICAgICAgICAgICBpbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IGZhbHNlLFxuICAgICAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24uY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY2xhc3MgRGlzcGF0Y2hlciB7XG4gICAgY29uc3RydWN0b3IoYXBwbGljYXRpb24pIHtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbiA9IGFwcGxpY2F0aW9uO1xuICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJNYXBzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKChldmVudExpc3RlbmVyKSA9PiBldmVudExpc3RlbmVyLmNvbm5lY3QoKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKGV2ZW50TGlzdGVuZXIpID0+IGV2ZW50TGlzdGVuZXIuZGlzY29ubmVjdCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMudmFsdWVzKCkpLnJlZHVjZSgobGlzdGVuZXJzLCBtYXApID0+IGxpc3RlbmVycy5jb25jYXQoQXJyYXkuZnJvbShtYXAudmFsdWVzKCkpKSwgW10pO1xuICAgIH1cbiAgICBiaW5kaW5nQ29ubmVjdGVkKGJpbmRpbmcpIHtcbiAgICAgICAgdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJGb3JCaW5kaW5nKGJpbmRpbmcpLmJpbmRpbmdDb25uZWN0ZWQoYmluZGluZyk7XG4gICAgfVxuICAgIGJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZywgY2xlYXJFdmVudExpc3RlbmVycyA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKS5iaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcpO1xuICAgICAgICBpZiAoY2xlYXJFdmVudExpc3RlbmVycylcbiAgICAgICAgICAgIHRoaXMuY2xlYXJFdmVudExpc3RlbmVyc0ZvckJpbmRpbmcoYmluZGluZyk7XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwgPSB7fSkge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmhhbmRsZUVycm9yKGVycm9yLCBgRXJyb3IgJHttZXNzYWdlfWAsIGRldGFpbCk7XG4gICAgfVxuICAgIGNsZWFyRXZlbnRMaXN0ZW5lcnNGb3JCaW5kaW5nKGJpbmRpbmcpIHtcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lciA9IHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKTtcbiAgICAgICAgaWYgKCFldmVudExpc3RlbmVyLmhhc0JpbmRpbmdzKCkpIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVNYXBwZWRFdmVudExpc3RlbmVyRm9yKGJpbmRpbmcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZU1hcHBlZEV2ZW50TGlzdGVuZXJGb3IoYmluZGluZykge1xuICAgICAgICBjb25zdCB7IGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyB9ID0gYmluZGluZztcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lck1hcCA9IHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyTWFwRm9yRXZlbnRUYXJnZXQoZXZlbnRUYXJnZXQpO1xuICAgICAgICBjb25zdCBjYWNoZUtleSA9IHRoaXMuY2FjaGVLZXkoZXZlbnROYW1lLCBldmVudE9wdGlvbnMpO1xuICAgICAgICBldmVudExpc3RlbmVyTWFwLmRlbGV0ZShjYWNoZUtleSk7XG4gICAgICAgIGlmIChldmVudExpc3RlbmVyTWFwLnNpemUgPT0gMClcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMuZGVsZXRlKGV2ZW50VGFyZ2V0KTtcbiAgICB9XG4gICAgZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKSB7XG4gICAgICAgIGNvbnN0IHsgZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zIH0gPSBiaW5kaW5nO1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICB9XG4gICAgZmV0Y2hFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgICAgICBjb25zdCBldmVudExpc3RlbmVyTWFwID0gdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJNYXBGb3JFdmVudFRhcmdldChldmVudFRhcmdldCk7XG4gICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5jYWNoZUtleShldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIGxldCBldmVudExpc3RlbmVyID0gZXZlbnRMaXN0ZW5lck1hcC5nZXQoY2FjaGVLZXkpO1xuICAgICAgICBpZiAoIWV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXIgPSB0aGlzLmNyZWF0ZUV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXJNYXAuc2V0KGNhY2hlS2V5LCBldmVudExpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRMaXN0ZW5lcjtcbiAgICB9XG4gICAgY3JlYXRlRXZlbnRMaXN0ZW5lcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lciA9IG5ldyBFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXIuY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudExpc3RlbmVyO1xuICAgIH1cbiAgICBmZXRjaEV2ZW50TGlzdGVuZXJNYXBGb3JFdmVudFRhcmdldChldmVudFRhcmdldCkge1xuICAgICAgICBsZXQgZXZlbnRMaXN0ZW5lck1hcCA9IHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMuZ2V0KGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgaWYgKCFldmVudExpc3RlbmVyTWFwKSB7XG4gICAgICAgICAgICBldmVudExpc3RlbmVyTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVyTWFwcy5zZXQoZXZlbnRUYXJnZXQsIGV2ZW50TGlzdGVuZXJNYXApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudExpc3RlbmVyTWFwO1xuICAgIH1cbiAgICBjYWNoZUtleShldmVudE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IFtldmVudE5hbWVdO1xuICAgICAgICBPYmplY3Qua2V5cyhldmVudE9wdGlvbnMpXG4gICAgICAgICAgICAuc29ydCgpXG4gICAgICAgICAgICAuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBwYXJ0cy5wdXNoKGAke2V2ZW50T3B0aW9uc1trZXldID8gXCJcIiA6IFwiIVwifSR7a2V5fWApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oXCI6XCIpO1xuICAgIH1cbn1cblxuY29uc3QgZGVmYXVsdEFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzID0ge1xuICAgIHN0b3AoeyBldmVudCwgdmFsdWUgfSkge1xuICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBwcmV2ZW50KHsgZXZlbnQsIHZhbHVlIH0pIHtcbiAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBzZWxmKHsgZXZlbnQsIHZhbHVlLCBlbGVtZW50IH0pIHtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudCA9PT0gZXZlbnQudGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxufTtcbmNvbnN0IGRlc2NyaXB0b3JQYXR0ZXJuID0gL14oPzooPzooW14uXSs/KVxcKyk/KC4rPykoPzpcXC4oLis/KSk/KD86QCh3aW5kb3d8ZG9jdW1lbnQpKT8tPik/KC4rPykoPzojKFteOl0rPykpKD86OiguKykpPyQvO1xuZnVuY3Rpb24gcGFyc2VBY3Rpb25EZXNjcmlwdG9yU3RyaW5nKGRlc2NyaXB0b3JTdHJpbmcpIHtcbiAgICBjb25zdCBzb3VyY2UgPSBkZXNjcmlwdG9yU3RyaW5nLnRyaW0oKTtcbiAgICBjb25zdCBtYXRjaGVzID0gc291cmNlLm1hdGNoKGRlc2NyaXB0b3JQYXR0ZXJuKSB8fCBbXTtcbiAgICBsZXQgZXZlbnROYW1lID0gbWF0Y2hlc1syXTtcbiAgICBsZXQga2V5RmlsdGVyID0gbWF0Y2hlc1szXTtcbiAgICBpZiAoa2V5RmlsdGVyICYmICFbXCJrZXlkb3duXCIsIFwia2V5dXBcIiwgXCJrZXlwcmVzc1wiXS5pbmNsdWRlcyhldmVudE5hbWUpKSB7XG4gICAgICAgIGV2ZW50TmFtZSArPSBgLiR7a2V5RmlsdGVyfWA7XG4gICAgICAgIGtleUZpbHRlciA9IFwiXCI7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGV2ZW50VGFyZ2V0OiBwYXJzZUV2ZW50VGFyZ2V0KG1hdGNoZXNbNF0pLFxuICAgICAgICBldmVudE5hbWUsXG4gICAgICAgIGV2ZW50T3B0aW9uczogbWF0Y2hlc1s3XSA/IHBhcnNlRXZlbnRPcHRpb25zKG1hdGNoZXNbN10pIDoge30sXG4gICAgICAgIGlkZW50aWZpZXI6IG1hdGNoZXNbNV0sXG4gICAgICAgIG1ldGhvZE5hbWU6IG1hdGNoZXNbNl0sXG4gICAgICAgIGtleUZpbHRlcjogbWF0Y2hlc1sxXSB8fCBrZXlGaWx0ZXIsXG4gICAgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlRXZlbnRUYXJnZXQoZXZlbnRUYXJnZXROYW1lKSB7XG4gICAgaWYgKGV2ZW50VGFyZ2V0TmFtZSA9PSBcIndpbmRvd1wiKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50VGFyZ2V0TmFtZSA9PSBcImRvY3VtZW50XCIpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlRXZlbnRPcHRpb25zKGV2ZW50T3B0aW9ucykge1xuICAgIHJldHVybiBldmVudE9wdGlvbnNcbiAgICAgICAgLnNwbGl0KFwiOlwiKVxuICAgICAgICAucmVkdWNlKChvcHRpb25zLCB0b2tlbikgPT4gT2JqZWN0LmFzc2lnbihvcHRpb25zLCB7IFt0b2tlbi5yZXBsYWNlKC9eIS8sIFwiXCIpXTogIS9eIS8udGVzdCh0b2tlbikgfSksIHt9KTtcbn1cbmZ1bmN0aW9uIHN0cmluZ2lmeUV2ZW50VGFyZ2V0KGV2ZW50VGFyZ2V0KSB7XG4gICAgaWYgKGV2ZW50VGFyZ2V0ID09IHdpbmRvdykge1xuICAgICAgICByZXR1cm4gXCJ3aW5kb3dcIjtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgPT0gZG9jdW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIFwiZG9jdW1lbnRcIjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNhbWVsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoLyg/OltfLV0pKFthLXowLTldKS9nLCAoXywgY2hhcikgPT4gY2hhci50b1VwcGVyQ2FzZSgpKTtcbn1cbmZ1bmN0aW9uIG5hbWVzcGFjZUNhbWVsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIGNhbWVsaXplKHZhbHVlLnJlcGxhY2UoLy0tL2csIFwiLVwiKS5yZXBsYWNlKC9fXy9nLCBcIl9cIikpO1xufVxuZnVuY3Rpb24gY2FwaXRhbGl6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHZhbHVlLnNsaWNlKDEpO1xufVxuZnVuY3Rpb24gZGFzaGVyaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoLyhbQS1aXSkvZywgKF8sIGNoYXIpID0+IGAtJHtjaGFyLnRvTG93ZXJDYXNlKCl9YCk7XG59XG5mdW5jdGlvbiB0b2tlbml6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5tYXRjaCgvW15cXHNdKy9nKSB8fCBbXTtcbn1cblxuZnVuY3Rpb24gaXNTb21ldGhpbmcob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdCAhPT0gbnVsbCAmJiBvYmplY3QgIT09IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGhhc1Byb3BlcnR5KG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpO1xufVxuXG5jb25zdCBhbGxNb2RpZmllcnMgPSBbXCJtZXRhXCIsIFwiY3RybFwiLCBcImFsdFwiLCBcInNoaWZ0XCJdO1xuY2xhc3MgQWN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBpbmRleCwgZGVzY3JpcHRvciwgc2NoZW1hKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldCA9IGRlc2NyaXB0b3IuZXZlbnRUYXJnZXQgfHwgZWxlbWVudDtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBkZXNjcmlwdG9yLmV2ZW50TmFtZSB8fCBnZXREZWZhdWx0RXZlbnROYW1lRm9yRWxlbWVudChlbGVtZW50KSB8fCBlcnJvcihcIm1pc3NpbmcgZXZlbnQgbmFtZVwiKTtcbiAgICAgICAgdGhpcy5ldmVudE9wdGlvbnMgPSBkZXNjcmlwdG9yLmV2ZW50T3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdGhpcy5pZGVudGlmaWVyID0gZGVzY3JpcHRvci5pZGVudGlmaWVyIHx8IGVycm9yKFwibWlzc2luZyBpZGVudGlmaWVyXCIpO1xuICAgICAgICB0aGlzLm1ldGhvZE5hbWUgPSBkZXNjcmlwdG9yLm1ldGhvZE5hbWUgfHwgZXJyb3IoXCJtaXNzaW5nIG1ldGhvZCBuYW1lXCIpO1xuICAgICAgICB0aGlzLmtleUZpbHRlciA9IGRlc2NyaXB0b3Iua2V5RmlsdGVyIHx8IFwiXCI7XG4gICAgICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgIH1cbiAgICBzdGF0aWMgZm9yVG9rZW4odG9rZW4sIHNjaGVtYSkge1xuICAgICAgICByZXR1cm4gbmV3IHRoaXModG9rZW4uZWxlbWVudCwgdG9rZW4uaW5kZXgsIHBhcnNlQWN0aW9uRGVzY3JpcHRvclN0cmluZyh0b2tlbi5jb250ZW50KSwgc2NoZW1hKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50RmlsdGVyID0gdGhpcy5rZXlGaWx0ZXIgPyBgLiR7dGhpcy5rZXlGaWx0ZXJ9YCA6IFwiXCI7XG4gICAgICAgIGNvbnN0IGV2ZW50VGFyZ2V0ID0gdGhpcy5ldmVudFRhcmdldE5hbWUgPyBgQCR7dGhpcy5ldmVudFRhcmdldE5hbWV9YCA6IFwiXCI7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmV2ZW50TmFtZX0ke2V2ZW50RmlsdGVyfSR7ZXZlbnRUYXJnZXR9LT4ke3RoaXMuaWRlbnRpZmllcn0jJHt0aGlzLm1ldGhvZE5hbWV9YDtcbiAgICB9XG4gICAgc2hvdWxkSWdub3JlS2V5Ym9hcmRFdmVudChldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMua2V5RmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsdGVycyA9IHRoaXMua2V5RmlsdGVyLnNwbGl0KFwiK1wiKTtcbiAgICAgICAgaWYgKHRoaXMua2V5RmlsdGVyRGlzc2F0aXNmaWVkKGV2ZW50LCBmaWx0ZXJzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhbmRhcmRGaWx0ZXIgPSBmaWx0ZXJzLmZpbHRlcigoa2V5KSA9PiAhYWxsTW9kaWZpZXJzLmluY2x1ZGVzKGtleSkpWzBdO1xuICAgICAgICBpZiAoIXN0YW5kYXJkRmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFoYXNQcm9wZXJ0eSh0aGlzLmtleU1hcHBpbmdzLCBzdGFuZGFyZEZpbHRlcikpIHtcbiAgICAgICAgICAgIGVycm9yKGBjb250YWlucyB1bmtub3duIGtleSBmaWx0ZXI6ICR7dGhpcy5rZXlGaWx0ZXJ9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMua2V5TWFwcGluZ3Nbc3RhbmRhcmRGaWx0ZXJdLnRvTG93ZXJDYXNlKCkgIT09IGV2ZW50LmtleS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbiAgICBzaG91bGRJZ25vcmVNb3VzZUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5rZXlGaWx0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWx0ZXJzID0gW3RoaXMua2V5RmlsdGVyXTtcbiAgICAgICAgaWYgKHRoaXMua2V5RmlsdGVyRGlzc2F0aXNmaWVkKGV2ZW50LCBmaWx0ZXJzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBnZXQgcGFyYW1zKCkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7fTtcbiAgICAgICAgY29uc3QgcGF0dGVybiA9IG5ldyBSZWdFeHAoYF5kYXRhLSR7dGhpcy5pZGVudGlmaWVyfS0oLispLXBhcmFtJGAsIFwiaVwiKTtcbiAgICAgICAgZm9yIChjb25zdCB7IG5hbWUsIHZhbHVlIH0gb2YgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQuYXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbmFtZS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IG1hdGNoICYmIG1hdGNoWzFdO1xuICAgICAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgICAgICAgIHBhcmFtc1tjYW1lbGl6ZShrZXkpXSA9IHR5cGVjYXN0KHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBnZXQgZXZlbnRUYXJnZXROYW1lKCkge1xuICAgICAgICByZXR1cm4gc3RyaW5naWZ5RXZlbnRUYXJnZXQodGhpcy5ldmVudFRhcmdldCk7XG4gICAgfVxuICAgIGdldCBrZXlNYXBwaW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmtleU1hcHBpbmdzO1xuICAgIH1cbiAgICBrZXlGaWx0ZXJEaXNzYXRpc2ZpZWQoZXZlbnQsIGZpbHRlcnMpIHtcbiAgICAgICAgY29uc3QgW21ldGEsIGN0cmwsIGFsdCwgc2hpZnRdID0gYWxsTW9kaWZpZXJzLm1hcCgobW9kaWZpZXIpID0+IGZpbHRlcnMuaW5jbHVkZXMobW9kaWZpZXIpKTtcbiAgICAgICAgcmV0dXJuIGV2ZW50Lm1ldGFLZXkgIT09IG1ldGEgfHwgZXZlbnQuY3RybEtleSAhPT0gY3RybCB8fCBldmVudC5hbHRLZXkgIT09IGFsdCB8fCBldmVudC5zaGlmdEtleSAhPT0gc2hpZnQ7XG4gICAgfVxufVxuY29uc3QgZGVmYXVsdEV2ZW50TmFtZXMgPSB7XG4gICAgYTogKCkgPT4gXCJjbGlja1wiLFxuICAgIGJ1dHRvbjogKCkgPT4gXCJjbGlja1wiLFxuICAgIGZvcm06ICgpID0+IFwic3VibWl0XCIsXG4gICAgZGV0YWlsczogKCkgPT4gXCJ0b2dnbGVcIixcbiAgICBpbnB1dDogKGUpID0+IChlLmdldEF0dHJpYnV0ZShcInR5cGVcIikgPT0gXCJzdWJtaXRcIiA/IFwiY2xpY2tcIiA6IFwiaW5wdXRcIiksXG4gICAgc2VsZWN0OiAoKSA9PiBcImNoYW5nZVwiLFxuICAgIHRleHRhcmVhOiAoKSA9PiBcImlucHV0XCIsXG59O1xuZnVuY3Rpb24gZ2V0RGVmYXVsdEV2ZW50TmFtZUZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAodGFnTmFtZSBpbiBkZWZhdWx0RXZlbnROYW1lcykge1xuICAgICAgICByZXR1cm4gZGVmYXVsdEV2ZW50TmFtZXNbdGFnTmFtZV0oZWxlbWVudCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbn1cbmZ1bmN0aW9uIHR5cGVjYXN0KHZhbHVlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAob19PKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG5cbmNsYXNzIEJpbmRpbmcge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB9XG4gICAgZ2V0IGluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uaW5kZXg7XG4gICAgfVxuICAgIGdldCBldmVudFRhcmdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uLmV2ZW50VGFyZ2V0O1xuICAgIH1cbiAgICBnZXQgZXZlbnRPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uZXZlbnRPcHRpb25zO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBhY3Rpb25FdmVudCA9IHRoaXMucHJlcGFyZUFjdGlvbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgaWYgKHRoaXMud2lsbEJlSW52b2tlZEJ5RXZlbnQoZXZlbnQpICYmIHRoaXMuYXBwbHlFdmVudE1vZGlmaWVycyhhY3Rpb25FdmVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuaW52b2tlV2l0aEV2ZW50KGFjdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZXZlbnROYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uZXZlbnROYW1lO1xuICAgIH1cbiAgICBnZXQgbWV0aG9kKCkge1xuICAgICAgICBjb25zdCBtZXRob2QgPSB0aGlzLmNvbnRyb2xsZXJbdGhpcy5tZXRob2ROYW1lXTtcbiAgICAgICAgaWYgKHR5cGVvZiBtZXRob2QgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbWV0aG9kO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQWN0aW9uIFwiJHt0aGlzLmFjdGlvbn1cIiByZWZlcmVuY2VzIHVuZGVmaW5lZCBtZXRob2QgXCIke3RoaXMubWV0aG9kTmFtZX1cImApO1xuICAgIH1cbiAgICBhcHBseUV2ZW50TW9kaWZpZXJzKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdGhpcy5hY3Rpb247XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uRGVzY3JpcHRvckZpbHRlcnMgfSA9IHRoaXMuY29udGV4dC5hcHBsaWNhdGlvbjtcbiAgICAgICAgY29uc3QgeyBjb250cm9sbGVyIH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgICAgIGxldCBwYXNzZXMgPSB0cnVlO1xuICAgICAgICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5ldmVudE9wdGlvbnMpKSB7XG4gICAgICAgICAgICBpZiAobmFtZSBpbiBhY3Rpb25EZXNjcmlwdG9yRmlsdGVycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IGFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzW25hbWVdO1xuICAgICAgICAgICAgICAgIHBhc3NlcyA9IHBhc3NlcyAmJiBmaWx0ZXIoeyBuYW1lLCB2YWx1ZSwgZXZlbnQsIGVsZW1lbnQsIGNvbnRyb2xsZXIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFzc2VzO1xuICAgIH1cbiAgICBwcmVwYXJlQWN0aW9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZXZlbnQsIHsgcGFyYW1zOiB0aGlzLmFjdGlvbi5wYXJhbXMgfSk7XG4gICAgfVxuICAgIGludm9rZVdpdGhFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCB7IHRhcmdldCwgY3VycmVudFRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLm1ldGhvZC5jYWxsKHRoaXMuY29udHJvbGxlciwgZXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmxvZ0RlYnVnQWN0aXZpdHkodGhpcy5tZXRob2ROYW1lLCB7IGV2ZW50LCB0YXJnZXQsIGN1cnJlbnRUYXJnZXQsIGFjdGlvbjogdGhpcy5tZXRob2ROYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50LCBpbmRleCB9ID0gdGhpcztcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbCA9IHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCwgaW5kZXgsIGV2ZW50IH07XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuaGFuZGxlRXJyb3IoZXJyb3IsIGBpbnZva2luZyBhY3Rpb24gXCIke3RoaXMuYWN0aW9ufVwiYCwgZGV0YWlsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aWxsQmVJbnZva2VkQnlFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBldmVudFRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiB0aGlzLmFjdGlvbi5zaG91bGRJZ25vcmVLZXlib2FyZEV2ZW50KGV2ZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgdGhpcy5hY3Rpb24uc2hvdWxkSWdub3JlTW91c2VFdmVudChldmVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09PSBldmVudFRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50ICYmIHRoaXMuZWxlbWVudC5jb250YWlucyhldmVudFRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmNvbnRhaW5zRWxlbWVudChldmVudFRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5jb250YWluc0VsZW1lbnQodGhpcy5hY3Rpb24uZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuY29udHJvbGxlcjtcbiAgICB9XG4gICAgZ2V0IG1ldGhvZE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5tZXRob2ROYW1lO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbn1cblxuY2xhc3MgRWxlbWVudE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXJJbml0ID0geyBhdHRyaWJ1dGVzOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4gdGhpcy5wcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gbmV3IFNldCh0aGlzLm1hdGNoRWxlbWVudHNJblRyZWUoKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzKSkge1xuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlcy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBBcnJheS5mcm9tKG1hdGNoZXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzTXV0YXRpb24obXV0YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbihtdXRhdGlvbikge1xuICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PSBcImF0dHJpYnV0ZXNcIikge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQXR0cmlidXRlQ2hhbmdlKG11dGF0aW9uLnRhcmdldCwgbXV0YXRpb24uYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobXV0YXRpb24udHlwZSA9PSBcImNoaWxkTGlzdFwiKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NSZW1vdmVkTm9kZXMobXV0YXRpb24ucmVtb3ZlZE5vZGVzKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0FkZGVkTm9kZXMobXV0YXRpb24uYWRkZWROb2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc0F0dHJpYnV0ZUNoYW5nZShlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudEF0dHJpYnV0ZUNoYW5nZWQgJiYgdGhpcy5tYXRjaEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMubWF0Y2hFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc1JlbW92ZWROb2Rlcyhub2Rlcykge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShub2RlcykpIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRGcm9tTm9kZShub2RlKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzVHJlZShlbGVtZW50LCB0aGlzLnJlbW92ZUVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NBZGRlZE5vZGVzKG5vZGVzKSB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBBcnJheS5mcm9tKG5vZGVzKSkge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudEZyb21Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgdGhpcy5lbGVtZW50SXNBY3RpdmUoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NUcmVlKGVsZW1lbnQsIHRoaXMuYWRkRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUubWF0Y2hFbGVtZW50KGVsZW1lbnQpO1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUgPSB0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUubWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlKTtcbiAgICB9XG4gICAgcHJvY2Vzc1RyZWUodHJlZSwgcHJvY2Vzc29yKSB7XG4gICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm1hdGNoRWxlbWVudHNJblRyZWUodHJlZSkpIHtcbiAgICAgICAgICAgIHByb2Nlc3Nvci5jYWxsKHRoaXMsIGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRGcm9tTm9kZShub2RlKSB7XG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50SXNBY3RpdmUoZWxlbWVudCkge1xuICAgICAgICBpZiAoZWxlbWVudC5pc0Nvbm5lY3RlZCAhPSB0aGlzLmVsZW1lbnQuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuY29udGFpbnMoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50cy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnRJc0FjdGl2ZShlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuYWRkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudE1hdGNoZWQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50cy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuZGVsZXRlKGVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgQXR0cmlidXRlT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWU7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIgPSBuZXcgRWxlbWVudE9ic2VydmVyKGVsZW1lbnQsIHRoaXMpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudE9ic2VydmVyLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIGBbJHt0aGlzLmF0dHJpYnV0ZU5hbWV9XWA7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBwYXVzZShjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5wYXVzZShjYWxsYmFjayk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0YXJ0ZWQ7XG4gICAgfVxuICAgIG1hdGNoRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50Lmhhc0F0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUpO1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLm1hdGNoRWxlbWVudCh0cmVlKSA/IFt0cmVlXSA6IFtdO1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gQXJyYXkuZnJvbSh0cmVlLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZWxlY3RvcikpO1xuICAgICAgICByZXR1cm4gbWF0Y2guY29uY2F0KG1hdGNoZXMpO1xuICAgIH1cbiAgICBlbGVtZW50TWF0Y2hlZChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKGVsZW1lbnQsIHRoaXMuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudFVubWF0Y2hlZChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRVbm1hdGNoZWRBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZEF0dHJpYnV0ZShlbGVtZW50LCB0aGlzLmF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudEF0dHJpYnV0ZVZhbHVlQ2hhbmdlZCAmJiB0aGlzLmF0dHJpYnV0ZU5hbWUgPT0gYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhZGQobWFwLCBrZXksIHZhbHVlKSB7XG4gICAgZmV0Y2gobWFwLCBrZXkpLmFkZCh2YWx1ZSk7XG59XG5mdW5jdGlvbiBkZWwobWFwLCBrZXksIHZhbHVlKSB7XG4gICAgZmV0Y2gobWFwLCBrZXkpLmRlbGV0ZSh2YWx1ZSk7XG4gICAgcHJ1bmUobWFwLCBrZXkpO1xufVxuZnVuY3Rpb24gZmV0Y2gobWFwLCBrZXkpIHtcbiAgICBsZXQgdmFsdWVzID0gbWFwLmdldChrZXkpO1xuICAgIGlmICghdmFsdWVzKSB7XG4gICAgICAgIHZhbHVlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgbWFwLnNldChrZXksIHZhbHVlcyk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZXM7XG59XG5mdW5jdGlvbiBwcnVuZShtYXAsIGtleSkge1xuICAgIGNvbnN0IHZhbHVlcyA9IG1hcC5nZXQoa2V5KTtcbiAgICBpZiAodmFsdWVzICE9IG51bGwgJiYgdmFsdWVzLnNpemUgPT0gMCkge1xuICAgICAgICBtYXAuZGVsZXRlKGtleSk7XG4gICAgfVxufVxuXG5jbGFzcyBNdWx0aW1hcCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudmFsdWVzQnlLZXkgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIGdldCBrZXlzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnZhbHVlc0J5S2V5LmtleXMoKSk7XG4gICAgfVxuICAgIGdldCB2YWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IHNldHMgPSBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkudmFsdWVzKCkpO1xuICAgICAgICByZXR1cm4gc2V0cy5yZWR1Y2UoKHZhbHVlcywgc2V0KSA9PiB2YWx1ZXMuY29uY2F0KEFycmF5LmZyb20oc2V0KSksIFtdKTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIGNvbnN0IHNldHMgPSBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkudmFsdWVzKCkpO1xuICAgICAgICByZXR1cm4gc2V0cy5yZWR1Y2UoKHNpemUsIHNldCkgPT4gc2l6ZSArIHNldC5zaXplLCAwKTtcbiAgICB9XG4gICAgYWRkKGtleSwgdmFsdWUpIHtcbiAgICAgICAgYWRkKHRoaXMudmFsdWVzQnlLZXksIGtleSwgdmFsdWUpO1xuICAgIH1cbiAgICBkZWxldGUoa2V5LCB2YWx1ZSkge1xuICAgICAgICBkZWwodGhpcy52YWx1ZXNCeUtleSwga2V5LCB2YWx1ZSk7XG4gICAgfVxuICAgIGhhcyhrZXksIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMudmFsdWVzQnlLZXkuZ2V0KGtleSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXMgIT0gbnVsbCAmJiB2YWx1ZXMuaGFzKHZhbHVlKTtcbiAgICB9XG4gICAgaGFzS2V5KGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNCeUtleS5oYXMoa2V5KTtcbiAgICB9XG4gICAgaGFzVmFsdWUodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgc2V0cyA9IEFycmF5LmZyb20odGhpcy52YWx1ZXNCeUtleS52YWx1ZXMoKSk7XG4gICAgICAgIHJldHVybiBzZXRzLnNvbWUoKHNldCkgPT4gc2V0Lmhhcyh2YWx1ZSkpO1xuICAgIH1cbiAgICBnZXRWYWx1ZXNGb3JLZXkoa2V5KSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMudmFsdWVzQnlLZXkuZ2V0KGtleSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXMgPyBBcnJheS5mcm9tKHZhbHVlcykgOiBbXTtcbiAgICB9XG4gICAgZ2V0S2V5c0ZvclZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkpXG4gICAgICAgICAgICAuZmlsdGVyKChbX2tleSwgdmFsdWVzXSkgPT4gdmFsdWVzLmhhcyh2YWx1ZSkpXG4gICAgICAgICAgICAubWFwKChba2V5LCBfdmFsdWVzXSkgPT4ga2V5KTtcbiAgICB9XG59XG5cbmNsYXNzIEluZGV4ZWRNdWx0aW1hcCBleHRlbmRzIE11bHRpbWFwIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5rZXlzQnlWYWx1ZSA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5rZXlzQnlWYWx1ZS5rZXlzKCkpO1xuICAgIH1cbiAgICBhZGQoa2V5LCB2YWx1ZSkge1xuICAgICAgICBzdXBlci5hZGQoa2V5LCB2YWx1ZSk7XG4gICAgICAgIGFkZCh0aGlzLmtleXNCeVZhbHVlLCB2YWx1ZSwga2V5KTtcbiAgICB9XG4gICAgZGVsZXRlKGtleSwgdmFsdWUpIHtcbiAgICAgICAgc3VwZXIuZGVsZXRlKGtleSwgdmFsdWUpO1xuICAgICAgICBkZWwodGhpcy5rZXlzQnlWYWx1ZSwgdmFsdWUsIGtleSk7XG4gICAgfVxuICAgIGhhc1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXNCeVZhbHVlLmhhcyh2YWx1ZSk7XG4gICAgfVxuICAgIGdldEtleXNGb3JWYWx1ZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBzZXQgPSB0aGlzLmtleXNCeVZhbHVlLmdldCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBzZXQgPyBBcnJheS5mcm9tKHNldCkgOiBbXTtcbiAgICB9XG59XG5cbmNsYXNzIFNlbGVjdG9yT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHNlbGVjdG9yLCBkZWxlZ2F0ZSwgZGV0YWlscykge1xuICAgICAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgICB0aGlzLmRldGFpbHMgPSBkZXRhaWxzO1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlciA9IG5ldyBFbGVtZW50T2JzZXJ2ZXIoZWxlbWVudCwgdGhpcyk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5tYXRjaGVzQnlFbGVtZW50ID0gbmV3IE11bHRpbWFwKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RhcnRlZDtcbiAgICB9XG4gICAgZ2V0IHNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3I7XG4gICAgfVxuICAgIHNldCBzZWxlY3RvcihzZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHBhdXNlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnBhdXNlKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50T2JzZXJ2ZXIuZWxlbWVudDtcbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgeyBzZWxlY3RvciB9ID0gdGhpcztcbiAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gZWxlbWVudC5tYXRjaGVzKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLnNlbGVjdG9yTWF0Y2hFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMgJiYgdGhpcy5kZWxlZ2F0ZS5zZWxlY3Rvck1hdGNoRWxlbWVudChlbGVtZW50LCB0aGlzLmRldGFpbHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlKSB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0b3IgfSA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLm1hdGNoRWxlbWVudCh0cmVlKSA/IFt0cmVlXSA6IFtdO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IEFycmF5LmZyb20odHJlZS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSkuZmlsdGVyKChtYXRjaCkgPT4gdGhpcy5tYXRjaEVsZW1lbnQobWF0Y2gpKTtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaC5jb25jYXQobWF0Y2hlcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCB7IHNlbGVjdG9yIH0gPSB0aGlzO1xuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkKGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3JzID0gdGhpcy5tYXRjaGVzQnlFbGVtZW50LmdldEtleXNGb3JWYWx1ZShlbGVtZW50KTtcbiAgICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBzZWxlY3RvcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JVbm1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkKGVsZW1lbnQsIF9hdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0b3IgfSA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMubWF0Y2hFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlZEJlZm9yZSA9IHRoaXMubWF0Y2hlc0J5RWxlbWVudC5oYXMoc2VsZWN0b3IsIGVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoZXMgJiYgIW1hdGNoZWRCZWZvcmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdG9yTWF0Y2hlZChlbGVtZW50LCBzZWxlY3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghbWF0Y2hlcyAmJiBtYXRjaGVkQmVmb3JlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBzZWxlY3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUuc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yLCB0aGlzLmRldGFpbHMpO1xuICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuYWRkKHNlbGVjdG9yLCBlbGVtZW50KTtcbiAgICB9XG4gICAgc2VsZWN0b3JVbm1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBzZWxlY3RvciwgdGhpcy5kZXRhaWxzKTtcbiAgICAgICAgdGhpcy5tYXRjaGVzQnlFbGVtZW50LmRlbGV0ZShzZWxlY3RvciwgZWxlbWVudCk7XG4gICAgfVxufVxuXG5jbGFzcyBTdHJpbmdNYXBPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHRoaXMucHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbnMpKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50LCB7IGF0dHJpYnV0ZXM6IHRydWUsIGF0dHJpYnV0ZU9sZFZhbHVlOiB0cnVlIH0pO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLnRha2VSZWNvcmRzKCk7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGVOYW1lIG9mIHRoaXMua25vd25BdHRyaWJ1dGVOYW1lcykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc011dGF0aW9uKG11dGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzTXV0YXRpb24obXV0YXRpb24pIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IG11dGF0aW9uLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgbXV0YXRpb24ub2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2hBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5kZWxlZ2F0ZS5nZXRTdHJpbmdNYXBLZXlGb3JBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIGlmIChrZXkgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0cmluZ01hcC5oYXMoYXR0cmlidXRlTmFtZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcEtleUFkZGVkKGtleSwgYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5zdHJpbmdNYXAuZ2V0KGF0dHJpYnV0ZU5hbWUpICE9IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHJpbmdNYXBWYWx1ZUNoYW5nZWQodmFsdWUsIGtleSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHRoaXMuc3RyaW5nTWFwLmdldChhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcC5kZWxldGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG9sZFZhbHVlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcEtleVJlbW92ZWQoa2V5LCBhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcC5zZXQoYXR0cmlidXRlTmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcEtleUFkZGVkKGtleSwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlBZGRlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlBZGRlZChrZXksIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcFZhbHVlQ2hhbmdlZCh2YWx1ZSwga2V5LCBvbGRWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBWYWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwVmFsdWVDaGFuZ2VkKHZhbHVlLCBrZXksIG9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBLZXlSZW1vdmVkKGtleSwgYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwS2V5UmVtb3ZlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlSZW1vdmVkKGtleSwgYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBrbm93bkF0dHJpYnV0ZU5hbWVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KHRoaXMuY3VycmVudEF0dHJpYnV0ZU5hbWVzLmNvbmNhdCh0aGlzLnJlY29yZGVkQXR0cmlidXRlTmFtZXMpKSk7XG4gICAgfVxuICAgIGdldCBjdXJyZW50QXR0cmlidXRlTmFtZXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5hdHRyaWJ1dGVzKS5tYXAoKGF0dHJpYnV0ZSkgPT4gYXR0cmlidXRlLm5hbWUpO1xuICAgIH1cbiAgICBnZXQgcmVjb3JkZWRBdHRyaWJ1dGVOYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5zdHJpbmdNYXAua2V5cygpKTtcbiAgICB9XG59XG5cbmNsYXNzIFRva2VuTGlzdE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyID0gbmV3IEF0dHJpYnV0ZU9ic2VydmVyKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIHRoaXMpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMudG9rZW5zQnlFbGVtZW50ID0gbmV3IE11bHRpbWFwKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBwYXVzZShjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLnBhdXNlKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGF0dHJpYnV0ZU5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLmF0dHJpYnV0ZU5hbWU7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy50b2tlbnNNYXRjaGVkKHRoaXMucmVhZFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCkpO1xuICAgIH1cbiAgICBlbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkKGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgW3VubWF0Y2hlZFRva2VucywgbWF0Y2hlZFRva2Vuc10gPSB0aGlzLnJlZnJlc2hUb2tlbnNGb3JFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICB0aGlzLnRva2Vuc1VubWF0Y2hlZCh1bm1hdGNoZWRUb2tlbnMpO1xuICAgICAgICB0aGlzLnRva2Vuc01hdGNoZWQobWF0Y2hlZFRva2Vucyk7XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRBdHRyaWJ1dGUoZWxlbWVudCkge1xuICAgICAgICB0aGlzLnRva2Vuc1VubWF0Y2hlZCh0aGlzLnRva2Vuc0J5RWxlbWVudC5nZXRWYWx1ZXNGb3JLZXkoZWxlbWVudCkpO1xuICAgIH1cbiAgICB0b2tlbnNNYXRjaGVkKHRva2Vucykge1xuICAgICAgICB0b2tlbnMuZm9yRWFjaCgodG9rZW4pID0+IHRoaXMudG9rZW5NYXRjaGVkKHRva2VuKSk7XG4gICAgfVxuICAgIHRva2Vuc1VubWF0Y2hlZCh0b2tlbnMpIHtcbiAgICAgICAgdG9rZW5zLmZvckVhY2goKHRva2VuKSA9PiB0aGlzLnRva2VuVW5tYXRjaGVkKHRva2VuKSk7XG4gICAgfVxuICAgIHRva2VuTWF0Y2hlZCh0b2tlbikge1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnRva2VuTWF0Y2hlZCh0b2tlbik7XG4gICAgICAgIHRoaXMudG9rZW5zQnlFbGVtZW50LmFkZCh0b2tlbi5lbGVtZW50LCB0b2tlbik7XG4gICAgfVxuICAgIHRva2VuVW5tYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudG9rZW5Vbm1hdGNoZWQodG9rZW4pO1xuICAgICAgICB0aGlzLnRva2Vuc0J5RWxlbWVudC5kZWxldGUodG9rZW4uZWxlbWVudCwgdG9rZW4pO1xuICAgIH1cbiAgICByZWZyZXNoVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzVG9rZW5zID0gdGhpcy50b2tlbnNCeUVsZW1lbnQuZ2V0VmFsdWVzRm9yS2V5KGVsZW1lbnQpO1xuICAgICAgICBjb25zdCBjdXJyZW50VG9rZW5zID0gdGhpcy5yZWFkVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgY29uc3QgZmlyc3REaWZmZXJpbmdJbmRleCA9IHppcChwcmV2aW91c1Rva2VucywgY3VycmVudFRva2VucykuZmluZEluZGV4KChbcHJldmlvdXNUb2tlbiwgY3VycmVudFRva2VuXSkgPT4gIXRva2Vuc0FyZUVxdWFsKHByZXZpb3VzVG9rZW4sIGN1cnJlbnRUb2tlbikpO1xuICAgICAgICBpZiAoZmlyc3REaWZmZXJpbmdJbmRleCA9PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIFtbXSwgW11dO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtwcmV2aW91c1Rva2Vucy5zbGljZShmaXJzdERpZmZlcmluZ0luZGV4KSwgY3VycmVudFRva2Vucy5zbGljZShmaXJzdERpZmZlcmluZ0luZGV4KV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVhZFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5hdHRyaWJ1dGVOYW1lO1xuICAgICAgICBjb25zdCB0b2tlblN0cmluZyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpIHx8IFwiXCI7XG4gICAgICAgIHJldHVybiBwYXJzZVRva2VuU3RyaW5nKHRva2VuU3RyaW5nLCBlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKTtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZVRva2VuU3RyaW5nKHRva2VuU3RyaW5nLCBlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgcmV0dXJuIHRva2VuU3RyaW5nXG4gICAgICAgIC50cmltKClcbiAgICAgICAgLnNwbGl0KC9cXHMrLylcbiAgICAgICAgLmZpbHRlcigoY29udGVudCkgPT4gY29udGVudC5sZW5ndGgpXG4gICAgICAgIC5tYXAoKGNvbnRlbnQsIGluZGV4KSA9PiAoeyBlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBjb250ZW50LCBpbmRleCB9KSk7XG59XG5mdW5jdGlvbiB6aXAobGVmdCwgcmlnaHQpIHtcbiAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1heChsZWZ0Lmxlbmd0aCwgcmlnaHQubGVuZ3RoKTtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aCB9LCAoXywgaW5kZXgpID0+IFtsZWZ0W2luZGV4XSwgcmlnaHRbaW5kZXhdXSk7XG59XG5mdW5jdGlvbiB0b2tlbnNBcmVFcXVhbChsZWZ0LCByaWdodCkge1xuICAgIHJldHVybiBsZWZ0ICYmIHJpZ2h0ICYmIGxlZnQuaW5kZXggPT0gcmlnaHQuaW5kZXggJiYgbGVmdC5jb250ZW50ID09IHJpZ2h0LmNvbnRlbnQ7XG59XG5cbmNsYXNzIFZhbHVlTGlzdE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyID0gbmV3IFRva2VuTGlzdE9ic2VydmVyKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIHRoaXMpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMucGFyc2VSZXN1bHRzQnlUb2tlbiA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMudmFsdWVzQnlUb2tlbkJ5RWxlbWVudCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbkxpc3RPYnNlcnZlci5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgYXR0cmlidXRlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuYXR0cmlidXRlTmFtZTtcbiAgICB9XG4gICAgdG9rZW5NYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdG9rZW47XG4gICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXMuZmV0Y2hQYXJzZVJlc3VsdEZvclRva2VuKHRva2VuKTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmZldGNoVmFsdWVzQnlUb2tlbkZvckVsZW1lbnQoZWxlbWVudCkuc2V0KHRva2VuLCB2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkVmFsdWUoZWxlbWVudCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRva2VuVW5tYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdG9rZW47XG4gICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXMuZmV0Y2hQYXJzZVJlc3VsdEZvclRva2VuKHRva2VuKTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmZldGNoVmFsdWVzQnlUb2tlbkZvckVsZW1lbnQoZWxlbWVudCkuZGVsZXRlKHRva2VuKTtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZFZhbHVlKGVsZW1lbnQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmZXRjaFBhcnNlUmVzdWx0Rm9yVG9rZW4odG9rZW4pIHtcbiAgICAgICAgbGV0IHBhcnNlUmVzdWx0ID0gdGhpcy5wYXJzZVJlc3VsdHNCeVRva2VuLmdldCh0b2tlbik7XG4gICAgICAgIGlmICghcGFyc2VSZXN1bHQpIHtcbiAgICAgICAgICAgIHBhcnNlUmVzdWx0ID0gdGhpcy5wYXJzZVRva2VuKHRva2VuKTtcbiAgICAgICAgICAgIHRoaXMucGFyc2VSZXN1bHRzQnlUb2tlbi5zZXQodG9rZW4sIHBhcnNlUmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyc2VSZXN1bHQ7XG4gICAgfVxuICAgIGZldGNoVmFsdWVzQnlUb2tlbkZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBsZXQgdmFsdWVzQnlUb2tlbiA9IHRoaXMudmFsdWVzQnlUb2tlbkJ5RWxlbWVudC5nZXQoZWxlbWVudCk7XG4gICAgICAgIGlmICghdmFsdWVzQnlUb2tlbikge1xuICAgICAgICAgICAgdmFsdWVzQnlUb2tlbiA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzQnlUb2tlbkJ5RWxlbWVudC5zZXQoZWxlbWVudCwgdmFsdWVzQnlUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlc0J5VG9rZW47XG4gICAgfVxuICAgIHBhcnNlVG9rZW4odG9rZW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5kZWxlZ2F0ZS5wYXJzZVZhbHVlRm9yVG9rZW4odG9rZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWUgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGVycm9yIH07XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIEJpbmRpbmdPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLmJpbmRpbmdzQnlBY3Rpb24gPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIgPSBuZXcgVmFsdWVMaXN0T2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLmFjdGlvbkF0dHJpYnV0ZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXI7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBbGxBY3Rpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IGFjdGlvbkF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmFjdGlvbkF0dHJpYnV0ZTtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zY2hlbWE7XG4gICAgfVxuICAgIGdldCBiaW5kaW5ncygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5iaW5kaW5nc0J5QWN0aW9uLnZhbHVlcygpKTtcbiAgICB9XG4gICAgY29ubmVjdEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgY29uc3QgYmluZGluZyA9IG5ldyBCaW5kaW5nKHRoaXMuY29udGV4dCwgYWN0aW9uKTtcbiAgICAgICAgdGhpcy5iaW5kaW5nc0J5QWN0aW9uLnNldChhY3Rpb24sIGJpbmRpbmcpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLmJpbmRpbmdDb25uZWN0ZWQoYmluZGluZyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RBY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgIGNvbnN0IGJpbmRpbmcgPSB0aGlzLmJpbmRpbmdzQnlBY3Rpb24uZ2V0KGFjdGlvbik7XG4gICAgICAgIGlmIChiaW5kaW5nKSB7XG4gICAgICAgICAgICB0aGlzLmJpbmRpbmdzQnlBY3Rpb24uZGVsZXRlKGFjdGlvbik7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdEFsbEFjdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuYmluZGluZ3MuZm9yRWFjaCgoYmluZGluZykgPT4gdGhpcy5kZWxlZ2F0ZS5iaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcsIHRydWUpKTtcbiAgICAgICAgdGhpcy5iaW5kaW5nc0J5QWN0aW9uLmNsZWFyKCk7XG4gICAgfVxuICAgIHBhcnNlVmFsdWVGb3JUb2tlbih0b2tlbikge1xuICAgICAgICBjb25zdCBhY3Rpb24gPSBBY3Rpb24uZm9yVG9rZW4odG9rZW4sIHRoaXMuc2NoZW1hKTtcbiAgICAgICAgaWYgKGFjdGlvbi5pZGVudGlmaWVyID09IHRoaXMuaWRlbnRpZmllcikge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50TWF0Y2hlZFZhbHVlKGVsZW1lbnQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmNvbm5lY3RBY3Rpb24oYWN0aW9uKTtcbiAgICB9XG4gICAgZWxlbWVudFVubWF0Y2hlZFZhbHVlKGVsZW1lbnQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBY3Rpb24oYWN0aW9uKTtcbiAgICB9XG59XG5cbmNsYXNzIFZhbHVlT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIHJlY2VpdmVyKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMucmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXBPYnNlcnZlciA9IG5ldyBTdHJpbmdNYXBPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMpO1xuICAgICAgICB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcCA9IHRoaXMuY29udHJvbGxlci52YWx1ZURlc2NyaXB0b3JNYXA7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnN0cmluZ01hcE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrc0ZvckRlZmF1bHRWYWx1ZXMoKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXBPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmNvbnRyb2xsZXI7XG4gICAgfVxuICAgIGdldFN0cmluZ01hcEtleUZvckF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lIGluIHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZURlc2NyaXB0b3JNYXBbYXR0cmlidXRlTmFtZV0ubmFtZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBLZXlBZGRlZChrZXksIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwW2F0dHJpYnV0ZU5hbWVdO1xuICAgICAgICBpZiAoIXRoaXMuaGFzVmFsdWUoa2V5KSkge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2soa2V5LCBkZXNjcmlwdG9yLndyaXRlcih0aGlzLnJlY2VpdmVyW2tleV0pLCBkZXNjcmlwdG9yLndyaXRlcihkZXNjcmlwdG9yLmRlZmF1bHRWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcFZhbHVlQ2hhbmdlZCh2YWx1ZSwgbmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTmFtZU1hcFtuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAob2xkVmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIG9sZFZhbHVlID0gZGVzY3JpcHRvci53cml0ZXIoZGVzY3JpcHRvci5kZWZhdWx0VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKG5hbWUsIHZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfVxuICAgIHN0cmluZ01hcEtleVJlbW92ZWQoa2V5LCBhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JOYW1lTWFwW2tleV07XG4gICAgICAgIGlmICh0aGlzLmhhc1ZhbHVlKGtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKGtleSwgZGVzY3JpcHRvci53cml0ZXIodGhpcy5yZWNlaXZlcltrZXldKSwgb2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2soa2V5LCBkZXNjcmlwdG9yLndyaXRlcihkZXNjcmlwdG9yLmRlZmF1bHRWYWx1ZSksIG9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbnZva2VDaGFuZ2VkQ2FsbGJhY2tzRm9yRGVmYXVsdFZhbHVlcygpIHtcbiAgICAgICAgZm9yIChjb25zdCB7IGtleSwgbmFtZSwgZGVmYXVsdFZhbHVlLCB3cml0ZXIgfSBvZiB0aGlzLnZhbHVlRGVzY3JpcHRvcnMpIHtcbiAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWUgIT0gdW5kZWZpbmVkICYmICF0aGlzLmNvbnRyb2xsZXIuZGF0YS5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKG5hbWUsIHdyaXRlcihkZWZhdWx0VmFsdWUpLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGludm9rZUNoYW5nZWRDYWxsYmFjayhuYW1lLCByYXdWYWx1ZSwgcmF3T2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3QgY2hhbmdlZE1ldGhvZE5hbWUgPSBgJHtuYW1lfUNoYW5nZWRgO1xuICAgICAgICBjb25zdCBjaGFuZ2VkTWV0aG9kID0gdGhpcy5yZWNlaXZlcltjaGFuZ2VkTWV0aG9kTmFtZV07XG4gICAgICAgIGlmICh0eXBlb2YgY2hhbmdlZE1ldGhvZCA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck5hbWVNYXBbbmFtZV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZGVzY3JpcHRvci5yZWFkZXIocmF3VmFsdWUpO1xuICAgICAgICAgICAgICAgIGxldCBvbGRWYWx1ZSA9IHJhd09sZFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChyYXdPbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZSA9IGRlc2NyaXB0b3IucmVhZGVyKHJhd09sZFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hhbmdlZE1ldGhvZC5jYWxsKHRoaXMucmVjZWl2ZXIsIHZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSA9IGBTdGltdWx1cyBWYWx1ZSBcIiR7dGhpcy5jb250ZXh0LmlkZW50aWZpZXJ9LiR7ZGVzY3JpcHRvci5uYW1lfVwiIC0gJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB2YWx1ZURlc2NyaXB0b3JzKCkge1xuICAgICAgICBjb25zdCB7IHZhbHVlRGVzY3JpcHRvck1hcCB9ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHZhbHVlRGVzY3JpcHRvck1hcCkubWFwKChrZXkpID0+IHZhbHVlRGVzY3JpcHRvck1hcFtrZXldKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlRGVzY3JpcHRvck5hbWVNYXAoKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3JzID0ge307XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcFtrZXldO1xuICAgICAgICAgICAgZGVzY3JpcHRvcnNbZGVzY3JpcHRvci5uYW1lXSA9IGRlc2NyaXB0b3I7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcnM7XG4gICAgfVxuICAgIGhhc1ZhbHVlKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTmFtZU1hcFthdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgY29uc3QgaGFzTWV0aG9kTmFtZSA9IGBoYXMke2NhcGl0YWxpemUoZGVzY3JpcHRvci5uYW1lKX1gO1xuICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlcltoYXNNZXRob2ROYW1lXTtcbiAgICB9XG59XG5cbmNsYXNzIFRhcmdldE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMudGFyZ2V0c0J5TmFtZSA9IG5ldyBNdWx0aW1hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRva2VuTGlzdE9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyID0gbmV3IFRva2VuTGlzdE9ic2VydmVyKHRoaXMuZWxlbWVudCwgdGhpcy5hdHRyaWJ1dGVOYW1lLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy50b2tlbkxpc3RPYnNlcnZlcikge1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0QWxsVGFyZ2V0cygpO1xuICAgICAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy50b2tlbkxpc3RPYnNlcnZlcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b2tlbk1hdGNoZWQoeyBlbGVtZW50LCBjb250ZW50OiBuYW1lIH0pIHtcbiAgICAgICAgaWYgKHRoaXMuc2NvcGUuY29udGFpbnNFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9rZW5Vbm1hdGNoZWQoeyBlbGVtZW50LCBjb250ZW50OiBuYW1lIH0pIHtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpO1xuICAgIH1cbiAgICBjb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAoIXRoaXMudGFyZ2V0c0J5TmFtZS5oYXMobmFtZSwgZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0c0J5TmFtZS5hZGQobmFtZSwgZWxlbWVudCk7XG4gICAgICAgICAgICAoX2EgPSB0aGlzLnRva2VuTGlzdE9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGF1c2UoKCkgPT4gdGhpcy5kZWxlZ2F0ZS50YXJnZXRDb25uZWN0ZWQoZWxlbWVudCwgbmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldHNCeU5hbWUuaGFzKG5hbWUsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldHNCeU5hbWUuZGVsZXRlKG5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgKF9hID0gdGhpcy50b2tlbkxpc3RPYnNlcnZlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhdXNlKCgpID0+IHRoaXMuZGVsZWdhdGUudGFyZ2V0RGlzY29ubmVjdGVkKGVsZW1lbnQsIG5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0QWxsVGFyZ2V0cygpIHtcbiAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIHRoaXMudGFyZ2V0c0J5TmFtZS5rZXlzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy50YXJnZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShuYW1lKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdFRhcmdldChlbGVtZW50LCBuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYXR0cmlidXRlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIGBkYXRhLSR7dGhpcy5jb250ZXh0LmlkZW50aWZpZXJ9LXRhcmdldGA7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzY29wZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zY29wZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBhbmNlc3RvcnMgPSBnZXRBbmNlc3RvcnNGb3JDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcik7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oYW5jZXN0b3JzLnJlZHVjZSgodmFsdWVzLCBjb25zdHJ1Y3RvcikgPT4ge1xuICAgICAgICBnZXRPd25TdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKS5mb3JFYWNoKChuYW1lKSA9PiB2YWx1ZXMuYWRkKG5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9LCBuZXcgU2V0KCkpKTtcbn1cbmZ1bmN0aW9uIHJlYWRJbmhlcml0YWJsZVN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBhbmNlc3RvcnMgPSBnZXRBbmNlc3RvcnNGb3JDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcik7XG4gICAgcmV0dXJuIGFuY2VzdG9ycy5yZWR1Y2UoKHBhaXJzLCBjb25zdHJ1Y3RvcikgPT4ge1xuICAgICAgICBwYWlycy5wdXNoKC4uLmdldE93blN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHBhaXJzO1xuICAgIH0sIFtdKTtcbn1cbmZ1bmN0aW9uIGdldEFuY2VzdG9yc0ZvckNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgYW5jZXN0b3JzID0gW107XG4gICAgd2hpbGUgKGNvbnN0cnVjdG9yKSB7XG4gICAgICAgIGFuY2VzdG9ycy5wdXNoKGNvbnN0cnVjdG9yKTtcbiAgICAgICAgY29uc3RydWN0b3IgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoY29uc3RydWN0b3IpO1xuICAgIH1cbiAgICByZXR1cm4gYW5jZXN0b3JzLnJldmVyc2UoKTtcbn1cbmZ1bmN0aW9uIGdldE93blN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gY29uc3RydWN0b3JbcHJvcGVydHlOYW1lXTtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShkZWZpbml0aW9uKSA/IGRlZmluaXRpb24gOiBbXTtcbn1cbmZ1bmN0aW9uIGdldE93blN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gY29uc3RydWN0b3JbcHJvcGVydHlOYW1lXTtcbiAgICByZXR1cm4gZGVmaW5pdGlvbiA/IE9iamVjdC5rZXlzKGRlZmluaXRpb24pLm1hcCgoa2V5KSA9PiBba2V5LCBkZWZpbml0aW9uW2tleV1dKSA6IFtdO1xufVxuXG5jbGFzcyBPdXRsZXRPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5vdXRsZXRzQnlOYW1lID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUgPSBuZXcgTXVsdGltYXAoKTtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyTWFwID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0RGVmaW5pdGlvbnMuZm9yRWFjaCgob3V0bGV0TmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBBdHRyaWJ1dGVPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW50Q29udGV4dHMuZm9yRWFjaCgoY29udGV4dCkgPT4gY29udGV4dC5yZWZyZXNoKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIucmVmcmVzaCgpKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIucmVmcmVzaCgpKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBbGxPdXRsZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BTZWxlY3Rvck9ic2VydmVycygpO1xuICAgICAgICAgICAgdGhpcy5zdG9wQXR0cmlidXRlT2JzZXJ2ZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcFNlbGVjdG9yT2JzZXJ2ZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZm9yRWFjaCgob2JzZXJ2ZXIpID0+IG9ic2VydmVyLnN0b3AoKSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wQXR0cmlidXRlT2JzZXJ2ZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIuc3RvcCgpKTtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXJNYXAuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3Rvck1hdGNoZWQoZWxlbWVudCwgX3NlbGVjdG9yLCB7IG91dGxldE5hbWUgfSkge1xuICAgICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLmdldE91dGxldChlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKG91dGxldCkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0b3JVbm1hdGNoZWQoZWxlbWVudCwgX3NlbGVjdG9yLCB7IG91dGxldE5hbWUgfSkge1xuICAgICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLmdldE91dGxldEZyb21NYXAoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIGlmIChvdXRsZXQpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdE91dGxldChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdG9yTWF0Y2hFbGVtZW50KGVsZW1lbnQsIHsgb3V0bGV0TmFtZSB9KSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5zZWxlY3RvcihvdXRsZXROYW1lKTtcbiAgICAgICAgY29uc3QgaGFzT3V0bGV0ID0gdGhpcy5oYXNPdXRsZXQoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIGNvbnN0IGhhc091dGxldENvbnRyb2xsZXIgPSBlbGVtZW50Lm1hdGNoZXMoYFske3RoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGV9fj0ke291dGxldE5hbWV9XWApO1xuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBoYXNPdXRsZXQgJiYgaGFzT3V0bGV0Q29udHJvbGxlciAmJiBlbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKF9lbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IG91dGxldE5hbWUgPSB0aGlzLmdldE91dGxldE5hbWVGcm9tT3V0bGV0QXR0cmlidXRlTmFtZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKG91dGxldE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkKF9lbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IG91dGxldE5hbWUgPSB0aGlzLmdldE91dGxldE5hbWVGcm9tT3V0bGV0QXR0cmlidXRlTmFtZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKG91dGxldE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkQXR0cmlidXRlKF9lbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IG91dGxldE5hbWUgPSB0aGlzLmdldE91dGxldE5hbWVGcm9tT3V0bGV0QXR0cmlidXRlTmFtZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKG91dGxldE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICghdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5oYXMob3V0bGV0TmFtZSwgZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0c0J5TmFtZS5hZGQob3V0bGV0TmFtZSwgb3V0bGV0KTtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuYWRkKG91dGxldE5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgKF9hID0gdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLmdldChvdXRsZXROYW1lKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhdXNlKCgpID0+IHRoaXMuZGVsZWdhdGUub3V0bGV0Q29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuaGFzKG91dGxldE5hbWUsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLm91dGxldHNCeU5hbWUuZGVsZXRlKG91dGxldE5hbWUsIG91dGxldCk7XG4gICAgICAgICAgICB0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmRlbGV0ZShvdXRsZXROYW1lLCBlbGVtZW50KTtcbiAgICAgICAgICAgIChfYSA9IHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcFxuICAgICAgICAgICAgICAgIC5nZXQob3V0bGV0TmFtZSkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXVzZSgoKSA9PiB0aGlzLmRlbGVnYXRlLm91dGxldERpc2Nvbm5lY3RlZChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0QWxsT3V0bGV0cygpIHtcbiAgICAgICAgZm9yIChjb25zdCBvdXRsZXROYW1lIG9mIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUua2V5cykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuZ2V0VmFsdWVzRm9yS2V5KG91dGxldE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBvdXRsZXQgb2YgdGhpcy5vdXRsZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShvdXRsZXROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLmdldChvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKG9ic2VydmVyKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5zZWxlY3RvciA9IHRoaXMuc2VsZWN0b3Iob3V0bGV0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0dXBTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yKG91dGxldE5hbWUpO1xuICAgICAgICBjb25zdCBzZWxlY3Rvck9ic2VydmVyID0gbmV3IFNlbGVjdG9yT2JzZXJ2ZXIoZG9jdW1lbnQuYm9keSwgc2VsZWN0b3IsIHRoaXMsIHsgb3V0bGV0TmFtZSB9KTtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLnNldChvdXRsZXROYW1lLCBzZWxlY3Rvck9ic2VydmVyKTtcbiAgICAgICAgc2VsZWN0b3JPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzZXR1cEF0dHJpYnV0ZU9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuYXR0cmlidXRlTmFtZUZvck91dGxldE5hbWUob3V0bGV0TmFtZSk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU9ic2VydmVyID0gbmV3IEF0dHJpYnV0ZU9ic2VydmVyKHRoaXMuc2NvcGUuZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXJNYXAuc2V0KG91dGxldE5hbWUsIGF0dHJpYnV0ZU9ic2VydmVyKTtcbiAgICAgICAgYXR0cmlidXRlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgc2VsZWN0b3Iob3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5vdXRsZXRzLmdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICB9XG4gICAgYXR0cmlidXRlTmFtZUZvck91dGxldE5hbWUob3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5zY2hlbWEub3V0bGV0QXR0cmlidXRlRm9yU2NvcGUodGhpcy5pZGVudGlmaWVyLCBvdXRsZXROYW1lKTtcbiAgICB9XG4gICAgZ2V0T3V0bGV0TmFtZUZyb21PdXRsZXRBdHRyaWJ1dGVOYW1lKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0RGVmaW5pdGlvbnMuZmluZCgob3V0bGV0TmFtZSkgPT4gdGhpcy5hdHRyaWJ1dGVOYW1lRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKSA9PT0gYXR0cmlidXRlTmFtZSk7XG4gICAgfVxuICAgIGdldCBvdXRsZXREZXBlbmRlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBNdWx0aW1hcCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5tb2R1bGVzLmZvckVhY2goKG1vZHVsZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29uc3RydWN0b3IgPSBtb2R1bGUuZGVmaW5pdGlvbi5jb250cm9sbGVyQ29uc3RydWN0b3I7XG4gICAgICAgICAgICBjb25zdCBvdXRsZXRzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwib3V0bGV0c1wiKTtcbiAgICAgICAgICAgIG91dGxldHMuZm9yRWFjaCgob3V0bGV0KSA9PiBkZXBlbmRlbmNpZXMuYWRkKG91dGxldCwgbW9kdWxlLmlkZW50aWZpZXIpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZXBlbmRlbmNpZXM7XG4gICAgfVxuICAgIGdldCBvdXRsZXREZWZpbml0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0RGVwZW5kZW5jaWVzLmdldEtleXNGb3JWYWx1ZSh0aGlzLmlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBnZXQgZGVwZW5kZW50Q29udHJvbGxlcklkZW50aWZpZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXREZXBlbmRlbmNpZXMuZ2V0VmFsdWVzRm9yS2V5KHRoaXMuaWRlbnRpZmllcik7XG4gICAgfVxuICAgIGdldCBkZXBlbmRlbnRDb250ZXh0cygpIHtcbiAgICAgICAgY29uc3QgaWRlbnRpZmllcnMgPSB0aGlzLmRlcGVuZGVudENvbnRyb2xsZXJJZGVudGlmaWVycztcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbnRleHRzLmZpbHRlcigoY29udGV4dCkgPT4gaWRlbnRpZmllcnMuaW5jbHVkZXMoY29udGV4dC5pZGVudGlmaWVyKSk7XG4gICAgfVxuICAgIGhhc091dGxldChlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuZ2V0T3V0bGV0KGVsZW1lbnQsIG91dGxldE5hbWUpIHx8ICEhdGhpcy5nZXRPdXRsZXRGcm9tTWFwKGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBnZXRPdXRsZXQoZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGdldE91dGxldEZyb21NYXAoZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShvdXRsZXROYW1lKS5maW5kKChvdXRsZXQpID0+IG91dGxldC5lbGVtZW50ID09PSBlbGVtZW50KTtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IGFwcGxpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBnZXQgcm91dGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWNhdGlvbi5yb3V0ZXI7XG4gICAgfVxufVxuXG5jbGFzcyBDb250ZXh0IHtcbiAgICBjb25zdHJ1Y3Rvcihtb2R1bGUsIHNjb3BlKSB7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eSA9IChmdW5jdGlvbk5hbWUsIGRldGFpbCA9IHt9KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXIsIGVsZW1lbnQgfSA9IHRoaXM7XG4gICAgICAgICAgICBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCB9LCBkZXRhaWwpO1xuICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbi5sb2dEZWJ1Z0FjdGl2aXR5KHRoaXMuaWRlbnRpZmllciwgZnVuY3Rpb25OYW1lLCBkZXRhaWwpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm1vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgbW9kdWxlLmNvbnRyb2xsZXJDb25zdHJ1Y3Rvcih0aGlzKTtcbiAgICAgICAgdGhpcy5iaW5kaW5nT2JzZXJ2ZXIgPSBuZXcgQmluZGluZ09ic2VydmVyKHRoaXMsIHRoaXMuZGlzcGF0Y2hlcik7XG4gICAgICAgIHRoaXMudmFsdWVPYnNlcnZlciA9IG5ldyBWYWx1ZU9ic2VydmVyKHRoaXMsIHRoaXMuY29udHJvbGxlcik7XG4gICAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIgPSBuZXcgVGFyZ2V0T2JzZXJ2ZXIodGhpcywgdGhpcyk7XG4gICAgICAgIHRoaXMub3V0bGV0T2JzZXJ2ZXIgPSBuZXcgT3V0bGV0T2JzZXJ2ZXIodGhpcywgdGhpcyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiaW5pdGlhbGl6ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIFwiaW5pdGlhbGl6aW5nIGNvbnRyb2xsZXJcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5iaW5kaW5nT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy52YWx1ZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5vdXRsZXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmNvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImNvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBcImNvbm5lY3RpbmcgY29udHJvbGxlclwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLm91dGxldE9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJkaXNjb25uZWN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgXCJkaXNjb25uZWN0aW5nIGNvbnRyb2xsZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vdXRsZXRPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLnZhbHVlT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLmJpbmRpbmdPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGdldCBhcHBsaWNhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kdWxlLmFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kdWxlLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGRpc3BhdGNoZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLmRpc3BhdGNoZXI7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgcGFyZW50RWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsID0ge30pIHtcbiAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50IH0gPSB0aGlzO1xuICAgICAgICBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCB9LCBkZXRhaWwpO1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmhhbmRsZUVycm9yKGVycm9yLCBgRXJyb3IgJHttZXNzYWdlfWAsIGRldGFpbCk7XG4gICAgfVxuICAgIHRhcmdldENvbm5lY3RlZChlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lfVRhcmdldENvbm5lY3RlZGAsIGVsZW1lbnQpO1xuICAgIH1cbiAgICB0YXJnZXREaXNjb25uZWN0ZWQoZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB0aGlzLmludm9rZUNvbnRyb2xsZXJNZXRob2QoYCR7bmFtZX1UYXJnZXREaXNjb25uZWN0ZWRgLCBlbGVtZW50KTtcbiAgICB9XG4gICAgb3V0bGV0Q29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB0aGlzLmludm9rZUNvbnRyb2xsZXJNZXRob2QoYCR7bmFtZXNwYWNlQ2FtZWxpemUobmFtZSl9T3V0bGV0Q29ubmVjdGVkYCwgb3V0bGV0LCBlbGVtZW50KTtcbiAgICB9XG4gICAgb3V0bGV0RGlzY29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB0aGlzLmludm9rZUNvbnRyb2xsZXJNZXRob2QoYCR7bmFtZXNwYWNlQ2FtZWxpemUobmFtZSl9T3V0bGV0RGlzY29ubmVjdGVkYCwgb3V0bGV0LCBlbGVtZW50KTtcbiAgICB9XG4gICAgaW52b2tlQ29udHJvbGxlck1ldGhvZChtZXRob2ROYW1lLCAuLi5hcmdzKSB7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSB0aGlzLmNvbnRyb2xsZXI7XG4gICAgICAgIGlmICh0eXBlb2YgY29udHJvbGxlclttZXRob2ROYW1lXSA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXJbbWV0aG9kTmFtZV0oLi4uYXJncyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGJsZXNzKGNvbnN0cnVjdG9yKSB7XG4gICAgcmV0dXJuIHNoYWRvdyhjb25zdHJ1Y3RvciwgZ2V0Qmxlc3NlZFByb3BlcnRpZXMoY29uc3RydWN0b3IpKTtcbn1cbmZ1bmN0aW9uIHNoYWRvdyhjb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIGNvbnN0IHNoYWRvd0NvbnN0cnVjdG9yID0gZXh0ZW5kKGNvbnN0cnVjdG9yKTtcbiAgICBjb25zdCBzaGFkb3dQcm9wZXJ0aWVzID0gZ2V0U2hhZG93UHJvcGVydGllcyhjb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3BlcnRpZXMpO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHNoYWRvd0NvbnN0cnVjdG9yLnByb3RvdHlwZSwgc2hhZG93UHJvcGVydGllcyk7XG4gICAgcmV0dXJuIHNoYWRvd0NvbnN0cnVjdG9yO1xufVxuZnVuY3Rpb24gZ2V0Qmxlc3NlZFByb3BlcnRpZXMoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCBibGVzc2luZ3MgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgXCJibGVzc2luZ3NcIik7XG4gICAgcmV0dXJuIGJsZXNzaW5ncy5yZWR1Y2UoKGJsZXNzZWRQcm9wZXJ0aWVzLCBibGVzc2luZykgPT4ge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gYmxlc3NpbmcoY29uc3RydWN0b3IpO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gYmxlc3NlZFByb3BlcnRpZXNba2V5XSB8fCB7fTtcbiAgICAgICAgICAgIGJsZXNzZWRQcm9wZXJ0aWVzW2tleV0gPSBPYmplY3QuYXNzaWduKGRlc2NyaXB0b3IsIHByb3BlcnRpZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJsZXNzZWRQcm9wZXJ0aWVzO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIGdldFNoYWRvd1Byb3BlcnRpZXMocHJvdG90eXBlLCBwcm9wZXJ0aWVzKSB7XG4gICAgcmV0dXJuIGdldE93bktleXMocHJvcGVydGllcykucmVkdWNlKChzaGFkb3dQcm9wZXJ0aWVzLCBrZXkpID0+IHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IGdldFNoYWRvd2VkRGVzY3JpcHRvcihwcm90b3R5cGUsIHByb3BlcnRpZXMsIGtleSk7XG4gICAgICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHNoYWRvd1Byb3BlcnRpZXMsIHsgW2tleV06IGRlc2NyaXB0b3IgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYWRvd1Byb3BlcnRpZXM7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gZ2V0U2hhZG93ZWREZXNjcmlwdG9yKHByb3RvdHlwZSwgcHJvcGVydGllcywga2V5KSB7XG4gICAgY29uc3Qgc2hhZG93aW5nRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG90eXBlLCBrZXkpO1xuICAgIGNvbnN0IHNoYWRvd2VkQnlWYWx1ZSA9IHNoYWRvd2luZ0Rlc2NyaXB0b3IgJiYgXCJ2YWx1ZVwiIGluIHNoYWRvd2luZ0Rlc2NyaXB0b3I7XG4gICAgaWYgKCFzaGFkb3dlZEJ5VmFsdWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvcGVydGllcywga2V5KS52YWx1ZTtcbiAgICAgICAgaWYgKHNoYWRvd2luZ0Rlc2NyaXB0b3IpIHtcbiAgICAgICAgICAgIGRlc2NyaXB0b3IuZ2V0ID0gc2hhZG93aW5nRGVzY3JpcHRvci5nZXQgfHwgZGVzY3JpcHRvci5nZXQ7XG4gICAgICAgICAgICBkZXNjcmlwdG9yLnNldCA9IHNoYWRvd2luZ0Rlc2NyaXB0b3Iuc2V0IHx8IGRlc2NyaXB0b3Iuc2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH1cbn1cbmNvbnN0IGdldE93bktleXMgPSAoKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIChvYmplY3QpID0+IFsuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmplY3QpLCAuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCldO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICAgIH1cbn0pKCk7XG5jb25zdCBleHRlbmQgPSAoKCkgPT4ge1xuICAgIGZ1bmN0aW9uIGV4dGVuZFdpdGhSZWZsZWN0KGNvbnN0cnVjdG9yKSB7XG4gICAgICAgIGZ1bmN0aW9uIGV4dGVuZGVkKCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuY29uc3RydWN0KGNvbnN0cnVjdG9yLCBhcmd1bWVudHMsIG5ldy50YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGV4dGVuZGVkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoY29uc3RydWN0b3IucHJvdG90eXBlLCB7XG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogZXh0ZW5kZWQgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIFJlZmxlY3Quc2V0UHJvdG90eXBlT2YoZXh0ZW5kZWQsIGNvbnN0cnVjdG9yKTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZGVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0ZXN0UmVmbGVjdEV4dGVuc2lvbigpIHtcbiAgICAgICAgY29uc3QgYSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuYS5jYWxsKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBiID0gZXh0ZW5kV2l0aFJlZmxlY3QoYSk7XG4gICAgICAgIGIucHJvdG90eXBlLmEgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIHJldHVybiBuZXcgYigpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICB0ZXN0UmVmbGVjdEV4dGVuc2lvbigpO1xuICAgICAgICByZXR1cm4gZXh0ZW5kV2l0aFJlZmxlY3Q7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gKGNvbnN0cnVjdG9yKSA9PiBjbGFzcyBleHRlbmRlZCBleHRlbmRzIGNvbnN0cnVjdG9yIHtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuXG5mdW5jdGlvbiBibGVzc0RlZmluaXRpb24oZGVmaW5pdGlvbikge1xuICAgIHJldHVybiB7XG4gICAgICAgIGlkZW50aWZpZXI6IGRlZmluaXRpb24uaWRlbnRpZmllcixcbiAgICAgICAgY29udHJvbGxlckNvbnN0cnVjdG9yOiBibGVzcyhkZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3RvciksXG4gICAgfTtcbn1cblxuY2xhc3MgTW9kdWxlIHtcbiAgICBjb25zdHJ1Y3RvcihhcHBsaWNhdGlvbiwgZGVmaW5pdGlvbikge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uID0gYXBwbGljYXRpb247XG4gICAgICAgIHRoaXMuZGVmaW5pdGlvbiA9IGJsZXNzRGVmaW5pdGlvbihkZWZpbml0aW9uKTtcbiAgICAgICAgdGhpcy5jb250ZXh0c0J5U2NvcGUgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENvbnRleHRzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmaW5pdGlvbi5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckNvbnN0cnVjdG9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3RvcjtcbiAgICB9XG4gICAgZ2V0IGNvbnRleHRzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmNvbm5lY3RlZENvbnRleHRzKTtcbiAgICB9XG4gICAgY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5mZXRjaENvbnRleHRGb3JTY29wZShzY29wZSk7XG4gICAgICAgIHRoaXMuY29ubmVjdGVkQ29udGV4dHMuYWRkKGNvbnRleHQpO1xuICAgICAgICBjb250ZXh0LmNvbm5lY3QoKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb250ZXh0c0J5U2NvcGUuZ2V0KHNjb3BlKTtcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkQ29udGV4dHMuZGVsZXRlKGNvbnRleHQpO1xuICAgICAgICAgICAgY29udGV4dC5kaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hDb250ZXh0Rm9yU2NvcGUoc2NvcGUpIHtcbiAgICAgICAgbGV0IGNvbnRleHQgPSB0aGlzLmNvbnRleHRzQnlTY29wZS5nZXQoc2NvcGUpO1xuICAgICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgICAgIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0aGlzLCBzY29wZSk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHRzQnlTY29wZS5zZXQoc2NvcGUsIGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cbn1cblxuY2xhc3MgQ2xhc3NNYXAge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB9XG4gICAgaGFzKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5oYXModGhpcy5nZXREYXRhS2V5KG5hbWUpKTtcbiAgICB9XG4gICAgZ2V0KG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsKG5hbWUpWzBdO1xuICAgIH1cbiAgICBnZXRBbGwobmFtZSkge1xuICAgICAgICBjb25zdCB0b2tlblN0cmluZyA9IHRoaXMuZGF0YS5nZXQodGhpcy5nZXREYXRhS2V5KG5hbWUpKSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gdG9rZW5pemUodG9rZW5TdHJpbmcpO1xuICAgIH1cbiAgICBnZXRBdHRyaWJ1dGVOYW1lKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5nZXRBdHRyaWJ1dGVOYW1lRm9yS2V5KHRoaXMuZ2V0RGF0YUtleShuYW1lKSk7XG4gICAgfVxuICAgIGdldERhdGFLZXkobmFtZSkge1xuICAgICAgICByZXR1cm4gYCR7bmFtZX0tY2xhc3NgO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZGF0YTtcbiAgICB9XG59XG5cbmNsYXNzIERhdGFNYXAge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQoa2V5KSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7XG4gICAgfVxuICAgIHNldChrZXksIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmdldChrZXkpO1xuICAgIH1cbiAgICBoYXMoa2V5KSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUobmFtZSk7XG4gICAgfVxuICAgIGRlbGV0ZShrZXkpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRBdHRyaWJ1dGVOYW1lRm9yS2V5KGtleSkge1xuICAgICAgICByZXR1cm4gYGRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LSR7ZGFzaGVyaXplKGtleSl9YDtcbiAgICB9XG59XG5cbmNsYXNzIEd1aWRlIHtcbiAgICBjb25zdHJ1Y3Rvcihsb2dnZXIpIHtcbiAgICAgICAgdGhpcy53YXJuZWRLZXlzQnlPYmplY3QgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlcjtcbiAgICB9XG4gICAgd2FybihvYmplY3QsIGtleSwgbWVzc2FnZSkge1xuICAgICAgICBsZXQgd2FybmVkS2V5cyA9IHRoaXMud2FybmVkS2V5c0J5T2JqZWN0LmdldChvYmplY3QpO1xuICAgICAgICBpZiAoIXdhcm5lZEtleXMpIHtcbiAgICAgICAgICAgIHdhcm5lZEtleXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICB0aGlzLndhcm5lZEtleXNCeU9iamVjdC5zZXQob2JqZWN0LCB3YXJuZWRLZXlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXdhcm5lZEtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHdhcm5lZEtleXMuYWRkKGtleSk7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKG1lc3NhZ2UsIG9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGF0dHJpYnV0ZVZhbHVlQ29udGFpbnNUb2tlbihhdHRyaWJ1dGVOYW1lLCB0b2tlbikge1xuICAgIHJldHVybiBgWyR7YXR0cmlidXRlTmFtZX1+PVwiJHt0b2tlbn1cIl1gO1xufVxuXG5jbGFzcyBUYXJnZXRTZXQge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5zY2hlbWE7XG4gICAgfVxuICAgIGhhcyh0YXJnZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQodGFyZ2V0TmFtZSkgIT0gbnVsbDtcbiAgICB9XG4gICAgZmluZCguLi50YXJnZXROYW1lcykge1xuICAgICAgICByZXR1cm4gdGFyZ2V0TmFtZXMucmVkdWNlKCh0YXJnZXQsIHRhcmdldE5hbWUpID0+IHRhcmdldCB8fCB0aGlzLmZpbmRUYXJnZXQodGFyZ2V0TmFtZSkgfHwgdGhpcy5maW5kTGVnYWN5VGFyZ2V0KHRhcmdldE5hbWUpLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBmaW5kQWxsKC4uLnRhcmdldE5hbWVzKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXROYW1lcy5yZWR1Y2UoKHRhcmdldHMsIHRhcmdldE5hbWUpID0+IFtcbiAgICAgICAgICAgIC4uLnRhcmdldHMsXG4gICAgICAgICAgICAuLi50aGlzLmZpbmRBbGxUYXJnZXRzKHRhcmdldE5hbWUpLFxuICAgICAgICAgICAgLi4udGhpcy5maW5kQWxsTGVnYWN5VGFyZ2V0cyh0YXJnZXROYW1lKSxcbiAgICAgICAgXSwgW10pO1xuICAgIH1cbiAgICBmaW5kVGFyZ2V0KHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZmluZEVsZW1lbnQoc2VsZWN0b3IpO1xuICAgIH1cbiAgICBmaW5kQWxsVGFyZ2V0cyh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5nZXRTZWxlY3RvckZvclRhcmdldE5hbWUodGFyZ2V0TmFtZSk7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmZpbmRBbGxFbGVtZW50cyhzZWxlY3Rvcik7XG4gICAgfVxuICAgIGdldFNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLnNjaGVtYS50YXJnZXRBdHRyaWJ1dGVGb3JTY29wZSh0aGlzLmlkZW50aWZpZXIpO1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKGF0dHJpYnV0ZU5hbWUsIHRhcmdldE5hbWUpO1xuICAgIH1cbiAgICBmaW5kTGVnYWN5VGFyZ2V0KHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldExlZ2FjeVNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVwcmVjYXRlKHRoaXMuc2NvcGUuZmluZEVsZW1lbnQoc2VsZWN0b3IpLCB0YXJnZXROYW1lKTtcbiAgICB9XG4gICAgZmluZEFsbExlZ2FjeVRhcmdldHModGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0TGVnYWN5U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5maW5kQWxsRWxlbWVudHMoc2VsZWN0b3IpLm1hcCgoZWxlbWVudCkgPT4gdGhpcy5kZXByZWNhdGUoZWxlbWVudCwgdGFyZ2V0TmFtZSkpO1xuICAgIH1cbiAgICBnZXRMZWdhY3lTZWxlY3RvckZvclRhcmdldE5hbWUodGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCB0YXJnZXREZXNjcmlwdG9yID0gYCR7dGhpcy5pZGVudGlmaWVyfS4ke3RhcmdldE5hbWV9YDtcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZVZhbHVlQ29udGFpbnNUb2tlbih0aGlzLnNjaGVtYS50YXJnZXRBdHRyaWJ1dGUsIHRhcmdldERlc2NyaXB0b3IpO1xuICAgIH1cbiAgICBkZXByZWNhdGUoZWxlbWVudCwgdGFyZ2V0TmFtZSkge1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyIH0gPSB0aGlzO1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuc2NoZW1hLnRhcmdldEF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGNvbnN0IHJldmlzZWRBdHRyaWJ1dGVOYW1lID0gdGhpcy5zY2hlbWEudGFyZ2V0QXR0cmlidXRlRm9yU2NvcGUoaWRlbnRpZmllcik7XG4gICAgICAgICAgICB0aGlzLmd1aWRlLndhcm4oZWxlbWVudCwgYHRhcmdldDoke3RhcmdldE5hbWV9YCwgYFBsZWFzZSByZXBsYWNlICR7YXR0cmlidXRlTmFtZX09XCIke2lkZW50aWZpZXJ9LiR7dGFyZ2V0TmFtZX1cIiB3aXRoICR7cmV2aXNlZEF0dHJpYnV0ZU5hbWV9PVwiJHt0YXJnZXROYW1lfVwiLiBgICtcbiAgICAgICAgICAgICAgICBgVGhlICR7YXR0cmlidXRlTmFtZX0gYXR0cmlidXRlIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uIG9mIFN0aW11bHVzLmApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgIH1cbiAgICBnZXQgZ3VpZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmd1aWRlO1xuICAgIH1cbn1cblxuY2xhc3MgT3V0bGV0U2V0IHtcbiAgICBjb25zdHJ1Y3RvcihzY29wZSwgY29udHJvbGxlckVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXJFbGVtZW50ID0gY29udHJvbGxlckVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuc2NoZW1hO1xuICAgIH1cbiAgICBoYXMob3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kKG91dGxldE5hbWUpICE9IG51bGw7XG4gICAgfVxuICAgIGZpbmQoLi4ub3V0bGV0TmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIG91dGxldE5hbWVzLnJlZHVjZSgob3V0bGV0LCBvdXRsZXROYW1lKSA9PiBvdXRsZXQgfHwgdGhpcy5maW5kT3V0bGV0KG91dGxldE5hbWUpLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBmaW5kQWxsKC4uLm91dGxldE5hbWVzKSB7XG4gICAgICAgIHJldHVybiBvdXRsZXROYW1lcy5yZWR1Y2UoKG91dGxldHMsIG91dGxldE5hbWUpID0+IFsuLi5vdXRsZXRzLCAuLi50aGlzLmZpbmRBbGxPdXRsZXRzKG91dGxldE5hbWUpXSwgW10pO1xuICAgIH1cbiAgICBnZXRTZWxlY3RvckZvck91dGxldE5hbWUob3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5zY2hlbWEub3V0bGV0QXR0cmlidXRlRm9yU2NvcGUodGhpcy5pZGVudGlmaWVyLCBvdXRsZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udHJvbGxlckVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgIH1cbiAgICBmaW5kT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKHNlbGVjdG9yKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZEVsZW1lbnQoc2VsZWN0b3IsIG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBmaW5kQWxsT3V0bGV0cyhvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5nZXRTZWxlY3RvckZvck91dGxldE5hbWUob3V0bGV0TmFtZSk7XG4gICAgICAgIHJldHVybiBzZWxlY3RvciA/IHRoaXMuZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yLCBvdXRsZXROYW1lKSA6IFtdO1xuICAgIH1cbiAgICBmaW5kRWxlbWVudChzZWxlY3Rvciwgb3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMuc2NvcGUucXVlcnlFbGVtZW50cyhzZWxlY3Rvcik7XG4gICAgICAgIHJldHVybiBlbGVtZW50cy5maWx0ZXIoKGVsZW1lbnQpID0+IHRoaXMubWF0Y2hlc0VsZW1lbnQoZWxlbWVudCwgc2VsZWN0b3IsIG91dGxldE5hbWUpKVswXTtcbiAgICB9XG4gICAgZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yLCBvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5zY29wZS5xdWVyeUVsZW1lbnRzKHNlbGVjdG9yKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbHRlcigoZWxlbWVudCkgPT4gdGhpcy5tYXRjaGVzRWxlbWVudChlbGVtZW50LCBzZWxlY3Rvciwgb3V0bGV0TmFtZSkpO1xuICAgIH1cbiAgICBtYXRjaGVzRWxlbWVudChlbGVtZW50LCBzZWxlY3Rvciwgb3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBjb250cm9sbGVyQXR0cmlidXRlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUodGhpcy5zY29wZS5zY2hlbWEuY29udHJvbGxlckF0dHJpYnV0ZSkgfHwgXCJcIjtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikgJiYgY29udHJvbGxlckF0dHJpYnV0ZS5zcGxpdChcIiBcIikuaW5jbHVkZXMob3V0bGV0TmFtZSk7XG4gICAgfVxufVxuXG5jbGFzcyBTY29wZSB7XG4gICAgY29uc3RydWN0b3Ioc2NoZW1hLCBlbGVtZW50LCBpZGVudGlmaWVyLCBsb2dnZXIpIHtcbiAgICAgICAgdGhpcy50YXJnZXRzID0gbmV3IFRhcmdldFNldCh0aGlzKTtcbiAgICAgICAgdGhpcy5jbGFzc2VzID0gbmV3IENsYXNzTWFwKHRoaXMpO1xuICAgICAgICB0aGlzLmRhdGEgPSBuZXcgRGF0YU1hcCh0aGlzKTtcbiAgICAgICAgdGhpcy5jb250YWluc0VsZW1lbnQgPSAoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuY2xvc2VzdCh0aGlzLmNvbnRyb2xsZXJTZWxlY3RvcikgPT09IHRoaXMuZWxlbWVudDtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaWRlbnRpZmllciA9IGlkZW50aWZpZXI7XG4gICAgICAgIHRoaXMuZ3VpZGUgPSBuZXcgR3VpZGUobG9nZ2VyKTtcbiAgICAgICAgdGhpcy5vdXRsZXRzID0gbmV3IE91dGxldFNldCh0aGlzLmRvY3VtZW50U2NvcGUsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBmaW5kRWxlbWVudChzZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpID8gdGhpcy5lbGVtZW50IDogdGhpcy5xdWVyeUVsZW1lbnRzKHNlbGVjdG9yKS5maW5kKHRoaXMuY29udGFpbnNFbGVtZW50KTtcbiAgICB9XG4gICAgZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAuLi4odGhpcy5lbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpID8gW3RoaXMuZWxlbWVudF0gOiBbXSksXG4gICAgICAgICAgICAuLi50aGlzLnF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpLmZpbHRlcih0aGlzLmNvbnRhaW5zRWxlbWVudCksXG4gICAgICAgIF07XG4gICAgfVxuICAgIHF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXJTZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZVZhbHVlQ29udGFpbnNUb2tlbih0aGlzLnNjaGVtYS5jb250cm9sbGVyQXR0cmlidXRlLCB0aGlzLmlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBnZXQgaXNEb2N1bWVudFNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50ID09PSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBkb2N1bWVudFNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0RvY3VtZW50U2NvcGVcbiAgICAgICAgICAgID8gdGhpc1xuICAgICAgICAgICAgOiBuZXcgU2NvcGUodGhpcy5zY2hlbWEsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgdGhpcy5pZGVudGlmaWVyLCB0aGlzLmd1aWRlLmxvZ2dlcik7XG4gICAgfVxufVxuXG5jbGFzcyBTY29wZU9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBzY2hlbWEsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIgPSBuZXcgVmFsdWVMaXN0T2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLmNvbnRyb2xsZXJBdHRyaWJ1dGUsIHRoaXMpO1xuICAgICAgICB0aGlzLnNjb3Blc0J5SWRlbnRpZmllckJ5RWxlbWVudCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMuc2NvcGVSZWZlcmVuY2VDb3VudHMgPSBuZXcgV2Vha01hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXJBdHRyaWJ1dGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjaGVtYS5jb250cm9sbGVyQXR0cmlidXRlO1xuICAgIH1cbiAgICBwYXJzZVZhbHVlRm9yVG9rZW4odG9rZW4pIHtcbiAgICAgICAgY29uc3QgeyBlbGVtZW50LCBjb250ZW50OiBpZGVudGlmaWVyIH0gPSB0b2tlbjtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VWYWx1ZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBwYXJzZVZhbHVlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBzY29wZXNCeUlkZW50aWZpZXIgPSB0aGlzLmZldGNoU2NvcGVzQnlJZGVudGlmaWVyRm9yRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgbGV0IHNjb3BlID0gc2NvcGVzQnlJZGVudGlmaWVyLmdldChpZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKCFzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUgPSB0aGlzLmRlbGVnYXRlLmNyZWF0ZVNjb3BlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcik7XG4gICAgICAgICAgICBzY29wZXNCeUlkZW50aWZpZXIuc2V0KGlkZW50aWZpZXIsIHNjb3BlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkVmFsdWUoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlQ291bnQgPSAodGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5nZXQodmFsdWUpIHx8IDApICsgMTtcbiAgICAgICAgdGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5zZXQodmFsdWUsIHJlZmVyZW5jZUNvdW50KTtcbiAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50ID09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc2NvcGVDb25uZWN0ZWQodmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRWYWx1ZShlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VDb3VudCA9IHRoaXMuc2NvcGVSZWZlcmVuY2VDb3VudHMuZ2V0KHZhbHVlKTtcbiAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50KSB7XG4gICAgICAgICAgICB0aGlzLnNjb3BlUmVmZXJlbmNlQ291bnRzLnNldCh2YWx1ZSwgcmVmZXJlbmNlQ291bnQgLSAxKTtcbiAgICAgICAgICAgIGlmIChyZWZlcmVuY2VDb3VudCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zY29wZURpc2Nvbm5lY3RlZCh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hTY29wZXNCeUlkZW50aWZpZXJGb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IHNjb3Blc0J5SWRlbnRpZmllciA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50LmdldChlbGVtZW50KTtcbiAgICAgICAgaWYgKCFzY29wZXNCeUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHNjb3Blc0J5SWRlbnRpZmllciA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50LnNldChlbGVtZW50LCBzY29wZXNCeUlkZW50aWZpZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY29wZXNCeUlkZW50aWZpZXI7XG4gICAgfVxufVxuXG5jbGFzcyBSb3V0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyID0gbmV3IFNjb3BlT2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLnNjaGVtYSwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMubW9kdWxlc0J5SWRlbnRpZmllciA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGxvZ2dlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24ubG9nZ2VyO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGU7XG4gICAgfVxuICAgIGdldCBtb2R1bGVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIudmFsdWVzKCkpO1xuICAgIH1cbiAgICBnZXQgY29udGV4dHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZHVsZXMucmVkdWNlKChjb250ZXh0cywgbW9kdWxlKSA9PiBjb250ZXh0cy5jb25jYXQobW9kdWxlLmNvbnRleHRzKSwgW10pO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuc2NvcGVPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGxvYWREZWZpbml0aW9uKGRlZmluaXRpb24pIHtcbiAgICAgICAgdGhpcy51bmxvYWRJZGVudGlmaWVyKGRlZmluaXRpb24uaWRlbnRpZmllcik7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IG5ldyBNb2R1bGUodGhpcy5hcHBsaWNhdGlvbiwgZGVmaW5pdGlvbik7XG4gICAgICAgIHRoaXMuY29ubmVjdE1vZHVsZShtb2R1bGUpO1xuICAgICAgICBjb25zdCBhZnRlckxvYWQgPSBkZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3Rvci5hZnRlckxvYWQ7XG4gICAgICAgIGlmIChhZnRlckxvYWQpIHtcbiAgICAgICAgICAgIGFmdGVyTG9hZC5jYWxsKGRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yLCBkZWZpbml0aW9uLmlkZW50aWZpZXIsIHRoaXMuYXBwbGljYXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVubG9hZElkZW50aWZpZXIoaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RNb2R1bGUobW9kdWxlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRDb250ZXh0Rm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNvbnRleHRzLmZpbmQoKGNvbnRleHQpID0+IGNvbnRleHQuZWxlbWVudCA9PSBlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9wb3NlVG9Db25uZWN0U2NvcGVGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IHNjb3BlID0gdGhpcy5zY29wZU9ic2VydmVyLnBhcnNlVmFsdWVGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKHNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLnNjb3BlT2JzZXJ2ZXIuZWxlbWVudE1hdGNoZWRWYWx1ZShzY29wZS5lbGVtZW50LCBzY29wZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBDb3VsZG4ndCBmaW5kIG9yIGNyZWF0ZSBzY29wZSBmb3IgaWRlbnRpZmllcjogXCIke2lkZW50aWZpZXJ9XCIgYW5kIGVsZW1lbnQ6YCwgZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIGRldGFpbCkge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwpO1xuICAgIH1cbiAgICBjcmVhdGVTY29wZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTY29wZSh0aGlzLnNjaGVtYSwgZWxlbWVudCwgaWRlbnRpZmllciwgdGhpcy5sb2dnZXIpO1xuICAgIH1cbiAgICBzY29wZUNvbm5lY3RlZChzY29wZSkge1xuICAgICAgICB0aGlzLnNjb3Blc0J5SWRlbnRpZmllci5hZGQoc2NvcGUuaWRlbnRpZmllciwgc2NvcGUpO1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KHNjb3BlLmlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICBtb2R1bGUuY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2NvcGVEaXNjb25uZWN0ZWQoc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZXNCeUlkZW50aWZpZXIuZGVsZXRlKHNjb3BlLmlkZW50aWZpZXIsIHNjb3BlKTtcbiAgICAgICAgY29uc3QgbW9kdWxlID0gdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyLmdldChzY29wZS5pZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKG1vZHVsZSkge1xuICAgICAgICAgICAgbW9kdWxlLmRpc2Nvbm5lY3RDb250ZXh0Rm9yU2NvcGUoc2NvcGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbm5lY3RNb2R1bGUobW9kdWxlKSB7XG4gICAgICAgIHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci5zZXQobW9kdWxlLmlkZW50aWZpZXIsIG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IHNjb3BlcyA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyLmdldFZhbHVlc0ZvcktleShtb2R1bGUuaWRlbnRpZmllcik7XG4gICAgICAgIHNjb3Blcy5mb3JFYWNoKChzY29wZSkgPT4gbW9kdWxlLmNvbm5lY3RDb250ZXh0Rm9yU2NvcGUoc2NvcGUpKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdE1vZHVsZShtb2R1bGUpIHtcbiAgICAgICAgdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyLmRlbGV0ZShtb2R1bGUuaWRlbnRpZmllcik7XG4gICAgICAgIGNvbnN0IHNjb3BlcyA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyLmdldFZhbHVlc0ZvcktleShtb2R1bGUuaWRlbnRpZmllcik7XG4gICAgICAgIHNjb3Blcy5mb3JFYWNoKChzY29wZSkgPT4gbW9kdWxlLmRpc2Nvbm5lY3RDb250ZXh0Rm9yU2NvcGUoc2NvcGUpKTtcbiAgICB9XG59XG5cbmNvbnN0IGRlZmF1bHRTY2hlbWEgPSB7XG4gICAgY29udHJvbGxlckF0dHJpYnV0ZTogXCJkYXRhLWNvbnRyb2xsZXJcIixcbiAgICBhY3Rpb25BdHRyaWJ1dGU6IFwiZGF0YS1hY3Rpb25cIixcbiAgICB0YXJnZXRBdHRyaWJ1dGU6IFwiZGF0YS10YXJnZXRcIixcbiAgICB0YXJnZXRBdHRyaWJ1dGVGb3JTY29wZTogKGlkZW50aWZpZXIpID0+IGBkYXRhLSR7aWRlbnRpZmllcn0tdGFyZ2V0YCxcbiAgICBvdXRsZXRBdHRyaWJ1dGVGb3JTY29wZTogKGlkZW50aWZpZXIsIG91dGxldCkgPT4gYGRhdGEtJHtpZGVudGlmaWVyfS0ke291dGxldH0tb3V0bGV0YCxcbiAgICBrZXlNYXBwaW5nczogT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHsgZW50ZXI6IFwiRW50ZXJcIiwgdGFiOiBcIlRhYlwiLCBlc2M6IFwiRXNjYXBlXCIsIHNwYWNlOiBcIiBcIiwgdXA6IFwiQXJyb3dVcFwiLCBkb3duOiBcIkFycm93RG93blwiLCBsZWZ0OiBcIkFycm93TGVmdFwiLCByaWdodDogXCJBcnJvd1JpZ2h0XCIsIGhvbWU6IFwiSG9tZVwiLCBlbmQ6IFwiRW5kXCIsIHBhZ2VfdXA6IFwiUGFnZVVwXCIsIHBhZ2VfZG93bjogXCJQYWdlRG93blwiIH0sIG9iamVjdEZyb21FbnRyaWVzKFwiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIi5zcGxpdChcIlwiKS5tYXAoKGMpID0+IFtjLCBjXSkpKSwgb2JqZWN0RnJvbUVudHJpZXMoXCIwMTIzNDU2Nzg5XCIuc3BsaXQoXCJcIikubWFwKChuKSA9PiBbbiwgbl0pKSksXG59O1xuZnVuY3Rpb24gb2JqZWN0RnJvbUVudHJpZXMoYXJyYXkpIHtcbiAgICByZXR1cm4gYXJyYXkucmVkdWNlKChtZW1vLCBbaywgdl0pID0+IChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG1lbW8pLCB7IFtrXTogdiB9KSksIHt9KTtcbn1cblxuY2xhc3MgQXBwbGljYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHNjaGVtYSA9IGRlZmF1bHRTY2hlbWEpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBjb25zb2xlO1xuICAgICAgICB0aGlzLmRlYnVnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eSA9IChpZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCA9IHt9KSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5kZWJ1Zykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nRm9ybWF0dGVkTWVzc2FnZShpZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih0aGlzKTtcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSBuZXcgUm91dGVyKHRoaXMpO1xuICAgICAgICB0aGlzLmFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzKTtcbiAgICB9XG4gICAgc3RhdGljIHN0YXJ0KGVsZW1lbnQsIHNjaGVtYSkge1xuICAgICAgICBjb25zdCBhcHBsaWNhdGlvbiA9IG5ldyB0aGlzKGVsZW1lbnQsIHNjaGVtYSk7XG4gICAgICAgIGFwcGxpY2F0aW9uLnN0YXJ0KCk7XG4gICAgICAgIHJldHVybiBhcHBsaWNhdGlvbjtcbiAgICB9XG4gICAgYXN5bmMgc3RhcnQoKSB7XG4gICAgICAgIGF3YWl0IGRvbVJlYWR5KCk7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImFwcGxpY2F0aW9uXCIsIFwic3RhcnRpbmdcIik7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlci5zdGFydCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5zdGFydCgpO1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJhcHBsaWNhdGlvblwiLCBcInN0YXJ0XCIpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJhcHBsaWNhdGlvblwiLCBcInN0b3BwaW5nXCIpO1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5zdG9wKCk7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImFwcGxpY2F0aW9uXCIsIFwic3RvcFwiKTtcbiAgICB9XG4gICAgcmVnaXN0ZXIoaWRlbnRpZmllciwgY29udHJvbGxlckNvbnN0cnVjdG9yKSB7XG4gICAgICAgIHRoaXMubG9hZCh7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXJDb25zdHJ1Y3RvciB9KTtcbiAgICB9XG4gICAgcmVnaXN0ZXJBY3Rpb25PcHRpb24obmFtZSwgZmlsdGVyKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uRGVzY3JpcHRvckZpbHRlcnNbbmFtZV0gPSBmaWx0ZXI7XG4gICAgfVxuICAgIGxvYWQoaGVhZCwgLi4ucmVzdCkge1xuICAgICAgICBjb25zdCBkZWZpbml0aW9ucyA9IEFycmF5LmlzQXJyYXkoaGVhZCkgPyBoZWFkIDogW2hlYWQsIC4uLnJlc3RdO1xuICAgICAgICBkZWZpbml0aW9ucy5mb3JFYWNoKChkZWZpbml0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5jb250cm9sbGVyQ29uc3RydWN0b3Iuc2hvdWxkTG9hZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLmxvYWREZWZpbml0aW9uKGRlZmluaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdW5sb2FkKGhlYWQsIC4uLnJlc3QpIHtcbiAgICAgICAgY29uc3QgaWRlbnRpZmllcnMgPSBBcnJheS5pc0FycmF5KGhlYWQpID8gaGVhZCA6IFtoZWFkLCAuLi5yZXN0XTtcbiAgICAgICAgaWRlbnRpZmllcnMuZm9yRWFjaCgoaWRlbnRpZmllcikgPT4gdGhpcy5yb3V0ZXIudW5sb2FkSWRlbnRpZmllcihpZGVudGlmaWVyKSk7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbnRleHRzLm1hcCgoY29udGV4dCkgPT4gY29udGV4dC5jb250cm9sbGVyKTtcbiAgICB9XG4gICAgZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMucm91dGVyLmdldENvbnRleHRGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQgPyBjb250ZXh0LmNvbnRyb2xsZXIgOiBudWxsO1xuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoYCVzXFxuXFxuJW9cXG5cXG4lb2AsIG1lc3NhZ2UsIGVycm9yLCBkZXRhaWwpO1xuICAgICAgICAoX2EgPSB3aW5kb3cub25lcnJvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGwod2luZG93LCBtZXNzYWdlLCBcIlwiLCAwLCAwLCBlcnJvcik7XG4gICAgfVxuICAgIGxvZ0Zvcm1hdHRlZE1lc3NhZ2UoaWRlbnRpZmllciwgZnVuY3Rpb25OYW1lLCBkZXRhaWwgPSB7fSkge1xuICAgICAgICBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHsgYXBwbGljYXRpb246IHRoaXMgfSwgZGV0YWlsKTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZ3JvdXBDb2xsYXBzZWQoYCR7aWRlbnRpZmllcn0gIyR7ZnVuY3Rpb25OYW1lfWApO1xuICAgICAgICB0aGlzLmxvZ2dlci5sb2coXCJkZXRhaWxzOlwiLCBPYmplY3QuYXNzaWduKHt9LCBkZXRhaWwpKTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZ3JvdXBFbmQoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkb21SZWFkeSgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT0gXCJsb2FkaW5nXCIpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gQ2xhc3NQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCBjbGFzc2VzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwiY2xhc3Nlc1wiKTtcbiAgICByZXR1cm4gY2xhc3Nlcy5yZWR1Y2UoKHByb3BlcnRpZXMsIGNsYXNzRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBwcm9wZXJ0aWVzRm9yQ2xhc3NEZWZpbml0aW9uKGNsYXNzRGVmaW5pdGlvbikpO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JDbGFzc0RlZmluaXRpb24oa2V5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake2tleX1DbGFzc2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBjbGFzc2VzIH0gPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmIChjbGFzc2VzLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjbGFzc2VzLmdldChrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gY2xhc3Nlcy5nZXRBdHRyaWJ1dGVOYW1lKGtleSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBhdHRyaWJ1dGUgXCIke2F0dHJpYnV0ZX1cImApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtrZXl9Q2xhc3Nlc2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3Nlcy5nZXRBbGwoa2V5KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgaGFzJHtjYXBpdGFsaXplKGtleSl9Q2xhc3NgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsYXNzZXMuaGFzKGtleSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIE91dGxldFByb3BlcnRpZXNCbGVzc2luZyhjb25zdHJ1Y3Rvcikge1xuICAgIGNvbnN0IG91dGxldHMgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgXCJvdXRsZXRzXCIpO1xuICAgIHJldHVybiBvdXRsZXRzLnJlZHVjZSgocHJvcGVydGllcywgb3V0bGV0RGVmaW5pdGlvbikgPT4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBwcm9wZXJ0aWVzRm9yT3V0bGV0RGVmaW5pdGlvbihvdXRsZXREZWZpbml0aW9uKSk7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gZ2V0T3V0bGV0Q29udHJvbGxlcihjb250cm9sbGVyLCBlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgcmV0dXJuIGNvbnRyb2xsZXIuYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpO1xufVxuZnVuY3Rpb24gZ2V0Q29udHJvbGxlckFuZEVuc3VyZUNvbm5lY3RlZFNjb3BlKGNvbnRyb2xsZXIsIGVsZW1lbnQsIG91dGxldE5hbWUpIHtcbiAgICBsZXQgb3V0bGV0Q29udHJvbGxlciA9IGdldE91dGxldENvbnRyb2xsZXIoY29udHJvbGxlciwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgaWYgKG91dGxldENvbnRyb2xsZXIpXG4gICAgICAgIHJldHVybiBvdXRsZXRDb250cm9sbGVyO1xuICAgIGNvbnRyb2xsZXIuYXBwbGljYXRpb24ucm91dGVyLnByb3Bvc2VUb0Nvbm5lY3RTY29wZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIG91dGxldENvbnRyb2xsZXIgPSBnZXRPdXRsZXRDb250cm9sbGVyKGNvbnRyb2xsZXIsIGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIGlmIChvdXRsZXRDb250cm9sbGVyKVxuICAgICAgICByZXR1cm4gb3V0bGV0Q29udHJvbGxlcjtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JPdXRsZXREZWZpbml0aW9uKG5hbWUpIHtcbiAgICBjb25zdCBjYW1lbGl6ZWROYW1lID0gbmFtZXNwYWNlQ2FtZWxpemUobmFtZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake2NhbWVsaXplZE5hbWV9T3V0bGV0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRFbGVtZW50ID0gdGhpcy5vdXRsZXRzLmZpbmQobmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLm91dGxldHMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChvdXRsZXRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldENvbnRyb2xsZXIgPSBnZXRDb250cm9sbGVyQW5kRW5zdXJlQ29ubmVjdGVkU2NvcGUodGhpcywgb3V0bGV0RWxlbWVudCwgbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRsZXRDb250cm9sbGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dGxldENvbnRyb2xsZXI7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHByb3ZpZGVkIG91dGxldCBlbGVtZW50IGlzIG1pc3NpbmcgYW4gb3V0bGV0IGNvbnRyb2xsZXIgXCIke25hbWV9XCIgaW5zdGFuY2UgZm9yIGhvc3QgY29udHJvbGxlciBcIiR7dGhpcy5pZGVudGlmaWVyfVwiYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBvdXRsZXQgZWxlbWVudCBcIiR7bmFtZX1cIiBmb3IgaG9zdCBjb250cm9sbGVyIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCIuIFN0aW11bHVzIGNvdWxkbid0IGZpbmQgYSBtYXRjaGluZyBvdXRsZXQgZWxlbWVudCB1c2luZyBzZWxlY3RvciBcIiR7c2VsZWN0b3J9XCIuYCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRzID0gdGhpcy5vdXRsZXRzLmZpbmRBbGwobmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG91dGxldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0bGV0c1xuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgob3V0bGV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0bGV0Q29udHJvbGxlciA9IGdldENvbnRyb2xsZXJBbmRFbnN1cmVDb25uZWN0ZWRTY29wZSh0aGlzLCBvdXRsZXRFbGVtZW50LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdXRsZXRDb250cm9sbGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXRDb250cm9sbGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBUaGUgcHJvdmlkZWQgb3V0bGV0IGVsZW1lbnQgaXMgbWlzc2luZyBhbiBvdXRsZXQgY29udHJvbGxlciBcIiR7bmFtZX1cIiBpbnN0YW5jZSBmb3IgaG9zdCBjb250cm9sbGVyIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCJgLCBvdXRsZXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGNvbnRyb2xsZXIpID0+IGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRFbGVtZW50YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRFbGVtZW50ID0gdGhpcy5vdXRsZXRzLmZpbmQobmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLm91dGxldHMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChvdXRsZXRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXRFbGVtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIG91dGxldCBlbGVtZW50IFwiJHtuYW1lfVwiIGZvciBob3N0IGNvbnRyb2xsZXIgXCIke3RoaXMuaWRlbnRpZmllcn1cIi4gU3RpbXVsdXMgY291bGRuJ3QgZmluZCBhIG1hdGNoaW5nIG91dGxldCBlbGVtZW50IHVzaW5nIHNlbGVjdG9yIFwiJHtzZWxlY3Rvcn1cIi5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRFbGVtZW50c2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0cy5maW5kQWxsKG5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2BoYXMke2NhcGl0YWxpemUoY2FtZWxpemVkTmFtZSl9T3V0bGV0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzLmhhcyhuYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gVGFyZ2V0UHJvcGVydGllc0JsZXNzaW5nKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgdGFyZ2V0cyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBcInRhcmdldHNcIik7XG4gICAgcmV0dXJuIHRhcmdldHMucmVkdWNlKChwcm9wZXJ0aWVzLCB0YXJnZXREZWZpbml0aW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnRpZXMsIHByb3BlcnRpZXNGb3JUYXJnZXREZWZpbml0aW9uKHRhcmdldERlZmluaXRpb24pKTtcbiAgICB9LCB7fSk7XG59XG5mdW5jdGlvbiBwcm9wZXJ0aWVzRm9yVGFyZ2V0RGVmaW5pdGlvbihuYW1lKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake25hbWV9VGFyZ2V0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLnRhcmdldHMuZmluZChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgdGFyZ2V0IGVsZW1lbnQgXCIke25hbWV9XCIgZm9yIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCIgY29udHJvbGxlcmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtuYW1lfVRhcmdldHNgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldHMuZmluZEFsbChuYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgaGFzJHtjYXBpdGFsaXplKG5hbWUpfVRhcmdldGBdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0cy5oYXMobmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIFZhbHVlUHJvcGVydGllc0JsZXNzaW5nKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgdmFsdWVEZWZpbml0aW9uUGFpcnMgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNPYmplY3RQYWlycyhjb25zdHJ1Y3RvciwgXCJ2YWx1ZXNcIik7XG4gICAgY29uc3QgcHJvcGVydHlEZXNjcmlwdG9yTWFwID0ge1xuICAgICAgICB2YWx1ZURlc2NyaXB0b3JNYXA6IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVEZWZpbml0aW9uUGFpcnMucmVkdWNlKChyZXN1bHQsIHZhbHVlRGVmaW5pdGlvblBhaXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVEZXNjcmlwdG9yID0gcGFyc2VWYWx1ZURlZmluaXRpb25QYWlyKHZhbHVlRGVmaW5pdGlvblBhaXIsIHRoaXMuaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLmRhdGEuZ2V0QXR0cmlidXRlTmFtZUZvcktleSh2YWx1ZURlc2NyaXB0b3Iua2V5KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocmVzdWx0LCB7IFthdHRyaWJ1dGVOYW1lXTogdmFsdWVEZXNjcmlwdG9yIH0pO1xuICAgICAgICAgICAgICAgIH0sIHt9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZXR1cm4gdmFsdWVEZWZpbml0aW9uUGFpcnMucmVkdWNlKChwcm9wZXJ0aWVzLCB2YWx1ZURlZmluaXRpb25QYWlyKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnRpZXMsIHByb3BlcnRpZXNGb3JWYWx1ZURlZmluaXRpb25QYWlyKHZhbHVlRGVmaW5pdGlvblBhaXIpKTtcbiAgICB9LCBwcm9wZXJ0eURlc2NyaXB0b3JNYXApO1xufVxuZnVuY3Rpb24gcHJvcGVydGllc0ZvclZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpciwgY29udHJvbGxlcikge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSBwYXJzZVZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpciwgY29udHJvbGxlcik7XG4gICAgY29uc3QgeyBrZXksIG5hbWUsIHJlYWRlcjogcmVhZCwgd3JpdGVyOiB3cml0ZSB9ID0gZGVmaW5pdGlvbjtcbiAgICByZXR1cm4ge1xuICAgICAgICBbbmFtZV06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGF0YS5nZXQoa2V5KTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlYWQodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmluaXRpb24uZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuc2V0KGtleSwgd3JpdGUodmFsdWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYGhhcyR7Y2FwaXRhbGl6ZShuYW1lKX1gXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEuaGFzKGtleSkgfHwgZGVmaW5pdGlvbi5oYXNDdXN0b21EZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59XG5mdW5jdGlvbiBwYXJzZVZhbHVlRGVmaW5pdGlvblBhaXIoW3Rva2VuLCB0eXBlRGVmaW5pdGlvbl0sIGNvbnRyb2xsZXIpIHtcbiAgICByZXR1cm4gdmFsdWVEZXNjcmlwdG9yRm9yVG9rZW5BbmRUeXBlRGVmaW5pdGlvbih7XG4gICAgICAgIGNvbnRyb2xsZXIsXG4gICAgICAgIHRva2VuLFxuICAgICAgICB0eXBlRGVmaW5pdGlvbixcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQoY29uc3RhbnQpIHtcbiAgICBzd2l0Y2ggKGNvbnN0YW50KSB7XG4gICAgICAgIGNhc2UgQXJyYXk6XG4gICAgICAgICAgICByZXR1cm4gXCJhcnJheVwiO1xuICAgICAgICBjYXNlIEJvb2xlYW46XG4gICAgICAgICAgICByZXR1cm4gXCJib29sZWFuXCI7XG4gICAgICAgIGNhc2UgTnVtYmVyOlxuICAgICAgICAgICAgcmV0dXJuIFwibnVtYmVyXCI7XG4gICAgICAgIGNhc2UgT2JqZWN0OlxuICAgICAgICAgICAgcmV0dXJuIFwib2JqZWN0XCI7XG4gICAgICAgIGNhc2UgU3RyaW5nOlxuICAgICAgICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KGRlZmF1bHRWYWx1ZSkge1xuICAgIHN3aXRjaCAodHlwZW9mIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYm9vbGVhblwiO1xuICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGRlZmF1bHRWYWx1ZSkpXG4gICAgICAgIHJldHVybiBcImFycmF5XCI7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkZWZhdWx0VmFsdWUpID09PSBcIltvYmplY3QgT2JqZWN0XVwiKVxuICAgICAgICByZXR1cm4gXCJvYmplY3RcIjtcbn1cbmZ1bmN0aW9uIHBhcnNlVmFsdWVUeXBlT2JqZWN0KHBheWxvYWQpIHtcbiAgICBjb25zdCB7IGNvbnRyb2xsZXIsIHRva2VuLCB0eXBlT2JqZWN0IH0gPSBwYXlsb2FkO1xuICAgIGNvbnN0IGhhc1R5cGUgPSBpc1NvbWV0aGluZyh0eXBlT2JqZWN0LnR5cGUpO1xuICAgIGNvbnN0IGhhc0RlZmF1bHQgPSBpc1NvbWV0aGluZyh0eXBlT2JqZWN0LmRlZmF1bHQpO1xuICAgIGNvbnN0IGZ1bGxPYmplY3QgPSBoYXNUeXBlICYmIGhhc0RlZmF1bHQ7XG4gICAgY29uc3Qgb25seVR5cGUgPSBoYXNUeXBlICYmICFoYXNEZWZhdWx0O1xuICAgIGNvbnN0IG9ubHlEZWZhdWx0ID0gIWhhc1R5cGUgJiYgaGFzRGVmYXVsdDtcbiAgICBjb25zdCB0eXBlRnJvbU9iamVjdCA9IHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQodHlwZU9iamVjdC50eXBlKTtcbiAgICBjb25zdCB0eXBlRnJvbURlZmF1bHRWYWx1ZSA9IHBhcnNlVmFsdWVUeXBlRGVmYXVsdChwYXlsb2FkLnR5cGVPYmplY3QuZGVmYXVsdCk7XG4gICAgaWYgKG9ubHlUeXBlKVxuICAgICAgICByZXR1cm4gdHlwZUZyb21PYmplY3Q7XG4gICAgaWYgKG9ubHlEZWZhdWx0KVxuICAgICAgICByZXR1cm4gdHlwZUZyb21EZWZhdWx0VmFsdWU7XG4gICAgaWYgKHR5cGVGcm9tT2JqZWN0ICE9PSB0eXBlRnJvbURlZmF1bHRWYWx1ZSkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0eVBhdGggPSBjb250cm9sbGVyID8gYCR7Y29udHJvbGxlcn0uJHt0b2tlbn1gIDogdG9rZW47XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHNwZWNpZmllZCBkZWZhdWx0IHZhbHVlIGZvciB0aGUgU3RpbXVsdXMgVmFsdWUgXCIke3Byb3BlcnR5UGF0aH1cIiBtdXN0IG1hdGNoIHRoZSBkZWZpbmVkIHR5cGUgXCIke3R5cGVGcm9tT2JqZWN0fVwiLiBUaGUgcHJvdmlkZWQgZGVmYXVsdCB2YWx1ZSBvZiBcIiR7dHlwZU9iamVjdC5kZWZhdWx0fVwiIGlzIG9mIHR5cGUgXCIke3R5cGVGcm9tRGVmYXVsdFZhbHVlfVwiLmApO1xuICAgIH1cbiAgICBpZiAoZnVsbE9iamVjdClcbiAgICAgICAgcmV0dXJuIHR5cGVGcm9tT2JqZWN0O1xufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVEZWZpbml0aW9uKHBheWxvYWQpIHtcbiAgICBjb25zdCB7IGNvbnRyb2xsZXIsIHRva2VuLCB0eXBlRGVmaW5pdGlvbiB9ID0gcGF5bG9hZDtcbiAgICBjb25zdCB0eXBlT2JqZWN0ID0geyBjb250cm9sbGVyLCB0b2tlbiwgdHlwZU9iamVjdDogdHlwZURlZmluaXRpb24gfTtcbiAgICBjb25zdCB0eXBlRnJvbU9iamVjdCA9IHBhcnNlVmFsdWVUeXBlT2JqZWN0KHR5cGVPYmplY3QpO1xuICAgIGNvbnN0IHR5cGVGcm9tRGVmYXVsdFZhbHVlID0gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KHR5cGVEZWZpbml0aW9uKTtcbiAgICBjb25zdCB0eXBlRnJvbUNvbnN0YW50ID0gcGFyc2VWYWx1ZVR5cGVDb25zdGFudCh0eXBlRGVmaW5pdGlvbik7XG4gICAgY29uc3QgdHlwZSA9IHR5cGVGcm9tT2JqZWN0IHx8IHR5cGVGcm9tRGVmYXVsdFZhbHVlIHx8IHR5cGVGcm9tQ29uc3RhbnQ7XG4gICAgaWYgKHR5cGUpXG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgIGNvbnN0IHByb3BlcnR5UGF0aCA9IGNvbnRyb2xsZXIgPyBgJHtjb250cm9sbGVyfS4ke3R5cGVEZWZpbml0aW9ufWAgOiB0b2tlbjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdmFsdWUgdHlwZSBcIiR7cHJvcGVydHlQYXRofVwiIGZvciBcIiR7dG9rZW59XCIgdmFsdWVgKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRWYWx1ZUZvckRlZmluaXRpb24odHlwZURlZmluaXRpb24pIHtcbiAgICBjb25zdCBjb25zdGFudCA9IHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQodHlwZURlZmluaXRpb24pO1xuICAgIGlmIChjb25zdGFudClcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZXNCeVR5cGVbY29uc3RhbnRdO1xuICAgIGNvbnN0IGhhc0RlZmF1bHQgPSBoYXNQcm9wZXJ0eSh0eXBlRGVmaW5pdGlvbiwgXCJkZWZhdWx0XCIpO1xuICAgIGNvbnN0IGhhc1R5cGUgPSBoYXNQcm9wZXJ0eSh0eXBlRGVmaW5pdGlvbiwgXCJ0eXBlXCIpO1xuICAgIGNvbnN0IHR5cGVPYmplY3QgPSB0eXBlRGVmaW5pdGlvbjtcbiAgICBpZiAoaGFzRGVmYXVsdClcbiAgICAgICAgcmV0dXJuIHR5cGVPYmplY3QuZGVmYXVsdDtcbiAgICBpZiAoaGFzVHlwZSkge1xuICAgICAgICBjb25zdCB7IHR5cGUgfSA9IHR5cGVPYmplY3Q7XG4gICAgICAgIGNvbnN0IGNvbnN0YW50RnJvbVR5cGUgPSBwYXJzZVZhbHVlVHlwZUNvbnN0YW50KHR5cGUpO1xuICAgICAgICBpZiAoY29uc3RhbnRGcm9tVHlwZSlcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWVzQnlUeXBlW2NvbnN0YW50RnJvbVR5cGVdO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZURlZmluaXRpb247XG59XG5mdW5jdGlvbiB2YWx1ZURlc2NyaXB0b3JGb3JUb2tlbkFuZFR5cGVEZWZpbml0aW9uKHBheWxvYWQpIHtcbiAgICBjb25zdCB7IHRva2VuLCB0eXBlRGVmaW5pdGlvbiB9ID0gcGF5bG9hZDtcbiAgICBjb25zdCBrZXkgPSBgJHtkYXNoZXJpemUodG9rZW4pfS12YWx1ZWA7XG4gICAgY29uc3QgdHlwZSA9IHBhcnNlVmFsdWVUeXBlRGVmaW5pdGlvbihwYXlsb2FkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlLFxuICAgICAgICBrZXksXG4gICAgICAgIG5hbWU6IGNhbWVsaXplKGtleSksXG4gICAgICAgIGdldCBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlRm9yRGVmaW5pdGlvbih0eXBlRGVmaW5pdGlvbik7XG4gICAgICAgIH0sXG4gICAgICAgIGdldCBoYXNDdXN0b21EZWZhdWx0VmFsdWUoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KHR5cGVEZWZpbml0aW9uKSAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICByZWFkZXI6IHJlYWRlcnNbdHlwZV0sXG4gICAgICAgIHdyaXRlcjogd3JpdGVyc1t0eXBlXSB8fCB3cml0ZXJzLmRlZmF1bHQsXG4gICAgfTtcbn1cbmNvbnN0IGRlZmF1bHRWYWx1ZXNCeVR5cGUgPSB7XG4gICAgZ2V0IGFycmF5KCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBib29sZWFuOiBmYWxzZSxcbiAgICBudW1iZXI6IDAsXG4gICAgZ2V0IG9iamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH0sXG4gICAgc3RyaW5nOiBcIlwiLFxufTtcbmNvbnN0IHJlYWRlcnMgPSB7XG4gICAgYXJyYXkodmFsdWUpIHtcbiAgICAgICAgY29uc3QgYXJyYXkgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgZXhwZWN0ZWQgdmFsdWUgb2YgdHlwZSBcImFycmF5XCIgYnV0IGluc3RlYWQgZ290IHZhbHVlIFwiJHt2YWx1ZX1cIiBvZiB0eXBlIFwiJHtwYXJzZVZhbHVlVHlwZURlZmF1bHQoYXJyYXkpfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH0sXG4gICAgYm9vbGVhbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gISh2YWx1ZSA9PSBcIjBcIiB8fCBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkgPT0gXCJmYWxzZVwiKTtcbiAgICB9LFxuICAgIG51bWJlcih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlLnJlcGxhY2UoL18vZywgXCJcIikpO1xuICAgIH0sXG4gICAgb2JqZWN0KHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICBpZiAob2JqZWN0ID09PSBudWxsIHx8IHR5cGVvZiBvYmplY3QgIT0gXCJvYmplY3RcIiB8fCBBcnJheS5pc0FycmF5KG9iamVjdCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIHZhbHVlIG9mIHR5cGUgXCJvYmplY3RcIiBidXQgaW5zdGVhZCBnb3QgdmFsdWUgXCIke3ZhbHVlfVwiIG9mIHR5cGUgXCIke3BhcnNlVmFsdWVUeXBlRGVmYXVsdChvYmplY3QpfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9LFxuICAgIHN0cmluZyh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbn07XG5jb25zdCB3cml0ZXJzID0ge1xuICAgIGRlZmF1bHQ6IHdyaXRlU3RyaW5nLFxuICAgIGFycmF5OiB3cml0ZUpTT04sXG4gICAgb2JqZWN0OiB3cml0ZUpTT04sXG59O1xuZnVuY3Rpb24gd3JpdGVKU09OKHZhbHVlKSB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHdyaXRlU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIGAke3ZhbHVlfWA7XG59XG5cbmNsYXNzIENvbnRyb2xsZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICB9XG4gICAgc3RhdGljIGdldCBzaG91bGRMb2FkKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgc3RhdGljIGFmdGVyTG9hZChfaWRlbnRpZmllciwgX2FwcGxpY2F0aW9uKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZ2V0IGFwcGxpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBnZXQgc2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NvcGU7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IHRhcmdldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLnRhcmdldHM7XG4gICAgfVxuICAgIGdldCBvdXRsZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5vdXRsZXRzO1xuICAgIH1cbiAgICBnZXQgY2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuY2xhc3NlcztcbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmRhdGE7XG4gICAgfVxuICAgIGluaXRpYWxpemUoKSB7XG4gICAgfVxuICAgIGNvbm5lY3QoKSB7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgfVxuICAgIGRpc3BhdGNoKGV2ZW50TmFtZSwgeyB0YXJnZXQgPSB0aGlzLmVsZW1lbnQsIGRldGFpbCA9IHt9LCBwcmVmaXggPSB0aGlzLmlkZW50aWZpZXIsIGJ1YmJsZXMgPSB0cnVlLCBjYW5jZWxhYmxlID0gdHJ1ZSwgfSA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBwcmVmaXggPyBgJHtwcmVmaXh9OiR7ZXZlbnROYW1lfWAgOiBldmVudE5hbWU7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KHR5cGUsIHsgZGV0YWlsLCBidWJibGVzLCBjYW5jZWxhYmxlIH0pO1xuICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICB9XG59XG5Db250cm9sbGVyLmJsZXNzaW5ncyA9IFtcbiAgICBDbGFzc1Byb3BlcnRpZXNCbGVzc2luZyxcbiAgICBUYXJnZXRQcm9wZXJ0aWVzQmxlc3NpbmcsXG4gICAgVmFsdWVQcm9wZXJ0aWVzQmxlc3NpbmcsXG4gICAgT3V0bGV0UHJvcGVydGllc0JsZXNzaW5nLFxuXTtcbkNvbnRyb2xsZXIudGFyZ2V0cyA9IFtdO1xuQ29udHJvbGxlci5vdXRsZXRzID0gW107XG5Db250cm9sbGVyLnZhbHVlcyA9IHt9O1xuXG5leHBvcnQgeyBBcHBsaWNhdGlvbiwgQXR0cmlidXRlT2JzZXJ2ZXIsIENvbnRleHQsIENvbnRyb2xsZXIsIEVsZW1lbnRPYnNlcnZlciwgSW5kZXhlZE11bHRpbWFwLCBNdWx0aW1hcCwgU2VsZWN0b3JPYnNlcnZlciwgU3RyaW5nTWFwT2JzZXJ2ZXIsIFRva2VuTGlzdE9ic2VydmVyLCBWYWx1ZUxpc3RPYnNlcnZlciwgYWRkLCBkZWZhdWx0U2NoZW1hLCBkZWwsIGZldGNoLCBwcnVuZSB9O1xuIiwiLyohXG5UdXJibyA4LjAuMTJcbkNvcHlyaWdodCDCqSAyMDI0IDM3c2lnbmFscyBMTENcbiAqL1xuLyoqXG4gKiBUaGUgTUlUIExpY2Vuc2UgKE1JVClcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTkgSmF2YW4gTWFraG1hbGlcbiAqXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKlxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICpcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICovXG5cbihmdW5jdGlvbiAocHJvdG90eXBlKSB7XG4gIGlmICh0eXBlb2YgcHJvdG90eXBlLnJlcXVlc3RTdWJtaXQgPT0gXCJmdW5jdGlvblwiKSByZXR1cm5cblxuICBwcm90b3R5cGUucmVxdWVzdFN1Ym1pdCA9IGZ1bmN0aW9uIChzdWJtaXR0ZXIpIHtcbiAgICBpZiAoc3VibWl0dGVyKSB7XG4gICAgICB2YWxpZGF0ZVN1Ym1pdHRlcihzdWJtaXR0ZXIsIHRoaXMpO1xuICAgICAgc3VibWl0dGVyLmNsaWNrKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Ym1pdHRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICAgIHN1Ym1pdHRlci50eXBlID0gXCJzdWJtaXRcIjtcbiAgICAgIHN1Ym1pdHRlci5oaWRkZW4gPSB0cnVlO1xuICAgICAgdGhpcy5hcHBlbmRDaGlsZChzdWJtaXR0ZXIpO1xuICAgICAgc3VibWl0dGVyLmNsaWNrKCk7XG4gICAgICB0aGlzLnJlbW92ZUNoaWxkKHN1Ym1pdHRlcik7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbGlkYXRlU3VibWl0dGVyKHN1Ym1pdHRlciwgZm9ybSkge1xuICAgIHN1Ym1pdHRlciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IHx8IHJhaXNlKFR5cGVFcnJvciwgXCJwYXJhbWV0ZXIgMSBpcyBub3Qgb2YgdHlwZSAnSFRNTEVsZW1lbnQnXCIpO1xuICAgIHN1Ym1pdHRlci50eXBlID09IFwic3VibWl0XCIgfHwgcmFpc2UoVHlwZUVycm9yLCBcIlRoZSBzcGVjaWZpZWQgZWxlbWVudCBpcyBub3QgYSBzdWJtaXQgYnV0dG9uXCIpO1xuICAgIHN1Ym1pdHRlci5mb3JtID09IGZvcm0gfHxcbiAgICAgIHJhaXNlKERPTUV4Y2VwdGlvbiwgXCJUaGUgc3BlY2lmaWVkIGVsZW1lbnQgaXMgbm90IG93bmVkIGJ5IHRoaXMgZm9ybSBlbGVtZW50XCIsIFwiTm90Rm91bmRFcnJvclwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJhaXNlKGVycm9yQ29uc3RydWN0b3IsIG1lc3NhZ2UsIG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JDb25zdHJ1Y3RvcihcIkZhaWxlZCB0byBleGVjdXRlICdyZXF1ZXN0U3VibWl0JyBvbiAnSFRNTEZvcm1FbGVtZW50JzogXCIgKyBtZXNzYWdlICsgXCIuXCIsIG5hbWUpXG4gIH1cbn0pKEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUpO1xuXG5jb25zdCBzdWJtaXR0ZXJzQnlGb3JtID0gbmV3IFdlYWtNYXAoKTtcblxuZnVuY3Rpb24gZmluZFN1Ym1pdHRlckZyb21DbGlja1RhcmdldCh0YXJnZXQpIHtcbiAgY29uc3QgZWxlbWVudCA9IHRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgPyB0YXJnZXQgOiB0YXJnZXQgaW5zdGFuY2VvZiBOb2RlID8gdGFyZ2V0LnBhcmVudEVsZW1lbnQgOiBudWxsO1xuICBjb25zdCBjYW5kaWRhdGUgPSBlbGVtZW50ID8gZWxlbWVudC5jbG9zZXN0KFwiaW5wdXQsIGJ1dHRvblwiKSA6IG51bGw7XG4gIHJldHVybiBjYW5kaWRhdGU/LnR5cGUgPT0gXCJzdWJtaXRcIiA/IGNhbmRpZGF0ZSA6IG51bGxcbn1cblxuZnVuY3Rpb24gY2xpY2tDYXB0dXJlZChldmVudCkge1xuICBjb25zdCBzdWJtaXR0ZXIgPSBmaW5kU3VibWl0dGVyRnJvbUNsaWNrVGFyZ2V0KGV2ZW50LnRhcmdldCk7XG5cbiAgaWYgKHN1Ym1pdHRlciAmJiBzdWJtaXR0ZXIuZm9ybSkge1xuICAgIHN1Ym1pdHRlcnNCeUZvcm0uc2V0KHN1Ym1pdHRlci5mb3JtLCBzdWJtaXR0ZXIpO1xuICB9XG59XG5cbihmdW5jdGlvbiAoKSB7XG4gIGlmIChcInN1Ym1pdHRlclwiIGluIEV2ZW50LnByb3RvdHlwZSkgcmV0dXJuXG5cbiAgbGV0IHByb3RvdHlwZSA9IHdpbmRvdy5FdmVudC5wcm90b3R5cGU7XG4gIC8vIENlcnRhaW4gdmVyc2lvbnMgb2YgU2FmYXJpIDE1IGhhdmUgYSBidWcgd2hlcmUgdGhleSB3b24ndFxuICAvLyBwb3B1bGF0ZSB0aGUgc3VibWl0dGVyLiBUaGlzIGh1cnRzIFR1cmJvRHJpdmUncyBlbmFibGUvZGlzYWJsZSBkZXRlY3Rpb24uXG4gIC8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjI5NjYwXG4gIGlmIChcIlN1Ym1pdEV2ZW50XCIgaW4gd2luZG93KSB7XG4gICAgY29uc3QgcHJvdG90eXBlT2ZTdWJtaXRFdmVudCA9IHdpbmRvdy5TdWJtaXRFdmVudC5wcm90b3R5cGU7XG5cbiAgICBpZiAoL0FwcGxlIENvbXB1dGVyLy50ZXN0KG5hdmlnYXRvci52ZW5kb3IpICYmICEoXCJzdWJtaXR0ZXJcIiBpbiBwcm90b3R5cGVPZlN1Ym1pdEV2ZW50KSkge1xuICAgICAgcHJvdG90eXBlID0gcHJvdG90eXBlT2ZTdWJtaXRFdmVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIC8vIHBvbHlmaWxsIG5vdCBuZWVkZWRcbiAgICB9XG4gIH1cblxuICBhZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tDYXB0dXJlZCwgdHJ1ZSk7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZSwgXCJzdWJtaXR0ZXJcIiwge1xuICAgIGdldCgpIHtcbiAgICAgIGlmICh0aGlzLnR5cGUgPT0gXCJzdWJtaXRcIiAmJiB0aGlzLnRhcmdldCBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCkge1xuICAgICAgICByZXR1cm4gc3VibWl0dGVyc0J5Rm9ybS5nZXQodGhpcy50YXJnZXQpXG4gICAgICB9XG4gICAgfVxuICB9KTtcbn0pKCk7XG5cbmNvbnN0IEZyYW1lTG9hZGluZ1N0eWxlID0ge1xuICBlYWdlcjogXCJlYWdlclwiLFxuICBsYXp5OiBcImxhenlcIlxufTtcblxuLyoqXG4gKiBDb250YWlucyBhIGZyYWdtZW50IG9mIEhUTUwgd2hpY2ggaXMgdXBkYXRlZCBiYXNlZCBvbiBuYXZpZ2F0aW9uIHdpdGhpblxuICogaXQgKGUuZy4gdmlhIGxpbmtzIG9yIGZvcm0gc3VibWlzc2lvbnMpLlxuICpcbiAqIEBjdXN0b21FbGVtZW50IHR1cmJvLWZyYW1lXG4gKiBAZXhhbXBsZVxuICogICA8dHVyYm8tZnJhbWUgaWQ9XCJtZXNzYWdlc1wiPlxuICogICAgIDxhIGhyZWY9XCIvbWVzc2FnZXMvZXhwYW5kZWRcIj5cbiAqICAgICAgIFNob3cgYWxsIGV4cGFuZGVkIG1lc3NhZ2VzIGluIHRoaXMgZnJhbWUuXG4gKiAgICAgPC9hPlxuICpcbiAqICAgICA8Zm9ybSBhY3Rpb249XCIvbWVzc2FnZXNcIj5cbiAqICAgICAgIFNob3cgcmVzcG9uc2UgZnJvbSB0aGlzIGZvcm0gd2l0aGluIHRoaXMgZnJhbWUuXG4gKiAgICAgPC9mb3JtPlxuICogICA8L3R1cmJvLWZyYW1lPlxuICovXG5jbGFzcyBGcmFtZUVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIHN0YXRpYyBkZWxlZ2F0ZUNvbnN0cnVjdG9yID0gdW5kZWZpbmVkXG5cbiAgbG9hZGVkID0gUHJvbWlzZS5yZXNvbHZlKClcblxuICBzdGF0aWMgZ2V0IG9ic2VydmVkQXR0cmlidXRlcygpIHtcbiAgICByZXR1cm4gW1wiZGlzYWJsZWRcIiwgXCJsb2FkaW5nXCIsIFwic3JjXCJdXG4gIH1cblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZGVsZWdhdGUgPSBuZXcgRnJhbWVFbGVtZW50LmRlbGVnYXRlQ29uc3RydWN0b3IodGhpcyk7XG4gIH1cblxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLmRlbGVnYXRlLmNvbm5lY3QoKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRoaXMuZGVsZWdhdGUuZGlzY29ubmVjdCgpO1xuICB9XG5cbiAgcmVsb2FkKCkge1xuICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLnNvdXJjZVVSTFJlbG9hZGVkKClcbiAgfVxuXG4gIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lKSB7XG4gICAgaWYgKG5hbWUgPT0gXCJsb2FkaW5nXCIpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUubG9hZGluZ1N0eWxlQ2hhbmdlZCgpO1xuICAgIH0gZWxzZSBpZiAobmFtZSA9PSBcInNyY1wiKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnNvdXJjZVVSTENoYW5nZWQoKTtcbiAgICB9IGVsc2UgaWYgKG5hbWUgPT0gXCJkaXNhYmxlZFwiKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLmRpc2FibGVkQ2hhbmdlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBVUkwgdG8gbGF6aWx5IGxvYWQgc291cmNlIEhUTUwgZnJvbVxuICAgKi9cbiAgZ2V0IHNyYygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJzcmNcIilcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBVUkwgdG8gbGF6aWx5IGxvYWQgc291cmNlIEhUTUwgZnJvbVxuICAgKi9cbiAgc2V0IHNyYyh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcInNyY1wiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgcmVmcmVzaCBtb2RlIGZvciB0aGUgZnJhbWUuXG4gICAqL1xuICBnZXQgcmVmcmVzaCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJyZWZyZXNoXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgcmVmcmVzaCBtb2RlIGZvciB0aGUgZnJhbWUuXG4gICAqL1xuICBzZXQgcmVmcmVzaCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJyZWZyZXNoXCIsIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoXCJyZWZyZXNoXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzaG91bGRSZWxvYWRXaXRoTW9ycGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3JjICYmIHRoaXMucmVmcmVzaCA9PT0gXCJtb3JwaFwiXG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgZWxlbWVudCBpcyBsb2FkaW5nXG4gICAqL1xuICBnZXQgbG9hZGluZygpIHtcbiAgICByZXR1cm4gZnJhbWVMb2FkaW5nU3R5bGVGcm9tU3RyaW5nKHRoaXMuZ2V0QXR0cmlidXRlKFwibG9hZGluZ1wiKSB8fCBcIlwiKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHZhbHVlIG9mIGlmIHRoZSBlbGVtZW50IGlzIGxvYWRpbmdcbiAgICovXG4gIHNldCBsb2FkaW5nKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImxvYWRpbmdcIiwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcImxvYWRpbmdcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc2FibGVkIHN0YXRlIG9mIHRoZSBmcmFtZS5cbiAgICpcbiAgICogSWYgZGlzYWJsZWQsIG5vIHJlcXVlc3RzIHdpbGwgYmUgaW50ZXJjZXB0ZWQgYnkgdGhlIGZyYW1lLlxuICAgKi9cbiAgZ2V0IGRpc2FibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmhhc0F0dHJpYnV0ZShcImRpc2FibGVkXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgZGlzYWJsZWQgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiBkaXNhYmxlZCwgbm8gcmVxdWVzdHMgd2lsbCBiZSBpbnRlcmNlcHRlZCBieSB0aGUgZnJhbWUuXG4gICAqL1xuICBzZXQgZGlzYWJsZWQodmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGF1dG9zY3JvbGwgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiB0cnVlLCB0aGUgZnJhbWUgd2lsbCBiZSBzY3JvbGxlZCBpbnRvIHZpZXcgYXV0b21hdGljYWxseSBvbiB1cGRhdGUuXG4gICAqL1xuICBnZXQgYXV0b3Njcm9sbCgpIHtcbiAgICByZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoXCJhdXRvc2Nyb2xsXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYXV0b3Njcm9sbCBzdGF0ZSBvZiB0aGUgZnJhbWUuXG4gICAqXG4gICAqIElmIHRydWUsIHRoZSBmcmFtZSB3aWxsIGJlIHNjcm9sbGVkIGludG8gdmlldyBhdXRvbWF0aWNhbGx5IG9uIHVwZGF0ZS5cbiAgICovXG4gIHNldCBhdXRvc2Nyb2xsKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImF1dG9zY3JvbGxcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiYXV0b3Njcm9sbFwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgZWxlbWVudCBoYXMgZmluaXNoZWQgbG9hZGluZ1xuICAgKi9cbiAgZ2V0IGNvbXBsZXRlKCkge1xuICAgIHJldHVybiAhdGhpcy5kZWxlZ2F0ZS5pc0xvYWRpbmdcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBhY3RpdmUgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiBpbmFjdGl2ZSwgc291cmNlIGNoYW5nZXMgd2lsbCBub3QgYmUgb2JzZXJ2ZWQuXG4gICAqL1xuICBnZXQgaXNBY3RpdmUoKSB7XG4gICAgcmV0dXJuIHRoaXMub3duZXJEb2N1bWVudCA9PT0gZG9jdW1lbnQgJiYgIXRoaXMuaXNQcmV2aWV3XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYWN0aXZlIHN0YXRlIG9mIHRoZSBmcmFtZS5cbiAgICpcbiAgICogSWYgaW5hY3RpdmUsIHNvdXJjZSBjaGFuZ2VzIHdpbGwgbm90IGJlIG9ic2VydmVkLlxuICAgKi9cbiAgZ2V0IGlzUHJldmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5vd25lckRvY3VtZW50Py5kb2N1bWVudEVsZW1lbnQ/Lmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tcHJldmlld1wiKVxuICB9XG59XG5cbmZ1bmN0aW9uIGZyYW1lTG9hZGluZ1N0eWxlRnJvbVN0cmluZyhzdHlsZSkge1xuICBzd2l0Y2ggKHN0eWxlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlIFwibGF6eVwiOlxuICAgICAgcmV0dXJuIEZyYW1lTG9hZGluZ1N0eWxlLmxhenlcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIEZyYW1lTG9hZGluZ1N0eWxlLmVhZ2VyXG4gIH1cbn1cblxuY29uc3QgZHJpdmUgPSB7XG4gIGVuYWJsZWQ6IHRydWUsXG4gIHByb2dyZXNzQmFyRGVsYXk6IDUwMCxcbiAgdW52aXNpdGFibGVFeHRlbnNpb25zOiBuZXcgU2V0KFxuICAgIFtcbiAgICAgIFwiLjd6XCIsIFwiLmFhY1wiLCBcIi5hcGtcIiwgXCIuYXZpXCIsIFwiLmJtcFwiLCBcIi5iejJcIiwgXCIuY3NzXCIsIFwiLmNzdlwiLCBcIi5kZWJcIiwgXCIuZG1nXCIsIFwiLmRvY1wiLFxuICAgICAgXCIuZG9jeFwiLCBcIi5leGVcIiwgXCIuZ2lmXCIsIFwiLmd6XCIsIFwiLmhlaWNcIiwgXCIuaGVpZlwiLCBcIi5pY29cIiwgXCIuaXNvXCIsIFwiLmpwZWdcIiwgXCIuanBnXCIsXG4gICAgICBcIi5qc1wiLCBcIi5qc29uXCIsIFwiLm00YVwiLCBcIi5ta3ZcIiwgXCIubW92XCIsIFwiLm1wM1wiLCBcIi5tcDRcIiwgXCIubXBlZ1wiLCBcIi5tcGdcIiwgXCIubXNpXCIsXG4gICAgICBcIi5vZ2dcIiwgXCIub2d2XCIsIFwiLnBkZlwiLCBcIi5wa2dcIiwgXCIucG5nXCIsIFwiLnBwdFwiLCBcIi5wcHR4XCIsIFwiLnJhclwiLCBcIi5ydGZcIixcbiAgICAgIFwiLnN2Z1wiLCBcIi50YXJcIiwgXCIudGlmXCIsIFwiLnRpZmZcIiwgXCIudHh0XCIsIFwiLndhdlwiLCBcIi53ZWJtXCIsIFwiLndlYnBcIiwgXCIud21hXCIsIFwiLndtdlwiLFxuICAgICAgXCIueGxzXCIsIFwiLnhsc3hcIiwgXCIueG1sXCIsIFwiLnppcFwiXG4gICAgXVxuICApXG59O1xuXG5mdW5jdGlvbiBhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWV2YWxcIikgPT0gXCJmYWxzZVwiKSB7XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBjcmVhdGVkU2NyaXB0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgY29uc3QgY3NwTm9uY2UgPSBnZXRDc3BOb25jZSgpO1xuICAgIGlmIChjc3BOb25jZSkge1xuICAgICAgY3JlYXRlZFNjcmlwdEVsZW1lbnQubm9uY2UgPSBjc3BOb25jZTtcbiAgICB9XG4gICAgY3JlYXRlZFNjcmlwdEVsZW1lbnQudGV4dENvbnRlbnQgPSBlbGVtZW50LnRleHRDb250ZW50O1xuICAgIGNyZWF0ZWRTY3JpcHRFbGVtZW50LmFzeW5jID0gZmFsc2U7XG4gICAgY29weUVsZW1lbnRBdHRyaWJ1dGVzKGNyZWF0ZWRTY3JpcHRFbGVtZW50LCBlbGVtZW50KTtcbiAgICByZXR1cm4gY3JlYXRlZFNjcmlwdEVsZW1lbnRcbiAgfVxufVxuXG5mdW5jdGlvbiBjb3B5RWxlbWVudEF0dHJpYnV0ZXMoZGVzdGluYXRpb25FbGVtZW50LCBzb3VyY2VFbGVtZW50KSB7XG4gIGZvciAoY29uc3QgeyBuYW1lLCB2YWx1ZSB9IG9mIHNvdXJjZUVsZW1lbnQuYXR0cmlidXRlcykge1xuICAgIGRlc3RpbmF0aW9uRWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50RnJhZ21lbnQoaHRtbCkge1xuICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZW1wbGF0ZVwiKTtcbiAgdGVtcGxhdGUuaW5uZXJIVE1MID0gaHRtbDtcbiAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnRcbn1cblxuZnVuY3Rpb24gZGlzcGF0Y2goZXZlbnROYW1lLCB7IHRhcmdldCwgY2FuY2VsYWJsZSwgZGV0YWlsIH0gPSB7fSkge1xuICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudE5hbWUsIHtcbiAgICBjYW5jZWxhYmxlLFxuICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgY29tcG9zZWQ6IHRydWUsXG4gICAgZGV0YWlsXG4gIH0pO1xuXG4gIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmlzQ29ubmVjdGVkKSB7XG4gICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9IGVsc2Uge1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfVxuXG4gIHJldHVybiBldmVudFxufVxuXG5mdW5jdGlvbiBjYW5jZWxFdmVudChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbn1cblxuZnVuY3Rpb24gbmV4dFJlcGFpbnQoKSB7XG4gIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT09IFwiaGlkZGVuXCIpIHtcbiAgICByZXR1cm4gbmV4dEV2ZW50TG9vcFRpY2soKVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBuZXh0QW5pbWF0aW9uRnJhbWUoKVxuICB9XG59XG5cbmZ1bmN0aW9uIG5leHRBbmltYXRpb25GcmFtZSgpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVzb2x2ZSgpKSlcbn1cblxuZnVuY3Rpb24gbmV4dEV2ZW50TG9vcFRpY2soKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKCksIDApKVxufVxuXG5mdW5jdGlvbiBuZXh0TWljcm90YXNrKCkge1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbn1cblxuZnVuY3Rpb24gcGFyc2VIVE1MRG9jdW1lbnQoaHRtbCA9IFwiXCIpIHtcbiAgcmV0dXJuIG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoaHRtbCwgXCJ0ZXh0L2h0bWxcIilcbn1cblxuZnVuY3Rpb24gdW5pbmRlbnQoc3RyaW5ncywgLi4udmFsdWVzKSB7XG4gIGNvbnN0IGxpbmVzID0gaW50ZXJwb2xhdGUoc3RyaW5ncywgdmFsdWVzKS5yZXBsYWNlKC9eXFxuLywgXCJcIikuc3BsaXQoXCJcXG5cIik7XG4gIGNvbnN0IG1hdGNoID0gbGluZXNbMF0ubWF0Y2goL15cXHMrLyk7XG4gIGNvbnN0IGluZGVudCA9IG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMDtcbiAgcmV0dXJuIGxpbmVzLm1hcCgobGluZSkgPT4gbGluZS5zbGljZShpbmRlbnQpKS5qb2luKFwiXFxuXCIpXG59XG5cbmZ1bmN0aW9uIGludGVycG9sYXRlKHN0cmluZ3MsIHZhbHVlcykge1xuICByZXR1cm4gc3RyaW5ncy5yZWR1Y2UoKHJlc3VsdCwgc3RyaW5nLCBpKSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV0gPT0gdW5kZWZpbmVkID8gXCJcIiA6IHZhbHVlc1tpXTtcbiAgICByZXR1cm4gcmVzdWx0ICsgc3RyaW5nICsgdmFsdWVcbiAgfSwgXCJcIilcbn1cblxuZnVuY3Rpb24gdXVpZCgpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGg6IDM2IH0pXG4gICAgLm1hcCgoXywgaSkgPT4ge1xuICAgICAgaWYgKGkgPT0gOCB8fCBpID09IDEzIHx8IGkgPT0gMTggfHwgaSA9PSAyMykge1xuICAgICAgICByZXR1cm4gXCItXCJcbiAgICAgIH0gZWxzZSBpZiAoaSA9PSAxNCkge1xuICAgICAgICByZXR1cm4gXCI0XCJcbiAgICAgIH0gZWxzZSBpZiAoaSA9PSAxOSkge1xuICAgICAgICByZXR1cm4gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgOCkudG9TdHJpbmcoMTYpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTUpLnRvU3RyaW5nKDE2KVxuICAgICAgfVxuICAgIH0pXG4gICAgLmpvaW4oXCJcIilcbn1cblxuZnVuY3Rpb24gZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIC4uLmVsZW1lbnRzKSB7XG4gIGZvciAoY29uc3QgdmFsdWUgb2YgZWxlbWVudHMubWFwKChlbGVtZW50KSA9PiBlbGVtZW50Py5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkpKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKSByZXR1cm4gdmFsdWVcbiAgfVxuXG4gIHJldHVybiBudWxsXG59XG5cbmZ1bmN0aW9uIGhhc0F0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCAuLi5lbGVtZW50cykge1xuICByZXR1cm4gZWxlbWVudHMuc29tZSgoZWxlbWVudCkgPT4gZWxlbWVudCAmJiBlbGVtZW50Lmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSlcbn1cblxuZnVuY3Rpb24gbWFya0FzQnVzeSguLi5lbGVtZW50cykge1xuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHtcbiAgICBpZiAoZWxlbWVudC5sb2NhbE5hbWUgPT0gXCJ0dXJiby1mcmFtZVwiKSB7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImJ1c3lcIiwgXCJcIik7XG4gICAgfVxuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1idXN5XCIsIFwidHJ1ZVwiKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjbGVhckJ1c3lTdGF0ZSguLi5lbGVtZW50cykge1xuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHtcbiAgICBpZiAoZWxlbWVudC5sb2NhbE5hbWUgPT0gXCJ0dXJiby1mcmFtZVwiKSB7XG4gICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImJ1c3lcIik7XG4gICAgfVxuXG4gICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWJ1c3lcIik7XG4gIH1cbn1cblxuZnVuY3Rpb24gd2FpdEZvckxvYWQoZWxlbWVudCwgdGltZW91dEluTWlsbGlzZWNvbmRzID0gMjAwMCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjb25zdCBvbkNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgb25Db21wbGV0ZSk7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uQ29tcGxldGUpO1xuICAgICAgcmVzb2x2ZSgpO1xuICAgIH07XG5cbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uQ29tcGxldGUsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBvbkNvbXBsZXRlLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCB0aW1lb3V0SW5NaWxsaXNlY29uZHMpO1xuICB9KVxufVxuXG5mdW5jdGlvbiBnZXRIaXN0b3J5TWV0aG9kRm9yQWN0aW9uKGFjdGlvbikge1xuICBzd2l0Y2ggKGFjdGlvbikge1xuICAgIGNhc2UgXCJyZXBsYWNlXCI6XG4gICAgICByZXR1cm4gaGlzdG9yeS5yZXBsYWNlU3RhdGVcbiAgICBjYXNlIFwiYWR2YW5jZVwiOlxuICAgIGNhc2UgXCJyZXN0b3JlXCI6XG4gICAgICByZXR1cm4gaGlzdG9yeS5wdXNoU3RhdGVcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0FjdGlvbihhY3Rpb24pIHtcbiAgcmV0dXJuIGFjdGlvbiA9PSBcImFkdmFuY2VcIiB8fCBhY3Rpb24gPT0gXCJyZXBsYWNlXCIgfHwgYWN0aW9uID09IFwicmVzdG9yZVwiXG59XG5cbmZ1bmN0aW9uIGdldFZpc2l0QWN0aW9uKC4uLmVsZW1lbnRzKSB7XG4gIGNvbnN0IGFjdGlvbiA9IGdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tYWN0aW9uXCIsIC4uLmVsZW1lbnRzKTtcblxuICByZXR1cm4gaXNBY3Rpb24oYWN0aW9uKSA/IGFjdGlvbiA6IG51bGxcbn1cblxuZnVuY3Rpb24gZ2V0TWV0YUVsZW1lbnQobmFtZSkge1xuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbWV0YVtuYW1lPVwiJHtuYW1lfVwiXWApXG59XG5cbmZ1bmN0aW9uIGdldE1ldGFDb250ZW50KG5hbWUpIHtcbiAgY29uc3QgZWxlbWVudCA9IGdldE1ldGFFbGVtZW50KG5hbWUpO1xuICByZXR1cm4gZWxlbWVudCAmJiBlbGVtZW50LmNvbnRlbnRcbn1cblxuZnVuY3Rpb24gZ2V0Q3NwTm9uY2UoKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBnZXRNZXRhRWxlbWVudChcImNzcC1ub25jZVwiKTtcblxuICBpZiAoZWxlbWVudCkge1xuICAgIGNvbnN0IHsgbm9uY2UsIGNvbnRlbnQgfSA9IGVsZW1lbnQ7XG4gICAgcmV0dXJuIG5vbmNlID09IFwiXCIgPyBjb250ZW50IDogbm9uY2VcbiAgfVxufVxuXG5mdW5jdGlvbiBzZXRNZXRhQ29udGVudChuYW1lLCBjb250ZW50KSB7XG4gIGxldCBlbGVtZW50ID0gZ2V0TWV0YUVsZW1lbnQobmFtZSk7XG5cbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJtZXRhXCIpO1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBuYW1lKTtcblxuICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gIH1cblxuICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImNvbnRlbnRcIiwgY29udGVudCk7XG5cbiAgcmV0dXJuIGVsZW1lbnRcbn1cblxuZnVuY3Rpb24gZmluZENsb3Nlc3RSZWN1cnNpdmVseShlbGVtZW50LCBzZWxlY3Rvcikge1xuICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgZWxlbWVudC5jbG9zZXN0KHNlbGVjdG9yKSB8fCBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KGVsZW1lbnQuYXNzaWduZWRTbG90IHx8IGVsZW1lbnQuZ2V0Um9vdE5vZGUoKT8uaG9zdCwgc2VsZWN0b3IpXG4gICAgKVxuICB9XG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRJc0ZvY3VzYWJsZShlbGVtZW50KSB7XG4gIGNvbnN0IGluZXJ0RGlzYWJsZWRPckhpZGRlbiA9IFwiW2luZXJ0XSwgOmRpc2FibGVkLCBbaGlkZGVuXSwgZGV0YWlsczpub3QoW29wZW5dKSwgZGlhbG9nOm5vdChbb3Blbl0pXCI7XG5cbiAgcmV0dXJuICEhZWxlbWVudCAmJiBlbGVtZW50LmNsb3Nlc3QoaW5lcnREaXNhYmxlZE9ySGlkZGVuKSA9PSBudWxsICYmIHR5cGVvZiBlbGVtZW50LmZvY3VzID09IFwiZnVuY3Rpb25cIlxufVxuXG5mdW5jdGlvbiBxdWVyeUF1dG9mb2N1c2FibGVFbGVtZW50KGVsZW1lbnRPckRvY3VtZW50RnJhZ21lbnQpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudE9yRG9jdW1lbnRGcmFnbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2F1dG9mb2N1c11cIikpLmZpbmQoZWxlbWVudElzRm9jdXNhYmxlKVxufVxuXG5hc3luYyBmdW5jdGlvbiBhcm91bmQoY2FsbGJhY2ssIHJlYWRlcikge1xuICBjb25zdCBiZWZvcmUgPSByZWFkZXIoKTtcblxuICBjYWxsYmFjaygpO1xuXG4gIGF3YWl0IG5leHRBbmltYXRpb25GcmFtZSgpO1xuXG4gIGNvbnN0IGFmdGVyID0gcmVhZGVyKCk7XG5cbiAgcmV0dXJuIFtiZWZvcmUsIGFmdGVyXVxufVxuXG5mdW5jdGlvbiBkb2VzTm90VGFyZ2V0SUZyYW1lKG5hbWUpIHtcbiAgaWYgKG5hbWUgPT09IFwiX2JsYW5rXCIpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfSBlbHNlIGlmIChuYW1lKSB7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKG5hbWUpKSB7XG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KSByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9IGVsc2Uge1xuICAgIHJldHVybiB0cnVlXG4gIH1cbn1cblxuZnVuY3Rpb24gZmluZExpbmtGcm9tQ2xpY2tUYXJnZXQodGFyZ2V0KSB7XG4gIHJldHVybiBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KHRhcmdldCwgXCJhW2hyZWZdOm5vdChbdGFyZ2V0Xj1fXSk6bm90KFtkb3dubG9hZF0pXCIpXG59XG5cbmZ1bmN0aW9uIGdldExvY2F0aW9uRm9yTGluayhsaW5rKSB7XG4gIHJldHVybiBleHBhbmRVUkwobGluay5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpIHx8IFwiXCIpXG59XG5cbmZ1bmN0aW9uIGRlYm91bmNlKGZuLCBkZWxheSkge1xuICBsZXQgdGltZW91dElkID0gbnVsbDtcblxuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCBjYWxsYmFjayA9ICgpID0+IGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoY2FsbGJhY2ssIGRlbGF5KTtcbiAgfVxufVxuXG5jb25zdCBzdWJtaXR0ZXIgPSB7XG4gIFwiYXJpYS1kaXNhYmxlZFwiOiB7XG4gICAgYmVmb3JlU3VibWl0OiBzdWJtaXR0ZXIgPT4ge1xuICAgICAgc3VibWl0dGVyLnNldEF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xuICAgICAgc3VibWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjYW5jZWxFdmVudCk7XG4gICAgfSxcblxuICAgIGFmdGVyU3VibWl0OiBzdWJtaXR0ZXIgPT4ge1xuICAgICAgc3VibWl0dGVyLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIik7XG4gICAgICBzdWJtaXR0ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNhbmNlbEV2ZW50KTtcbiAgICB9XG4gIH0sXG5cbiAgXCJkaXNhYmxlZFwiOiB7XG4gICAgYmVmb3JlU3VibWl0OiBzdWJtaXR0ZXIgPT4gc3VibWl0dGVyLmRpc2FibGVkID0gdHJ1ZSxcbiAgICBhZnRlclN1Ym1pdDogc3VibWl0dGVyID0+IHN1Ym1pdHRlci5kaXNhYmxlZCA9IGZhbHNlXG4gIH1cbn07XG5cbmNsYXNzIENvbmZpZyB7XG4gICNzdWJtaXR0ZXIgPSBudWxsXG5cbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCBjb25maWcpO1xuICB9XG5cbiAgZ2V0IHN1Ym1pdHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy4jc3VibWl0dGVyXG4gIH1cblxuICBzZXQgc3VibWl0dGVyKHZhbHVlKSB7XG4gICAgdGhpcy4jc3VibWl0dGVyID0gc3VibWl0dGVyW3ZhbHVlXSB8fCB2YWx1ZTtcbiAgfVxufVxuXG5jb25zdCBmb3JtcyA9IG5ldyBDb25maWcoe1xuICBtb2RlOiBcIm9uXCIsXG4gIHN1Ym1pdHRlcjogXCJkaXNhYmxlZFwiXG59KTtcblxuY29uc3QgY29uZmlnID0ge1xuICBkcml2ZSxcbiAgZm9ybXNcbn07XG5cbmZ1bmN0aW9uIGV4cGFuZFVSTChsb2NhdGFibGUpIHtcbiAgcmV0dXJuIG5ldyBVUkwobG9jYXRhYmxlLnRvU3RyaW5nKCksIGRvY3VtZW50LmJhc2VVUkkpXG59XG5cbmZ1bmN0aW9uIGdldEFuY2hvcih1cmwpIHtcbiAgbGV0IGFuY2hvck1hdGNoO1xuICBpZiAodXJsLmhhc2gpIHtcbiAgICByZXR1cm4gdXJsLmhhc2guc2xpY2UoMSlcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uZC1hc3NpZ25cbiAgfSBlbHNlIGlmICgoYW5jaG9yTWF0Y2ggPSB1cmwuaHJlZi5tYXRjaCgvIyguKikkLykpKSB7XG4gICAgcmV0dXJuIGFuY2hvck1hdGNoWzFdXG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0QWN0aW9uJDEoZm9ybSwgc3VibWl0dGVyKSB7XG4gIGNvbnN0IGFjdGlvbiA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybWFjdGlvblwiKSB8fCBmb3JtLmdldEF0dHJpYnV0ZShcImFjdGlvblwiKSB8fCBmb3JtLmFjdGlvbjtcblxuICByZXR1cm4gZXhwYW5kVVJMKGFjdGlvbilcbn1cblxuZnVuY3Rpb24gZ2V0RXh0ZW5zaW9uKHVybCkge1xuICByZXR1cm4gKGdldExhc3RQYXRoQ29tcG9uZW50KHVybCkubWF0Y2goL1xcLlteLl0qJC8pIHx8IFtdKVswXSB8fCBcIlwiXG59XG5cbmZ1bmN0aW9uIGlzUHJlZml4ZWRCeShiYXNlVVJMLCB1cmwpIHtcbiAgY29uc3QgcHJlZml4ID0gZ2V0UHJlZml4KHVybCk7XG4gIHJldHVybiBiYXNlVVJMLmhyZWYgPT09IGV4cGFuZFVSTChwcmVmaXgpLmhyZWYgfHwgYmFzZVVSTC5ocmVmLnN0YXJ0c1dpdGgocHJlZml4KVxufVxuXG5mdW5jdGlvbiBsb2NhdGlvbklzVmlzaXRhYmxlKGxvY2F0aW9uLCByb290TG9jYXRpb24pIHtcbiAgcmV0dXJuIGlzUHJlZml4ZWRCeShsb2NhdGlvbiwgcm9vdExvY2F0aW9uKSAmJiAhY29uZmlnLmRyaXZlLnVudmlzaXRhYmxlRXh0ZW5zaW9ucy5oYXMoZ2V0RXh0ZW5zaW9uKGxvY2F0aW9uKSlcbn1cblxuZnVuY3Rpb24gZ2V0UmVxdWVzdFVSTCh1cmwpIHtcbiAgY29uc3QgYW5jaG9yID0gZ2V0QW5jaG9yKHVybCk7XG4gIHJldHVybiBhbmNob3IgIT0gbnVsbCA/IHVybC5ocmVmLnNsaWNlKDAsIC0oYW5jaG9yLmxlbmd0aCArIDEpKSA6IHVybC5ocmVmXG59XG5cbmZ1bmN0aW9uIHRvQ2FjaGVLZXkodXJsKSB7XG4gIHJldHVybiBnZXRSZXF1ZXN0VVJMKHVybClcbn1cblxuZnVuY3Rpb24gdXJsc0FyZUVxdWFsKGxlZnQsIHJpZ2h0KSB7XG4gIHJldHVybiBleHBhbmRVUkwobGVmdCkuaHJlZiA9PSBleHBhbmRVUkwocmlnaHQpLmhyZWZcbn1cblxuZnVuY3Rpb24gZ2V0UGF0aENvbXBvbmVudHModXJsKSB7XG4gIHJldHVybiB1cmwucGF0aG5hbWUuc3BsaXQoXCIvXCIpLnNsaWNlKDEpXG59XG5cbmZ1bmN0aW9uIGdldExhc3RQYXRoQ29tcG9uZW50KHVybCkge1xuICByZXR1cm4gZ2V0UGF0aENvbXBvbmVudHModXJsKS5zbGljZSgtMSlbMF1cbn1cblxuZnVuY3Rpb24gZ2V0UHJlZml4KHVybCkge1xuICByZXR1cm4gYWRkVHJhaWxpbmdTbGFzaCh1cmwub3JpZ2luICsgdXJsLnBhdGhuYW1lKVxufVxuXG5mdW5jdGlvbiBhZGRUcmFpbGluZ1NsYXNoKHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZS5lbmRzV2l0aChcIi9cIikgPyB2YWx1ZSA6IHZhbHVlICsgXCIvXCJcbn1cblxuY2xhc3MgRmV0Y2hSZXNwb25zZSB7XG4gIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICB9XG5cbiAgZ2V0IHN1Y2NlZWRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5yZXNwb25zZS5va1xuICB9XG5cbiAgZ2V0IGZhaWxlZCgpIHtcbiAgICByZXR1cm4gIXRoaXMuc3VjY2VlZGVkXG4gIH1cblxuICBnZXQgY2xpZW50RXJyb3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzQ29kZSA+PSA0MDAgJiYgdGhpcy5zdGF0dXNDb2RlIDw9IDQ5OVxuICB9XG5cbiAgZ2V0IHNlcnZlckVycm9yKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXR1c0NvZGUgPj0gNTAwICYmIHRoaXMuc3RhdHVzQ29kZSA8PSA1OTlcbiAgfVxuXG4gIGdldCByZWRpcmVjdGVkKCkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlLnJlZGlyZWN0ZWRcbiAgfVxuXG4gIGdldCBsb2NhdGlvbigpIHtcbiAgICByZXR1cm4gZXhwYW5kVVJMKHRoaXMucmVzcG9uc2UudXJsKVxuICB9XG5cbiAgZ2V0IGlzSFRNTCgpIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZW50VHlwZSAmJiB0aGlzLmNvbnRlbnRUeXBlLm1hdGNoKC9eKD86dGV4dFxcLyhbXlxcczssXStcXGIpP2h0bWx8YXBwbGljYXRpb25cXC94aHRtbFxcK3htbClcXGIvKVxuICB9XG5cbiAgZ2V0IHN0YXR1c0NvZGUoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzcG9uc2Uuc3RhdHVzXG4gIH1cblxuICBnZXQgY29udGVudFR5cGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZGVyKFwiQ29udGVudC1UeXBlXCIpXG4gIH1cblxuICBnZXQgcmVzcG9uc2VUZXh0KCkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlLmNsb25lKCkudGV4dCgpXG4gIH1cblxuICBnZXQgcmVzcG9uc2VIVE1MKCkge1xuICAgIGlmICh0aGlzLmlzSFRNTCkge1xuICAgICAgcmV0dXJuIHRoaXMucmVzcG9uc2UuY2xvbmUoKS50ZXh0KClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpXG4gICAgfVxuICB9XG5cbiAgaGVhZGVyKG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5yZXNwb25zZS5oZWFkZXJzLmdldChuYW1lKVxuICB9XG59XG5cbmNsYXNzIExpbWl0ZWRTZXQgZXh0ZW5kcyBTZXQge1xuICBjb25zdHJ1Y3RvcihtYXhTaXplKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm1heFNpemUgPSBtYXhTaXplO1xuICB9XG5cbiAgYWRkKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuc2l6ZSA+PSB0aGlzLm1heFNpemUpIHtcbiAgICAgIGNvbnN0IGl0ZXJhdG9yID0gdGhpcy52YWx1ZXMoKTtcbiAgICAgIGNvbnN0IG9sZGVzdFZhbHVlID0gaXRlcmF0b3IubmV4dCgpLnZhbHVlO1xuICAgICAgdGhpcy5kZWxldGUob2xkZXN0VmFsdWUpO1xuICAgIH1cbiAgICBzdXBlci5hZGQodmFsdWUpO1xuICB9XG59XG5cbmNvbnN0IHJlY2VudFJlcXVlc3RzID0gbmV3IExpbWl0ZWRTZXQoMjApO1xuXG5jb25zdCBuYXRpdmVGZXRjaCA9IHdpbmRvdy5mZXRjaDtcblxuZnVuY3Rpb24gZmV0Y2hXaXRoVHVyYm9IZWFkZXJzKHVybCwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IG1vZGlmaWVkSGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycyB8fCB7fSk7XG4gIGNvbnN0IHJlcXVlc3RVSUQgPSB1dWlkKCk7XG4gIHJlY2VudFJlcXVlc3RzLmFkZChyZXF1ZXN0VUlEKTtcbiAgbW9kaWZpZWRIZWFkZXJzLmFwcGVuZChcIlgtVHVyYm8tUmVxdWVzdC1JZFwiLCByZXF1ZXN0VUlEKTtcblxuICByZXR1cm4gbmF0aXZlRmV0Y2godXJsLCB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBoZWFkZXJzOiBtb2RpZmllZEhlYWRlcnNcbiAgfSlcbn1cblxuZnVuY3Rpb24gZmV0Y2hNZXRob2RGcm9tU3RyaW5nKG1ldGhvZCkge1xuICBzd2l0Y2ggKG1ldGhvZC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBcImdldFwiOlxuICAgICAgcmV0dXJuIEZldGNoTWV0aG9kLmdldFxuICAgIGNhc2UgXCJwb3N0XCI6XG4gICAgICByZXR1cm4gRmV0Y2hNZXRob2QucG9zdFxuICAgIGNhc2UgXCJwdXRcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5wdXRcbiAgICBjYXNlIFwicGF0Y2hcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5wYXRjaFxuICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5kZWxldGVcbiAgfVxufVxuXG5jb25zdCBGZXRjaE1ldGhvZCA9IHtcbiAgZ2V0OiBcImdldFwiLFxuICBwb3N0OiBcInBvc3RcIixcbiAgcHV0OiBcInB1dFwiLFxuICBwYXRjaDogXCJwYXRjaFwiLFxuICBkZWxldGU6IFwiZGVsZXRlXCJcbn07XG5cbmZ1bmN0aW9uIGZldGNoRW5jdHlwZUZyb21TdHJpbmcoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChlbmNvZGluZy50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBGZXRjaEVuY3R5cGUubXVsdGlwYXJ0OlxuICAgICAgcmV0dXJuIEZldGNoRW5jdHlwZS5tdWx0aXBhcnRcbiAgICBjYXNlIEZldGNoRW5jdHlwZS5wbGFpbjpcbiAgICAgIHJldHVybiBGZXRjaEVuY3R5cGUucGxhaW5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIEZldGNoRW5jdHlwZS51cmxFbmNvZGVkXG4gIH1cbn1cblxuY29uc3QgRmV0Y2hFbmN0eXBlID0ge1xuICB1cmxFbmNvZGVkOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICBtdWx0aXBhcnQ6IFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiLFxuICBwbGFpbjogXCJ0ZXh0L3BsYWluXCJcbn07XG5cbmNsYXNzIEZldGNoUmVxdWVzdCB7XG4gIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxuICAjcmVzb2x2ZVJlcXVlc3RQcm9taXNlID0gKF92YWx1ZSkgPT4ge31cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgbWV0aG9kLCBsb2NhdGlvbiwgcmVxdWVzdEJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCksIHRhcmdldCA9IG51bGwsIGVuY3R5cGUgPSBGZXRjaEVuY3R5cGUudXJsRW5jb2RlZCkge1xuICAgIGNvbnN0IFt1cmwsIGJvZHldID0gYnVpbGRSZXNvdXJjZUFuZEJvZHkoZXhwYW5kVVJMKGxvY2F0aW9uKSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgZW5jdHlwZSk7XG5cbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMgPSB7XG4gICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgcmVkaXJlY3Q6IFwiZm9sbG93XCIsXG4gICAgICBtZXRob2Q6IG1ldGhvZC50b1VwcGVyQ2FzZSgpLFxuICAgICAgaGVhZGVyczogeyAuLi50aGlzLmRlZmF1bHRIZWFkZXJzIH0sXG4gICAgICBib2R5OiBib2R5LFxuICAgICAgc2lnbmFsOiB0aGlzLmFib3J0U2lnbmFsLFxuICAgICAgcmVmZXJyZXI6IHRoaXMuZGVsZWdhdGUucmVmZXJyZXI/LmhyZWZcbiAgICB9O1xuICAgIHRoaXMuZW5jdHlwZSA9IGVuY3R5cGU7XG4gIH1cblxuICBnZXQgbWV0aG9kKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoT3B0aW9ucy5tZXRob2RcbiAgfVxuXG4gIHNldCBtZXRob2QodmFsdWUpIHtcbiAgICBjb25zdCBmZXRjaEJvZHkgPSB0aGlzLmlzU2FmZSA/IHRoaXMudXJsLnNlYXJjaFBhcmFtcyA6IHRoaXMuZmV0Y2hPcHRpb25zLmJvZHkgfHwgbmV3IEZvcm1EYXRhKCk7XG4gICAgY29uc3QgZmV0Y2hNZXRob2QgPSBmZXRjaE1ldGhvZEZyb21TdHJpbmcodmFsdWUpIHx8IEZldGNoTWV0aG9kLmdldDtcblxuICAgIHRoaXMudXJsLnNlYXJjaCA9IFwiXCI7XG5cbiAgICBjb25zdCBbdXJsLCBib2R5XSA9IGJ1aWxkUmVzb3VyY2VBbmRCb2R5KHRoaXMudXJsLCBmZXRjaE1ldGhvZCwgZmV0Y2hCb2R5LCB0aGlzLmVuY3R5cGUpO1xuXG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMuYm9keSA9IGJvZHk7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMubWV0aG9kID0gZmV0Y2hNZXRob2QudG9VcHBlckNhc2UoKTtcbiAgfVxuXG4gIGdldCBoZWFkZXJzKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoT3B0aW9ucy5oZWFkZXJzXG4gIH1cblxuICBzZXQgaGVhZGVycyh2YWx1ZSkge1xuICAgIHRoaXMuZmV0Y2hPcHRpb25zLmhlYWRlcnMgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBib2R5KCkge1xuICAgIGlmICh0aGlzLmlzU2FmZSkge1xuICAgICAgcmV0dXJuIHRoaXMudXJsLnNlYXJjaFBhcmFtc1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5mZXRjaE9wdGlvbnMuYm9keVxuICAgIH1cbiAgfVxuXG4gIHNldCBib2R5KHZhbHVlKSB7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMuYm9keSA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnVybFxuICB9XG5cbiAgZ2V0IHBhcmFtcygpIHtcbiAgICByZXR1cm4gdGhpcy51cmwuc2VhcmNoUGFyYW1zXG4gIH1cblxuICBnZXQgZW50cmllcygpIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5ID8gQXJyYXkuZnJvbSh0aGlzLmJvZHkuZW50cmllcygpKSA6IFtdXG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgfVxuXG4gIGFzeW5jIHBlcmZvcm0oKSB7XG4gICAgY29uc3QgeyBmZXRjaE9wdGlvbnMgfSA9IHRoaXM7XG4gICAgdGhpcy5kZWxlZ2F0ZS5wcmVwYXJlUmVxdWVzdCh0aGlzKTtcbiAgICBjb25zdCBldmVudCA9IGF3YWl0IHRoaXMuI2FsbG93UmVxdWVzdFRvQmVJbnRlcmNlcHRlZChmZXRjaE9wdGlvbnMpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnJlcXVlc3RTdGFydGVkKHRoaXMpO1xuXG4gICAgICBpZiAoZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdCkge1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdC5yZXNwb25zZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSBmZXRjaFdpdGhUdXJib0hlYWRlcnModGhpcy51cmwuaHJlZiwgZmV0Y2hPcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlc3BvbnNlO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucmVjZWl2ZShyZXNwb25zZSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLm5hbWUgIT09IFwiQWJvcnRFcnJvclwiKSB7XG4gICAgICAgIGlmICh0aGlzLiN3aWxsRGVsZWdhdGVFcnJvckhhbmRsaW5nKGVycm9yKSkge1xuICAgICAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdEVycm9yZWQodGhpcywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdEZpbmlzaGVkKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlY2VpdmUocmVzcG9uc2UpIHtcbiAgICBjb25zdCBmZXRjaFJlc3BvbnNlID0gbmV3IEZldGNoUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtZmV0Y2gtcmVzcG9uc2VcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyBmZXRjaFJlc3BvbnNlIH0sXG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0XG4gICAgfSk7XG4gICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdFByZXZlbnRlZEhhbmRsaW5nUmVzcG9uc2UodGhpcywgZmV0Y2hSZXNwb25zZSk7XG4gICAgfSBlbHNlIGlmIChmZXRjaFJlc3BvbnNlLnN1Y2NlZWRlZCkge1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5yZXF1ZXN0U3VjY2VlZGVkV2l0aFJlc3BvbnNlKHRoaXMsIGZldGNoUmVzcG9uc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UodGhpcywgZmV0Y2hSZXNwb25zZSk7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaFJlc3BvbnNlXG4gIH1cblxuICBnZXQgZGVmYXVsdEhlYWRlcnMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIEFjY2VwdDogXCJ0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3hodG1sK3htbFwiXG4gICAgfVxuICB9XG5cbiAgZ2V0IGlzU2FmZSgpIHtcbiAgICByZXR1cm4gaXNTYWZlKHRoaXMubWV0aG9kKVxuICB9XG5cbiAgZ2V0IGFib3J0U2lnbmFsKCkge1xuICAgIHJldHVybiB0aGlzLmFib3J0Q29udHJvbGxlci5zaWduYWxcbiAgfVxuXG4gIGFjY2VwdFJlc3BvbnNlVHlwZShtaW1lVHlwZSkge1xuICAgIHRoaXMuaGVhZGVyc1tcIkFjY2VwdFwiXSA9IFttaW1lVHlwZSwgdGhpcy5oZWFkZXJzW1wiQWNjZXB0XCJdXS5qb2luKFwiLCBcIik7XG4gIH1cblxuICBhc3luYyAjYWxsb3dSZXF1ZXN0VG9CZUludGVyY2VwdGVkKGZldGNoT3B0aW9ucykge1xuICAgIGNvbnN0IHJlcXVlc3RJbnRlcmNlcHRpb24gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gKHRoaXMuI3Jlc29sdmVSZXF1ZXN0UHJvbWlzZSA9IHJlc29sdmUpKTtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZldGNoLXJlcXVlc3RcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDoge1xuICAgICAgICBmZXRjaE9wdGlvbnMsXG4gICAgICAgIHVybDogdGhpcy51cmwsXG4gICAgICAgIHJlc3VtZTogdGhpcy4jcmVzb2x2ZVJlcXVlc3RQcm9taXNlXG4gICAgICB9LFxuICAgICAgdGFyZ2V0OiB0aGlzLnRhcmdldFxuICAgIH0pO1xuICAgIHRoaXMudXJsID0gZXZlbnQuZGV0YWlsLnVybDtcbiAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgYXdhaXQgcmVxdWVzdEludGVyY2VwdGlvbjtcblxuICAgIHJldHVybiBldmVudFxuICB9XG5cbiAgI3dpbGxEZWxlZ2F0ZUVycm9ySGFuZGxpbmcoZXJyb3IpIHtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86ZmV0Y2gtcmVxdWVzdC1lcnJvclwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyByZXF1ZXN0OiB0aGlzLCBlcnJvcjogZXJyb3IgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cbn1cblxuZnVuY3Rpb24gaXNTYWZlKGZldGNoTWV0aG9kKSB7XG4gIHJldHVybiBmZXRjaE1ldGhvZEZyb21TdHJpbmcoZmV0Y2hNZXRob2QpID09IEZldGNoTWV0aG9kLmdldFxufVxuXG5mdW5jdGlvbiBidWlsZFJlc291cmNlQW5kQm9keShyZXNvdXJjZSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgZW5jdHlwZSkge1xuICBjb25zdCBzZWFyY2hQYXJhbXMgPVxuICAgIEFycmF5LmZyb20ocmVxdWVzdEJvZHkpLmxlbmd0aCA+IDAgPyBuZXcgVVJMU2VhcmNoUGFyYW1zKGVudHJpZXNFeGNsdWRpbmdGaWxlcyhyZXF1ZXN0Qm9keSkpIDogcmVzb3VyY2Uuc2VhcmNoUGFyYW1zO1xuXG4gIGlmIChpc1NhZmUobWV0aG9kKSkge1xuICAgIHJldHVybiBbbWVyZ2VJbnRvVVJMU2VhcmNoUGFyYW1zKHJlc291cmNlLCBzZWFyY2hQYXJhbXMpLCBudWxsXVxuICB9IGVsc2UgaWYgKGVuY3R5cGUgPT0gRmV0Y2hFbmN0eXBlLnVybEVuY29kZWQpIHtcbiAgICByZXR1cm4gW3Jlc291cmNlLCBzZWFyY2hQYXJhbXNdXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFtyZXNvdXJjZSwgcmVxdWVzdEJvZHldXG4gIH1cbn1cblxuZnVuY3Rpb24gZW50cmllc0V4Y2x1ZGluZ0ZpbGVzKHJlcXVlc3RCb2R5KSB7XG4gIGNvbnN0IGVudHJpZXMgPSBbXTtcblxuICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgcmVxdWVzdEJvZHkpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBGaWxlKSBjb250aW51ZVxuICAgIGVsc2UgZW50cmllcy5wdXNoKFtuYW1lLCB2YWx1ZV0pO1xuICB9XG5cbiAgcmV0dXJuIGVudHJpZXNcbn1cblxuZnVuY3Rpb24gbWVyZ2VJbnRvVVJMU2VhcmNoUGFyYW1zKHVybCwgcmVxdWVzdEJvZHkpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhlbnRyaWVzRXhjbHVkaW5nRmlsZXMocmVxdWVzdEJvZHkpKTtcblxuICB1cmwuc2VhcmNoID0gc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCk7XG5cbiAgcmV0dXJuIHVybFxufVxuXG5jbGFzcyBBcHBlYXJhbmNlT2JzZXJ2ZXIge1xuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIodGhpcy5pbnRlcnNlY3QpO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlci51bm9ic2VydmUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBpbnRlcnNlY3QgPSAoZW50cmllcykgPT4ge1xuICAgIGNvbnN0IGxhc3RFbnRyeSA9IGVudHJpZXMuc2xpY2UoLTEpWzBdO1xuICAgIGlmIChsYXN0RW50cnk/LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRBcHBlYXJlZEluVmlld3BvcnQodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgU3RyZWFtTWVzc2FnZSB7XG4gIHN0YXRpYyBjb250ZW50VHlwZSA9IFwidGV4dC92bmQudHVyYm8tc3RyZWFtLmh0bWxcIlxuXG4gIHN0YXRpYyB3cmFwKG1lc3NhZ2UpIHtcbiAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIG5ldyB0aGlzKGNyZWF0ZURvY3VtZW50RnJhZ21lbnQobWVzc2FnZSkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtZXNzYWdlXG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gaW1wb3J0U3RyZWFtRWxlbWVudHMoZnJhZ21lbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGltcG9ydFN0cmVhbUVsZW1lbnRzKGZyYWdtZW50KSB7XG4gIGZvciAoY29uc3QgZWxlbWVudCBvZiBmcmFnbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwidHVyYm8tc3RyZWFtXCIpKSB7XG4gICAgY29uc3Qgc3RyZWFtRWxlbWVudCA9IGRvY3VtZW50LmltcG9ydE5vZGUoZWxlbWVudCwgdHJ1ZSk7XG5cbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiBzdHJlYW1FbGVtZW50LnRlbXBsYXRlRWxlbWVudC5jb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIikpIHtcbiAgICAgIGluZXJ0U2NyaXB0RWxlbWVudC5yZXBsYWNlV2l0aChhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoaW5lcnRTY3JpcHRFbGVtZW50KSk7XG4gICAgfVxuXG4gICAgZWxlbWVudC5yZXBsYWNlV2l0aChzdHJlYW1FbGVtZW50KTtcbiAgfVxuXG4gIHJldHVybiBmcmFnbWVudFxufVxuXG5jb25zdCBQUkVGRVRDSF9ERUxBWSA9IDEwMDtcblxuY2xhc3MgUHJlZmV0Y2hDYWNoZSB7XG4gICNwcmVmZXRjaFRpbWVvdXQgPSBudWxsXG4gICNwcmVmZXRjaGVkID0gbnVsbFxuXG4gIGdldCh1cmwpIHtcbiAgICBpZiAodGhpcy4jcHJlZmV0Y2hlZCAmJiB0aGlzLiNwcmVmZXRjaGVkLnVybCA9PT0gdXJsICYmIHRoaXMuI3ByZWZldGNoZWQuZXhwaXJlID4gRGF0ZS5ub3coKSkge1xuICAgICAgcmV0dXJuIHRoaXMuI3ByZWZldGNoZWQucmVxdWVzdFxuICAgIH1cbiAgfVxuXG4gIHNldExhdGVyKHVybCwgcmVxdWVzdCwgdHRsKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgdGhpcy4jcHJlZmV0Y2hUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXF1ZXN0LnBlcmZvcm0oKTtcbiAgICAgIHRoaXMuc2V0KHVybCwgcmVxdWVzdCwgdHRsKTtcbiAgICAgIHRoaXMuI3ByZWZldGNoVGltZW91dCA9IG51bGw7XG4gICAgfSwgUFJFRkVUQ0hfREVMQVkpO1xuICB9XG5cbiAgc2V0KHVybCwgcmVxdWVzdCwgdHRsKSB7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZCA9IHsgdXJsLCByZXF1ZXN0LCBleHBpcmU6IG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgdHRsKSB9O1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgaWYgKHRoaXMuI3ByZWZldGNoVGltZW91dCkgY2xlYXJUaW1lb3V0KHRoaXMuI3ByZWZldGNoVGltZW91dCk7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZCA9IG51bGw7XG4gIH1cbn1cblxuY29uc3QgY2FjaGVUdGwgPSAxMCAqIDEwMDA7XG5jb25zdCBwcmVmZXRjaENhY2hlID0gbmV3IFByZWZldGNoQ2FjaGUoKTtcblxuY29uc3QgRm9ybVN1Ym1pc3Npb25TdGF0ZSA9IHtcbiAgaW5pdGlhbGl6ZWQ6IFwiaW5pdGlhbGl6ZWRcIixcbiAgcmVxdWVzdGluZzogXCJyZXF1ZXN0aW5nXCIsXG4gIHdhaXRpbmc6IFwid2FpdGluZ1wiLFxuICByZWNlaXZpbmc6IFwicmVjZWl2aW5nXCIsXG4gIHN0b3BwaW5nOiBcInN0b3BwaW5nXCIsXG4gIHN0b3BwZWQ6IFwic3RvcHBlZFwiXG59O1xuXG5jbGFzcyBGb3JtU3VibWlzc2lvbiB7XG4gIHN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5pbml0aWFsaXplZFxuXG4gIHN0YXRpYyBjb25maXJtTWV0aG9kKG1lc3NhZ2UpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbmZpcm0obWVzc2FnZSkpXG4gIH1cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZm9ybUVsZW1lbnQsIHN1Ym1pdHRlciwgbXVzdFJlZGlyZWN0ID0gZmFsc2UpIHtcbiAgICBjb25zdCBtZXRob2QgPSBnZXRNZXRob2QoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgY29uc3QgYWN0aW9uID0gZ2V0QWN0aW9uKGdldEZvcm1BY3Rpb24oZm9ybUVsZW1lbnQsIHN1Ym1pdHRlciksIG1ldGhvZCk7XG4gICAgY29uc3QgYm9keSA9IGJ1aWxkRm9ybURhdGEoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgY29uc3QgZW5jdHlwZSA9IGdldEVuY3R5cGUoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcik7XG5cbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuc3VibWl0dGVyID0gc3VibWl0dGVyO1xuICAgIHRoaXMuZmV0Y2hSZXF1ZXN0ID0gbmV3IEZldGNoUmVxdWVzdCh0aGlzLCBtZXRob2QsIGFjdGlvbiwgYm9keSwgZm9ybUVsZW1lbnQsIGVuY3R5cGUpO1xuICAgIHRoaXMubXVzdFJlZGlyZWN0ID0gbXVzdFJlZGlyZWN0O1xuICB9XG5cbiAgZ2V0IG1ldGhvZCgpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QubWV0aG9kXG4gIH1cblxuICBzZXQgbWV0aG9kKHZhbHVlKSB7XG4gICAgdGhpcy5mZXRjaFJlcXVlc3QubWV0aG9kID0gdmFsdWU7XG4gIH1cblxuICBnZXQgYWN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdC51cmwudG9TdHJpbmcoKVxuICB9XG5cbiAgc2V0IGFjdGlvbih2YWx1ZSkge1xuICAgIHRoaXMuZmV0Y2hSZXF1ZXN0LnVybCA9IGV4cGFuZFVSTCh2YWx1ZSk7XG4gIH1cblxuICBnZXQgYm9keSgpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QuYm9keVxuICB9XG5cbiAgZ2V0IGVuY3R5cGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LmVuY3R5cGVcbiAgfVxuXG4gIGdldCBpc1NhZmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LmlzU2FmZVxuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdC51cmxcbiAgfVxuXG4gIC8vIFRoZSBzdWJtaXNzaW9uIHByb2Nlc3NcblxuICBhc3luYyBzdGFydCgpIHtcbiAgICBjb25zdCB7IGluaXRpYWxpemVkLCByZXF1ZXN0aW5nIH0gPSBGb3JtU3VibWlzc2lvblN0YXRlO1xuICAgIGNvbnN0IGNvbmZpcm1hdGlvbk1lc3NhZ2UgPSBnZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIiwgdGhpcy5zdWJtaXR0ZXIsIHRoaXMuZm9ybUVsZW1lbnQpO1xuXG4gICAgaWYgKHR5cGVvZiBjb25maXJtYXRpb25NZXNzYWdlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBjb25maXJtTWV0aG9kID0gdHlwZW9mIGNvbmZpZy5mb3Jtcy5jb25maXJtID09PSBcImZ1bmN0aW9uXCIgP1xuICAgICAgICBjb25maWcuZm9ybXMuY29uZmlybSA6XG4gICAgICAgIEZvcm1TdWJtaXNzaW9uLmNvbmZpcm1NZXRob2Q7XG5cbiAgICAgIGNvbnN0IGFuc3dlciA9IGF3YWl0IGNvbmZpcm1NZXRob2QoY29uZmlybWF0aW9uTWVzc2FnZSwgdGhpcy5mb3JtRWxlbWVudCwgdGhpcy5zdWJtaXR0ZXIpO1xuICAgICAgaWYgKCFhbnN3ZXIpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gaW5pdGlhbGl6ZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSByZXF1ZXN0aW5nO1xuICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LnBlcmZvcm0oKVxuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgY29uc3QgeyBzdG9wcGluZywgc3RvcHBlZCB9ID0gRm9ybVN1Ym1pc3Npb25TdGF0ZTtcbiAgICBpZiAodGhpcy5zdGF0ZSAhPSBzdG9wcGluZyAmJiB0aGlzLnN0YXRlICE9IHN0b3BwZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBzdG9wcGluZztcbiAgICAgIHRoaXMuZmV0Y2hSZXF1ZXN0LmNhbmNlbCgpO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cblxuICAvLyBGZXRjaCByZXF1ZXN0IGRlbGVnYXRlXG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIGlmICghcmVxdWVzdC5pc1NhZmUpIHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2V0Q29va2llVmFsdWUoZ2V0TWV0YUNvbnRlbnQoXCJjc3JmLXBhcmFtXCIpKSB8fCBnZXRNZXRhQ29udGVudChcImNzcmYtdG9rZW5cIik7XG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgcmVxdWVzdC5oZWFkZXJzW1wiWC1DU1JGLVRva2VuXCJdID0gdG9rZW47XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucmVxdWVzdEFjY2VwdHNUdXJib1N0cmVhbVJlc3BvbnNlKHJlcXVlc3QpKSB7XG4gICAgICByZXF1ZXN0LmFjY2VwdFJlc3BvbnNlVHlwZShTdHJlYW1NZXNzYWdlLmNvbnRlbnRUeXBlKTtcbiAgICB9XG4gIH1cblxuICByZXF1ZXN0U3RhcnRlZChfcmVxdWVzdCkge1xuICAgIHRoaXMuc3RhdGUgPSBGb3JtU3VibWlzc2lvblN0YXRlLndhaXRpbmc7XG4gICAgaWYgKHRoaXMuc3VibWl0dGVyKSBjb25maWcuZm9ybXMuc3VibWl0dGVyLmJlZm9yZVN1Ym1pdCh0aGlzLnN1Ym1pdHRlcik7XG4gICAgdGhpcy5zZXRTdWJtaXRzV2l0aCgpO1xuICAgIG1hcmtBc0J1c3kodGhpcy5mb3JtRWxlbWVudCk7XG4gICAgZGlzcGF0Y2goXCJ0dXJibzpzdWJtaXQtc3RhcnRcIiwge1xuICAgICAgdGFyZ2V0OiB0aGlzLmZvcm1FbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGZvcm1TdWJtaXNzaW9uOiB0aGlzIH1cbiAgICB9KTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uU3RhcnRlZCh0aGlzKTtcbiAgfVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuXG4gICAgdGhpcy5yZXN1bHQgPSB7IHN1Y2Nlc3M6IHJlc3BvbnNlLnN1Y2NlZWRlZCwgZmV0Y2hSZXNwb25zZTogcmVzcG9uc2UgfTtcbiAgfVxuXG4gIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBpZiAocmVzcG9uc2UuY2xpZW50RXJyb3IgfHwgcmVzcG9uc2Uuc2VydmVyRXJyb3IpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UodGhpcywgcmVzcG9uc2UpO1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuXG4gICAgaWYgKHRoaXMucmVxdWVzdE11c3RSZWRpcmVjdChyZXF1ZXN0KSAmJiByZXNwb25zZVN1Y2NlZWRlZFdpdGhvdXRSZWRpcmVjdChyZXNwb25zZSkpIHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiRm9ybSByZXNwb25zZXMgbXVzdCByZWRpcmVjdCB0byBhbm90aGVyIGxvY2F0aW9uXCIpO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkVycm9yZWQodGhpcywgZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5yZWNlaXZpbmc7XG4gICAgICB0aGlzLnJlc3VsdCA9IHsgc3VjY2VzczogdHJ1ZSwgZmV0Y2hSZXNwb25zZTogcmVzcG9uc2UgfTtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UodGhpcywgcmVzcG9uc2UpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICB0aGlzLnJlc3VsdCA9IHsgc3VjY2VzczogZmFsc2UsIGZldGNoUmVzcG9uc2U6IHJlc3BvbnNlIH07XG4gICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkZhaWxlZFdpdGhSZXNwb25zZSh0aGlzLCByZXNwb25zZSk7XG4gIH1cblxuICByZXF1ZXN0RXJyb3JlZChyZXF1ZXN0LCBlcnJvcikge1xuICAgIHRoaXMucmVzdWx0ID0geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3IgfTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uRXJyb3JlZCh0aGlzLCBlcnJvcik7XG4gIH1cblxuICByZXF1ZXN0RmluaXNoZWQoX3JlcXVlc3QpIHtcbiAgICB0aGlzLnN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5zdG9wcGVkO1xuICAgIGlmICh0aGlzLnN1Ym1pdHRlcikgY29uZmlnLmZvcm1zLnN1Ym1pdHRlci5hZnRlclN1Ym1pdCh0aGlzLnN1Ym1pdHRlcik7XG4gICAgdGhpcy5yZXNldFN1Ym1pdHRlclRleHQoKTtcbiAgICBjbGVhckJ1c3lTdGF0ZSh0aGlzLmZvcm1FbGVtZW50KTtcbiAgICBkaXNwYXRjaChcInR1cmJvOnN1Ym1pdC1lbmRcIiwge1xuICAgICAgdGFyZ2V0OiB0aGlzLmZvcm1FbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGZvcm1TdWJtaXNzaW9uOiB0aGlzLCAuLi50aGlzLnJlc3VsdCB9XG4gICAgfSk7XG4gICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkZpbmlzaGVkKHRoaXMpO1xuICB9XG5cbiAgLy8gUHJpdmF0ZVxuXG4gIHNldFN1Ym1pdHNXaXRoKCkge1xuICAgIGlmICghdGhpcy5zdWJtaXR0ZXIgfHwgIXRoaXMuc3VibWl0c1dpdGgpIHJldHVyblxuXG4gICAgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJidXR0b25cIikpIHtcbiAgICAgIHRoaXMub3JpZ2luYWxTdWJtaXRUZXh0ID0gdGhpcy5zdWJtaXR0ZXIuaW5uZXJIVE1MO1xuICAgICAgdGhpcy5zdWJtaXR0ZXIuaW5uZXJIVE1MID0gdGhpcy5zdWJtaXRzV2l0aDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJpbnB1dFwiKSkge1xuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLnN1Ym1pdHRlcjtcbiAgICAgIHRoaXMub3JpZ2luYWxTdWJtaXRUZXh0ID0gaW5wdXQudmFsdWU7XG4gICAgICBpbnB1dC52YWx1ZSA9IHRoaXMuc3VibWl0c1dpdGg7XG4gICAgfVxuICB9XG5cbiAgcmVzZXRTdWJtaXR0ZXJUZXh0KCkge1xuICAgIGlmICghdGhpcy5zdWJtaXR0ZXIgfHwgIXRoaXMub3JpZ2luYWxTdWJtaXRUZXh0KSByZXR1cm5cblxuICAgIGlmICh0aGlzLnN1Ym1pdHRlci5tYXRjaGVzKFwiYnV0dG9uXCIpKSB7XG4gICAgICB0aGlzLnN1Ym1pdHRlci5pbm5lckhUTUwgPSB0aGlzLm9yaWdpbmFsU3VibWl0VGV4dDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJpbnB1dFwiKSkge1xuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLnN1Ym1pdHRlcjtcbiAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5vcmlnaW5hbFN1Ym1pdFRleHQ7XG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdE11c3RSZWRpcmVjdChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuICFyZXF1ZXN0LmlzU2FmZSAmJiB0aGlzLm11c3RSZWRpcmVjdFxuICB9XG5cbiAgcmVxdWVzdEFjY2VwdHNUdXJib1N0cmVhbVJlc3BvbnNlKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gIXJlcXVlc3QuaXNTYWZlIHx8IGhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tc3RyZWFtXCIsIHRoaXMuc3VibWl0dGVyLCB0aGlzLmZvcm1FbGVtZW50KVxuICB9XG5cbiAgZ2V0IHN1Ym1pdHNXaXRoKCkge1xuICAgIHJldHVybiB0aGlzLnN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1zdWJtaXRzLXdpdGhcIilcbiAgfVxufVxuXG5mdW5jdGlvbiBidWlsZEZvcm1EYXRhKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybUVsZW1lbnQpO1xuICBjb25zdCBuYW1lID0gc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICBjb25zdCB2YWx1ZSA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XG5cbiAgaWYgKG5hbWUpIHtcbiAgICBmb3JtRGF0YS5hcHBlbmQobmFtZSwgdmFsdWUgfHwgXCJcIik7XG4gIH1cblxuICByZXR1cm4gZm9ybURhdGFcbn1cblxuZnVuY3Rpb24gZ2V0Q29va2llVmFsdWUoY29va2llTmFtZSkge1xuICBpZiAoY29va2llTmFtZSAhPSBudWxsKSB7XG4gICAgY29uc3QgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZSA/IGRvY3VtZW50LmNvb2tpZS5zcGxpdChcIjsgXCIpIDogW107XG4gICAgY29uc3QgY29va2llID0gY29va2llcy5maW5kKChjb29raWUpID0+IGNvb2tpZS5zdGFydHNXaXRoKGNvb2tpZU5hbWUpKTtcbiAgICBpZiAoY29va2llKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGNvb2tpZS5zcGxpdChcIj1cIikuc2xpY2UoMSkuam9pbihcIj1cIik7XG4gICAgICByZXR1cm4gdmFsdWUgPyBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpIDogdW5kZWZpbmVkXG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlc3BvbnNlU3VjY2VlZGVkV2l0aG91dFJlZGlyZWN0KHJlc3BvbnNlKSB7XG4gIHJldHVybiByZXNwb25zZS5zdGF0dXNDb2RlID09IDIwMCAmJiAhcmVzcG9uc2UucmVkaXJlY3RlZFxufVxuXG5mdW5jdGlvbiBnZXRGb3JtQWN0aW9uKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgY29uc3QgZm9ybUVsZW1lbnRBY3Rpb24gPSB0eXBlb2YgZm9ybUVsZW1lbnQuYWN0aW9uID09PSBcInN0cmluZ1wiID8gZm9ybUVsZW1lbnQuYWN0aW9uIDogbnVsbDtcblxuICBpZiAoc3VibWl0dGVyPy5oYXNBdHRyaWJ1dGUoXCJmb3JtYWN0aW9uXCIpKSB7XG4gICAgcmV0dXJuIHN1Ym1pdHRlci5nZXRBdHRyaWJ1dGUoXCJmb3JtYWN0aW9uXCIpIHx8IFwiXCJcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpIHx8IGZvcm1FbGVtZW50QWN0aW9uIHx8IFwiXCJcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRBY3Rpb24oZm9ybUFjdGlvbiwgZmV0Y2hNZXRob2QpIHtcbiAgY29uc3QgYWN0aW9uID0gZXhwYW5kVVJMKGZvcm1BY3Rpb24pO1xuXG4gIGlmIChpc1NhZmUoZmV0Y2hNZXRob2QpKSB7XG4gICAgYWN0aW9uLnNlYXJjaCA9IFwiXCI7XG4gIH1cblxuICByZXR1cm4gYWN0aW9uXG59XG5cbmZ1bmN0aW9uIGdldE1ldGhvZChmb3JtRWxlbWVudCwgc3VibWl0dGVyKSB7XG4gIGNvbnN0IG1ldGhvZCA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybW1ldGhvZFwiKSB8fCBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIikgfHwgXCJcIjtcbiAgcmV0dXJuIGZldGNoTWV0aG9kRnJvbVN0cmluZyhtZXRob2QudG9Mb3dlckNhc2UoKSkgfHwgRmV0Y2hNZXRob2QuZ2V0XG59XG5cbmZ1bmN0aW9uIGdldEVuY3R5cGUoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICByZXR1cm4gZmV0Y2hFbmN0eXBlRnJvbVN0cmluZyhzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImZvcm1lbmN0eXBlXCIpIHx8IGZvcm1FbGVtZW50LmVuY3R5cGUpXG59XG5cbmNsYXNzIFNuYXBzaG90IHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gIH1cblxuICBnZXQgYWN0aXZlRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuYWN0aXZlRWxlbWVudFxuICB9XG5cbiAgZ2V0IGNoaWxkcmVuKCkge1xuICAgIHJldHVybiBbLi4udGhpcy5lbGVtZW50LmNoaWxkcmVuXVxuICB9XG5cbiAgaGFzQW5jaG9yKGFuY2hvcikge1xuICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRGb3JBbmNob3IoYW5jaG9yKSAhPSBudWxsXG4gIH1cblxuICBnZXRFbGVtZW50Rm9yQW5jaG9yKGFuY2hvcikge1xuICAgIHJldHVybiBhbmNob3IgPyB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihgW2lkPScke2FuY2hvcn0nXSwgYVtuYW1lPScke2FuY2hvcn0nXWApIDogbnVsbFxuICB9XG5cbiAgZ2V0IGlzQ29ubmVjdGVkKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuaXNDb25uZWN0ZWRcbiAgfVxuXG4gIGdldCBmaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50KCkge1xuICAgIHJldHVybiBxdWVyeUF1dG9mb2N1c2FibGVFbGVtZW50KHRoaXMuZWxlbWVudClcbiAgfVxuXG4gIGdldCBwZXJtYW5lbnRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gcXVlcnlQZXJtYW5lbnRFbGVtZW50c0FsbCh0aGlzLmVsZW1lbnQpXG4gIH1cblxuICBnZXRQZXJtYW5lbnRFbGVtZW50QnlJZChpZCkge1xuICAgIHJldHVybiBnZXRQZXJtYW5lbnRFbGVtZW50QnlJZCh0aGlzLmVsZW1lbnQsIGlkKVxuICB9XG5cbiAgZ2V0UGVybWFuZW50RWxlbWVudE1hcEZvclNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgY29uc3QgcGVybWFuZW50RWxlbWVudE1hcCA9IHt9O1xuXG4gICAgZm9yIChjb25zdCBjdXJyZW50UGVybWFuZW50RWxlbWVudCBvZiB0aGlzLnBlcm1hbmVudEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSBjdXJyZW50UGVybWFuZW50RWxlbWVudDtcbiAgICAgIGNvbnN0IG5ld1Blcm1hbmVudEVsZW1lbnQgPSBzbmFwc2hvdC5nZXRQZXJtYW5lbnRFbGVtZW50QnlJZChpZCk7XG4gICAgICBpZiAobmV3UGVybWFuZW50RWxlbWVudCkge1xuICAgICAgICBwZXJtYW5lbnRFbGVtZW50TWFwW2lkXSA9IFtjdXJyZW50UGVybWFuZW50RWxlbWVudCwgbmV3UGVybWFuZW50RWxlbWVudF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHBlcm1hbmVudEVsZW1lbnRNYXBcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRQZXJtYW5lbnRFbGVtZW50QnlJZChub2RlLCBpZCkge1xuICByZXR1cm4gbm9kZS5xdWVyeVNlbGVjdG9yKGAjJHtpZH1bZGF0YS10dXJiby1wZXJtYW5lbnRdYClcbn1cblxuZnVuY3Rpb24gcXVlcnlQZXJtYW5lbnRFbGVtZW50c0FsbChub2RlKSB7XG4gIHJldHVybiBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbaWRdW2RhdGEtdHVyYm8tcGVybWFuZW50XVwiKVxufVxuXG5jbGFzcyBGb3JtU3VibWl0T2JzZXJ2ZXIge1xuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZXZlbnRUYXJnZXQpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5ldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0O1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLnN1Ym1pdENhcHR1cmVkLCB0cnVlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRDYXB0dXJlZCwgdHJ1ZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBzdWJtaXRDYXB0dXJlZCA9ICgpID0+IHtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRCdWJibGVkLCBmYWxzZSk7XG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuc3VibWl0QnViYmxlZCwgZmFsc2UpO1xuICB9XG5cbiAgc3VibWl0QnViYmxlZCA9IChldmVudCkgPT4ge1xuICAgIGlmICghZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgY29uc3QgZm9ybSA9IGV2ZW50LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCA/IGV2ZW50LnRhcmdldCA6IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IHN1Ym1pdHRlciA9IGV2ZW50LnN1Ym1pdHRlciB8fCB1bmRlZmluZWQ7XG5cbiAgICAgIGlmIChcbiAgICAgICAgZm9ybSAmJlxuICAgICAgICBzdWJtaXNzaW9uRG9lc05vdERpc21pc3NEaWFsb2coZm9ybSwgc3VibWl0dGVyKSAmJlxuICAgICAgICBzdWJtaXNzaW9uRG9lc05vdFRhcmdldElGcmFtZShmb3JtLCBzdWJtaXR0ZXIpICYmXG4gICAgICAgIHRoaXMuZGVsZWdhdGUud2lsbFN1Ym1pdEZvcm0oZm9ybSwgc3VibWl0dGVyKVxuICAgICAgKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXR0ZWQoZm9ybSwgc3VibWl0dGVyKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gc3VibWlzc2lvbkRvZXNOb3REaXNtaXNzRGlhbG9nKGZvcm0sIHN1Ym1pdHRlcikge1xuICBjb25zdCBtZXRob2QgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImZvcm1tZXRob2RcIikgfHwgZm9ybS5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIik7XG5cbiAgcmV0dXJuIG1ldGhvZCAhPSBcImRpYWxvZ1wiXG59XG5cbmZ1bmN0aW9uIHN1Ym1pc3Npb25Eb2VzTm90VGFyZ2V0SUZyYW1lKGZvcm0sIHN1Ym1pdHRlcikge1xuICBjb25zdCB0YXJnZXQgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImZvcm10YXJnZXRcIikgfHwgZm9ybS5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIik7XG5cbiAgcmV0dXJuIGRvZXNOb3RUYXJnZXRJRnJhbWUodGFyZ2V0KVxufVxuXG5jbGFzcyBWaWV3IHtcbiAgI3Jlc29sdmVSZW5kZXJQcm9taXNlID0gKF92YWx1ZSkgPT4ge31cbiAgI3Jlc29sdmVJbnRlcmNlcHRpb25Qcm9taXNlID0gKF92YWx1ZSkgPT4ge31cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgLy8gU2Nyb2xsaW5nXG5cbiAgc2Nyb2xsVG9BbmNob3IoYW5jaG9yKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc25hcHNob3QuZ2V0RWxlbWVudEZvckFuY2hvcihhbmNob3IpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICB0aGlzLnNjcm9sbFRvRWxlbWVudChlbGVtZW50KTtcbiAgICAgIHRoaXMuZm9jdXNFbGVtZW50KGVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNjcm9sbFRvUG9zaXRpb24oeyB4OiAwLCB5OiAwIH0pO1xuICAgIH1cbiAgfVxuXG4gIHNjcm9sbFRvQW5jaG9yRnJvbUxvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgdGhpcy5zY3JvbGxUb0FuY2hvcihnZXRBbmNob3IobG9jYXRpb24pKTtcbiAgfVxuXG4gIHNjcm9sbFRvRWxlbWVudChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5zY3JvbGxJbnRvVmlldygpO1xuICB9XG5cbiAgZm9jdXNFbGVtZW50KGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKSkge1xuICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzY3JvbGxUb1Bvc2l0aW9uKHsgeCwgeSB9KSB7XG4gICAgdGhpcy5zY3JvbGxSb290LnNjcm9sbFRvKHgsIHkpO1xuICB9XG5cbiAgc2Nyb2xsVG9Ub3AoKSB7XG4gICAgdGhpcy5zY3JvbGxUb1Bvc2l0aW9uKHsgeDogMCwgeTogMCB9KTtcbiAgfVxuXG4gIGdldCBzY3JvbGxSb290KCkge1xuICAgIHJldHVybiB3aW5kb3dcbiAgfVxuXG4gIC8vIFJlbmRlcmluZ1xuXG4gIGFzeW5jIHJlbmRlcihyZW5kZXJlcikge1xuICAgIGNvbnN0IHsgaXNQcmV2aWV3LCBzaG91bGRSZW5kZXIsIHdpbGxSZW5kZXIsIG5ld1NuYXBzaG90OiBzbmFwc2hvdCB9ID0gcmVuZGVyZXI7XG5cbiAgICAvLyBBIHdvcmthcm91bmQgdG8gaWdub3JlIHRyYWNrZWQgZWxlbWVudCBtaXNtYXRjaCByZWxvYWRzIHdoZW4gcGVyZm9ybWluZ1xuICAgIC8vIGEgcHJvbW90ZWQgVmlzaXQgZnJvbSBhIGZyYW1lIG5hdmlnYXRpb25cbiAgICBjb25zdCBzaG91bGRJbnZhbGlkYXRlID0gd2lsbFJlbmRlcjtcblxuICAgIGlmIChzaG91bGRSZW5kZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiAodGhpcy4jcmVzb2x2ZVJlbmRlclByb21pc2UgPSByZXNvbHZlKSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgYXdhaXQgdGhpcy5wcmVwYXJlVG9SZW5kZXJTbmFwc2hvdChyZW5kZXJlcik7XG5cbiAgICAgICAgY29uc3QgcmVuZGVySW50ZXJjZXB0aW9uID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+ICh0aGlzLiNyZXNvbHZlSW50ZXJjZXB0aW9uUHJvbWlzZSA9IHJlc29sdmUpKTtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgcmVzdW1lOiB0aGlzLiNyZXNvbHZlSW50ZXJjZXB0aW9uUHJvbWlzZSwgcmVuZGVyOiB0aGlzLnJlbmRlcmVyLnJlbmRlckVsZW1lbnQsIHJlbmRlck1ldGhvZDogdGhpcy5yZW5kZXJlci5yZW5kZXJNZXRob2QgfTtcbiAgICAgICAgY29uc3QgaW1tZWRpYXRlUmVuZGVyID0gdGhpcy5kZWxlZ2F0ZS5hbGxvd3NJbW1lZGlhdGVSZW5kZXIoc25hcHNob3QsIG9wdGlvbnMpO1xuICAgICAgICBpZiAoIWltbWVkaWF0ZVJlbmRlcikgYXdhaXQgcmVuZGVySW50ZXJjZXB0aW9uO1xuXG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyU25hcHNob3QocmVuZGVyZXIpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnZpZXdSZW5kZXJlZFNuYXBzaG90KHNuYXBzaG90LCBpc1ByZXZpZXcsIHRoaXMucmVuZGVyZXIucmVuZGVyTWV0aG9kKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5wcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMuZmluaXNoUmVuZGVyaW5nU25hcHNob3QocmVuZGVyZXIpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgZGVsZXRlIHRoaXMucmVuZGVyZXI7XG4gICAgICAgIHRoaXMuI3Jlc29sdmVSZW5kZXJQcm9taXNlKHVuZGVmaW5lZCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLnJlbmRlclByb21pc2U7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzaG91bGRJbnZhbGlkYXRlKSB7XG4gICAgICB0aGlzLmludmFsaWRhdGUocmVuZGVyZXIucmVsb2FkUmVhc29uKTtcbiAgICB9XG4gIH1cblxuICBpbnZhbGlkYXRlKHJlYXNvbikge1xuICAgIHRoaXMuZGVsZWdhdGUudmlld0ludmFsaWRhdGVkKHJlYXNvbik7XG4gIH1cblxuICBhc3luYyBwcmVwYXJlVG9SZW5kZXJTbmFwc2hvdChyZW5kZXJlcikge1xuICAgIHRoaXMubWFya0FzUHJldmlldyhyZW5kZXJlci5pc1ByZXZpZXcpO1xuICAgIGF3YWl0IHJlbmRlcmVyLnByZXBhcmVUb1JlbmRlcigpO1xuICB9XG5cbiAgbWFya0FzUHJldmlldyhpc1ByZXZpZXcpIHtcbiAgICBpZiAoaXNQcmV2aWV3KSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1wcmV2aWV3XCIsIFwiXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS10dXJiby1wcmV2aWV3XCIpO1xuICAgIH1cbiAgfVxuXG4gIG1hcmtWaXNpdERpcmVjdGlvbihkaXJlY3Rpb24pIHtcbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby12aXNpdC1kaXJlY3Rpb25cIiwgZGlyZWN0aW9uKTtcbiAgfVxuXG4gIHVubWFya1Zpc2l0RGlyZWN0aW9uKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXZpc2l0LWRpcmVjdGlvblwiKTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlclNuYXBzaG90KHJlbmRlcmVyKSB7XG4gICAgYXdhaXQgcmVuZGVyZXIucmVuZGVyKCk7XG4gIH1cblxuICBmaW5pc2hSZW5kZXJpbmdTbmFwc2hvdChyZW5kZXJlcikge1xuICAgIHJlbmRlcmVyLmZpbmlzaFJlbmRlcmluZygpO1xuICB9XG59XG5cbmNsYXNzIEZyYW1lVmlldyBleHRlbmRzIFZpZXcge1xuICBtaXNzaW5nKCkge1xuICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSBgPHN0cm9uZyBjbGFzcz1cInR1cmJvLWZyYW1lLWVycm9yXCI+Q29udGVudCBtaXNzaW5nPC9zdHJvbmc+YDtcbiAgfVxuXG4gIGdldCBzbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gbmV3IFNuYXBzaG90KHRoaXMuZWxlbWVudClcbiAgfVxufVxuXG5jbGFzcyBMaW5rSW50ZXJjZXB0b3Ige1xuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQnViYmxlZCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOmNsaWNrXCIsIHRoaXMubGlua0NsaWNrZWQpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtdmlzaXRcIiwgdGhpcy53aWxsVmlzaXQpO1xuICB9XG5cbiAgc3RvcCgpIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tCdWJibGVkKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86Y2xpY2tcIiwgdGhpcy5saW5rQ2xpY2tlZCk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS12aXNpdFwiLCB0aGlzLndpbGxWaXNpdCk7XG4gIH1cblxuICBjbGlja0J1YmJsZWQgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5jbGlja0V2ZW50SXNTaWduaWZpY2FudChldmVudCkpIHtcbiAgICAgIHRoaXMuY2xpY2tFdmVudCA9IGV2ZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWxldGUgdGhpcy5jbGlja0V2ZW50O1xuICAgIH1cbiAgfVxuXG4gIGxpbmtDbGlja2VkID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKHRoaXMuY2xpY2tFdmVudCAmJiB0aGlzLmNsaWNrRXZlbnRJc1NpZ25pZmljYW50KGV2ZW50KSkge1xuICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc2hvdWxkSW50ZXJjZXB0TGlua0NsaWNrKGV2ZW50LnRhcmdldCwgZXZlbnQuZGV0YWlsLnVybCwgZXZlbnQuZGV0YWlsLm9yaWdpbmFsRXZlbnQpKSB7XG4gICAgICAgIHRoaXMuY2xpY2tFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLmxpbmtDbGlja0ludGVyY2VwdGVkKGV2ZW50LnRhcmdldCwgZXZlbnQuZGV0YWlsLnVybCwgZXZlbnQuZGV0YWlsLm9yaWdpbmFsRXZlbnQpO1xuICAgICAgfVxuICAgIH1cbiAgICBkZWxldGUgdGhpcy5jbGlja0V2ZW50O1xuICB9XG5cbiAgd2lsbFZpc2l0ID0gKF9ldmVudCkgPT4ge1xuICAgIGRlbGV0ZSB0aGlzLmNsaWNrRXZlbnQ7XG4gIH1cblxuICBjbGlja0V2ZW50SXNTaWduaWZpY2FudChldmVudCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LmNvbXBvc2VkID8gZXZlbnQudGFyZ2V0Py5wYXJlbnRFbGVtZW50IDogZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGVsZW1lbnQgPSBmaW5kTGlua0Zyb21DbGlja1RhcmdldCh0YXJnZXQpIHx8IHRhcmdldDtcblxuICAgIHJldHVybiBlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCAmJiBlbGVtZW50LmNsb3Nlc3QoXCJ0dXJiby1mcmFtZSwgaHRtbFwiKSA9PSB0aGlzLmVsZW1lbnRcbiAgfVxufVxuXG5jbGFzcyBMaW5rQ2xpY2tPYnNlcnZlciB7XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBldmVudFRhcmdldCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZXZlbnRUYXJnZXQ7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbGlja0NhcHR1cmVkLCB0cnVlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQ2FwdHVyZWQsIHRydWUpO1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgY2xpY2tDYXB0dXJlZCA9ICgpID0+IHtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQnViYmxlZCwgZmFsc2UpO1xuICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tCdWJibGVkLCBmYWxzZSk7XG4gIH1cblxuICBjbGlja0J1YmJsZWQgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ICYmIHRoaXMuY2xpY2tFdmVudElzU2lnbmlmaWNhbnQoZXZlbnQpKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSAoZXZlbnQuY29tcG9zZWRQYXRoICYmIGV2ZW50LmNvbXBvc2VkUGF0aCgpWzBdKSB8fCBldmVudC50YXJnZXQ7XG4gICAgICBjb25zdCBsaW5rID0gZmluZExpbmtGcm9tQ2xpY2tUYXJnZXQodGFyZ2V0KTtcbiAgICAgIGlmIChsaW5rICYmIGRvZXNOb3RUYXJnZXRJRnJhbWUobGluay50YXJnZXQpKSB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb25Gb3JMaW5rKGxpbmspO1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS53aWxsRm9sbG93TGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2ZW50KSkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5mb2xsb3dlZExpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNsaWNrRXZlbnRJc1NpZ25pZmljYW50KGV2ZW50KSB7XG4gICAgcmV0dXJuICEoXG4gICAgICAoZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5pc0NvbnRlbnRFZGl0YWJsZSkgfHxcbiAgICAgIGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgfHxcbiAgICAgIGV2ZW50LndoaWNoID4gMSB8fFxuICAgICAgZXZlbnQuYWx0S2V5IHx8XG4gICAgICBldmVudC5jdHJsS2V5IHx8XG4gICAgICBldmVudC5tZXRhS2V5IHx8XG4gICAgICBldmVudC5zaGlmdEtleVxuICAgIClcbiAgfVxufVxuXG5jbGFzcyBGb3JtTGlua0NsaWNrT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmxpbmtJbnRlcmNlcHRvciA9IG5ldyBMaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCBlbGVtZW50KTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0YXJ0KCk7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0b3AoKTtcbiAgfVxuXG4gIC8vIExpbmsgaG92ZXIgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBjYW5QcmVmZXRjaFJlcXVlc3RUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBwcmVmZXRjaEFuZENhY2hlUmVxdWVzdFRvTG9jYXRpb24obGluaywgbG9jYXRpb24pIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIC8vIExpbmsgY2xpY2sgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsRm9sbG93TGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIG9yaWdpbmFsRXZlbnQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5kZWxlZ2F0ZS53aWxsU3VibWl0Rm9ybUxpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uLCBvcmlnaW5hbEV2ZW50KSAmJlxuICAgICAgKGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1tZXRob2RcIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKSlcbiAgICApXG4gIH1cblxuICBmb2xsb3dlZExpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xuXG4gICAgY29uc3QgdHlwZSA9IFwiaGlkZGVuXCI7XG4gICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVdIG9mIGxvY2F0aW9uLnNlYXJjaFBhcmFtcykge1xuICAgICAgZm9ybS5hcHBlbmQoT2JqZWN0LmFzc2lnbihkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksIHsgdHlwZSwgbmFtZSwgdmFsdWUgfSkpO1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGlvbiA9IE9iamVjdC5hc3NpZ24obG9jYXRpb24sIHsgc2VhcmNoOiBcIlwiIH0pO1xuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiZGF0YS10dXJib1wiLCBcInRydWVcIik7XG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIiwgYWN0aW9uLmhyZWYpO1xuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiaGlkZGVuXCIsIFwiXCIpO1xuXG4gICAgY29uc3QgbWV0aG9kID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLW1ldGhvZFwiKTtcbiAgICBpZiAobWV0aG9kKSBmb3JtLnNldEF0dHJpYnV0ZShcIm1ldGhvZFwiLCBtZXRob2QpO1xuXG4gICAgY29uc3QgdHVyYm9GcmFtZSA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKTtcbiAgICBpZiAodHVyYm9GcmFtZSkgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIsIHR1cmJvRnJhbWUpO1xuXG4gICAgY29uc3QgdHVyYm9BY3Rpb24gPSBnZXRWaXNpdEFjdGlvbihsaW5rKTtcbiAgICBpZiAodHVyYm9BY3Rpb24pIGZvcm0uc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1hY3Rpb25cIiwgdHVyYm9BY3Rpb24pO1xuXG4gICAgY29uc3QgdHVyYm9Db25maXJtID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIik7XG4gICAgaWYgKHR1cmJvQ29uZmlybSkgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIiwgdHVyYm9Db25maXJtKTtcblxuICAgIGNvbnN0IHR1cmJvU3RyZWFtID0gbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKTtcbiAgICBpZiAodHVyYm9TdHJlYW0pIGZvcm0uc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIiwgXCJcIik7XG5cbiAgICB0aGlzLmRlbGVnYXRlLnN1Ym1pdHRlZEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZm9ybSk7XG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZvcm0pO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOnN1Ym1pdC1lbmRcIiwgKCkgPT4gZm9ybS5yZW1vdmUoKSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBmb3JtLnJlcXVlc3RTdWJtaXQoKSk7XG4gIH1cbn1cblxuY2xhc3MgQmFyZG8ge1xuICBzdGF0aWMgYXN5bmMgcHJlc2VydmluZ1Blcm1hbmVudEVsZW1lbnRzKGRlbGVnYXRlLCBwZXJtYW5lbnRFbGVtZW50TWFwLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IGJhcmRvID0gbmV3IHRoaXMoZGVsZWdhdGUsIHBlcm1hbmVudEVsZW1lbnRNYXApO1xuICAgIGJhcmRvLmVudGVyKCk7XG4gICAgYXdhaXQgY2FsbGJhY2soKTtcbiAgICBiYXJkby5sZWF2ZSgpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIHBlcm1hbmVudEVsZW1lbnRNYXApIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwID0gcGVybWFuZW50RWxlbWVudE1hcDtcbiAgfVxuXG4gIGVudGVyKCkge1xuICAgIGZvciAoY29uc3QgaWQgaW4gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwKSB7XG4gICAgICBjb25zdCBbY3VycmVudFBlcm1hbmVudEVsZW1lbnQsIG5ld1Blcm1hbmVudEVsZW1lbnRdID0gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwW2lkXTtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZW50ZXJpbmdCYXJkbyhjdXJyZW50UGVybWFuZW50RWxlbWVudCwgbmV3UGVybWFuZW50RWxlbWVudCk7XG4gICAgICB0aGlzLnJlcGxhY2VOZXdQZXJtYW5lbnRFbGVtZW50V2l0aFBsYWNlaG9sZGVyKG5ld1Blcm1hbmVudEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGxlYXZlKCkge1xuICAgIGZvciAoY29uc3QgaWQgaW4gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwKSB7XG4gICAgICBjb25zdCBbY3VycmVudFBlcm1hbmVudEVsZW1lbnRdID0gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwW2lkXTtcbiAgICAgIHRoaXMucmVwbGFjZUN1cnJlbnRQZXJtYW5lbnRFbGVtZW50V2l0aENsb25lKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50KTtcbiAgICAgIHRoaXMucmVwbGFjZVBsYWNlaG9sZGVyV2l0aFBlcm1hbmVudEVsZW1lbnQoY3VycmVudFBlcm1hbmVudEVsZW1lbnQpO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5sZWF2aW5nQmFyZG8oY3VycmVudFBlcm1hbmVudEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJlcGxhY2VOZXdQZXJtYW5lbnRFbGVtZW50V2l0aFBsYWNlaG9sZGVyKHBlcm1hbmVudEVsZW1lbnQpIHtcbiAgICBjb25zdCBwbGFjZWhvbGRlciA9IGNyZWF0ZVBsYWNlaG9sZGVyRm9yUGVybWFuZW50RWxlbWVudChwZXJtYW5lbnRFbGVtZW50KTtcbiAgICBwZXJtYW5lbnRFbGVtZW50LnJlcGxhY2VXaXRoKHBsYWNlaG9sZGVyKTtcbiAgfVxuXG4gIHJlcGxhY2VDdXJyZW50UGVybWFuZW50RWxlbWVudFdpdGhDbG9uZShwZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgY29uc3QgY2xvbmUgPSBwZXJtYW5lbnRFbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgICBwZXJtYW5lbnRFbGVtZW50LnJlcGxhY2VXaXRoKGNsb25lKTtcbiAgfVxuXG4gIHJlcGxhY2VQbGFjZWhvbGRlcldpdGhQZXJtYW5lbnRFbGVtZW50KHBlcm1hbmVudEVsZW1lbnQpIHtcbiAgICBjb25zdCBwbGFjZWhvbGRlciA9IHRoaXMuZ2V0UGxhY2Vob2xkZXJCeUlkKHBlcm1hbmVudEVsZW1lbnQuaWQpO1xuICAgIHBsYWNlaG9sZGVyPy5yZXBsYWNlV2l0aChwZXJtYW5lbnRFbGVtZW50KTtcbiAgfVxuXG4gIGdldFBsYWNlaG9sZGVyQnlJZChpZCkge1xuICAgIHJldHVybiB0aGlzLnBsYWNlaG9sZGVycy5maW5kKChlbGVtZW50KSA9PiBlbGVtZW50LmNvbnRlbnQgPT0gaWQpXG4gIH1cblxuICBnZXQgcGxhY2Vob2xkZXJzKCkge1xuICAgIHJldHVybiBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIm1ldGFbbmFtZT10dXJiby1wZXJtYW5lbnQtcGxhY2Vob2xkZXJdW2NvbnRlbnRdXCIpXVxuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVBsYWNlaG9sZGVyRm9yUGVybWFuZW50RWxlbWVudChwZXJtYW5lbnRFbGVtZW50KSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibWV0YVwiKTtcbiAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwidHVyYm8tcGVybWFuZW50LXBsYWNlaG9sZGVyXCIpO1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImNvbnRlbnRcIiwgcGVybWFuZW50RWxlbWVudC5pZCk7XG4gIHJldHVybiBlbGVtZW50XG59XG5cbmNsYXNzIFJlbmRlcmVyIHtcbiAgI2FjdGl2ZUVsZW1lbnQgPSBudWxsXG5cbiAgc3RhdGljIHJlbmRlckVsZW1lbnQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgICAvLyBBYnN0cmFjdCBtZXRob2RcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGN1cnJlbnRTbmFwc2hvdCwgbmV3U25hcHNob3QsIGlzUHJldmlldywgd2lsbFJlbmRlciA9IHRydWUpIHtcbiAgICB0aGlzLmN1cnJlbnRTbmFwc2hvdCA9IGN1cnJlbnRTbmFwc2hvdDtcbiAgICB0aGlzLm5ld1NuYXBzaG90ID0gbmV3U25hcHNob3Q7XG4gICAgdGhpcy5pc1ByZXZpZXcgPSBpc1ByZXZpZXc7XG4gICAgdGhpcy53aWxsUmVuZGVyID0gd2lsbFJlbmRlcjtcbiAgICB0aGlzLnJlbmRlckVsZW1lbnQgPSB0aGlzLmNvbnN0cnVjdG9yLnJlbmRlckVsZW1lbnQ7XG4gICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gKHRoaXMucmVzb2x2aW5nRnVuY3Rpb25zID0geyByZXNvbHZlLCByZWplY3QgfSkpO1xuICB9XG5cbiAgZ2V0IHNob3VsZFJlbmRlcigpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgZ2V0IHNob3VsZEF1dG9mb2N1cygpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgZ2V0IHJlbG9hZFJlYXNvbigpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHByZXBhcmVUb1JlbmRlcigpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICAvLyBBYnN0cmFjdCBtZXRob2RcbiAgfVxuXG4gIGZpbmlzaFJlbmRlcmluZygpIHtcbiAgICBpZiAodGhpcy5yZXNvbHZpbmdGdW5jdGlvbnMpIHtcbiAgICAgIHRoaXMucmVzb2x2aW5nRnVuY3Rpb25zLnJlc29sdmUoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLnJlc29sdmluZ0Z1bmN0aW9ucztcbiAgICB9XG4gIH1cblxuICBhc3luYyBwcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoY2FsbGJhY2spIHtcbiAgICBhd2FpdCBCYXJkby5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHModGhpcywgdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwLCBjYWxsYmFjayk7XG4gIH1cblxuICBmb2N1c0ZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnQoKSB7XG4gICAgaWYgKHRoaXMuc2hvdWxkQXV0b2ZvY3VzKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5jb25uZWN0ZWRTbmFwc2hvdC5maXJzdEF1dG9mb2N1c2FibGVFbGVtZW50O1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEJhcmRvIGRlbGVnYXRlXG5cbiAgZW50ZXJpbmdCYXJkbyhjdXJyZW50UGVybWFuZW50RWxlbWVudCkge1xuICAgIGlmICh0aGlzLiNhY3RpdmVFbGVtZW50KSByZXR1cm5cblxuICAgIGlmIChjdXJyZW50UGVybWFuZW50RWxlbWVudC5jb250YWlucyh0aGlzLmN1cnJlbnRTbmFwc2hvdC5hY3RpdmVFbGVtZW50KSkge1xuICAgICAgdGhpcy4jYWN0aXZlRWxlbWVudCA9IHRoaXMuY3VycmVudFNuYXBzaG90LmFjdGl2ZUVsZW1lbnQ7XG4gICAgfVxuICB9XG5cbiAgbGVhdmluZ0JhcmRvKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgaWYgKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LmNvbnRhaW5zKHRoaXMuI2FjdGl2ZUVsZW1lbnQpICYmIHRoaXMuI2FjdGl2ZUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgdGhpcy4jYWN0aXZlRWxlbWVudC5mb2N1cygpO1xuXG4gICAgICB0aGlzLiNhY3RpdmVFbGVtZW50ID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBnZXQgY29ubmVjdGVkU25hcHNob3QoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3U25hcHNob3QuaXNDb25uZWN0ZWQgPyB0aGlzLm5ld1NuYXBzaG90IDogdGhpcy5jdXJyZW50U25hcHNob3RcbiAgfVxuXG4gIGdldCBjdXJyZW50RWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50U25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgZ2V0IG5ld0VsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3U25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgZ2V0IHBlcm1hbmVudEVsZW1lbnRNYXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFNuYXBzaG90LmdldFBlcm1hbmVudEVsZW1lbnRNYXBGb3JTbmFwc2hvdCh0aGlzLm5ld1NuYXBzaG90KVxuICB9XG5cbiAgZ2V0IHJlbmRlck1ldGhvZCgpIHtcbiAgICByZXR1cm4gXCJyZXBsYWNlXCJcbiAgfVxufVxuXG5jbGFzcyBGcmFtZVJlbmRlcmVyIGV4dGVuZHMgUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIGNvbnN0IGRlc3RpbmF0aW9uUmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgIGRlc3RpbmF0aW9uUmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGN1cnJlbnRFbGVtZW50KTtcbiAgICBkZXN0aW5hdGlvblJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7XG5cbiAgICBjb25zdCBmcmFtZUVsZW1lbnQgPSBuZXdFbGVtZW50O1xuICAgIGNvbnN0IHNvdXJjZVJhbmdlID0gZnJhbWVFbGVtZW50Lm93bmVyRG9jdW1lbnQ/LmNyZWF0ZVJhbmdlKCk7XG4gICAgaWYgKHNvdXJjZVJhbmdlKSB7XG4gICAgICBzb3VyY2VSYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZnJhbWVFbGVtZW50KTtcbiAgICAgIGN1cnJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHNvdXJjZVJhbmdlLmV4dHJhY3RDb250ZW50cygpKTtcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgY3VycmVudFNuYXBzaG90LCBuZXdTbmFwc2hvdCwgcmVuZGVyRWxlbWVudCwgaXNQcmV2aWV3LCB3aWxsUmVuZGVyID0gdHJ1ZSkge1xuICAgIHN1cGVyKGN1cnJlbnRTbmFwc2hvdCwgbmV3U25hcHNob3QsIHJlbmRlckVsZW1lbnQsIGlzUHJldmlldywgd2lsbFJlbmRlcik7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgZ2V0IHNob3VsZFJlbmRlcigpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgYXN5bmMgcmVuZGVyKCkge1xuICAgIGF3YWl0IG5leHRSZXBhaW50KCk7XG4gICAgdGhpcy5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoKCkgPT4ge1xuICAgICAgdGhpcy5sb2FkRnJhbWVFbGVtZW50KCk7XG4gICAgfSk7XG4gICAgdGhpcy5zY3JvbGxGcmFtZUludG9WaWV3KCk7XG4gICAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICB0aGlzLmZvY3VzRmlyc3RBdXRvZm9jdXNhYmxlRWxlbWVudCgpO1xuICAgIGF3YWl0IG5leHRSZXBhaW50KCk7XG4gICAgdGhpcy5hY3RpdmF0ZVNjcmlwdEVsZW1lbnRzKCk7XG4gIH1cblxuICBsb2FkRnJhbWVFbGVtZW50KCkge1xuICAgIHRoaXMuZGVsZWdhdGUud2lsbFJlbmRlckZyYW1lKHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gICAgdGhpcy5yZW5kZXJFbGVtZW50KHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gIH1cblxuICBzY3JvbGxGcmFtZUludG9WaWV3KCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRFbGVtZW50LmF1dG9zY3JvbGwgfHwgdGhpcy5uZXdFbGVtZW50LmF1dG9zY3JvbGwpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmN1cnJlbnRFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgY29uc3QgYmxvY2sgPSByZWFkU2Nyb2xsTG9naWNhbFBvc2l0aW9uKHRoaXMuY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hdXRvc2Nyb2xsLWJsb2NrXCIpLCBcImVuZFwiKTtcbiAgICAgIGNvbnN0IGJlaGF2aW9yID0gcmVhZFNjcm9sbEJlaGF2aW9yKHRoaXMuY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hdXRvc2Nyb2xsLWJlaGF2aW9yXCIpLCBcImF1dG9cIik7XG5cbiAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoeyBibG9jaywgYmVoYXZpb3IgfSk7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgYWN0aXZhdGVTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiB0aGlzLm5ld1NjcmlwdEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCBhY3RpdmF0ZWRTY3JpcHRFbGVtZW50ID0gYWN0aXZhdGVTY3JpcHRFbGVtZW50KGluZXJ0U2NyaXB0RWxlbWVudCk7XG4gICAgICBpbmVydFNjcmlwdEVsZW1lbnQucmVwbGFjZVdpdGgoYWN0aXZhdGVkU2NyaXB0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IG5ld1NjcmlwdEVsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIilcbiAgfVxufVxuXG5mdW5jdGlvbiByZWFkU2Nyb2xsTG9naWNhbFBvc2l0aW9uKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgaWYgKHZhbHVlID09IFwiZW5kXCIgfHwgdmFsdWUgPT0gXCJzdGFydFwiIHx8IHZhbHVlID09IFwiY2VudGVyXCIgfHwgdmFsdWUgPT0gXCJuZWFyZXN0XCIpIHtcbiAgICByZXR1cm4gdmFsdWVcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlXG4gIH1cbn1cblxuZnVuY3Rpb24gcmVhZFNjcm9sbEJlaGF2aW9yKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgaWYgKHZhbHVlID09IFwiYXV0b1wiIHx8IHZhbHVlID09IFwic21vb3RoXCIpIHtcbiAgICByZXR1cm4gdmFsdWVcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlXG4gIH1cbn1cblxuLy8gYmFzZSBJSUZFIHRvIGRlZmluZSBpZGlvbW9ycGhcbnZhciBJZGlvbW9ycGggPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gQU5EIE5PVyBJVCBCRUdJTlMuLi5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBsZXQgRU1QVFlfU0VUID0gbmV3IFNldCgpO1xuXG4gICAgICAgIC8vIGRlZmF1bHQgY29uZmlndXJhdGlvbiB2YWx1ZXMsIHVwZGF0YWJsZSBieSB1c2VycyBub3dcbiAgICAgICAgbGV0IGRlZmF1bHRzID0ge1xuICAgICAgICAgICAgbW9ycGhTdHlsZTogXCJvdXRlckhUTUxcIixcbiAgICAgICAgICAgIGNhbGxiYWNrcyA6IHtcbiAgICAgICAgICAgICAgICBiZWZvcmVOb2RlQWRkZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYWZ0ZXJOb2RlQWRkZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYmVmb3JlTm9kZU1vcnBoZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYWZ0ZXJOb2RlTW9ycGhlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBiZWZvcmVOb2RlUmVtb3ZlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBhZnRlck5vZGVSZW1vdmVkOiBub09wLFxuICAgICAgICAgICAgICAgIGJlZm9yZUF0dHJpYnV0ZVVwZGF0ZWQ6IG5vT3AsXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoZWFkOiB7XG4gICAgICAgICAgICAgICAgc3R5bGU6ICdtZXJnZScsXG4gICAgICAgICAgICAgICAgc2hvdWxkUHJlc2VydmU6IGZ1bmN0aW9uIChlbHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsdC5nZXRBdHRyaWJ1dGUoXCJpbS1wcmVzZXJ2ZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaG91bGRSZUFwcGVuZDogZnVuY3Rpb24gKGVsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWx0LmdldEF0dHJpYnV0ZShcImltLXJlLWFwcGVuZFwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaG91bGRSZW1vdmU6IG5vT3AsXG4gICAgICAgICAgICAgICAgYWZ0ZXJIZWFkTW9ycGhlZDogbm9PcCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIENvcmUgTW9ycGhpbmcgQWxnb3JpdGhtIC0gbW9ycGgsIG1vcnBoTm9ybWFsaXplZENvbnRlbnQsIG1vcnBoT2xkTm9kZVRvLCBtb3JwaENoaWxkcmVuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gbW9ycGgob2xkTm9kZSwgbmV3Q29udGVudCwgY29uZmlnID0ge30pIHtcblxuICAgICAgICAgICAgaWYgKG9sZE5vZGUgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xuICAgICAgICAgICAgICAgIG9sZE5vZGUgPSBvbGROb2RlLmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQgPSBwYXJzZUNvbnRlbnQobmV3Q29udGVudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBub3JtYWxpemVkQ29udGVudCA9IG5vcm1hbGl6ZUNvbnRlbnQobmV3Q29udGVudCk7XG5cbiAgICAgICAgICAgIGxldCBjdHggPSBjcmVhdGVNb3JwaENvbnRleHQob2xkTm9kZSwgbm9ybWFsaXplZENvbnRlbnQsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIHJldHVybiBtb3JwaE5vcm1hbGl6ZWRDb250ZW50KG9sZE5vZGUsIG5vcm1hbGl6ZWRDb250ZW50LCBjdHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbW9ycGhOb3JtYWxpemVkQ29udGVudChvbGROb2RlLCBub3JtYWxpemVkTmV3Q29udGVudCwgY3R4KSB7XG4gICAgICAgICAgICBpZiAoY3R4LmhlYWQuYmxvY2spIHtcbiAgICAgICAgICAgICAgICBsZXQgb2xkSGVhZCA9IG9sZE5vZGUucXVlcnlTZWxlY3RvcignaGVhZCcpO1xuICAgICAgICAgICAgICAgIGxldCBuZXdIZWFkID0gbm9ybWFsaXplZE5ld0NvbnRlbnQucXVlcnlTZWxlY3RvcignaGVhZCcpO1xuICAgICAgICAgICAgICAgIGlmIChvbGRIZWFkICYmIG5ld0hlYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHByb21pc2VzID0gaGFuZGxlSGVhZEVsZW1lbnQobmV3SGVhZCwgb2xkSGVhZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiBoZWFkIHByb21pc2VzIHJlc29sdmUsIGNhbGwgbW9ycGggYWdhaW4sIGlnbm9yaW5nIHRoZSBoZWFkIHRhZ1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3JwaE5vcm1hbGl6ZWRDb250ZW50KG9sZE5vZGUsIG5vcm1hbGl6ZWROZXdDb250ZW50LCBPYmplY3QuYXNzaWduKGN0eCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3R4Lm1vcnBoU3R5bGUgPT09IFwiaW5uZXJIVE1MXCIpIHtcblxuICAgICAgICAgICAgICAgIC8vIGlubmVySFRNTCwgc28gd2UgYXJlIG9ubHkgdXBkYXRpbmcgdGhlIGNoaWxkcmVuXG4gICAgICAgICAgICAgICAgbW9ycGhDaGlsZHJlbihub3JtYWxpemVkTmV3Q29udGVudCwgb2xkTm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2xkTm9kZS5jaGlsZHJlbjtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChjdHgubW9ycGhTdHlsZSA9PT0gXCJvdXRlckhUTUxcIiB8fCBjdHgubW9ycGhTdHlsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGZpbmQgdGhlIGJlc3QgZWxlbWVudCBtYXRjaCBpbiB0aGUgbmV3IGNvbnRlbnQsIG1vcnBoIHRoYXQsIGFuZCBtZXJnZSBpdHMgc2libGluZ3NcbiAgICAgICAgICAgICAgICAvLyBpbnRvIGVpdGhlciBzaWRlIG9mIHRoZSBiZXN0IG1hdGNoXG4gICAgICAgICAgICAgICAgbGV0IGJlc3RNYXRjaCA9IGZpbmRCZXN0Tm9kZU1hdGNoKG5vcm1hbGl6ZWROZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgLy8gc3Rhc2ggdGhlIHNpYmxpbmdzIHRoYXQgd2lsbCBuZWVkIHRvIGJlIGluc2VydGVkIG9uIGVpdGhlciBzaWRlIG9mIHRoZSBiZXN0IG1hdGNoXG4gICAgICAgICAgICAgICAgbGV0IHByZXZpb3VzU2libGluZyA9IGJlc3RNYXRjaD8ucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgICAgIGxldCBuZXh0U2libGluZyA9IGJlc3RNYXRjaD8ubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICAvLyBtb3JwaCBpdFxuICAgICAgICAgICAgICAgIGxldCBtb3JwaGVkTm9kZSA9IG1vcnBoT2xkTm9kZVRvKG9sZE5vZGUsIGJlc3RNYXRjaCwgY3R4KTtcblxuICAgICAgICAgICAgICAgIGlmIChiZXN0TWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUgd2FzIGEgYmVzdCBtYXRjaCwgbWVyZ2UgdGhlIHNpYmxpbmdzIGluIHRvbyBhbmQgcmV0dXJuIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyB3aG9sZSBidW5jaFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0U2libGluZ3MocHJldmlvdXNTaWJsaW5nLCBtb3JwaGVkTm9kZSwgbmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBub3RoaW5nIHdhcyBhZGRlZCB0byB0aGUgRE9NXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgXCJEbyBub3QgdW5kZXJzdGFuZCBob3cgdG8gbW9ycGggc3R5bGUgXCIgKyBjdHgubW9ycGhTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSBwb3NzaWJsZUFjdGl2ZUVsZW1lbnRcbiAgICAgICAgICogQHBhcmFtIGN0eFxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGlnbm9yZVZhbHVlT2ZBY3RpdmVFbGVtZW50KHBvc3NpYmxlQWN0aXZlRWxlbWVudCwgY3R4KSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmlnbm9yZUFjdGl2ZVZhbHVlICYmIHBvc3NpYmxlQWN0aXZlRWxlbWVudCA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBwb3NzaWJsZUFjdGl2ZUVsZW1lbnQgIT09IGRvY3VtZW50LmJvZHk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIG9sZE5vZGUgcm9vdCBub2RlIHRvIG1lcmdlIGNvbnRlbnQgaW50b1xuICAgICAgICAgKiBAcGFyYW0gbmV3Q29udGVudCBuZXcgY29udGVudCB0byBtZXJnZVxuICAgICAgICAgKiBAcGFyYW0gY3R4IHRoZSBtZXJnZSBjb250ZXh0XG4gICAgICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSB0aGUgZWxlbWVudCB0aGF0IGVuZGVkIHVwIGluIHRoZSBET01cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1vcnBoT2xkTm9kZVRvKG9sZE5vZGUsIG5ld0NvbnRlbnQsIGN0eCkge1xuICAgICAgICAgICAgaWYgKGN0eC5pZ25vcmVBY3RpdmUgJiYgb2xkTm9kZSA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkgOyBlbHNlIGlmIChuZXdDb250ZW50ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlUmVtb3ZlZChvbGROb2RlKSA9PT0gZmFsc2UpIHJldHVybiBvbGROb2RlO1xuXG4gICAgICAgICAgICAgICAgb2xkTm9kZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBjdHguY2FsbGJhY2tzLmFmdGVyTm9kZVJlbW92ZWQob2xkTm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFpc1NvZnRNYXRjaChvbGROb2RlLCBuZXdDb250ZW50KSkge1xuICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVSZW1vdmVkKG9sZE5vZGUpID09PSBmYWxzZSkgcmV0dXJuIG9sZE5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZUFkZGVkKG5ld0NvbnRlbnQpID09PSBmYWxzZSkgcmV0dXJuIG9sZE5vZGU7XG5cbiAgICAgICAgICAgICAgICBvbGROb2RlLnBhcmVudEVsZW1lbnQucmVwbGFjZUNoaWxkKG5ld0NvbnRlbnQsIG9sZE5vZGUpO1xuICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVSZW1vdmVkKG9sZE5vZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdDb250ZW50O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlTW9ycGhlZChvbGROb2RlLCBuZXdDb250ZW50KSA9PT0gZmFsc2UpIHJldHVybiBvbGROb2RlO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9sZE5vZGUgaW5zdGFuY2VvZiBIVE1MSGVhZEVsZW1lbnQgJiYgY3R4LmhlYWQuaWdub3JlKSA7IGVsc2UgaWYgKG9sZE5vZGUgaW5zdGFuY2VvZiBIVE1MSGVhZEVsZW1lbnQgJiYgY3R4LmhlYWQuc3R5bGUgIT09IFwibW9ycGhcIikge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVIZWFkRWxlbWVudChuZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN5bmNOb2RlRnJvbShuZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZVZhbHVlT2ZBY3RpdmVFbGVtZW50KG9sZE5vZGUsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vcnBoQ2hpbGRyZW4obmV3Q29udGVudCwgb2xkTm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdHguY2FsbGJhY2tzLmFmdGVyTm9kZU1vcnBoZWQob2xkTm9kZSwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9sZE5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBpcyB0aGUgY29yZSBhbGdvcml0aG0gZm9yIG1hdGNoaW5nIHVwIGNoaWxkcmVuLiAgVGhlIGlkZWEgaXMgdG8gdXNlIGlkIHNldHMgdG8gdHJ5IHRvIG1hdGNoIHVwXG4gICAgICAgICAqIG5vZGVzIGFzIGZhaXRoZnVsbHkgYXMgcG9zc2libGUuICBXZSBncmVlZGlseSBtYXRjaCwgd2hpY2ggYWxsb3dzIHVzIHRvIGtlZXAgdGhlIGFsZ29yaXRobSBmYXN0LCBidXRcbiAgICAgICAgICogYnkgdXNpbmcgaWQgc2V0cywgd2UgYXJlIGFibGUgdG8gYmV0dGVyIG1hdGNoIHVwIHdpdGggY29udGVudCBkZWVwZXIgaW4gdGhlIERPTS5cbiAgICAgICAgICpcbiAgICAgICAgICogQmFzaWMgYWxnb3JpdGhtIGlzLCBmb3IgZWFjaCBub2RlIGluIHRoZSBuZXcgY29udGVudDpcbiAgICAgICAgICpcbiAgICAgICAgICogLSBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgb2xkIHBhcmVudCwgYXBwZW5kIHRoZSBuZXcgY29udGVudFxuICAgICAgICAgKiAtIGlmIHRoZSBuZXcgY29udGVudCBoYXMgYW4gaWQgc2V0IG1hdGNoIHdpdGggdGhlIGN1cnJlbnQgaW5zZXJ0aW9uIHBvaW50LCBtb3JwaFxuICAgICAgICAgKiAtIHNlYXJjaCBmb3IgYW4gaWQgc2V0IG1hdGNoXG4gICAgICAgICAqIC0gaWYgaWQgc2V0IG1hdGNoIGZvdW5kLCBtb3JwaFxuICAgICAgICAgKiAtIG90aGVyd2lzZSBzZWFyY2ggZm9yIGEgXCJzb2Z0XCIgbWF0Y2hcbiAgICAgICAgICogLSBpZiBhIHNvZnQgbWF0Y2ggaXMgZm91bmQsIG1vcnBoXG4gICAgICAgICAqIC0gb3RoZXJ3aXNlLCBwcmVwZW5kIHRoZSBuZXcgbm9kZSBiZWZvcmUgdGhlIGN1cnJlbnQgaW5zZXJ0aW9uIHBvaW50XG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSB0d28gc2VhcmNoIGFsZ29yaXRobXMgdGVybWluYXRlIGlmIGNvbXBldGluZyBub2RlIG1hdGNoZXMgYXBwZWFyIHRvIG91dHdlaWdoIHdoYXQgY2FuIGJlIGFjaGlldmVkXG4gICAgICAgICAqIHdpdGggdGhlIGN1cnJlbnQgbm9kZS4gIFNlZSBmaW5kSWRTZXRNYXRjaCgpIGFuZCBmaW5kU29mdE1hdGNoKCkgZm9yIGRldGFpbHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gbmV3UGFyZW50IHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgbmV3IGNvbnRlbnRcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50IH0gb2xkUGFyZW50IHRoZSBvbGQgY29udGVudCB0aGF0IHdlIGFyZSBtZXJnaW5nIHRoZSBuZXcgY29udGVudCBpbnRvXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1vcnBoQ2hpbGRyZW4obmV3UGFyZW50LCBvbGRQYXJlbnQsIGN0eCkge1xuXG4gICAgICAgICAgICBsZXQgbmV4dE5ld0NoaWxkID0gbmV3UGFyZW50LmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICBsZXQgaW5zZXJ0aW9uUG9pbnQgPSBvbGRQYXJlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIGxldCBuZXdDaGlsZDtcblxuICAgICAgICAgICAgLy8gcnVuIHRocm91Z2ggYWxsIHRoZSBuZXcgY29udGVudFxuICAgICAgICAgICAgd2hpbGUgKG5leHROZXdDaGlsZCkge1xuXG4gICAgICAgICAgICAgICAgbmV3Q2hpbGQgPSBuZXh0TmV3Q2hpbGQ7XG4gICAgICAgICAgICAgICAgbmV4dE5ld0NoaWxkID0gbmV3Q2hpbGQubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBhcmUgYXQgdGhlIGVuZCBvZiB0aGUgZXhpdGluZyBwYXJlbnQncyBjaGlsZHJlbiwganVzdCBhcHBlbmRcbiAgICAgICAgICAgICAgICBpZiAoaW5zZXJ0aW9uUG9pbnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlQWRkZWQobmV3Q2hpbGQpID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIG9sZFBhcmVudC5hcHBlbmRDaGlsZChuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVJZHNGcm9tQ29uc2lkZXJhdGlvbihjdHgsIG5ld0NoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGN1cnJlbnQgbm9kZSBoYXMgYW4gaWQgc2V0IG1hdGNoIHRoZW4gbW9ycGhcbiAgICAgICAgICAgICAgICBpZiAoaXNJZFNldE1hdGNoKG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCwgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICBtb3JwaE9sZE5vZGVUbyhpbnNlcnRpb25Qb2ludCwgbmV3Q2hpbGQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydGlvblBvaW50ID0gaW5zZXJ0aW9uUG9pbnQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2Ugc2VhcmNoIGZvcndhcmQgaW4gdGhlIGV4aXN0aW5nIG9sZCBjaGlsZHJlbiBmb3IgYW4gaWQgc2V0IG1hdGNoXG4gICAgICAgICAgICAgICAgbGV0IGlkU2V0TWF0Y2ggPSBmaW5kSWRTZXRNYXRjaChuZXdQYXJlbnQsIG9sZFBhcmVudCwgbmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgZm91bmQgYSBwb3RlbnRpYWwgbWF0Y2gsIHJlbW92ZSB0aGUgbm9kZXMgdW50aWwgdGhhdCBwb2ludCBhbmQgbW9ycGhcbiAgICAgICAgICAgICAgICBpZiAoaWRTZXRNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRpb25Qb2ludCA9IHJlbW92ZU5vZGVzQmV0d2VlbihpbnNlcnRpb25Qb2ludCwgaWRTZXRNYXRjaCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgbW9ycGhPbGROb2RlVG8oaWRTZXRNYXRjaCwgbmV3Q2hpbGQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBubyBpZCBzZXQgbWF0Y2ggZm91bmQsIHNvIHNjYW4gZm9yd2FyZCBmb3IgYSBzb2Z0IG1hdGNoIGZvciB0aGUgY3VycmVudCBub2RlXG4gICAgICAgICAgICAgICAgbGV0IHNvZnRNYXRjaCA9IGZpbmRTb2Z0TWF0Y2gobmV3UGFyZW50LCBvbGRQYXJlbnQsIG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCwgY3R4KTtcblxuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGZvdW5kIGEgc29mdCBtYXRjaCBmb3IgdGhlIGN1cnJlbnQgbm9kZSwgbW9ycGhcbiAgICAgICAgICAgICAgICBpZiAoc29mdE1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydGlvblBvaW50ID0gcmVtb3ZlTm9kZXNCZXR3ZWVuKGluc2VydGlvblBvaW50LCBzb2Z0TWF0Y2gsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIG1vcnBoT2xkTm9kZVRvKHNvZnRNYXRjaCwgbmV3Q2hpbGQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBhYmFuZG9uIGFsbCBob3BlIG9mIG1vcnBoaW5nLCBqdXN0IGluc2VydCB0aGUgbmV3IGNoaWxkIGJlZm9yZSB0aGUgaW5zZXJ0aW9uIHBvaW50XG4gICAgICAgICAgICAgICAgLy8gYW5kIG1vdmUgb25cbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlQWRkZWQobmV3Q2hpbGQpID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgb2xkUGFyZW50Lmluc2VydEJlZm9yZShuZXdDaGlsZCwgaW5zZXJ0aW9uUG9pbnQpO1xuICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZW1vdmUgYW55IHJlbWFpbmluZyBvbGQgbm9kZXMgdGhhdCBkaWRuJ3QgbWF0Y2ggdXAgd2l0aCBuZXcgY29udGVudFxuICAgICAgICAgICAgd2hpbGUgKGluc2VydGlvblBvaW50ICE9PSBudWxsKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgdGVtcE5vZGUgPSBpbnNlcnRpb25Qb2ludDtcbiAgICAgICAgICAgICAgICBpbnNlcnRpb25Qb2ludCA9IGluc2VydGlvblBvaW50Lm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIHJlbW92ZU5vZGUodGVtcE5vZGUsIGN0eCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEF0dHJpYnV0ZSBTeW5jaW5nIENvZGVcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gYXR0ciB7U3RyaW5nfSB0aGUgYXR0cmlidXRlIHRvIGJlIG11dGF0ZWRcbiAgICAgICAgICogQHBhcmFtIHRvIHtFbGVtZW50fSB0aGUgZWxlbWVudCB0aGF0IGlzIGdvaW5nIHRvIGJlIHVwZGF0ZWRcbiAgICAgICAgICogQHBhcmFtIHVwZGF0ZVR5cGUgeyhcInVwZGF0ZVwifFwicmVtb3ZlXCIpfVxuICAgICAgICAgKiBAcGFyYW0gY3R4IHRoZSBtZXJnZSBjb250ZXh0XG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIHRoZSBhdHRyaWJ1dGUgc2hvdWxkIGJlIGlnbm9yZWQsIGZhbHNlIG90aGVyd2lzZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gaWdub3JlQXR0cmlidXRlKGF0dHIsIHRvLCB1cGRhdGVUeXBlLCBjdHgpIHtcbiAgICAgICAgICAgIGlmKGF0dHIgPT09ICd2YWx1ZScgJiYgY3R4Lmlnbm9yZUFjdGl2ZVZhbHVlICYmIHRvID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjdHguY2FsbGJhY2tzLmJlZm9yZUF0dHJpYnV0ZVVwZGF0ZWQoYXR0ciwgdG8sIHVwZGF0ZVR5cGUpID09PSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzeW5jcyBhIGdpdmVuIG5vZGUgd2l0aCBhbm90aGVyIG5vZGUsIGNvcHlpbmcgb3ZlciBhbGwgYXR0cmlidXRlcyBhbmRcbiAgICAgICAgICogaW5uZXIgZWxlbWVudCBzdGF0ZSBmcm9tIHRoZSAnZnJvbScgbm9kZSB0byB0aGUgJ3RvJyBub2RlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZnJvbSB0aGUgZWxlbWVudCB0byBjb3B5IGF0dHJpYnV0ZXMgJiBzdGF0ZSBmcm9tXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdG8gdGhlIGVsZW1lbnQgdG8gY29weSBhdHRyaWJ1dGVzICYgc3RhdGUgdG9cbiAgICAgICAgICogQHBhcmFtIGN0eCB0aGUgbWVyZ2UgY29udGV4dFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc3luY05vZGVGcm9tKGZyb20sIHRvLCBjdHgpIHtcbiAgICAgICAgICAgIGxldCB0eXBlID0gZnJvbS5ub2RlVHlwZTtcblxuICAgICAgICAgICAgLy8gaWYgaXMgYW4gZWxlbWVudCB0eXBlLCBzeW5jIHRoZSBhdHRyaWJ1dGVzIGZyb20gdGhlXG4gICAgICAgICAgICAvLyBuZXcgbm9kZSBpbnRvIHRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IDEgLyogZWxlbWVudCB0eXBlICovKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZnJvbUF0dHJpYnV0ZXMgPSBmcm9tLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9BdHRyaWJ1dGVzID0gdG8uYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZyb21BdHRyaWJ1dGUgb2YgZnJvbUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlnbm9yZUF0dHJpYnV0ZShmcm9tQXR0cmlidXRlLm5hbWUsIHRvLCAndXBkYXRlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvLmdldEF0dHJpYnV0ZShmcm9tQXR0cmlidXRlLm5hbWUpICE9PSBmcm9tQXR0cmlidXRlLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRBdHRyaWJ1dGUoZnJvbUF0dHJpYnV0ZS5uYW1lLCBmcm9tQXR0cmlidXRlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpdGVyYXRlIGJhY2t3YXJkcyB0byBhdm9pZCBza2lwcGluZyBvdmVyIGl0ZW1zIHdoZW4gYSBkZWxldGUgb2NjdXJzXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHRvQXR0cmlidXRlcy5sZW5ndGggLSAxOyAwIDw9IGk7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0b0F0dHJpYnV0ZSA9IHRvQXR0cmlidXRlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlnbm9yZUF0dHJpYnV0ZSh0b0F0dHJpYnV0ZS5uYW1lLCB0bywgJ3JlbW92ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghZnJvbS5oYXNBdHRyaWJ1dGUodG9BdHRyaWJ1dGUubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnJlbW92ZUF0dHJpYnV0ZSh0b0F0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc3luYyB0ZXh0IG5vZGVzXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gOCAvKiBjb21tZW50ICovIHx8IHR5cGUgPT09IDMgLyogdGV4dCAqLykge1xuICAgICAgICAgICAgICAgIGlmICh0by5ub2RlVmFsdWUgIT09IGZyb20ubm9kZVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvLm5vZGVWYWx1ZSA9IGZyb20ubm9kZVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFpZ25vcmVWYWx1ZU9mQWN0aXZlRWxlbWVudCh0bywgY3R4KSkge1xuICAgICAgICAgICAgICAgIC8vIHN5bmMgaW5wdXQgdmFsdWVzXG4gICAgICAgICAgICAgICAgc3luY0lucHV0VmFsdWUoZnJvbSwgdG8sIGN0eCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIGZyb20ge0VsZW1lbnR9IGVsZW1lbnQgdG8gc3luYyB0aGUgdmFsdWUgZnJvbVxuICAgICAgICAgKiBAcGFyYW0gdG8ge0VsZW1lbnR9IGVsZW1lbnQgdG8gc3luYyB0aGUgdmFsdWUgdG9cbiAgICAgICAgICogQHBhcmFtIGF0dHJpYnV0ZU5hbWUge1N0cmluZ30gdGhlIGF0dHJpYnV0ZSBuYW1lXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCBhdHRyaWJ1dGVOYW1lLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChmcm9tW2F0dHJpYnV0ZU5hbWVdICE9PSB0b1thdHRyaWJ1dGVOYW1lXSkge1xuICAgICAgICAgICAgICAgIGxldCBpZ25vcmVVcGRhdGUgPSBpZ25vcmVBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgdG8sICd1cGRhdGUnLCBjdHgpO1xuICAgICAgICAgICAgICAgIGlmICghaWdub3JlVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvW2F0dHJpYnV0ZU5hbWVdID0gZnJvbVthdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZyb21bYXR0cmlidXRlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpZ25vcmVVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCBmcm9tW2F0dHJpYnV0ZU5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaWdub3JlQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIHRvLCAncmVtb3ZlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8ucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE5COiBtYW55IGJvdGhhbnMgZGllZCB0byBicmluZyB1cyBpbmZvcm1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogIGh0dHBzOi8vZ2l0aHViLmNvbS9wYXRyaWNrLXN0ZWVsZS1pZGVtL21vcnBoZG9tL2Jsb2IvbWFzdGVyL3NyYy9zcGVjaWFsRWxIYW5kbGVycy5qc1xuICAgICAgICAgKiAgaHR0cHM6Ly9naXRodWIuY29tL2Nob29qcy9uYW5vbW9ycGgvYmxvYi9tYXN0ZXIvbGliL21vcnBoLmpzTDExM1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gZnJvbSB7RWxlbWVudH0gdGhlIGVsZW1lbnQgdG8gc3luYyB0aGUgaW5wdXQgdmFsdWUgZnJvbVxuICAgICAgICAgKiBAcGFyYW0gdG8ge0VsZW1lbnR9IHRoZSBlbGVtZW50IHRvIHN5bmMgdGhlIGlucHV0IHZhbHVlIHRvXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN5bmNJbnB1dFZhbHVlKGZyb20sIHRvLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChmcm9tIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJlxuICAgICAgICAgICAgICAgIHRvIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJlxuICAgICAgICAgICAgICAgIGZyb20udHlwZSAhPT0gJ2ZpbGUnKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgZnJvbVZhbHVlID0gZnJvbS52YWx1ZTtcbiAgICAgICAgICAgICAgICBsZXQgdG9WYWx1ZSA9IHRvLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgLy8gc3luYyBib29sZWFuIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICBzeW5jQm9vbGVhbkF0dHJpYnV0ZShmcm9tLCB0bywgJ2NoZWNrZWQnLCBjdHgpO1xuICAgICAgICAgICAgICAgIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCAnZGlzYWJsZWQnLCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFmcm9tLmhhc0F0dHJpYnV0ZSgndmFsdWUnKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZUF0dHJpYnV0ZSgndmFsdWUnLCB0bywgJ3JlbW92ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0by5yZW1vdmVBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZyb21WYWx1ZSAhPT0gdG9WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZUF0dHJpYnV0ZSgndmFsdWUnLCB0bywgJ3VwZGF0ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8udmFsdWUgPSBmcm9tVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZyb20gaW5zdGFuY2VvZiBIVE1MT3B0aW9uRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCAnc2VsZWN0ZWQnLCBjdHgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmcm9tIGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudCAmJiB0byBpbnN0YW5jZW9mIEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBsZXQgZnJvbVZhbHVlID0gZnJvbS52YWx1ZTtcbiAgICAgICAgICAgICAgICBsZXQgdG9WYWx1ZSA9IHRvLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChpZ25vcmVBdHRyaWJ1dGUoJ3ZhbHVlJywgdG8sICd1cGRhdGUnLCBjdHgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZyb21WYWx1ZSAhPT0gdG9WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0by52YWx1ZSA9IGZyb21WYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRvLmZpcnN0Q2hpbGQgJiYgdG8uZmlyc3RDaGlsZC5ub2RlVmFsdWUgIT09IGZyb21WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0by5maXJzdENoaWxkLm5vZGVWYWx1ZSA9IGZyb21WYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIHRoZSBIRUFEIHRhZyBjYW4gYmUgaGFuZGxlZCBzcGVjaWFsbHksIGVpdGhlciB3LyBhICdtZXJnZScgb3IgJ2FwcGVuZCcgc3R5bGVcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVIZWFkRWxlbWVudChuZXdIZWFkVGFnLCBjdXJyZW50SGVhZCwgY3R4KSB7XG5cbiAgICAgICAgICAgIGxldCBhZGRlZCA9IFtdO1xuICAgICAgICAgICAgbGV0IHJlbW92ZWQgPSBbXTtcbiAgICAgICAgICAgIGxldCBwcmVzZXJ2ZWQgPSBbXTtcbiAgICAgICAgICAgIGxldCBub2Rlc1RvQXBwZW5kID0gW107XG5cbiAgICAgICAgICAgIGxldCBoZWFkTWVyZ2VTdHlsZSA9IGN0eC5oZWFkLnN0eWxlO1xuXG4gICAgICAgICAgICAvLyBwdXQgYWxsIG5ldyBoZWFkIGVsZW1lbnRzIGludG8gYSBNYXAsIGJ5IHRoZWlyIG91dGVySFRNTFxuICAgICAgICAgICAgbGV0IHNyY1RvTmV3SGVhZE5vZGVzID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuZXdIZWFkQ2hpbGQgb2YgbmV3SGVhZFRhZy5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIHNyY1RvTmV3SGVhZE5vZGVzLnNldChuZXdIZWFkQ2hpbGQub3V0ZXJIVE1MLCBuZXdIZWFkQ2hpbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBmb3IgZWFjaCBlbHQgaW4gdGhlIGN1cnJlbnQgaGVhZFxuICAgICAgICAgICAgZm9yIChjb25zdCBjdXJyZW50SGVhZEVsdCBvZiBjdXJyZW50SGVhZC5jaGlsZHJlbikge1xuXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgaGVhZCBlbGVtZW50IGlzIGluIHRoZSBtYXBcbiAgICAgICAgICAgICAgICBsZXQgaW5OZXdDb250ZW50ID0gc3JjVG9OZXdIZWFkTm9kZXMuaGFzKGN1cnJlbnRIZWFkRWx0Lm91dGVySFRNTCk7XG4gICAgICAgICAgICAgICAgbGV0IGlzUmVBcHBlbmRlZCA9IGN0eC5oZWFkLnNob3VsZFJlQXBwZW5kKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICBsZXQgaXNQcmVzZXJ2ZWQgPSBjdHguaGVhZC5zaG91bGRQcmVzZXJ2ZShjdXJyZW50SGVhZEVsdCk7XG4gICAgICAgICAgICAgICAgaWYgKGluTmV3Q29udGVudCB8fCBpc1ByZXNlcnZlZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNSZUFwcGVuZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIGN1cnJlbnQgdmVyc2lvbiBhbmQgbGV0IHRoZSBuZXcgdmVyc2lvbiByZXBsYWNlIGl0IGFuZCByZS1leGVjdXRlXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkLnB1c2goY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbGVtZW50IGFscmVhZHkgZXhpc3RzIGFuZCBzaG91bGQgbm90IGJlIHJlLWFwcGVuZGVkLCBzbyByZW1vdmUgaXQgZnJvbVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG5ldyBjb250ZW50IG1hcCwgcHJlc2VydmluZyBpdCBpbiB0aGUgRE9NXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmNUb05ld0hlYWROb2Rlcy5kZWxldGUoY3VycmVudEhlYWRFbHQub3V0ZXJIVE1MKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXNlcnZlZC5wdXNoKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoZWFkTWVyZ2VTdHlsZSA9PT0gXCJhcHBlbmRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgYXJlIGFwcGVuZGluZyBhbmQgdGhpcyBleGlzdGluZyBlbGVtZW50IGlzIG5vdCBuZXcgY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gaWYgYW5kIG9ubHkgaWYgaXQgaXMgbWFya2VkIGZvciByZS1hcHBlbmQgZG8gd2UgZG8gYW55dGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1JlQXBwZW5kZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkLnB1c2goY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9BcHBlbmQucHVzaChjdXJyZW50SGVhZEVsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgbWVyZ2UsIHdlIHJlbW92ZSB0aGlzIGNvbnRlbnQgc2luY2UgaXQgaXMgbm90IGluIHRoZSBuZXcgaGVhZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC5oZWFkLnNob3VsZFJlbW92ZShjdXJyZW50SGVhZEVsdCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHVzaCB0aGUgcmVtYWluaW5nIG5ldyBoZWFkIGVsZW1lbnRzIGluIHRoZSBNYXAgaW50byB0aGVcbiAgICAgICAgICAgIC8vIG5vZGVzIHRvIGFwcGVuZCB0byB0aGUgaGVhZCB0YWdcbiAgICAgICAgICAgIG5vZGVzVG9BcHBlbmQucHVzaCguLi5zcmNUb05ld0hlYWROb2Rlcy52YWx1ZXMoKSk7XG5cbiAgICAgICAgICAgIGxldCBwcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuZXdOb2RlIG9mIG5vZGVzVG9BcHBlbmQpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3RWx0ID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQobmV3Tm9kZS5vdXRlckhUTUwpLmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZUFkZGVkKG5ld0VsdCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdFbHQuaHJlZiB8fCBuZXdFbHQuc3JjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzb2x2ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChfcmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUgPSBfcmVzb2x2ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RWx0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHByb21pc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRIZWFkLmFwcGVuZENoaWxkKG5ld0VsdCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3RWx0KTtcbiAgICAgICAgICAgICAgICAgICAgYWRkZWQucHVzaChuZXdFbHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCByZW1vdmVkIGVsZW1lbnRzLCBhZnRlciB3ZSBoYXZlIGFwcGVuZGVkIHRoZSBuZXcgZWxlbWVudHMgdG8gYXZvaWRcbiAgICAgICAgICAgIC8vIGFkZGl0aW9uYWwgbmV0d29yayByZXF1ZXN0cyBmb3IgdGhpbmdzIGxpa2Ugc3R5bGUgc2hlZXRzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlbW92ZWRFbGVtZW50IG9mIHJlbW92ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlUmVtb3ZlZChyZW1vdmVkRWxlbWVudCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRIZWFkLnJlbW92ZUNoaWxkKHJlbW92ZWRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVSZW1vdmVkKHJlbW92ZWRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGN0eC5oZWFkLmFmdGVySGVhZE1vcnBoZWQoY3VycmVudEhlYWQsIHthZGRlZDogYWRkZWQsIGtlcHQ6IHByZXNlcnZlZCwgcmVtb3ZlZDogcmVtb3ZlZH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbm9PcCgpIHtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAgRGVlcCBtZXJnZXMgdGhlIGNvbmZpZyBvYmplY3QgYW5kIHRoZSBJZGlvbW9yb3BoLmRlZmF1bHRzIG9iamVjdCB0b1xuICAgICAgICAgIHByb2R1Y2UgYSBmaW5hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWVyZ2VEZWZhdWx0cyhjb25maWcpIHtcbiAgICAgICAgICAgIGxldCBmaW5hbENvbmZpZyA9IHt9O1xuICAgICAgICAgICAgLy8gY29weSB0b3AgbGV2ZWwgc3R1ZmYgaW50byBmaW5hbCBjb25maWdcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmluYWxDb25maWcsIGRlZmF1bHRzKTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmluYWxDb25maWcsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIC8vIGNvcHkgY2FsbGJhY2tzIGludG8gZmluYWwgY29uZmlnIChkbyB0aGlzIHRvIGRlZXAgbWVyZ2UgdGhlIGNhbGxiYWNrcylcbiAgICAgICAgICAgIGZpbmFsQ29uZmlnLmNhbGxiYWNrcyA9IHt9O1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihmaW5hbENvbmZpZy5jYWxsYmFja3MsIGRlZmF1bHRzLmNhbGxiYWNrcyk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGZpbmFsQ29uZmlnLmNhbGxiYWNrcywgY29uZmlnLmNhbGxiYWNrcyk7XG5cbiAgICAgICAgICAgIC8vIGNvcHkgaGVhZCBjb25maWcgaW50byBmaW5hbCBjb25maWcgIChkbyB0aGlzIHRvIGRlZXAgbWVyZ2UgdGhlIGhlYWQpXG4gICAgICAgICAgICBmaW5hbENvbmZpZy5oZWFkID0ge307XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGZpbmFsQ29uZmlnLmhlYWQsIGRlZmF1bHRzLmhlYWQpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihmaW5hbENvbmZpZy5oZWFkLCBjb25maWcuaGVhZCk7XG4gICAgICAgICAgICByZXR1cm4gZmluYWxDb25maWc7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVNb3JwaENvbnRleHQob2xkTm9kZSwgbmV3Q29udGVudCwgY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcgPSBtZXJnZURlZmF1bHRzKGNvbmZpZyk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRhcmdldDogb2xkTm9kZSxcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50OiBuZXdDb250ZW50LFxuICAgICAgICAgICAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgICAgICAgICAgIG1vcnBoU3R5bGU6IGNvbmZpZy5tb3JwaFN0eWxlLFxuICAgICAgICAgICAgICAgIGlnbm9yZUFjdGl2ZTogY29uZmlnLmlnbm9yZUFjdGl2ZSxcbiAgICAgICAgICAgICAgICBpZ25vcmVBY3RpdmVWYWx1ZTogY29uZmlnLmlnbm9yZUFjdGl2ZVZhbHVlLFxuICAgICAgICAgICAgICAgIGlkTWFwOiBjcmVhdGVJZE1hcChvbGROb2RlLCBuZXdDb250ZW50KSxcbiAgICAgICAgICAgICAgICBkZWFkSWRzOiBuZXcgU2V0KCksXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzOiBjb25maWcuY2FsbGJhY2tzLFxuICAgICAgICAgICAgICAgIGhlYWQ6IGNvbmZpZy5oZWFkXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpc0lkU2V0TWF0Y2gobm9kZTEsIG5vZGUyLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChub2RlMSA9PSBudWxsIHx8IG5vZGUyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZTEubm9kZVR5cGUgPT09IG5vZGUyLm5vZGVUeXBlICYmIG5vZGUxLnRhZ05hbWUgPT09IG5vZGUyLnRhZ05hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZTEuaWQgIT09IFwiXCIgJiYgbm9kZTEuaWQgPT09IG5vZGUyLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJZEludGVyc2VjdGlvbkNvdW50KGN0eCwgbm9kZTEsIG5vZGUyKSA+IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNTb2Z0TWF0Y2gobm9kZTEsIG5vZGUyKSB7XG4gICAgICAgICAgICBpZiAobm9kZTEgPT0gbnVsbCB8fCBub2RlMiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vZGUxLm5vZGVUeXBlID09PSBub2RlMi5ub2RlVHlwZSAmJiBub2RlMS50YWdOYW1lID09PSBub2RlMi50YWdOYW1lXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVOb2Rlc0JldHdlZW4oc3RhcnRJbmNsdXNpdmUsIGVuZEV4Y2x1c2l2ZSwgY3R4KSB7XG4gICAgICAgICAgICB3aGlsZSAoc3RhcnRJbmNsdXNpdmUgIT09IGVuZEV4Y2x1c2l2ZSkge1xuICAgICAgICAgICAgICAgIGxldCB0ZW1wTm9kZSA9IHN0YXJ0SW5jbHVzaXZlO1xuICAgICAgICAgICAgICAgIHN0YXJ0SW5jbHVzaXZlID0gc3RhcnRJbmNsdXNpdmUubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgcmVtb3ZlTm9kZSh0ZW1wTm9kZSwgY3R4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgZW5kRXhjbHVzaXZlKTtcbiAgICAgICAgICAgIHJldHVybiBlbmRFeGNsdXNpdmUubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFNjYW5zIGZvcndhcmQgZnJvbSB0aGUgaW5zZXJ0aW9uUG9pbnQgaW4gdGhlIG9sZCBwYXJlbnQgbG9va2luZyBmb3IgYSBwb3RlbnRpYWwgaWQgbWF0Y2hcbiAgICAgICAgLy8gZm9yIHRoZSBuZXdDaGlsZC4gIFdlIHN0b3AgaWYgd2UgZmluZCBhIHBvdGVudGlhbCBpZCBtYXRjaCBmb3IgdGhlIG5ldyBjaGlsZCBPUlxuICAgICAgICAvLyBpZiB0aGUgbnVtYmVyIG9mIHBvdGVudGlhbCBpZCBtYXRjaGVzIHdlIGFyZSBkaXNjYXJkaW5nIGlzIGdyZWF0ZXIgdGhhbiB0aGVcbiAgICAgICAgLy8gcG90ZW50aWFsIGlkIG1hdGNoZXMgZm9yIHRoZSBuZXcgY2hpbGRcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBmaW5kSWRTZXRNYXRjaChuZXdDb250ZW50LCBvbGRQYXJlbnQsIG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCwgY3R4KSB7XG5cbiAgICAgICAgICAgIC8vIG1heCBpZCBtYXRjaGVzIHdlIGFyZSB3aWxsaW5nIHRvIGRpc2NhcmQgaW4gb3VyIHNlYXJjaFxuICAgICAgICAgICAgbGV0IG5ld0NoaWxkUG90ZW50aWFsSWRDb3VudCA9IGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBuZXdDaGlsZCwgb2xkUGFyZW50KTtcblxuICAgICAgICAgICAgbGV0IHBvdGVudGlhbE1hdGNoID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gb25seSBzZWFyY2ggZm9yd2FyZCBpZiB0aGVyZSBpcyBhIHBvc3NpYmlsaXR5IG9mIGFuIGlkIG1hdGNoXG4gICAgICAgICAgICBpZiAobmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgIGxldCBwb3RlbnRpYWxNYXRjaCA9IGluc2VydGlvblBvaW50O1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgcG9zc2liaWxpdHkgb2YgYW4gaWQgbWF0Y2gsIHNjYW4gZm9yd2FyZFxuICAgICAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIHBvdGVudGlhbCBpZCBtYXRjaCBjb3VudCB3ZSBhcmUgZGlzY2FyZGluZyAodGhlXG4gICAgICAgICAgICAgICAgLy8gbmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50IG11c3QgYmUgZ3JlYXRlciB0aGFuIHRoaXMgdG8gbWFrZSBpdCBsaWtlbHlcbiAgICAgICAgICAgICAgICAvLyB3b3J0aCBpdClcbiAgICAgICAgICAgICAgICBsZXQgb3RoZXJNYXRjaENvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAocG90ZW50aWFsTWF0Y2ggIT0gbnVsbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgYW4gaWQgbWF0Y2gsIHJldHVybiB0aGUgY3VycmVudCBwb3RlbnRpYWwgbWF0Y2hcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSWRTZXRNYXRjaChuZXdDaGlsZCwgcG90ZW50aWFsTWF0Y2gsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb3RlbnRpYWxNYXRjaDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbXB1dGVyIHRoZSBvdGhlciBwb3RlbnRpYWwgbWF0Y2hlcyBvZiB0aGlzIG5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIG90aGVyTWF0Y2hDb3VudCArPSBnZXRJZEludGVyc2VjdGlvbkNvdW50KGN0eCwgcG90ZW50aWFsTWF0Y2gsIG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJNYXRjaENvdW50ID4gbmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIG1vcmUgcG90ZW50aWFsIGlkIG1hdGNoZXMgaW4gX290aGVyXyBjb250ZW50LCB3ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90IGhhdmUgYSBnb29kIGNhbmRpZGF0ZSBmb3IgYW4gaWQgbWF0Y2gsIHNvIHJldHVybiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkdmFuY2VkIHRvIHRoZSBuZXh0IG9sZCBjb250ZW50IGNoaWxkXG4gICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbE1hdGNoID0gcG90ZW50aWFsTWF0Y2gubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBvdGVudGlhbE1hdGNoO1xuICAgICAgICB9XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBTY2FucyBmb3J3YXJkIGZyb20gdGhlIGluc2VydGlvblBvaW50IGluIHRoZSBvbGQgcGFyZW50IGxvb2tpbmcgZm9yIGEgcG90ZW50aWFsIHNvZnQgbWF0Y2hcbiAgICAgICAgLy8gZm9yIHRoZSBuZXdDaGlsZC4gIFdlIHN0b3AgaWYgd2UgZmluZCBhIHBvdGVudGlhbCBzb2Z0IG1hdGNoIGZvciB0aGUgbmV3IGNoaWxkIE9SXG4gICAgICAgIC8vIGlmIHdlIGZpbmQgYSBwb3RlbnRpYWwgaWQgbWF0Y2ggaW4gdGhlIG9sZCBwYXJlbnRzIGNoaWxkcmVuIE9SIGlmIHdlIGZpbmQgdHdvXG4gICAgICAgIC8vIHBvdGVudGlhbCBzb2Z0IG1hdGNoZXMgZm9yIHRoZSBuZXh0IHR3byBwaWVjZXMgb2YgbmV3IGNvbnRlbnRcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBmaW5kU29mdE1hdGNoKG5ld0NvbnRlbnQsIG9sZFBhcmVudCwgbmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpIHtcblxuICAgICAgICAgICAgbGV0IHBvdGVudGlhbFNvZnRNYXRjaCA9IGluc2VydGlvblBvaW50O1xuICAgICAgICAgICAgbGV0IG5leHRTaWJsaW5nID0gbmV3Q2hpbGQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICBsZXQgc2libGluZ1NvZnRNYXRjaENvdW50ID0gMDtcblxuICAgICAgICAgICAgd2hpbGUgKHBvdGVudGlhbFNvZnRNYXRjaCAhPSBudWxsKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2V0SWRJbnRlcnNlY3Rpb25Db3VudChjdHgsIHBvdGVudGlhbFNvZnRNYXRjaCwgbmV3Q29udGVudCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjdXJyZW50IHBvdGVudGlhbCBzb2Z0IG1hdGNoIGhhcyBhIHBvdGVudGlhbCBpZCBzZXQgbWF0Y2ggd2l0aCB0aGUgcmVtYWluaW5nIG5ld1xuICAgICAgICAgICAgICAgICAgICAvLyBjb250ZW50IHNvIGJhaWwgb3V0IG9mIGxvb2tpbmdcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhIHNvZnQgbWF0Y2ggd2l0aCB0aGUgY3VycmVudCBub2RlLCByZXR1cm4gaXRcbiAgICAgICAgICAgICAgICBpZiAoaXNTb2Z0TWF0Y2gobmV3Q2hpbGQsIHBvdGVudGlhbFNvZnRNYXRjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvdGVudGlhbFNvZnRNYXRjaDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNTb2Z0TWF0Y2gobmV4dFNpYmxpbmcsIHBvdGVudGlhbFNvZnRNYXRjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG5leHQgbmV3IG5vZGUgaGFzIGEgc29mdCBtYXRjaCB3aXRoIHRoaXMgbm9kZSwgc29cbiAgICAgICAgICAgICAgICAgICAgLy8gaW5jcmVtZW50IHRoZSBjb3VudCBvZiBmdXR1cmUgc29mdCBtYXRjaGVzXG4gICAgICAgICAgICAgICAgICAgIHNpYmxpbmdTb2Z0TWF0Y2hDb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSB0d28gZnV0dXJlIHNvZnQgbWF0Y2hlcywgYmFpbCB0byBhbGxvdyB0aGUgc2libGluZ3MgdG8gc29mdCBtYXRjaFxuICAgICAgICAgICAgICAgICAgICAvLyBzbyB0aGF0IHdlIGRvbid0IGNvbnN1bWUgZnV0dXJlIHNvZnQgbWF0Y2hlcyBmb3IgdGhlIHNha2Ugb2YgdGhlIGN1cnJlbnQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2libGluZ1NvZnRNYXRjaENvdW50ID49IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gYWR2YW5jZWQgdG8gdGhlIG5leHQgb2xkIGNvbnRlbnQgY2hpbGRcbiAgICAgICAgICAgICAgICBwb3RlbnRpYWxTb2Z0TWF0Y2ggPSBwb3RlbnRpYWxTb2Z0TWF0Y2gubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBwb3RlbnRpYWxTb2Z0TWF0Y2g7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwYXJzZUNvbnRlbnQobmV3Q29udGVudCkge1xuICAgICAgICAgICAgbGV0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblxuICAgICAgICAgICAgLy8gcmVtb3ZlIHN2Z3MgdG8gYXZvaWQgZmFsc2UtcG9zaXRpdmUgbWF0Y2hlcyBvbiBoZWFkLCBldGMuXG4gICAgICAgICAgICBsZXQgY29udGVudFdpdGhTdmdzUmVtb3ZlZCA9IG5ld0NvbnRlbnQucmVwbGFjZSgvPHN2ZyhcXHNbXj5dKj58PikoW1xcc1xcU10qPyk8XFwvc3ZnPi9naW0sICcnKTtcblxuICAgICAgICAgICAgLy8gaWYgdGhlIG5ld0NvbnRlbnQgY29udGFpbnMgYSBodG1sLCBoZWFkIG9yIGJvZHkgdGFnLCB3ZSBjYW4gc2ltcGx5IHBhcnNlIGl0IHcvbyB3cmFwcGluZ1xuICAgICAgICAgICAgaWYgKGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9odG1sPi8pIHx8IGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9oZWFkPi8pIHx8IGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9ib2R5Pi8pKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKG5ld0NvbnRlbnQsIFwidGV4dC9odG1sXCIpO1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIGEgZnVsbCBIVE1MIGRvY3VtZW50LCByZXR1cm4gdGhlIGRvY3VtZW50IGl0c2VsZiBhcyB0aGUgcGFyZW50IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50V2l0aFN2Z3NSZW1vdmVkLm1hdGNoKC88XFwvaHRtbD4vKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50LmdlbmVyYXRlZEJ5SWRpb21vcnBoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHJldHVybiB0aGUgaHRtbCBlbGVtZW50IGFzIHRoZSBwYXJlbnQgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgIGxldCBodG1sRWxlbWVudCA9IGNvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGh0bWxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRWxlbWVudC5nZW5lcmF0ZWRCeUlkaW9tb3JwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaHRtbEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgcGFydGlhbCBIVE1MLCB3cmFwIGl0IGluIGEgdGVtcGxhdGUgdGFnIHRvIHByb3ZpZGUgYSBwYXJlbnQgZWxlbWVudCBhbmQgYWxzbyB0byBoZWxwXG4gICAgICAgICAgICAgICAgLy8gZGVhbCB3aXRoIHRvdWNoeSB0YWdzIGxpa2UgdHIsIHRib2R5LCBldGMuXG4gICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlRG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhcIjxib2R5Pjx0ZW1wbGF0ZT5cIiArIG5ld0NvbnRlbnQgKyBcIjwvdGVtcGxhdGU+PC9ib2R5PlwiLCBcInRleHQvaHRtbFwiKTtcbiAgICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHJlc3BvbnNlRG9jLmJvZHkucXVlcnlTZWxlY3RvcigndGVtcGxhdGUnKS5jb250ZW50O1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuZ2VuZXJhdGVkQnlJZGlvbW9ycGggPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb250ZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVDb250ZW50KG5ld0NvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmIChuZXdDb250ZW50ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBub2luc3BlY3Rpb24gVW5uZWNlc3NhcnlMb2NhbFZhcmlhYmxlSlNcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teVBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkdW1teVBhcmVudDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV3Q29udGVudC5nZW5lcmF0ZWRCeUlkaW9tb3JwaCkge1xuICAgICAgICAgICAgICAgIC8vIHRoZSB0ZW1wbGF0ZSB0YWcgY3JlYXRlZCBieSBpZGlvbW9ycGggcGFyc2luZyBjYW4gc2VydmUgYXMgYSBkdW1teSBwYXJlbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q29udGVudDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV3Q29udGVudCBpbnN0YW5jZW9mIE5vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBhIHNpbmdsZSBub2RlIGlzIGFkZGVkIGFzIGEgY2hpbGQgdG8gYSBkdW1teSBwYXJlbnRcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teVBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGR1bW15UGFyZW50LmFwcGVuZChuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZHVtbXlQYXJlbnQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGFsbCBub2RlcyBpbiB0aGUgYXJyYXkgb3IgSFRNTEVsZW1lbnQgY29sbGVjdGlvbiBhcmUgY29uc29saWRhdGVkIHVuZGVyXG4gICAgICAgICAgICAgICAgLy8gYSBzaW5nbGUgZHVtbXkgcGFyZW50IGVsZW1lbnRcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teVBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWx0IG9mIFsuLi5uZXdDb250ZW50XSkge1xuICAgICAgICAgICAgICAgICAgICBkdW1teVBhcmVudC5hcHBlbmQoZWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGR1bW15UGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5zZXJ0U2libGluZ3MocHJldmlvdXNTaWJsaW5nLCBtb3JwaGVkTm9kZSwgbmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIGxldCBzdGFjayA9IFtdO1xuICAgICAgICAgICAgbGV0IGFkZGVkID0gW107XG4gICAgICAgICAgICB3aGlsZSAocHJldmlvdXNTaWJsaW5nICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzdGFjay5wdXNoKHByZXZpb3VzU2libGluZyk7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNTaWJsaW5nID0gcHJldmlvdXNTaWJsaW5nLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5vZGUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICBhZGRlZC5wdXNoKG5vZGUpOyAvLyBwdXNoIGFkZGVkIHByZWNlZGluZyBzaWJsaW5ncyBvbiBpbiBvcmRlciBhbmQgaW5zZXJ0XG4gICAgICAgICAgICAgICAgbW9ycGhlZE5vZGUucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUobm9kZSwgbW9ycGhlZE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkZWQucHVzaChtb3JwaGVkTm9kZSk7XG4gICAgICAgICAgICB3aGlsZSAobmV4dFNpYmxpbmcgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIGFkZGVkLnB1c2gobmV4dFNpYmxpbmcpOyAvLyBoZXJlIHdlIGFyZSBnb2luZyBpbiBvcmRlciwgc28gcHVzaCBvbiBhcyB3ZSBzY2FuLCByYXRoZXIgdGhhbiBhZGRcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBtb3JwaGVkTm9kZS5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShzdGFjay5wb3AoKSwgbW9ycGhlZE5vZGUubmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFkZGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmluZEJlc3ROb2RlTWF0Y2gobmV3Q29udGVudCwgb2xkTm9kZSwgY3R4KSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudEVsZW1lbnQ7XG4gICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IG5ld0NvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIGxldCBiZXN0RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50O1xuICAgICAgICAgICAgbGV0IHNjb3JlID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxldCBuZXdTY29yZSA9IHNjb3JlRWxlbWVudChjdXJyZW50RWxlbWVudCwgb2xkTm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICBpZiAobmV3U2NvcmUgPiBzY29yZSkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBzY29yZSA9IG5ld1Njb3JlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50Lm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJlc3RFbGVtZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2NvcmVFbGVtZW50KG5vZGUxLCBub2RlMiwgY3R4KSB7XG4gICAgICAgICAgICBpZiAoaXNTb2Z0TWF0Y2gobm9kZTEsIG5vZGUyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAuNSArIGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBub2RlMSwgbm9kZTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVOb2RlKHRlbXBOb2RlLCBjdHgpIHtcbiAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgdGVtcE5vZGUpO1xuICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZVJlbW92ZWQodGVtcE5vZGUpID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICB0ZW1wTm9kZS5yZW1vdmUoKTtcbiAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlUmVtb3ZlZCh0ZW1wTm9kZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIElEIFNldCBGdW5jdGlvbnNcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgICAgIGZ1bmN0aW9uIGlzSWRJbkNvbnNpZGVyYXRpb24oY3R4LCBpZCkge1xuICAgICAgICAgICAgcmV0dXJuICFjdHguZGVhZElkcy5oYXMoaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaWRJc1dpdGhpbk5vZGUoY3R4LCBpZCwgdGFyZ2V0Tm9kZSkge1xuICAgICAgICAgICAgbGV0IGlkU2V0ID0gY3R4LmlkTWFwLmdldCh0YXJnZXROb2RlKSB8fCBFTVBUWV9TRVQ7XG4gICAgICAgICAgICByZXR1cm4gaWRTZXQuaGFzKGlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbm9kZSkge1xuICAgICAgICAgICAgbGV0IGlkU2V0ID0gY3R4LmlkTWFwLmdldChub2RlKSB8fCBFTVBUWV9TRVQ7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGlkU2V0KSB7XG4gICAgICAgICAgICAgICAgY3R4LmRlYWRJZHMuYWRkKGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBub2RlMSwgbm9kZTIpIHtcbiAgICAgICAgICAgIGxldCBzb3VyY2VTZXQgPSBjdHguaWRNYXAuZ2V0KG5vZGUxKSB8fCBFTVBUWV9TRVQ7XG4gICAgICAgICAgICBsZXQgbWF0Y2hDb3VudCA9IDA7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIHNvdXJjZVNldCkge1xuICAgICAgICAgICAgICAgIC8vIGEgcG90ZW50aWFsIG1hdGNoIGlzIGFuIGlkIGluIHRoZSBzb3VyY2UgYW5kIHBvdGVudGlhbElkc1NldCwgYnV0XG4gICAgICAgICAgICAgICAgLy8gdGhhdCBoYXMgbm90IGFscmVhZHkgYmVlbiBtZXJnZWQgaW50byB0aGUgRE9NXG4gICAgICAgICAgICAgICAgaWYgKGlzSWRJbkNvbnNpZGVyYXRpb24oY3R4LCBpZCkgJiYgaWRJc1dpdGhpbk5vZGUoY3R4LCBpZCwgbm9kZTIpKSB7XG4gICAgICAgICAgICAgICAgICAgICsrbWF0Y2hDb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hDb3VudDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGJvdHRvbSB1cCBhbGdvcml0aG0gdGhhdCBmaW5kcyBhbGwgZWxlbWVudHMgd2l0aCBpZHMgaW5zaWRlIG9mIHRoZSBub2RlXG4gICAgICAgICAqIGFyZ3VtZW50IGFuZCBwb3B1bGF0ZXMgaWQgc2V0cyBmb3IgdGhvc2Ugbm9kZXMgYW5kIGFsbCB0aGVpciBwYXJlbnRzLCBnZW5lcmF0aW5nXG4gICAgICAgICAqIGEgc2V0IG9mIGlkcyBjb250YWluZWQgd2l0aGluIGFsbCBub2RlcyBmb3IgdGhlIGVudGlyZSBoaWVyYXJjaHkgaW4gdGhlIERPTVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gbm9kZSB7RWxlbWVudH1cbiAgICAgICAgICogQHBhcmFtIHtNYXA8Tm9kZSwgU2V0PFN0cmluZz4+fSBpZE1hcFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcG9wdWxhdGVJZE1hcEZvck5vZGUobm9kZSwgaWRNYXApIHtcbiAgICAgICAgICAgIGxldCBub2RlUGFyZW50ID0gbm9kZS5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgLy8gZmluZCBhbGwgZWxlbWVudHMgd2l0aCBhbiBpZCBwcm9wZXJ0eVxuICAgICAgICAgICAgbGV0IGlkRWxlbWVudHMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tpZF0nKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZWx0IG9mIGlkRWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IGVsdDtcbiAgICAgICAgICAgICAgICAvLyB3YWxrIHVwIHRoZSBwYXJlbnQgaGllcmFyY2h5IG9mIHRoYXQgZWxlbWVudCwgYWRkaW5nIHRoZSBpZFxuICAgICAgICAgICAgICAgIC8vIG9mIGVsZW1lbnQgdG8gdGhlIHBhcmVudCdzIGlkIHNldFxuICAgICAgICAgICAgICAgIHdoaWxlIChjdXJyZW50ICE9PSBub2RlUGFyZW50ICYmIGN1cnJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaWRTZXQgPSBpZE1hcC5nZXQoY3VycmVudCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBpZCBzZXQgZG9lc24ndCBleGlzdCwgY3JlYXRlIGl0IGFuZCBpbnNlcnQgaXQgaW4gdGhlICBtYXBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkU2V0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkU2V0ID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWRNYXAuc2V0KGN1cnJlbnQsIGlkU2V0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZFNldC5hZGQoZWx0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBmdW5jdGlvbiBjb21wdXRlcyBhIG1hcCBvZiBub2RlcyB0byBhbGwgaWRzIGNvbnRhaW5lZCB3aXRoaW4gdGhhdCBub2RlIChpbmNsdXNpdmUgb2YgdGhlXG4gICAgICAgICAqIG5vZGUpLiAgVGhpcyBtYXAgY2FuIGJlIHVzZWQgdG8gYXNrIGlmIHR3byBub2RlcyBoYXZlIGludGVyc2VjdGluZyBzZXRzIG9mIGlkcywgd2hpY2ggYWxsb3dzXG4gICAgICAgICAqIGZvciBhIGxvb3NlciBkZWZpbml0aW9uIG9mIFwibWF0Y2hpbmdcIiB0aGFuIHRyYWRpdGlvbiBpZCBtYXRjaGluZywgYW5kIGFsbG93cyBjaGlsZCBub2Rlc1xuICAgICAgICAgKiB0byBjb250cmlidXRlIHRvIGEgcGFyZW50IG5vZGVzIG1hdGNoaW5nLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG9sZENvbnRlbnQgIHRoZSBvbGQgY29udGVudCB0aGF0IHdpbGwgYmUgbW9ycGhlZFxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5ld0NvbnRlbnQgIHRoZSBuZXcgY29udGVudCB0byBtb3JwaCB0b1xuICAgICAgICAgKiBAcmV0dXJucyB7TWFwPE5vZGUsIFNldDxTdHJpbmc+Pn0gYSBtYXAgb2Ygbm9kZXMgdG8gaWQgc2V0cyBmb3IgdGhlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBjcmVhdGVJZE1hcChvbGRDb250ZW50LCBuZXdDb250ZW50KSB7XG4gICAgICAgICAgICBsZXQgaWRNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBwb3B1bGF0ZUlkTWFwRm9yTm9kZShvbGRDb250ZW50LCBpZE1hcCk7XG4gICAgICAgICAgICBwb3B1bGF0ZUlkTWFwRm9yTm9kZShuZXdDb250ZW50LCBpZE1hcCk7XG4gICAgICAgICAgICByZXR1cm4gaWRNYXA7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFRoaXMgaXMgd2hhdCBlbmRzIHVwIGJlY29taW5nIHRoZSBJZGlvbW9ycGggZ2xvYmFsIG9iamVjdFxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtb3JwaCxcbiAgICAgICAgICAgIGRlZmF1bHRzXG4gICAgICAgIH1cbiAgICB9KSgpO1xuXG5mdW5jdGlvbiBtb3JwaEVsZW1lbnRzKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50LCB7IGNhbGxiYWNrcywgLi4ub3B0aW9ucyB9ID0ge30pIHtcbiAgSWRpb21vcnBoLm1vcnBoKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50LCB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBjYWxsYmFja3M6IG5ldyBEZWZhdWx0SWRpb21vcnBoQ2FsbGJhY2tzKGNhbGxiYWNrcylcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG1vcnBoQ2hpbGRyZW4oY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgbW9ycGhFbGVtZW50cyhjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudC5jaGlsZHJlbiwge1xuICAgIG1vcnBoU3R5bGU6IFwiaW5uZXJIVE1MXCJcbiAgfSk7XG59XG5cbmNsYXNzIERlZmF1bHRJZGlvbW9ycGhDYWxsYmFja3Mge1xuICAjYmVmb3JlTm9kZU1vcnBoZWRcblxuICBjb25zdHJ1Y3Rvcih7IGJlZm9yZU5vZGVNb3JwaGVkIH0gPSB7fSkge1xuICAgIHRoaXMuI2JlZm9yZU5vZGVNb3JwaGVkID0gYmVmb3JlTm9kZU1vcnBoZWQgfHwgKCgpID0+IHRydWUpO1xuICB9XG5cbiAgYmVmb3JlTm9kZUFkZGVkID0gKG5vZGUpID0+IHtcbiAgICByZXR1cm4gIShub2RlLmlkICYmIG5vZGUuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1wZXJtYW5lbnRcIikgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCkpXG4gIH1cblxuICBiZWZvcmVOb2RlTW9ycGhlZCA9IChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkgPT4ge1xuICAgIGlmIChjdXJyZW50RWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgIGlmICghY3VycmVudEVsZW1lbnQuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1wZXJtYW5lbnRcIikgJiYgdGhpcy4jYmVmb3JlTm9kZU1vcnBoZWQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtbW9ycGgtZWxlbWVudFwiLCB7XG4gICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgICAgICB0YXJnZXQ6IGN1cnJlbnRFbGVtZW50LFxuICAgICAgICAgIGRldGFpbDogeyBjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYmVmb3JlQXR0cmlidXRlVXBkYXRlZCA9IChhdHRyaWJ1dGVOYW1lLCB0YXJnZXQsIG11dGF0aW9uVHlwZSkgPT4ge1xuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtbW9ycGgtYXR0cmlidXRlXCIsIHtcbiAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICB0YXJnZXQsXG4gICAgICBkZXRhaWw6IHsgYXR0cmlidXRlTmFtZSwgbXV0YXRpb25UeXBlIH1cbiAgICB9KTtcblxuICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICB9XG5cbiAgYmVmb3JlTm9kZVJlbW92ZWQgPSAobm9kZSkgPT4ge1xuICAgIHJldHVybiB0aGlzLmJlZm9yZU5vZGVNb3JwaGVkKG5vZGUpXG4gIH1cblxuICBhZnRlck5vZGVNb3JwaGVkID0gKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSA9PiB7XG4gICAgaWYgKGN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgZGlzcGF0Y2goXCJ0dXJibzptb3JwaC1lbGVtZW50XCIsIHtcbiAgICAgICAgdGFyZ2V0OiBjdXJyZW50RWxlbWVudCxcbiAgICAgICAgZGV0YWlsOiB7IGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50IH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBNb3JwaGluZ0ZyYW1lUmVuZGVyZXIgZXh0ZW5kcyBGcmFtZVJlbmRlcmVyIHtcbiAgc3RhdGljIHJlbmRlckVsZW1lbnQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgICBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1mcmFtZS1tb3JwaFwiLCB7XG4gICAgICB0YXJnZXQ6IGN1cnJlbnRFbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50IH1cbiAgICB9KTtcblxuICAgIG1vcnBoQ2hpbGRyZW4oY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpO1xuICB9XG5cbiAgYXN5bmMgcHJlc2VydmluZ1Blcm1hbmVudEVsZW1lbnRzKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIGF3YWl0IGNhbGxiYWNrKClcbiAgfVxufVxuXG5jbGFzcyBQcm9ncmVzc0JhciB7XG4gIHN0YXRpYyBhbmltYXRpb25EdXJhdGlvbiA9IDMwMCAvKm1zKi9cblxuICBzdGF0aWMgZ2V0IGRlZmF1bHRDU1MoKSB7XG4gICAgcmV0dXJuIHVuaW5kZW50YFxuICAgICAgLnR1cmJvLXByb2dyZXNzLWJhciB7XG4gICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgbGVmdDogMDtcbiAgICAgICAgaGVpZ2h0OiAzcHg7XG4gICAgICAgIGJhY2tncm91bmQ6ICMwMDc2ZmY7XG4gICAgICAgIHotaW5kZXg6IDIxNDc0ODM2NDc7XG4gICAgICAgIHRyYW5zaXRpb246XG4gICAgICAgICAgd2lkdGggJHtQcm9ncmVzc0Jhci5hbmltYXRpb25EdXJhdGlvbn1tcyBlYXNlLW91dCxcbiAgICAgICAgICBvcGFjaXR5ICR7UHJvZ3Jlc3NCYXIuYW5pbWF0aW9uRHVyYXRpb24gLyAyfW1zICR7UHJvZ3Jlc3NCYXIuYW5pbWF0aW9uRHVyYXRpb24gLyAyfW1zIGVhc2UtaW47XG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoMCwgMCwgMCk7XG4gICAgICB9XG4gICAgYFxuICB9XG5cbiAgaGlkaW5nID0gZmFsc2VcbiAgdmFsdWUgPSAwXG4gIHZpc2libGUgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3R5bGVzaGVldEVsZW1lbnQgPSB0aGlzLmNyZWF0ZVN0eWxlc2hlZXRFbGVtZW50KCk7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQgPSB0aGlzLmNyZWF0ZVByb2dyZXNzRWxlbWVudCgpO1xuICAgIHRoaXMuaW5zdGFsbFN0eWxlc2hlZXRFbGVtZW50KCk7XG4gICAgdGhpcy5zZXRWYWx1ZSgwKTtcbiAgfVxuXG4gIHNob3coKSB7XG4gICAgaWYgKCF0aGlzLnZpc2libGUpIHtcbiAgICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgICB0aGlzLmluc3RhbGxQcm9ncmVzc0VsZW1lbnQoKTtcbiAgICAgIHRoaXMuc3RhcnRUcmlja2xpbmcoKTtcbiAgICB9XG4gIH1cblxuICBoaWRlKCkge1xuICAgIGlmICh0aGlzLnZpc2libGUgJiYgIXRoaXMuaGlkaW5nKSB7XG4gICAgICB0aGlzLmhpZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmZhZGVQcm9ncmVzc0VsZW1lbnQoKCkgPT4ge1xuICAgICAgICB0aGlzLnVuaW5zdGFsbFByb2dyZXNzRWxlbWVudCgpO1xuICAgICAgICB0aGlzLnN0b3BUcmlja2xpbmcoKTtcbiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaGlkaW5nID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBzZXRWYWx1ZSh2YWx1ZSkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBpbnN0YWxsU3R5bGVzaGVldEVsZW1lbnQoKSB7XG4gICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUodGhpcy5zdHlsZXNoZWV0RWxlbWVudCwgZG9jdW1lbnQuaGVhZC5maXJzdENoaWxkKTtcbiAgfVxuXG4gIGluc3RhbGxQcm9ncmVzc0VsZW1lbnQoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBcIjBcIjtcbiAgICB0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gXCIxXCI7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lmluc2VydEJlZm9yZSh0aGlzLnByb2dyZXNzRWxlbWVudCwgZG9jdW1lbnQuYm9keSk7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gIH1cblxuICBmYWRlUHJvZ3Jlc3NFbGVtZW50KGNhbGxiYWNrKSB7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUub3BhY2l0eSA9IFwiMFwiO1xuICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIFByb2dyZXNzQmFyLmFuaW1hdGlvbkR1cmF0aW9uICogMS41KTtcbiAgfVxuXG4gIHVuaW5zdGFsbFByb2dyZXNzRWxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5wcm9ncmVzc0VsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMucHJvZ3Jlc3NFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBzdGFydFRyaWNrbGluZygpIHtcbiAgICBpZiAoIXRoaXMudHJpY2tsZUludGVydmFsKSB7XG4gICAgICB0aGlzLnRyaWNrbGVJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLnRyaWNrbGUsIFByb2dyZXNzQmFyLmFuaW1hdGlvbkR1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICBzdG9wVHJpY2tsaW5nKCkge1xuICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudHJpY2tsZUludGVydmFsKTtcbiAgICBkZWxldGUgdGhpcy50cmlja2xlSW50ZXJ2YWw7XG4gIH1cblxuICB0cmlja2xlID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0VmFsdWUodGhpcy52YWx1ZSArIE1hdGgucmFuZG9tKCkgLyAxMDApO1xuICB9XG5cbiAgcmVmcmVzaCgpIHtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBgJHsxMCArIHRoaXMudmFsdWUgKiA5MH0lYDtcbiAgICB9KTtcbiAgfVxuXG4gIGNyZWF0ZVN0eWxlc2hlZXRFbGVtZW50KCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgZWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBQcm9ncmVzc0Jhci5kZWZhdWx0Q1NTO1xuICAgIGNvbnN0IGNzcE5vbmNlID0gZ2V0Q3NwTm9uY2UoKTtcbiAgICBpZiAoY3NwTm9uY2UpIHtcbiAgICAgIGVsZW1lbnQubm9uY2UgPSBjc3BOb25jZTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuXG4gIGNyZWF0ZVByb2dyZXNzRWxlbWVudCgpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBlbGVtZW50LmNsYXNzTmFtZSA9IFwidHVyYm8tcHJvZ3Jlc3MtYmFyXCI7XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxufVxuXG5jbGFzcyBIZWFkU25hcHNob3QgZXh0ZW5kcyBTbmFwc2hvdCB7XG4gIGRldGFpbHNCeU91dGVySFRNTCA9IHRoaXMuY2hpbGRyZW5cbiAgICAuZmlsdGVyKChlbGVtZW50KSA9PiAhZWxlbWVudElzTm9zY3JpcHQoZWxlbWVudCkpXG4gICAgLm1hcCgoZWxlbWVudCkgPT4gZWxlbWVudFdpdGhvdXROb25jZShlbGVtZW50KSlcbiAgICAucmVkdWNlKChyZXN1bHQsIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgb3V0ZXJIVE1MIH0gPSBlbGVtZW50O1xuICAgICAgY29uc3QgZGV0YWlscyA9XG4gICAgICAgIG91dGVySFRNTCBpbiByZXN1bHRcbiAgICAgICAgICA/IHJlc3VsdFtvdXRlckhUTUxdXG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIHR5cGU6IGVsZW1lbnRUeXBlKGVsZW1lbnQpLFxuICAgICAgICAgICAgICB0cmFja2VkOiBlbGVtZW50SXNUcmFja2VkKGVsZW1lbnQpLFxuICAgICAgICAgICAgICBlbGVtZW50czogW11cbiAgICAgICAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgIFtvdXRlckhUTUxdOiB7XG4gICAgICAgICAgLi4uZGV0YWlscyxcbiAgICAgICAgICBlbGVtZW50czogWy4uLmRldGFpbHMuZWxlbWVudHMsIGVsZW1lbnRdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB7fSlcblxuICBnZXQgdHJhY2tlZEVsZW1lbnRTaWduYXR1cmUoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MKVxuICAgICAgLmZpbHRlcigob3V0ZXJIVE1MKSA9PiB0aGlzLmRldGFpbHNCeU91dGVySFRNTFtvdXRlckhUTUxdLnRyYWNrZWQpXG4gICAgICAuam9pbihcIlwiKVxuICB9XG5cbiAgZ2V0U2NyaXB0RWxlbWVudHNOb3RJblNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudHNNYXRjaGluZ1R5cGVOb3RJblNuYXBzaG90KFwic2NyaXB0XCIsIHNuYXBzaG90KVxuICB9XG5cbiAgZ2V0U3R5bGVzaGVldEVsZW1lbnRzTm90SW5TbmFwc2hvdChzbmFwc2hvdCkge1xuICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRzTWF0Y2hpbmdUeXBlTm90SW5TbmFwc2hvdChcInN0eWxlc2hlZXRcIiwgc25hcHNob3QpXG4gIH1cblxuICBnZXRFbGVtZW50c01hdGNoaW5nVHlwZU5vdEluU25hcHNob3QobWF0Y2hlZFR5cGUsIHNuYXBzaG90KSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MKVxuICAgICAgLmZpbHRlcigob3V0ZXJIVE1MKSA9PiAhKG91dGVySFRNTCBpbiBzbmFwc2hvdC5kZXRhaWxzQnlPdXRlckhUTUwpKVxuICAgICAgLm1hcCgob3V0ZXJIVE1MKSA9PiB0aGlzLmRldGFpbHNCeU91dGVySFRNTFtvdXRlckhUTUxdKVxuICAgICAgLmZpbHRlcigoeyB0eXBlIH0pID0+IHR5cGUgPT0gbWF0Y2hlZFR5cGUpXG4gICAgICAubWFwKCh7IGVsZW1lbnRzOiBbZWxlbWVudF0gfSkgPT4gZWxlbWVudClcbiAgfVxuXG4gIGdldCBwcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmRldGFpbHNCeU91dGVySFRNTCkucmVkdWNlKChyZXN1bHQsIG91dGVySFRNTCkgPT4ge1xuICAgICAgY29uc3QgeyB0eXBlLCB0cmFja2VkLCBlbGVtZW50cyB9ID0gdGhpcy5kZXRhaWxzQnlPdXRlckhUTUxbb3V0ZXJIVE1MXTtcbiAgICAgIGlmICh0eXBlID09IG51bGwgJiYgIXRyYWNrZWQpIHtcbiAgICAgICAgcmV0dXJuIFsuLi5yZXN1bHQsIC4uLmVsZW1lbnRzXVxuICAgICAgfSBlbHNlIGlmIChlbGVtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHJldHVybiBbLi4ucmVzdWx0LCAuLi5lbGVtZW50cy5zbGljZSgxKV1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH1cbiAgICB9LCBbXSlcbiAgfVxuXG4gIGdldE1ldGFWYWx1ZShuYW1lKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZmluZE1ldGFFbGVtZW50QnlOYW1lKG5hbWUpO1xuICAgIHJldHVybiBlbGVtZW50ID8gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIpIDogbnVsbFxuICB9XG5cbiAgZmluZE1ldGFFbGVtZW50QnlOYW1lKG5hbWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5kZXRhaWxzQnlPdXRlckhUTUwpLnJlZHVjZSgocmVzdWx0LCBvdXRlckhUTUwpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZWxlbWVudHM6IFtlbGVtZW50XVxuICAgICAgfSA9IHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MW291dGVySFRNTF07XG4gICAgICByZXR1cm4gZWxlbWVudElzTWV0YUVsZW1lbnRXaXRoTmFtZShlbGVtZW50LCBuYW1lKSA/IGVsZW1lbnQgOiByZXN1bHRcbiAgICB9LCB1bmRlZmluZWQgfCB1bmRlZmluZWQpXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudFR5cGUoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudElzU2NyaXB0KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFwic2NyaXB0XCJcbiAgfSBlbHNlIGlmIChlbGVtZW50SXNTdHlsZXNoZWV0KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFwic3R5bGVzaGVldFwiXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudElzVHJhY2tlZChlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tdHJhY2tcIikgPT0gXCJyZWxvYWRcIlxufVxuXG5mdW5jdGlvbiBlbGVtZW50SXNTY3JpcHQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwic2NyaXB0XCJcbn1cblxuZnVuY3Rpb24gZWxlbWVudElzTm9zY3JpcHQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwibm9zY3JpcHRcIlxufVxuXG5mdW5jdGlvbiBlbGVtZW50SXNTdHlsZXNoZWV0KGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQubG9jYWxOYW1lO1xuICByZXR1cm4gdGFnTmFtZSA9PSBcInN0eWxlXCIgfHwgKHRhZ05hbWUgPT0gXCJsaW5rXCIgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJyZWxcIikgPT0gXCJzdHlsZXNoZWV0XCIpXG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRJc01ldGFFbGVtZW50V2l0aE5hbWUoZWxlbWVudCwgbmFtZSkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwibWV0YVwiICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSA9PSBuYW1lXG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRXaXRob3V0Tm9uY2UoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJub25jZVwiKSkge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgXCJcIik7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudFxufVxuXG5jbGFzcyBQYWdlU25hcHNob3QgZXh0ZW5kcyBTbmFwc2hvdCB7XG4gIHN0YXRpYyBmcm9tSFRNTFN0cmluZyhodG1sID0gXCJcIikge1xuICAgIHJldHVybiB0aGlzLmZyb21Eb2N1bWVudChwYXJzZUhUTUxEb2N1bWVudChodG1sKSlcbiAgfVxuXG4gIHN0YXRpYyBmcm9tRWxlbWVudChlbGVtZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuZnJvbURvY3VtZW50KGVsZW1lbnQub3duZXJEb2N1bWVudClcbiAgfVxuXG4gIHN0YXRpYyBmcm9tRG9jdW1lbnQoeyBkb2N1bWVudEVsZW1lbnQsIGJvZHksIGhlYWQgfSkge1xuICAgIHJldHVybiBuZXcgdGhpcyhkb2N1bWVudEVsZW1lbnQsIGJvZHksIG5ldyBIZWFkU25hcHNob3QoaGVhZCkpXG4gIH1cblxuICBjb25zdHJ1Y3Rvcihkb2N1bWVudEVsZW1lbnQsIGJvZHksIGhlYWRTbmFwc2hvdCkge1xuICAgIHN1cGVyKGJvZHkpO1xuICAgIHRoaXMuZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnRFbGVtZW50O1xuICAgIHRoaXMuaGVhZFNuYXBzaG90ID0gaGVhZFNuYXBzaG90O1xuICB9XG5cbiAgY2xvbmUoKSB7XG4gICAgY29uc3QgY2xvbmVkRWxlbWVudCA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICBjb25zdCBzZWxlY3RFbGVtZW50cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0XCIpO1xuICAgIGNvbnN0IGNsb25lZFNlbGVjdEVsZW1lbnRzID0gY2xvbmVkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0XCIpO1xuXG4gICAgZm9yIChjb25zdCBbaW5kZXgsIHNvdXJjZV0gb2Ygc2VsZWN0RWxlbWVudHMuZW50cmllcygpKSB7XG4gICAgICBjb25zdCBjbG9uZSA9IGNsb25lZFNlbGVjdEVsZW1lbnRzW2luZGV4XTtcbiAgICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIGNsb25lLnNlbGVjdGVkT3B0aW9ucykgb3B0aW9uLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBzb3VyY2Uuc2VsZWN0ZWRPcHRpb25zKSBjbG9uZS5vcHRpb25zW29wdGlvbi5pbmRleF0uc2VsZWN0ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgY2xvbmVkUGFzc3dvcmRJbnB1dCBvZiBjbG9uZWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJwYXNzd29yZFwiXScpKSB7XG4gICAgICBjbG9uZWRQYXNzd29yZElucHV0LnZhbHVlID0gXCJcIjtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFBhZ2VTbmFwc2hvdCh0aGlzLmRvY3VtZW50RWxlbWVudCwgY2xvbmVkRWxlbWVudCwgdGhpcy5oZWFkU25hcHNob3QpXG4gIH1cblxuICBnZXQgbGFuZygpIHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibGFuZ1wiKVxuICB9XG5cbiAgZ2V0IGhlYWRFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmhlYWRTbmFwc2hvdC5lbGVtZW50XG4gIH1cblxuICBnZXQgcm9vdExvY2F0aW9uKCkge1xuICAgIGNvbnN0IHJvb3QgPSB0aGlzLmdldFNldHRpbmcoXCJyb290XCIpID8/IFwiL1wiO1xuICAgIHJldHVybiBleHBhbmRVUkwocm9vdClcbiAgfVxuXG4gIGdldCBjYWNoZUNvbnRyb2xWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKFwiY2FjaGUtY29udHJvbFwiKVxuICB9XG5cbiAgZ2V0IGlzUHJldmlld2FibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FjaGVDb250cm9sVmFsdWUgIT0gXCJuby1wcmV2aWV3XCJcbiAgfVxuXG4gIGdldCBpc0NhY2hlYWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZUNvbnRyb2xWYWx1ZSAhPSBcIm5vLWNhY2hlXCJcbiAgfVxuXG4gIGdldCBpc1Zpc2l0YWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKFwidmlzaXQtY29udHJvbFwiKSAhPSBcInJlbG9hZFwiXG4gIH1cblxuICBnZXQgcHJlZmVyc1ZpZXdUcmFuc2l0aW9ucygpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkU25hcHNob3QuZ2V0TWV0YVZhbHVlKFwidmlldy10cmFuc2l0aW9uXCIpID09PSBcInNhbWUtb3JpZ2luXCJcbiAgfVxuXG4gIGdldCBzaG91bGRNb3JwaFBhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U2V0dGluZyhcInJlZnJlc2gtbWV0aG9kXCIpID09PSBcIm1vcnBoXCJcbiAgfVxuXG4gIGdldCBzaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmdldFNldHRpbmcoXCJyZWZyZXNoLXNjcm9sbFwiKSA9PT0gXCJwcmVzZXJ2ZVwiXG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgZ2V0U2V0dGluZyhuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZFNuYXBzaG90LmdldE1ldGFWYWx1ZShgdHVyYm8tJHtuYW1lfWApXG4gIH1cbn1cblxuY2xhc3MgVmlld1RyYW5zaXRpb25lciB7XG4gICN2aWV3VHJhbnNpdGlvblN0YXJ0ZWQgPSBmYWxzZVxuICAjbGFzdE9wZXJhdGlvbiA9IFByb21pc2UucmVzb2x2ZSgpXG5cbiAgcmVuZGVyQ2hhbmdlKHVzZVZpZXdUcmFuc2l0aW9uLCByZW5kZXIpIHtcbiAgICBpZiAodXNlVmlld1RyYW5zaXRpb24gJiYgdGhpcy52aWV3VHJhbnNpdGlvbnNBdmFpbGFibGUgJiYgIXRoaXMuI3ZpZXdUcmFuc2l0aW9uU3RhcnRlZCkge1xuICAgICAgdGhpcy4jdmlld1RyYW5zaXRpb25TdGFydGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuI2xhc3RPcGVyYXRpb24gPSB0aGlzLiNsYXN0T3BlcmF0aW9uLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBkb2N1bWVudC5zdGFydFZpZXdUcmFuc2l0aW9uKHJlbmRlcikuZmluaXNoZWQ7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4jbGFzdE9wZXJhdGlvbiA9IHRoaXMuI2xhc3RPcGVyYXRpb24udGhlbihyZW5kZXIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLiNsYXN0T3BlcmF0aW9uXG4gIH1cblxuICBnZXQgdmlld1RyYW5zaXRpb25zQXZhaWxhYmxlKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5zdGFydFZpZXdUcmFuc2l0aW9uXG4gIH1cbn1cblxuY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gIGFjdGlvbjogXCJhZHZhbmNlXCIsXG4gIGhpc3RvcnlDaGFuZ2VkOiBmYWxzZSxcbiAgdmlzaXRDYWNoZWRTbmFwc2hvdDogKCkgPT4ge30sXG4gIHdpbGxSZW5kZXI6IHRydWUsXG4gIHVwZGF0ZUhpc3Rvcnk6IHRydWUsXG4gIHNob3VsZENhY2hlU25hcHNob3Q6IHRydWUsXG4gIGFjY2VwdHNTdHJlYW1SZXNwb25zZTogZmFsc2Vcbn07XG5cbmNvbnN0IFRpbWluZ01ldHJpYyA9IHtcbiAgdmlzaXRTdGFydDogXCJ2aXNpdFN0YXJ0XCIsXG4gIHJlcXVlc3RTdGFydDogXCJyZXF1ZXN0U3RhcnRcIixcbiAgcmVxdWVzdEVuZDogXCJyZXF1ZXN0RW5kXCIsXG4gIHZpc2l0RW5kOiBcInZpc2l0RW5kXCJcbn07XG5cbmNvbnN0IFZpc2l0U3RhdGUgPSB7XG4gIGluaXRpYWxpemVkOiBcImluaXRpYWxpemVkXCIsXG4gIHN0YXJ0ZWQ6IFwic3RhcnRlZFwiLFxuICBjYW5jZWxlZDogXCJjYW5jZWxlZFwiLFxuICBmYWlsZWQ6IFwiZmFpbGVkXCIsXG4gIGNvbXBsZXRlZDogXCJjb21wbGV0ZWRcIlxufTtcblxuY29uc3QgU3lzdGVtU3RhdHVzQ29kZSA9IHtcbiAgbmV0d29ya0ZhaWx1cmU6IDAsXG4gIHRpbWVvdXRGYWlsdXJlOiAtMSxcbiAgY29udGVudFR5cGVNaXNtYXRjaDogLTJcbn07XG5cbmNvbnN0IERpcmVjdGlvbiA9IHtcbiAgYWR2YW5jZTogXCJmb3J3YXJkXCIsXG4gIHJlc3RvcmU6IFwiYmFja1wiLFxuICByZXBsYWNlOiBcIm5vbmVcIlxufTtcblxuY2xhc3MgVmlzaXQge1xuICBpZGVudGlmaWVyID0gdXVpZCgpIC8vIFJlcXVpcmVkIGJ5IHR1cmJvLWlvc1xuICB0aW1pbmdNZXRyaWNzID0ge31cblxuICBmb2xsb3dlZFJlZGlyZWN0ID0gZmFsc2VcbiAgaGlzdG9yeUNoYW5nZWQgPSBmYWxzZVxuICBzY3JvbGxlZCA9IGZhbHNlXG4gIHNob3VsZENhY2hlU25hcHNob3QgPSB0cnVlXG4gIGFjY2VwdHNTdHJlYW1SZXNwb25zZSA9IGZhbHNlXG4gIHNuYXBzaG90Q2FjaGVkID0gZmFsc2VcbiAgc3RhdGUgPSBWaXNpdFN0YXRlLmluaXRpYWxpemVkXG4gIHZpZXdUcmFuc2l0aW9uZXIgPSBuZXcgVmlld1RyYW5zaXRpb25lcigpXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIgPSByZXN0b3JhdGlvbklkZW50aWZpZXIgfHwgdXVpZCgpO1xuXG4gICAgY29uc3Qge1xuICAgICAgYWN0aW9uLFxuICAgICAgaGlzdG9yeUNoYW5nZWQsXG4gICAgICByZWZlcnJlcixcbiAgICAgIHNuYXBzaG90LFxuICAgICAgc25hcHNob3RIVE1MLFxuICAgICAgcmVzcG9uc2UsXG4gICAgICB2aXNpdENhY2hlZFNuYXBzaG90LFxuICAgICAgd2lsbFJlbmRlcixcbiAgICAgIHVwZGF0ZUhpc3RvcnksXG4gICAgICBzaG91bGRDYWNoZVNuYXBzaG90LFxuICAgICAgYWNjZXB0c1N0cmVhbVJlc3BvbnNlLFxuICAgICAgZGlyZWN0aW9uXG4gICAgfSA9IHtcbiAgICAgIC4uLmRlZmF1bHRPcHRpb25zLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH07XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG4gICAgdGhpcy5oaXN0b3J5Q2hhbmdlZCA9IGhpc3RvcnlDaGFuZ2VkO1xuICAgIHRoaXMucmVmZXJyZXIgPSByZWZlcnJlcjtcbiAgICB0aGlzLnNuYXBzaG90ID0gc25hcHNob3Q7XG4gICAgdGhpcy5zbmFwc2hvdEhUTUwgPSBzbmFwc2hvdEhUTUw7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMuaXNTYW1lUGFnZSA9IHRoaXMuZGVsZWdhdGUubG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZSh0aGlzLmxvY2F0aW9uLCB0aGlzLmFjdGlvbik7XG4gICAgdGhpcy5pc1BhZ2VSZWZyZXNoID0gdGhpcy52aWV3LmlzUGFnZVJlZnJlc2godGhpcyk7XG4gICAgdGhpcy52aXNpdENhY2hlZFNuYXBzaG90ID0gdmlzaXRDYWNoZWRTbmFwc2hvdDtcbiAgICB0aGlzLndpbGxSZW5kZXIgPSB3aWxsUmVuZGVyO1xuICAgIHRoaXMudXBkYXRlSGlzdG9yeSA9IHVwZGF0ZUhpc3Rvcnk7XG4gICAgdGhpcy5zY3JvbGxlZCA9ICF3aWxsUmVuZGVyO1xuICAgIHRoaXMuc2hvdWxkQ2FjaGVTbmFwc2hvdCA9IHNob3VsZENhY2hlU25hcHNob3Q7XG4gICAgdGhpcy5hY2NlcHRzU3RyZWFtUmVzcG9uc2UgPSBhY2NlcHRzU3RyZWFtUmVzcG9uc2U7XG4gICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb24gfHwgRGlyZWN0aW9uW2FjdGlvbl07XG4gIH1cblxuICBnZXQgYWRhcHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5hZGFwdGVyXG4gIH1cblxuICBnZXQgdmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS52aWV3XG4gIH1cblxuICBnZXQgaGlzdG9yeSgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5XG4gIH1cblxuICBnZXQgcmVzdG9yYXRpb25EYXRhKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkuZ2V0UmVzdG9yYXRpb25EYXRhRm9ySWRlbnRpZmllcih0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllcilcbiAgfVxuXG4gIGdldCBzaWxlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNTYW1lUGFnZVxuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gVmlzaXRTdGF0ZS5pbml0aWFsaXplZCkge1xuICAgICAgdGhpcy5yZWNvcmRUaW1pbmdNZXRyaWMoVGltaW5nTWV0cmljLnZpc2l0U3RhcnQpO1xuICAgICAgdGhpcy5zdGF0ZSA9IFZpc2l0U3RhdGUuc3RhcnRlZDtcbiAgICAgIHRoaXMuYWRhcHRlci52aXNpdFN0YXJ0ZWQodGhpcyk7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpc2l0U3RhcnRlZCh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gVmlzaXRTdGF0ZS5zdGFydGVkKSB7XG4gICAgICBpZiAodGhpcy5yZXF1ZXN0KSB7XG4gICAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2FuY2VsUmVuZGVyKCk7XG4gICAgICB0aGlzLnN0YXRlID0gVmlzaXRTdGF0ZS5jYW5jZWxlZDtcbiAgICB9XG4gIH1cblxuICBjb21wbGV0ZSgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBWaXNpdFN0YXRlLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy52aXNpdEVuZCk7XG4gICAgICB0aGlzLmFkYXB0ZXIudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgICB0aGlzLnN0YXRlID0gVmlzaXRTdGF0ZS5jb21wbGV0ZWQ7XG4gICAgICB0aGlzLmZvbGxvd1JlZGlyZWN0KCk7XG5cbiAgICAgIGlmICghdGhpcy5mb2xsb3dlZFJlZGlyZWN0KSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZmFpbCgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBWaXNpdFN0YXRlLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBWaXNpdFN0YXRlLmZhaWxlZDtcbiAgICAgIHRoaXMuYWRhcHRlci52aXNpdEZhaWxlZCh0aGlzKTtcbiAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgY2hhbmdlSGlzdG9yeSgpIHtcbiAgICBpZiAoIXRoaXMuaGlzdG9yeUNoYW5nZWQgJiYgdGhpcy51cGRhdGVIaXN0b3J5KSB7XG4gICAgICBjb25zdCBhY3Rpb25Gb3JIaXN0b3J5ID0gdGhpcy5sb2NhdGlvbi5ocmVmID09PSB0aGlzLnJlZmVycmVyPy5ocmVmID8gXCJyZXBsYWNlXCIgOiB0aGlzLmFjdGlvbjtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGdldEhpc3RvcnlNZXRob2RGb3JBY3Rpb24oYWN0aW9uRm9ySGlzdG9yeSk7XG4gICAgICB0aGlzLmhpc3RvcnkudXBkYXRlKG1ldGhvZCwgdGhpcy5sb2NhdGlvbiwgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIpO1xuICAgICAgdGhpcy5oaXN0b3J5Q2hhbmdlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgaXNzdWVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLmhhc1ByZWxvYWRlZFJlc3BvbnNlKCkpIHtcbiAgICAgIHRoaXMuc2ltdWxhdGVSZXF1ZXN0KCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnNob3VsZElzc3VlUmVxdWVzdCgpICYmICF0aGlzLnJlcXVlc3QpIHtcbiAgICAgIHRoaXMucmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QodGhpcywgRmV0Y2hNZXRob2QuZ2V0LCB0aGlzLmxvY2F0aW9uKTtcbiAgICAgIHRoaXMucmVxdWVzdC5wZXJmb3JtKCk7XG4gICAgfVxuICB9XG5cbiAgc2ltdWxhdGVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLnJlc3BvbnNlKSB7XG4gICAgICB0aGlzLnN0YXJ0UmVxdWVzdCgpO1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSgpO1xuICAgICAgdGhpcy5maW5pc2hSZXF1ZXN0KCk7XG4gICAgfVxuICB9XG5cbiAgc3RhcnRSZXF1ZXN0KCkge1xuICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy5yZXF1ZXN0U3RhcnQpO1xuICAgIHRoaXMuYWRhcHRlci52aXNpdFJlcXVlc3RTdGFydGVkKHRoaXMpO1xuICB9XG5cbiAgcmVjb3JkUmVzcG9uc2UocmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlKSB7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgY29uc3QgeyBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICAgIGlmIChpc1N1Y2Nlc3NmdWwoc3RhdHVzQ29kZSkpIHtcbiAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVxdWVzdENvbXBsZXRlZCh0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYWRhcHRlci52aXNpdFJlcXVlc3RGYWlsZWRXaXRoU3RhdHVzQ29kZSh0aGlzLCBzdGF0dXNDb2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmaW5pc2hSZXF1ZXN0KCkge1xuICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy5yZXF1ZXN0RW5kKTtcbiAgICB0aGlzLmFkYXB0ZXIudmlzaXRSZXF1ZXN0RmluaXNoZWQodGhpcyk7XG4gIH1cblxuICBsb2FkUmVzcG9uc2UoKSB7XG4gICAgaWYgKHRoaXMucmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHsgc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MIH0gPSB0aGlzLnJlc3BvbnNlO1xuICAgICAgdGhpcy5yZW5kZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zaG91bGRDYWNoZVNuYXBzaG90KSB0aGlzLmNhY2hlU25hcHNob3QoKTtcbiAgICAgICAgaWYgKHRoaXMudmlldy5yZW5kZXJQcm9taXNlKSBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUHJvbWlzZTtcblxuICAgICAgICBpZiAoaXNTdWNjZXNzZnVsKHN0YXR1c0NvZGUpICYmIHJlc3BvbnNlSFRNTCAhPSBudWxsKSB7XG4gICAgICAgICAgY29uc3Qgc25hcHNob3QgPSBQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclBhZ2VTbmFwc2hvdChzbmFwc2hvdCwgZmFsc2UpO1xuXG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJFcnJvcihQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKSwgdGhpcyk7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgdGhpcy5mYWlsKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGdldENhY2hlZFNuYXBzaG90KCkge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy52aWV3LmdldENhY2hlZFNuYXBzaG90Rm9yTG9jYXRpb24odGhpcy5sb2NhdGlvbikgfHwgdGhpcy5nZXRQcmVsb2FkZWRTbmFwc2hvdCgpO1xuXG4gICAgaWYgKHNuYXBzaG90ICYmICghZ2V0QW5jaG9yKHRoaXMubG9jYXRpb24pIHx8IHNuYXBzaG90Lmhhc0FuY2hvcihnZXRBbmNob3IodGhpcy5sb2NhdGlvbikpKSkge1xuICAgICAgaWYgKHRoaXMuYWN0aW9uID09IFwicmVzdG9yZVwiIHx8IHNuYXBzaG90LmlzUHJldmlld2FibGUpIHtcbiAgICAgICAgcmV0dXJuIHNuYXBzaG90XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0UHJlbG9hZGVkU25hcHNob3QoKSB7XG4gICAgaWYgKHRoaXMuc25hcHNob3RIVE1MKSB7XG4gICAgICByZXR1cm4gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHRoaXMuc25hcHNob3RIVE1MKVxuICAgIH1cbiAgfVxuXG4gIGhhc0NhY2hlZFNuYXBzaG90KCkge1xuICAgIHJldHVybiB0aGlzLmdldENhY2hlZFNuYXBzaG90KCkgIT0gbnVsbFxuICB9XG5cbiAgbG9hZENhY2hlZFNuYXBzaG90KCkge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy5nZXRDYWNoZWRTbmFwc2hvdCgpO1xuICAgIGlmIChzbmFwc2hvdCkge1xuICAgICAgY29uc3QgaXNQcmV2aWV3ID0gdGhpcy5zaG91bGRJc3N1ZVJlcXVlc3QoKTtcbiAgICAgIHRoaXMucmVuZGVyKGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5jYWNoZVNuYXBzaG90KCk7XG4gICAgICAgIGlmICh0aGlzLmlzU2FtZVBhZ2UgfHwgdGhpcy5pc1BhZ2VSZWZyZXNoKSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHRoaXMudmlldy5yZW5kZXJQcm9taXNlKSBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUHJvbWlzZTtcblxuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyUGFnZVNuYXBzaG90KHNuYXBzaG90LCBpc1ByZXZpZXcpO1xuXG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgaWYgKCFpc1ByZXZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZvbGxvd1JlZGlyZWN0KCkge1xuICAgIGlmICh0aGlzLnJlZGlyZWN0ZWRUb0xvY2F0aW9uICYmICF0aGlzLmZvbGxvd2VkUmVkaXJlY3QgJiYgdGhpcy5yZXNwb25zZT8ucmVkaXJlY3RlZCkge1xuICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UHJvcG9zZWRUb0xvY2F0aW9uKHRoaXMucmVkaXJlY3RlZFRvTG9jYXRpb24sIHtcbiAgICAgICAgYWN0aW9uOiBcInJlcGxhY2VcIixcbiAgICAgICAgcmVzcG9uc2U6IHRoaXMucmVzcG9uc2UsXG4gICAgICAgIHNob3VsZENhY2hlU25hcHNob3Q6IGZhbHNlLFxuICAgICAgICB3aWxsUmVuZGVyOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICB0aGlzLmZvbGxvd2VkUmVkaXJlY3QgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGdvVG9TYW1lUGFnZUFuY2hvcigpIHtcbiAgICBpZiAodGhpcy5pc1NhbWVQYWdlKSB7XG4gICAgICB0aGlzLnJlbmRlcihhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2FjaGVTbmFwc2hvdCgpO1xuICAgICAgICB0aGlzLnBlcmZvcm1TY3JvbGwoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VIaXN0b3J5KCk7XG4gICAgICAgIHRoaXMuYWRhcHRlci52aXNpdFJlbmRlcmVkKHRoaXMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gRmV0Y2ggcmVxdWVzdCBkZWxlZ2F0ZVxuXG4gIHByZXBhcmVSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBpZiAodGhpcy5hY2NlcHRzU3RyZWFtUmVzcG9uc2UpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKCkge1xuICAgIHRoaXMuc3RhcnRSZXF1ZXN0KCk7XG4gIH1cblxuICByZXF1ZXN0UHJldmVudGVkSGFuZGxpbmdSZXNwb25zZShfcmVxdWVzdCwgX3Jlc3BvbnNlKSB7fVxuXG4gIGFzeW5jIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICBpZiAocmVzcG9uc2VIVE1MID09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSh7XG4gICAgICAgIHN0YXR1c0NvZGU6IFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaCxcbiAgICAgICAgcmVkaXJlY3RlZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVkaXJlY3RlZFRvTG9jYXRpb24gPSByZXNwb25zZS5yZWRpcmVjdGVkID8gcmVzcG9uc2UubG9jYXRpb24gOiB1bmRlZmluZWQ7XG4gICAgICB0aGlzLnJlY29yZFJlc3BvbnNlKHsgc3RhdHVzQ29kZTogc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MLCByZWRpcmVjdGVkIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICBpZiAocmVzcG9uc2VIVE1MID09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSh7XG4gICAgICAgIHN0YXR1c0NvZGU6IFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaCxcbiAgICAgICAgcmVkaXJlY3RlZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVjb3JkUmVzcG9uc2UoeyBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLCByZXNwb25zZUhUTUwsIHJlZGlyZWN0ZWQgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdEVycm9yZWQoX3JlcXVlc3QsIF9lcnJvcikge1xuICAgIHRoaXMucmVjb3JkUmVzcG9uc2Uoe1xuICAgICAgc3RhdHVzQ29kZTogU3lzdGVtU3RhdHVzQ29kZS5uZXR3b3JrRmFpbHVyZSxcbiAgICAgIHJlZGlyZWN0ZWQ6IGZhbHNlXG4gICAgfSk7XG4gIH1cblxuICByZXF1ZXN0RmluaXNoZWQoKSB7XG4gICAgdGhpcy5maW5pc2hSZXF1ZXN0KCk7XG4gIH1cblxuICAvLyBTY3JvbGxpbmdcblxuICBwZXJmb3JtU2Nyb2xsKCkge1xuICAgIGlmICghdGhpcy5zY3JvbGxlZCAmJiAhdGhpcy52aWV3LmZvcmNlUmVsb2FkZWQgJiYgIXRoaXMudmlldy5zaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKHRoaXMpKSB7XG4gICAgICBpZiAodGhpcy5hY3Rpb24gPT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb1Jlc3RvcmVkUG9zaXRpb24oKSB8fCB0aGlzLnNjcm9sbFRvQW5jaG9yKCkgfHwgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNjcm9sbFRvQW5jaG9yKCkgfHwgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5pc1NhbWVQYWdlKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbih0aGlzLnZpZXcubGFzdFJlbmRlcmVkTG9jYXRpb24sIHRoaXMubG9jYXRpb24pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNjcm9sbGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzY3JvbGxUb1Jlc3RvcmVkUG9zaXRpb24oKSB7XG4gICAgY29uc3QgeyBzY3JvbGxQb3NpdGlvbiB9ID0gdGhpcy5yZXN0b3JhdGlvbkRhdGE7XG4gICAgaWYgKHNjcm9sbFBvc2l0aW9uKSB7XG4gICAgICB0aGlzLnZpZXcuc2Nyb2xsVG9Qb3NpdGlvbihzY3JvbGxQb3NpdGlvbik7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIHNjcm9sbFRvQW5jaG9yKCkge1xuICAgIGNvbnN0IGFuY2hvciA9IGdldEFuY2hvcih0aGlzLmxvY2F0aW9uKTtcbiAgICBpZiAoYW5jaG9yICE9IG51bGwpIHtcbiAgICAgIHRoaXMudmlldy5zY3JvbGxUb0FuY2hvcihhbmNob3IpO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cblxuICAvLyBJbnN0cnVtZW50YXRpb25cblxuICByZWNvcmRUaW1pbmdNZXRyaWMobWV0cmljKSB7XG4gICAgdGhpcy50aW1pbmdNZXRyaWNzW21ldHJpY10gPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgfVxuXG4gIGdldFRpbWluZ01ldHJpY3MoKSB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy50aW1pbmdNZXRyaWNzIH1cbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBnZXRIaXN0b3J5TWV0aG9kRm9yQWN0aW9uKGFjdGlvbikge1xuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlIFwicmVwbGFjZVwiOlxuICAgICAgICByZXR1cm4gaGlzdG9yeS5yZXBsYWNlU3RhdGVcbiAgICAgIGNhc2UgXCJhZHZhbmNlXCI6XG4gICAgICBjYXNlIFwicmVzdG9yZVwiOlxuICAgICAgICByZXR1cm4gaGlzdG9yeS5wdXNoU3RhdGVcbiAgICB9XG4gIH1cblxuICBoYXNQcmVsb2FkZWRSZXNwb25zZSgpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaXMucmVzcG9uc2UgPT0gXCJvYmplY3RcIlxuICB9XG5cbiAgc2hvdWxkSXNzdWVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLmlzU2FtZVBhZ2UpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0gZWxzZSBpZiAodGhpcy5hY3Rpb24gPT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgIHJldHVybiAhdGhpcy5oYXNDYWNoZWRTbmFwc2hvdCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLndpbGxSZW5kZXJcbiAgICB9XG4gIH1cblxuICBjYWNoZVNuYXBzaG90KCkge1xuICAgIGlmICghdGhpcy5zbmFwc2hvdENhY2hlZCkge1xuICAgICAgdGhpcy52aWV3LmNhY2hlU25hcHNob3QodGhpcy5zbmFwc2hvdCkudGhlbigoc25hcHNob3QpID0+IHNuYXBzaG90ICYmIHRoaXMudmlzaXRDYWNoZWRTbmFwc2hvdChzbmFwc2hvdCkpO1xuICAgICAgdGhpcy5zbmFwc2hvdENhY2hlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVuZGVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5jYW5jZWxSZW5kZXIoKTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy5mcmFtZSA9XG4gICAgICAgIGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gXCJoaWRkZW5cIiA/IHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZSgpLCAwKSA6IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiByZXNvbHZlKCkpO1xuICAgIH0pO1xuICAgIGF3YWl0IGNhbGxiYWNrKCk7XG4gICAgZGVsZXRlIHRoaXMuZnJhbWU7XG4gIH1cblxuICBhc3luYyByZW5kZXJQYWdlU25hcHNob3Qoc25hcHNob3QsIGlzUHJldmlldykge1xuICAgIGF3YWl0IHRoaXMudmlld1RyYW5zaXRpb25lci5yZW5kZXJDaGFuZ2UodGhpcy52aWV3LnNob3VsZFRyYW5zaXRpb25UbyhzbmFwc2hvdCksIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJQYWdlKHNuYXBzaG90LCBpc1ByZXZpZXcsIHRoaXMud2lsbFJlbmRlciwgdGhpcyk7XG4gICAgICB0aGlzLnBlcmZvcm1TY3JvbGwoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNhbmNlbFJlbmRlcigpIHtcbiAgICBpZiAodGhpcy5mcmFtZSkge1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5mcmFtZSk7XG4gICAgICBkZWxldGUgdGhpcy5mcmFtZTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNTdWNjZXNzZnVsKHN0YXR1c0NvZGUpIHtcbiAgcmV0dXJuIHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDBcbn1cblxuY2xhc3MgQnJvd3NlckFkYXB0ZXIge1xuICBwcm9ncmVzc0JhciA9IG5ldyBQcm9ncmVzc0JhcigpXG5cbiAgY29uc3RydWN0b3Ioc2Vzc2lvbikge1xuICAgIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247XG4gIH1cblxuICB2aXNpdFByb3Bvc2VkVG9Mb2NhdGlvbihsb2NhdGlvbiwgb3B0aW9ucykge1xuICAgIGlmIChsb2NhdGlvbklzVmlzaXRhYmxlKGxvY2F0aW9uLCB0aGlzLm5hdmlnYXRvci5yb290TG9jYXRpb24pKSB7XG4gICAgICB0aGlzLm5hdmlnYXRvci5zdGFydFZpc2l0KGxvY2F0aW9uLCBvcHRpb25zPy5yZXN0b3JhdGlvbklkZW50aWZpZXIgfHwgdXVpZCgpLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBsb2NhdGlvbi50b1N0cmluZygpO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0U3RhcnRlZCh2aXNpdCkge1xuICAgIHRoaXMubG9jYXRpb24gPSB2aXNpdC5sb2NhdGlvbjtcbiAgICB2aXNpdC5sb2FkQ2FjaGVkU25hcHNob3QoKTtcbiAgICB2aXNpdC5pc3N1ZVJlcXVlc3QoKTtcbiAgICB2aXNpdC5nb1RvU2FtZVBhZ2VBbmNob3IoKTtcbiAgfVxuXG4gIHZpc2l0UmVxdWVzdFN0YXJ0ZWQodmlzaXQpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDApO1xuICAgIGlmICh2aXNpdC5oYXNDYWNoZWRTbmFwc2hvdCgpIHx8IHZpc2l0LmFjdGlvbiAhPSBcInJlc3RvcmVcIikge1xuICAgICAgdGhpcy5zaG93VmlzaXRQcm9ncmVzc0JhckFmdGVyRGVsYXkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zaG93UHJvZ3Jlc3NCYXIoKTtcbiAgICB9XG4gIH1cblxuICB2aXNpdFJlcXVlc3RDb21wbGV0ZWQodmlzaXQpIHtcbiAgICB2aXNpdC5sb2FkUmVzcG9uc2UoKTtcbiAgfVxuXG4gIHZpc2l0UmVxdWVzdEZhaWxlZFdpdGhTdGF0dXNDb2RlKHZpc2l0LCBzdGF0dXNDb2RlKSB7XG4gICAgc3dpdGNoIChzdGF0dXNDb2RlKSB7XG4gICAgICBjYXNlIFN5c3RlbVN0YXR1c0NvZGUubmV0d29ya0ZhaWx1cmU6XG4gICAgICBjYXNlIFN5c3RlbVN0YXR1c0NvZGUudGltZW91dEZhaWx1cmU6XG4gICAgICBjYXNlIFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaDpcbiAgICAgICAgcmV0dXJuIHRoaXMucmVsb2FkKHtcbiAgICAgICAgICByZWFzb246IFwicmVxdWVzdF9mYWlsZWRcIixcbiAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICBzdGF0dXNDb2RlXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHZpc2l0LmxvYWRSZXNwb25zZSgpXG4gICAgfVxuICB9XG5cbiAgdmlzaXRSZXF1ZXN0RmluaXNoZWQoX3Zpc2l0KSB7fVxuXG4gIHZpc2l0Q29tcGxldGVkKF92aXNpdCkge1xuICAgIHRoaXMucHJvZ3Jlc3NCYXIuc2V0VmFsdWUoMSk7XG4gICAgdGhpcy5oaWRlVmlzaXRQcm9ncmVzc0JhcigpO1xuICB9XG5cbiAgcGFnZUludmFsaWRhdGVkKHJlYXNvbikge1xuICAgIHRoaXMucmVsb2FkKHJlYXNvbik7XG4gIH1cblxuICB2aXNpdEZhaWxlZChfdmlzaXQpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDEpO1xuICAgIHRoaXMuaGlkZVZpc2l0UHJvZ3Jlc3NCYXIoKTtcbiAgfVxuXG4gIHZpc2l0UmVuZGVyZWQoX3Zpc2l0KSB7fVxuXG4gIC8vIEZvcm0gU3VibWlzc2lvbiBEZWxlZ2F0ZVxuXG4gIGZvcm1TdWJtaXNzaW9uU3RhcnRlZChfZm9ybVN1Ym1pc3Npb24pIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDApO1xuICAgIHRoaXMuc2hvd0Zvcm1Qcm9ncmVzc0JhckFmdGVyRGVsYXkoKTtcbiAgfVxuXG4gIGZvcm1TdWJtaXNzaW9uRmluaXNoZWQoX2Zvcm1TdWJtaXNzaW9uKSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5zZXRWYWx1ZSgxKTtcbiAgICB0aGlzLmhpZGVGb3JtUHJvZ3Jlc3NCYXIoKTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBzaG93VmlzaXRQcm9ncmVzc0JhckFmdGVyRGVsYXkoKSB7XG4gICAgdGhpcy52aXNpdFByb2dyZXNzQmFyVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KHRoaXMuc2hvd1Byb2dyZXNzQmFyLCB0aGlzLnNlc3Npb24ucHJvZ3Jlc3NCYXJEZWxheSk7XG4gIH1cblxuICBoaWRlVmlzaXRQcm9ncmVzc0JhcigpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLmhpZGUoKTtcbiAgICBpZiAodGhpcy52aXNpdFByb2dyZXNzQmFyVGltZW91dCAhPSBudWxsKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudmlzaXRQcm9ncmVzc0JhclRpbWVvdXQpO1xuICAgICAgZGVsZXRlIHRoaXMudmlzaXRQcm9ncmVzc0JhclRpbWVvdXQ7XG4gICAgfVxuICB9XG5cbiAgc2hvd0Zvcm1Qcm9ncmVzc0JhckFmdGVyRGVsYXkoKSB7XG4gICAgaWYgKHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dCA9PSBudWxsKSB7XG4gICAgICB0aGlzLmZvcm1Qcm9ncmVzc0JhclRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCh0aGlzLnNob3dQcm9ncmVzc0JhciwgdGhpcy5zZXNzaW9uLnByb2dyZXNzQmFyRGVsYXkpO1xuICAgIH1cbiAgfVxuXG4gIGhpZGVGb3JtUHJvZ3Jlc3NCYXIoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5oaWRlKCk7XG4gICAgaWYgKHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dCAhPSBudWxsKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dCk7XG4gICAgICBkZWxldGUgdGhpcy5mb3JtUHJvZ3Jlc3NCYXJUaW1lb3V0O1xuICAgIH1cbiAgfVxuXG4gIHNob3dQcm9ncmVzc0JhciA9ICgpID0+IHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNob3coKTtcbiAgfVxuXG4gIHJlbG9hZChyZWFzb24pIHtcbiAgICBkaXNwYXRjaChcInR1cmJvOnJlbG9hZFwiLCB7IGRldGFpbDogcmVhc29uIH0pO1xuXG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB0aGlzLmxvY2F0aW9uPy50b1N0cmluZygpIHx8IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICB9XG5cbiAgZ2V0IG5hdmlnYXRvcigpIHtcbiAgICByZXR1cm4gdGhpcy5zZXNzaW9uLm5hdmlnYXRvclxuICB9XG59XG5cbmNsYXNzIENhY2hlT2JzZXJ2ZXIge1xuICBzZWxlY3RvciA9IFwiW2RhdGEtdHVyYm8tdGVtcG9yYXJ5XVwiXG4gIGRlcHJlY2F0ZWRTZWxlY3RvciA9IFwiW2RhdGEtdHVyYm8tY2FjaGU9ZmFsc2VdXCJcblxuICBzdGFydGVkID0gZmFsc2VcblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtY2FjaGVcIiwgdGhpcy5yZW1vdmVUZW1wb3JhcnlFbGVtZW50cywgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWNhY2hlXCIsIHRoaXMucmVtb3ZlVGVtcG9yYXJ5RWxlbWVudHMsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVUZW1wb3JhcnlFbGVtZW50cyA9IChfZXZlbnQpID0+IHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy50ZW1wb3JhcnlFbGVtZW50cykge1xuICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICBnZXQgdGVtcG9yYXJ5RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2VsZWN0b3IpLCAuLi50aGlzLnRlbXBvcmFyeUVsZW1lbnRzV2l0aERlcHJlY2F0aW9uXVxuICB9XG5cbiAgZ2V0IHRlbXBvcmFyeUVsZW1lbnRzV2l0aERlcHJlY2F0aW9uKCkge1xuICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLmRlcHJlY2F0ZWRTZWxlY3Rvcik7XG5cbiAgICBpZiAoZWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBUaGUgJHt0aGlzLmRlcHJlY2F0ZWRTZWxlY3Rvcn0gc2VsZWN0b3IgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24uIFVzZSAke3RoaXMuc2VsZWN0b3J9IGluc3RlYWQuYFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gWy4uLmVsZW1lbnRzXVxuICB9XG59XG5cbmNsYXNzIEZyYW1lUmVkaXJlY3RvciB7XG4gIGNvbnN0cnVjdG9yKHNlc3Npb24sIGVsZW1lbnQpIHtcbiAgICB0aGlzLnNlc3Npb24gPSBzZXNzaW9uO1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5saW5rSW50ZXJjZXB0b3IgPSBuZXcgTGlua0ludGVyY2VwdG9yKHRoaXMsIGVsZW1lbnQpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyID0gbmV3IEZvcm1TdWJtaXRPYnNlcnZlcih0aGlzLCBlbGVtZW50KTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0YXJ0KCk7XG4gICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RvcCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyLnN0b3AoKTtcbiAgfVxuXG4gIC8vIExpbmsgaW50ZXJjZXB0b3IgZGVsZWdhdGVcblxuICBzaG91bGRJbnRlcmNlcHRMaW5rQ2xpY2soZWxlbWVudCwgX2xvY2F0aW9uLCBfZXZlbnQpIHtcbiAgICByZXR1cm4gdGhpcy4jc2hvdWxkUmVkaXJlY3QoZWxlbWVudClcbiAgfVxuXG4gIGxpbmtDbGlja0ludGVyY2VwdGVkKGVsZW1lbnQsIHVybCwgZXZlbnQpIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgaWYgKGZyYW1lKSB7XG4gICAgICBmcmFtZS5kZWxlZ2F0ZS5saW5rQ2xpY2tJbnRlcmNlcHRlZChlbGVtZW50LCB1cmwsIGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pdCBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxTdWJtaXRGb3JtKGVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICAgIHJldHVybiAoXG4gICAgICBlbGVtZW50LmNsb3Nlc3QoXCJ0dXJiby1mcmFtZVwiKSA9PSBudWxsICYmXG4gICAgICB0aGlzLiNzaG91bGRTdWJtaXQoZWxlbWVudCwgc3VibWl0dGVyKSAmJlxuICAgICAgdGhpcy4jc2hvdWxkUmVkaXJlY3QoZWxlbWVudCwgc3VibWl0dGVyKVxuICAgIClcbiAgfVxuXG4gIGZvcm1TdWJtaXR0ZWQoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgaWYgKGZyYW1lKSB7XG4gICAgICBmcmFtZS5kZWxlZ2F0ZS5mb3JtU3VibWl0dGVkKGVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgfVxuICB9XG5cbiAgI3Nob3VsZFN1Ym1pdChmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBhY3Rpb24gPSBnZXRBY3Rpb24kMShmb3JtLCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IG1ldGEgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBtZXRhW25hbWU9XCJ0dXJiby1yb290XCJdYCk7XG4gICAgY29uc3Qgcm9vdExvY2F0aW9uID0gZXhwYW5kVVJMKG1ldGE/LmNvbnRlbnQgPz8gXCIvXCIpO1xuXG4gICAgcmV0dXJuIHRoaXMuI3Nob3VsZFJlZGlyZWN0KGZvcm0sIHN1Ym1pdHRlcikgJiYgbG9jYXRpb25Jc1Zpc2l0YWJsZShhY3Rpb24sIHJvb3RMb2NhdGlvbilcbiAgfVxuXG4gICNzaG91bGRSZWRpcmVjdChlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBpc05hdmlnYXRhYmxlID1cbiAgICAgIGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnRcbiAgICAgICAgPyB0aGlzLnNlc3Npb24uc3VibWlzc2lvbklzTmF2aWdhdGFibGUoZWxlbWVudCwgc3VibWl0dGVyKVxuICAgICAgICA6IHRoaXMuc2Vzc2lvbi5lbGVtZW50SXNOYXZpZ2F0YWJsZShlbGVtZW50KTtcblxuICAgIGlmIChpc05hdmlnYXRhYmxlKSB7XG4gICAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKTtcbiAgICAgIHJldHVybiBmcmFtZSA/IGZyYW1lICE9IGVsZW1lbnQuY2xvc2VzdChcInR1cmJvLWZyYW1lXCIpIDogZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgaWQgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIikgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIpO1xuICAgIGlmIChpZCAmJiBpZCAhPSBcIl90b3BcIikge1xuICAgICAgY29uc3QgZnJhbWUgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aWR9Om5vdChbZGlzYWJsZWRdKWApO1xuICAgICAgaWYgKGZyYW1lIGluc3RhbmNlb2YgRnJhbWVFbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBmcmFtZVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBIaXN0b3J5IHtcbiAgbG9jYXRpb25cbiAgcmVzdG9yYXRpb25JZGVudGlmaWVyID0gdXVpZCgpXG4gIHJlc3RvcmF0aW9uRGF0YSA9IHt9XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuICBwYWdlTG9hZGVkID0gZmFsc2VcbiAgY3VycmVudEluZGV4ID0gMFxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCB0aGlzLm9uUG9wU3RhdGUsIGZhbHNlKTtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIHRoaXMub25QYWdlTG9hZCwgZmFsc2UpO1xuICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBoaXN0b3J5LnN0YXRlPy50dXJibz8ucmVzdG9yYXRpb25JbmRleCB8fCAwO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMucmVwbGFjZShuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKSk7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgdGhpcy5vblBvcFN0YXRlLCBmYWxzZSk7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCB0aGlzLm9uUGFnZUxvYWQsIGZhbHNlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHB1c2gobG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllcikge1xuICAgIHRoaXMudXBkYXRlKGhpc3RvcnkucHVzaFN0YXRlLCBsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyKTtcbiAgfVxuXG4gIHJlcGxhY2UobG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllcikge1xuICAgIHRoaXMudXBkYXRlKGhpc3RvcnkucmVwbGFjZVN0YXRlLCBsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyKTtcbiAgfVxuXG4gIHVwZGF0ZShtZXRob2QsIGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIgPSB1dWlkKCkpIHtcbiAgICBpZiAobWV0aG9kID09PSBoaXN0b3J5LnB1c2hTdGF0ZSkgKyt0aGlzLmN1cnJlbnRJbmRleDtcblxuICAgIGNvbnN0IHN0YXRlID0geyB0dXJibzogeyByZXN0b3JhdGlvbklkZW50aWZpZXIsIHJlc3RvcmF0aW9uSW5kZXg6IHRoaXMuY3VycmVudEluZGV4IH0gfTtcbiAgICBtZXRob2QuY2FsbChoaXN0b3J5LCBzdGF0ZSwgXCJcIiwgbG9jYXRpb24uaHJlZik7XG4gICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgIHRoaXMucmVzdG9yYXRpb25JZGVudGlmaWVyID0gcmVzdG9yYXRpb25JZGVudGlmaWVyO1xuICB9XG5cbiAgLy8gUmVzdG9yYXRpb24gZGF0YVxuXG4gIGdldFJlc3RvcmF0aW9uRGF0YUZvcklkZW50aWZpZXIocmVzdG9yYXRpb25JZGVudGlmaWVyKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzdG9yYXRpb25EYXRhW3Jlc3RvcmF0aW9uSWRlbnRpZmllcl0gfHwge31cbiAgfVxuXG4gIHVwZGF0ZVJlc3RvcmF0aW9uRGF0YShhZGRpdGlvbmFsRGF0YSkge1xuICAgIGNvbnN0IHsgcmVzdG9yYXRpb25JZGVudGlmaWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHJlc3RvcmF0aW9uRGF0YSA9IHRoaXMucmVzdG9yYXRpb25EYXRhW3Jlc3RvcmF0aW9uSWRlbnRpZmllcl07XG4gICAgdGhpcy5yZXN0b3JhdGlvbkRhdGFbcmVzdG9yYXRpb25JZGVudGlmaWVyXSA9IHtcbiAgICAgIC4uLnJlc3RvcmF0aW9uRGF0YSxcbiAgICAgIC4uLmFkZGl0aW9uYWxEYXRhXG4gICAgfTtcbiAgfVxuXG4gIC8vIFNjcm9sbCByZXN0b3JhdGlvblxuXG4gIGFzc3VtZUNvbnRyb2xPZlNjcm9sbFJlc3RvcmF0aW9uKCkge1xuICAgIGlmICghdGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uKSB7XG4gICAgICB0aGlzLnByZXZpb3VzU2Nyb2xsUmVzdG9yYXRpb24gPSBoaXN0b3J5LnNjcm9sbFJlc3RvcmF0aW9uID8/IFwiYXV0b1wiO1xuICAgICAgaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbiA9IFwibWFudWFsXCI7XG4gICAgfVxuICB9XG5cbiAgcmVsaW5xdWlzaENvbnRyb2xPZlNjcm9sbFJlc3RvcmF0aW9uKCkge1xuICAgIGlmICh0aGlzLnByZXZpb3VzU2Nyb2xsUmVzdG9yYXRpb24pIHtcbiAgICAgIGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24gPSB0aGlzLnByZXZpb3VzU2Nyb2xsUmVzdG9yYXRpb247XG4gICAgICBkZWxldGUgdGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uO1xuICAgIH1cbiAgfVxuXG4gIC8vIEV2ZW50IGhhbmRsZXJzXG5cbiAgb25Qb3BTdGF0ZSA9IChldmVudCkgPT4ge1xuICAgIGlmICh0aGlzLnNob3VsZEhhbmRsZVBvcFN0YXRlKCkpIHtcbiAgICAgIGNvbnN0IHsgdHVyYm8gfSA9IGV2ZW50LnN0YXRlIHx8IHt9O1xuICAgICAgaWYgKHR1cmJvKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgY29uc3QgeyByZXN0b3JhdGlvbklkZW50aWZpZXIsIHJlc3RvcmF0aW9uSW5kZXggfSA9IHR1cmJvO1xuICAgICAgICB0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllciA9IHJlc3RvcmF0aW9uSWRlbnRpZmllcjtcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gcmVzdG9yYXRpb25JbmRleCA+IHRoaXMuY3VycmVudEluZGV4ID8gXCJmb3J3YXJkXCIgOiBcImJhY2tcIjtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5UG9wcGVkVG9Mb2NhdGlvbldpdGhSZXN0b3JhdGlvbklkZW50aWZpZXJBbmREaXJlY3Rpb24odGhpcy5sb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCBkaXJlY3Rpb24pO1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IHJlc3RvcmF0aW9uSW5kZXg7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25QYWdlTG9hZCA9IGFzeW5jIChfZXZlbnQpID0+IHtcbiAgICBhd2FpdCBuZXh0TWljcm90YXNrKCk7XG4gICAgdGhpcy5wYWdlTG9hZGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBzaG91bGRIYW5kbGVQb3BTdGF0ZSgpIHtcbiAgICAvLyBTYWZhcmkgZGlzcGF0Y2hlcyBhIHBvcHN0YXRlIGV2ZW50IGFmdGVyIHdpbmRvdydzIGxvYWQgZXZlbnQsIGlnbm9yZSBpdFxuICAgIHJldHVybiB0aGlzLnBhZ2VJc0xvYWRlZCgpXG4gIH1cblxuICBwYWdlSXNMb2FkZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFnZUxvYWRlZCB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09IFwiY29tcGxldGVcIlxuICB9XG59XG5cbmNsYXNzIExpbmtQcmVmZXRjaE9ic2VydmVyIHtcbiAgc3RhcnRlZCA9IGZhbHNlXG4gICNwcmVmZXRjaGVkTGluayA9IG51bGxcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZXZlbnRUYXJnZXQpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5ldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0O1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkgcmV0dXJuXG5cbiAgICBpZiAodGhpcy5ldmVudFRhcmdldC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xuICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCB0aGlzLiNlbmFibGUsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4jZW5hYmxlKCk7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkgcmV0dXJuXG5cbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIHRoaXMuI3RyeVRvUHJlZmV0Y2hSZXF1ZXN0LCB7XG4gICAgICBjYXB0dXJlOiB0cnVlLFxuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgdGhpcy4jY2FuY2VsUmVxdWVzdElmT2Jzb2xldGUsIHtcbiAgICAgIGNhcHR1cmU6IHRydWUsXG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG5cbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtZmV0Y2gtcmVxdWVzdFwiLCB0aGlzLiN0cnlUb1VzZVByZWZldGNoZWRSZXF1ZXN0LCB0cnVlKTtcbiAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgfVxuXG4gICNlbmFibGUgPSAoKSA9PiB7XG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCB0aGlzLiN0cnlUb1ByZWZldGNoUmVxdWVzdCwge1xuICAgICAgY2FwdHVyZTogdHJ1ZSxcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIHRoaXMuI2NhbmNlbFJlcXVlc3RJZk9ic29sZXRlLCB7XG4gICAgICBjYXB0dXJlOiB0cnVlLFxuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlcXVlc3RcIiwgdGhpcy4jdHJ5VG9Vc2VQcmVmZXRjaGVkUmVxdWVzdCwgdHJ1ZSk7XG4gICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgfVxuXG4gICN0cnlUb1ByZWZldGNoUmVxdWVzdCA9IChldmVudCkgPT4ge1xuICAgIGlmIChnZXRNZXRhQ29udGVudChcInR1cmJvLXByZWZldGNoXCIpID09PSBcImZhbHNlXCIpIHJldHVyblxuXG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGlzTGluayA9IHRhcmdldC5tYXRjaGVzICYmIHRhcmdldC5tYXRjaGVzKFwiYVtocmVmXTpub3QoW3RhcmdldF49X10pOm5vdChbZG93bmxvYWRdKVwiKTtcblxuICAgIGlmIChpc0xpbmsgJiYgdGhpcy4jaXNQcmVmZXRjaGFibGUodGFyZ2V0KSkge1xuICAgICAgY29uc3QgbGluayA9IHRhcmdldDtcbiAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb25Gb3JMaW5rKGxpbmspO1xuXG4gICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5jYW5QcmVmZXRjaFJlcXVlc3RUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSkge1xuICAgICAgICB0aGlzLiNwcmVmZXRjaGVkTGluayA9IGxpbms7XG5cbiAgICAgICAgY29uc3QgZmV0Y2hSZXF1ZXN0ID0gbmV3IEZldGNoUmVxdWVzdChcbiAgICAgICAgICB0aGlzLFxuICAgICAgICAgIEZldGNoTWV0aG9kLmdldCxcbiAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICBuZXcgVVJMU2VhcmNoUGFyYW1zKCksXG4gICAgICAgICAgdGFyZ2V0XG4gICAgICAgICk7XG5cbiAgICAgICAgcHJlZmV0Y2hDYWNoZS5zZXRMYXRlcihsb2NhdGlvbi50b1N0cmluZygpLCBmZXRjaFJlcXVlc3QsIHRoaXMuI2NhY2hlVHRsKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAjY2FuY2VsUmVxdWVzdElmT2Jzb2xldGUgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLiNwcmVmZXRjaGVkTGluaykgdGhpcy4jY2FuY2VsUHJlZmV0Y2hSZXF1ZXN0KCk7XG4gIH1cblxuICAjY2FuY2VsUHJlZmV0Y2hSZXF1ZXN0ID0gKCkgPT4ge1xuICAgIHByZWZldGNoQ2FjaGUuY2xlYXIoKTtcbiAgICB0aGlzLiNwcmVmZXRjaGVkTGluayA9IG51bGw7XG4gIH1cblxuICAjdHJ5VG9Vc2VQcmVmZXRjaGVkUmVxdWVzdCA9IChldmVudCkgPT4ge1xuICAgIGlmIChldmVudC50YXJnZXQudGFnTmFtZSAhPT0gXCJGT1JNXCIgJiYgZXZlbnQuZGV0YWlsLmZldGNoT3B0aW9ucy5tZXRob2QgPT09IFwiR0VUXCIpIHtcbiAgICAgIGNvbnN0IGNhY2hlZCA9IHByZWZldGNoQ2FjaGUuZ2V0KGV2ZW50LmRldGFpbC51cmwudG9TdHJpbmcoKSk7XG5cbiAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgLy8gVXNlciBjbGlja2VkIGxpbmssIHVzZSBjYWNoZSByZXNwb25zZVxuICAgICAgICBldmVudC5kZXRhaWwuZmV0Y2hSZXF1ZXN0ID0gY2FjaGVkO1xuICAgICAgfVxuXG4gICAgICBwcmVmZXRjaENhY2hlLmNsZWFyKCk7XG4gICAgfVxuICB9XG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIGNvbnN0IGxpbmsgPSByZXF1ZXN0LnRhcmdldDtcblxuICAgIHJlcXVlc3QuaGVhZGVyc1tcIlgtU2VjLVB1cnBvc2VcIl0gPSBcInByZWZldGNoXCI7XG5cbiAgICBjb25zdCB0dXJib0ZyYW1lID0gbGluay5jbG9zZXN0KFwidHVyYm8tZnJhbWVcIik7XG4gICAgY29uc3QgdHVyYm9GcmFtZVRhcmdldCA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKSB8fCB0dXJib0ZyYW1lPy5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIikgfHwgdHVyYm9GcmFtZT8uaWQ7XG5cbiAgICBpZiAodHVyYm9GcmFtZVRhcmdldCAmJiB0dXJib0ZyYW1lVGFyZ2V0ICE9PSBcIl90b3BcIikge1xuICAgICAgcmVxdWVzdC5oZWFkZXJzW1wiVHVyYm8tRnJhbWVcIl0gPSB0dXJib0ZyYW1lVGFyZ2V0O1xuICAgIH1cbiAgfVxuXG4gIC8vIEZldGNoIHJlcXVlc3QgaW50ZXJmYWNlXG5cbiAgcmVxdWVzdFN1Y2NlZWRlZFdpdGhSZXNwb25zZSgpIHt9XG5cbiAgcmVxdWVzdFN0YXJ0ZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RFcnJvcmVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0RmluaXNoZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICByZXF1ZXN0RmFpbGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICBnZXQgI2NhY2hlVHRsKCkge1xuICAgIHJldHVybiBOdW1iZXIoZ2V0TWV0YUNvbnRlbnQoXCJ0dXJiby1wcmVmZXRjaC1jYWNoZS10aW1lXCIpKSB8fCBjYWNoZVR0bFxuICB9XG5cbiAgI2lzUHJlZmV0Y2hhYmxlKGxpbmspIHtcbiAgICBjb25zdCBocmVmID0gbGluay5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuXG4gICAgaWYgKCFocmVmKSByZXR1cm4gZmFsc2VcblxuICAgIGlmICh1bmZldGNoYWJsZUxpbmsobGluaykpIHJldHVybiBmYWxzZVxuICAgIGlmIChsaW5rVG9UaGVTYW1lUGFnZShsaW5rKSkgcmV0dXJuIGZhbHNlXG4gICAgaWYgKGxpbmtPcHRzT3V0KGxpbmspKSByZXR1cm4gZmFsc2VcbiAgICBpZiAobm9uU2FmZUxpbmsobGluaykpIHJldHVybiBmYWxzZVxuICAgIGlmIChldmVudFByZXZlbnRlZChsaW5rKSkgcmV0dXJuIGZhbHNlXG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59XG5cbmNvbnN0IHVuZmV0Y2hhYmxlTGluayA9IChsaW5rKSA9PiB7XG4gIHJldHVybiBsaW5rLm9yaWdpbiAhPT0gZG9jdW1lbnQubG9jYXRpb24ub3JpZ2luIHx8ICFbXCJodHRwOlwiLCBcImh0dHBzOlwiXS5pbmNsdWRlcyhsaW5rLnByb3RvY29sKSB8fCBsaW5rLmhhc0F0dHJpYnV0ZShcInRhcmdldFwiKVxufTtcblxuY29uc3QgbGlua1RvVGhlU2FtZVBhZ2UgPSAobGluaykgPT4ge1xuICByZXR1cm4gKGxpbmsucGF0aG5hbWUgKyBsaW5rLnNlYXJjaCA9PT0gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgKyBkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2gpIHx8IGxpbmsuaHJlZi5zdGFydHNXaXRoKFwiI1wiKVxufTtcblxuY29uc3QgbGlua09wdHNPdXQgPSAobGluaykgPT4ge1xuICBpZiAobGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXByZWZldGNoXCIpID09PSBcImZhbHNlXCIpIHJldHVybiB0cnVlXG4gIGlmIChsaW5rLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm9cIikgPT09IFwiZmFsc2VcIikgcmV0dXJuIHRydWVcblxuICBjb25zdCB0dXJib1ByZWZldGNoUGFyZW50ID0gZmluZENsb3Nlc3RSZWN1cnNpdmVseShsaW5rLCBcIltkYXRhLXR1cmJvLXByZWZldGNoXVwiKTtcbiAgaWYgKHR1cmJvUHJlZmV0Y2hQYXJlbnQgJiYgdHVyYm9QcmVmZXRjaFBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXByZWZldGNoXCIpID09PSBcImZhbHNlXCIpIHJldHVybiB0cnVlXG5cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG5jb25zdCBub25TYWZlTGluayA9IChsaW5rKSA9PiB7XG4gIGNvbnN0IHR1cmJvTWV0aG9kID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLW1ldGhvZFwiKTtcbiAgaWYgKHR1cmJvTWV0aG9kICYmIHR1cmJvTWV0aG9kLnRvTG93ZXJDYXNlKCkgIT09IFwiZ2V0XCIpIHJldHVybiB0cnVlXG5cbiAgaWYgKGlzVUpTKGxpbmspKSByZXR1cm4gdHJ1ZVxuICBpZiAobGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIikpIHJldHVybiB0cnVlXG4gIGlmIChsaW5rLmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tc3RyZWFtXCIpKSByZXR1cm4gdHJ1ZVxuXG4gIHJldHVybiBmYWxzZVxufTtcblxuY29uc3QgaXNVSlMgPSAobGluaykgPT4ge1xuICByZXR1cm4gbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXJlbW90ZVwiKSB8fCBsaW5rLmhhc0F0dHJpYnV0ZShcImRhdGEtYmVoYXZpb3JcIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLWNvbmZpcm1cIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLW1ldGhvZFwiKVxufTtcblxuY29uc3QgZXZlbnRQcmV2ZW50ZWQgPSAobGluaykgPT4ge1xuICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLXByZWZldGNoXCIsIHsgdGFyZ2V0OiBsaW5rLCBjYW5jZWxhYmxlOiB0cnVlIH0pO1xuICByZXR1cm4gZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxufTtcblxuY2xhc3MgTmF2aWdhdG9yIHtcbiAgY29uc3RydWN0b3IoZGVsZWdhdGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gIH1cblxuICBwcm9wb3NlVmlzaXQobG9jYXRpb24sIG9wdGlvbnMgPSB7fSkge1xuICAgIGlmICh0aGlzLmRlbGVnYXRlLmFsbG93c1Zpc2l0aW5nTG9jYXRpb25XaXRoQWN0aW9uKGxvY2F0aW9uLCBvcHRpb25zLmFjdGlvbikpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRQcm9wb3NlZFRvTG9jYXRpb24obG9jYXRpb24sIG9wdGlvbnMpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXJ0VmlzaXQobG9jYXRhYmxlLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuc3RvcCgpO1xuICAgIHRoaXMuY3VycmVudFZpc2l0ID0gbmV3IFZpc2l0KHRoaXMsIGV4cGFuZFVSTChsb2NhdGFibGUpLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIHtcbiAgICAgIHJlZmVycmVyOiB0aGlzLmxvY2F0aW9uLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH0pO1xuICAgIHRoaXMuY3VycmVudFZpc2l0LnN0YXJ0KCk7XG4gIH1cblxuICBzdWJtaXRGb3JtKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIHRoaXMuc3RvcCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pc3Npb24gPSBuZXcgRm9ybVN1Ym1pc3Npb24odGhpcywgZm9ybSwgc3VibWl0dGVyLCB0cnVlKTtcblxuICAgIHRoaXMuZm9ybVN1Ym1pc3Npb24uc3RhcnQoKTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuZm9ybVN1Ym1pc3Npb24pIHtcbiAgICAgIHRoaXMuZm9ybVN1Ym1pc3Npb24uc3RvcCgpO1xuICAgICAgZGVsZXRlIHRoaXMuZm9ybVN1Ym1pc3Npb247XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY3VycmVudFZpc2l0KSB7XG4gICAgICB0aGlzLmN1cnJlbnRWaXNpdC5jYW5jZWwoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLmN1cnJlbnRWaXNpdDtcbiAgICB9XG4gIH1cblxuICBnZXQgYWRhcHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5hZGFwdGVyXG4gIH1cblxuICBnZXQgdmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS52aWV3XG4gIH1cblxuICBnZXQgcm9vdExvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnZpZXcuc25hcHNob3Qucm9vdExvY2F0aW9uXG4gIH1cblxuICBnZXQgaGlzdG9yeSgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pc3Npb24gZGVsZWdhdGVcblxuICBmb3JtU3VibWlzc2lvblN0YXJ0ZWQoZm9ybVN1Ym1pc3Npb24pIHtcbiAgICAvLyBOb3QgYWxsIGFkYXB0ZXJzIGltcGxlbWVudCBmb3JtU3VibWlzc2lvblN0YXJ0ZWRcbiAgICBpZiAodHlwZW9mIHRoaXMuYWRhcHRlci5mb3JtU3VibWlzc2lvblN0YXJ0ZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5hZGFwdGVyLmZvcm1TdWJtaXNzaW9uU3RhcnRlZChmb3JtU3VibWlzc2lvbik7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICBpZiAoZm9ybVN1Ym1pc3Npb24gPT0gdGhpcy5mb3JtU3VibWlzc2lvbikge1xuICAgICAgY29uc3QgcmVzcG9uc2VIVE1MID0gYXdhaXQgZmV0Y2hSZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgICBpZiAocmVzcG9uc2VIVE1MKSB7XG4gICAgICAgIGNvbnN0IHNob3VsZENhY2hlU25hcHNob3QgPSBmb3JtU3VibWlzc2lvbi5pc1NhZmU7XG4gICAgICAgIGlmICghc2hvdWxkQ2FjaGVTbmFwc2hvdCkge1xuICAgICAgICAgIHRoaXMudmlldy5jbGVhclNuYXBzaG90Q2FjaGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgc3RhdHVzQ29kZSwgcmVkaXJlY3RlZCB9ID0gZmV0Y2hSZXNwb25zZTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy4jZ2V0QWN0aW9uRm9yRm9ybVN1Ym1pc3Npb24oZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpO1xuICAgICAgICBjb25zdCB2aXNpdE9wdGlvbnMgPSB7XG4gICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgIHNob3VsZENhY2hlU25hcHNob3QsXG4gICAgICAgICAgcmVzcG9uc2U6IHsgc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MLCByZWRpcmVjdGVkIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcm9wb3NlVmlzaXQoZmV0Y2hSZXNwb25zZS5sb2NhdGlvbiwgdmlzaXRPcHRpb25zKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBmb3JtU3VibWlzc2lvbkZhaWxlZFdpdGhSZXNwb25zZShmb3JtU3VibWlzc2lvbiwgZmV0Y2hSZXNwb25zZSkge1xuICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IGZldGNoUmVzcG9uc2UucmVzcG9uc2VIVE1MO1xuXG4gICAgaWYgKHJlc3BvbnNlSFRNTCkge1xuICAgICAgY29uc3Qgc25hcHNob3QgPSBQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKTtcbiAgICAgIGlmIChmZXRjaFJlc3BvbnNlLnNlcnZlckVycm9yKSB7XG4gICAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJFcnJvcihzbmFwc2hvdCwgdGhpcy5jdXJyZW50VmlzaXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy52aWV3LnJlbmRlclBhZ2Uoc25hcHNob3QsIGZhbHNlLCB0cnVlLCB0aGlzLmN1cnJlbnRWaXNpdCk7XG4gICAgICB9XG4gICAgICBpZighc25hcHNob3Quc2hvdWxkUHJlc2VydmVTY3JvbGxQb3NpdGlvbikge1xuICAgICAgICB0aGlzLnZpZXcuc2Nyb2xsVG9Ub3AoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudmlldy5jbGVhclNuYXBzaG90Q2FjaGUoKTtcbiAgICB9XG4gIH1cblxuICBmb3JtU3VibWlzc2lvbkVycm9yZWQoZm9ybVN1Ym1pc3Npb24sIGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH1cblxuICBmb3JtU3VibWlzc2lvbkZpbmlzaGVkKGZvcm1TdWJtaXNzaW9uKSB7XG4gICAgLy8gTm90IGFsbCBhZGFwdGVycyBpbXBsZW1lbnQgZm9ybVN1Ym1pc3Npb25GaW5pc2hlZFxuICAgIGlmICh0eXBlb2YgdGhpcy5hZGFwdGVyLmZvcm1TdWJtaXNzaW9uRmluaXNoZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5hZGFwdGVyLmZvcm1TdWJtaXNzaW9uRmluaXNoZWQoZm9ybVN1Ym1pc3Npb24pO1xuICAgIH1cbiAgfVxuXG4gIC8vIFZpc2l0IGRlbGVnYXRlXG5cbiAgdmlzaXRTdGFydGVkKHZpc2l0KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS52aXNpdFN0YXJ0ZWQodmlzaXQpO1xuICB9XG5cbiAgdmlzaXRDb21wbGV0ZWQodmlzaXQpIHtcbiAgICB0aGlzLmRlbGVnYXRlLnZpc2l0Q29tcGxldGVkKHZpc2l0KTtcbiAgICBkZWxldGUgdGhpcy5jdXJyZW50VmlzaXQ7XG4gIH1cblxuICBsb2NhdGlvbldpdGhBY3Rpb25Jc1NhbWVQYWdlKGxvY2F0aW9uLCBhY3Rpb24pIHtcbiAgICBjb25zdCBhbmNob3IgPSBnZXRBbmNob3IobG9jYXRpb24pO1xuICAgIGNvbnN0IGN1cnJlbnRBbmNob3IgPSBnZXRBbmNob3IodGhpcy52aWV3Lmxhc3RSZW5kZXJlZExvY2F0aW9uKTtcbiAgICBjb25zdCBpc1Jlc3RvcmF0aW9uVG9Ub3AgPSBhY3Rpb24gPT09IFwicmVzdG9yZVwiICYmIHR5cGVvZiBhbmNob3IgPT09IFwidW5kZWZpbmVkXCI7XG5cbiAgICByZXR1cm4gKFxuICAgICAgYWN0aW9uICE9PSBcInJlcGxhY2VcIiAmJlxuICAgICAgZ2V0UmVxdWVzdFVSTChsb2NhdGlvbikgPT09IGdldFJlcXVlc3RVUkwodGhpcy52aWV3Lmxhc3RSZW5kZXJlZExvY2F0aW9uKSAmJlxuICAgICAgKGlzUmVzdG9yYXRpb25Ub1RvcCB8fCAoYW5jaG9yICE9IG51bGwgJiYgYW5jaG9yICE9PSBjdXJyZW50QW5jaG9yKSlcbiAgICApXG4gIH1cblxuICB2aXNpdFNjcm9sbGVkVG9TYW1lUGFnZUxvY2F0aW9uKG9sZFVSTCwgbmV3VVJMKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS52aXNpdFNjcm9sbGVkVG9TYW1lUGFnZUxvY2F0aW9uKG9sZFVSTCwgbmV3VVJMKTtcbiAgfVxuXG4gIC8vIFZpc2l0c1xuXG4gIGdldCBsb2NhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5oaXN0b3J5LmxvY2F0aW9uXG4gIH1cblxuICBnZXQgcmVzdG9yYXRpb25JZGVudGlmaWVyKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkucmVzdG9yYXRpb25JZGVudGlmaWVyXG4gIH1cblxuICAjZ2V0QWN0aW9uRm9yRm9ybVN1Ym1pc3Npb24oZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICBjb25zdCB7IHN1Ym1pdHRlciwgZm9ybUVsZW1lbnQgfSA9IGZvcm1TdWJtaXNzaW9uO1xuICAgIHJldHVybiBnZXRWaXNpdEFjdGlvbihzdWJtaXR0ZXIsIGZvcm1FbGVtZW50KSB8fCB0aGlzLiNnZXREZWZhdWx0QWN0aW9uKGZldGNoUmVzcG9uc2UpXG4gIH1cblxuICAjZ2V0RGVmYXVsdEFjdGlvbihmZXRjaFJlc3BvbnNlKSB7XG4gICAgY29uc3Qgc2FtZUxvY2F0aW9uUmVkaXJlY3QgPSBmZXRjaFJlc3BvbnNlLnJlZGlyZWN0ZWQgJiYgZmV0Y2hSZXNwb25zZS5sb2NhdGlvbi5ocmVmID09PSB0aGlzLmxvY2F0aW9uPy5ocmVmO1xuICAgIHJldHVybiBzYW1lTG9jYXRpb25SZWRpcmVjdCA/IFwicmVwbGFjZVwiIDogXCJhZHZhbmNlXCJcbiAgfVxufVxuXG5jb25zdCBQYWdlU3RhZ2UgPSB7XG4gIGluaXRpYWw6IDAsXG4gIGxvYWRpbmc6IDEsXG4gIGludGVyYWN0aXZlOiAyLFxuICBjb21wbGV0ZTogM1xufTtcblxuY2xhc3MgUGFnZU9ic2VydmVyIHtcbiAgc3RhZ2UgPSBQYWdlU3RhZ2UuaW5pdGlhbFxuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICBpZiAodGhpcy5zdGFnZSA9PSBQYWdlU3RhZ2UuaW5pdGlhbCkge1xuICAgICAgICB0aGlzLnN0YWdlID0gUGFnZVN0YWdlLmxvYWRpbmc7XG4gICAgICB9XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLCB0aGlzLmludGVycHJldFJlYWR5U3RhdGUsIGZhbHNlKTtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJwYWdlaGlkZVwiLCB0aGlzLnBhZ2VXaWxsVW5sb2FkLCBmYWxzZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlYWR5c3RhdGVjaGFuZ2VcIiwgdGhpcy5pbnRlcnByZXRSZWFkeVN0YXRlLCBmYWxzZSk7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5wYWdlV2lsbFVubG9hZCwgZmFsc2UpO1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaW50ZXJwcmV0UmVhZHlTdGF0ZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHJlYWR5U3RhdGUgfSA9IHRoaXM7XG4gICAgaWYgKHJlYWR5U3RhdGUgPT0gXCJpbnRlcmFjdGl2ZVwiKSB7XG4gICAgICB0aGlzLnBhZ2VJc0ludGVyYWN0aXZlKCk7XG4gICAgfSBlbHNlIGlmIChyZWFkeVN0YXRlID09IFwiY29tcGxldGVcIikge1xuICAgICAgdGhpcy5wYWdlSXNDb21wbGV0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIHBhZ2VJc0ludGVyYWN0aXZlKCkge1xuICAgIGlmICh0aGlzLnN0YWdlID09IFBhZ2VTdGFnZS5sb2FkaW5nKSB7XG4gICAgICB0aGlzLnN0YWdlID0gUGFnZVN0YWdlLmludGVyYWN0aXZlO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5wYWdlQmVjYW1lSW50ZXJhY3RpdmUoKTtcbiAgICB9XG4gIH1cblxuICBwYWdlSXNDb21wbGV0ZSgpIHtcbiAgICB0aGlzLnBhZ2VJc0ludGVyYWN0aXZlKCk7XG4gICAgaWYgKHRoaXMuc3RhZ2UgPT0gUGFnZVN0YWdlLmludGVyYWN0aXZlKSB7XG4gICAgICB0aGlzLnN0YWdlID0gUGFnZVN0YWdlLmNvbXBsZXRlO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5wYWdlTG9hZGVkKCk7XG4gICAgfVxuICB9XG5cbiAgcGFnZVdpbGxVbmxvYWQgPSAoKSA9PiB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5wYWdlV2lsbFVubG9hZCgpO1xuICB9XG5cbiAgZ2V0IHJlYWR5U3RhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnJlYWR5U3RhdGVcbiAgfVxufVxuXG5jbGFzcyBTY3JvbGxPYnNlcnZlciB7XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgdGhpcy5vblNjcm9sbCwgZmFsc2UpO1xuICAgICAgdGhpcy5vblNjcm9sbCgpO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgdGhpcy5vblNjcm9sbCwgZmFsc2UpO1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgb25TY3JvbGwgPSAoKSA9PiB7XG4gICAgdGhpcy51cGRhdGVQb3NpdGlvbih7IHg6IHdpbmRvdy5wYWdlWE9mZnNldCwgeTogd2luZG93LnBhZ2VZT2Zmc2V0IH0pO1xuICB9XG5cbiAgLy8gUHJpdmF0ZVxuXG4gIHVwZGF0ZVBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5zY3JvbGxQb3NpdGlvbkNoYW5nZWQocG9zaXRpb24pO1xuICB9XG59XG5cbmNsYXNzIFN0cmVhbU1lc3NhZ2VSZW5kZXJlciB7XG4gIHJlbmRlcih7IGZyYWdtZW50IH0pIHtcbiAgICBCYXJkby5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHModGhpcywgZ2V0UGVybWFuZW50RWxlbWVudE1hcEZvckZyYWdtZW50KGZyYWdtZW50KSwgKCkgPT4ge1xuICAgICAgd2l0aEF1dG9mb2N1c0Zyb21GcmFnbWVudChmcmFnbWVudCwgKCkgPT4ge1xuICAgICAgICB3aXRoUHJlc2VydmVkRm9jdXMoKCkgPT4ge1xuICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBCYXJkbyBkZWxlZ2F0ZVxuXG4gIGVudGVyaW5nQmFyZG8oY3VycmVudFBlcm1hbmVudEVsZW1lbnQsIG5ld1Blcm1hbmVudEVsZW1lbnQpIHtcbiAgICBuZXdQZXJtYW5lbnRFbGVtZW50LnJlcGxhY2VXaXRoKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LmNsb25lTm9kZSh0cnVlKSk7XG4gIH1cblxuICBsZWF2aW5nQmFyZG8oKSB7fVxufVxuXG5mdW5jdGlvbiBnZXRQZXJtYW5lbnRFbGVtZW50TWFwRm9yRnJhZ21lbnQoZnJhZ21lbnQpIHtcbiAgY29uc3QgcGVybWFuZW50RWxlbWVudHNJbkRvY3VtZW50ID0gcXVlcnlQZXJtYW5lbnRFbGVtZW50c0FsbChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuICBjb25zdCBwZXJtYW5lbnRFbGVtZW50TWFwID0ge307XG4gIGZvciAoY29uc3QgcGVybWFuZW50RWxlbWVudEluRG9jdW1lbnQgb2YgcGVybWFuZW50RWxlbWVudHNJbkRvY3VtZW50KSB7XG4gICAgY29uc3QgeyBpZCB9ID0gcGVybWFuZW50RWxlbWVudEluRG9jdW1lbnQ7XG5cbiAgICBmb3IgKGNvbnN0IHN0cmVhbUVsZW1lbnQgb2YgZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbChcInR1cmJvLXN0cmVhbVwiKSkge1xuICAgICAgY29uc3QgZWxlbWVudEluU3RyZWFtID0gZ2V0UGVybWFuZW50RWxlbWVudEJ5SWQoc3RyZWFtRWxlbWVudC50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCwgaWQpO1xuXG4gICAgICBpZiAoZWxlbWVudEluU3RyZWFtKSB7XG4gICAgICAgIHBlcm1hbmVudEVsZW1lbnRNYXBbaWRdID0gW3Blcm1hbmVudEVsZW1lbnRJbkRvY3VtZW50LCBlbGVtZW50SW5TdHJlYW1dO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwZXJtYW5lbnRFbGVtZW50TWFwXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHdpdGhBdXRvZm9jdXNGcm9tRnJhZ21lbnQoZnJhZ21lbnQsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGdlbmVyYXRlZElEID0gYHR1cmJvLXN0cmVhbS1hdXRvZm9jdXMtJHt1dWlkKCl9YDtcbiAgY29uc3QgdHVyYm9TdHJlYW1zID0gZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbChcInR1cmJvLXN0cmVhbVwiKTtcbiAgY29uc3QgZWxlbWVudFdpdGhBdXRvZm9jdXMgPSBmaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50SW5TdHJlYW1zKHR1cmJvU3RyZWFtcyk7XG4gIGxldCB3aWxsQXV0b2ZvY3VzSWQgPSBudWxsO1xuXG4gIGlmIChlbGVtZW50V2l0aEF1dG9mb2N1cykge1xuICAgIGlmIChlbGVtZW50V2l0aEF1dG9mb2N1cy5pZCkge1xuICAgICAgd2lsbEF1dG9mb2N1c0lkID0gZWxlbWVudFdpdGhBdXRvZm9jdXMuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbGxBdXRvZm9jdXNJZCA9IGdlbmVyYXRlZElEO1xuICAgIH1cblxuICAgIGVsZW1lbnRXaXRoQXV0b2ZvY3VzLmlkID0gd2lsbEF1dG9mb2N1c0lkO1xuICB9XG5cbiAgY2FsbGJhY2soKTtcbiAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcblxuICBjb25zdCBoYXNOb0FjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09IG51bGwgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PSBkb2N1bWVudC5ib2R5O1xuXG4gIGlmIChoYXNOb0FjdGl2ZUVsZW1lbnQgJiYgd2lsbEF1dG9mb2N1c0lkKSB7XG4gICAgY29uc3QgZWxlbWVudFRvQXV0b2ZvY3VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQod2lsbEF1dG9mb2N1c0lkKTtcblxuICAgIGlmIChlbGVtZW50SXNGb2N1c2FibGUoZWxlbWVudFRvQXV0b2ZvY3VzKSkge1xuICAgICAgZWxlbWVudFRvQXV0b2ZvY3VzLmZvY3VzKCk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50VG9BdXRvZm9jdXMgJiYgZWxlbWVudFRvQXV0b2ZvY3VzLmlkID09IGdlbmVyYXRlZElEKSB7XG4gICAgICBlbGVtZW50VG9BdXRvZm9jdXMucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XG4gICAgfVxuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHdpdGhQcmVzZXJ2ZWRGb2N1cyhjYWxsYmFjaykge1xuICBjb25zdCBbYWN0aXZlRWxlbWVudEJlZm9yZVJlbmRlciwgYWN0aXZlRWxlbWVudEFmdGVyUmVuZGVyXSA9IGF3YWl0IGFyb3VuZChjYWxsYmFjaywgKCkgPT4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7XG5cbiAgY29uc3QgcmVzdG9yZUZvY3VzVG8gPSBhY3RpdmVFbGVtZW50QmVmb3JlUmVuZGVyICYmIGFjdGl2ZUVsZW1lbnRCZWZvcmVSZW5kZXIuaWQ7XG5cbiAgaWYgKHJlc3RvcmVGb2N1c1RvKSB7XG4gICAgY29uc3QgZWxlbWVudFRvRm9jdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXN0b3JlRm9jdXNUbyk7XG5cbiAgICBpZiAoZWxlbWVudElzRm9jdXNhYmxlKGVsZW1lbnRUb0ZvY3VzKSAmJiBlbGVtZW50VG9Gb2N1cyAhPSBhY3RpdmVFbGVtZW50QWZ0ZXJSZW5kZXIpIHtcbiAgICAgIGVsZW1lbnRUb0ZvY3VzLmZvY3VzKCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnRJblN0cmVhbXMobm9kZUxpc3RPZlN0cmVhbUVsZW1lbnRzKSB7XG4gIGZvciAoY29uc3Qgc3RyZWFtRWxlbWVudCBvZiBub2RlTGlzdE9mU3RyZWFtRWxlbWVudHMpIHtcbiAgICBjb25zdCBlbGVtZW50V2l0aEF1dG9mb2N1cyA9IHF1ZXJ5QXV0b2ZvY3VzYWJsZUVsZW1lbnQoc3RyZWFtRWxlbWVudC50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCk7XG5cbiAgICBpZiAoZWxlbWVudFdpdGhBdXRvZm9jdXMpIHJldHVybiBlbGVtZW50V2l0aEF1dG9mb2N1c1xuICB9XG5cbiAgcmV0dXJuIG51bGxcbn1cblxuY2xhc3MgU3RyZWFtT2JzZXJ2ZXIge1xuICBzb3VyY2VzID0gbmV3IFNldCgpXG4gICNzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy4jc3RhcnRlZCkge1xuICAgICAgdGhpcy4jc3RhcnRlZCA9IHRydWU7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlc3BvbnNlXCIsIHRoaXMuaW5zcGVjdEZldGNoUmVzcG9uc2UsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLiNzdGFydGVkKSB7XG4gICAgICB0aGlzLiNzdGFydGVkID0gZmFsc2U7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlc3BvbnNlXCIsIHRoaXMuaW5zcGVjdEZldGNoUmVzcG9uc2UsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSkge1xuICAgIGlmICghdGhpcy5zdHJlYW1Tb3VyY2VJc0Nvbm5lY3RlZChzb3VyY2UpKSB7XG4gICAgICB0aGlzLnNvdXJjZXMuYWRkKHNvdXJjZSk7XG4gICAgICBzb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5yZWNlaXZlTWVzc2FnZUV2ZW50LCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgZGlzY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5zdHJlYW1Tb3VyY2VJc0Nvbm5lY3RlZChzb3VyY2UpKSB7XG4gICAgICB0aGlzLnNvdXJjZXMuZGVsZXRlKHNvdXJjZSk7XG4gICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5yZWNlaXZlTWVzc2FnZUV2ZW50LCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgc3RyZWFtU291cmNlSXNDb25uZWN0ZWQoc291cmNlKSB7XG4gICAgcmV0dXJuIHRoaXMuc291cmNlcy5oYXMoc291cmNlKVxuICB9XG5cbiAgaW5zcGVjdEZldGNoUmVzcG9uc2UgPSAoZXZlbnQpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGZldGNoUmVzcG9uc2VGcm9tRXZlbnQoZXZlbnQpO1xuICAgIGlmIChyZXNwb25zZSAmJiBmZXRjaFJlc3BvbnNlSXNTdHJlYW0ocmVzcG9uc2UpKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB9XG4gIH1cblxuICByZWNlaXZlTWVzc2FnZUV2ZW50ID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKHRoaXMuI3N0YXJ0ZWQgJiYgdHlwZW9mIGV2ZW50LmRhdGEgPT0gXCJzdHJpbmdcIikge1xuICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZUhUTUwoZXZlbnQuZGF0YSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVjZWl2ZU1lc3NhZ2VSZXNwb25zZShyZXNwb25zZSkge1xuICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgaWYgKGh0bWwpIHtcbiAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VIVE1MKGh0bWwpO1xuICAgIH1cbiAgfVxuXG4gIHJlY2VpdmVNZXNzYWdlSFRNTChodG1sKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5yZWNlaXZlZE1lc3NhZ2VGcm9tU3RyZWFtKFN0cmVhbU1lc3NhZ2Uud3JhcChodG1sKSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmV0Y2hSZXNwb25zZUZyb21FdmVudChldmVudCkge1xuICBjb25zdCBmZXRjaFJlc3BvbnNlID0gZXZlbnQuZGV0YWlsPy5mZXRjaFJlc3BvbnNlO1xuICBpZiAoZmV0Y2hSZXNwb25zZSBpbnN0YW5jZW9mIEZldGNoUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZmV0Y2hSZXNwb25zZVxuICB9XG59XG5cbmZ1bmN0aW9uIGZldGNoUmVzcG9uc2VJc1N0cmVhbShyZXNwb25zZSkge1xuICBjb25zdCBjb250ZW50VHlwZSA9IHJlc3BvbnNlLmNvbnRlbnRUeXBlID8/IFwiXCI7XG4gIHJldHVybiBjb250ZW50VHlwZS5zdGFydHNXaXRoKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpXG59XG5cbmNsYXNzIEVycm9yUmVuZGVyZXIgZXh0ZW5kcyBSZW5kZXJlciB7XG4gIHN0YXRpYyByZW5kZXJFbGVtZW50KGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSB7XG4gICAgY29uc3QgeyBkb2N1bWVudEVsZW1lbnQsIGJvZHkgfSA9IGRvY3VtZW50O1xuXG4gICAgZG9jdW1lbnRFbGVtZW50LnJlcGxhY2VDaGlsZChuZXdFbGVtZW50LCBib2R5KTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpIHtcbiAgICB0aGlzLnJlcGxhY2VIZWFkQW5kQm9keSgpO1xuICAgIHRoaXMuYWN0aXZhdGVTY3JpcHRFbGVtZW50cygpO1xuICB9XG5cbiAgcmVwbGFjZUhlYWRBbmRCb2R5KCkge1xuICAgIGNvbnN0IHsgZG9jdW1lbnRFbGVtZW50LCBoZWFkIH0gPSBkb2N1bWVudDtcbiAgICBkb2N1bWVudEVsZW1lbnQucmVwbGFjZUNoaWxkKHRoaXMubmV3SGVhZCwgaGVhZCk7XG4gICAgdGhpcy5yZW5kZXJFbGVtZW50KHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gIH1cblxuICBhY3RpdmF0ZVNjcmlwdEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgcmVwbGFjZWFibGVFbGVtZW50IG9mIHRoaXMuc2NyaXB0RWxlbWVudHMpIHtcbiAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSByZXBsYWNlYWJsZUVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICAgIGlmIChwYXJlbnROb2RlKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBhY3RpdmF0ZVNjcmlwdEVsZW1lbnQocmVwbGFjZWFibGVFbGVtZW50KTtcbiAgICAgICAgcGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZWxlbWVudCwgcmVwbGFjZWFibGVFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXQgbmV3SGVhZCgpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5oZWFkU25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgZ2V0IHNjcmlwdEVsZW1lbnRzKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcInNjcmlwdFwiKVxuICB9XG59XG5cbmNsYXNzIFBhZ2VSZW5kZXJlciBleHRlbmRzIFJlbmRlcmVyIHtcbiAgc3RhdGljIHJlbmRlckVsZW1lbnQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgICBpZiAoZG9jdW1lbnQuYm9keSAmJiBuZXdFbGVtZW50IGluc3RhbmNlb2YgSFRNTEJvZHlFbGVtZW50KSB7XG4gICAgICBkb2N1bWVudC5ib2R5LnJlcGxhY2VXaXRoKG5ld0VsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNob3VsZFJlbmRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5pc1Zpc2l0YWJsZSAmJiB0aGlzLnRyYWNrZWRFbGVtZW50c0FyZUlkZW50aWNhbFxuICB9XG5cbiAgZ2V0IHJlbG9hZFJlYXNvbigpIHtcbiAgICBpZiAoIXRoaXMubmV3U25hcHNob3QuaXNWaXNpdGFibGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlYXNvbjogXCJ0dXJib192aXNpdF9jb250cm9sX2lzX3JlbG9hZFwiXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnRyYWNrZWRFbGVtZW50c0FyZUlkZW50aWNhbCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVhc29uOiBcInRyYWNrZWRfZWxlbWVudF9taXNtYXRjaFwiXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJlcGFyZVRvUmVuZGVyKCkge1xuICAgIHRoaXMuI3NldExhbmd1YWdlKCk7XG4gICAgYXdhaXQgdGhpcy5tZXJnZUhlYWQoKTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpIHtcbiAgICBpZiAodGhpcy53aWxsUmVuZGVyKSB7XG4gICAgICBhd2FpdCB0aGlzLnJlcGxhY2VCb2R5KCk7XG4gICAgfVxuICB9XG5cbiAgZmluaXNoUmVuZGVyaW5nKCkge1xuICAgIHN1cGVyLmZpbmlzaFJlbmRlcmluZygpO1xuICAgIGlmICghdGhpcy5pc1ByZXZpZXcpIHtcbiAgICAgIHRoaXMuZm9jdXNGaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50KCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGN1cnJlbnRIZWFkU25hcHNob3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFNuYXBzaG90LmhlYWRTbmFwc2hvdFxuICB9XG5cbiAgZ2V0IG5ld0hlYWRTbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5oZWFkU25hcHNob3RcbiAgfVxuXG4gIGdldCBuZXdFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLm5ld1NuYXBzaG90LmVsZW1lbnRcbiAgfVxuXG4gICNzZXRMYW5ndWFnZSgpIHtcbiAgICBjb25zdCB7IGRvY3VtZW50RWxlbWVudCB9ID0gdGhpcy5jdXJyZW50U25hcHNob3Q7XG4gICAgY29uc3QgeyBsYW5nIH0gPSB0aGlzLm5ld1NuYXBzaG90O1xuXG4gICAgaWYgKGxhbmcpIHtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJsYW5nXCIsIGxhbmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwibGFuZ1wiKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBtZXJnZUhlYWQoKSB7XG4gICAgY29uc3QgbWVyZ2VkSGVhZEVsZW1lbnRzID0gdGhpcy5tZXJnZVByb3Zpc2lvbmFsRWxlbWVudHMoKTtcbiAgICBjb25zdCBuZXdTdHlsZXNoZWV0RWxlbWVudHMgPSB0aGlzLmNvcHlOZXdIZWFkU3R5bGVzaGVldEVsZW1lbnRzKCk7XG4gICAgdGhpcy5jb3B5TmV3SGVhZFNjcmlwdEVsZW1lbnRzKCk7XG5cbiAgICBhd2FpdCBtZXJnZWRIZWFkRWxlbWVudHM7XG4gICAgYXdhaXQgbmV3U3R5bGVzaGVldEVsZW1lbnRzO1xuXG4gICAgaWYgKHRoaXMud2lsbFJlbmRlcikge1xuICAgICAgdGhpcy5yZW1vdmVVbnVzZWREeW5hbWljU3R5bGVzaGVldEVsZW1lbnRzKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVwbGFjZUJvZHkoKSB7XG4gICAgYXdhaXQgdGhpcy5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoYXN5bmMgKCkgPT4ge1xuICAgICAgdGhpcy5hY3RpdmF0ZU5ld0JvZHkoKTtcbiAgICAgIGF3YWl0IHRoaXMuYXNzaWduTmV3Qm9keSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0IHRyYWNrZWRFbGVtZW50c0FyZUlkZW50aWNhbCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50SGVhZFNuYXBzaG90LnRyYWNrZWRFbGVtZW50U2lnbmF0dXJlID09IHRoaXMubmV3SGVhZFNuYXBzaG90LnRyYWNrZWRFbGVtZW50U2lnbmF0dXJlXG4gIH1cblxuICBhc3luYyBjb3B5TmV3SGVhZFN0eWxlc2hlZXRFbGVtZW50cygpIHtcbiAgICBjb25zdCBsb2FkaW5nRWxlbWVudHMgPSBbXTtcblxuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm5ld0hlYWRTdHlsZXNoZWV0RWxlbWVudHMpIHtcbiAgICAgIGxvYWRpbmdFbGVtZW50cy5wdXNoKHdhaXRGb3JMb2FkKGVsZW1lbnQpKTtcblxuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICB9XG5cbiAgICBhd2FpdCBQcm9taXNlLmFsbChsb2FkaW5nRWxlbWVudHMpO1xuICB9XG5cbiAgY29weU5ld0hlYWRTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5uZXdIZWFkU2NyaXB0RWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoYWN0aXZhdGVTY3JpcHRFbGVtZW50KGVsZW1lbnQpKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVVbnVzZWREeW5hbWljU3R5bGVzaGVldEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLnVudXNlZER5bmFtaWNTdHlsZXNoZWV0RWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbWVyZ2VQcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIGNvbnN0IG5ld0hlYWRFbGVtZW50cyA9IFsuLi50aGlzLm5ld0hlYWRQcm92aXNpb25hbEVsZW1lbnRzXTtcblxuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLmN1cnJlbnRIZWFkUHJvdmlzaW9uYWxFbGVtZW50cykge1xuICAgICAgaWYgKCF0aGlzLmlzQ3VycmVudEVsZW1lbnRJbkVsZW1lbnRMaXN0KGVsZW1lbnQsIG5ld0hlYWRFbGVtZW50cykpIHtcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgbmV3SGVhZEVsZW1lbnRzKSB7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGlzQ3VycmVudEVsZW1lbnRJbkVsZW1lbnRMaXN0KGVsZW1lbnQsIGVsZW1lbnRMaXN0KSB7XG4gICAgZm9yIChjb25zdCBbaW5kZXgsIG5ld0VsZW1lbnRdIG9mIGVsZW1lbnRMaXN0LmVudHJpZXMoKSkge1xuICAgICAgLy8gaWYgdGl0bGUgZWxlbWVudC4uLlxuICAgICAgaWYgKGVsZW1lbnQudGFnTmFtZSA9PSBcIlRJVExFXCIpIHtcbiAgICAgICAgaWYgKG5ld0VsZW1lbnQudGFnTmFtZSAhPSBcIlRJVExFXCIpIHtcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtZW50LmlubmVySFRNTCA9PSBuZXdFbGVtZW50LmlubmVySFRNTCkge1xuICAgICAgICAgIGVsZW1lbnRMaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBpZiBhbnkgb3RoZXIgZWxlbWVudC4uLlxuICAgICAgaWYgKG5ld0VsZW1lbnQuaXNFcXVhbE5vZGUoZWxlbWVudCkpIHtcbiAgICAgICAgZWxlbWVudExpc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJlbW92ZUN1cnJlbnRIZWFkUHJvdmlzaW9uYWxFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5jdXJyZW50SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgY29weU5ld0hlYWRQcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm5ld0hlYWRQcm92aXNpb25hbEVsZW1lbnRzKSB7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGFjdGl2YXRlTmV3Qm9keSgpIHtcbiAgICBkb2N1bWVudC5hZG9wdE5vZGUodGhpcy5uZXdFbGVtZW50KTtcbiAgICB0aGlzLmFjdGl2YXRlTmV3Qm9keVNjcmlwdEVsZW1lbnRzKCk7XG4gIH1cblxuICBhY3RpdmF0ZU5ld0JvZHlTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiB0aGlzLm5ld0JvZHlTY3JpcHRFbGVtZW50cykge1xuICAgICAgY29uc3QgYWN0aXZhdGVkU2NyaXB0RWxlbWVudCA9IGFjdGl2YXRlU2NyaXB0RWxlbWVudChpbmVydFNjcmlwdEVsZW1lbnQpO1xuICAgICAgaW5lcnRTY3JpcHRFbGVtZW50LnJlcGxhY2VXaXRoKGFjdGl2YXRlZFNjcmlwdEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGFzc2lnbk5ld0JvZHkoKSB7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXJFbGVtZW50KHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gIH1cblxuICBnZXQgdW51c2VkRHluYW1pY1N0eWxlc2hlZXRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5vbGRIZWFkU3R5bGVzaGVldEVsZW1lbnRzLmZpbHRlcigoZWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby10cmFja1wiKSA9PT0gXCJkeW5hbWljXCJcbiAgICB9KVxuICB9XG5cbiAgZ2V0IG9sZEhlYWRTdHlsZXNoZWV0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWRTbmFwc2hvdC5nZXRTdHlsZXNoZWV0RWxlbWVudHNOb3RJblNuYXBzaG90KHRoaXMubmV3SGVhZFNuYXBzaG90KVxuICB9XG5cbiAgZ2V0IG5ld0hlYWRTdHlsZXNoZWV0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3SGVhZFNuYXBzaG90LmdldFN0eWxlc2hlZXRFbGVtZW50c05vdEluU25hcHNob3QodGhpcy5jdXJyZW50SGVhZFNuYXBzaG90KVxuICB9XG5cbiAgZ2V0IG5ld0hlYWRTY3JpcHRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdIZWFkU25hcHNob3QuZ2V0U2NyaXB0RWxlbWVudHNOb3RJblNuYXBzaG90KHRoaXMuY3VycmVudEhlYWRTbmFwc2hvdClcbiAgfVxuXG4gIGdldCBjdXJyZW50SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWRTbmFwc2hvdC5wcm92aXNpb25hbEVsZW1lbnRzXG4gIH1cblxuICBnZXQgbmV3SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3SGVhZFNuYXBzaG90LnByb3Zpc2lvbmFsRWxlbWVudHNcbiAgfVxuXG4gIGdldCBuZXdCb2R5U2NyaXB0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2NyaXB0XCIpXG4gIH1cbn1cblxuY2xhc3MgTW9ycGhpbmdQYWdlUmVuZGVyZXIgZXh0ZW5kcyBQYWdlUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIG1vcnBoRWxlbWVudHMoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQsIHtcbiAgICAgIGNhbGxiYWNrczoge1xuICAgICAgICBiZWZvcmVOb2RlTW9ycGhlZDogZWxlbWVudCA9PiAhY2FuUmVmcmVzaEZyYW1lKGVsZW1lbnQpXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBmb3IgKGNvbnN0IGZyYW1lIG9mIGN1cnJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0dXJiby1mcmFtZVwiKSkge1xuICAgICAgaWYgKGNhblJlZnJlc2hGcmFtZShmcmFtZSkpIGZyYW1lLnJlbG9hZCgpO1xuICAgIH1cblxuICAgIGRpc3BhdGNoKFwidHVyYm86bW9ycGhcIiwgeyBkZXRhaWw6IHsgY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQgfSB9KTtcbiAgfVxuXG4gIGFzeW5jIHByZXNlcnZpbmdQZXJtYW5lbnRFbGVtZW50cyhjYWxsYmFjaykge1xuICAgIHJldHVybiBhd2FpdCBjYWxsYmFjaygpXG4gIH1cblxuICBnZXQgcmVuZGVyTWV0aG9kKCkge1xuICAgIHJldHVybiBcIm1vcnBoXCJcbiAgfVxuXG4gIGdldCBzaG91bGRBdXRvZm9jdXMoKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24gY2FuUmVmcmVzaEZyYW1lKGZyYW1lKSB7XG4gIHJldHVybiBmcmFtZSBpbnN0YW5jZW9mIEZyYW1lRWxlbWVudCAmJlxuICAgIGZyYW1lLnNyYyAmJlxuICAgIGZyYW1lLnJlZnJlc2ggPT09IFwibW9ycGhcIiAmJlxuICAgICFmcmFtZS5jbG9zZXN0KFwiW2RhdGEtdHVyYm8tcGVybWFuZW50XVwiKVxufVxuXG5jbGFzcyBTbmFwc2hvdENhY2hlIHtcbiAga2V5cyA9IFtdXG4gIHNuYXBzaG90cyA9IHt9XG5cbiAgY29uc3RydWN0b3Ioc2l6ZSkge1xuICAgIHRoaXMuc2l6ZSA9IHNpemU7XG4gIH1cblxuICBoYXMobG9jYXRpb24pIHtcbiAgICByZXR1cm4gdG9DYWNoZUtleShsb2NhdGlvbikgaW4gdGhpcy5zbmFwc2hvdHNcbiAgfVxuXG4gIGdldChsb2NhdGlvbikge1xuICAgIGlmICh0aGlzLmhhcyhsb2NhdGlvbikpIHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy5yZWFkKGxvY2F0aW9uKTtcbiAgICAgIHRoaXMudG91Y2gobG9jYXRpb24pO1xuICAgICAgcmV0dXJuIHNuYXBzaG90XG4gICAgfVxuICB9XG5cbiAgcHV0KGxvY2F0aW9uLCBzbmFwc2hvdCkge1xuICAgIHRoaXMud3JpdGUobG9jYXRpb24sIHNuYXBzaG90KTtcbiAgICB0aGlzLnRvdWNoKGxvY2F0aW9uKTtcbiAgICByZXR1cm4gc25hcHNob3RcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuc25hcHNob3RzID0ge307XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgcmVhZChsb2NhdGlvbikge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90c1t0b0NhY2hlS2V5KGxvY2F0aW9uKV1cbiAgfVxuXG4gIHdyaXRlKGxvY2F0aW9uLCBzbmFwc2hvdCkge1xuICAgIHRoaXMuc25hcHNob3RzW3RvQ2FjaGVLZXkobG9jYXRpb24pXSA9IHNuYXBzaG90O1xuICB9XG5cbiAgdG91Y2gobG9jYXRpb24pIHtcbiAgICBjb25zdCBrZXkgPSB0b0NhY2hlS2V5KGxvY2F0aW9uKTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMua2V5cy5pbmRleE9mKGtleSk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHRoaXMua2V5cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIHRoaXMua2V5cy51bnNoaWZ0KGtleSk7XG4gICAgdGhpcy50cmltKCk7XG4gIH1cblxuICB0cmltKCkge1xuICAgIGZvciAoY29uc3Qga2V5IG9mIHRoaXMua2V5cy5zcGxpY2UodGhpcy5zaXplKSkge1xuICAgICAgZGVsZXRlIHRoaXMuc25hcHNob3RzW2tleV07XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFBhZ2VWaWV3IGV4dGVuZHMgVmlldyB7XG4gIHNuYXBzaG90Q2FjaGUgPSBuZXcgU25hcHNob3RDYWNoZSgxMClcbiAgbGFzdFJlbmRlcmVkTG9jYXRpb24gPSBuZXcgVVJMKGxvY2F0aW9uLmhyZWYpXG4gIGZvcmNlUmVsb2FkZWQgPSBmYWxzZVxuXG4gIHNob3VsZFRyYW5zaXRpb25UbyhuZXdTbmFwc2hvdCkge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90LnByZWZlcnNWaWV3VHJhbnNpdGlvbnMgJiYgbmV3U25hcHNob3QucHJlZmVyc1ZpZXdUcmFuc2l0aW9uc1xuICB9XG5cbiAgcmVuZGVyUGFnZShzbmFwc2hvdCwgaXNQcmV2aWV3ID0gZmFsc2UsIHdpbGxSZW5kZXIgPSB0cnVlLCB2aXNpdCkge1xuICAgIGNvbnN0IHNob3VsZE1vcnBoUGFnZSA9IHRoaXMuaXNQYWdlUmVmcmVzaCh2aXNpdCkgJiYgdGhpcy5zbmFwc2hvdC5zaG91bGRNb3JwaFBhZ2U7XG4gICAgY29uc3QgcmVuZGVyZXJDbGFzcyA9IHNob3VsZE1vcnBoUGFnZSA/IE1vcnBoaW5nUGFnZVJlbmRlcmVyIDogUGFnZVJlbmRlcmVyO1xuXG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgcmVuZGVyZXJDbGFzcyh0aGlzLnNuYXBzaG90LCBzbmFwc2hvdCwgaXNQcmV2aWV3LCB3aWxsUmVuZGVyKTtcblxuICAgIGlmICghcmVuZGVyZXIuc2hvdWxkUmVuZGVyKSB7XG4gICAgICB0aGlzLmZvcmNlUmVsb2FkZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2aXNpdD8uY2hhbmdlSGlzdG9yeSgpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlbmRlcihyZW5kZXJlcilcbiAgfVxuXG4gIHJlbmRlckVycm9yKHNuYXBzaG90LCB2aXNpdCkge1xuICAgIHZpc2l0Py5jaGFuZ2VIaXN0b3J5KCk7XG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgRXJyb3JSZW5kZXJlcih0aGlzLnNuYXBzaG90LCBzbmFwc2hvdCwgZmFsc2UpO1xuICAgIHJldHVybiB0aGlzLnJlbmRlcihyZW5kZXJlcilcbiAgfVxuXG4gIGNsZWFyU25hcHNob3RDYWNoZSgpIHtcbiAgICB0aGlzLnNuYXBzaG90Q2FjaGUuY2xlYXIoKTtcbiAgfVxuXG4gIGFzeW5jIGNhY2hlU25hcHNob3Qoc25hcHNob3QgPSB0aGlzLnNuYXBzaG90KSB7XG4gICAgaWYgKHNuYXBzaG90LmlzQ2FjaGVhYmxlKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpZXdXaWxsQ2FjaGVTbmFwc2hvdCgpO1xuICAgICAgY29uc3QgeyBsYXN0UmVuZGVyZWRMb2NhdGlvbjogbG9jYXRpb24gfSA9IHRoaXM7XG4gICAgICBhd2FpdCBuZXh0RXZlbnRMb29wVGljaygpO1xuICAgICAgY29uc3QgY2FjaGVkU25hcHNob3QgPSBzbmFwc2hvdC5jbG9uZSgpO1xuICAgICAgdGhpcy5zbmFwc2hvdENhY2hlLnB1dChsb2NhdGlvbiwgY2FjaGVkU25hcHNob3QpO1xuICAgICAgcmV0dXJuIGNhY2hlZFNuYXBzaG90XG4gICAgfVxuICB9XG5cbiAgZ2V0Q2FjaGVkU25hcHNob3RGb3JMb2NhdGlvbihsb2NhdGlvbikge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90Q2FjaGUuZ2V0KGxvY2F0aW9uKVxuICB9XG5cbiAgaXNQYWdlUmVmcmVzaCh2aXNpdCkge1xuICAgIHJldHVybiAhdmlzaXQgfHwgKHRoaXMubGFzdFJlbmRlcmVkTG9jYXRpb24ucGF0aG5hbWUgPT09IHZpc2l0LmxvY2F0aW9uLnBhdGhuYW1lICYmIHZpc2l0LmFjdGlvbiA9PT0gXCJyZXBsYWNlXCIpXG4gIH1cblxuICBzaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKHZpc2l0KSB7XG4gICAgcmV0dXJuIHRoaXMuaXNQYWdlUmVmcmVzaCh2aXNpdCkgJiYgdGhpcy5zbmFwc2hvdC5zaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uXG4gIH1cblxuICBnZXQgc25hcHNob3QoKSB7XG4gICAgcmV0dXJuIFBhZ2VTbmFwc2hvdC5mcm9tRWxlbWVudCh0aGlzLmVsZW1lbnQpXG4gIH1cbn1cblxuY2xhc3MgUHJlbG9hZGVyIHtcbiAgc2VsZWN0b3IgPSBcImFbZGF0YS10dXJiby1wcmVsb2FkXVwiXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIHNuYXBzaG90Q2FjaGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5zbmFwc2hvdENhY2hlID0gc25hcHNob3RDYWNoZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgdGhpcy4jcHJlbG9hZEFsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhkb2N1bWVudC5ib2R5KTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIHRoaXMuI3ByZWxvYWRBbGwpO1xuICB9XG5cbiAgcHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhlbGVtZW50KSB7XG4gICAgZm9yIChjb25zdCBsaW5rIG9mIGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yKSkge1xuICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc2hvdWxkUHJlbG9hZExpbmsobGluaykpIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVVJMKGxpbmspO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHByZWxvYWRVUkwobGluaykge1xuICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IFVSTChsaW5rLmhyZWYpO1xuXG4gICAgaWYgKHRoaXMuc25hcHNob3RDYWNoZS5oYXMobG9jYXRpb24pKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBmZXRjaFJlcXVlc3QgPSBuZXcgRmV0Y2hSZXF1ZXN0KHRoaXMsIEZldGNoTWV0aG9kLmdldCwgbG9jYXRpb24sIG5ldyBVUkxTZWFyY2hQYXJhbXMoKSwgbGluayk7XG4gICAgYXdhaXQgZmV0Y2hSZXF1ZXN0LnBlcmZvcm0oKTtcbiAgfVxuXG4gIC8vIEZldGNoIHJlcXVlc3QgZGVsZWdhdGVcblxuICBwcmVwYXJlUmVxdWVzdChmZXRjaFJlcXVlc3QpIHtcbiAgICBmZXRjaFJlcXVlc3QuaGVhZGVyc1tcIlgtU2VjLVB1cnBvc2VcIl0gPSBcInByZWZldGNoXCI7XG4gIH1cblxuICBhc3luYyByZXF1ZXN0U3VjY2VlZGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHJlc3BvbnNlSFRNTCk7XG5cbiAgICAgIHRoaXMuc25hcHNob3RDYWNoZS5wdXQoZmV0Y2hSZXF1ZXN0LnVybCwgc25hcHNob3QpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIC8vIElmIHdlIGNhbm5vdCBwcmVsb2FkIHRoYXQgaXMgb2shXG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdFN0YXJ0ZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RFcnJvcmVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0RmluaXNoZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICByZXF1ZXN0RmFpbGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICAjcHJlbG9hZEFsbCA9ICgpID0+IHtcbiAgICB0aGlzLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZG9jdW1lbnQuYm9keSk7XG4gIH1cbn1cblxuY2xhc3MgQ2FjaGUge1xuICBjb25zdHJ1Y3RvcihzZXNzaW9uKSB7XG4gICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG4gIH1cblxuICByZXNldENhY2hlQ29udHJvbCgpIHtcbiAgICB0aGlzLiNzZXRDYWNoZUNvbnRyb2woXCJcIik7XG4gIH1cblxuICBleGVtcHRQYWdlRnJvbUNhY2hlKCkge1xuICAgIHRoaXMuI3NldENhY2hlQ29udHJvbChcIm5vLWNhY2hlXCIpO1xuICB9XG5cbiAgZXhlbXB0UGFnZUZyb21QcmV2aWV3KCkge1xuICAgIHRoaXMuI3NldENhY2hlQ29udHJvbChcIm5vLXByZXZpZXdcIik7XG4gIH1cblxuICAjc2V0Q2FjaGVDb250cm9sKHZhbHVlKSB7XG4gICAgc2V0TWV0YUNvbnRlbnQoXCJ0dXJiby1jYWNoZS1jb250cm9sXCIsIHZhbHVlKTtcbiAgfVxufVxuXG5jbGFzcyBTZXNzaW9uIHtcbiAgbmF2aWdhdG9yID0gbmV3IE5hdmlnYXRvcih0aGlzKVxuICBoaXN0b3J5ID0gbmV3IEhpc3RvcnkodGhpcylcbiAgdmlldyA9IG5ldyBQYWdlVmlldyh0aGlzLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpXG4gIGFkYXB0ZXIgPSBuZXcgQnJvd3NlckFkYXB0ZXIodGhpcylcblxuICBwYWdlT2JzZXJ2ZXIgPSBuZXcgUGFnZU9ic2VydmVyKHRoaXMpXG4gIGNhY2hlT2JzZXJ2ZXIgPSBuZXcgQ2FjaGVPYnNlcnZlcigpXG4gIGxpbmtQcmVmZXRjaE9ic2VydmVyID0gbmV3IExpbmtQcmVmZXRjaE9ic2VydmVyKHRoaXMsIGRvY3VtZW50KVxuICBsaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBMaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCB3aW5kb3cpXG4gIGZvcm1TdWJtaXRPYnNlcnZlciA9IG5ldyBGb3JtU3VibWl0T2JzZXJ2ZXIodGhpcywgZG9jdW1lbnQpXG4gIHNjcm9sbE9ic2VydmVyID0gbmV3IFNjcm9sbE9ic2VydmVyKHRoaXMpXG4gIHN0cmVhbU9ic2VydmVyID0gbmV3IFN0cmVhbU9ic2VydmVyKHRoaXMpXG4gIGZvcm1MaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBGb3JtTGlua0NsaWNrT2JzZXJ2ZXIodGhpcywgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KVxuICBmcmFtZVJlZGlyZWN0b3IgPSBuZXcgRnJhbWVSZWRpcmVjdG9yKHRoaXMsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudClcbiAgc3RyZWFtTWVzc2FnZVJlbmRlcmVyID0gbmV3IFN0cmVhbU1lc3NhZ2VSZW5kZXJlcigpXG4gIGNhY2hlID0gbmV3IENhY2hlKHRoaXMpXG5cbiAgZW5hYmxlZCA9IHRydWVcbiAgc3RhcnRlZCA9IGZhbHNlXG4gICNwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gMTUwXG5cbiAgY29uc3RydWN0b3IocmVjZW50UmVxdWVzdHMpIHtcbiAgICB0aGlzLnJlY2VudFJlcXVlc3RzID0gcmVjZW50UmVxdWVzdHM7XG4gICAgdGhpcy5wcmVsb2FkZXIgPSBuZXcgUHJlbG9hZGVyKHRoaXMsIHRoaXMudmlldy5zbmFwc2hvdENhY2hlKTtcbiAgICB0aGlzLmRlYm91bmNlZFJlZnJlc2ggPSB0aGlzLnJlZnJlc2g7XG4gICAgdGhpcy5wYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gdGhpcy5wYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucGFnZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmNhY2hlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMubGlua1ByZWZldGNoT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmZvcm1TdWJtaXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5zY3JvbGxPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5zdHJlYW1PYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5mcmFtZVJlZGlyZWN0b3Iuc3RhcnQoKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5zdGFydCgpO1xuICAgICAgdGhpcy5wcmVsb2FkZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGRpc2FibGUoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucGFnZU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuY2FjaGVPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLmxpbmtQcmVmZXRjaE9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMubGlua0NsaWNrT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5zY3JvbGxPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLnN0cmVhbU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZnJhbWVSZWRpcmVjdG9yLnN0b3AoKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5zdG9wKCk7XG4gICAgICB0aGlzLnByZWxvYWRlci5zdG9wKCk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZWdpc3RlckFkYXB0ZXIoYWRhcHRlcikge1xuICAgIHRoaXMuYWRhcHRlciA9IGFkYXB0ZXI7XG4gIH1cblxuICB2aXNpdChsb2NhdGlvbiwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgZnJhbWVFbGVtZW50ID0gb3B0aW9ucy5mcmFtZSA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMuZnJhbWUpIDogbnVsbDtcblxuICAgIGlmIChmcmFtZUVsZW1lbnQgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IG9wdGlvbnMuYWN0aW9uIHx8IGdldFZpc2l0QWN0aW9uKGZyYW1lRWxlbWVudCk7XG5cbiAgICAgIGZyYW1lRWxlbWVudC5kZWxlZ2F0ZS5wcm9wb3NlVmlzaXRJZk5hdmlnYXRlZFdpdGhBY3Rpb24oZnJhbWVFbGVtZW50LCBhY3Rpb24pO1xuICAgICAgZnJhbWVFbGVtZW50LnNyYyA9IGxvY2F0aW9uLnRvU3RyaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubmF2aWdhdG9yLnByb3Bvc2VWaXNpdChleHBhbmRVUkwobG9jYXRpb24pLCBvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICByZWZyZXNoKHVybCwgcmVxdWVzdElkKSB7XG4gICAgY29uc3QgaXNSZWNlbnRSZXF1ZXN0ID0gcmVxdWVzdElkICYmIHRoaXMucmVjZW50UmVxdWVzdHMuaGFzKHJlcXVlc3RJZCk7XG4gICAgaWYgKCFpc1JlY2VudFJlcXVlc3QgJiYgIXRoaXMubmF2aWdhdG9yLmN1cnJlbnRWaXNpdCkge1xuICAgICAgdGhpcy52aXNpdCh1cmwsIHsgYWN0aW9uOiBcInJlcGxhY2VcIiwgc2hvdWxkQ2FjaGVTbmFwc2hvdDogZmFsc2UgfSk7XG4gICAgfVxuICB9XG5cbiAgY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgICB0aGlzLnN0cmVhbU9ic2VydmVyLmNvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gICAgdGhpcy5zdHJlYW1PYnNlcnZlci5kaXNjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSk7XG4gIH1cblxuICByZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICB0aGlzLnN0cmVhbU1lc3NhZ2VSZW5kZXJlci5yZW5kZXIoU3RyZWFtTWVzc2FnZS53cmFwKG1lc3NhZ2UpKTtcbiAgfVxuXG4gIGNsZWFyQ2FjaGUoKSB7XG4gICAgdGhpcy52aWV3LmNsZWFyU25hcHNob3RDYWNoZSgpO1xuICB9XG5cbiAgc2V0UHJvZ3Jlc3NCYXJEZWxheShkZWxheSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiUGxlYXNlIHJlcGxhY2UgYHNlc3Npb24uc2V0UHJvZ3Jlc3NCYXJEZWxheShkZWxheSlgIHdpdGggYHNlc3Npb24ucHJvZ3Jlc3NCYXJEZWxheSA9IGRlbGF5YC4gVGhlIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uIG9mIFR1cmJvLmBcIlxuICAgICk7XG5cbiAgICB0aGlzLnByb2dyZXNzQmFyRGVsYXkgPSBkZWxheTtcbiAgfVxuXG4gIHNldCBwcm9ncmVzc0JhckRlbGF5KGRlbGF5KSB7XG4gICAgY29uZmlnLmRyaXZlLnByb2dyZXNzQmFyRGVsYXkgPSBkZWxheTtcbiAgfVxuXG4gIGdldCBwcm9ncmVzc0JhckRlbGF5KCkge1xuICAgIHJldHVybiBjb25maWcuZHJpdmUucHJvZ3Jlc3NCYXJEZWxheVxuICB9XG5cbiAgc2V0IGRyaXZlKHZhbHVlKSB7XG4gICAgY29uZmlnLmRyaXZlLmVuYWJsZWQgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBkcml2ZSgpIHtcbiAgICByZXR1cm4gY29uZmlnLmRyaXZlLmVuYWJsZWRcbiAgfVxuXG4gIHNldCBmb3JtTW9kZSh2YWx1ZSkge1xuICAgIGNvbmZpZy5mb3Jtcy5tb2RlID0gdmFsdWU7XG4gIH1cblxuICBnZXQgZm9ybU1vZGUoKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5mb3Jtcy5tb2RlXG4gIH1cblxuICBnZXQgbG9jYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5sb2NhdGlvblxuICB9XG5cbiAgZ2V0IHJlc3RvcmF0aW9uSWRlbnRpZmllcigpIHtcbiAgICByZXR1cm4gdGhpcy5oaXN0b3J5LnJlc3RvcmF0aW9uSWRlbnRpZmllclxuICB9XG5cbiAgZ2V0IHBhZ2VSZWZyZXNoRGVib3VuY2VQZXJpb2QoKSB7XG4gICAgcmV0dXJuIHRoaXMuI3BhZ2VSZWZyZXNoRGVib3VuY2VQZXJpb2RcbiAgfVxuXG4gIHNldCBwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kKHZhbHVlKSB7XG4gICAgdGhpcy5yZWZyZXNoID0gZGVib3VuY2UodGhpcy5kZWJvdW5jZWRSZWZyZXNoLmJpbmQodGhpcyksIHZhbHVlKTtcbiAgICB0aGlzLiNwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gdmFsdWU7XG4gIH1cblxuICAvLyBQcmVsb2FkZXIgZGVsZWdhdGVcblxuICBzaG91bGRQcmVsb2FkTGluayhlbGVtZW50KSB7XG4gICAgY29uc3QgaXNVbnNhZmUgPSBlbGVtZW50Lmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tbWV0aG9kXCIpO1xuICAgIGNvbnN0IGlzU3RyZWFtID0gZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKTtcbiAgICBjb25zdCBmcmFtZVRhcmdldCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKTtcbiAgICBjb25zdCBmcmFtZSA9IGZyYW1lVGFyZ2V0ID09IFwiX3RvcFwiID9cbiAgICAgIG51bGwgOlxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhbWVUYXJnZXQpIHx8IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkoZWxlbWVudCwgXCJ0dXJiby1mcmFtZTpub3QoW2Rpc2FibGVkXSlcIik7XG5cbiAgICBpZiAoaXNVbnNhZmUgfHwgaXNTdHJlYW0gfHwgZnJhbWUgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9IG5ldyBVUkwoZWxlbWVudC5ocmVmKTtcblxuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCkgJiYgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gICAgfVxuICB9XG5cbiAgLy8gSGlzdG9yeSBkZWxlZ2F0ZVxuXG4gIGhpc3RvcnlQb3BwZWRUb0xvY2F0aW9uV2l0aFJlc3RvcmF0aW9uSWRlbnRpZmllckFuZERpcmVjdGlvbihsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCBkaXJlY3Rpb24pIHtcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLm5hdmlnYXRvci5zdGFydFZpc2l0KGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIHtcbiAgICAgICAgYWN0aW9uOiBcInJlc3RvcmVcIixcbiAgICAgICAgaGlzdG9yeUNoYW5nZWQ6IHRydWUsXG4gICAgICAgIGRpcmVjdGlvblxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWRhcHRlci5wYWdlSW52YWxpZGF0ZWQoe1xuICAgICAgICByZWFzb246IFwidHVyYm9fZGlzYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU2Nyb2xsIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgc2Nyb2xsUG9zaXRpb25DaGFuZ2VkKHBvc2l0aW9uKSB7XG4gICAgdGhpcy5oaXN0b3J5LnVwZGF0ZVJlc3RvcmF0aW9uRGF0YSh7IHNjcm9sbFBvc2l0aW9uOiBwb3NpdGlvbiB9KTtcbiAgfVxuXG4gIC8vIEZvcm0gY2xpY2sgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybUxpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUobGluaykgJiYgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gIH1cblxuICBzdWJtaXR0ZWRGb3JtTGlua1RvTG9jYXRpb24oKSB7fVxuXG4gIC8vIExpbmsgaG92ZXIgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBjYW5QcmVmZXRjaFJlcXVlc3RUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUobGluaykgJiZcbiAgICAgICAgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gICAgKVxuICB9XG5cbiAgLy8gTGluayBjbGljayBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxGb2xsb3dMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXZlbnQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5lbGVtZW50SXNOYXZpZ2F0YWJsZShsaW5rKSAmJlxuICAgICAgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pICYmXG4gICAgICB0aGlzLmFwcGxpY2F0aW9uQWxsb3dzRm9sbG93aW5nTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2ZW50KVxuICAgIClcbiAgfVxuXG4gIGZvbGxvd2VkTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24pIHtcbiAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmdldEFjdGlvbkZvckxpbmsobGluayk7XG4gICAgY29uc3QgYWNjZXB0c1N0cmVhbVJlc3BvbnNlID0gbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKTtcblxuICAgIHRoaXMudmlzaXQobG9jYXRpb24uaHJlZiwgeyBhY3Rpb24sIGFjY2VwdHNTdHJlYW1SZXNwb25zZSB9KTtcbiAgfVxuXG4gIC8vIE5hdmlnYXRvciBkZWxlZ2F0ZVxuXG4gIGFsbG93c1Zpc2l0aW5nTG9jYXRpb25XaXRoQWN0aW9uKGxvY2F0aW9uLCBhY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhdGlvbldpdGhBY3Rpb25Jc1NhbWVQYWdlKGxvY2F0aW9uLCBhY3Rpb24pIHx8IHRoaXMuYXBwbGljYXRpb25BbGxvd3NWaXNpdGluZ0xvY2F0aW9uKGxvY2F0aW9uKVxuICB9XG5cbiAgdmlzaXRQcm9wb3NlZFRvTG9jYXRpb24obG9jYXRpb24sIG9wdGlvbnMpIHtcbiAgICBleHRlbmRVUkxXaXRoRGVwcmVjYXRlZFByb3BlcnRpZXMobG9jYXRpb24pO1xuICAgIHRoaXMuYWRhcHRlci52aXNpdFByb3Bvc2VkVG9Mb2NhdGlvbihsb2NhdGlvbiwgb3B0aW9ucyk7XG4gIH1cblxuICAvLyBWaXNpdCBkZWxlZ2F0ZVxuXG4gIHZpc2l0U3RhcnRlZCh2aXNpdCkge1xuICAgIGlmICghdmlzaXQuYWNjZXB0c1N0cmVhbVJlc3BvbnNlKSB7XG4gICAgICBtYXJrQXNCdXN5KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7XG4gICAgICB0aGlzLnZpZXcubWFya1Zpc2l0RGlyZWN0aW9uKHZpc2l0LmRpcmVjdGlvbik7XG4gICAgfVxuICAgIGV4dGVuZFVSTFdpdGhEZXByZWNhdGVkUHJvcGVydGllcyh2aXNpdC5sb2NhdGlvbik7XG4gICAgaWYgKCF2aXNpdC5zaWxlbnQpIHtcbiAgICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlclZpc2l0aW5nTG9jYXRpb24odmlzaXQubG9jYXRpb24sIHZpc2l0LmFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRDb21wbGV0ZWQodmlzaXQpIHtcbiAgICB0aGlzLnZpZXcudW5tYXJrVmlzaXREaXJlY3Rpb24oKTtcbiAgICBjbGVhckJ1c3lTdGF0ZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlclBhZ2VMb2FkKHZpc2l0LmdldFRpbWluZ01ldHJpY3MoKSk7XG4gIH1cblxuICBsb2NhdGlvbldpdGhBY3Rpb25Jc1NhbWVQYWdlKGxvY2F0aW9uLCBhY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5uYXZpZ2F0b3IubG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZShsb2NhdGlvbiwgYWN0aW9uKVxuICB9XG5cbiAgdmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbihvbGRVUkwsIG5ld1VSTCkge1xuICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlclZpc2l0aW5nU2FtZVBhZ2VMb2NhdGlvbihvbGRVUkwsIG5ld1VSTCk7XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pdCBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxTdWJtaXRGb3JtKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGFjdGlvbiA9IGdldEFjdGlvbiQxKGZvcm0sIHN1Ym1pdHRlcik7XG5cbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5zdWJtaXNzaW9uSXNOYXZpZ2F0YWJsZShmb3JtLCBzdWJtaXR0ZXIpICYmXG4gICAgICBsb2NhdGlvbklzVmlzaXRhYmxlKGV4cGFuZFVSTChhY3Rpb24pLCB0aGlzLnNuYXBzaG90LnJvb3RMb2NhdGlvbilcbiAgICApXG4gIH1cblxuICBmb3JtU3VibWl0dGVkKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIHRoaXMubmF2aWdhdG9yLnN1Ym1pdEZvcm0oZm9ybSwgc3VibWl0dGVyKTtcbiAgfVxuXG4gIC8vIFBhZ2Ugb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBwYWdlQmVjYW1lSW50ZXJhY3RpdmUoKSB7XG4gICAgdGhpcy52aWV3Lmxhc3RSZW5kZXJlZExvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJQYWdlTG9hZCgpO1xuICB9XG5cbiAgcGFnZUxvYWRlZCgpIHtcbiAgICB0aGlzLmhpc3RvcnkuYXNzdW1lQ29udHJvbE9mU2Nyb2xsUmVzdG9yYXRpb24oKTtcbiAgfVxuXG4gIHBhZ2VXaWxsVW5sb2FkKCkge1xuICAgIHRoaXMuaGlzdG9yeS5yZWxpbnF1aXNoQ29udHJvbE9mU2Nyb2xsUmVzdG9yYXRpb24oKTtcbiAgfVxuXG4gIC8vIFN0cmVhbSBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHJlY2VpdmVkTWVzc2FnZUZyb21TdHJlYW0obWVzc2FnZSkge1xuICAgIHRoaXMucmVuZGVyU3RyZWFtTWVzc2FnZShtZXNzYWdlKTtcbiAgfVxuXG4gIC8vIFBhZ2UgdmlldyBkZWxlZ2F0ZVxuXG4gIHZpZXdXaWxsQ2FjaGVTbmFwc2hvdCgpIHtcbiAgICBpZiAoIXRoaXMubmF2aWdhdG9yLmN1cnJlbnRWaXNpdD8uc2lsZW50KSB7XG4gICAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlQ2FjaGluZ1NuYXBzaG90KCk7XG4gICAgfVxuICB9XG5cbiAgYWxsb3dzSW1tZWRpYXRlUmVuZGVyKHsgZWxlbWVudCB9LCBvcHRpb25zKSB7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlUmVuZGVyKGVsZW1lbnQsIG9wdGlvbnMpO1xuICAgIGNvbnN0IHtcbiAgICAgIGRlZmF1bHRQcmV2ZW50ZWQsXG4gICAgICBkZXRhaWw6IHsgcmVuZGVyIH1cbiAgICB9ID0gZXZlbnQ7XG5cbiAgICBpZiAodGhpcy52aWV3LnJlbmRlcmVyICYmIHJlbmRlcikge1xuICAgICAgdGhpcy52aWV3LnJlbmRlcmVyLnJlbmRlckVsZW1lbnQgPSByZW5kZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuICFkZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICB2aWV3UmVuZGVyZWRTbmFwc2hvdChfc25hcHNob3QsIF9pc1ByZXZpZXcsIHJlbmRlck1ldGhvZCkge1xuICAgIHRoaXMudmlldy5sYXN0UmVuZGVyZWRMb2NhdGlvbiA9IHRoaXMuaGlzdG9yeS5sb2NhdGlvbjtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJSZW5kZXIocmVuZGVyTWV0aG9kKTtcbiAgfVxuXG4gIHByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZWxlbWVudCkge1xuICAgIHRoaXMucHJlbG9hZGVyLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZWxlbWVudCk7XG4gIH1cblxuICB2aWV3SW52YWxpZGF0ZWQocmVhc29uKSB7XG4gICAgdGhpcy5hZGFwdGVyLnBhZ2VJbnZhbGlkYXRlZChyZWFzb24pO1xuICB9XG5cbiAgLy8gRnJhbWUgZWxlbWVudFxuXG4gIGZyYW1lTG9hZGVkKGZyYW1lKSB7XG4gICAgdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyRnJhbWVMb2FkKGZyYW1lKTtcbiAgfVxuXG4gIGZyYW1lUmVuZGVyZWQoZmV0Y2hSZXNwb25zZSwgZnJhbWUpIHtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJGcmFtZVJlbmRlcihmZXRjaFJlc3BvbnNlLCBmcmFtZSk7XG4gIH1cblxuICAvLyBBcHBsaWNhdGlvbiBldmVudHNcblxuICBhcHBsaWNhdGlvbkFsbG93c0ZvbGxvd2luZ0xpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uLCBldikge1xuICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyQ2xpY2tpbmdMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXYpO1xuICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICB9XG5cbiAgYXBwbGljYXRpb25BbGxvd3NWaXNpdGluZ0xvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlVmlzaXRpbmdMb2NhdGlvbihsb2NhdGlvbik7XG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyQ2xpY2tpbmdMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXZlbnQpIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goXCJ0dXJibzpjbGlja1wiLCB7XG4gICAgICB0YXJnZXQ6IGxpbmssXG4gICAgICBkZXRhaWw6IHsgdXJsOiBsb2NhdGlvbi5ocmVmLCBvcmlnaW5hbEV2ZW50OiBldmVudCB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkJlZm9yZVZpc2l0aW5nTG9jYXRpb24obG9jYXRpb24pIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtdmlzaXRcIiwge1xuICAgICAgZGV0YWlsOiB7IHVybDogbG9jYXRpb24uaHJlZiB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyVmlzaXRpbmdMb2NhdGlvbihsb2NhdGlvbiwgYWN0aW9uKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86dmlzaXRcIiwgeyBkZXRhaWw6IHsgdXJsOiBsb2NhdGlvbi5ocmVmLCBhY3Rpb24gfSB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25CZWZvcmVDYWNoaW5nU25hcHNob3QoKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWNhY2hlXCIpXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkJlZm9yZVJlbmRlcihuZXdCb2R5LCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLXJlbmRlclwiLCB7XG4gICAgICBkZXRhaWw6IHsgbmV3Qm9keSwgLi4ub3B0aW9ucyB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyUmVuZGVyKHJlbmRlck1ldGhvZCkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOnJlbmRlclwiLCB7IGRldGFpbDogeyByZW5kZXJNZXRob2QgfSB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25BZnRlclBhZ2VMb2FkKHRpbWluZyA9IHt9KSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86bG9hZFwiLCB7XG4gICAgICBkZXRhaWw6IHsgdXJsOiB0aGlzLmxvY2F0aW9uLmhyZWYsIHRpbWluZyB9XG4gICAgfSlcbiAgfVxuXG4gIG5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJWaXNpdGluZ1NhbWVQYWdlTG9jYXRpb24ob2xkVVJMLCBuZXdVUkwpIHtcbiAgICBkaXNwYXRjaEV2ZW50KFxuICAgICAgbmV3IEhhc2hDaGFuZ2VFdmVudChcImhhc2hjaGFuZ2VcIiwge1xuICAgICAgICBvbGRVUkw6IG9sZFVSTC50b1N0cmluZygpLFxuICAgICAgICBuZXdVUkw6IG5ld1VSTC50b1N0cmluZygpXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyRnJhbWVMb2FkKGZyYW1lKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86ZnJhbWUtbG9hZFwiLCB7IHRhcmdldDogZnJhbWUgfSlcbiAgfVxuXG4gIG5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJGcmFtZVJlbmRlcihmZXRjaFJlc3BvbnNlLCBmcmFtZSkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOmZyYW1lLXJlbmRlclwiLCB7XG4gICAgICBkZXRhaWw6IHsgZmV0Y2hSZXNwb25zZSB9LFxuICAgICAgdGFyZ2V0OiBmcmFtZSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KVxuICB9XG5cbiAgLy8gSGVscGVyc1xuXG4gIHN1Ym1pc3Npb25Jc05hdmlnYXRhYmxlKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIGlmIChjb25maWcuZm9ybXMubW9kZSA9PSBcIm9mZlwiKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc3VibWl0dGVySXNOYXZpZ2F0YWJsZSA9IHN1Ym1pdHRlciA/IHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUoc3VibWl0dGVyKSA6IHRydWU7XG5cbiAgICAgIGlmIChjb25maWcuZm9ybXMubW9kZSA9PSBcIm9wdGluXCIpIHtcbiAgICAgICAgcmV0dXJuIHN1Ym1pdHRlcklzTmF2aWdhdGFibGUgJiYgZm9ybS5jbG9zZXN0KCdbZGF0YS10dXJibz1cInRydWVcIl0nKSAhPSBudWxsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gc3VibWl0dGVySXNOYXZpZ2F0YWJsZSAmJiB0aGlzLmVsZW1lbnRJc05hdmlnYXRhYmxlKGZvcm0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkoZWxlbWVudCwgXCJbZGF0YS10dXJib11cIik7XG4gICAgY29uc3Qgd2l0aGluRnJhbWUgPSBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KGVsZW1lbnQsIFwidHVyYm8tZnJhbWVcIik7XG5cbiAgICAvLyBDaGVjayBpZiBEcml2ZSBpcyBlbmFibGVkIG9uIHRoZSBzZXNzaW9uIG9yIHdlJ3JlIHdpdGhpbiBhIEZyYW1lLlxuICAgIGlmIChjb25maWcuZHJpdmUuZW5hYmxlZCB8fCB3aXRoaW5GcmFtZSkge1xuICAgICAgLy8gRWxlbWVudCBpcyBuYXZpZ2F0YWJsZSBieSBkZWZhdWx0LCB1bmxlc3MgYGRhdGEtdHVyYm89XCJmYWxzZVwiYC5cbiAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvXCIpICE9IFwiZmFsc2VcIlxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRWxlbWVudCBpc24ndCBuYXZpZ2F0YWJsZSBieSBkZWZhdWx0LCB1bmxlc3MgYGRhdGEtdHVyYm89XCJ0cnVlXCJgLlxuICAgICAgaWYgKGNvbnRhaW5lcikge1xuICAgICAgICByZXR1cm4gY29udGFpbmVyLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm9cIikgPT0gXCJ0cnVlXCJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBnZXRBY3Rpb25Gb3JMaW5rKGxpbmspIHtcbiAgICByZXR1cm4gZ2V0VmlzaXRBY3Rpb24obGluaykgfHwgXCJhZHZhbmNlXCJcbiAgfVxuXG4gIGdldCBzbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3LnNuYXBzaG90XG4gIH1cbn1cblxuLy8gT2xkZXIgdmVyc2lvbnMgb2YgdGhlIFR1cmJvIE5hdGl2ZSBhZGFwdGVycyByZWZlcmVuY2VkIHRoZVxuLy8gYExvY2F0aW9uI2Fic29sdXRlVVJMYCBwcm9wZXJ0eSBpbiB0aGVpciBpbXBsZW1lbnRhdGlvbnMgb2Zcbi8vIHRoZSBgQWRhcHRlciN2aXNpdFByb3Bvc2VkVG9Mb2NhdGlvbigpYCBhbmQgYCN2aXNpdFN0YXJ0ZWQoKWBcbi8vIG1ldGhvZHMuIFRoZSBMb2NhdGlvbiBjbGFzcyBoYXMgc2luY2UgYmVlbiByZW1vdmVkIGluIGZhdm9yXG4vLyBvZiB0aGUgRE9NIFVSTCBBUEksIGFuZCBhY2NvcmRpbmdseSBhbGwgQWRhcHRlciBtZXRob2RzIG5vd1xuLy8gcmVjZWl2ZSBVUkwgb2JqZWN0cy5cbi8vXG4vLyBXZSBhbGlhcyAjYWJzb2x1dGVVUkwgdG8gI3RvU3RyaW5nKCkgaGVyZSB0byBhdm9pZCBjcmFzaGluZ1xuLy8gb2xkZXIgYWRhcHRlcnMgd2hpY2ggZG8gbm90IGV4cGVjdCBVUkwgb2JqZWN0cy4gV2Ugc2hvdWxkXG4vLyBjb25zaWRlciByZW1vdmluZyB0aGlzIHN1cHBvcnQgYXQgc29tZSBwb2ludCBpbiB0aGUgZnV0dXJlLlxuXG5mdW5jdGlvbiBleHRlbmRVUkxXaXRoRGVwcmVjYXRlZFByb3BlcnRpZXModXJsKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHVybCwgZGVwcmVjYXRlZExvY2F0aW9uUHJvcGVydHlEZXNjcmlwdG9ycyk7XG59XG5cbmNvbnN0IGRlcHJlY2F0ZWRMb2NhdGlvblByb3BlcnR5RGVzY3JpcHRvcnMgPSB7XG4gIGFic29sdXRlVVJMOiB7XG4gICAgZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKVxuICAgIH1cbiAgfVxufTtcblxuY29uc3Qgc2Vzc2lvbiA9IG5ldyBTZXNzaW9uKHJlY2VudFJlcXVlc3RzKTtcbmNvbnN0IHsgY2FjaGUsIG5hdmlnYXRvcjogbmF2aWdhdG9yJDEgfSA9IHNlc3Npb247XG5cbi8qKlxuICogU3RhcnRzIHRoZSBtYWluIHNlc3Npb24uXG4gKiBUaGlzIGluaXRpYWxpc2VzIGFueSBuZWNlc3Nhcnkgb2JzZXJ2ZXJzIHN1Y2ggYXMgdGhvc2UgdG8gbW9uaXRvclxuICogbGluayBpbnRlcmFjdGlvbnMuXG4gKi9cbmZ1bmN0aW9uIHN0YXJ0KCkge1xuICBzZXNzaW9uLnN0YXJ0KCk7XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGFuIGFkYXB0ZXIgZm9yIHRoZSBtYWluIHNlc3Npb24uXG4gKlxuICogQHBhcmFtIGFkYXB0ZXIgQWRhcHRlciB0byByZWdpc3RlclxuICovXG5mdW5jdGlvbiByZWdpc3RlckFkYXB0ZXIoYWRhcHRlcikge1xuICBzZXNzaW9uLnJlZ2lzdGVyQWRhcHRlcihhZGFwdGVyKTtcbn1cblxuLyoqXG4gKiBQZXJmb3JtcyBhbiBhcHBsaWNhdGlvbiB2aXNpdCB0byB0aGUgZ2l2ZW4gbG9jYXRpb24uXG4gKlxuICogQHBhcmFtIGxvY2F0aW9uIExvY2F0aW9uIHRvIHZpc2l0IChhIFVSTCBvciBwYXRoKVxuICogQHBhcmFtIG9wdGlvbnMgT3B0aW9ucyB0byBhcHBseVxuICogQHBhcmFtIG9wdGlvbnMuYWN0aW9uIFR5cGUgb2YgaGlzdG9yeSBuYXZpZ2F0aW9uIHRvIGFwcGx5IChcInJlc3RvcmVcIixcbiAqIFwicmVwbGFjZVwiIG9yIFwiYWR2YW5jZVwiKVxuICogQHBhcmFtIG9wdGlvbnMuaGlzdG9yeUNoYW5nZWQgU3BlY2lmaWVzIHdoZXRoZXIgdGhlIGJyb3dzZXIgaGlzdG9yeSBoYXNcbiAqIGFscmVhZHkgYmVlbiBjaGFuZ2VkIGZvciB0aGlzIHZpc2l0IG9yIG5vdFxuICogQHBhcmFtIG9wdGlvbnMucmVmZXJyZXIgU3BlY2lmaWVzIHRoZSByZWZlcnJlciBvZiB0aGlzIHZpc2l0IHN1Y2ggdGhhdFxuICogbmF2aWdhdGlvbnMgdG8gdGhlIHNhbWUgcGFnZSB3aWxsIG5vdCByZXN1bHQgaW4gYSBuZXcgaGlzdG9yeSBlbnRyeS5cbiAqIEBwYXJhbSBvcHRpb25zLnNuYXBzaG90SFRNTCBDYWNoZWQgc25hcHNob3QgdG8gcmVuZGVyXG4gKiBAcGFyYW0gb3B0aW9ucy5yZXNwb25zZSBSZXNwb25zZSBvZiB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uXG4gKi9cbmZ1bmN0aW9uIHZpc2l0KGxvY2F0aW9uLCBvcHRpb25zKSB7XG4gIHNlc3Npb24udmlzaXQobG9jYXRpb24sIG9wdGlvbnMpO1xufVxuXG4vKipcbiAqIENvbm5lY3RzIGEgc3RyZWFtIHNvdXJjZSB0byB0aGUgbWFpbiBzZXNzaW9uLlxuICpcbiAqIEBwYXJhbSBzb3VyY2UgU3RyZWFtIHNvdXJjZSB0byBjb25uZWN0XG4gKi9cbmZ1bmN0aW9uIGNvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gIHNlc3Npb24uY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpO1xufVxuXG4vKipcbiAqIERpc2Nvbm5lY3RzIGEgc3RyZWFtIHNvdXJjZSBmcm9tIHRoZSBtYWluIHNlc3Npb24uXG4gKlxuICogQHBhcmFtIHNvdXJjZSBTdHJlYW0gc291cmNlIHRvIGRpc2Nvbm5lY3RcbiAqL1xuZnVuY3Rpb24gZGlzY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgc2Vzc2lvbi5kaXNjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSk7XG59XG5cbi8qKlxuICogUmVuZGVycyBhIHN0cmVhbSBtZXNzYWdlIHRvIHRoZSBtYWluIHNlc3Npb24gYnkgYXBwZW5kaW5nIGl0IHRvIHRoZVxuICogY3VycmVudCBkb2N1bWVudC5cbiAqXG4gKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIHJlbmRlclxuICovXG5mdW5jdGlvbiByZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgc2Vzc2lvbi5yZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGVudHJpZXMgZnJvbSB0aGUgVHVyYm8gRHJpdmUgcGFnZSBjYWNoZS5cbiAqIENhbGwgdGhpcyB3aGVuIHN0YXRlIGhhcyBjaGFuZ2VkIG9uIHRoZSBzZXJ2ZXIgdGhhdCBtYXkgYWZmZWN0IGNhY2hlZCBwYWdlcy5cbiAqXG4gKiBAZGVwcmVjYXRlZCBzaW5jZSB2ZXJzaW9uIDcuMi4wIGluIGZhdm9yIG9mIGBUdXJiby5jYWNoZS5jbGVhcigpYFxuICovXG5mdW5jdGlvbiBjbGVhckNhY2hlKCkge1xuICBjb25zb2xlLndhcm4oXG4gICAgXCJQbGVhc2UgcmVwbGFjZSBgVHVyYm8uY2xlYXJDYWNoZSgpYCB3aXRoIGBUdXJiby5jYWNoZS5jbGVhcigpYC4gVGhlIHRvcC1sZXZlbCBmdW5jdGlvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBUdXJiby5gXCJcbiAgKTtcbiAgc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG59XG5cbi8qKlxuICogU2V0cyB0aGUgZGVsYXkgYWZ0ZXIgd2hpY2ggdGhlIHByb2dyZXNzIGJhciB3aWxsIGFwcGVhciBkdXJpbmcgbmF2aWdhdGlvbi5cbiAqXG4gKiBUaGUgcHJvZ3Jlc3MgYmFyIGFwcGVhcnMgYWZ0ZXIgNTAwbXMgYnkgZGVmYXVsdC5cbiAqXG4gKiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgaGFzIG5vIGVmZmVjdCB3aGVuIHVzZWQgd2l0aCB0aGUgaU9TIG9yIEFuZHJvaWRcbiAqIGFkYXB0ZXJzLlxuICpcbiAqIEBwYXJhbSBkZWxheSBUaW1lIHRvIGRlbGF5IGluIG1pbGxpc2Vjb25kc1xuICovXG5mdW5jdGlvbiBzZXRQcm9ncmVzc0JhckRlbGF5KGRlbGF5KSB7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIlBsZWFzZSByZXBsYWNlIGBUdXJiby5zZXRQcm9ncmVzc0JhckRlbGF5KGRlbGF5KWAgd2l0aCBgVHVyYm8uY29uZmlnLmRyaXZlLnByb2dyZXNzQmFyRGVsYXkgPSBkZWxheWAuIFRoZSB0b3AtbGV2ZWwgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgVHVyYm8uYFwiXG4gICk7XG4gIGNvbmZpZy5kcml2ZS5wcm9ncmVzc0JhckRlbGF5ID0gZGVsYXk7XG59XG5cbmZ1bmN0aW9uIHNldENvbmZpcm1NZXRob2QoY29uZmlybU1ldGhvZCkge1xuICBjb25zb2xlLndhcm4oXG4gICAgXCJQbGVhc2UgcmVwbGFjZSBgVHVyYm8uc2V0Q29uZmlybU1ldGhvZChjb25maXJtTWV0aG9kKWAgd2l0aCBgVHVyYm8uY29uZmlnLmZvcm1zLmNvbmZpcm0gPSBjb25maXJtTWV0aG9kYC4gVGhlIHRvcC1sZXZlbCBmdW5jdGlvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBUdXJiby5gXCJcbiAgKTtcbiAgY29uZmlnLmZvcm1zLmNvbmZpcm0gPSBjb25maXJtTWV0aG9kO1xufVxuXG5mdW5jdGlvbiBzZXRGb3JtTW9kZShtb2RlKSB7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIlBsZWFzZSByZXBsYWNlIGBUdXJiby5zZXRGb3JtTW9kZShtb2RlKWAgd2l0aCBgVHVyYm8uY29uZmlnLmZvcm1zLm1vZGUgPSBtb2RlYC4gVGhlIHRvcC1sZXZlbCBmdW5jdGlvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBUdXJiby5gXCJcbiAgKTtcbiAgY29uZmlnLmZvcm1zLm1vZGUgPSBtb2RlO1xufVxuXG52YXIgVHVyYm8gPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgbmF2aWdhdG9yOiBuYXZpZ2F0b3IkMSxcbiAgc2Vzc2lvbjogc2Vzc2lvbixcbiAgY2FjaGU6IGNhY2hlLFxuICBQYWdlUmVuZGVyZXI6IFBhZ2VSZW5kZXJlcixcbiAgUGFnZVNuYXBzaG90OiBQYWdlU25hcHNob3QsXG4gIEZyYW1lUmVuZGVyZXI6IEZyYW1lUmVuZGVyZXIsXG4gIGZldGNoOiBmZXRjaFdpdGhUdXJib0hlYWRlcnMsXG4gIGNvbmZpZzogY29uZmlnLFxuICBzdGFydDogc3RhcnQsXG4gIHJlZ2lzdGVyQWRhcHRlcjogcmVnaXN0ZXJBZGFwdGVyLFxuICB2aXNpdDogdmlzaXQsXG4gIGNvbm5lY3RTdHJlYW1Tb3VyY2U6IGNvbm5lY3RTdHJlYW1Tb3VyY2UsXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2U6IGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2UsXG4gIHJlbmRlclN0cmVhbU1lc3NhZ2U6IHJlbmRlclN0cmVhbU1lc3NhZ2UsXG4gIGNsZWFyQ2FjaGU6IGNsZWFyQ2FjaGUsXG4gIHNldFByb2dyZXNzQmFyRGVsYXk6IHNldFByb2dyZXNzQmFyRGVsYXksXG4gIHNldENvbmZpcm1NZXRob2Q6IHNldENvbmZpcm1NZXRob2QsXG4gIHNldEZvcm1Nb2RlOiBzZXRGb3JtTW9kZVxufSk7XG5cbmNsYXNzIFR1cmJvRnJhbWVNaXNzaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7fVxuXG5jbGFzcyBGcmFtZUNvbnRyb2xsZXIge1xuICBmZXRjaFJlc3BvbnNlTG9hZGVkID0gKF9mZXRjaFJlc3BvbnNlKSA9PiBQcm9taXNlLnJlc29sdmUoKVxuICAjY3VycmVudEZldGNoUmVxdWVzdCA9IG51bGxcbiAgI3Jlc29sdmVWaXNpdFByb21pc2UgPSAoKSA9PiB7fVxuICAjY29ubmVjdGVkID0gZmFsc2VcbiAgI2hhc0JlZW5Mb2FkZWQgPSBmYWxzZVxuICAjaWdub3JlZEF0dHJpYnV0ZXMgPSBuZXcgU2V0KClcbiAgI3Nob3VsZE1vcnBoRnJhbWUgPSBmYWxzZVxuICBhY3Rpb24gPSBudWxsXG5cbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy52aWV3ID0gbmV3IEZyYW1lVmlldyh0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMuYXBwZWFyYW5jZU9ic2VydmVyID0gbmV3IEFwcGVhcmFuY2VPYnNlcnZlcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyID0gbmV3IEZvcm1MaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yID0gbmV3IExpbmtJbnRlcmNlcHRvcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMucmVzdG9yYXRpb25JZGVudGlmaWVyID0gdXVpZCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyID0gbmV3IEZvcm1TdWJtaXRPYnNlcnZlcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICB9XG5cbiAgLy8gRnJhbWUgZGVsZWdhdGVcblxuICBjb25uZWN0KCkge1xuICAgIGlmICghdGhpcy4jY29ubmVjdGVkKSB7XG4gICAgICB0aGlzLiNjb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoaXMubG9hZGluZ1N0eWxlID09IEZyYW1lTG9hZGluZ1N0eWxlLmxhenkpIHtcbiAgICAgICAgdGhpcy5hcHBlYXJhbmNlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuI2xvYWRTb3VyY2VVUkwoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmxpbmtJbnRlcmNlcHRvci5zdGFydCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gIH1cblxuICBkaXNjb25uZWN0KCkge1xuICAgIGlmICh0aGlzLiNjb25uZWN0ZWQpIHtcbiAgICAgIHRoaXMuI2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5hcHBlYXJhbmNlT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtTGlua0NsaWNrT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgfVxuXG4gIGRpc2FibGVkQ2hhbmdlZCgpIHtcbiAgICBpZiAodGhpcy5sb2FkaW5nU3R5bGUgPT0gRnJhbWVMb2FkaW5nU3R5bGUuZWFnZXIpIHtcbiAgICAgIHRoaXMuI2xvYWRTb3VyY2VVUkwoKTtcbiAgICB9XG4gIH1cblxuICBzb3VyY2VVUkxDaGFuZ2VkKCkge1xuICAgIGlmICh0aGlzLiNpc0lnbm9yaW5nQ2hhbmdlc1RvKFwic3JjXCIpKSByZXR1cm5cblxuICAgIGlmICh0aGlzLmVsZW1lbnQuaXNDb25uZWN0ZWQpIHtcbiAgICAgIHRoaXMuY29tcGxldGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5sb2FkaW5nU3R5bGUgPT0gRnJhbWVMb2FkaW5nU3R5bGUuZWFnZXIgfHwgdGhpcy4jaGFzQmVlbkxvYWRlZCkge1xuICAgICAgdGhpcy4jbG9hZFNvdXJjZVVSTCgpO1xuICAgIH1cbiAgfVxuXG4gIHNvdXJjZVVSTFJlbG9hZGVkKCkge1xuICAgIGNvbnN0IHsgcmVmcmVzaCwgc3JjIH0gPSB0aGlzLmVsZW1lbnQ7XG5cbiAgICB0aGlzLiNzaG91bGRNb3JwaEZyYW1lID0gc3JjICYmIHJlZnJlc2ggPT09IFwibW9ycGhcIjtcblxuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKTtcbiAgICB0aGlzLmVsZW1lbnQuc3JjID0gbnVsbDtcbiAgICB0aGlzLmVsZW1lbnQuc3JjID0gc3JjO1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQubG9hZGVkXG4gIH1cblxuICBsb2FkaW5nU3R5bGVDaGFuZ2VkKCkge1xuICAgIGlmICh0aGlzLmxvYWRpbmdTdHlsZSA9PSBGcmFtZUxvYWRpbmdTdHlsZS5sYXp5KSB7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLiNsb2FkU291cmNlVVJMKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgI2xvYWRTb3VyY2VVUkwoKSB7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmlzQWN0aXZlICYmICF0aGlzLmNvbXBsZXRlICYmIHRoaXMuc291cmNlVVJMKSB7XG4gICAgICB0aGlzLmVsZW1lbnQubG9hZGVkID0gdGhpcy4jdmlzaXQoZXhwYW5kVVJMKHRoaXMuc291cmNlVVJMKSk7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdG9wKCk7XG4gICAgICBhd2FpdCB0aGlzLmVsZW1lbnQubG9hZGVkO1xuICAgICAgdGhpcy4jaGFzQmVlbkxvYWRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZFJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICBpZiAoZmV0Y2hSZXNwb25zZS5yZWRpcmVjdGVkIHx8IChmZXRjaFJlc3BvbnNlLnN1Y2NlZWRlZCAmJiBmZXRjaFJlc3BvbnNlLmlzSFRNTCkpIHtcbiAgICAgIHRoaXMuc291cmNlVVJMID0gZmV0Y2hSZXNwb25zZS5yZXNwb25zZS51cmw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcbiAgICAgIGlmIChodG1sKSB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gcGFyc2VIVE1MRG9jdW1lbnQoaHRtbCk7XG4gICAgICAgIGNvbnN0IHBhZ2VTbmFwc2hvdCA9IFBhZ2VTbmFwc2hvdC5mcm9tRG9jdW1lbnQoZG9jdW1lbnQpO1xuXG4gICAgICAgIGlmIChwYWdlU25hcHNob3QuaXNWaXNpdGFibGUpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLiNsb2FkRnJhbWVSZXNwb25zZShmZXRjaFJlc3BvbnNlLCBkb2N1bWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy4jaGFuZGxlVW52aXNpdGFibGVGcmFtZVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuI3Nob3VsZE1vcnBoRnJhbWUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZmV0Y2hSZXNwb25zZUxvYWRlZCA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFwcGVhcmFuY2Ugb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBlbGVtZW50QXBwZWFyZWRJblZpZXdwb3J0KGVsZW1lbnQpIHtcbiAgICB0aGlzLnByb3Bvc2VWaXNpdElmTmF2aWdhdGVkV2l0aEFjdGlvbihlbGVtZW50LCBnZXRWaXNpdEFjdGlvbihlbGVtZW50KSk7XG4gICAgdGhpcy4jbG9hZFNvdXJjZVVSTCgpO1xuICB9XG5cbiAgLy8gRm9ybSBsaW5rIGNsaWNrIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgd2lsbFN1Ym1pdEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuI3Nob3VsZEludGVyY2VwdE5hdmlnYXRpb24obGluaylcbiAgfVxuXG4gIHN1Ym1pdHRlZEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rLCBfbG9jYXRpb24sIGZvcm0pIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQobGluayk7XG4gICAgaWYgKGZyYW1lKSBmb3JtLnNldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgZnJhbWUuaWQpO1xuICB9XG5cbiAgLy8gTGluayBpbnRlcmNlcHRvciBkZWxlZ2F0ZVxuXG4gIHNob3VsZEludGVyY2VwdExpbmtDbGljayhlbGVtZW50LCBfbG9jYXRpb24sIF9ldmVudCkge1xuICAgIHJldHVybiB0aGlzLiNzaG91bGRJbnRlcmNlcHROYXZpZ2F0aW9uKGVsZW1lbnQpXG4gIH1cblxuICBsaW5rQ2xpY2tJbnRlcmNlcHRlZChlbGVtZW50LCBsb2NhdGlvbikge1xuICAgIHRoaXMuI25hdmlnYXRlRnJhbWUoZWxlbWVudCwgbG9jYXRpb24pO1xuICB9XG5cbiAgLy8gRm9ybSBzdWJtaXQgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybShlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KFwidHVyYm8tZnJhbWVcIikgPT0gdGhpcy5lbGVtZW50ICYmIHRoaXMuI3Nob3VsZEludGVyY2VwdE5hdmlnYXRpb24oZWxlbWVudCwgc3VibWl0dGVyKVxuICB9XG5cbiAgZm9ybVN1Ym1pdHRlZChlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBpZiAodGhpcy5mb3JtU3VibWlzc2lvbikge1xuICAgICAgdGhpcy5mb3JtU3VibWlzc2lvbi5zdG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy5mb3JtU3VibWlzc2lvbiA9IG5ldyBGb3JtU3VibWlzc2lvbih0aGlzLCBlbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IHsgZmV0Y2hSZXF1ZXN0IH0gPSB0aGlzLmZvcm1TdWJtaXNzaW9uO1xuICAgIHRoaXMucHJlcGFyZVJlcXVlc3QoZmV0Y2hSZXF1ZXN0KTtcbiAgICB0aGlzLmZvcm1TdWJtaXNzaW9uLnN0YXJ0KCk7XG4gIH1cblxuICAvLyBGZXRjaCByZXF1ZXN0IGRlbGVnYXRlXG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJlcXVlc3QuaGVhZGVyc1tcIlR1cmJvLUZyYW1lXCJdID0gdGhpcy5pZDtcblxuICAgIGlmICh0aGlzLmN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudD8uaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIikpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKF9yZXF1ZXN0KSB7XG4gICAgbWFya0FzQnVzeSh0aGlzLmVsZW1lbnQpO1xuICB9XG5cbiAgcmVxdWVzdFByZXZlbnRlZEhhbmRsaW5nUmVzcG9uc2UoX3JlcXVlc3QsIF9yZXNwb25zZSkge1xuICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKTtcbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRSZXNwb25zZShyZXNwb25zZSk7XG4gICAgdGhpcy4jcmVzb2x2ZVZpc2l0UHJvbWlzZSgpO1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdEZhaWxlZFdpdGhSZXNwb25zZShyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGF3YWl0IHRoaXMubG9hZFJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlKCk7XG4gIH1cblxuICByZXF1ZXN0RXJyb3JlZChyZXF1ZXN0LCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKTtcbiAgfVxuXG4gIHJlcXVlc3RGaW5pc2hlZChfcmVxdWVzdCkge1xuICAgIGNsZWFyQnVzeVN0YXRlKHRoaXMuZWxlbWVudCk7XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pc3Npb24gZGVsZWdhdGVcblxuICBmb3JtU3VibWlzc2lvblN0YXJ0ZWQoeyBmb3JtRWxlbWVudCB9KSB7XG4gICAgbWFya0FzQnVzeShmb3JtRWxlbWVudCwgdGhpcy4jZmluZEZyYW1lRWxlbWVudChmb3JtRWxlbWVudCkpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIHJlc3BvbnNlKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGZvcm1TdWJtaXNzaW9uLmZvcm1FbGVtZW50LCBmb3JtU3VibWlzc2lvbi5zdWJtaXR0ZXIpO1xuXG4gICAgZnJhbWUuZGVsZWdhdGUucHJvcG9zZVZpc2l0SWZOYXZpZ2F0ZWRXaXRoQWN0aW9uKGZyYW1lLCBnZXRWaXNpdEFjdGlvbihmb3JtU3VibWlzc2lvbi5zdWJtaXR0ZXIsIGZvcm1TdWJtaXNzaW9uLmZvcm1FbGVtZW50LCBmcmFtZSkpO1xuICAgIGZyYW1lLmRlbGVnYXRlLmxvYWRSZXNwb25zZShyZXNwb25zZSk7XG5cbiAgICBpZiAoIWZvcm1TdWJtaXNzaW9uLmlzU2FmZSkge1xuICAgICAgc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG4gICAgfVxuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICB0aGlzLmVsZW1lbnQuZGVsZWdhdGUubG9hZFJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgIHNlc3Npb24uY2xlYXJDYWNoZSgpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25FcnJvcmVkKGZvcm1TdWJtaXNzaW9uLCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GaW5pc2hlZCh7IGZvcm1FbGVtZW50IH0pIHtcbiAgICBjbGVhckJ1c3lTdGF0ZShmb3JtRWxlbWVudCwgdGhpcy4jZmluZEZyYW1lRWxlbWVudChmb3JtRWxlbWVudCkpO1xuICB9XG5cbiAgLy8gVmlldyBkZWxlZ2F0ZVxuXG4gIGFsbG93c0ltbWVkaWF0ZVJlbmRlcih7IGVsZW1lbnQ6IG5ld0ZyYW1lIH0sIG9wdGlvbnMpIHtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZyYW1lLXJlbmRlclwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMuZWxlbWVudCxcbiAgICAgIGRldGFpbDogeyBuZXdGcmFtZSwgLi4ub3B0aW9ucyB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgY29uc3Qge1xuICAgICAgZGVmYXVsdFByZXZlbnRlZCxcbiAgICAgIGRldGFpbDogeyByZW5kZXIgfVxuICAgIH0gPSBldmVudDtcblxuICAgIGlmICh0aGlzLnZpZXcucmVuZGVyZXIgJiYgcmVuZGVyKSB7XG4gICAgICB0aGlzLnZpZXcucmVuZGVyZXIucmVuZGVyRWxlbWVudCA9IHJlbmRlcjtcbiAgICB9XG5cbiAgICByZXR1cm4gIWRlZmF1bHRQcmV2ZW50ZWRcbiAgfVxuXG4gIHZpZXdSZW5kZXJlZFNuYXBzaG90KF9zbmFwc2hvdCwgX2lzUHJldmlldywgX3JlbmRlck1ldGhvZCkge31cblxuICBwcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KGVsZW1lbnQpIHtcbiAgICBzZXNzaW9uLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZWxlbWVudCk7XG4gIH1cblxuICB2aWV3SW52YWxpZGF0ZWQoKSB7fVxuXG4gIC8vIEZyYW1lIHJlbmRlcmVyIGRlbGVnYXRlXG5cbiAgd2lsbFJlbmRlckZyYW1lKGN1cnJlbnRFbGVtZW50LCBfbmV3RWxlbWVudCkge1xuICAgIHRoaXMucHJldmlvdXNGcmFtZUVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICB2aXNpdENhY2hlZFNuYXBzaG90ID0gKHsgZWxlbWVudCB9KSA9PiB7XG4gICAgY29uc3QgZnJhbWUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyB0aGlzLmVsZW1lbnQuaWQpO1xuXG4gICAgaWYgKGZyYW1lICYmIHRoaXMucHJldmlvdXNGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGZyYW1lLnJlcGxhY2VDaGlsZHJlbiguLi50aGlzLnByZXZpb3VzRnJhbWVFbGVtZW50LmNoaWxkcmVuKTtcbiAgICB9XG5cbiAgICBkZWxldGUgdGhpcy5wcmV2aW91c0ZyYW1lRWxlbWVudDtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBhc3luYyAjbG9hZEZyYW1lUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSwgZG9jdW1lbnQpIHtcbiAgICBjb25zdCBuZXdGcmFtZUVsZW1lbnQgPSBhd2FpdCB0aGlzLmV4dHJhY3RGb3JlaWduRnJhbWVFbGVtZW50KGRvY3VtZW50LmJvZHkpO1xuICAgIGNvbnN0IHJlbmRlcmVyQ2xhc3MgPSB0aGlzLiNzaG91bGRNb3JwaEZyYW1lID8gTW9ycGhpbmdGcmFtZVJlbmRlcmVyIDogRnJhbWVSZW5kZXJlcjtcblxuICAgIGlmIChuZXdGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gbmV3IFNuYXBzaG90KG5ld0ZyYW1lRWxlbWVudCk7XG4gICAgICBjb25zdCByZW5kZXJlciA9IG5ldyByZW5kZXJlckNsYXNzKHRoaXMsIHRoaXMudmlldy5zbmFwc2hvdCwgc25hcHNob3QsIGZhbHNlLCBmYWxzZSk7XG4gICAgICBpZiAodGhpcy52aWV3LnJlbmRlclByb21pc2UpIGF3YWl0IHRoaXMudmlldy5yZW5kZXJQcm9taXNlO1xuICAgICAgdGhpcy5jaGFuZ2VIaXN0b3J5KCk7XG5cbiAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXIocmVuZGVyZXIpO1xuICAgICAgdGhpcy5jb21wbGV0ZSA9IHRydWU7XG4gICAgICBzZXNzaW9uLmZyYW1lUmVuZGVyZWQoZmV0Y2hSZXNwb25zZSwgdGhpcy5lbGVtZW50KTtcbiAgICAgIHNlc3Npb24uZnJhbWVMb2FkZWQodGhpcy5lbGVtZW50KTtcbiAgICAgIGF3YWl0IHRoaXMuZmV0Y2hSZXNwb25zZUxvYWRlZChmZXRjaFJlc3BvbnNlKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuI3dpbGxIYW5kbGVGcmFtZU1pc3NpbmdGcm9tUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSkpIHtcbiAgICAgIHRoaXMuI2hhbmRsZUZyYW1lTWlzc2luZ0Zyb21SZXNwb25zZShmZXRjaFJlc3BvbnNlKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyAjdmlzaXQodXJsKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QodGhpcywgRmV0Y2hNZXRob2QuZ2V0LCB1cmwsIG5ldyBVUkxTZWFyY2hQYXJhbXMoKSwgdGhpcy5lbGVtZW50KTtcblxuICAgIHRoaXMuI2N1cnJlbnRGZXRjaFJlcXVlc3Q/LmNhbmNlbCgpO1xuICAgIHRoaXMuI2N1cnJlbnRGZXRjaFJlcXVlc3QgPSByZXF1ZXN0O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlID0gKCkgPT4ge307XG4gICAgICAgIHRoaXMuI2N1cnJlbnRGZXRjaFJlcXVlc3QgPSBudWxsO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgcmVxdWVzdC5wZXJmb3JtKCk7XG4gICAgfSlcbiAgfVxuXG4gICNuYXZpZ2F0ZUZyYW1lKGVsZW1lbnQsIHVybCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQsIHN1Ym1pdHRlcik7XG5cbiAgICBmcmFtZS5kZWxlZ2F0ZS5wcm9wb3NlVmlzaXRJZk5hdmlnYXRlZFdpdGhBY3Rpb24oZnJhbWUsIGdldFZpc2l0QWN0aW9uKHN1Ym1pdHRlciwgZWxlbWVudCwgZnJhbWUpKTtcblxuICAgIHRoaXMuI3dpdGhDdXJyZW50TmF2aWdhdGlvbkVsZW1lbnQoZWxlbWVudCwgKCkgPT4ge1xuICAgICAgZnJhbWUuc3JjID0gdXJsO1xuICAgIH0pO1xuICB9XG5cbiAgcHJvcG9zZVZpc2l0SWZOYXZpZ2F0ZWRXaXRoQWN0aW9uKGZyYW1lLCBhY3Rpb24gPSBudWxsKSB7XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG5cbiAgICBpZiAodGhpcy5hY3Rpb24pIHtcbiAgICAgIGNvbnN0IHBhZ2VTbmFwc2hvdCA9IFBhZ2VTbmFwc2hvdC5mcm9tRWxlbWVudChmcmFtZSkuY2xvbmUoKTtcbiAgICAgIGNvbnN0IHsgdmlzaXRDYWNoZWRTbmFwc2hvdCB9ID0gZnJhbWUuZGVsZWdhdGU7XG5cbiAgICAgIGZyYW1lLmRlbGVnYXRlLmZldGNoUmVzcG9uc2VMb2FkZWQgPSBhc3luYyAoZmV0Y2hSZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoZnJhbWUuc3JjKSB7XG4gICAgICAgICAgY29uc3QgeyBzdGF0dXNDb2RlLCByZWRpcmVjdGVkIH0gPSBmZXRjaFJlc3BvbnNlO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IGZldGNoUmVzcG9uc2UucmVzcG9uc2VIVE1MO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0geyBzdGF0dXNDb2RlLCByZWRpcmVjdGVkLCByZXNwb25zZUhUTUwgfTtcbiAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICB2aXNpdENhY2hlZFNuYXBzaG90LFxuICAgICAgICAgICAgd2lsbFJlbmRlcjogZmFsc2UsXG4gICAgICAgICAgICB1cGRhdGVIaXN0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgIHJlc3RvcmF0aW9uSWRlbnRpZmllcjogdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIsXG4gICAgICAgICAgICBzbmFwc2hvdDogcGFnZVNuYXBzaG90XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGlmICh0aGlzLmFjdGlvbikgb3B0aW9ucy5hY3Rpb24gPSB0aGlzLmFjdGlvbjtcblxuICAgICAgICAgIHNlc3Npb24udmlzaXQoZnJhbWUuc3JjLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBjaGFuZ2VIaXN0b3J5KCkge1xuICAgIGlmICh0aGlzLmFjdGlvbikge1xuICAgICAgY29uc3QgbWV0aG9kID0gZ2V0SGlzdG9yeU1ldGhvZEZvckFjdGlvbih0aGlzLmFjdGlvbik7XG4gICAgICBzZXNzaW9uLmhpc3RvcnkudXBkYXRlKG1ldGhvZCwgZXhwYW5kVVJMKHRoaXMuZWxlbWVudC5zcmMgfHwgXCJcIiksIHRoaXMucmVzdG9yYXRpb25JZGVudGlmaWVyKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyAjaGFuZGxlVW52aXNpdGFibGVGcmFtZVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBgVGhlIHJlc3BvbnNlICgke2ZldGNoUmVzcG9uc2Uuc3RhdHVzQ29kZX0pIGZyb20gPHR1cmJvLWZyYW1lIGlkPVwiJHt0aGlzLmVsZW1lbnQuaWR9XCI+IGlzIHBlcmZvcm1pbmcgYSBmdWxsIHBhZ2UgdmlzaXQgZHVlIHRvIHR1cmJvLXZpc2l0LWNvbnRyb2wuYFxuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLiN2aXNpdFJlc3BvbnNlKGZldGNoUmVzcG9uc2UucmVzcG9uc2UpO1xuICB9XG5cbiAgI3dpbGxIYW5kbGVGcmFtZU1pc3NpbmdGcm9tUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSkge1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiLCBcIlwiKTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gZmV0Y2hSZXNwb25zZS5yZXNwb25zZTtcbiAgICBjb25zdCB2aXNpdCA9IGFzeW5jICh1cmwsIG9wdGlvbnMpID0+IHtcbiAgICAgIGlmICh1cmwgaW5zdGFuY2VvZiBSZXNwb25zZSkge1xuICAgICAgICB0aGlzLiN2aXNpdFJlc3BvbnNlKHVybCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXNzaW9uLnZpc2l0KHVybCwgb3B0aW9ucyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpmcmFtZS1taXNzaW5nXCIsIHtcbiAgICAgIHRhcmdldDogdGhpcy5lbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IHJlc3BvbnNlLCB2aXNpdCB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICAjaGFuZGxlRnJhbWVNaXNzaW5nRnJvbVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICB0aGlzLnZpZXcubWlzc2luZygpO1xuICAgIHRoaXMuI3Rocm93RnJhbWVNaXNzaW5nRXJyb3IoZmV0Y2hSZXNwb25zZSk7XG4gIH1cblxuICAjdGhyb3dGcmFtZU1pc3NpbmdFcnJvcihmZXRjaFJlc3BvbnNlKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGBUaGUgcmVzcG9uc2UgKCR7ZmV0Y2hSZXNwb25zZS5zdGF0dXNDb2RlfSkgZGlkIG5vdCBjb250YWluIHRoZSBleHBlY3RlZCA8dHVyYm8tZnJhbWUgaWQ9XCIke3RoaXMuZWxlbWVudC5pZH1cIj4gYW5kIHdpbGwgYmUgaWdub3JlZC4gVG8gcGVyZm9ybSBhIGZ1bGwgcGFnZSB2aXNpdCBpbnN0ZWFkLCBzZXQgdHVyYm8tdmlzaXQtY29udHJvbCB0byByZWxvYWQuYDtcbiAgICB0aHJvdyBuZXcgVHVyYm9GcmFtZU1pc3NpbmdFcnJvcihtZXNzYWdlKVxuICB9XG5cbiAgYXN5bmMgI3Zpc2l0UmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICBjb25zdCB3cmFwcGVkID0gbmV3IEZldGNoUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IHdyYXBwZWQucmVzcG9uc2VIVE1MO1xuICAgIGNvbnN0IHsgbG9jYXRpb24sIHJlZGlyZWN0ZWQsIHN0YXR1c0NvZGUgfSA9IHdyYXBwZWQ7XG5cbiAgICByZXR1cm4gc2Vzc2lvbi52aXNpdChsb2NhdGlvbiwgeyByZXNwb25zZTogeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlLCByZXNwb25zZUhUTUwgfSB9KVxuICB9XG5cbiAgI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgaWQgPSBnZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIsIHN1Ym1pdHRlciwgZWxlbWVudCkgfHwgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShcInRhcmdldFwiKTtcbiAgICByZXR1cm4gZ2V0RnJhbWVFbGVtZW50QnlJZChpZCkgPz8gdGhpcy5lbGVtZW50XG4gIH1cblxuICBhc3luYyBleHRyYWN0Rm9yZWlnbkZyYW1lRWxlbWVudChjb250YWluZXIpIHtcbiAgICBsZXQgZWxlbWVudDtcbiAgICBjb25zdCBpZCA9IENTUy5lc2NhcGUodGhpcy5pZCk7XG5cbiAgICB0cnkge1xuICAgICAgZWxlbWVudCA9IGFjdGl2YXRlRWxlbWVudChjb250YWluZXIucXVlcnlTZWxlY3RvcihgdHVyYm8tZnJhbWUjJHtpZH1gKSwgdGhpcy5zb3VyY2VVUkwpO1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRcbiAgICAgIH1cblxuICAgICAgZWxlbWVudCA9IGFjdGl2YXRlRWxlbWVudChjb250YWluZXIucXVlcnlTZWxlY3RvcihgdHVyYm8tZnJhbWVbc3JjXVtyZWN1cnNlfj0ke2lkfV1gKSwgdGhpcy5zb3VyY2VVUkwpO1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgYXdhaXQgZWxlbWVudC5sb2FkZWQ7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmV4dHJhY3RGb3JlaWduRnJhbWVFbGVtZW50KGVsZW1lbnQpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmV0dXJuIG5ldyBGcmFtZUVsZW1lbnQoKVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAjZm9ybUFjdGlvbklzVmlzaXRhYmxlKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGFjdGlvbiA9IGdldEFjdGlvbiQxKGZvcm0sIHN1Ym1pdHRlcik7XG5cbiAgICByZXR1cm4gbG9jYXRpb25Jc1Zpc2l0YWJsZShleHBhbmRVUkwoYWN0aW9uKSwgdGhpcy5yb290TG9jYXRpb24pXG4gIH1cblxuICAjc2hvdWxkSW50ZXJjZXB0TmF2aWdhdGlvbihlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBpZCA9IGdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgc3VibWl0dGVyLCBlbGVtZW50KSB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidGFyZ2V0XCIpO1xuXG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnQgJiYgIXRoaXMuI2Zvcm1BY3Rpb25Jc1Zpc2l0YWJsZShlbGVtZW50LCBzdWJtaXR0ZXIpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZW5hYmxlZCB8fCBpZCA9PSBcIl90b3BcIikge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKGlkKSB7XG4gICAgICBjb25zdCBmcmFtZUVsZW1lbnQgPSBnZXRGcmFtZUVsZW1lbnRCeUlkKGlkKTtcbiAgICAgIGlmIChmcmFtZUVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuICFmcmFtZUVsZW1lbnQuZGlzYWJsZWRcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXNlc3Npb24uZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmIChzdWJtaXR0ZXIgJiYgIXNlc3Npb24uZWxlbWVudElzTmF2aWdhdGFibGUoc3VibWl0dGVyKSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8vIENvbXB1dGVkIHByb3BlcnRpZXNcblxuICBnZXQgaWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pZFxuICB9XG5cbiAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgcmV0dXJuICF0aGlzLmVsZW1lbnQuZGlzYWJsZWRcbiAgfVxuXG4gIGdldCBzb3VyY2VVUkwoKSB7XG4gICAgaWYgKHRoaXMuZWxlbWVudC5zcmMpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuc3JjXG4gICAgfVxuICB9XG5cbiAgc2V0IHNvdXJjZVVSTChzb3VyY2VVUkwpIHtcbiAgICB0aGlzLiNpZ25vcmluZ0NoYW5nZXNUb0F0dHJpYnV0ZShcInNyY1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmVsZW1lbnQuc3JjID0gc291cmNlVVJMID8/IG51bGw7XG4gICAgfSk7XG4gIH1cblxuICBnZXQgbG9hZGluZ1N0eWxlKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQubG9hZGluZ1xuICB9XG5cbiAgZ2V0IGlzTG9hZGluZygpIHtcbiAgICByZXR1cm4gdGhpcy5mb3JtU3VibWlzc2lvbiAhPT0gdW5kZWZpbmVkIHx8IHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKSAhPT0gdW5kZWZpbmVkXG4gIH1cblxuICBnZXQgY29tcGxldGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKVxuICB9XG5cbiAgc2V0IGNvbXBsZXRlKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiY29tcGxldGVcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKTtcbiAgICB9XG4gIH1cblxuICBnZXQgaXNBY3RpdmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pc0FjdGl2ZSAmJiB0aGlzLiNjb25uZWN0ZWRcbiAgfVxuXG4gIGdldCByb290TG9jYXRpb24oKSB7XG4gICAgY29uc3QgbWV0YSA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYG1ldGFbbmFtZT1cInR1cmJvLXJvb3RcIl1gKTtcbiAgICBjb25zdCByb290ID0gbWV0YT8uY29udGVudCA/PyBcIi9cIjtcbiAgICByZXR1cm4gZXhwYW5kVVJMKHJvb3QpXG4gIH1cblxuICAjaXNJZ25vcmluZ0NoYW5nZXNUbyhhdHRyaWJ1dGVOYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuI2lnbm9yZWRBdHRyaWJ1dGVzLmhhcyhhdHRyaWJ1dGVOYW1lKVxuICB9XG5cbiAgI2lnbm9yaW5nQ2hhbmdlc1RvQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy4jaWdub3JlZEF0dHJpYnV0ZXMuYWRkKGF0dHJpYnV0ZU5hbWUpO1xuICAgIGNhbGxiYWNrKCk7XG4gICAgdGhpcy4jaWdub3JlZEF0dHJpYnV0ZXMuZGVsZXRlKGF0dHJpYnV0ZU5hbWUpO1xuICB9XG5cbiAgI3dpdGhDdXJyZW50TmF2aWdhdGlvbkVsZW1lbnQoZWxlbWVudCwgY2FsbGJhY2spIHtcbiAgICB0aGlzLmN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgY2FsbGJhY2soKTtcbiAgICBkZWxldGUgdGhpcy5jdXJyZW50TmF2aWdhdGlvbkVsZW1lbnQ7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RnJhbWVFbGVtZW50QnlJZChpZCkge1xuICBpZiAoaWQgIT0gbnVsbCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBlbGVtZW50XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGFjdGl2YXRlRWxlbWVudChlbGVtZW50LCBjdXJyZW50VVJMKSB7XG4gIGlmIChlbGVtZW50KSB7XG4gICAgY29uc3Qgc3JjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJzcmNcIik7XG4gICAgaWYgKHNyYyAhPSBudWxsICYmIGN1cnJlbnRVUkwgIT0gbnVsbCAmJiB1cmxzQXJlRXF1YWwoc3JjLCBjdXJyZW50VVJMKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBNYXRjaGluZyA8dHVyYm8tZnJhbWUgaWQ9XCIke2VsZW1lbnQuaWR9XCI+IGVsZW1lbnQgaGFzIGEgc291cmNlIFVSTCB3aGljaCByZWZlcmVuY2VzIGl0c2VsZmApXG4gICAgfVxuICAgIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQgIT09IGRvY3VtZW50KSB7XG4gICAgICBlbGVtZW50ID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShlbGVtZW50LCB0cnVlKTtcbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEZyYW1lRWxlbWVudCkge1xuICAgICAgZWxlbWVudC5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgICAgZWxlbWVudC5kaXNjb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgICAgcmV0dXJuIGVsZW1lbnRcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgU3RyZWFtQWN0aW9ucyA9IHtcbiAgYWZ0ZXIoKSB7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZSh0aGlzLnRlbXBsYXRlQ29udGVudCwgZS5uZXh0U2libGluZykpO1xuICB9LFxuXG4gIGFwcGVuZCgpIHtcbiAgICB0aGlzLnJlbW92ZUR1cGxpY2F0ZVRhcmdldENoaWxkcmVuKCk7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLmFwcGVuZCh0aGlzLnRlbXBsYXRlQ29udGVudCkpO1xuICB9LFxuXG4gIGJlZm9yZSgpIHtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKGUpID0+IGUucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKHRoaXMudGVtcGxhdGVDb250ZW50LCBlKSk7XG4gIH0sXG5cbiAgcHJlcGVuZCgpIHtcbiAgICB0aGlzLnJlbW92ZUR1cGxpY2F0ZVRhcmdldENoaWxkcmVuKCk7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLnByZXBlbmQodGhpcy50ZW1wbGF0ZUNvbnRlbnQpKTtcbiAgfSxcblxuICByZW1vdmUoKSB7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLnJlbW92ZSgpKTtcbiAgfSxcblxuICByZXBsYWNlKCkge1xuICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuZ2V0QXR0cmlidXRlKFwibWV0aG9kXCIpO1xuXG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKCh0YXJnZXRFbGVtZW50KSA9PiB7XG4gICAgICBpZiAobWV0aG9kID09PSBcIm1vcnBoXCIpIHtcbiAgICAgICAgbW9ycGhFbGVtZW50cyh0YXJnZXRFbGVtZW50LCB0aGlzLnRlbXBsYXRlQ29udGVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXRFbGVtZW50LnJlcGxhY2VXaXRoKHRoaXMudGVtcGxhdGVDb250ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICB1cGRhdGUoKSB7XG4gICAgY29uc3QgbWV0aG9kID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIik7XG5cbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKHRhcmdldEVsZW1lbnQpID0+IHtcbiAgICAgIGlmIChtZXRob2QgPT09IFwibW9ycGhcIikge1xuICAgICAgICBtb3JwaENoaWxkcmVuKHRhcmdldEVsZW1lbnQsIHRoaXMudGVtcGxhdGVDb250ZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldEVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgdGFyZ2V0RWxlbWVudC5hcHBlbmQodGhpcy50ZW1wbGF0ZUNvbnRlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIHJlZnJlc2goKSB7XG4gICAgc2Vzc2lvbi5yZWZyZXNoKHRoaXMuYmFzZVVSSSwgdGhpcy5yZXF1ZXN0SWQpO1xuICB9XG59O1xuXG4vLyA8dHVyYm8tc3RyZWFtIGFjdGlvbj1yZXBsYWNlIHRhcmdldD1pZD48dGVtcGxhdGU+Li4uXG5cbi8qKlxuICogUmVuZGVycyB1cGRhdGVzIHRvIHRoZSBwYWdlIGZyb20gYSBzdHJlYW0gb2YgbWVzc2FnZXMuXG4gKlxuICogVXNpbmcgdGhlIGBhY3Rpb25gIGF0dHJpYnV0ZSwgdGhpcyBjYW4gYmUgY29uZmlndXJlZCBvbmUgb2YgZWlnaHQgd2F5czpcbiAqXG4gKiAtIGBhZnRlcmAgLSBpbnNlcnRzIHRoZSByZXN1bHQgYWZ0ZXIgdGhlIHRhcmdldFxuICogLSBgYXBwZW5kYCAtIGFwcGVuZHMgdGhlIHJlc3VsdCB0byB0aGUgdGFyZ2V0XG4gKiAtIGBiZWZvcmVgIC0gaW5zZXJ0cyB0aGUgcmVzdWx0IGJlZm9yZSB0aGUgdGFyZ2V0XG4gKiAtIGBwcmVwZW5kYCAtIHByZXBlbmRzIHRoZSByZXN1bHQgdG8gdGhlIHRhcmdldFxuICogLSBgcmVmcmVzaGAgLSBpbml0aWF0ZXMgYSBwYWdlIHJlZnJlc2hcbiAqIC0gYHJlbW92ZWAgLSByZW1vdmVzIHRoZSB0YXJnZXRcbiAqIC0gYHJlcGxhY2VgIC0gcmVwbGFjZXMgdGhlIG91dGVyIEhUTUwgb2YgdGhlIHRhcmdldFxuICogLSBgdXBkYXRlYCAtIHJlcGxhY2VzIHRoZSBpbm5lciBIVE1MIG9mIHRoZSB0YXJnZXRcbiAqXG4gKiBAY3VzdG9tRWxlbWVudCB0dXJiby1zdHJlYW1cbiAqIEBleGFtcGxlXG4gKiAgIDx0dXJiby1zdHJlYW0gYWN0aW9uPVwiYXBwZW5kXCIgdGFyZ2V0PVwiZG9tX2lkXCI+XG4gKiAgICAgPHRlbXBsYXRlPlxuICogICAgICAgQ29udGVudCB0byBhcHBlbmQgdG8gdGFyZ2V0IGRlc2lnbmF0ZWQgd2l0aCB0aGUgZG9tX2lkLlxuICogICAgIDwvdGVtcGxhdGU+XG4gKiAgIDwvdHVyYm8tc3RyZWFtPlxuICovXG5jbGFzcyBTdHJlYW1FbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdGF0aWMgYXN5bmMgcmVuZGVyRWxlbWVudChuZXdFbGVtZW50KSB7XG4gICAgYXdhaXQgbmV3RWxlbWVudC5wZXJmb3JtQWN0aW9uKCk7XG4gIH1cblxuICBhc3luYyBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZGlzY29ubmVjdCgpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKHRoaXMucmVuZGVyUHJvbWlzZSA/Pz0gKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5iZWZvcmVSZW5kZXJFdmVudDtcblxuICAgICAgaWYgKHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCkpIHtcbiAgICAgICAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICAgICAgYXdhaXQgZXZlbnQuZGV0YWlsLnJlbmRlcih0aGlzKTtcbiAgICAgIH1cbiAgICB9KSgpKVxuICB9XG5cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICAgIH0gY2F0Y2gge31cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBjaGlsZHJlbiAoYnkgSUQpXG4gICAqL1xuICByZW1vdmVEdXBsaWNhdGVUYXJnZXRDaGlsZHJlbigpIHtcbiAgICB0aGlzLmR1cGxpY2F0ZUNoaWxkcmVuLmZvckVhY2goKGMpID0+IGMucmVtb3ZlKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGxpc3Qgb2YgZHVwbGljYXRlIGNoaWxkcmVuIChpLmUuIHRob3NlIHdpdGggdGhlIHNhbWUgSUQpXG4gICAqL1xuICBnZXQgZHVwbGljYXRlQ2hpbGRyZW4oKSB7XG4gICAgY29uc3QgZXhpc3RpbmdDaGlsZHJlbiA9IHRoaXMudGFyZ2V0RWxlbWVudHMuZmxhdE1hcCgoZSkgPT4gWy4uLmUuY2hpbGRyZW5dKS5maWx0ZXIoKGMpID0+ICEhYy5pZCk7XG4gICAgY29uc3QgbmV3Q2hpbGRyZW5JZHMgPSBbLi4uKHRoaXMudGVtcGxhdGVDb250ZW50Py5jaGlsZHJlbiB8fCBbXSldLmZpbHRlcigoYykgPT4gISFjLmlkKS5tYXAoKGMpID0+IGMuaWQpO1xuXG4gICAgcmV0dXJuIGV4aXN0aW5nQ2hpbGRyZW4uZmlsdGVyKChjKSA9PiBuZXdDaGlsZHJlbklkcy5pbmNsdWRlcyhjLmlkKSlcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBhY3Rpb24gZnVuY3Rpb24gdG8gYmUgcGVyZm9ybWVkLlxuICAgKi9cbiAgZ2V0IHBlcmZvcm1BY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuYWN0aW9uKSB7XG4gICAgICBjb25zdCBhY3Rpb25GdW5jdGlvbiA9IFN0cmVhbUFjdGlvbnNbdGhpcy5hY3Rpb25dO1xuICAgICAgaWYgKGFjdGlvbkZ1bmN0aW9uKSB7XG4gICAgICAgIHJldHVybiBhY3Rpb25GdW5jdGlvblxuICAgICAgfVxuICAgICAgdGhpcy4jcmFpc2UoXCJ1bmtub3duIGFjdGlvblwiKTtcbiAgICB9XG4gICAgdGhpcy4jcmFpc2UoXCJhY3Rpb24gYXR0cmlidXRlIGlzIG1pc3NpbmdcIik7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgdGFyZ2V0IGVsZW1lbnRzIHdoaWNoIHRoZSB0ZW1wbGF0ZSB3aWxsIGJlIHJlbmRlcmVkIHRvLlxuICAgKi9cbiAgZ2V0IHRhcmdldEVsZW1lbnRzKCkge1xuICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0RWxlbWVudHNCeUlkXG4gICAgfSBlbHNlIGlmICh0aGlzLnRhcmdldHMpIHtcbiAgICAgIHJldHVybiB0aGlzLnRhcmdldEVsZW1lbnRzQnlRdWVyeVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiNyYWlzZShcInRhcmdldCBvciB0YXJnZXRzIGF0dHJpYnV0ZSBpcyBtaXNzaW5nXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb250ZW50cyBvZiB0aGUgbWFpbiBgPHRlbXBsYXRlPmAuXG4gICAqL1xuICBnZXQgdGVtcGxhdGVDb250ZW50KCkge1xuICAgIHJldHVybiB0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LmNsb25lTm9kZSh0cnVlKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1haW4gYDx0ZW1wbGF0ZT5gIHVzZWQgZm9yIHJlbmRlcmluZ1xuICAgKi9cbiAgZ2V0IHRlbXBsYXRlRWxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5maXJzdEVsZW1lbnRDaGlsZCA9PT0gbnVsbCkge1xuICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRlbXBsYXRlXCIpO1xuICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0ZW1wbGF0ZSk7XG4gICAgICByZXR1cm4gdGVtcGxhdGVcbiAgICB9IGVsc2UgaWYgKHRoaXMuZmlyc3RFbGVtZW50Q2hpbGQgaW5zdGFuY2VvZiBIVE1MVGVtcGxhdGVFbGVtZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5maXJzdEVsZW1lbnRDaGlsZFxuICAgIH1cbiAgICB0aGlzLiNyYWlzZShcImZpcnN0IGNoaWxkIGVsZW1lbnQgbXVzdCBiZSBhIDx0ZW1wbGF0ZT4gZWxlbWVudFwiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IGFjdGlvbi5cbiAgICovXG4gIGdldCBhY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpXG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCB0YXJnZXQgKGFuIGVsZW1lbnQgSUQpIHRvIHdoaWNoIHRoZSByZXN1bHQgd2lsbFxuICAgKiBiZSByZW5kZXJlZC5cbiAgICovXG4gIGdldCB0YXJnZXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwidGFyZ2V0XCIpXG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBcInRhcmdldHNcIiBzZWxlY3RvciAoYSBDU1Mgc2VsZWN0b3IpXG4gICAqL1xuICBnZXQgdGFyZ2V0cygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRzXCIpXG4gIH1cblxuICAvKipcbiAgICogUmVhZHMgdGhlIHJlcXVlc3QtaWQgYXR0cmlidXRlXG4gICAqL1xuICBnZXQgcmVxdWVzdElkKCkge1xuICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZShcInJlcXVlc3QtaWRcIilcbiAgfVxuXG4gICNyYWlzZShtZXNzYWdlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke3RoaXMuZGVzY3JpcHRpb259OiAke21lc3NhZ2V9YClcbiAgfVxuXG4gIGdldCBkZXNjcmlwdGlvbigpIHtcbiAgICByZXR1cm4gKHRoaXMub3V0ZXJIVE1MLm1hdGNoKC88W14+XSs+LykgPz8gW10pWzBdID8/IFwiPHR1cmJvLXN0cmVhbT5cIlxuICB9XG5cbiAgZ2V0IGJlZm9yZVJlbmRlckV2ZW50KCkge1xuICAgIHJldHVybiBuZXcgQ3VzdG9tRXZlbnQoXCJ0dXJibzpiZWZvcmUtc3RyZWFtLXJlbmRlclwiLCB7XG4gICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyBuZXdTdHJlYW06IHRoaXMsIHJlbmRlcjogU3RyZWFtRWxlbWVudC5yZW5kZXJFbGVtZW50IH1cbiAgICB9KVxuICB9XG5cbiAgZ2V0IHRhcmdldEVsZW1lbnRzQnlJZCgpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5vd25lckRvY3VtZW50Py5nZXRFbGVtZW50QnlJZCh0aGlzLnRhcmdldCk7XG5cbiAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIFtlbGVtZW50XVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cblxuICBnZXQgdGFyZ2V0RWxlbWVudHNCeVF1ZXJ5KCkge1xuICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5vd25lckRvY3VtZW50Py5xdWVyeVNlbGVjdG9yQWxsKHRoaXMudGFyZ2V0cyk7XG5cbiAgICBpZiAoZWxlbWVudHMubGVuZ3RoICE9PSAwKSB7XG4gICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZWxlbWVudHMpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBTdHJlYW1Tb3VyY2VFbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdHJlYW1Tb3VyY2UgPSBudWxsXG5cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5zdHJlYW1Tb3VyY2UgPSB0aGlzLnNyYy5tYXRjaCgvXndzezEsMn06LykgPyBuZXcgV2ViU29ja2V0KHRoaXMuc3JjKSA6IG5ldyBFdmVudFNvdXJjZSh0aGlzLnNyYyk7XG5cbiAgICBjb25uZWN0U3RyZWFtU291cmNlKHRoaXMuc3RyZWFtU291cmNlKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGlmICh0aGlzLnN0cmVhbVNvdXJjZSkge1xuICAgICAgdGhpcy5zdHJlYW1Tb3VyY2UuY2xvc2UoKTtcblxuICAgICAgZGlzY29ubmVjdFN0cmVhbVNvdXJjZSh0aGlzLnN0cmVhbVNvdXJjZSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNyYygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgfHwgXCJcIlxuICB9XG59XG5cbkZyYW1lRWxlbWVudC5kZWxlZ2F0ZUNvbnN0cnVjdG9yID0gRnJhbWVDb250cm9sbGVyO1xuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KFwidHVyYm8tZnJhbWVcIikgPT09IHVuZGVmaW5lZCkge1xuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoXCJ0dXJiby1mcmFtZVwiLCBGcmFtZUVsZW1lbnQpO1xufVxuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KFwidHVyYm8tc3RyZWFtXCIpID09PSB1bmRlZmluZWQpIHtcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKFwidHVyYm8tc3RyZWFtXCIsIFN0cmVhbUVsZW1lbnQpO1xufVxuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KFwidHVyYm8tc3RyZWFtLXNvdXJjZVwiKSA9PT0gdW5kZWZpbmVkKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcInR1cmJvLXN0cmVhbS1zb3VyY2VcIiwgU3RyZWFtU291cmNlRWxlbWVudCk7XG59XG5cbigoKSA9PiB7XG4gIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdDtcbiAgaWYgKCFlbGVtZW50KSByZXR1cm5cbiAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdXBwcmVzcy13YXJuaW5nXCIpKSByZXR1cm5cblxuICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICB3aGlsZSAoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50ID09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLndhcm4oXG4gICAgICAgIHVuaW5kZW50YFxuICAgICAgICBZb3UgYXJlIGxvYWRpbmcgVHVyYm8gZnJvbSBhIDxzY3JpcHQ+IGVsZW1lbnQgaW5zaWRlIHRoZSA8Ym9keT4gZWxlbWVudC4gVGhpcyBpcyBwcm9iYWJseSBub3Qgd2hhdCB5b3UgbWVhbnQgdG8gZG8hXG5cbiAgICAgICAgTG9hZCB5b3VyIGFwcGxpY2F0aW9u4oCZcyBKYXZhU2NyaXB0IGJ1bmRsZSBpbnNpZGUgdGhlIDxoZWFkPiBlbGVtZW50IGluc3RlYWQuIDxzY3JpcHQ+IGVsZW1lbnRzIGluIDxib2R5PiBhcmUgZXZhbHVhdGVkIHdpdGggZWFjaCBwYWdlIGNoYW5nZS5cblxuICAgICAgICBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlOiBodHRwczovL3R1cmJvLmhvdHdpcmVkLmRldi9oYW5kYm9vay9idWlsZGluZyN3b3JraW5nLXdpdGgtc2NyaXB0LWVsZW1lbnRzXG5cbiAgICAgICAg4oCU4oCUXG4gICAgICAgIFN1cHByZXNzIHRoaXMgd2FybmluZyBieSBhZGRpbmcgYSBcImRhdGEtdHVyYm8tc3VwcHJlc3Mtd2FybmluZ1wiIGF0dHJpYnV0ZSB0bzogJXNcbiAgICAgIGAsXG4gICAgICAgIGVsZW1lbnQub3V0ZXJIVE1MXG4gICAgICApXG4gICAgfVxuXG4gICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgfVxufSkoKTtcblxud2luZG93LlR1cmJvID0geyAuLi5UdXJibywgU3RyZWFtQWN0aW9ucyB9O1xuc3RhcnQoKTtcblxuZXhwb3J0IHsgRmV0Y2hFbmN0eXBlLCBGZXRjaE1ldGhvZCwgRmV0Y2hSZXF1ZXN0LCBGZXRjaFJlc3BvbnNlLCBGcmFtZUVsZW1lbnQsIEZyYW1lTG9hZGluZ1N0eWxlLCBGcmFtZVJlbmRlcmVyLCBQYWdlUmVuZGVyZXIsIFBhZ2VTbmFwc2hvdCwgU3RyZWFtQWN0aW9ucywgU3RyZWFtRWxlbWVudCwgU3RyZWFtU291cmNlRWxlbWVudCwgY2FjaGUsIGNsZWFyQ2FjaGUsIGNvbmZpZywgY29ubmVjdFN0cmVhbVNvdXJjZSwgZGlzY29ubmVjdFN0cmVhbVNvdXJjZSwgZmV0Y2hXaXRoVHVyYm9IZWFkZXJzIGFzIGZldGNoLCBmZXRjaEVuY3R5cGVGcm9tU3RyaW5nLCBmZXRjaE1ldGhvZEZyb21TdHJpbmcsIGlzU2FmZSwgbmF2aWdhdG9yJDEgYXMgbmF2aWdhdG9yLCByZWdpc3RlckFkYXB0ZXIsIHJlbmRlclN0cmVhbU1lc3NhZ2UsIHNlc3Npb24sIHNldENvbmZpcm1NZXRob2QsIHNldEZvcm1Nb2RlLCBzZXRQcm9ncmVzc0JhckRlbGF5LCBzdGFydCwgdmlzaXQgfTtcbiIsIi8qISBQaWNrciAxLjkuMCBNSVQgfCBodHRwczovL2dpdGh1Yi5jb20vU2ltb253ZXAvcGlja3IgKi9cbiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuUGlja3I9ZSgpOnQuUGlja3I9ZSgpfShzZWxmLCgoKT0+KCgpPT57XCJ1c2Ugc3RyaWN0XCI7dmFyIHQ9e2Q6KGUsbyk9Pntmb3IodmFyIG4gaW4gbyl0Lm8obyxuKSYmIXQubyhlLG4pJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxuLHtlbnVtZXJhYmxlOiEwLGdldDpvW25dfSl9LG86KHQsZSk9Pk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LGUpLHI6dD0+e1widW5kZWZpbmVkXCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZTpcIk1vZHVsZVwifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9fSxlPXt9O3QuZChlLHtkZWZhdWx0OigpPT5FfSk7dmFyIG89e307ZnVuY3Rpb24gbih0LGUsbyxuLGk9e30pe2UgaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbnx8ZSBpbnN0YW5jZW9mIE5vZGVMaXN0P2U9QXJyYXkuZnJvbShlKTpBcnJheS5pc0FycmF5KGUpfHwoZT1bZV0pLEFycmF5LmlzQXJyYXkobyl8fChvPVtvXSk7Zm9yKGNvbnN0IHMgb2YgZSlmb3IoY29uc3QgZSBvZiBvKXNbdF0oZSxuLHtjYXB0dXJlOiExLC4uLml9KTtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpfXQucihvKSx0LmQobyx7YWRqdXN0YWJsZUlucHV0TnVtYmVyczooKT0+cCxjcmVhdGVFbGVtZW50RnJvbVN0cmluZzooKT0+cixjcmVhdGVGcm9tVGVtcGxhdGU6KCk9PmEsZXZlbnRQYXRoOigpPT5sLG9mZjooKT0+cyxvbjooKT0+aSxyZXNvbHZlRWxlbWVudDooKT0+Y30pO2NvbnN0IGk9bi5iaW5kKG51bGwsXCJhZGRFdmVudExpc3RlbmVyXCIpLHM9bi5iaW5kKG51bGwsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIpO2Z1bmN0aW9uIHIodCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBlLmlubmVySFRNTD10LnRyaW0oKSxlLmZpcnN0RWxlbWVudENoaWxkfWZ1bmN0aW9uIGEodCl7Y29uc3QgZT0odCxlKT0+e2NvbnN0IG89dC5nZXRBdHRyaWJ1dGUoZSk7cmV0dXJuIHQucmVtb3ZlQXR0cmlidXRlKGUpLG99LG89KHQsbj17fSk9Pntjb25zdCBpPWUodCxcIjpvYmpcIikscz1lKHQsXCI6cmVmXCIpLHI9aT9uW2ldPXt9Om47cyYmKG5bc109dCk7Zm9yKGNvbnN0IG4gb2YgQXJyYXkuZnJvbSh0LmNoaWxkcmVuKSl7Y29uc3QgdD1lKG4sXCI6YXJyXCIpLGk9byhuLHQ/e306cik7dCYmKHJbdF18fChyW3RdPVtdKSkucHVzaChPYmplY3Qua2V5cyhpKS5sZW5ndGg/aTpuKX1yZXR1cm4gbn07cmV0dXJuIG8ocih0KSl9ZnVuY3Rpb24gbCh0KXtsZXQgZT10LnBhdGh8fHQuY29tcG9zZWRQYXRoJiZ0LmNvbXBvc2VkUGF0aCgpO2lmKGUpcmV0dXJuIGU7bGV0IG89dC50YXJnZXQucGFyZW50RWxlbWVudDtmb3IoZT1bdC50YXJnZXQsb107bz1vLnBhcmVudEVsZW1lbnQ7KWUucHVzaChvKTtyZXR1cm4gZS5wdXNoKGRvY3VtZW50LHdpbmRvdyksZX1mdW5jdGlvbiBjKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRWxlbWVudD90Olwic3RyaW5nXCI9PXR5cGVvZiB0P3Quc3BsaXQoLz4+L2cpLnJlZHVjZSgoKHQsZSxvLG4pPT4odD10LnF1ZXJ5U2VsZWN0b3IoZSksbzxuLmxlbmd0aC0xP3Quc2hhZG93Um9vdDp0KSksZG9jdW1lbnQpOm51bGx9ZnVuY3Rpb24gcCh0LGU9KHQ9PnQpKXtmdW5jdGlvbiBvKG8pe2NvbnN0IG49Wy4wMDEsLjAxLC4xXVtOdW1iZXIoby5zaGlmdEtleXx8MipvLmN0cmxLZXkpXSooby5kZWx0YVk8MD8xOi0xKTtsZXQgaT0wLHM9dC5zZWxlY3Rpb25TdGFydDt0LnZhbHVlPXQudmFsdWUucmVwbGFjZSgvW1xcZC5dKy9nLCgodCxvKT0+bzw9cyYmbyt0Lmxlbmd0aD49cz8ocz1vLGUoTnVtYmVyKHQpLG4saSkpOihpKyssdCkpKSx0LmZvY3VzKCksdC5zZXRTZWxlY3Rpb25SYW5nZShzLHMpLG8ucHJldmVudERlZmF1bHQoKSx0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiaW5wdXRcIikpfWkodCxcImZvY3VzXCIsKCgpPT5pKHdpbmRvdyxcIndoZWVsXCIsbyx7cGFzc2l2ZTohMX0pKSksaSh0LFwiYmx1clwiLCgoKT0+cyh3aW5kb3csXCJ3aGVlbFwiLG8pKSl9Y29uc3R7bWluOnUsbWF4OmgsZmxvb3I6ZCxyb3VuZDptfT1NYXRoO2Z1bmN0aW9uIGYodCxlLG8pe2UvPTEwMCxvLz0xMDA7Y29uc3Qgbj1kKHQ9dC8zNjAqNiksaT10LW4scz1vKigxLWUpLHI9byooMS1pKmUpLGE9byooMS0oMS1pKSplKSxsPW4lNjtyZXR1cm5bMjU1KltvLHIscyxzLGEsb11bbF0sMjU1KlthLG8sbyxyLHMsc11bbF0sMjU1KltzLHMsYSxvLG8scl1bbF1dfWZ1bmN0aW9uIHYodCxlLG8pe2NvbnN0IG49KDItKGUvPTEwMCkpKihvLz0xMDApLzI7cmV0dXJuIDAhPT1uJiYoZT0xPT09bj8wOm48LjU/ZSpvLygyKm4pOmUqby8oMi0yKm4pKSxbdCwxMDAqZSwxMDAqbl19ZnVuY3Rpb24gYih0LGUsbyl7Y29uc3Qgbj11KHQvPTI1NSxlLz0yNTUsby89MjU1KSxpPWgodCxlLG8pLHM9aS1uO2xldCByLGE7aWYoMD09PXMpcj1hPTA7ZWxzZXthPXMvaTtjb25zdCBuPSgoaS10KS82K3MvMikvcyxsPSgoaS1lKS82K3MvMikvcyxjPSgoaS1vKS82K3MvMikvczt0PT09aT9yPWMtbDplPT09aT9yPTEvMytuLWM6bz09PWkmJihyPTIvMytsLW4pLHI8MD9yKz0xOnI+MSYmKHItPTEpfXJldHVyblszNjAqciwxMDAqYSwxMDAqaV19ZnVuY3Rpb24geSh0LGUsbyxuKXtlLz0xMDAsby89MTAwO3JldHVyblsuLi5iKDI1NSooMS11KDEsKHQvPTEwMCkqKDEtKG4vPTEwMCkpK24pKSwyNTUqKDEtdSgxLGUqKDEtbikrbikpLDI1NSooMS11KDEsbyooMS1uKStuKSkpXX1mdW5jdGlvbiBnKHQsZSxvKXtlLz0xMDA7Y29uc3Qgbj0yKihlKj0oby89MTAwKTwuNT9vOjEtbykvKG8rZSkqMTAwLGk9MTAwKihvK2UpO3JldHVyblt0LGlzTmFOKG4pPzA6bixpXX1mdW5jdGlvbiBfKHQpe3JldHVybiBiKC4uLnQubWF0Y2goLy57Mn0vZykubWFwKCh0PT5wYXJzZUludCh0LDE2KSkpKX1mdW5jdGlvbiB3KHQpe3Q9dC5tYXRjaCgvXlthLXpBLVpdKyQvKT9mdW5jdGlvbih0KXtpZihcImJsYWNrXCI9PT10LnRvTG93ZXJDYXNlKCkpcmV0dXJuXCIjMDAwXCI7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLmdldENvbnRleHQoXCIyZFwiKTtyZXR1cm4gZS5maWxsU3R5bGU9dCxcIiMwMDBcIj09PWUuZmlsbFN0eWxlP251bGw6ZS5maWxsU3R5bGV9KHQpOnQ7Y29uc3QgZT17Y215azovXmNteWtcXEQrKFtcXGQuXSspXFxEKyhbXFxkLl0rKVxcRCsoW1xcZC5dKylcXEQrKFtcXGQuXSspL2kscmdiYTovXnJnYmE/XFxEKyhbXFxkLl0rKSglPylcXEQrKFtcXGQuXSspKCU/KVxcRCsoW1xcZC5dKykoJT8pXFxEKj8oKFtcXGQuXSspKCU/KXwkKS9pLGhzbGE6L15oc2xhP1xcRCsoW1xcZC5dKylcXEQrKFtcXGQuXSspXFxEKyhbXFxkLl0rKVxcRCo/KChbXFxkLl0rKSglPyl8JCkvaSxoc3ZhOi9eaHN2YT9cXEQrKFtcXGQuXSspXFxEKyhbXFxkLl0rKVxcRCsoW1xcZC5dKylcXEQqPygoW1xcZC5dKykoJT8pfCQpL2ksaGV4YTovXiM/KChbXFxkQS1GYS1mXXszLDR9KXwoW1xcZEEtRmEtZl17Nn0pfChbXFxkQS1GYS1mXXs4fSkpJC9pfSxvPXQ9PnQubWFwKCh0PT4vXih8XFxkKylcXC5cXGQrfFxcZCskLy50ZXN0KHQpP051bWJlcih0KTp2b2lkIDApKTtsZXQgbjt0OmZvcihjb25zdCBpIGluIGUpaWYobj1lW2ldLmV4ZWModCkpc3dpdGNoKGkpe2Nhc2VcImNteWtcIjp7Y29uc3RbLHQsZSxzLHJdPW8obik7aWYodD4xMDB8fGU+MTAwfHxzPjEwMHx8cj4xMDApYnJlYWsgdDtyZXR1cm57dmFsdWVzOnkodCxlLHMsciksdHlwZTppfX1jYXNlXCJyZ2JhXCI6e2xldFssdCwsZSwscywsLHJdPW8obik7aWYodD1cIiVcIj09PW5bMl0/dC8xMDAqMjU1OnQsZT1cIiVcIj09PW5bNF0/ZS8xMDAqMjU1OmUscz1cIiVcIj09PW5bNl0/cy8xMDAqMjU1OnMscj1cIiVcIj09PW5bOV0/ci8xMDA6cix0PjI1NXx8ZT4yNTV8fHM+MjU1fHxyPDB8fHI+MSlicmVhayB0O3JldHVybnt2YWx1ZXM6Wy4uLmIodCxlLHMpLHJdLGE6cix0eXBlOml9fWNhc2VcImhleGFcIjp7bGV0Wyx0XT1uOzQhPT10Lmxlbmd0aCYmMyE9PXQubGVuZ3RofHwodD10LnNwbGl0KFwiXCIpLm1hcCgodD0+dCt0KSkuam9pbihcIlwiKSk7Y29uc3QgZT10LnN1YnN0cmluZygwLDYpO2xldCBvPXQuc3Vic3RyaW5nKDYpO3JldHVybiBvPW8/cGFyc2VJbnQobywxNikvMjU1OnZvaWQgMCx7dmFsdWVzOlsuLi5fKGUpLG9dLGE6byx0eXBlOml9fWNhc2VcImhzbGFcIjp7bGV0Wyx0LGUscywscl09byhuKTtpZihyPVwiJVwiPT09bls2XT9yLzEwMDpyLHQ+MzYwfHxlPjEwMHx8cz4xMDB8fHI8MHx8cj4xKWJyZWFrIHQ7cmV0dXJue3ZhbHVlczpbLi4uZyh0LGUscykscl0sYTpyLHR5cGU6aX19Y2FzZVwiaHN2YVwiOntsZXRbLHQsZSxzLCxyXT1vKG4pO2lmKHI9XCIlXCI9PT1uWzZdP3IvMTAwOnIsdD4zNjB8fGU+MTAwfHxzPjEwMHx8cjwwfHxyPjEpYnJlYWsgdDtyZXR1cm57dmFsdWVzOlt0LGUscyxyXSxhOnIsdHlwZTppfX19cmV0dXJue3ZhbHVlczpudWxsLHR5cGU6bnVsbH19ZnVuY3Rpb24gQSh0PTAsZT0wLG89MCxuPTEpe2NvbnN0IGk9KHQsZSk9PihvPS0xKT0+ZSh+bz90Lm1hcCgodD0+TnVtYmVyKHQudG9GaXhlZChvKSkpKTp0KSxzPXtoOnQsczplLHY6byxhOm4sdG9IU1ZBKCl7Y29uc3QgdD1bcy5oLHMucyxzLnYscy5hXTtyZXR1cm4gdC50b1N0cmluZz1pKHQsKHQ9PmBoc3ZhKCR7dFswXX0sICR7dFsxXX0lLCAke3RbMl19JSwgJHtzLmF9KWApKSx0fSx0b0hTTEEoKXtjb25zdCB0PVsuLi52KHMuaCxzLnMscy52KSxzLmFdO3JldHVybiB0LnRvU3RyaW5nPWkodCwodD0+YGhzbGEoJHt0WzBdfSwgJHt0WzFdfSUsICR7dFsyXX0lLCAke3MuYX0pYCkpLHR9LHRvUkdCQSgpe2NvbnN0IHQ9Wy4uLmYocy5oLHMucyxzLnYpLHMuYV07cmV0dXJuIHQudG9TdHJpbmc9aSh0LCh0PT5gcmdiYSgke3RbMF19LCAke3RbMV19LCAke3RbMl19LCAke3MuYX0pYCkpLHR9LHRvQ01ZSygpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlLG8pe2NvbnN0IG49Zih0LGUsbyksaT1uWzBdLzI1NSxzPW5bMV0vMjU1LHI9blsyXS8yNTUsYT11KDEtaSwxLXMsMS1yKTtyZXR1cm5bMTAwKigxPT09YT8wOigxLWktYSkvKDEtYSkpLDEwMCooMT09PWE/MDooMS1zLWEpLygxLWEpKSwxMDAqKDE9PT1hPzA6KDEtci1hKS8oMS1hKSksMTAwKmFdfShzLmgscy5zLHMudik7cmV0dXJuIHQudG9TdHJpbmc9aSh0LCh0PT5gY215aygke3RbMF19JSwgJHt0WzFdfSUsICR7dFsyXX0lLCAke3RbM119JSlgKSksdH0sdG9IRVhBKCl7Y29uc3QgdD1mdW5jdGlvbih0LGUsbyl7cmV0dXJuIGYodCxlLG8pLm1hcCgodD0+bSh0KS50b1N0cmluZygxNikucGFkU3RhcnQoMixcIjBcIikpKX0ocy5oLHMucyxzLnYpLGU9cy5hPj0xP1wiXCI6TnVtYmVyKCgyNTUqcy5hKS50b0ZpeGVkKDApKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKS5wYWRTdGFydCgyLFwiMFwiKTtyZXR1cm4gZSYmdC5wdXNoKGUpLHQudG9TdHJpbmc9KCk9PmAjJHt0LmpvaW4oXCJcIikudG9VcHBlckNhc2UoKX1gLHR9LGNsb25lOigpPT5BKHMuaCxzLnMscy52LHMuYSl9O3JldHVybiBzfWNvbnN0ICQ9dD0+TWF0aC5tYXgoTWF0aC5taW4odCwxKSwwKTtmdW5jdGlvbiBDKHQpe2NvbnN0IGU9e29wdGlvbnM6T2JqZWN0LmFzc2lnbih7bG9jazpudWxsLG9uY2hhbmdlOigpPT4wLG9uc3RvcDooKT0+MH0sdCksX2tleWJvYXJkKHQpe2NvbnN0e29wdGlvbnM6b309ZSx7dHlwZTpuLGtleTppfT10O2lmKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ9PT1vLndyYXBwZXIpe2NvbnN0e2xvY2s6b309ZS5vcHRpb25zLHM9XCJBcnJvd1VwXCI9PT1pLHI9XCJBcnJvd1JpZ2h0XCI9PT1pLGE9XCJBcnJvd0Rvd25cIj09PWksbD1cIkFycm93TGVmdFwiPT09aTtpZihcImtleWRvd25cIj09PW4mJihzfHxyfHxhfHxsKSl7bGV0IG49MCxpPTA7XCJ2XCI9PT1vP249c3x8cj8xOi0xOlwiaFwiPT09bz9uPXN8fHI/LTE6MTooaT1zPy0xOmE/MTowLG49bD8tMTpyPzE6MCksZS51cGRhdGUoJChlLmNhY2hlLngrLjAxKm4pLCQoZS5jYWNoZS55Ky4wMSppKSksdC5wcmV2ZW50RGVmYXVsdCgpfWVsc2UgaS5zdGFydHNXaXRoKFwiQXJyb3dcIikmJihlLm9wdGlvbnMub25zdG9wKCksdC5wcmV2ZW50RGVmYXVsdCgpKX19LF90YXBzdGFydCh0KXtpKGRvY3VtZW50LFtcIm1vdXNldXBcIixcInRvdWNoZW5kXCIsXCJ0b3VjaGNhbmNlbFwiXSxlLl90YXBzdG9wKSxpKGRvY3VtZW50LFtcIm1vdXNlbW92ZVwiLFwidG91Y2htb3ZlXCJdLGUuX3RhcG1vdmUpLHQuY2FuY2VsYWJsZSYmdC5wcmV2ZW50RGVmYXVsdCgpLGUuX3RhcG1vdmUodCl9LF90YXBtb3ZlKHQpe2NvbnN0e29wdGlvbnM6byxjYWNoZTpufT1lLHtsb2NrOmksZWxlbWVudDpzLHdyYXBwZXI6cn09byxhPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7bGV0IGw9MCxjPTA7aWYodCl7Y29uc3QgZT10JiZ0LnRvdWNoZXMmJnQudG91Y2hlc1swXTtsPXQ/KGV8fHQpLmNsaWVudFg6MCxjPXQ/KGV8fHQpLmNsaWVudFk6MCxsPGEubGVmdD9sPWEubGVmdDpsPmEubGVmdCthLndpZHRoJiYobD1hLmxlZnQrYS53aWR0aCksYzxhLnRvcD9jPWEudG9wOmM+YS50b3ArYS5oZWlnaHQmJihjPWEudG9wK2EuaGVpZ2h0KSxsLT1hLmxlZnQsYy09YS50b3B9ZWxzZSBuJiYobD1uLngqYS53aWR0aCxjPW4ueSphLmhlaWdodCk7XCJoXCIhPT1pJiYocy5zdHlsZS5sZWZ0PWBjYWxjKCR7bC9hLndpZHRoKjEwMH0lIC0gJHtzLm9mZnNldFdpZHRoLzJ9cHgpYCksXCJ2XCIhPT1pJiYocy5zdHlsZS50b3A9YGNhbGMoJHtjL2EuaGVpZ2h0KjEwMH0lIC0gJHtzLm9mZnNldEhlaWdodC8yfXB4KWApLGUuY2FjaGU9e3g6bC9hLndpZHRoLHk6Yy9hLmhlaWdodH07Y29uc3QgcD0kKGwvYS53aWR0aCksdT0kKGMvYS5oZWlnaHQpO3N3aXRjaChpKXtjYXNlXCJ2XCI6cmV0dXJuIG8ub25jaGFuZ2UocCk7Y2FzZVwiaFwiOnJldHVybiBvLm9uY2hhbmdlKHUpO2RlZmF1bHQ6cmV0dXJuIG8ub25jaGFuZ2UocCx1KX19LF90YXBzdG9wKCl7ZS5vcHRpb25zLm9uc3RvcCgpLHMoZG9jdW1lbnQsW1wibW91c2V1cFwiLFwidG91Y2hlbmRcIixcInRvdWNoY2FuY2VsXCJdLGUuX3RhcHN0b3ApLHMoZG9jdW1lbnQsW1wibW91c2Vtb3ZlXCIsXCJ0b3VjaG1vdmVcIl0sZS5fdGFwbW92ZSl9LHRyaWdnZXIoKXtlLl90YXBtb3ZlKCl9LHVwZGF0ZSh0PTAsbz0wKXtjb25zdHtsZWZ0Om4sdG9wOmksd2lkdGg6cyxoZWlnaHQ6cn09ZS5vcHRpb25zLndyYXBwZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XCJoXCI9PT1lLm9wdGlvbnMubG9jayYmKG89dCksZS5fdGFwbW92ZSh7Y2xpZW50WDpuK3MqdCxjbGllbnRZOmkrcipvfSl9LGRlc3Ryb3koKXtjb25zdHtvcHRpb25zOnQsX3RhcHN0YXJ0Om8sX2tleWJvYXJkOm59PWU7cyhkb2N1bWVudCxbXCJrZXlkb3duXCIsXCJrZXl1cFwiXSxuKSxzKFt0LndyYXBwZXIsdC5lbGVtZW50XSxcIm1vdXNlZG93blwiLG8pLHMoW3Qud3JhcHBlcix0LmVsZW1lbnRdLFwidG91Y2hzdGFydFwiLG8se3Bhc3NpdmU6ITF9KX19LHtvcHRpb25zOm8sX3RhcHN0YXJ0Om4sX2tleWJvYXJkOnJ9PWU7cmV0dXJuIGkoW28ud3JhcHBlcixvLmVsZW1lbnRdLFwibW91c2Vkb3duXCIsbiksaShbby53cmFwcGVyLG8uZWxlbWVudF0sXCJ0b3VjaHN0YXJ0XCIsbix7cGFzc2l2ZTohMX0pLGkoZG9jdW1lbnQsW1wia2V5ZG93blwiLFwia2V5dXBcIl0sciksZX1mdW5jdGlvbiBrKHQ9e30pe3Q9T2JqZWN0LmFzc2lnbih7b25jaGFuZ2U6KCk9PjAsY2xhc3NOYW1lOlwiXCIsZWxlbWVudHM6W119LHQpO2NvbnN0IGU9aSh0LmVsZW1lbnRzLFwiY2xpY2tcIiwoZT0+e3QuZWxlbWVudHMuZm9yRWFjaCgobz0+by5jbGFzc0xpc3RbZS50YXJnZXQ9PT1vP1wiYWRkXCI6XCJyZW1vdmVcIl0odC5jbGFzc05hbWUpKSksdC5vbmNoYW5nZShlKSxlLnN0b3BQcm9wYWdhdGlvbigpfSkpO3JldHVybntkZXN0cm95OigpPT5zKC4uLmUpfX1jb25zdCBTPXt2YXJpYW50RmxpcE9yZGVyOntzdGFydDpcInNtZVwiLG1pZGRsZTpcIm1zZVwiLGVuZDpcImVtc1wifSxwb3NpdGlvbkZsaXBPcmRlcjp7dG9wOlwidGJybFwiLHJpZ2h0Olwicmx0YlwiLGJvdHRvbTpcImJ0cmxcIixsZWZ0OlwibHJidFwifSxwb3NpdGlvbjpcImJvdHRvbVwiLG1hcmdpbjo4LHBhZGRpbmc6MH0sTz0odCxlLG8pPT57Y29uc3Qgbj1cIm9iamVjdFwiIT10eXBlb2YgdHx8dCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50P3tyZWZlcmVuY2U6dCxwb3BwZXI6ZSwuLi5vfTp0O3JldHVybnt1cGRhdGUodD1uKXtjb25zdHtyZWZlcmVuY2U6ZSxwb3BwZXI6b309T2JqZWN0LmFzc2lnbihuLHQpO2lmKCFvfHwhZSl0aHJvdyBuZXcgRXJyb3IoXCJQb3BwZXItIG9yIHJlZmVyZW5jZS1lbGVtZW50IG1pc3NpbmcuXCIpO3JldHVybigodCxlLG8pPT57Y29uc3R7Y29udGFpbmVyOm4sYXJyb3c6aSxtYXJnaW46cyxwYWRkaW5nOnIscG9zaXRpb246YSx2YXJpYW50RmxpcE9yZGVyOmwscG9zaXRpb25GbGlwT3JkZXI6Y309e2NvbnRhaW5lcjpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksLi4uUywuLi5vfSx7bGVmdDpwLHRvcDp1fT1lLnN0eWxlO2Uuc3R5bGUubGVmdD1cIjBcIixlLnN0eWxlLnRvcD1cIjBcIjtjb25zdCBoPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksZD1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG09e3Q6aC50b3AtZC5oZWlnaHQtcyxiOmguYm90dG9tK3MscjpoLnJpZ2h0K3MsbDpoLmxlZnQtZC53aWR0aC1zfSxmPXt2czpoLmxlZnQsdm06aC5sZWZ0K2gud2lkdGgvMi1kLndpZHRoLzIsdmU6aC5sZWZ0K2gud2lkdGgtZC53aWR0aCxoczpoLnRvcCxobTpoLmJvdHRvbS1oLmhlaWdodC8yLWQuaGVpZ2h0LzIsaGU6aC5ib3R0b20tZC5oZWlnaHR9LFt2LGI9XCJtaWRkbGVcIl09YS5zcGxpdChcIi1cIikseT1jW3ZdLGc9bFtiXSx7dG9wOl8sbGVmdDp3LGJvdHRvbTpBLHJpZ2h0OiR9PW47Zm9yKGNvbnN0IHQgb2YgeSl7Y29uc3Qgbz1cInRcIj09PXR8fFwiYlwiPT09dDtsZXQgbj1tW3RdO2NvbnN0W3MsYV09bz9bXCJ0b3BcIixcImxlZnRcIl06W1wibGVmdFwiLFwidG9wXCJdLFtsLGNdPW8/W2QuaGVpZ2h0LGQud2lkdGhdOltkLndpZHRoLGQuaGVpZ2h0XSxbcCx1XT1vP1tBLCRdOlskLEFdLFt2LGJdPW8/W18sd106W3csX107aWYoIShuPHZ8fG4rbCtyPnApKWZvcihjb25zdCBwIG9mIGcpe2xldCBtPWZbKG8/XCJ2XCI6XCJoXCIpK3BdO2lmKCEobTxifHxtK2Mrcj51KSl7aWYobS09ZFthXSxuLT1kW3NdLGUuc3R5bGVbYV09YCR7bX1weGAsZS5zdHlsZVtzXT1gJHtufXB4YCxpKXtjb25zdCB0PW8/aC53aWR0aC8yOmguaGVpZ2h0LzIsZT0yKnQ8Yz9oW2FdK3Q6bStjLzI7bjxoW3NdJiYobis9bCksaS5zdHlsZVthXT1gJHtlfXB4YCxpLnN0eWxlW3NdPWAke259cHhgfXJldHVybiB0K3B9fX1yZXR1cm4gZS5zdHlsZS5sZWZ0PXAsZS5zdHlsZS50b3A9dSxudWxsfSkoZSxvLG4pfX19O2NsYXNzIEV7c3RhdGljIHV0aWxzPW87c3RhdGljIHZlcnNpb249XCIxLjkuMFwiO3N0YXRpYyBJMThOX0RFRkFVTFRTPXtcInVpOmRpYWxvZ1wiOlwiY29sb3IgcGlja2VyIGRpYWxvZ1wiLFwiYnRuOnRvZ2dsZVwiOlwidG9nZ2xlIGNvbG9yIHBpY2tlciBkaWFsb2dcIixcImJ0bjpzd2F0Y2hcIjpcImNvbG9yIHN3YXRjaFwiLFwiYnRuOmxhc3QtY29sb3JcIjpcInVzZSBwcmV2aW91cyBjb2xvclwiLFwiYnRuOnNhdmVcIjpcIlNhdmVcIixcImJ0bjpjYW5jZWxcIjpcIkNhbmNlbFwiLFwiYnRuOmNsZWFyXCI6XCJDbGVhclwiLFwiYXJpYTpidG46c2F2ZVwiOlwic2F2ZSBhbmQgY2xvc2VcIixcImFyaWE6YnRuOmNhbmNlbFwiOlwiY2FuY2VsIGFuZCBjbG9zZVwiLFwiYXJpYTpidG46Y2xlYXJcIjpcImNsZWFyIGFuZCBjbG9zZVwiLFwiYXJpYTppbnB1dFwiOlwiY29sb3IgaW5wdXQgZmllbGRcIixcImFyaWE6cGFsZXR0ZVwiOlwiY29sb3Igc2VsZWN0aW9uIGFyZWFcIixcImFyaWE6aHVlXCI6XCJodWUgc2VsZWN0aW9uIHNsaWRlclwiLFwiYXJpYTpvcGFjaXR5XCI6XCJzZWxlY3Rpb24gc2xpZGVyXCJ9O3N0YXRpYyBERUZBVUxUX09QVElPTlM9e2FwcENsYXNzOm51bGwsdGhlbWU6XCJjbGFzc2ljXCIsdXNlQXNCdXR0b246ITEscGFkZGluZzo4LGRpc2FibGVkOiExLGNvbXBhcmlzb246ITAsY2xvc2VPblNjcm9sbDohMSxvdXRwdXRQcmVjaXNpb246MCxsb2NrT3BhY2l0eTohMSxhdXRvUmVwb3NpdGlvbjohMCxjb250YWluZXI6XCJib2R5XCIsY29tcG9uZW50czp7aW50ZXJhY3Rpb246e319LGkxOG46e30sc3dhdGNoZXM6bnVsbCxpbmxpbmU6ITEsc2xpZGVyczpudWxsLGRlZmF1bHQ6XCIjNDI0NDVhXCIsZGVmYXVsdFJlcHJlc2VudGF0aW9uOm51bGwscG9zaXRpb246XCJib3R0b20tbWlkZGxlXCIsYWRqdXN0YWJsZU51bWJlcnM6ITAsc2hvd0Fsd2F5czohMSxjbG9zZVdpdGhLZXk6XCJFc2NhcGVcIn07X2luaXRpYWxpemluZ0FjdGl2ZT0hMDtfcmVjYWxjPSEwO19uYW5vcG9wPW51bGw7X3Jvb3Q9bnVsbDtfY29sb3I9QSgpO19sYXN0Q29sb3I9QSgpO19zd2F0Y2hDb2xvcnM9W107X3NldHVwQW5pbWF0aW9uRnJhbWU9bnVsbDtfZXZlbnRMaXN0ZW5lcj17aW5pdDpbXSxzYXZlOltdLGhpZGU6W10sc2hvdzpbXSxjbGVhcjpbXSxjaGFuZ2U6W10sY2hhbmdlc3RvcDpbXSxjYW5jZWw6W10sc3dhdGNoc2VsZWN0OltdfTtjb25zdHJ1Y3Rvcih0KXt0aGlzLm9wdGlvbnM9dD1PYmplY3QuYXNzaWduKHsuLi5FLkRFRkFVTFRfT1BUSU9OU30sdCk7Y29uc3R7c3dhdGNoZXM6ZSxjb21wb25lbnRzOm8sdGhlbWU6bixzbGlkZXJzOmksbG9ja09wYWNpdHk6cyxwYWRkaW5nOnJ9PXQ7W1wibmFub1wiLFwibW9ub2xpdGhcIl0uaW5jbHVkZXMobikmJiFpJiYodC5zbGlkZXJzPVwiaFwiKSxvLmludGVyYWN0aW9ufHwoby5pbnRlcmFjdGlvbj17fSk7Y29uc3R7cHJldmlldzphLG9wYWNpdHk6bCxodWU6YyxwYWxldHRlOnB9PW87by5vcGFjaXR5PSFzJiZsLG8ucGFsZXR0ZT1wfHxhfHxsfHxjLHRoaXMuX3ByZUJ1aWxkKCksdGhpcy5fYnVpbGRDb21wb25lbnRzKCksdGhpcy5fYmluZEV2ZW50cygpLHRoaXMuX2ZpbmFsQnVpbGQoKSxlJiZlLmxlbmd0aCYmZS5mb3JFYWNoKCh0PT50aGlzLmFkZFN3YXRjaCh0KSkpO2NvbnN0e2J1dHRvbjp1LGFwcDpofT10aGlzLl9yb290O3RoaXMuX25hbm9wb3A9Tyh1LGgse21hcmdpbjpyfSksdS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJidXR0b25cIiksdS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsdGhpcy5fdChcImJ0bjp0b2dnbGVcIikpO2NvbnN0IGQ9dGhpczt0aGlzLl9zZXR1cEFuaW1hdGlvbkZyYW1lPXJlcXVlc3RBbmltYXRpb25GcmFtZSgoZnVuY3Rpb24gZSgpe2lmKCFoLm9mZnNldFdpZHRoKXJldHVybiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSk7ZC5zZXRDb2xvcih0LmRlZmF1bHQpLGQuX3JlUG9zaXRpb25pbmdQaWNrZXIoKSx0LmRlZmF1bHRSZXByZXNlbnRhdGlvbiYmKGQuX3JlcHJlc2VudGF0aW9uPXQuZGVmYXVsdFJlcHJlc2VudGF0aW9uLGQuc2V0Q29sb3JSZXByZXNlbnRhdGlvbihkLl9yZXByZXNlbnRhdGlvbikpLHQuc2hvd0Fsd2F5cyYmZC5zaG93KCksZC5faW5pdGlhbGl6aW5nQWN0aXZlPSExLGQuX2VtaXQoXCJpbml0XCIpfSkpfXN0YXRpYyBjcmVhdGU9dD0+bmV3IEUodCk7X3ByZUJ1aWxkKCl7Y29uc3R7b3B0aW9uczp0fT10aGlzO2Zvcihjb25zdCBlIG9mW1wiZWxcIixcImNvbnRhaW5lclwiXSl0W2VdPWModFtlXSk7dGhpcy5fcm9vdD0odD0+e2NvbnN0e2NvbXBvbmVudHM6ZSx1c2VBc0J1dHRvbjpvLGlubGluZTpuLGFwcENsYXNzOmksdGhlbWU6cyxsb2NrT3BhY2l0eTpyfT10Lm9wdGlvbnMsbD10PT50P1wiXCI6J3N0eWxlPVwiZGlzcGxheTpub25lXCIgaGlkZGVuJyxjPWU9PnQuX3QoZSkscD1hKGBcXG4gICAgICA8ZGl2IDpyZWY9XCJyb290XCIgY2xhc3M9XCJwaWNrclwiPlxcblxcbiAgICAgICAgJHtvP1wiXCI6JzxidXR0b24gdHlwZT1cImJ1dHRvblwiIDpyZWY9XCJidXR0b25cIiBjbGFzcz1cInBjci1idXR0b25cIj48L2J1dHRvbj4nfVxcblxcbiAgICAgICAgPGRpdiA6cmVmPVwiYXBwXCIgY2xhc3M9XCJwY3ItYXBwICR7aXx8XCJcIn1cIiBkYXRhLXRoZW1lPVwiJHtzfVwiICR7bj8nc3R5bGU9XCJwb3NpdGlvbjogdW5zZXRcIic6XCJcIn0gYXJpYS1sYWJlbD1cIiR7YyhcInVpOmRpYWxvZ1wiKX1cIiByb2xlPVwid2luZG93XCI+XFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJwY3Itc2VsZWN0aW9uXCIgJHtsKGUucGFsZXR0ZSl9PlxcbiAgICAgICAgICAgIDxkaXYgOm9iaj1cInByZXZpZXdcIiBjbGFzcz1cInBjci1jb2xvci1wcmV2aWV3XCIgJHtsKGUucHJldmlldyl9PlxcbiAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgOnJlZj1cImxhc3RDb2xvclwiIGNsYXNzPVwicGNyLWxhc3QtY29sb3JcIiBhcmlhLWxhYmVsPVwiJHtjKFwiYnRuOmxhc3QtY29sb3JcIil9XCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICA8ZGl2IDpyZWY9XCJjdXJyZW50Q29sb3JcIiBjbGFzcz1cInBjci1jdXJyZW50LWNvbG9yXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiA6b2JqPVwicGFsZXR0ZVwiIGNsYXNzPVwicGNyLWNvbG9yLXBhbGV0dGVcIj5cXG4gICAgICAgICAgICAgIDxkaXYgOnJlZj1cInBpY2tlclwiIGNsYXNzPVwicGNyLXBpY2tlclwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgPGRpdiA6cmVmPVwicGFsZXR0ZVwiIGNsYXNzPVwicGNyLXBhbGV0dGVcIiB0YWJpbmRleD1cIjBcIiBhcmlhLWxhYmVsPVwiJHtjKFwiYXJpYTpwYWxldHRlXCIpfVwiIHJvbGU9XCJsaXN0Ym94XCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiA6b2JqPVwiaHVlXCIgY2xhc3M9XCJwY3ItY29sb3ItY2hvb3NlclwiICR7bChlLmh1ZSl9PlxcbiAgICAgICAgICAgICAgPGRpdiA6cmVmPVwicGlja2VyXCIgY2xhc3M9XCJwY3ItcGlja2VyXCI+PC9kaXY+XFxuICAgICAgICAgICAgICA8ZGl2IDpyZWY9XCJzbGlkZXJcIiBjbGFzcz1cInBjci1odWUgcGNyLXNsaWRlclwiIHRhYmluZGV4PVwiMFwiIGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOmh1ZVwiKX1cIiByb2xlPVwic2xpZGVyXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiA6b2JqPVwib3BhY2l0eVwiIGNsYXNzPVwicGNyLWNvbG9yLW9wYWNpdHlcIiAke2woZS5vcGFjaXR5KX0+XFxuICAgICAgICAgICAgICA8ZGl2IDpyZWY9XCJwaWNrZXJcIiBjbGFzcz1cInBjci1waWNrZXJcIj48L2Rpdj5cXG4gICAgICAgICAgICAgIDxkaXYgOnJlZj1cInNsaWRlclwiIGNsYXNzPVwicGNyLW9wYWNpdHkgcGNyLXNsaWRlclwiIHRhYmluZGV4PVwiMFwiIGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOm9wYWNpdHlcIil9XCIgcm9sZT1cInNsaWRlclwiPjwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInBjci1zd2F0Y2hlcyAke2UucGFsZXR0ZT9cIlwiOlwicGNyLWxhc3RcIn1cIiA6cmVmPVwic3dhdGNoZXNcIj48L2Rpdj5cXG5cXG4gICAgICAgICAgPGRpdiA6b2JqPVwiaW50ZXJhY3Rpb25cIiBjbGFzcz1cInBjci1pbnRlcmFjdGlvblwiICR7bChPYmplY3Qua2V5cyhlLmludGVyYWN0aW9uKS5sZW5ndGgpfT5cXG4gICAgICAgICAgICA8aW5wdXQgOnJlZj1cInJlc3VsdFwiIGNsYXNzPVwicGNyLXJlc3VsdFwiIHR5cGU9XCJ0ZXh0XCIgc3BlbGxjaGVjaz1cImZhbHNlXCIgJHtsKGUuaW50ZXJhY3Rpb24uaW5wdXQpfSBhcmlhLWxhYmVsPVwiJHtjKFwiYXJpYTppbnB1dFwiKX1cIj5cXG5cXG4gICAgICAgICAgICA8aW5wdXQgOmFycj1cIm9wdGlvbnNcIiBjbGFzcz1cInBjci10eXBlXCIgZGF0YS10eXBlPVwiSEVYQVwiIHZhbHVlPVwiJHtyP1wiSEVYXCI6XCJIRVhBXCJ9XCIgdHlwZT1cImJ1dHRvblwiICR7bChlLmludGVyYWN0aW9uLmhleCl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJSR0JBXCIgdmFsdWU9XCIke3I/XCJSR0JcIjpcIlJHQkFcIn1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24ucmdiYSl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJIU0xBXCIgdmFsdWU9XCIke3I/XCJIU0xcIjpcIkhTTEFcIn1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24uaHNsYSl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJIU1ZBXCIgdmFsdWU9XCIke3I/XCJIU1ZcIjpcIkhTVkFcIn1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24uaHN2YSl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJDTVlLXCIgdmFsdWU9XCJDTVlLXCIgdHlwZT1cImJ1dHRvblwiICR7bChlLmludGVyYWN0aW9uLmNteWspfT5cXG5cXG4gICAgICAgICAgICA8aW5wdXQgOnJlZj1cInNhdmVcIiBjbGFzcz1cInBjci1zYXZlXCIgdmFsdWU9XCIke2MoXCJidG46c2F2ZVwiKX1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24uc2F2ZSl9IGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOmJ0bjpzYXZlXCIpfVwiPlxcbiAgICAgICAgICAgIDxpbnB1dCA6cmVmPVwiY2FuY2VsXCIgY2xhc3M9XCJwY3ItY2FuY2VsXCIgdmFsdWU9XCIke2MoXCJidG46Y2FuY2VsXCIpfVwiIHR5cGU9XCJidXR0b25cIiAke2woZS5pbnRlcmFjdGlvbi5jYW5jZWwpfSBhcmlhLWxhYmVsPVwiJHtjKFwiYXJpYTpidG46Y2FuY2VsXCIpfVwiPlxcbiAgICAgICAgICAgIDxpbnB1dCA6cmVmPVwiY2xlYXJcIiBjbGFzcz1cInBjci1jbGVhclwiIHZhbHVlPVwiJHtjKFwiYnRuOmNsZWFyXCIpfVwiIHR5cGU9XCJidXR0b25cIiAke2woZS5pbnRlcmFjdGlvbi5jbGVhcil9IGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOmJ0bjpjbGVhclwiKX1cIj5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgYCksdT1wLmludGVyYWN0aW9uO3JldHVybiB1Lm9wdGlvbnMuZmluZCgodD0+IXQuaGlkZGVuJiYhdC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpKSksdS50eXBlPSgpPT51Lm9wdGlvbnMuZmluZCgodD0+dC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpKSxwfSkodGhpcyksdC51c2VBc0J1dHRvbiYmKHRoaXMuX3Jvb3QuYnV0dG9uPXQuZWwpLHQuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuX3Jvb3Qucm9vdCl9X2ZpbmFsQnVpbGQoKXtjb25zdCB0PXRoaXMub3B0aW9ucyxlPXRoaXMuX3Jvb3Q7aWYodC5jb250YWluZXIucmVtb3ZlQ2hpbGQoZS5yb290KSx0LmlubGluZSl7Y29uc3Qgbz10LmVsLnBhcmVudEVsZW1lbnQ7dC5lbC5uZXh0U2libGluZz9vLmluc2VydEJlZm9yZShlLmFwcCx0LmVsLm5leHRTaWJsaW5nKTpvLmFwcGVuZENoaWxkKGUuYXBwKX1lbHNlIHQuY29udGFpbmVyLmFwcGVuZENoaWxkKGUuYXBwKTt0LnVzZUFzQnV0dG9uP3QuaW5saW5lJiZ0LmVsLnJlbW92ZSgpOnQuZWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZS5yb290LHQuZWwpLHQuZGlzYWJsZWQmJnRoaXMuZGlzYWJsZSgpLHQuY29tcGFyaXNvbnx8KGUuYnV0dG9uLnN0eWxlLnRyYW5zaXRpb249XCJub25lXCIsdC51c2VBc0J1dHRvbnx8KGUucHJldmlldy5sYXN0Q29sb3Iuc3R5bGUudHJhbnNpdGlvbj1cIm5vbmVcIikpLHRoaXMuaGlkZSgpfV9idWlsZENvbXBvbmVudHMoKXtjb25zdCB0PXRoaXMsZT10aGlzLm9wdGlvbnMuY29tcG9uZW50cyxvPSh0Lm9wdGlvbnMuc2xpZGVyc3x8XCJ2XCIpLnJlcGVhdCgyKSxbbixpXT1vLm1hdGNoKC9eW3ZoXSskL2cpP286W10scz0oKT0+dGhpcy5fY29sb3J8fCh0aGlzLl9jb2xvcj10aGlzLl9sYXN0Q29sb3IuY2xvbmUoKSkscj17cGFsZXR0ZTpDKHtlbGVtZW50OnQuX3Jvb3QucGFsZXR0ZS5waWNrZXIsd3JhcHBlcjp0Ll9yb290LnBhbGV0dGUucGFsZXR0ZSxvbnN0b3A6KCk9PnQuX2VtaXQoXCJjaGFuZ2VzdG9wXCIsXCJzbGlkZXJcIix0KSxvbmNoYW5nZShvLG4pe2lmKCFlLnBhbGV0dGUpcmV0dXJuO2NvbnN0IGk9cygpLHtfcm9vdDpyLG9wdGlvbnM6YX09dCx7bGFzdENvbG9yOmwsY3VycmVudENvbG9yOmN9PXIucHJldmlldzt0Ll9yZWNhbGMmJihpLnM9MTAwKm8saS52PTEwMC0xMDAqbixpLnY8MCYmKGkudj0wKSx0Ll91cGRhdGVPdXRwdXQoXCJzbGlkZXJcIikpO2NvbnN0IHA9aS50b1JHQkEoKS50b1N0cmluZygwKTt0aGlzLmVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZD1wLHRoaXMud3JhcHBlci5zdHlsZS5iYWNrZ3JvdW5kPWBcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lYXItZ3JhZGllbnQodG8gdG9wLCByZ2JhKDAsIDAsIDAsICR7aS5hfSksIHRyYW5zcGFyZW50KSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lYXItZ3JhZGllbnQodG8gbGVmdCwgaHNsYSgke2kuaH0sIDEwMCUsIDUwJSwgJHtpLmF9KSwgcmdiYSgyNTUsIDI1NSwgMjU1LCAke2kuYX0pKVxcbiAgICAgICAgICAgICAgICAgICAgYCxhLmNvbXBhcmlzb24/YS51c2VBc0J1dHRvbnx8dC5fbGFzdENvbG9yfHxsLnN0eWxlLnNldFByb3BlcnR5KFwiLS1wY3ItY29sb3JcIixwKTooci5idXR0b24uc3R5bGUuc2V0UHJvcGVydHkoXCItLXBjci1jb2xvclwiLHApLHIuYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjbGVhclwiKSk7Y29uc3QgdT1pLnRvSEVYQSgpLnRvU3RyaW5nKCk7Zm9yKGNvbnN0e2VsOmUsY29sb3I6b31vZiB0Ll9zd2F0Y2hDb2xvcnMpZS5jbGFzc0xpc3RbdT09PW8udG9IRVhBKCkudG9TdHJpbmcoKT9cImFkZFwiOlwicmVtb3ZlXCJdKFwicGNyLWFjdGl2ZVwiKTtjLnN0eWxlLnNldFByb3BlcnR5KFwiLS1wY3ItY29sb3JcIixwKX19KSxodWU6Qyh7bG9jazpcInZcIj09PWk/XCJoXCI6XCJ2XCIsZWxlbWVudDp0Ll9yb290Lmh1ZS5waWNrZXIsd3JhcHBlcjp0Ll9yb290Lmh1ZS5zbGlkZXIsb25zdG9wOigpPT50Ll9lbWl0KFwiY2hhbmdlc3RvcFwiLFwic2xpZGVyXCIsdCksb25jaGFuZ2Uobyl7aWYoIWUuaHVlfHwhZS5wYWxldHRlKXJldHVybjtjb25zdCBuPXMoKTt0Ll9yZWNhbGMmJihuLmg9MzYwKm8pLHRoaXMuZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9YGhzbCgke24uaH0sIDEwMCUsIDUwJSlgLHIucGFsZXR0ZS50cmlnZ2VyKCl9fSksb3BhY2l0eTpDKHtsb2NrOlwidlwiPT09bj9cImhcIjpcInZcIixlbGVtZW50OnQuX3Jvb3Qub3BhY2l0eS5waWNrZXIsd3JhcHBlcjp0Ll9yb290Lm9wYWNpdHkuc2xpZGVyLG9uc3RvcDooKT0+dC5fZW1pdChcImNoYW5nZXN0b3BcIixcInNsaWRlclwiLHQpLG9uY2hhbmdlKG8pe2lmKCFlLm9wYWNpdHl8fCFlLnBhbGV0dGUpcmV0dXJuO2NvbnN0IG49cygpO3QuX3JlY2FsYyYmKG4uYT1NYXRoLnJvdW5kKDEwMCpvKS8xMDApLHRoaXMuZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kPWByZ2JhKDAsIDAsIDAsICR7bi5hfSlgLHIucGFsZXR0ZS50cmlnZ2VyKCl9fSksc2VsZWN0YWJsZTprKHtlbGVtZW50czp0Ll9yb290LmludGVyYWN0aW9uLm9wdGlvbnMsY2xhc3NOYW1lOlwiYWN0aXZlXCIsb25jaGFuZ2UoZSl7dC5fcmVwcmVzZW50YXRpb249ZS50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS10eXBlXCIpLnRvVXBwZXJDYXNlKCksdC5fcmVjYWxjJiZ0Ll91cGRhdGVPdXRwdXQoXCJzd2F0Y2hcIil9fSl9O3RoaXMuX2NvbXBvbmVudHM9cn1fYmluZEV2ZW50cygpe2NvbnN0e19yb290OnQsb3B0aW9uczplfT10aGlzLG89W2kodC5pbnRlcmFjdGlvbi5jbGVhcixcImNsaWNrXCIsKCgpPT50aGlzLl9jbGVhckNvbG9yKCkpKSxpKFt0LmludGVyYWN0aW9uLmNhbmNlbCx0LnByZXZpZXcubGFzdENvbG9yXSxcImNsaWNrXCIsKCgpPT57dGhpcy5zZXRIU1ZBKC4uLih0aGlzLl9sYXN0Q29sb3J8fHRoaXMuX2NvbG9yKS50b0hTVkEoKSwhMCksdGhpcy5fZW1pdChcImNhbmNlbFwiKX0pKSxpKHQuaW50ZXJhY3Rpb24uc2F2ZSxcImNsaWNrXCIsKCgpPT57IXRoaXMuYXBwbHlDb2xvcigpJiYhZS5zaG93QWx3YXlzJiZ0aGlzLmhpZGUoKX0pKSxpKHQuaW50ZXJhY3Rpb24ucmVzdWx0LFtcImtleXVwXCIsXCJpbnB1dFwiXSwodD0+e3RoaXMuc2V0Q29sb3IodC50YXJnZXQudmFsdWUsITApJiYhdGhpcy5faW5pdGlhbGl6aW5nQWN0aXZlJiYodGhpcy5fZW1pdChcImNoYW5nZVwiLHRoaXMuX2NvbG9yLFwiaW5wdXRcIix0aGlzKSx0aGlzLl9lbWl0KFwiY2hhbmdlc3RvcFwiLFwiaW5wdXRcIix0aGlzKSksdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKX0pKSxpKHQuaW50ZXJhY3Rpb24ucmVzdWx0LFtcImZvY3VzXCIsXCJibHVyXCJdLCh0PT57dGhpcy5fcmVjYWxjPVwiYmx1clwiPT09dC50eXBlLHRoaXMuX3JlY2FsYyYmdGhpcy5fdXBkYXRlT3V0cHV0KG51bGwpfSkpLGkoW3QucGFsZXR0ZS5wYWxldHRlLHQucGFsZXR0ZS5waWNrZXIsdC5odWUuc2xpZGVyLHQuaHVlLnBpY2tlcix0Lm9wYWNpdHkuc2xpZGVyLHQub3BhY2l0eS5waWNrZXJdLFtcIm1vdXNlZG93blwiLFwidG91Y2hzdGFydFwiXSwoKCk9PnRoaXMuX3JlY2FsYz0hMCkse3Bhc3NpdmU6ITB9KV07aWYoIWUuc2hvd0Fsd2F5cyl7Y29uc3Qgbj1lLmNsb3NlV2l0aEtleTtvLnB1c2goaSh0LmJ1dHRvbixcImNsaWNrXCIsKCgpPT50aGlzLmlzT3BlbigpP3RoaXMuaGlkZSgpOnRoaXMuc2hvdygpKSksaShkb2N1bWVudCxcImtleXVwXCIsKHQ9PnRoaXMuaXNPcGVuKCkmJih0LmtleT09PW58fHQuY29kZT09PW4pJiZ0aGlzLmhpZGUoKSkpLGkoZG9jdW1lbnQsW1widG91Y2hzdGFydFwiLFwibW91c2Vkb3duXCJdLChlPT57dGhpcy5pc09wZW4oKSYmIWwoZSkuc29tZSgoZT0+ZT09PXQuYXBwfHxlPT09dC5idXR0b24pKSYmdGhpcy5oaWRlKCl9KSx7Y2FwdHVyZTohMH0pKX1pZihlLmFkanVzdGFibGVOdW1iZXJzKXtjb25zdCBlPXtyZ2JhOlsyNTUsMjU1LDI1NSwxXSxoc3ZhOlszNjAsMTAwLDEwMCwxXSxoc2xhOlszNjAsMTAwLDEwMCwxXSxjbXlrOlsxMDAsMTAwLDEwMCwxMDBdfTtwKHQuaW50ZXJhY3Rpb24ucmVzdWx0LCgodCxvLG4pPT57Y29uc3QgaT1lW3RoaXMuZ2V0Q29sb3JSZXByZXNlbnRhdGlvbigpLnRvTG93ZXJDYXNlKCldO2lmKGkpe2NvbnN0IGU9aVtuXSxzPXQrKGU+PTEwMD8xZTMqbzpvKTtyZXR1cm4gczw9MD8wOk51bWJlcigoczxlP3M6ZSkudG9QcmVjaXNpb24oMykpfXJldHVybiB0fSkpfWlmKGUuYXV0b1JlcG9zaXRpb24mJiFlLmlubGluZSl7bGV0IHQ9bnVsbDtjb25zdCBuPXRoaXM7by5wdXNoKGkod2luZG93LFtcInNjcm9sbFwiLFwicmVzaXplXCJdLCgoKT0+e24uaXNPcGVuKCkmJihlLmNsb3NlT25TY3JvbGwmJm4uaGlkZSgpLG51bGw9PT10Pyh0PXNldFRpbWVvdXQoKCgpPT50PW51bGwpLDEwMCkscmVxdWVzdEFuaW1hdGlvbkZyYW1lKChmdW5jdGlvbiBlKCl7bi5fcmVQb3NpdGlvbmluZ1BpY2tlcigpLG51bGwhPT10JiZyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSl9KSkpOihjbGVhclRpbWVvdXQodCksdD1zZXRUaW1lb3V0KCgoKT0+dD1udWxsKSwxMDApKSl9KSx7Y2FwdHVyZTohMH0pKX10aGlzLl9ldmVudEJpbmRpbmdzPW99X3JlUG9zaXRpb25pbmdQaWNrZXIoKXtjb25zdHtvcHRpb25zOnR9PXRoaXM7aWYoIXQuaW5saW5lKXtpZighdGhpcy5fbmFub3BvcC51cGRhdGUoe2NvbnRhaW5lcjpkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHBvc2l0aW9uOnQucG9zaXRpb259KSl7Y29uc3QgdD10aGlzLl9yb290LmFwcCxlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7dC5zdHlsZS50b3A9KHdpbmRvdy5pbm5lckhlaWdodC1lLmhlaWdodCkvMitcInB4XCIsdC5zdHlsZS5sZWZ0PSh3aW5kb3cuaW5uZXJXaWR0aC1lLndpZHRoKS8yK1wicHhcIn19fV91cGRhdGVPdXRwdXQodCl7Y29uc3R7X3Jvb3Q6ZSxfY29sb3I6byxvcHRpb25zOm59PXRoaXM7aWYoZS5pbnRlcmFjdGlvbi50eXBlKCkpe2NvbnN0IHQ9YHRvJHtlLmludGVyYWN0aW9uLnR5cGUoKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGVcIil9YDtlLmludGVyYWN0aW9uLnJlc3VsdC52YWx1ZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBvW3RdP29bdF0oKS50b1N0cmluZyhuLm91dHB1dFByZWNpc2lvbik6XCJcIn0hdGhpcy5faW5pdGlhbGl6aW5nQWN0aXZlJiZ0aGlzLl9yZWNhbGMmJnRoaXMuX2VtaXQoXCJjaGFuZ2VcIixvLHQsdGhpcyl9X2NsZWFyQ29sb3IodD0hMSl7Y29uc3R7X3Jvb3Q6ZSxvcHRpb25zOm99PXRoaXM7by51c2VBc0J1dHRvbnx8ZS5idXR0b24uc3R5bGUuc2V0UHJvcGVydHkoXCItLXBjci1jb2xvclwiLFwicmdiYSgwLCAwLCAwLCAwLjE1KVwiKSxlLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2xlYXJcIiksby5zaG93QWx3YXlzfHx0aGlzLmhpZGUoKSx0aGlzLl9sYXN0Q29sb3I9bnVsbCx0aGlzLl9pbml0aWFsaXppbmdBY3RpdmV8fHR8fCh0aGlzLl9lbWl0KFwic2F2ZVwiLG51bGwpLHRoaXMuX2VtaXQoXCJjbGVhclwiKSl9X3BhcnNlTG9jYWxDb2xvcih0KXtjb25zdHt2YWx1ZXM6ZSx0eXBlOm8sYTpufT13KHQpLHtsb2NrT3BhY2l0eTppfT10aGlzLm9wdGlvbnMscz12b2lkIDAhPT1uJiYxIT09bjtyZXR1cm4gZSYmMz09PWUubGVuZ3RoJiYoZVszXT12b2lkIDApLHt2YWx1ZXM6IWV8fGkmJnM/bnVsbDplLHR5cGU6b319X3QodCl7cmV0dXJuIHRoaXMub3B0aW9ucy5pMThuW3RdfHxFLkkxOE5fREVGQVVMVFNbdF19X2VtaXQodCwuLi5lKXt0aGlzLl9ldmVudExpc3RlbmVyW3RdLmZvckVhY2goKHQ9PnQoLi4uZSx0aGlzKSkpfW9uKHQsZSl7cmV0dXJuIHRoaXMuX2V2ZW50TGlzdGVuZXJbdF0ucHVzaChlKSx0aGlzfW9mZih0LGUpe2NvbnN0IG89dGhpcy5fZXZlbnRMaXN0ZW5lclt0XXx8W10sbj1vLmluZGV4T2YoZSk7cmV0dXJufm4mJm8uc3BsaWNlKG4sMSksdGhpc31hZGRTd2F0Y2godCl7Y29uc3R7dmFsdWVzOmV9PXRoaXMuX3BhcnNlTG9jYWxDb2xvcih0KTtpZihlKXtjb25zdHtfc3dhdGNoQ29sb3JzOnQsX3Jvb3Q6b309dGhpcyxuPUEoLi4uZSkscz1yKGA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBzdHlsZT1cIi0tcGNyLWNvbG9yOiAke24udG9SR0JBKCkudG9TdHJpbmcoMCl9XCIgYXJpYS1sYWJlbD1cIiR7dGhpcy5fdChcImJ0bjpzd2F0Y2hcIil9XCIvPmApO3JldHVybiBvLnN3YXRjaGVzLmFwcGVuZENoaWxkKHMpLHQucHVzaCh7ZWw6cyxjb2xvcjpufSksdGhpcy5fZXZlbnRCaW5kaW5ncy5wdXNoKGkocyxcImNsaWNrXCIsKCgpPT57dGhpcy5zZXRIU1ZBKC4uLm4udG9IU1ZBKCksITApLHRoaXMuX2VtaXQoXCJzd2F0Y2hzZWxlY3RcIixuKSx0aGlzLl9lbWl0KFwiY2hhbmdlXCIsbixcInN3YXRjaFwiLHRoaXMpfSkpKSwhMH1yZXR1cm4hMX1yZW1vdmVTd2F0Y2godCl7Y29uc3QgZT10aGlzLl9zd2F0Y2hDb2xvcnNbdF07aWYoZSl7Y29uc3R7ZWw6b309ZTtyZXR1cm4gdGhpcy5fcm9vdC5zd2F0Y2hlcy5yZW1vdmVDaGlsZChvKSx0aGlzLl9zd2F0Y2hDb2xvcnMuc3BsaWNlKHQsMSksITB9cmV0dXJuITF9YXBwbHlDb2xvcih0PSExKXtjb25zdHtwcmV2aWV3OmUsYnV0dG9uOm99PXRoaXMuX3Jvb3Qsbj10aGlzLl9jb2xvci50b1JHQkEoKS50b1N0cmluZygwKTtyZXR1cm4gZS5sYXN0Q29sb3Iuc3R5bGUuc2V0UHJvcGVydHkoXCItLXBjci1jb2xvclwiLG4pLHRoaXMub3B0aW9ucy51c2VBc0J1dHRvbnx8by5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tcGNyLWNvbG9yXCIsbiksby5jbGFzc0xpc3QucmVtb3ZlKFwiY2xlYXJcIiksdGhpcy5fbGFzdENvbG9yPXRoaXMuX2NvbG9yLmNsb25lKCksdGhpcy5faW5pdGlhbGl6aW5nQWN0aXZlfHx0fHx0aGlzLl9lbWl0KFwic2F2ZVwiLHRoaXMuX2NvbG9yKSx0aGlzfWRlc3Ryb3koKXtjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl9zZXR1cEFuaW1hdGlvbkZyYW1lKSx0aGlzLl9ldmVudEJpbmRpbmdzLmZvckVhY2goKHQ9PnMoLi4udCkpKSxPYmplY3Qua2V5cyh0aGlzLl9jb21wb25lbnRzKS5mb3JFYWNoKCh0PT50aGlzLl9jb21wb25lbnRzW3RdLmRlc3Ryb3koKSkpfWRlc3Ryb3lBbmRSZW1vdmUoKXt0aGlzLmRlc3Ryb3koKTtjb25zdHtyb290OnQsYXBwOmV9PXRoaXMuX3Jvb3Q7dC5wYXJlbnRFbGVtZW50JiZ0LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodCksZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGUpLE9iamVjdC5rZXlzKHRoaXMpLmZvckVhY2goKHQ9PnRoaXNbdF09bnVsbCkpfWhpZGUoKXtyZXR1cm4hIXRoaXMuaXNPcGVuKCkmJih0aGlzLl9yb290LmFwcC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKSx0aGlzLl9lbWl0KFwiaGlkZVwiKSwhMCl9c2hvdygpe3JldHVybiF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJiF0aGlzLmlzT3BlbigpJiYodGhpcy5fcm9vdC5hcHAuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIiksdGhpcy5fcmVQb3NpdGlvbmluZ1BpY2tlcigpLHRoaXMuX2VtaXQoXCJzaG93XCIsdGhpcy5fY29sb3IpLHRoaXMpfWlzT3Blbigpe3JldHVybiB0aGlzLl9yb290LmFwcC5jbGFzc0xpc3QuY29udGFpbnMoXCJ2aXNpYmxlXCIpfXNldEhTVkEodD0zNjAsZT0wLG89MCxuPTEsaT0hMSl7Y29uc3Qgcz10aGlzLl9yZWNhbGM7aWYodGhpcy5fcmVjYWxjPSExLHQ8MHx8dD4zNjB8fGU8MHx8ZT4xMDB8fG88MHx8bz4xMDB8fG48MHx8bj4xKXJldHVybiExO3RoaXMuX2NvbG9yPUEodCxlLG8sbik7Y29uc3R7aHVlOnIsb3BhY2l0eTphLHBhbGV0dGU6bH09dGhpcy5fY29tcG9uZW50cztyZXR1cm4gci51cGRhdGUodC8zNjApLGEudXBkYXRlKG4pLGwudXBkYXRlKGUvMTAwLDEtby8xMDApLGl8fHRoaXMuYXBwbHlDb2xvcigpLHMmJnRoaXMuX3VwZGF0ZU91dHB1dCgpLHRoaXMuX3JlY2FsYz1zLCEwfXNldENvbG9yKHQsZT0hMSl7aWYobnVsbD09PXQpcmV0dXJuIHRoaXMuX2NsZWFyQ29sb3IoZSksITA7Y29uc3R7dmFsdWVzOm8sdHlwZTpufT10aGlzLl9wYXJzZUxvY2FsQ29sb3IodCk7aWYobyl7Y29uc3QgdD1uLnRvVXBwZXJDYXNlKCkse29wdGlvbnM6aX09dGhpcy5fcm9vdC5pbnRlcmFjdGlvbixzPWkuZmluZCgoZT0+ZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGVcIik9PT10KSk7aWYocyYmIXMuaGlkZGVuKWZvcihjb25zdCB0IG9mIGkpdC5jbGFzc0xpc3RbdD09PXM/XCJhZGRcIjpcInJlbW92ZVwiXShcImFjdGl2ZVwiKTtyZXR1cm4hIXRoaXMuc2V0SFNWQSguLi5vLGUpJiZ0aGlzLnNldENvbG9yUmVwcmVzZW50YXRpb24odCl9cmV0dXJuITF9c2V0Q29sb3JSZXByZXNlbnRhdGlvbih0KXtyZXR1cm4gdD10LnRvVXBwZXJDYXNlKCksISF0aGlzLl9yb290LmludGVyYWN0aW9uLm9wdGlvbnMuZmluZCgoZT0+ZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGVcIikuc3RhcnRzV2l0aCh0KSYmIWUuY2xpY2soKSkpfWdldENvbG9yUmVwcmVzZW50YXRpb24oKXtyZXR1cm4gdGhpcy5fcmVwcmVzZW50YXRpb259Z2V0Q29sb3IoKXtyZXR1cm4gdGhpcy5fY29sb3J9Z2V0U2VsZWN0ZWRDb2xvcigpe3JldHVybiB0aGlzLl9sYXN0Q29sb3J9Z2V0Um9vdCgpe3JldHVybiB0aGlzLl9yb290fWRpc2FibGUoKXtyZXR1cm4gdGhpcy5oaWRlKCksdGhpcy5vcHRpb25zLmRpc2FibGVkPSEwLHRoaXMuX3Jvb3QuYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJkaXNhYmxlZFwiKSx0aGlzfWVuYWJsZSgpe3JldHVybiB0aGlzLm9wdGlvbnMuZGlzYWJsZWQ9ITEsdGhpcy5fcm9vdC5idXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImRpc2FibGVkXCIpLHRoaXN9fXJldHVybiBlPWUuZGVmYXVsdH0pKCkpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBpY2tyLm1pbi5qcy5tYXAiLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlYWRPbmx5OiBCb29sZWFuLFxuICAgIH1cblxuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIGRpdiB0byBhcHBseSB0aGUgZWRpdG9yIHRvXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmlkID0gdGhpcy5lbGVtZW50LmlkICsgJ19kaXYnO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc05hbWUgPSB0aGlzLmVsZW1lbnQuY2xhc3NOYW1lO1xuICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5jb250YWluZXIsIHRoaXMuZWxlbWVudC5uZXh0U2libGluZyk7XG5cbiAgICAgICAgLy8gSGlkZSB0aGUgdGV4dGFyZWFcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlWydkaXNwbGF5J10gPSAnbm9uZSc7XG5cbiAgICAgICAgLy8gSW5zdGFudGlhdGUgdGhlIGVkaXRvclxuICAgICAgICB0aGlzLmVkaXRvciA9IGFjZS5lZGl0KHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5lZGl0b3IuZ2V0U2Vzc2lvbigpLnNldFZhbHVlKHRoaXMuZWxlbWVudC52YWx1ZSk7XG5cbiAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2ZvY3VzJywgKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IHRoaXMuZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERpc2FibGUgY29tbWFuZCBjb25mbGljdHMgd2l0aCBBbHRHciAoc2VlICM1NzkyKVxuICAgICAgICB0aGlzLmVkaXRvci5jb21tYW5kcy5iaW5kS2V5KCdDdHJsLWFsdC1hfEN0cmwtYWx0LWV8Q3RybC1hbHQtaHxDdHJsLWFsdC1sfEN0cmwtYWx0LXMnLCBudWxsKTtcblxuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjb25maWcgY2FsbGJhY2tcbiAgICAgICAgdGhpcy5lbGVtZW50Py5jb25maWdDYWxsYmFjayh0aGlzLmVkaXRvcik7XG5cbiAgICAgICAgdGhpcy5zZXRNYXhMaW5lcygpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zZXRNYXhMaW5lcy5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmVkaXRvcj8uZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lcj8ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgYmVmb3JlQ2FjaGUoKSB7XG4gICAgICAgIC8vIFJlbW92ZSB0aGUgZWxlbWVudCBjb250YWluZXIgYmVmb3JlIFR1cmJvIGNhY2hlcyB0aGUgcGFnZS4gSXQgd2lsbFxuICAgICAgICAvLyBiZSByZWNyZWF0ZWQgd2hlbiB0aGUgY29ubmVjdCgpIGNhbGwgaGFwcGVucyBvbiB0aGUgcmVzdG9yZWQgcGFnZS5cbiAgICAgICAgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgfVxuXG4gICAgY29sb3JDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5lZGl0b3Iuc2V0VGhlbWUoYGFjZS90aGVtZS8ke2V2ZW50LmRldGFpbC5tb2RlID09PSAnZGFyaycgPyAndHdpbGlnaHQnIDogJ2Nsb3Vkcyd9YCk7XG4gICAgfVxuXG4gICAgc2V0TWF4TGluZXMoKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNldE9wdGlvbignbWF4TGluZXMnLCBNYXRoLmZsb29yKCh3aW5kb3cuaW5uZXJIZWlnaHQgLSAzMjApIC8gTWF0aC5mbG9vcigxMiAqIHRoaXMuZWRpdG9yLmNvbnRhaW5lci5zdHlsZS5saW5lSGVpZ2h0KSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7Q29udHJvbGxlcn0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhY2tlbmRTZWFyY2hDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbXG4gICAgICAgIFwiaW5wdXRcIixcbiAgICAgICAgXCJyZXN1bHRzXCIsXG4gICAgXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIHJvdXRlOiBTdHJpbmcsXG4gICAgICAgIG1pbkNoYXJhY3RlcnM6IHtcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgICAgICAgIGRlZmF1bHQ6IDMsXG4gICAgICAgIH0sXG4gICAgICAgIGRlbGF5OiB7XG4gICAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgICBkZWZhdWx0OiAxNTAsXG4gICAgICAgIH0sXG4gICAgfVxuXG4gICAgc3RhdGljIGNsYXNzZXMgPSBbXG4gICAgICAgIFwiaGlkZGVuXCIsXG4gICAgICAgIFwiaW5pdGlhbFwiLFxuICAgICAgICBcImxvYWRpbmdcIixcbiAgICAgICAgXCJpbnZhbGlkXCIsXG4gICAgICAgIFwicmVzdWx0c1wiLFxuICAgICAgICBcImVycm9yXCIsXG4gICAgXVxuXG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50aW1lb3V0ID0gbnVsbDtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKFwiaGlkZGVuXCIpO1xuICAgIH1cblxuICAgIHBlcmZvcm1TZWFyY2goKSB7XG4gICAgICAgIGlmICh0aGlzLmlucHV0VGFyZ2V0LnZhbHVlLmxlbmd0aCA8IHRoaXMubWluQ2hhcmFjdGVyc1ZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTdGF0ZShcImludmFsaWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcblxuICAgICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9hZFJlc3VsdHMoKTtcbiAgICAgICAgfSwgdGhpcy5kZWxheVZhbHVlKTtcbiAgICB9XG5cbiAgICBsb2FkUmVzdWx0cygpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShcImxvYWRpbmdcIik7XG5cbiAgICAgICAgZmV0Y2godGhpcy5zZWFyY2hSb3V0ZSlcbiAgICAgICAgICAgIC50aGVuKHJlcz0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlcy5vaykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXMudGV4dCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGh0bWwgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0c1RhcmdldC5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoXCJyZXN1bHRzXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKFwiZXJyb3JcIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvcGVuKCkge1xuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKFwiaW5pdGlhbFwiKTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmlucHV0VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgdGhpcy5pbnB1dFRhcmdldC52YWx1ZSA9IFwiXCI7XG5cbiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50aW1lb3V0ID0gbnVsbDtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKFwiaGlkZGVuXCIpO1xuICAgICAgICB0aGlzLl9yZXNldEZvY3VzYWJsZVJlc3VsdHMoKTtcbiAgICB9XG5cbiAgICBpbnB1dEJsdXIoKSB7XG4gICAgICAgIGlmIChcInJlc3VsdHNcIiA9PT0gdGhpcy5zdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cblxuICAgIGZvY3VzVHJhcE5leHQoZXZlbnQpIHtcbiAgICAgICAgaWYgKFwicmVzdWx0c1wiID09PSB0aGlzLnN0YXRlICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMubGFzdEZvY3VzKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5maXJzdEZvY3VzPy5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZm9jdXNUcmFwUHJldihldmVudCkge1xuICAgICAgICBpZiAoXCJyZXN1bHRzXCIgPT09IHRoaXMuc3RhdGUgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5maXJzdEZvY3VzKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5sYXN0Rm9jdXM/LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfcmVzZXRGb2N1c2FibGVSZXN1bHRzKCkge1xuICAgICAgICB0aGlzLmZpcnN0Rm9jdXMgPSBudWxsO1xuICAgICAgICB0aGlzLmxhc3RGb2N1cyA9IG51bGw7XG4gICAgfVxuXG4gICAgX3NldEZvY3VzYWJsZVJlc3VsdHMoKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gW3RoaXMuaW5wdXRUYXJnZXQsIC4uLnRoaXMucmVzdWx0c1RhcmdldC5xdWVyeVNlbGVjdG9yQWxsKCdhW2hyZWZdOm5vdChbZGlzYWJsZWRdKSwgYnV0dG9uOm5vdChbZGlzYWJsZWRdKScpXVxuXG4gICAgICAgIHRoaXMuZmlyc3RGb2N1cyA9IGVsZW1lbnRzWzBdID8/IFtdXG4gICAgICAgIHRoaXMubGFzdEZvY3VzID0gZWxlbWVudHNbZWxlbWVudHMubGVuZ3RoIC0gMV0gPz8gW11cbiAgICB9XG5cbiAgICBkb2N1bWVudENsaWNrKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cblxuICAgIHNldFN0YXRlKHN0YXRlKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcblxuICAgICAgICBpZiAoc3RhdGUgPT09IFwicmVzdWx0c1wiKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRGb2N1c2FibGVSZXN1bHRzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNldEZvY3VzYWJsZVJlc3VsdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEJhY2tlbmRTZWFyY2hDb250cm9sbGVyLmNsYXNzZXMuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC50b2dnbGUodGhpc1tgJHtjbGFzc05hbWV9Q2xhc3NgXSwgY2xhc3NOYW1lID09PSBzdGF0ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldCBzZWFyY2hSb3V0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVWYWx1ZSArIHRoaXMuaW5wdXRUYXJnZXQudmFsdWU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtDb250cm9sbGVyfSBmcm9tIFwiQGhvdHdpcmVkL3N0aW11bHVzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2hvaWNlc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBtdXRhdGlvbkd1YXJkID0gZmFsc2U7XG5cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy5faXNHdWFyZGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENob2ljZXMgd3JhcHMgdGhlIGVsZW1lbnQgbXVsdGlwbGUgdGltZXMgZHVyaW5nIGluaXRpYWxpemF0aW9uLCBsZWFkaW5nIHRvXG4gICAgICAgIC8vIG11bHRpcGxlIGRpc2Nvbm5lY3RzL3JlY29ubmVjdHMgb2YgdGhlIGNvbnRyb2xsZXIgdGhhdCB3ZSBuZWVkIHRvIGlnbm9yZS5cbiAgICAgICAgdGhpcy5fc2V0R3VhcmQoKTtcblxuICAgICAgICBjb25zdCBzZWxlY3QgPSB0aGlzLmVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5jaG9pY2VzID0gbmV3IENob2ljZXMoc2VsZWN0LCB7XG4gICAgICAgICAgICBzaG91bGRTb3J0OiBmYWxzZSxcbiAgICAgICAgICAgIGR1cGxpY2F0ZUl0ZW1zQWxsb3dlZDogZmFsc2UsXG4gICAgICAgICAgICBhbGxvd0hUTUw6IGZhbHNlLFxuICAgICAgICAgICAgcmVtb3ZlSXRlbUJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgIHNlYXJjaEVuYWJsZWQ6IHNlbGVjdC5vcHRpb25zLmxlbmd0aCA+IDcsXG4gICAgICAgICAgICBjbGFzc05hbWVzOiB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyT3V0ZXI6IFsnY2hvaWNlcycsIC4uLkFycmF5LmZyb20oc2VsZWN0LmNsYXNzTGlzdCldLFxuICAgICAgICAgICAgICAgIGZsaXBwZWRTdGF0ZTogJycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZnVzZU9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBpbmNsdWRlU2NvcmU6IHRydWUsXG4gICAgICAgICAgICAgICAgdGhyZXNob2xkOiAwLjQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2FsbGJhY2tPbkluaXQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaG9pY2VzID0gc2VsZWN0LmNsb3Nlc3QoJy5jaG9pY2VzJyk/LnF1ZXJ5U2VsZWN0b3IoJy5jaG9pY2VzX19saXN0LS1kcm9wZG93biA+IC5jaG9pY2VzX19saXN0Jyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2hvaWNlcyAmJiBzZWxlY3QuZGF0YXNldC5wbGFjZWhvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICBjaG9pY2VzLmRhdGFzZXQucGxhY2Vob2xkZXIgPSBzZWxlY3QuZGF0YXNldC5wbGFjZWhvbGRlcjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9yZXNldEd1YXJkKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9hZGluZ1RleHQ6IENvbnRhby5sYW5nLmxvYWRpbmcsXG4gICAgICAgICAgICBub1Jlc3VsdHNUZXh0OiBDb250YW8ubGFuZy5ub1Jlc3VsdHMsXG4gICAgICAgICAgICBub0Nob2ljZXNUZXh0OiBDb250YW8ubGFuZy5ub09wdGlvbnMsXG4gICAgICAgICAgICByZW1vdmVJdGVtTGFiZWxUZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29udGFvLmxhbmcucmVtb3ZlSXRlbS5jb25jYXQoJyAnKS5jb25jYXQodmFsdWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy5faXNHdWFyZGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3JlbW92ZUNob2ljZXMoKTtcbiAgICB9XG5cbiAgICBiZWZvcmVDYWNoZSgpIHtcbiAgICAgICAgLy8gTGV0IGNob2ljZXMgdW53cmFwIHRoZSBlbGVtZW50IGNvbnRhaW5lciBiZWZvcmUgVHVyYm8gY2FjaGVzIHRoZVxuICAgICAgICAvLyBwYWdlLiBJdCB3aWxsIGJlIHJlY3JlYXRlZCwgd2hlbiB0aGUgY29ubmVjdCgpIGNhbGwgaGFwcGVucyBvbiB0aGVcbiAgICAgICAgLy8gcmVzdG9yZWQgcGFnZS5cbiAgICAgICAgdGhpcy5fcmVtb3ZlQ2hvaWNlcygpO1xuICAgIH1cblxuICAgIF9yZW1vdmVDaG9pY2VzKCkge1xuICAgICAgICAvLyBTYWZlbHkgdW53cmFwIHRoZSBlbGVtZW50IGJ5IHByZXZlbnRpbmcgZGlzY29ubmVjdC9jb25uZWN0IGNhbGxzXG4gICAgICAgIC8vIGR1cmluZyB0aGUgcHJvY2Vzcy5cbiAgICAgICAgdGhpcy5fc2V0R3VhcmQoKTtcblxuICAgICAgICB0aGlzLmNob2ljZXM/LmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5jaG9pY2VzID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9yZXNldEd1YXJkKCk7XG4gICAgfVxuXG4gICAgX3NldEd1YXJkKCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uR3VhcmQgPSB0cnVlO1xuICAgIH1cblxuICAgIF9yZXNldEd1YXJkKCkge1xuICAgICAgICAvLyBSZXNldCBndWFyZCBhcyBzb29uIGFzIHRoZSBjYWxsIHN0YWNrIGhhcyBjbGVhcmVkLlxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgdGhpcy5tdXRhdGlvbkd1YXJkID0gZmFsc2U7IH0sIDApO1xuICAgIH1cblxuICAgIF9pc0d1YXJkZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uR3VhcmQ7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgY29udGVudDogU3RyaW5nXG4gICAgfVxuXG4gICAgd3JpdGUgKCkge1xuICAgICAgICBpZiAobmF2aWdhdG9yLmNsaXBib2FyZCAmJiBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCkge1xuICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodGhpcy5jb250ZW50VmFsdWUpLmNhdGNoKHRoaXMuY2xpcGJvYXJkRmFsbGJhY2suYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsaXBib2FyZEZhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbGlwYm9hcmRGYWxsYmFjayAgKCkge1xuICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5jb250ZW50VmFsdWU7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuICAgICAgICBpbnB1dC5zZWxlY3QoKTtcbiAgICAgICAgaW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgOTk5OTkpO1xuICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGlucHV0KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQ29sb3JQaWNrZXIgZnJvbSBcIkBzdGltdWx1cy1jb21wb25lbnRzL2NvbG9yLXBpY2tlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbG9yUGlja2VyIHtcbiAgICAvLyBPdmVycmlkZSB0aGUgb25TYXZlIGZ1bmN0aW9uIHRvIHN0cmlwIHRoZSBsZWFkaW5nIGAjYFxuICAgIG9uU2F2ZShjb2xvcikge1xuICAgICAgICB0aGlzLmlucHV0VGFyZ2V0LnZhbHVlID0gbnVsbDtcblxuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IGNvbG9yLnRvSEVYQSgpLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICAgIGlmICgnIycgPT09IHZhbHVlLmNoYXJBdCgwKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuc3Vic3RyaW5nKDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmlucHV0VGFyZ2V0LnZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucGlja2VyLmhpZGUoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuY29uc3QgcHJlZmVyc0RhcmsgPSAoKSA9PiB7XG4gICAgY29uc3QgcHJlZmVyc0RhcmsgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY29udGFvLS1wcmVmZXJzLWRhcmsnKTtcblxuICAgIGlmIChudWxsID09PSBwcmVmZXJzRGFyaykge1xuICAgICAgICByZXR1cm4gISF3aW5kb3cubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpLm1hdGNoZXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByZWZlcnNEYXJrID09PSAndHJ1ZSc7XG59XG5cbmNvbnN0IHNldENvbG9yU2NoZW1lID0gKCkgPT4ge1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0LmNvbG9yU2NoZW1lID0gcHJlZmVyc0RhcmsoKSA/ICdkYXJrJyA6ICdsaWdodCc7XG59O1xuXG53aW5kb3cubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHNldENvbG9yU2NoZW1lKTtcbnNldENvbG9yU2NoZW1lKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ2xhYmVsJ107XG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBpMThuOiB7XG4gICAgICAgICAgICB0eXBlOiBPYmplY3QsXG4gICAgICAgICAgICBkZWZhdWx0OiB7IGxpZ2h0OiAnRGlzYWJsZSBkYXJrIG1vZGUnLCBkYXJrOiAnRW5hYmxlIGRhcmsgbW9kZScgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGluaXRpYWxpemUgKCkge1xuICAgICAgICB0aGlzLnNldExhYmVsID0gdGhpcy5zZXRMYWJlbC5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICB0aGlzLm1hdGNoTWVkaWEgPSB3aW5kb3cubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpO1xuICAgICAgICB0aGlzLm1hdGNoTWVkaWEuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5zZXRMYWJlbCk7XG4gICAgICAgIHRoaXMuc2V0TGFiZWwoKTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5tYXRjaE1lZGlhLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuc2V0TGFiZWwpO1xuICAgIH1cblxuICAgIHRvZ2dsZSAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaXNEYXJrID0gIXByZWZlcnNEYXJrKCk7XG5cbiAgICAgICAgaWYgKGlzRGFyayA9PT0gdGhpcy5tYXRjaE1lZGlhLm1hdGNoZXMpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjb250YW8tLXByZWZlcnMtZGFyaycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NvbnRhby0tcHJlZmVycy1kYXJrJywgU3RyaW5nKGlzRGFyaykpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0Q29sb3JTY2hlbWUoKTtcblxuICAgICAgICB0aGlzLmRpc3BhdGNoKCdjaGFuZ2UnLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICBtb2RlOiBpc0RhcmsgPyAnZGFyaycgOiAnbGlnaHQnXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDaGFuZ2UgdGhlIGxhYmVsIGFmdGVyIHRoZSBkcm9wZG93biBpcyBoaWRkZW5cbiAgICAgICAgc2V0VGltZW91dCh0aGlzLnNldExhYmVsLCAzMDApO1xuICAgIH1cblxuICAgIHNldExhYmVsICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc0xhYmVsVGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsYWJlbCA9IHRoaXMuaTE4blZhbHVlW3ByZWZlcnNEYXJrKCkgPyAnbGlnaHQnIDogJ2RhcmsnXTtcblxuICAgICAgICB0aGlzLmxhYmVsVGFyZ2V0LnRpdGxlID0gbGFiZWw7XG4gICAgICAgIHRoaXMubGFiZWxUYXJnZXQuaW5uZXJUZXh0ID0gbGFiZWw7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5pbXBvcnQgKiBhcyBUdXJibyBmcm9tICdAaG90d2lyZWQvdHVyYm8nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydwcmltYXJ5JywgJ3NlY29uZGFyeSddO1xuXG4gICAgc3RhdGljIGFmdGVyTG9hZCAoaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBzZXR1cENvbnRyb2xsZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xpY2syZWRpdCcpLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnY2xpY2syZWRpdCcpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcHJpbWFyeSA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2EuZWRpdCcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlY29uZGFyeSA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2EuY2hpbGRyZW4nKTtcblxuICAgICAgICAgICAgICAgIGlmIChwcmltYXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIHByaW1hcnkuc2V0QXR0cmlidXRlKGBkYXRhLSR7aWRlbnRpZmllcn0tdGFyZ2V0YCwgXCJwcmltYXJ5XCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzZWNvbmRhcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2Vjb25kYXJ5LnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LXRhcmdldGAsIFwic2Vjb25kYXJ5XCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGVsLmRhdGFzZXQuY29udHJvbGxlciA9IGAke2VsLmRhdGFzZXQuY29udHJvbGxlciB8fCAnJ30gJHtpZGVudGlmaWVyfWA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgc2V0dXBDb250cm9sbGVyKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYWpheF9jaGFuZ2UnLCBzZXR1cENvbnRyb2xsZXIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0dXJibzpyZW5kZXInLCBzZXR1cENvbnRyb2xsZXIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0dXJibzpmcmFtZS1yZW5kZXInLCBzZXR1cENvbnRyb2xsZXIpO1xuICAgICAgICBzZXR1cENvbnRyb2xsZXIoKTtcblxuICAgICAgICBUaGVtZS5zZXR1cEN0cmxDbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh3aW5kb3cuY29uc29sZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignVXNpbmcgVGhlbWUuc2V0dXBDdHJsQ2xpY2soKSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gQ29udGFvIDYuIEFwcGx5IHRoZSBTdGltdWx1cyBhY3Rpb25zIGluc3RlYWQuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldHVwQ29udHJvbGxlcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZSAoKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlID0gdGhpcy5oYW5kbGUuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGUpO1xuICAgIH1cblxuICAgIGhhbmRsZSAoZXZlbnQpIHtcbiAgICAgICAgLy8gSWdub3JlIGNsaWNrcyBvbiBhbmNob3IgZWxlbWVudHNcbiAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWQoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJpbWFyeUtleSA9IHdpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0/LnN0YXJ0c1dpdGgoJ01hYycpID8gJ21ldGFLZXknIDogJ2N0cmxLZXknO1xuXG4gICAgICAgIGlmIChldmVudFtwcmltYXJ5S2V5XSAmJiAhZXZlbnQuc2hpZnRLZXkgJiYgdGhpcy5oYXNQcmltYXJ5VGFyZ2V0ICYmIHRoaXMucHJpbWFyeVRhcmdldC5ocmVmKSB7XG4gICAgICAgICAgICBUdXJiby52aXNpdCh0aGlzLnByaW1hcnlUYXJnZXQuaHJlZik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXZlbnRbcHJpbWFyeUtleV0gJiYgZXZlbnQuc2hpZnRLZXkgJiYgdGhpcy5oYXNTZWNvbmRhcnlUYXJnZXQgJiYgdGhpcy5zZWNvbmRhcnlUYXJnZXQuaHJlZikge1xuICAgICAgICAgICAgVHVyYm8udmlzaXQodGhpcy5zZWNvbmRhcnlUYXJnZXQuaHJlZik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXZlbnQucG9pbnRlclR5cGUgPT09ICdtb3VzZScgfHwgIXRoaXMuaGFzUHJpbWFyeVRhcmdldCB8fCAhdGhpcy5wcmltYXJ5VGFyZ2V0LmhyZWYpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLiR0aW1lcik7XG5cbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXZpc2l0ZWQnKSkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS12aXNpdGVkJywgJzEnKTtcblxuICAgICAgICAgICAgdGhpcy4kdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXZpc2l0ZWQnKTtcbiAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS12aXNpdGVkJyk7XG4gICAgICAgICAgICBUdXJiby52aXNpdCh0aGlzLnByaW1hcnlUYXJnZXQuaHJlZik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2aXNpdFByaW1hcnkgKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1ByaW1hcnlUYXJnZXQgJiYgdGhpcy5wcmltYXJ5VGFyZ2V0LmhyZWYgJiYgdGhpcy5pc1ZhbGlkKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIFR1cmJvLnZpc2l0KHRoaXMucHJpbWFyeVRhcmdldC5ocmVmKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZpc2l0U2Vjb25kYXJ5IChldmVudCkge1xuICAgICAgICBpZiAodGhpcy5oYXNTZWNvbmRhcnlUYXJnZXQgJiYgdGhpcy5zZWNvbmRhcnlUYXJnZXQuaHJlZiAmJiB0aGlzLmlzVmFsaWQoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgVHVyYm8udmlzaXQodGhpcy5zZWNvbmRhcnlUYXJnZXQuaHJlZik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpc1ZhbGlkIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiAnYScgIT09IGVsZW1lbnQudGFnTmFtZSAmJiAhZWxlbWVudC5jbG9zZXN0KCdhLCBidXR0b24nKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnc2VsZWN0JywgJ2J1dHRvbicsICdpbWFnZSddO1xuXG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgY29uZmlnOiBPYmplY3QsXG4gICAgfVxuXG4gICAgY29ubmVjdCAoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlV2l6YXJkKCk7XG4gICAgfVxuXG4gICAgdXBkYXRlV2l6YXJkICgpIHtcbiAgICAgICAgaWYgKHRoaXMuY2FuRWRpdCgpKSB7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvblRhcmdldC50aXRsZSA9IHRoaXMuY29uZmlnVmFsdWUudGl0bGU7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvblRhcmdldC5kaXNhYmxlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLmltYWdlVGFyZ2V0cy5mb3JFYWNoKChpbWcpID0+IHtcbiAgICAgICAgICAgICAgICBpbWcuc3JjID0gdGhpcy5jb25maWdWYWx1ZS5pY29uO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvblRhcmdldC50aXRsZSA9ICcnO1xuICAgICAgICAgICAgdGhpcy5idXR0b25UYXJnZXQuZGlzYWJsZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICB0aGlzLmltYWdlVGFyZ2V0cy5mb3JFYWNoKChpbWcpID0+IHtcbiAgICAgICAgICAgICAgICBpbWcuc3JjID0gdGhpcy5jb25maWdWYWx1ZS5pY29uRGlzYWJsZWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wZW5Nb2RhbCAoKSB7XG4gICAgICAgIEJhY2tlbmQub3Blbk1vZGFsSWZyYW1lKHtcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLmNvbmZpZ1ZhbHVlLnRpdGxlLFxuICAgICAgICAgICAgdXJsOiBgJHsgdGhpcy5jb25maWdWYWx1ZS5ocmVmIH0maWQ9JHsgdGhpcy5zZWxlY3RUYXJnZXQudmFsdWUgfWBcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2FuRWRpdCAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ1ZhbHVlLmlkcy5pbmNsdWRlcyhOdW1iZXIodGhpcy5zZWxlY3RUYXJnZXQudmFsdWUpKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnbmF2aWdhdGlvbicsICdzZWN0aW9uJ107XG5cbiAgICBzZWN0aW9uVGFyZ2V0Q29ubmVjdGVkICgpIHtcbiAgICAgICAgdGhpcy5yZWJ1aWxkTmF2aWdhdGlvbigpO1xuICAgIH1cblxuICAgIHNlY3Rpb25UYXJnZXREaXNjb25uZWN0ZWQgKCkge1xuICAgICAgICB0aGlzLnJlYnVpbGROYXZpZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgcmVidWlsZE5hdmlnYXRpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzTmF2aWdhdGlvblRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGlua3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuXG4gICAgICAgIHRoaXMuc2VjdGlvblRhcmdldHMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgYWN0aW9uLmlubmVyVGV4dCA9IGVsLmdldEF0dHJpYnV0ZShgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0tbGFiZWwtdmFsdWVgKTtcblxuICAgICAgICAgICAgYWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKCdzY3JvbGx0bycsIHsgdGFyZ2V0OiBlbCB9KTtcbiAgICAgICAgICAgICAgICBlbC5zY3JvbGxJbnRvVmlldygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgICAgIGxpLmFwcGVuZChhY3Rpb24pO1xuXG4gICAgICAgICAgICBsaW5rcy5hcHBlbmQobGkpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5hdmlnYXRpb25UYXJnZXQucmVwbGFjZUNoaWxkcmVuKGxpbmtzKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBtYXg6IE51bWJlcixcbiAgICAgICAgZXhwYW5kOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZEFsbDogU3RyaW5nLFxuICAgICAgICBleHBhbmRBbGxUaXRsZTogU3RyaW5nLFxuICAgICAgICBjb2xsYXBzZUFsbDogU3RyaW5nLFxuICAgICAgICBjb2xsYXBzZUFsbFRpdGxlOiBTdHJpbmcsXG4gICAgfVxuXG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ29wZXJhdGlvbicsICdub2RlJ107XG5cbiAgICBpbml0aWFsaXplICgpIHtcbiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgICB0aGlzLnRvZ2dsZXJNYXAgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLm5leHRJZCA9IDE7XG4gICAgfVxuXG4gICAgb3BlcmF0aW9uVGFyZ2V0Q29ubmVjdGVkICgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICBub2RlVGFyZ2V0Q29ubmVjdGVkIChub2RlKSB7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUobm9kZSwgbnVsbCk7XG4gICAgICAgIGNvbnN0IHBhZGRpbmcgPSBwYXJzZUZsb2F0KHN0eWxlLnBhZGRpbmdUb3ApICsgcGFyc2VGbG9hdChzdHlsZS5wYWRkaW5nQm90dG9tKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gbm9kZS5jbGllbnRIZWlnaHQgLSBwYWRkaW5nO1xuXG4gICAgICAgIC8vIFJlc2l6ZSB0aGUgZWxlbWVudCBpZiBpdCBpcyBoaWdoZXIgdGhhbiB0aGUgbWF4aW11bSBoZWlnaHRcbiAgICAgICAgaWYgKHRoaXMubWF4VmFsdWUgPiBoZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbm9kZS5pZCkge1xuICAgICAgICAgICAgbm9kZS5pZCA9IGBsaW1pdC1oZWlnaHQtJHt0aGlzLm5leHRJZCsrfWA7XG4gICAgICAgIH1cblxuICAgICAgICBub2RlLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgICAgIG5vZGUuc3R5bGUubWF4SGVpZ2h0ID0gYCR7dGhpcy5tYXhWYWx1ZX1weGA7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi50aXRsZSA9IHRoaXMuZXhwYW5kVmFsdWU7XG4gICAgICAgIGJ1dHRvbi5pbm5lckhUTUwgPSAnPHNwYW4+Li4uPC9zcGFuPic7XG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCd1bnNlbGVjdGFibGUnKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgbm9kZS5pZCk7XG5cbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGUobm9kZSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbihldmVudCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHRvZ2dsZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdG9nZ2xlci5jbGFzc0xpc3QuYWRkKCdsaW1pdF90b2dnbGVyJyk7XG4gICAgICAgIHRvZ2dsZXIuYXBwZW5kKGJ1dHRvbik7XG5cbiAgICAgICAgdGhpcy50b2dnbGVyTWFwLnNldChub2RlLCB0b2dnbGVyKTtcblxuICAgICAgICBub2RlLmFwcGVuZCh0b2dnbGVyKTtcbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICBub2RlVGFyZ2V0RGlzY29ubmVjdGVkIChub2RlKSB7XG4gICAgICAgIGlmICghdGhpcy50b2dnbGVyTWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50b2dnbGVyTWFwLmdldChub2RlKS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy50b2dnbGVyTWFwLmRlbGV0ZShub2RlKTtcbiAgICAgICAgbm9kZS5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuICAgICAgICBub2RlLnN0eWxlLm1heEhlaWdodCA9ICcnO1xuICAgIH1cblxuICAgIHRvZ2dsZSAobm9kZSkge1xuICAgICAgICBpZiAobm9kZS5zdHlsZS5tYXhIZWlnaHQgPT09ICcnKSB7XG4gICAgICAgICAgICB0aGlzLmNvbGxhcHNlKG5vZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5leHBhbmQobm9kZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBleHBhbmQgKG5vZGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRvZ2dsZXJNYXAuaGFzKG5vZGUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBub2RlLnN0eWxlLm1heEhlaWdodCA9ICcnO1xuICAgICAgICBjb25zdCBidXR0b24gPSB0aGlzLnRvZ2dsZXJNYXAuZ2V0KG5vZGUpLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24udGl0bGUgPSB0aGlzLmNvbGxhcHNlVmFsdWU7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICAgIH1cblxuICAgIGNvbGxhcHNlIChub2RlKSB7XG4gICAgICAgIGlmICghdGhpcy50b2dnbGVyTWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZS5zdHlsZS5tYXhIZWlnaHQgPSBgJHt0aGlzLm1heFZhbHVlfXB4YDtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy50b2dnbGVyTWFwLmdldChub2RlKS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLnRpdGxlID0gdGhpcy5leHBhbmRWYWx1ZTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIH1cblxuICAgIHRvZ2dsZUFsbCAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IHRoaXMuaGFzRXhwYW5kZWQoKSBeIGV2ZW50LmFsdEtleTtcblxuICAgICAgICB0aGlzLm5vZGVUYXJnZXRzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgICAgIGlmIChpc0V4cGFuZGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xsYXBzZShub2RlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHBhbmQobm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKGV2ZW50KTtcbiAgICB9XG5cbiAgICBrZXlwcmVzcyAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oZXZlbnQpO1xuICAgIH1cblxuICAgIHVwZGF0ZU9wZXJhdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc09wZXJhdGlvblRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaGFzVG9nZ2xlcnMgPSAhIXRoaXMubm9kZVRhcmdldHMuZmluZCgoZWwpID0+IHRoaXMudG9nZ2xlck1hcC5oYXMoZWwpKTtcbiAgICAgICAgY29uc3QgZXhwYW5kZWQgPSB0aGlzLmhhc0V4cGFuZGVkKCk7XG5cbiAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuc3R5bGUuZGlzcGxheSA9IGhhc1RvZ2dsZXJzID8gJycgOiAnbm9uZSc7XG4gICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRoaXMubm9kZVRhcmdldHMubWFwKChlbCkgPT4gZWwuaWQpLmpvaW4oJyAnKSk7XG4gICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGV4cGFuZGVkID8gJ3RydWUnIDogJ2ZhbHNlJyk7XG5cbiAgICAgICAgaWYgKGV4cGFuZGVkIF4gKGV2ZW50ID8gZXZlbnQuYWx0S2V5IDogZmFsc2UpKSB7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5pbm5lclRleHQgPSB0aGlzLmNvbGxhcHNlQWxsVmFsdWU7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC50aXRsZSA9IHRoaXMuY29sbGFwc2VBbGxUaXRsZVZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuaW5uZXJUZXh0ID0gdGhpcy5leHBhbmRBbGxWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnRpdGxlID0gdGhpcy5leHBhbmRBbGxUaXRsZVZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFzRXhwYW5kZWQgKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLm5vZGVUYXJnZXRzLmZpbmQoKGVsKSA9PiB0aGlzLnRvZ2dsZXJNYXAuaGFzKGVsKSAmJiBlbC5zdHlsZS5tYXhIZWlnaHQgPT09ICcnKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnaW5wdXQnXTtcblxuICAgIGRlbGV0ZSAoKSB7XG4gICAgICAgIHRoaXMuaW5wdXRUYXJnZXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICB9KVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuaW1wb3J0IEFjY2Vzc2libGVNZW51IGZyb20gJ2FjY2Vzc2libGUtbWVudSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9wZXJhdGlvbnNNZW51Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydtZW51JywgJ3N1Ym1lbnUnLCAnY29udHJvbGxlcicsICd0aXRsZSddO1xuXG4gICAgY29ubmVjdCAoKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNDb250cm9sbGVyVGFyZ2V0IHx8ICF0aGlzLmhhc01lbnVUYXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuJG1lbnUgPSBuZXcgQWNjZXNzaWJsZU1lbnUuRGlzY2xvc3VyZU1lbnUoe1xuICAgICAgICAgICAgbWVudUVsZW1lbnQ6IHRoaXMubWVudVRhcmdldCxcbiAgICAgICAgICAgIG1lbnVMaW5rU2VsZWN0b3I6ICdhLGJ1dHRvbixpbWcnLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNvbnRyb2xsZXJUYXJnZXQ/LmFkZEV2ZW50TGlzdGVuZXIoJ2FjY2Vzc2libGVNZW51RXhwYW5kJywgKCkgPT4ge1xuICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyh3aW5kb3cuQWNjZXNzaWJsZU1lbnUubWVudXMpLmZvckVhY2goKG1lbnUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobWVudSAhPT0gdGhpcy4kbWVudSAmJiBtZW51LmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzWzBdLmlzT3Blbikge1xuICAgICAgICAgICAgICAgICAgICBtZW51LmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzWzBdLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgdGhpcy5zZXRGaXhlZFBvc2l0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaG92ZXInKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb250cm9sbGVyVGFyZ2V0Py5hZGRFdmVudExpc3RlbmVyKCdhY2Nlc3NpYmxlTWVudUNvbGxhcHNlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hvdmVyJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIC8vIENsZWFudXAgbWVudSBpbnN0YW5jZSwgb3RoZXJ3aXNlIHdlIHdvdWxkIGxlYWsgbWVtb3J5XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHdpbmRvdy5BY2Nlc3NpYmxlTWVudS5tZW51cykpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy4kbWVudSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB3aW5kb3cuQWNjZXNzaWJsZU1lbnUubWVudXNba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRpdGxlVGFyZ2V0Q29ubmVjdGVkIChlbCkge1xuICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoYGRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LXRhcmdldGApO1xuXG4gICAgICAgIGNvbnN0IGxpbmsgPSBlbC5xdWVyeVNlbGVjdG9yKCdhW3RpdGxlXScpO1xuICAgICAgICBpZiAobGluayAmJiAnJyAhPT0gbGluay5nZXRBdHRyaWJ1dGUoJ3RpdGxlJykpIHtcbiAgICAgICAgICAgIGxpbmsuYXBwZW5kKGxpbmsuZ2V0QXR0cmlidXRlKCd0aXRsZScpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGltZyA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2ltZ1thbHRdJyk7XG4gICAgICAgIGlmIChpbWcgJiYgJycgIT09IGltZy5nZXRBdHRyaWJ1dGUoJ2FsdCcpKSB7XG4gICAgICAgICAgICBpbWcucGFyZW50Tm9kZS5hcHBlbmQoaW1nLmdldEF0dHJpYnV0ZSgnYWx0JykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb3BlbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc0NvbnRyb2xsZXJUYXJnZXQgfHwgIXRoaXMuaGFzTWVudVRhcmdldCB8fCB0aGlzLmlzSW50ZXJhY3RpdmUoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgdGhpcy4kbWVudS5lbGVtZW50cy5zdWJtZW51VG9nZ2xlc1swXS5vcGVuKCk7XG4gICAgICAgIHRoaXMuc2V0Rml4ZWRQb3NpdGlvbihldmVudCk7XG4gICAgfVxuXG4gICAgc2V0Rml4ZWRQb3NpdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuc3VibWVudVRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgbGV0IHgsIHksIG9mZnNldCA9IDA7XG5cbiAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICB4ID0gZXZlbnQuY2xpZW50WDtcbiAgICAgICAgICAgIHkgPSBldmVudC5jbGllbnRZO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY29udHJvbGxlclRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIHggPSByLng7XG4gICAgICAgICAgICB5ID0gci55O1xuICAgICAgICAgICAgb2Zmc2V0ID0gMjA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnN1Ym1lbnVUYXJnZXQuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICB0aGlzLnN1Ym1lbnVUYXJnZXQuc3R5bGUucmlnaHQgPSAnYXV0byc7XG5cbiAgICAgICAgaWYgKHdpbmRvdy5pbm5lckhlaWdodCA8IHkgKyByZWN0LmhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5zdWJtZW51VGFyZ2V0LnN0eWxlLnRvcCA9IGAke3kgLSByZWN0LmhlaWdodH1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN1Ym1lbnVUYXJnZXQuc3R5bGUudG9wID0gYCR7eSArIG9mZnNldH1weGA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCB4ICsgcmVjdC53aWR0aCkge1xuICAgICAgICAgICAgdGhpcy5zdWJtZW51VGFyZ2V0LnN0eWxlLmxlZnQgPSBgJHt4IC0gcmVjdC53aWR0aCArIG9mZnNldH1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN1Ym1lbnVUYXJnZXQuc3R5bGUubGVmdCA9IGAke3ggKyBvZmZzZXR9cHhgO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaXNJbnRlcmFjdGl2ZSAoZWwpIHtcbiAgICAgICAgaWYgKGVsIGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCB8fCBlbCBpbnN0YW5jZW9mIEhUTUxBbmNob3JFbGVtZW50IHx8IGVsIGluc3RhbmNlb2YgSFRNTEJ1dHRvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWxzbyBjaGVjayB0aGUgcGFyZW50IGVsZW1lbnQgaWYgZWwgaXMgbm90IGludGVyYWN0aXZlXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGVsLnBhcmVudEVsZW1lbnQ7XG5cbiAgICAgICAgcmV0dXJuIHBhcmVudCBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQgfHwgcGFyZW50IGluc3RhbmNlb2YgSFRNTEFuY2hvckVsZW1lbnQgfHwgcGFyZW50IGluc3RhbmNlb2YgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ2Zvcm0nLCAnbmFtZUlucHV0J107XG5cbiAgICBuYW1lSW5wdXRUYXJnZXRDb25uZWN0ZWQoZWwpIHtcbiAgICAgICAgZWwuZm9jdXMoKTtcbiAgICAgICAgZWwuc2VsZWN0KCk7XG4gICAgfVxuXG4gICAgY2FuY2VsRWRpdChlKSB7XG4gICAgICAgIHRoaXMubmFtZUlucHV0VGFyZ2V0LnZhbHVlID0gdGhpcy5uYW1lSW5wdXRUYXJnZXQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpO1xuICAgICAgICB0aGlzLmZvcm1UYXJnZXQucmVxdWVzdFN1Ym1pdCgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydidXR0b24nLCAnbWVudSddO1xuXG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgbmFtZTogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICd0bWVudV9fcHJvZmlsZScgfVxuICAgIH1cblxuICAgIGJ1dHRvblRhcmdldENvbm5lY3RlZChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRoaXMubmFtZVZhbHVlKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIH1cblxuICAgIG1lbnVUYXJnZXRDb25uZWN0ZWQobWVudSkge1xuICAgICAgICBtZW51LnNldEF0dHJpYnV0ZSgnaWQnLCB0aGlzLm5hbWVWYWx1ZSk7XG4gICAgfVxuXG4gICAgdG9nZ2xlKGV2ZW50KSB7XG4gICAgICAgIHRoaXMubWVudVRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcblxuICAgICAgICBpZiAodGhpcy5tZW51VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uVGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvblRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLm1lbnVUYXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuYnV0dG9uVGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIH1cblxuICAgIGRvY3VtZW50Q2xpY2soZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuYnV0dG9uVGFyZ2V0LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydzY3JvbGxUbycsICdhdXRvRm9jdXMnLCAnd2lkZ2V0RXJyb3InXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIHNlc3Npb25LZXk6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICAgIGRlZmF1bHQ6ICdjb250YW9fYmFja2VuZF9vZmZzZXQnXG4gICAgICAgIH0sXG4gICAgICAgIGJlaGF2aW9yOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0OiAnaW5zdGFudCdcbiAgICAgICAgfSxcbiAgICAgICAgYmxvY2s6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICAgIGRlZmF1bHQ6ICdjZW50ZXInXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHk6IGF1dG9tYXRpY2FsbHkgcmVnaXN0ZXIgdGhlIFN0aW11bHVzIGNvbnRyb2xsZXIgaWYgdGhlIGxlZ2FjeSBtZXRob2RzIGFyZSB1c2VkXG4gICAgc3RhdGljIGFmdGVyTG9hZChpZGVudGlmaWVyLCBhcHBsaWNhdGlvbikge1xuICAgICAgICBjb25zdCBsb2FkRmFsbGJhY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBhcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBpZGVudGlmaWVyKTtcblxuICAgICAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCB7IGNvbnRyb2xsZXJBdHRyaWJ1dGUgfSA9IGFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKGNvbnRyb2xsZXJBdHRyaWJ1dGUsIGAke2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoY29udHJvbGxlckF0dHJpYnV0ZSkgfHwgJyd9ICR7IGlkZW50aWZpZXIgfWApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBhcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlciAmJiByZXNvbHZlKGNvbnRyb2xsZXIpIHx8IHJlamVjdChjb250cm9sbGVyKTtcbiAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2luZG93LkJhY2tlbmQgJiYgIXdpbmRvdy5CYWNrZW5kLmluaXRTY3JvbGxPZmZzZXQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5CYWNrZW5kLmluaXRTY3JvbGxPZmZzZXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQmFja2VuZC5pbml0U2Nyb2xsT2Zmc2V0KCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgU3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxvYWRGYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpbmRvdy5CYWNrZW5kICYmICF3aW5kb3cuQmFja2VuZC5nZXRTY3JvbGxPZmZzZXQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5CYWNrZW5kLmdldFNjcm9sbE9mZnNldCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdCYWNrZW5kLmdldFNjcm9sbE9mZnNldCgpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgdGhlIFN0aW11bHVzIGNvbnRyb2xsZXIgaW5zdGVhZC4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBsb2FkRmFsbGJhY2soKS50aGVuKChjb250cm9sbGVyKSA9PiBjb250cm9sbGVyLmRpc2NhcmQoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbml0aWFsaXplICgpIHtcbiAgICAgICAgdGhpcy5zdG9yZSA9IHRoaXMuc3RvcmUuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5yZXN0b3JlKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVzdG9yZSAoKSB7XG4gICAgICAgIGlmICghdGhpcy5vZmZzZXQpIHJldHVybjtcblxuICAgICAgICAvLyBFeGVjdXRlIHNjcm9sbCByZXN0b3JlIGFmdGVyIFR1cmJvIHNjcm9sbGVkIHRvIHRvcFxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXF1ZXN0QW5pbWF0aW9uRnJhbWUpO1xuXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7XG4gICAgICAgICAgICB0b3A6IHRoaXMub2Zmc2V0LFxuICAgICAgICAgICAgYmVoYXZpb3I6IHRoaXMuYmVoYXZpb3JWYWx1ZSxcbiAgICAgICAgICAgIGJsb2NrOiB0aGlzLmJsb2NrVmFsdWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5vZmZzZXQgPSBudWxsO1xuICAgIH1cblxuICAgIHNjcm9sbFRvVGFyZ2V0Q29ubmVjdGVkKCkge1xuICAgICAgICB0aGlzLnNjcm9sbFRvVGFyZ2V0LnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJlaGF2aW9yOiB0aGlzLmJlaGF2aW9yVmFsdWUsXG4gICAgICAgICAgICBibG9jazogdGhpcy5ibG9ja1ZhbHVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGF1dG9Gb2N1c1RhcmdldENvbm5lY3RlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMub2Zmc2V0IHx8IHRoaXMuYXV0b0ZvY3VzKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmF1dG9Gb2N1c1RhcmdldDtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBpbnB1dC5kaXNhYmxlZCB8fCBpbnB1dC5yZWFkb25seVxuICAgICAgICAgICAgfHwgIWlucHV0Lm9mZnNldFdpZHRoIHx8ICFpbnB1dC5vZmZzZXRIZWlnaHRcbiAgICAgICAgICAgIHx8IGlucHV0LmNsb3Nlc3QoJy5jaHpuLXNlYXJjaCcpXG4gICAgICAgICAgICB8fCBpbnB1dC5hdXRvY29tcGxldGUgJiYgaW5wdXQuYXV0b2NvbXBsZXRlICE9PSAnb2ZmJ1xuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXV0b0ZvY3VzID0gdHJ1ZTtcbiAgICAgICAgaW5wdXQuZm9jdXMoKTtcbiAgICB9XG5cbiAgICB3aWRnZXRFcnJvclRhcmdldENvbm5lY3RlZCgpIHtcbiAgICAgICAgdGhpcy53aWRnZXRFcnJvclRhcmdldC5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICBiZWhhdmlvcjogJ3Ntb290aCcsXG4gICAgICAgICAgICBibG9jazogJ3N0YXJ0J1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzdG9yZSAoKSB7XG4gICAgICAgIHRoaXMub2Zmc2V0ID0gdGhpcy5lbGVtZW50LnNjcm9sbFRvcDtcbiAgICB9XG5cbiAgICBkaXNjYXJkICgpIHtcbiAgICAgICAgdGhpcy5vZmZzZXQgPSBudWxsO1xuICAgIH1cblxuICAgIHNjcm9sbFRvV2lkZ2V0RXJyb3IoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1dpZGdldEVycm9yVGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLndpZGdldEVycm9yVGFyZ2V0Q29ubmVjdGVkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgb2Zmc2V0ICgpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0aGlzLnNlc3Npb25LZXlWYWx1ZSk7XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlID8gcGFyc2VJbnQodmFsdWUpIDogbnVsbDtcbiAgICB9XG5cbiAgICBzZXQgb2Zmc2V0ICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5zZXNzaW9uS2V5VmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0odGhpcy5zZXNzaW9uS2V5VmFsdWUsIFN0cmluZyh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRhYnNDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgY2xvc2VMYWJlbDogU3RyaW5nLFxuICAgIH1cblxuICAgIHN0YXRpYyB0YXJnZXRzID0gWyduYXZpZ2F0aW9uJywgJ3BhbmVsJ107XG5cbiAgICBhY3RpdmVUYWIgPSBudWxsO1xuXG4gICAgcGFuZWxUYXJnZXRDb25uZWN0ZWQocGFuZWwpIHtcbiAgICAgICAgLy8gV2hlbiB0aGUgRE9NIGlzIGFscmVhZHkgc2V0IHVwLCBqdXN0IHNldCB0aGUgcGFuZWwgSUQgYW5kXG4gICAgICAgIC8vIGluc3RhbGwgdGhlIGV2ZW50IGxpc3RlbmVycywgb3RoZXJ3aXNlIGNyZWF0ZSB0aGUgZWxlbWVudHMgZmlyc3QuXG4gICAgICAgIGNvbnN0IGlzUmVzdG9yZSA9ICd0YWJwYW5lbCcgPT09IHBhbmVsLmdldEF0dHJpYnV0ZSgncm9sZScpO1xuXG4gICAgICAgIGNvbnN0IHRhYklkID0gaXNSZXN0b3JlID8gcGFuZWwuZGF0YXNldC50YWJJZCA6IChNYXRoLnJhbmRvbSgpICsgMSkudG9TdHJpbmcoMzYpLnN1YnN0cmluZyg3KTtcbiAgICAgICAgY29uc3QgY29udGFpbmVySWQgPSB0aGlzLmVsZW1lbnQuaWQ7XG4gICAgICAgIGNvbnN0IHBhbmVsUmVmZXJlbmNlID0gcGFuZWwuaWQgfHwgYHRhYi1wYW5lbF8ke2NvbnRhaW5lcklkfV8ke3RhYklkfWA7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xSZWZlcmVuY2UgPSBgdGFiLWNvbnRyb2xfJHtjb250YWluZXJJZH1fJHt0YWJJZH1gO1xuXG4gICAgICAgIC8vIENyZWF0ZSBuYXZpZ2F0aW9uIGVsZW1lbnRzXG4gICAgICAgIGNvbnN0IHNlbGVjdEJ1dHRvbiA9IGlzUmVzdG9yZVxuICAgICAgICAgICAgPyB0aGlzLm5hdmlnYXRpb25UYXJnZXQucXVlcnlTZWxlY3RvcihgYnV0dG9uLnNlbGVjdFthcmlhLWNvbnRyb2xzPVwiJHtwYW5lbFJlZmVyZW5jZX1cIl1gKVxuICAgICAgICAgICAgOiAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5pZCA9IGNvbnRyb2xSZWZlcmVuY2U7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTmFtZSA9ICdzZWxlY3QnO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5pbm5lclRleHQgPSBwYW5lbC5kYXRhc2V0LmxhYmVsO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWInKTtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgcGFuZWxSZWZlcmVuY2UpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICAgICAgICAgIH0pKClcbiAgICAgICAgO1xuXG4gICAgICAgIHNlbGVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0VGFiKHBhbmVsKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGlzUmVzdG9yZVxuICAgICAgICAgICAgPyB0aGlzLm5hdmlnYXRpb25UYXJnZXQucXVlcnlTZWxlY3RvcihgYnV0dG9uLmNsb3NlW2FyaWEtY29udHJvbHM9XCIke3BhbmVsUmVmZXJlbmNlfVwiXWApXG4gICAgICAgICAgICA6ICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTmFtZSA9ICdjbG9zZSc7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmlubmVyVGV4dCA9ICfDlyc7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgcGFuZWxSZWZlcmVuY2UpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCB0aGlzLmNsb3NlTGFiZWxWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgICAgICAgICAgfSkoKVxuICAgICAgICA7XG5cbiAgICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHBhbmVsIGFuZCBsZXQgdGhlIGRpc2Nvbm5lY3QgaGFuZGxlciBkbyB0aGUgcmVzdFxuICAgICAgICAgICAgcGFuZWwucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghaXNSZXN0b3JlKSB7XG4gICAgICAgICAgICAvLyBFbmhhbmNlIHBhbmVsIGNvbnRhaW5lclxuICAgICAgICAgICAgcGFuZWwuZGF0YXNldC50YWJJZCA9IHRhYklkO1xuICAgICAgICAgICAgcGFuZWwuaWQgPSBwYW5lbFJlZmVyZW5jZTtcbiAgICAgICAgICAgIHBhbmVsLnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWJwYW5lbCcpO1xuICAgICAgICAgICAgcGFuZWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCBjb250cm9sUmVmZXJlbmNlKTtcblxuICAgICAgICAgICAgLy8gQWRkIG5hdmlnYXRpb24gZWxlbWVudFxuICAgICAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3ByZXNlbnRhdGlvbicpO1xuICAgICAgICAgICAgbGkuYXBwZW5kKHNlbGVjdEJ1dHRvbik7XG4gICAgICAgICAgICBsaS5hcHBlbmQoY2xvc2VCdXR0b24pO1xuXG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25UYXJnZXQuYXBwZW5kKGxpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFjdGl2YXRlIHRhYlxuICAgICAgICB0aGlzLnNlbGVjdFRhYihwYW5lbCk7XG4gICAgfVxuXG4gICAgcGFuZWxUYXJnZXREaXNjb25uZWN0ZWQocGFuZWwpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGNvbnRyb2xzXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBhbmVsLmdldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5JykpPy5wYXJlbnRFbGVtZW50Py5yZW1vdmUoKTtcblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGZpcnN0IHRhYi9ubyB0YWIgaWYgdGhlIGN1cnJlbnQgdGFiIHdhcyBhY3RpdmUgYmVmb3JlIGNsb3NpbmcuXG4gICAgICAgIGlmIChwYW5lbCA9PT0gdGhpcy5hY3RpdmVUYWIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc1BhbmVsVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RUYWIodGhpcy5wYW5lbFRhcmdldCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFiID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNlbGVjdFRhYihwYW5lbCkge1xuICAgICAgICB0aGlzLnBhbmVsVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNUYXJnZXQgPSBlbCA9PT0gcGFuZWw7XG5cbiAgICAgICAgICAgIGVsLnRvZ2dsZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsIGlzVGFyZ2V0KTtcbiAgICAgICAgICAgIGVsLnRvZ2dsZUF0dHJpYnV0ZSgnZGF0YS1hY3RpdmUnLCBpc1RhcmdldCk7XG4gICAgICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gaXNUYXJnZXQgPyAncmV2ZXJ0JyA6ICdub25lJztcblxuICAgICAgICAgICAgLy8gUmUtZW5hYmxlL2Rpc2FibGUgdGhlIGJ1dHRvbiBhY2Nlc3Mga2V5c1xuICAgICAgICAgICAgaWYgKGlzVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2RhdGEtZGlzYWJsZWQtYWNjZXNza2V5XScpLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYWNjZXNza2V5JywgYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS1kaXNhYmxlZC1hY2Nlc3NrZXknKSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZGlzYWJsZWQtYWNjZXNza2V5Jyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2FjY2Vzc2tleV0nKS5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGlzYWJsZWQtYWNjZXNza2V5JywgYnV0dG9uLmdldEF0dHJpYnV0ZSgnYWNjZXNza2V5JykpO1xuICAgICAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlQXR0cmlidXRlKCdhY2Nlc3NrZXknKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScpKTtcbiAgICAgICAgICAgIHNlbGVjdEJ1dHRvbj8udG9nZ2xlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgaXNUYXJnZXQpO1xuICAgICAgICAgICAgc2VsZWN0QnV0dG9uPy5wYXJlbnRFbGVtZW50LnRvZ2dsZUF0dHJpYnV0ZSgnZGF0YS1hY3RpdmUnLCBpc1RhcmdldCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWN0aXZlVGFiID0gcGFuZWw7XG4gICAgfVxuXG4gICAgZ2V0QWN0aXZlVGFiKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVUYWI7XG4gICAgfVxuXG4gICAgZ2V0VGFicygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFuZWxUYXJnZXRzLnJlZHVjZSgocmVzdWx0LCBwYW5lbCkgPT4ge1xuICAgICAgICAgICAgcmVzdWx0W3BhbmVsLmlkXSA9IHBhbmVsO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSwge30pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuaW1wb3J0IHsgVHdpZ0VkaXRvciB9IGZyb20gJy4uL21vZHVsZXMvdHdpZy1lZGl0b3InO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIGVkaXRvcnMgPSBuZXcgTWFwKCk7XG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBmb2xsb3dVcmw6IFN0cmluZyxcbiAgICAgICAgYmxvY2tJbmZvVXJsOiBTdHJpbmcsXG4gICAgfTtcblxuICAgIHN0YXRpYyB0YXJnZXRzID0gWyd0aGVtZVNlbGVjdG9yJywgJ3RhYnMnLCAnZWRpdG9yJywgJ2VkaXRvckFubm90YXRpb25zJywgJ2RpYWxvZyddO1xuXG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgLy8gU3Vic2NyaWJlIHRvIGV2ZW50cyBkaXNwYXRjaGVkIGJ5IHRoZSBlZGl0b3JzXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0d2lnLWVkaXRvcjpsZW5zOmZvbGxvdycsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3Zpc2l0KHRoaXMuZm9sbG93VXJsVmFsdWUsIHtuYW1lOiBldmVudC5kZXRhaWwubmFtZX0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHdpZy1lZGl0b3I6bGVuczpibG9jay1pbmZvJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgdGhpcy5fdmlzaXQodGhpcy5ibG9ja0luZm9VcmxWYWx1ZSwgZXZlbnQuZGV0YWlsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOnN1Ym1pdC1zdGFydCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgIC8vIEFkZCB0aGUgY3VycmVudGx5IG9wZW4gZWRpdG9yIHRhYnMgdG8gdGhlIHJlcXVlc3Qgd2hlbiBzZWxlY3RpbmcgYSB0aGVtZVxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcy50aGVtZVNlbGVjdG9yVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkT3BlbkVkaXRvclRhYnNUb1JlcXVlc3QoZXZlbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbmNsdWRlIHRoZSBhY3RpdmUgZWRpdG9yJ3MgY29udGVudCB3aGVuIHRoZSBzYXZlIG9wZXJhdGlvbiB3YXMgdHJpZ2dlcmVkXG4gICAgICAgICAgICBpZiAoZXZlbnQuZGV0YWlsLmZvcm1TdWJtaXNzaW9uLnN1Ym1pdHRlcj8uZGF0YXNldD8ub3BlcmF0aW9uID09PSAnc2F2ZScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRFZGl0b3JDb250ZW50VG9SZXF1ZXN0KGV2ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9nZXRBY3RpdmVNdXRhYmxlRWRpdG9yKCk/LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGJlZm9yZUNhY2hlKCkge1xuICAgICAgICAvLyBEZXN0cm95IGVkaXRvciBpbnN0YW5jZXMgYmVmb3JlIFR1cmJvIGNhY2hlcyB0aGUgcGFnZS4gVGhleSB3aWxsIGJlXG4gICAgICAgIC8vIHJlY3JlYXRlZCB3aGVuIHRoZSBlZGl0b3JUYXJnZXRDb25uZWN0ZWQoKSBjYWxscyBoYXBwZW5zIG9uIHRoZVxuICAgICAgICAvLyByZXN0b3JlZCBwYWdlLlxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGVkaXRvcl0gb2YgdGhpcy5lZGl0b3JzKSB7XG4gICAgICAgICAgICBlZGl0b3IuZGVzdHJveSgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuZWRpdG9yc1trZXldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2UoZXZlbnQpIHtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpKS5pbm5lclRleHQgPSAnJztcbiAgICB9XG5cbiAgICBlZGl0b3JUYXJnZXRDb25uZWN0ZWQoZWwpIHtcbiAgICAgICAgdGhpcy5lZGl0b3JzLnNldChlbCwgbmV3IFR3aWdFZGl0b3IoZWwucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKSkpO1xuICAgIH1cblxuICAgIGVkaXRvclRhcmdldERpc2Nvbm5lY3RlZChlbCkge1xuICAgICAgICB0aGlzLmVkaXRvcnMuZ2V0KGVsKS5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuZWRpdG9ycy5kZWxldGUoZWwpO1xuICAgIH1cblxuICAgIGVkaXRvckFubm90YXRpb25zVGFyZ2V0Q29ubmVjdGVkKGVsKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yc1xuICAgICAgICAgICAgLmdldChlbC5jbG9zZXN0KCcqW2RhdGEtY29udGFvLS10ZW1wbGF0ZS1zdHVkaW8tdGFyZ2V0PVwiZWRpdG9yXCJdJykpXG4gICAgICAgICAgICA/LnNldEFubm90YXRpb25zRGF0YShKU09OLnBhcnNlKGVsLmlubmVyVGV4dCkpXG4gICAgICAgIDtcbiAgICB9XG5cbiAgICBkaWFsb2dUYXJnZXRDb25uZWN0ZWQoZWwpIHtcbiAgICAgICAgZWwuc2hvd01vZGFsKCk7XG4gICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk/LmZvY3VzKCk7XG4gICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJyk/LnNlbGVjdCgpO1xuXG4gICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKT8uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKCkgPT4ge1xuICAgICAgICAgICAgZWwucmVtb3ZlKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgY29sb3JDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5lZGl0b3JzLmZvckVhY2goZWRpdG9yID0+IHtcbiAgICAgICAgICAgIGVkaXRvci5zZXRDb2xvclNjaGVtZShldmVudC5kZXRhaWwubW9kZSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgX2FkZE9wZW5FZGl0b3JUYWJzVG9SZXF1ZXN0KGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IGV2ZW50LmRldGFpbC5mb3JtU3VibWlzc2lvbi5sb2NhdGlvbi5zZWFyY2hQYXJhbXM7XG5cbiAgICAgICAgY29uc3QgdGFicyA9IHRoaXMuYXBwbGljYXRpb25cbiAgICAgICAgICAgIC5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIodGhpcy50YWJzVGFyZ2V0LCAnY29udGFvLS10YWJzJylcbiAgICAgICAgICAgIC5nZXRUYWJzKClcbiAgICAgICAgO1xuXG4gICAgICAgIE9iamVjdC5rZXlzKHRhYnMpLmZvckVhY2godGFiSWQgPT4ge1xuICAgICAgICAgICAgLy8gRXh0cmFjdCBpZGVudGlmaWVyIGZyb20gdGFiSWQgXCJ0ZW1wbGF0ZS1zdHVkaW8tLXRhYl88aWRlbnRpZmllcj5cIlxuICAgICAgICAgICAgc2VhcmNoUGFyYW1zLmFwcGVuZCgnb3Blbl90YWJbXScsIHRhYklkLnN1YnN0cmluZygyMSkpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIF9hZGRFZGl0b3JDb250ZW50VG9SZXF1ZXN0KGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LmRldGFpbC5mb3JtU3VibWlzc2lvbi5mZXRjaFJlcXVlc3QuYm9keS5hcHBlbmQoXG4gICAgICAgICAgICAnY29kZScsXG4gICAgICAgICAgICB0aGlzLl9nZXRBY3RpdmVNdXRhYmxlRWRpdG9yKCk/LmdldENvbnRlbnQoKSA/PyAnJ1xuICAgICAgICApO1xuICAgIH1cblxuICAgIF9nZXRBY3RpdmVNdXRhYmxlRWRpdG9yKCkge1xuICAgICAgICBjb25zdCBlZGl0b3JFbGVtZW50c09uQWN0aXZlVGFiID0gdGhpcy5hcHBsaWNhdGlvblxuICAgICAgICAgICAgLmdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcih0aGlzLnRhYnNUYXJnZXQsICdjb250YW8tLXRhYnMnKVxuICAgICAgICAgICAgLmdldEFjdGl2ZVRhYigpXG4gICAgICAgICAgICA/LnF1ZXJ5U2VsZWN0b3JBbGwoJypbZGF0YS1jb250YW8tLXRlbXBsYXRlLXN0dWRpby10YXJnZXQ9XCJlZGl0b3JcIl0nKVxuICAgICAgICA7XG5cbiAgICAgICAgZm9yIChjb25zdCBlbCBvZiBlZGl0b3JFbGVtZW50c09uQWN0aXZlVGFiID8/IFtdKSB7XG4gICAgICAgICAgICBjb25zdCBlZGl0b3IgPSB0aGlzLmVkaXRvcnMuZ2V0KGVsKTtcblxuICAgICAgICAgICAgaWYgKGVkaXRvciAmJiBlZGl0b3IuaXNFZGl0YWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGFzeW5jIF92aXNpdCh1cmwsIHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zICE9PSBudWxsKSB7XG4gICAgICAgICAgICB1cmwgKz0gJz8nICsgbmV3IFVSTFNlYXJjaFBhcmFtcyhwYXJhbXMpLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQWNjZXB0JzogJ3RleHQvdm5kLnR1cmJvLXN0cmVhbS5odG1sJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHJlc3BvbnNlLnJlZGlyZWN0ZWQpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uID0gcmVzcG9uc2UudXJsO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKS5zdGFydHNXaXRoKCd0ZXh0L3ZuZC50dXJiby1zdHJlYW0uaHRtbCcpIHx8IHJlc3BvbnNlLnN0YXR1cyA+PSAzMDApIHtcbiAgICAgICAgICAgIGlmICh3aW5kb3cuY29uc29sZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFRoZXJlIHdhcyBhbiBlcnJvciBwcm9jZXNzaW5nIHRoZSBUdXJibyBzdHJlYW0gcmVzcG9uc2UgZnJvbSBcIiR7dXJsfVwiYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKVxuICAgICAgIFR1cmJvLnJlbmRlclN0cmVhbU1lc3NhZ2UoaHRtbCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQudGlueW1jZUNvbmZpZykge1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gVGlueU1DRSBjb25maWcgd2FzIGF0dGFjaGVkIHRvIHRoZSBET00gZWxlbWVudCwgZXhwZWN0ZWQgYW4gZXhwYW5kbyBwcm9wZXJ0eSBjYWxsZWQgXCJ0aW55bWNlQ29uZmlnXCIuJywgdGhpcy5lbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuZWxlbWVudC50aW55bWNlQ29uZmlnO1xuICAgICAgICBjb25maWcudGFyZ2V0ID0gdGhpcy5lbGVtZW50O1xuXG4gICAgICAgIHRpbnltY2U/LmluaXQoY29uZmlnKS50aGVuKChlZGl0b3JzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVkaXRvcklkID0gZWRpdG9yc1swXT8uaWQ7XG5cbiAgICAgICAgICAgIC8vIEZpcmUgYSBjdXN0b20gZXZlbnQgd2hlbiB0aGUgZWRpdG9yIGZpbmlzaGVkIGluaXRpYWxpemluZy5cbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goJ2VkaXRvci1sb2FkZWQnLCB7IGRldGFpbDogeyBjb250ZW50OiBlZGl0b3JzWzBdID8/IG51bGwgfSB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgdGlueW1jZT8uZ2V0KHRoaXMuZWRpdG9ySWQpPy5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBiZWZvcmVDYWNoZSgpIHtcbiAgICAgICAgLy8gRGVzdHJveSBUaW55TUNFIGJlZm9yZSBUdXJibyBjYWNoZXMgdGhlIHBhZ2UuIEl0IHdpbGwgYmUgcmVjcmVhdGVkXG4gICAgICAgIC8vIHdoZW4gdGhlIGNvbm5lY3QoKSBjYWxsIGhhcHBlbnMgb24gdGhlIHJlc3RvcmVkIHBhZ2UuXG4gICAgICAgIHRoaXMuZGlzY29ubmVjdCgpO1xuXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgY29udHJvbGxlciBhdHRyaWJ1dGUuIFRoZXkgd2lsbCBiZSByZS1hZGRlZCBpbiB0aGUgaW5pdFxuICAgICAgICAvLyBzY3JpcHQgb2YgdGhlIGJlX3RpbnlNQ0UuaHRtbDUgdGVtcGxhdGUuXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtY29udHJvbGxlcicpO1xuICAgIH1cblxuICAgIGxlYXZlKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IHRpbnltY2U/LmdldCh0aGlzLmVkaXRvcklkKVxuXG4gICAgICAgIGlmICghZWRpdG9yIHx8ICFlZGl0b3IucGx1Z2lucy5oYXNPd25Qcm9wZXJ0eSgnYXV0b3NhdmUnKSB8fCBlZGl0b3IuaXNOb3REaXJ0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJpZ2dlciBhIGJlZm9yZXVubG9hZCBldmVudCBsaWtlIHdoZW4gbmF2aWdhdGluZyBhd2F5IHRvIGNhcHR1cmUgdGhlIFRpbnlNQ0UgYXV0b3NhdmUgbWVzc2FnZVxuICAgICAgICBjb25zdCBkZWxlZ2F0ZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdCZWZvcmVVbmxvYWRFdmVudCcpO1xuICAgICAgICBkZWxlZ2F0ZS5pbml0RXZlbnQoJ2JlZm9yZXVubG9hZCcsIGZhbHNlLCB0cnVlKTtcblxuICAgICAgICBpZiAoIXdpbmRvdy5kaXNwYXRjaEV2ZW50KGRlbGVnYXRlKSAmJiAhY29uZmlybShkZWxlZ2F0ZS5yZXR1cm5WYWx1ZSkpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBpZDogU3RyaW5nLFxuICAgICAgICB0YWJsZTogU3RyaW5nLFxuICAgIH1cblxuICAgIHN0YXRpYyBjbGFzc2VzID0gWydjb2xsYXBzZWQnXTtcblxuICAgIHN0YXRpYyBhZnRlckxvYWQgKGlkZW50aWZpZXIsIGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IGFkZENvbnRyb2xsZXIgPSAoZWwsIGlkLCB0YWJsZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZnMgPSBlbC5wYXJlbnROb2RlO1xuXG4gICAgICAgICAgICBmcy5kYXRhc2V0LmNvbnRyb2xsZXIgPSBgJHtmcy5kYXRhc2V0LmNvbnRyb2xsZXIgfHwgJyd9ICR7aWRlbnRpZmllcn1gO1xuICAgICAgICAgICAgZnMuc2V0QXR0cmlidXRlKGBkYXRhLSR7aWRlbnRpZmllcn0taWQtdmFsdWVgLCBpZCk7XG4gICAgICAgICAgICBmcy5zZXRBdHRyaWJ1dGUoYGRhdGEtJHtpZGVudGlmaWVyfS10YWJsZS12YWx1ZWAsIHRhYmxlKTtcbiAgICAgICAgICAgIGZzLnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LWNvbGxhcHNlZC1jbGFzc2AsICdjb2xsYXBzZWQnKTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1hY3Rpb24nLCBgY2xpY2stPiR7aWRlbnRpZmllcn0jdG9nZ2xlIGtleWRvd24uZW50ZXItPiR7aWRlbnRpZmllcn0jdG9nZ2xlIGtleWRvd24uc3BhY2UtPiR7aWRlbnRpZmllcn0jcHJldmVudDpwcmV2ZW50IGtleXVwLnNwYWNlLT4ke2lkZW50aWZpZXJ9I3RvZ2dsZTpwcmV2ZW50YCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtaWdyYXRlTGVnYWN5ID0gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGVnZW5kW2RhdGEtdG9nZ2xlLWZpZWxkc2V0XScpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVc2luZyB0aGUgXCJkYXRhLXRvZ2dsZS1maWVsZHNldFwiIGF0dHJpYnV0ZSBvbiBmaWVsZHNldCBsZWdlbmRzIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBDb250YW8gNi4gQXBwbHkgdGhlIFwiJHtpZGVudGlmaWVyfVwiIFN0aW11bHVzIGNvbnRyb2xsZXIgaW5zdGVhZC5gKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCB7IGlkLCB0YWJsZSB9ID0gSlNPTi5wYXJzZShlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlLWZpZWxkc2V0JykpO1xuICAgICAgICAgICAgICAgIGFkZENvbnRyb2xsZXIoZWwsIGlkLCB0YWJsZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgQWpheFJlcXVlc3QudG9nZ2xlRmllbGRzZXQgPSAoZWwsIGlkLCB0YWJsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZzID0gZWwucGFyZW50Tm9kZTtcblxuICAgICAgICAgICAgICAgIC8vIEFscmVhZHkgY2xpY2tlZCwgU3RpbXVsdXMgY29udHJvbGxlciB3YXMgYWRkZWQgZHluYW1pY2FsbHlcbiAgICAgICAgICAgICAgICBpZiAoYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGZzLCBpZGVudGlmaWVyKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignVXNpbmcgQWpheFJlcXVlc3QudG9nZ2xlRmllbGRzZXQoKSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gQ29udGFvIDYuIEFwcGx5IHRoZSBTdGltdWx1cyBhY3Rpb25zIGluc3RlYWQuJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYWRkQ29udHJvbGxlcihlbCwgaWQsIHRhYmxlKTtcblxuICAgICAgICAgICAgICAgIC8vIE9wdGltaXN0aWNhbGx5IHdhaXQgdW50aWwgU3RpbXVsdXMgaGFzIHJlZ2lzdGVyZWQgdGhlIG5ldyBjb250cm9sbGVyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGFwcGxpY2F0aW9uLmdldENvbnRyb2xsZXJGb3JFbGVtZW50QW5kSWRlbnRpZmllcihmcywgaWRlbnRpZmllcikudG9nZ2xlKCk7IH0sIDEwMCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsbGVkIGFzIHNvb24gYXMgcmVnaXN0ZXJlZCwgc28gRE9NIG1heSBub3QgaGF2ZSBiZWVuIGxvYWRlZCB5ZXRcbiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09IFwibG9hZGluZ1wiKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBtaWdyYXRlTGVnYWN5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1pZ3JhdGVMZWdhY3koKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xhYmVsLmVycm9yLCBsYWJlbC5tYW5kYXRvcnknKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGUnKSkge1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVc2luZyBjbGFzcyBcImhpZGVcIiBvbiBhIGZpZWxkc2V0IGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBDb250YW8gNi4gVXNlIGNsYXNzIFwiJHt0aGlzLmNvbGxhcHNlZENsYXNzfVwiIGluc3RlYWQuYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5jb2xsYXBzZWRDbGFzcykpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QXJpYUV4cGFuZGVkKGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QXJpYUV4cGFuZGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdG9nZ2xlICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5jb2xsYXBzZWRDbGFzcykpIHtcbiAgICAgICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgICAgICAgdGhpcy5zZXRBcmlhRXhwYW5kZWQodHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnNldEFyaWFFeHBhbmRlZChmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvcGVuICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuY29sbGFwc2VkQ2xhc3MpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmNvbGxhcHNlZENsYXNzKTtcbiAgICAgICAgdGhpcy5zdG9yZVN0YXRlKDEpO1xuICAgIH1cblxuICAgIGNsb3NlICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5jb2xsYXBzZWRDbGFzcykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZvcm0gPSB0aGlzLmVsZW1lbnQuY2xvc2VzdCgnZm9ybScpO1xuICAgICAgICBjb25zdCBpbnB1dCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbcmVxdWlyZWRdJyk7XG5cbiAgICAgICAgbGV0IGNvbGxhcHNlID0gdHJ1ZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFpbnB1dFtpXS52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNvbGxhcHNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWNvbGxhcHNlKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mKGZvcm0uY2hlY2tWYWxpZGl0eSkgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGZvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS5jbGljaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jb2xsYXBzZWRDbGFzcyk7XG4gICAgICAgICAgICB0aGlzLnN0b3JlU3RhdGUoMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdG9yZVN0YXRlIChzdGF0ZSkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzSWRWYWx1ZSB8fCAhdGhpcy5oYXNUYWJsZVZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmZXRjaCh3aW5kb3cubG9jYXRpb24uaHJlZiwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ1gtUmVxdWVzdGVkLVdpdGgnOiAnWE1MSHR0cFJlcXVlc3QnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAndG9nZ2xlRmllbGRzZXQnLFxuICAgICAgICAgICAgICAgIGlkOiB0aGlzLmlkVmFsdWUsXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGVWYWx1ZSxcbiAgICAgICAgICAgICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXRBcmlhRXhwYW5kZWQoc3RhdGUpIHtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xuXG4gICAgICAgIGlmIChidXR0b24pIHtcbiAgICAgICAgICAgIGJ1dHRvbi5hcmlhRXhwYW5kZWQgPSBzdGF0ZTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyBjbGFzc2VzID0gWydjb2xsYXBzZWQnXVxuXG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgdXJsOiBTdHJpbmcsXG4gICAgICAgIHJlcXVlc3RUb2tlbjogU3RyaW5nLFxuICAgICAgICBleHBhbmRUaXRsZTogU3RyaW5nLFxuICAgICAgICBjb2xsYXBzZVRpdGxlOiBTdHJpbmcsXG4gICAgfVxuXG4gICAgdG9nZ2xlICh7IGN1cnJlbnRUYXJnZXQsIHBhcmFtczogeyBjYXRlZ29yeSB9fSkge1xuICAgICAgICBjb25zdCBlbCA9IGN1cnJlbnRUYXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgY29uc3QgY29sbGFwc2VkID0gZWwuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLmNvbGxhcHNlZENsYXNzKTtcblxuICAgICAgICBjdXJyZW50VGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGNvbGxhcHNlZCA/ICdmYWxzZScgOiAndHJ1ZScpO1xuICAgICAgICBjdXJyZW50VGFyZ2V0LnNldEF0dHJpYnV0ZSgndGl0bGUnLCBjb2xsYXBzZWQgPyB0aGlzLmV4cGFuZFRpdGxlVmFsdWUgOiB0aGlzLmNvbGxhcHNlVGl0bGVWYWx1ZSk7XG5cbiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChjYXRlZ29yeSwgY29sbGFwc2VkKTtcbiAgICB9XG5cbiAgICBzZW5kUmVxdWVzdCAoY2F0ZWdvcnksIGNvbGxhcHNlZCkge1xuICAgICAgICBmZXRjaCh0aGlzLnVybFZhbHVlLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnWC1SZXF1ZXN0ZWQtV2l0aCc6ICdYTUxIdHRwUmVxdWVzdCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVOYXZpZ2F0aW9uJyxcbiAgICAgICAgICAgICAgICBpZDogY2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgc3RhdGU6IGNvbGxhcHNlZCA/IDAgOiAxLFxuICAgICAgICAgICAgICAgIFJFUVVFU1RfVE9LRU46IHRoaXMucmVxdWVzdFRva2VuVmFsdWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIG1vZGU6IHtcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgICAgICAgIGRlZmF1bHQ6IDVcbiAgICAgICAgfSxcbiAgICAgICAgdG9nZ2xlQWN0aW9uOiBTdHJpbmcsXG4gICAgICAgIGxvYWRBY3Rpb246IFN0cmluZyxcbiAgICAgICAgcmVxdWVzdFRva2VuOiBTdHJpbmcsXG4gICAgICAgIHJlZmVyZXJJZDogU3RyaW5nLFxuICAgICAgICBleHBhbmQ6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2U6IFN0cmluZyxcbiAgICAgICAgZXhwYW5kQWxsOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZEFsbFRpdGxlOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlQWxsOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlQWxsVGl0bGU6IFN0cmluZyxcbiAgICB9XG5cbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnb3BlcmF0aW9uJywgJ25vZGUnLCAndG9nZ2xlJywgJ2NoaWxkJywgJ3Jvb3RDaGlsZCddO1xuXG4gICAgb3BlcmF0aW9uVGFyZ2V0Q29ubmVjdGVkICgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICBjaGlsZFRhcmdldENvbm5lY3RlZCAoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKCk7XG4gICAgfVxuXG4gICAgdG9nZ2xlIChldmVudCkge1xuICAgICAgICBjb25zdCBlbCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgIHRoaXMudG9nZ2xlVG9nZ2xlcihlbCwgZXZlbnQucGFyYW1zLmlkLCBldmVudC5wYXJhbXMubGV2ZWwsIGV2ZW50LnBhcmFtcy5mb2xkZXIpO1xuICAgIH1cblxuICAgIHRvZ2dsZVRvZ2dsZXIgKGVsLCBpZCwgbGV2ZWwsIGZvbGRlcikge1xuICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuaWQoaWQpO1xuXG4gICAgICAgIGlmIChpdGVtICYmIGl0ZW0uc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuZXhwYW5kVG9nZ2xlcihlbCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKGVsLCBpZCwgMSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbSkge1xuICAgICAgICAgICAgdGhpcy5oaWRlQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB0aGlzLmNvbGxhcHNlVG9nZ2xlcihlbCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKGVsLCBpZCwgMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZldGNoQ2hpbGQoZWwsIGlkLCBsZXZlbCwgZm9sZGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKCk7XG4gICAgfVxuXG4gICAgZXhwYW5kVG9nZ2xlciAoZWwpIHtcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZm9sZGFibGUtLW9wZW4nKTtcblxuICAgICAgICBpZiAoZWwuaGFzQXR0cmlidXRlKCd0aXRsZScpKSB7XG4gICAgICAgICAgICBlbC50aXRsZSA9IHRoaXMuY29sbGFwc2VWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsLmdldEVsZW1lbnRzKCdpbWcnKT8uZm9yRWFjaCgoaW1hZ2UpID0+IHtcbiAgICAgICAgICAgIGltYWdlLmFsdCA9IHRoaXMuY29sbGFwc2VWYWx1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29sbGFwc2VUb2dnbGVyIChlbCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdmb2xkYWJsZS0tb3BlbicpO1xuXG4gICAgICAgIGlmIChlbC5oYXNBdHRyaWJ1dGUoJ3RpdGxlJykpIHtcbiAgICAgICAgICAgIGVsLnRpdGxlID0gdGhpcy5leHBhbmRWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsLmdldEVsZW1lbnRzKCdpbWcnKT8uZm9yRWFjaCgoaW1hZ2UpID0+IHtcbiAgICAgICAgICAgIGltYWdlLmFsdCA9IHRoaXMuZXhwYW5kVmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGxvYWRUb2dnbGVyIChlbCwgZW5hYmxlZCkge1xuICAgICAgICBlbC5jbGFzc0xpc3RbZW5hYmxlZCA/ICdhZGQnIDogJ3JlbW92ZSddKCdmb2xkYWJsZS0tbG9hZGluZycpO1xuICAgIH1cblxuICAgIHNob3dDaGlsZCAoaXRlbSkge1xuICAgICAgICBpdGVtLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICB9XG5cbiAgICBoaWRlQ2hpbGQgKGl0ZW0pIHtcbiAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cblxuICAgIGFzeW5jIGZldGNoQ2hpbGQgKGVsLCBpZCwgbGV2ZWwsIGZvbGRlcikge1xuICAgICAgICB0aGlzLmxvYWRUb2dnbGVyKGVsLCB0cnVlKTtcblxuICAgICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGxvY2F0aW9uLmhyZWYpO1xuICAgICAgICBjb25zdCBzZWFyY2ggPSB1cmwuc2VhcmNoUGFyYW1zO1xuICAgICAgICBzZWFyY2guc2V0KCdyZWYnLCB0aGlzLnJlZmVyZXJJZFZhbHVlKTtcbiAgICAgICAgdXJsLnNlYXJjaCA9IHNlYXJjaC50b1N0cmluZygpO1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICAgICAgJ1gtUmVxdWVzdGVkLVdpdGgnOiAnWE1MSHR0cFJlcXVlc3QnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgJ2FjdGlvbic6IHRoaXMubG9hZEFjdGlvblZhbHVlLFxuICAgICAgICAgICAgICAgICdpZCc6IGlkLFxuICAgICAgICAgICAgICAgICdsZXZlbCc6IGxldmVsLFxuICAgICAgICAgICAgICAgICdmb2xkZXInOiBmb2xkZXIsXG4gICAgICAgICAgICAgICAgJ3N0YXRlJzogMSxcbiAgICAgICAgICAgICAgICAnUkVRVUVTVF9UT0tFTic6IHRoaXMucmVxdWVzdFRva2VuVmFsdWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgY29uc3QgdHh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXG4gICAgICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgICBsaS5pZCA9IGlkO1xuICAgICAgICAgICAgbGkuY2xhc3NMaXN0LmFkZCgncGFyZW50Jyk7XG4gICAgICAgICAgICBsaS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7XG4gICAgICAgICAgICBsaS5zZXRBdHRyaWJ1dGUoYGRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LXRhcmdldGAsIGxldmVsID09PSAwID8gJ2NoaWxkIHJvb3RDaGlsZCcgOiAnY2hpbGQnKTtcblxuICAgICAgICAgICAgY29uc3QgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgICAgICAgICAgdWwuY2xhc3NMaXN0LmFkZCgnbGV2ZWxfJyArIGxldmVsKTtcbiAgICAgICAgICAgIHVsLmlubmVySFRNTCA9IHR4dDtcbiAgICAgICAgICAgIGxpLmFwcGVuZCh1bCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGVWYWx1ZSA9PT0gNSkge1xuICAgICAgICAgICAgICAgIGVsLmNsb3Nlc3QoJ2xpJykuYWZ0ZXIobGkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgaXNGb2xkZXIgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gZWwuY2xvc2VzdCgnbGknKSxcbiAgICAgICAgICAgICAgICAgICAgbmV4dDtcblxuICAgICAgICAgICAgICAgIHdoaWxlICh0eXBlT2YocGFyZW50KSA9PT0gJ2VsZW1lbnQnICYmIHBhcmVudC50YWdOYW1lID09PSAnTEknICYmIChuZXh0ID0gcGFyZW50Lm5leHRFbGVtZW50U2libGluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gbmV4dDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3RsX2ZvbGRlcicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0ZvbGRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc0ZvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYmVmb3JlKGxpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYWZ0ZXIobGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdzdHJ1Y3R1cmUnKSk7XG4gICAgICAgICAgICB0aGlzLmV4cGFuZFRvZ2dsZXIoZWwpO1xuXG4gICAgICAgICAgICAvLyBIT09LIChzZWUgIzY3NTIpXG4gICAgICAgICAgICB3aW5kb3cuZmlyZUV2ZW50KCdhamF4X2NoYW5nZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sb2FkVG9nZ2xlcihlbCwgZmFsc2UpO1xuICAgIH1cblxuICAgIGFzeW5jIHRvZ2dsZUFsbCAoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgaHJlZiA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuaHJlZjtcblxuICAgICAgICBpZiAodGhpcy5oYXNFeHBhbmRlZFJvb3QoKSBeIChldmVudCA/IGV2ZW50LmFsdEtleSA6IGZhbHNlKSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVBbGxTdGF0ZShocmVmLCAwKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4gdGhpcy5jb2xsYXBzZVRvZ2dsZXIoZWwpKTtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRUYXJnZXRzLmZvckVhY2goKGl0ZW0pID0+IGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4gZWwucmVtb3ZlKCkpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVUYXJnZXRzLmZvckVhY2goKGVsKSA9PiB0aGlzLmxvYWRUb2dnbGVyKGVsLCB0cnVlKSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlQWxsU3RhdGUoaHJlZiwgMSk7XG4gICAgICAgICAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRhcmdldHMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuZmV0Y2hDaGlsZChcbiAgICAgICAgICAgICAgICAgICAgZWwsXG4gICAgICAgICAgICAgICAgICAgIGVsLmdldEF0dHJpYnV0ZShgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0taWQtcGFyYW1gKSxcbiAgICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgICAgZWwuZ2V0QXR0cmlidXRlKGBkYXRhLSR7dGhpcy5pZGVudGlmaWVyfS1mb2xkZXItcGFyYW1gKVxuICAgICAgICAgICAgICAgICkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKCk7XG4gICAgfVxuXG4gICAga2V5cHJlc3MgKGV2ZW50KSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKGV2ZW50KTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVTdGF0ZSAoZWwsIGlkLCBzdGF0ZSkge1xuICAgICAgICBhd2FpdCBmZXRjaChsb2NhdGlvbi5ocmVmLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICAgICAgJ1gtUmVxdWVzdGVkLVdpdGgnOiAnWE1MSHR0cFJlcXVlc3QnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICAgICAgJ2FjdGlvbic6IHRoaXMudG9nZ2xlQWN0aW9uVmFsdWUsXG4gICAgICAgICAgICAgICAgJ2lkJzogaWQsXG4gICAgICAgICAgICAgICAgJ3N0YXRlJzogc3RhdGUsXG4gICAgICAgICAgICAgICAgJ1JFUVVFU1RfVE9LRU4nOiB0aGlzLnJlcXVlc3RUb2tlblZhbHVlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVBbGxTdGF0ZSAoaHJlZiwgc3RhdGUpIHtcbiAgICAgICAgYXdhaXQgZmV0Y2goYCR7aHJlZn0mc3RhdGU9JHtzdGF0ZX1gKTtcbiAgICB9XG5cbiAgICB1cGRhdGVPcGVyYXRpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNPcGVyYXRpb25UYXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmhhc0V4cGFuZGVkUm9vdCgpIF4gKGV2ZW50ID8gZXZlbnQuYWx0S2V5IDogZmFsc2UpKSB7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5pbm5lclRleHQgPSB0aGlzLmNvbGxhcHNlQWxsVmFsdWU7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC50aXRsZSA9IHRoaXMuY29sbGFwc2VBbGxUaXRsZVZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuaW5uZXJUZXh0ID0gdGhpcy5leHBhbmRBbGxWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnRpdGxlID0gdGhpcy5leHBhbmRBbGxUaXRsZVZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFzRXhwYW5kZWRSb290ICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5yb290Q2hpbGRUYXJnZXRzLmZpbmQoKGVsKSA9PiBlbC5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpXG4gICAgfVxufVxuIiwiaW1wb3J0IHtDb250cm9sbGVyfSBmcm9tIFwiQGhvdHdpcmVkL3N0aW11bHVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvb2x0aXBzQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyBkZWZhdWx0T3B0aW9uc01hcCA9IHtcbiAgICAgICAgJ2EgaW1nW2FsdF0nOiB7eDogLTksIHk6IDMwfSxcbiAgICAgICAgJy5zZ2FsbGVyeSBpbWdbYWx0XSc6IHt4OiAwLCB5OiA3NX0sXG4gICAgICAgICdwLnRsX3RpcCc6IHt4OiAwLCB5OiAyMywgdXNlQ29udGVudDogdHJ1ZX0sXG4gICAgICAgICcjaG9tZVt0aXRsZV0nOiB7eDogNiwgeTogNDJ9LFxuICAgICAgICAnI3RtZW51IGFbdGl0bGVdJzoge3g6IDAsIHk6IDQyfSxcbiAgICAgICAgJ2FbdGl0bGVdW2NsYXNzXj1cImdyb3VwLVwiXSc6IHt4OiAtNiwgeTogMjd9LFxuICAgICAgICAnYVt0aXRsZV0ubmF2aWdhdGlvbic6IHt4OiAyNSwgeTogMzJ9LFxuICAgICAgICAnaW1nW3RpdGxlXS5naW1hZ2UnOiB7eDogLTksIHk6IDYwfSxcbiAgICAgICAgJ2ltZ1t0aXRsZV06bm90KC5naW1hZ2UpJzoge3g6IC05LCB5OiAzMH0sXG4gICAgICAgICdhW3RpdGxlXS5waWNrZXItd2l6YXJkJzoge3g6IC00LCB5OiAzMH0sXG4gICAgICAgICdidXR0b24gaW1nW2FsdF0nOiB7eDogLTksIHk6IDMwfSxcbiAgICAgICAgJy50bF9wYW5lbCBidXR0b25bdGl0bGVdJzoge3g6IDAsIHk6IDM2fSxcbiAgICAgICAgJ2J1dHRvblt0aXRsZV0udW5zZWxlY3RhYmxlJzoge3g6IC00LCB5OiAyMH0sXG4gICAgICAgICdidXR0b25bdGl0bGVdOm5vdCgudW5zZWxlY3RhYmxlKSc6IHt4OiAtOSwgeTogMzB9LFxuICAgICAgICAnYVt0aXRsZV06bm90KC5waWNrZXItd2l6YXJkKSc6IHt4OiAtOSwgeTogMzB9LFxuICAgICAgICAnaW5wdXRbdGl0bGVdJzoge3g6IC05LCB5OiAzMH0sXG4gICAgICAgICd0aW1lW3RpdGxlXSc6IHt4OiAtOSwgeTogMjZ9LFxuICAgICAgICAnc3Bhblt0aXRsZV0nOiB7eDogLTksIHk6IDI2fSxcbiAgICB9O1xuXG4gICAgYWN0aXZlVGFyZ2V0cyA9IG5ldyBTZXQoKTtcbiAgICByZW1vdmVDbGlja1RhcmdldEhhbmRsZXJEZWxlZ2F0ZXMgPSBuZXcgTWFwKCk7XG5cbiAgICAvKipcbiAgICAgKiBUaGVyZSBpcyBvbmUgY29udHJvbGxlciBoYW5kbGluZyBtdWx0aXBsZSB0b29sdGlwIHRhcmdldHMuIFRoZSB0b29sdGlwXG4gICAgICogRE9NIGVsZW1lbnQgaXMgc2hhcmVkIGFjcm9zcyB0YXJnZXRzLlxuICAgICAqL1xuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMudG9vbHRpcCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignYm9keSA+IGRpdltyb2xlPVwidG9vbHRpcFwiXScpID8/IHRoaXMuX2NyZWF0ZVRpcENvbnRhaW5lcigpO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMudG9vbHRpcC5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICB0b29sdGlwVGFyZ2V0Q29ubmVjdGVkKGVsKSB7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoZSkgPT4gdGhpcy5fc2hvd1Rvb2x0aXAoZS50YXJnZXQsIDEwMDApKTtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoZSkgPT4gdGhpcy5fc2hvd1Rvb2x0aXAoZS50YXJnZXQpKTtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKSA9PiB0aGlzLl9oaWRlVG9vbHRpcChlLnRhcmdldCkpO1xuXG4gICAgICAgIC8vIEluIGNhc2UgdGhlIHRvb2x0aXAgdGFyZ2V0IGlzIGluc2lkZSBhIGxpbmsgb3IgYnV0dG9uLCBhbHNvIGNsb3NlIGl0XG4gICAgICAgIC8vIHdoZW4gYSBjbGljayBoYXBwZW5lZFxuICAgICAgICBjb25zdCBjbGlja1RhcmdldCA9IGVsLmNsb3Nlc3QoJ2J1dHRvbiwgYScpO1xuXG4gICAgICAgIGlmIChjbGlja1RhcmdldCkge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHRoaXMuX2hpZGVUb29sdGlwKGVsKTtcblxuICAgICAgICAgICAgY2xpY2tUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2xpY2tUYXJnZXRIYW5kbGVyRGVsZWdhdGVzLnNldChlbCwgKCkgPT4gZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVyKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b29sdGlwVGFyZ2V0RGlzY29ubmVjdGVkKGVsKSB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVRhcmdldHMuaGFzKGVsKSkge1xuICAgICAgICAgICAgdGhpcy5faGlkZVRvb2x0aXAoZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucmVtb3ZlQ2xpY2tUYXJnZXRIYW5kbGVyRGVsZWdhdGVzLmhhcyhlbCkpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2xpY2tUYXJnZXRIYW5kbGVyRGVsZWdhdGVzLmdldChlbCkoKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2xpY2tUYXJnZXRIYW5kbGVyRGVsZWdhdGVzLmRlbGV0ZShlbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfY3JlYXRlVGlwQ29udGFpbmVyKCkge1xuICAgICAgICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRvb2x0aXAuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3Rvb2x0aXAnKTtcbiAgICAgICAgdG9vbHRpcC5jbGFzc0xpc3QuYWRkKCd0aXAnKTtcbiAgICAgICAgdG9vbHRpcC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIHRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRvb2x0aXApO1xuXG4gICAgICAgIHJldHVybiB0b29sdGlwO1xuICAgIH1cblxuICAgIHRvdWNoU3RhcnQgPSAoZSkgPT4ge1xuICAgICAgICBbLi4udGhpcy5hY3RpdmVUYXJnZXRzXS5maWx0ZXIoZWwgPT4gIWVsLmNvbnRhaW5zKGUudGFyZ2V0KSkuZm9yRWFjaCh0aGlzLl9oaWRlVG9vbHRpcC5iaW5kKHRoaXMpKVxuICAgIH07XG5cbiAgICBfc2hvd1Rvb2x0aXAoZWwsIGRlbGF5ID0gMCkge1xuICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5fZ2V0T3B0aW9uc0ZvckVsZW1lbnQoZWwpO1xuICAgICAgICBsZXQgdGV4dDtcblxuICAgICAgICBpZiAob3B0aW9ucy51c2VDb250ZW50KSB7XG4gICAgICAgICAgICB0ZXh0ID0gZWwuaW5uZXJIVE1MO1xuICAgICAgICB9IGVsc2UgaWYgKGVsIGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCkge1xuICAgICAgICAgICAgdGV4dCA9IGVsLmdldEF0dHJpYnV0ZSgnYWx0Jyk7XG4gICAgICAgICAgICB0ZXh0ID0gdGV4dD8ucmVwbGFjZSgvJi9nLCAnJmFtcDsnKS5yZXBsYWNlKC88L2csICcmbHQ7JykucmVwbGFjZSgvXCIvZywgJyZxdW90OycpLnJlcGxhY2UoLycvZywgJyZhcG9zOycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGV4dCA9IGVsLmdldEF0dHJpYnV0ZSgndGl0bGUnKTtcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1vcmlnaW5hbC10aXRsZScsIHRleHQpO1xuICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCd0aXRsZScpO1xuICAgICAgICAgICAgdGV4dCA9IHRleHQ/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdkaXNwbGF5LGNvbnRlbnRzJztcblxuICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldHMuYWRkKGVsKTtcblxuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHJ0bCA9IGdldENvbXB1dGVkU3R5bGUoZWwpLmRpcmVjdGlvbiA9PT0gJ3J0bCc7XG4gICAgICAgICAgICBjb25zdCBjbGllbnRXaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcblxuICAgICAgICAgICAgaWYgKChydGwgJiYgcG9zaXRpb24ueCA8IDIwMCkgfHwgKCFydGwgJiYgcG9zaXRpb24ueCA8IChjbGllbnRXaWR0aCAtIDIwMCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLmxlZnQgPSBgJHsod2luZG93LnNjcm9sbFggKyBwb3NpdGlvbi5sZWZ0ICsgb3B0aW9ucy54KX1weGA7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLnJpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5jbGFzc0xpc3QucmVtb3ZlKCd0aXAtLXJ0bCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUubGVmdCA9ICdhdXRvJztcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUucmlnaHQgPSBgJHsoY2xpZW50V2lkdGggLSB3aW5kb3cuc2Nyb2xsWCAtIHBvc2l0aW9uLnJpZ2h0ICsgb3B0aW9ucy54KX1weGA7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLmNsYXNzTGlzdC5hZGQoJ3RpcC0tcnRsJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5pbm5lckhUTUwgPSBgPGRpdj4ke3RleHR9PC9kaXY+YDtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS50b3AgPSBgJHsod2luZG93LnNjcm9sbFkgKyBwb3NpdGlvbi50b3AgKyBvcHRpb25zLnkpfXB4YDtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS53aWxsQ2hhbmdlID0gJ2F1dG8nO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfVxuXG4gICAgX2hpZGVUb29sdGlwKGVsLCBkZWxheSA9IDApIHtcbiAgICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnZGF0YS1vcmlnaW5hbC10aXRsZScpKSB7XG4gICAgICAgICAgICBpZiAoIWVsLmhhc0F0dHJpYnV0ZSgndGl0bGUnKSkge1xuICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1vcmlnaW5hbC10aXRsZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdhdXRvJztcblxuICAgICAgICBpZiAodGhpcy50b29sdGlwLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0cy5kZWxldGUoZWwpO1xuXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdkaXNwbGF5JztcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdhdXRvJztcbiAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9nZXRPcHRpb25zRm9yRWxlbWVudChlbCkge1xuICAgICAgICBmb3IgKGNvbnN0IFtjcml0ZXJpYSwgZGVmYXVsdE9wdGlvbnNdIG9mIE9iamVjdC5lbnRyaWVzKFRvb2x0aXBzQ29udHJvbGxlci5kZWZhdWx0T3B0aW9uc01hcCkpIHtcbiAgICAgICAgICAgIGlmIChlbC5tYXRjaChjcml0ZXJpYSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge3g6IC05LCB5OiAzMH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWlncmF0ZSBsZWdhY3kgdGFyZ2V0cyB0byBwcm9wZXIgY29udHJvbGxlciB0YXJnZXRzLlxuICAgICAqL1xuICAgIHN0YXRpYyBhZnRlckxvYWQoaWRlbnRpZmllciwgYXBwbGljYXRpb24pIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0U2VsZWN0b3JzID0gT2JqZWN0LmtleXMoVG9vbHRpcHNDb250cm9sbGVyLmRlZmF1bHRPcHRpb25zTWFwKTtcblxuICAgICAgICBjb25zdCBtaWdyYXRlVGFyZ2V0ID0gZWwgPT4ge1xuICAgICAgICAgICAgdGFyZ2V0U2VsZWN0b3JzLmZvckVhY2godGFyZ2V0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWVsLmhhc0F0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LXRhcmdldGApICYmIGVsLm1hdGNoKHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKGBkYXRhLSR7aWRlbnRpZmllcn0tdGFyZ2V0YCwgJ3Rvb2x0aXAnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBlbC5xdWVyeVNlbGVjdG9yQWxsKHRhcmdldCkuZm9yRWFjaChzZWwgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbC5oYXNBdHRyaWJ1dGUoYGRhdGEtJHtpZGVudGlmaWVyfS10YXJnZXRgKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsLnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LXRhcmdldGAsICd0b29sdGlwJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zTGlzdCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnNMaXN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgIT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAobGV0IG5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG1pZ3JhdGVUYXJnZXQobm9kZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGx5IG1pZ3JhdGUgYWxsIHRhcmdldHMgdGhhdCBhcmUgYWxyZWFkeSBpbiB0aGUgRE9NXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFyZ2V0U2VsZWN0b3JzLmpvaW4oJywnKSkuZm9yRWFjaChlbCA9PiBtaWdyYXRlVGFyZ2V0KGVsKSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ21lc3NhZ2UnXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIHVuc3VwcG9ydGVkTWVzc2FnZTogU3RyaW5nLFxuICAgICAgICBhc3NlcnRpb25GYWlsdXJlTWVzc2FnZTogU3RyaW5nLFxuICAgICAgICBhdHRlc3RhdGlvbkZhaWx1cmVNZXNzYWdlOiBTdHJpbmcsXG4gICAgICAgIG9wdGlvbnNGYWlsdXJlTWVzc2FnZTogU3RyaW5nLFxuICAgICAgICBjc3JmVXJsOiBTdHJpbmcsXG4gICAgfVxuXG4gICAgaGFuZGxlVW5zdXBwb3J0ZWQoKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVRhcmdldC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlck1lc3NhZ2UodGhpcy51bnN1cHBvcnRlZE1lc3NhZ2VWYWx1ZSk7XG4gICAgfVxuXG4gICAgaGFuZGxlQXNzZXJ0aW9uRmFpbHVyZShlKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVRhcmdldC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlck1lc3NhZ2UodGhpcy5hc3NlcnRpb25GYWlsdXJlTWVzc2FnZVZhbHVlKTtcbiAgICB9XG5cbiAgICBoYW5kbGVBdHRlc3RhdGlvbkZhaWx1cmUoKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZVRhcmdldC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlck1lc3NhZ2UodGhpcy5hdHRlc3RhdGlvbkZhaWx1cmVNZXNzYWdlVmFsdWUpO1xuICAgIH1cblxuICAgIGhhbmRsZU9wdGlvbnNGYWlsdXJlKCkge1xuICAgICAgICB0aGlzLm1lc3NhZ2VUYXJnZXQuaW5uZXJIVE1MID0gdGhpcy5yZW5kZXJNZXNzYWdlKHRoaXMub3B0aW9uc0ZhaWx1cmVNZXNzYWdlVmFsdWUpO1xuICAgIH1cblxuICAgIGxvYWRDc3JmKCkge1xuICAgICAgICBpZiAodGhpcy5jc3JmU2NyaXB0IHx8ICF0aGlzLmNzcmZVcmxWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIGFsd2F5cyBoYXZlIHRoZSBjb3JyZWN0IHJlcXVlc3QgdG9rZW4gYW5kIGNvb2tpZVxuICAgICAgICB0aGlzLmNzcmZTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgdGhpcy5jc3JmU2NyaXB0LnNyYyA9IHRoaXMuY3NyZlVybFZhbHVlO1xuICAgICAgICB0aGlzLmNzcmZTY3JpcHQuYXN5bmMgPSB0cnVlO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZCh0aGlzLmNzcmZTY3JpcHQpO1xuICAgIH1cblxuICAgIHJlbmRlck1lc3NhZ2UobWVzc2FnZSwgdHlwZSkge1xuICAgICAgICB0eXBlID0gdHlwZSA/PyAnZXJyb3InO1xuXG4gICAgICAgIHJldHVybiBgPHAgY2xhc3M9XCJ0bF8ke3R5cGV9XCI+JHttZXNzYWdlfTwvcD5gO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBUd2lnRWRpdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyQmFja3VwID0gZWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICAgICAgdGhpcy5uYW1lID0gZWxlbWVudC5kYXRhc2V0Lm5hbWU7XG4gICAgICAgIHRoaXMucmVzb3VyY2VVcmwgPSBlbGVtZW50LmRhdGFzZXQucmVzb3VyY2VVcmw7XG5cbiAgICAgICAgdGhpcy5lZGl0b3IgPSBhY2UuZWRpdChlbGVtZW50LCB7XG4gICAgICAgICAgICBtb2RlOiAnYWNlL21vZGUvdHdpZycsXG4gICAgICAgICAgICBtYXhMaW5lczogMTAwLFxuICAgICAgICAgICAgd3JhcDogdHJ1ZSxcbiAgICAgICAgICAgIHVzZVNvZnRUYWJzOiBmYWxzZSxcbiAgICAgICAgICAgIGF1dG9TY3JvbGxFZGl0b3JJbnRvVmlldzogdHJ1ZSxcbiAgICAgICAgICAgIHJlYWRPbmx5OiBlbGVtZW50Lmhhc0F0dHJpYnV0ZSgncmVhZG9ubHknKSxcbiAgICAgICAgICAgIGVuYWJsZUxpdmVBdXRvY29tcGxldGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIGVuYWJsZUtleWJvYXJkQWNjZXNzaWJpbGl0eTogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRDb2xvclNjaGVtZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZGF0YXNldC5jb2xvclNjaGVtZSk7XG4gICAgICAgIHRoaXMuZWRpdG9yLmNvbnRhaW5lci5zdHlsZS5saW5lSGVpZ2h0ID0gJzEuNDUnO1xuXG4gICAgICAgIGNvbnN0IHdoaXRlc3BhY2UgPSBhY2UucmVxdWlyZSgnYWNlL2V4dC93aGl0ZXNwYWNlJyk7XG4gICAgICAgIHdoaXRlc3BhY2UuZGV0ZWN0SW5kZW50YXRpb24odGhpcy5lZGl0b3IuZ2V0U2Vzc2lvbigpKTtcblxuICAgICAgICAvLyBSZWdpc3RlciBjb21tYW5kc1xuICAgICAgICB0aGlzLmVkaXRvci5jb21tYW5kcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIG5hbWU6ICdsZW5zOmJsb2NrLWluZm8nLFxuICAgICAgICAgICAgcmVhZE9ubHk6IHRydWUsXG4gICAgICAgICAgICBleGVjOiAoZWRpdG9yLCBhcmdzKSA9PiB7XG4gICAgICAgICAgICAgICAgZWRpdG9yLmNvbnRhaW5lci5kaXNwYXRjaEV2ZW50KFxuICAgICAgICAgICAgICAgICAgICBuZXcgQ3VzdG9tRXZlbnQoJ3R3aWctZWRpdG9yOmxlbnM6YmxvY2staW5mbycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s6IGFyZ3NbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuZWRpdG9yLmNvbW1hbmRzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgbmFtZTogJ2xlbnM6Zm9sbG93JyxcbiAgICAgICAgICAgIHJlYWRPbmx5OiB0cnVlLFxuICAgICAgICAgICAgZXhlYzogKGVkaXRvciwgYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRvci5jb250YWluZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KCd0d2lnLWVkaXRvcjpsZW5zOmZvbGxvdycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBhcmdzWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNldHVwIGNvZGUgbGVuc2VzXG4gICAgICAgIHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5vbmNlKCd0b2tlbml6ZXJVcGRhdGUnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyQ29kZUxlbnNQcm92aWRlcigpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHJlZ2lzdGVyQ29kZUxlbnNQcm92aWRlcigpIHtcbiAgICAgICAgY29uc3QgY29kZUxlbnMgPSBhY2UucmVxdWlyZSgnYWNlL2V4dC9jb2RlX2xlbnMnKTtcblxuICAgICAgICBjb2RlTGVucy5yZWdpc3RlckNvZGVMZW5zUHJvdmlkZXIodGhpcy5lZGl0b3IsIHtcbiAgICAgICAgICAgIHByb3ZpZGVDb2RlTGVuc2VzOiAoc2Vzc2lvbiwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5kZXN0cm95ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxldCBwYXlsb2FkID0gW107XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFuYWx5emVSZWZlcmVuY2VzKCkuZm9yRWFjaChyZWZlcmVuY2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IHtyb3c6IHJlZmVyZW5jZS5yb3csIGNvbHVtbjogcmVmZXJlbmNlLmNvbHVtbn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdsZW5zOmZvbGxvdycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHJlZmVyZW5jZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50czogW3JlZmVyZW5jZS5uYW1lXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5hbmFseXplQmxvY2tzKCkuZm9yRWFjaChibG9jayA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDoge3JvdzogYmxvY2sucm93LCBjb2x1bW46IGJsb2NrLmNvbHVtbn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdsZW5zOmJsb2NrLWluZm8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBgQmxvY2sgXCIke2Jsb2NrLm5hbWV9XCJgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50czogW2Jsb2NrLm5hbWVdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCBwYXlsb2FkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBhbmFseXplUmVmZXJlbmNlcygpIHtcbiAgICAgICAgbGV0IHJlZmVyZW5jZXMgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuZ2V0TGVuZ3RoKCk7IHJvdysrKSB7XG4gICAgICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuZ2V0VG9rZW5zKHJvdyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRva2Vuc1tpXS50eXBlID09PSAnbWV0YS50YWcudHdpZydcbiAgICAgICAgICAgICAgICAgICAgJiYgL157JS0/JC8udGVzdCh0b2tlbnNbaV0udmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICYmIHRva2Vuc1tpICsgMl0/LnR5cGUgPT09ICdrZXl3b3JkLmNvbnRyb2wudHdpZydcbiAgICAgICAgICAgICAgICAgICAgJiYgWydleHRlbmRzJywgJ3VzZSddLmluY2x1ZGVzKHRva2Vuc1tpICsgMl0udmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICYmIHRva2Vuc1tpICsgNF0/LnR5cGUgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0b2tlbnNbaSArIDRdLnZhbHVlLnJlcGxhY2UoL1tcIiddL2csICcnKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoL15AQ29udGFvKF8uKyk/XFwvLy50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VzLnB1c2goe25hbWUsIHJvdywgY29sdW1uOiB0b2tlbnNbaV0uc3RhcnR9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZWZlcmVuY2VzO1xuICAgIH1cblxuICAgIGFuYWx5emVCbG9ja3MoKSB7XG4gICAgICAgIGxldCBibG9ja3MgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuZ2V0TGVuZ3RoKCk7IHJvdysrKSB7XG4gICAgICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuZ2V0VG9rZW5zKHJvdyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRva2Vuc1tpXS50eXBlID09PSAnbWV0YS50YWcudHdpZydcbiAgICAgICAgICAgICAgICAgICAgJiYgL157JS0/JC8udGVzdCh0b2tlbnNbaV0udmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICYmIHRva2Vuc1tpICsgMl0/LnR5cGUgPT09ICdrZXl3b3JkLmNvbnRyb2wudHdpZydcbiAgICAgICAgICAgICAgICAgICAgJiYgdG9rZW5zW2kgKyAyXS52YWx1ZSA9PT0gJ2Jsb2NrJ1xuICAgICAgICAgICAgICAgICAgICAmJiB0b2tlbnNbaSArIDRdPy50eXBlID09PSAnaWRlbnRpZmllcidcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tzLnB1c2goe25hbWU6IHRva2Vuc1tpICsgNF0udmFsdWUsIHJvdywgY29sdW1uOiB0b2tlbnNbaV0uc3RhcnR9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYmxvY2tzO1xuICAgIH1cblxuICAgIHNldEFubm90YXRpb25zRGF0YShkYXRhKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yLmNvbXBsZXRlcnMgPSBbe1xuICAgICAgICAgICAgZ2V0Q29tcGxldGlvbnM6IGZ1bmN0aW9uKGVkaXRvciwgc2Vzc2lvbiwgcG9zLCBwcmVmaXgsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YS5hdXRvY29tcGxldGUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfV07XG5cbiAgICAgICAgaWYgKCdlcnJvcicgaW4gZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5lZGl0b3IuZ2V0U2Vzc2lvbigpLnNldEFubm90YXRpb25zKFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJvdzogZGF0YS5lcnJvci5saW5lIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogZGF0YS5lcnJvci50eXBlIHx8ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGAgJHtkYXRhLmVycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldENvbG9yU2NoZW1lKG1vZGUpIHtcbiAgICAgICAgdGhpcy5lZGl0b3Iuc2V0VGhlbWUobW9kZSA9PT0gJ2RhcmsnID8gJ2FjZS90aGVtZS90d2lsaWdodCcgOiAnYWNlL3RoZW1lL2Nsb3VkcycpO1xuICAgIH1cblxuICAgIGlzRWRpdGFibGUoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5lZGl0b3IuZ2V0UmVhZE9ubHkoKTtcbiAgICB9XG5cbiAgICBnZXRDb250ZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICB9XG5cbiAgICBmb2N1cygpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IuZm9jdXMoKTtcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICAvLyBEZXN0cm95aW5nIHRoZSBBQ0UgaW5zdGFuY2UgZG9lcyBub3QgZnVsbHkgcmVzZXQgdGhlIEhUTUwsIHNvIHdlXG4gICAgICAgIC8vIG1hbnVhbGx5IHJlc3RvcmUgdGhlIGNvbnRhaW5lciBieSB1c2luZyB0aGUgY2xvbmVkIGJhY2t1cCB3aXRoXG4gICAgICAgIC8vIHVwZGF0ZWQgY29udGVudC5cbiAgICAgICAgdGhpcy5jb250YWluZXJCYWNrdXAudGV4dENvbnRlbnQgPSB0aGlzLmdldENvbnRlbnQoKTtcbiAgICAgICAgdGhpcy5lZGl0b3IuY29udGFpbmVyLnJlcGxhY2VXaXRoKHRoaXMuY29udGFpbmVyQmFja3VwKTtcblxuICAgICAgICB0aGlzLmVkaXRvci5kZXN0cm95KCk7XG4gICAgfVxufVxuIiwiLyoqXG4gKiBQcm92aWRlIG1ldGhvZHMgdG8gaGFuZGxlIEFqYXggcmVxdWVzdHMuXG4gKlxuICogQGF1dGhvciBMZW8gRmV5ZXIgPGh0dHBzOi8vZ2l0aHViLmNvbS9sZW9mZXllcj5cbiAqL1xud2luZG93LkFqYXhSZXF1ZXN0ID1cbntcblx0LyoqXG5cdCAqIFRvZ2dsZSB0aGUgbmF2aWdhdGlvbiBtZW51XG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgVGhlIElEIG9mIHRoZSBtZW51IGl0ZW1cblx0ICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgQWpheCBVUkxcblx0ICpcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHR0b2dnbGVOYXZpZ2F0aW9uOiBmdW5jdGlvbihlbCwgaWQsIHVybCkge1xuXHRcdGlmICh3aW5kb3cuY29uc29sZSkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBamF4UmVxdWVzdC50b2dnbGVOYXZpZ2F0aW9uKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgc3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuXHRcdH1cblxuXHRcdHZhciBpdGVtID0gJChpZCksXG5cdFx0XHRwYXJlbnQgPSAkKGVsKS5nZXRQYXJlbnQoJ2xpJyk7XG5cblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKHBhcmVudC5oYXNDbGFzcygnY29sbGFwc2VkJykpIHtcblx0XHRcdFx0cGFyZW50LnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHsgdXJsOiB1cmwgfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZU5hdmlnYXRpb24nLCAnaWQnOmlkLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGFyZW50LmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5leHBhbmQpO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oeyB1cmw6IHVybCB9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlTmF2aWdhdGlvbicsICdpZCc6aWQsICdzdGF0ZSc6MCwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgdGhlIHBhZ2UgdHJlZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgICBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqIEBwYXJhbSB7aW50fSAgICBsZXZlbCBUaGUgaW5kZW50YXRpb24gbGV2ZWxcblx0ICogQHBhcmFtIHtpbnR9ICAgIG1vZGUgIFRoZSBpbnNlcnQgbW9kZVxuXHQgKlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICovXG5cdHRvZ2dsZVN0cnVjdHVyZTogZnVuY3Rpb24oZWwsIGlkLCBsZXZlbCwgbW9kZSkge1xuXHRcdGlmICh3aW5kb3cuY29uc29sZSkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBamF4UmVxdWVzdC50b2dnbGVTdHJ1Y3R1cmUoKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBzdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG5cdFx0fVxuXG5cdFx0dmFyIGl0ZW0gPSAkKGlkKTtcblxuXHRcdGlmIChpdGVtKSB7XG5cdFx0XHRpZiAoaXRlbS5nZXRTdHlsZSgnZGlzcGxheScpID09ICdub25lJykge1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cblx0XHRcdFx0JChlbCkuYWRkQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5jb2xsYXBzZSk7XG5cblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtmaWVsZDplbH0pLnBvc3QoeydhY3Rpb24nOid0b2dnbGVTdHJ1Y3R1cmUnLCAnaWQnOmlkLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aXRlbS5zZXRTdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cblx0XHRcdFx0JChlbCkucmVtb3ZlQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5leHBhbmQpO1xuXG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7ZmllbGQ6ZWx9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3RydWN0dXJlJywgJ2lkJzppZCwgJ3N0YXRlJzowLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRuZXcgUmVxdWVzdC5Db250YW8oe1xuXHRcdFx0ZmllbGQ6IGVsLFxuXHRcdFx0ZXZhbFNjcmlwdHM6IHRydWUsXG5cdFx0XHRvblJlcXVlc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRBamF4UmVxdWVzdC5kaXNwbGF5Qm94KENvbnRhby5sYW5nLmxvYWRpbmcgKyAnIOKApicpO1xuXHRcdFx0fSxcblx0XHRcdG9uU3VjY2VzczogZnVuY3Rpb24odHh0KSB7XG5cdFx0XHRcdHZhciBsaSA9IG5ldyBFbGVtZW50KCdsaScsIHtcblx0XHRcdFx0XHQnaWQnOiBpZCxcblx0XHRcdFx0XHQnY2xhc3MnOiAncGFyZW50Jyxcblx0XHRcdFx0XHQnc3R5bGVzJzoge1xuXHRcdFx0XHRcdFx0J2Rpc3BsYXknOiAnaW5saW5lJ1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0bmV3IEVsZW1lbnQoJ3VsJywge1xuXHRcdFx0XHRcdCdjbGFzcyc6ICdsZXZlbF8nICsgbGV2ZWwsXG5cdFx0XHRcdFx0J2h0bWwnOiB0eHRcblx0XHRcdFx0fSkuaW5qZWN0KGxpLCAnYm90dG9tJyk7XG5cblx0XHRcdFx0aWYgKG1vZGUgPT0gNSkge1xuXHRcdFx0XHRcdGxpLmluamVjdCgkKGVsKS5nZXRQYXJlbnQoJ2xpJyksICdhZnRlcicpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBmb2xkZXIgPSBmYWxzZSxcblx0XHRcdFx0XHRcdHBhcmVudCA9ICQoZWwpLmdldFBhcmVudCgnbGknKSxcblx0XHRcdFx0XHRcdG5leHQ7XG5cblx0XHRcdFx0XHR3aGlsZSAodHlwZU9mKHBhcmVudCkgPT0gJ2VsZW1lbnQnICYmIChuZXh0ID0gcGFyZW50LmdldE5leHQoJ2xpJykpKSB7XG5cdFx0XHRcdFx0XHRwYXJlbnQgPSBuZXh0O1xuXHRcdFx0XHRcdFx0aWYgKHBhcmVudC5oYXNDbGFzcygndGxfZm9sZGVyJykpIHtcblx0XHRcdFx0XHRcdFx0Zm9sZGVyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGZvbGRlcikge1xuXHRcdFx0XHRcdFx0bGkuaW5qZWN0KHBhcmVudCwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRsaS5pbmplY3QocGFyZW50LCAnYWZ0ZXInKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHJlZmVyZXIgSURcblx0XHRcdFx0bGkuZ2V0RWxlbWVudHMoJ2EnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdFx0ZWwuaHJlZiA9IGVsLmhyZWYucmVwbGFjZSgvJnJlZj1bYS1mMC05XSsvLCAnJnJlZj0nICsgQ29udGFvLnJlZmVyZXJfaWQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblxuXHRcdFx0XHR3aW5kb3cuZmlyZUV2ZW50KCdzdHJ1Y3R1cmUnKTtcblx0XHRcdFx0QWpheFJlcXVlc3QuaGlkZUJveCgpO1xuXG5cdFx0XHRcdC8vIEhPT0tcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcbiAgIFx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzonbG9hZFN0cnVjdHVyZScsICdpZCc6aWQsICdsZXZlbCc6bGV2ZWwsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSB0aGUgZmlsZSB0cmVlXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgICAgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZm9sZGVyIFRoZSBmb2xkZXIncyBwYXRoXG5cdCAqIEBwYXJhbSB7aW50fSAgICBsZXZlbCAgVGhlIGluZGVudGF0aW9uIGxldmVsXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0dG9nZ2xlRmlsZU1hbmFnZXI6IGZ1bmN0aW9uKGVsLCBpZCwgZm9sZGVyLCBsZXZlbCkge1xuXHRcdGlmICh3aW5kb3cuY29uc29sZSkge1xuXHRcdFx0Y29uc29sZS53YXJuKCdBamF4UmVxdWVzdC50b2dnbGVGaWxlTWFuYWdlcigpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgdGhlIHN0aW11bHVzIGNvbnRyb2xsZXIgaW5zdGVhZC4nKTtcblx0XHR9XG5cblx0XHR2YXIgaXRlbSA9ICQoaWQpO1xuXG5cdFx0aWYgKGl0ZW0pIHtcblx0XHRcdGlmIChpdGVtLmdldFN0eWxlKCdkaXNwbGF5JykgPT0gJ25vbmUnKSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcblxuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOmVsfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZUZpbGVNYW5hZ2VyJywgJ2lkJzppZCwgJ3N0YXRlJzoxLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXG5cdFx0XHRcdCQoZWwpLnJlbW92ZUNsYXNzKCdmb2xkYWJsZS0tb3BlbicpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgQ29udGFvLmxhbmcuZXhwYW5kKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOmVsfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZUZpbGVNYW5hZ2VyJywgJ2lkJzppZCwgJ3N0YXRlJzowLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRuZXcgUmVxdWVzdC5Db250YW8oe1xuXHRcdFx0ZmllbGQ6IGVsLFxuXHRcdFx0ZXZhbFNjcmlwdHM6IHRydWUsXG5cdFx0XHRvblJlcXVlc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRBamF4UmVxdWVzdC5kaXNwbGF5Qm94KENvbnRhby5sYW5nLmxvYWRpbmcgKyAnIOKApicpO1xuXHRcdFx0fSxcblx0XHRcdG9uU3VjY2VzczogZnVuY3Rpb24odHh0KSB7XG5cdFx0XHRcdHZhciBsaSA9IG5ldyBFbGVtZW50KCdsaScsIHtcblx0XHRcdFx0XHQnaWQnOiBpZCxcblx0XHRcdFx0XHQnY2xhc3MnOiAncGFyZW50Jyxcblx0XHRcdFx0XHQnc3R5bGVzJzoge1xuXHRcdFx0XHRcdFx0J2Rpc3BsYXknOiAnaW5saW5lJ1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0bmV3IEVsZW1lbnQoJ3VsJywge1xuXHRcdFx0XHRcdCdjbGFzcyc6ICdsZXZlbF8nICsgbGV2ZWwsXG5cdFx0XHRcdFx0J2h0bWwnOiB0eHRcblx0XHRcdFx0fSkuaW5qZWN0KGxpLCAnYm90dG9tJyk7XG5cblx0XHRcdFx0bGkuaW5qZWN0KCQoZWwpLmdldFBhcmVudCgnbGknKSwgJ2FmdGVyJyk7XG5cblx0XHRcdFx0Ly8gVXBkYXRlIHRoZSByZWZlcmVyIElEXG5cdFx0XHRcdGxpLmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLmhyZWYgPSBlbC5ocmVmLnJlcGxhY2UoLyZyZWY9W2EtZjAtOV0rLywgJyZyZWY9JyArIENvbnRhby5yZWZlcmVyX2lkKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0JChlbCkuYWRkQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5jb2xsYXBzZSk7XG5cblx0XHRcdFx0QWpheFJlcXVlc3QuaGlkZUJveCgpO1xuXG5cdFx0XHRcdC8vIEhPT0tcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcbiAgIFx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzonbG9hZEZpbGVNYW5hZ2VyJywgJ2lkJzppZCwgJ2xldmVsJzpsZXZlbCwgJ2ZvbGRlcic6Zm9sZGVyLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgc3ViLXBhbGV0dGVzIGluIGVkaXQgbW9kZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCAgICBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBUaGUgZmllbGQgbmFtZVxuXHQgKi9cblx0dG9nZ2xlU3VicGFsZXR0ZTogZnVuY3Rpb24oZWwsIGlkLCBmaWVsZCkge1xuXHRcdHZhciBpdGVtID0gJChpZCk7XG5cblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKCFlbC52YWx1ZSkge1xuXHRcdFx0XHRlbC52YWx1ZSA9IDE7XG5cdFx0XHRcdGVsLmNoZWNrZWQgPSAnY2hlY2tlZCc7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcblx0XHRcdFx0aXRlbS5nZXRFbGVtZW50cygnW2RhdGEtcmVxdWlyZWRdJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLnNldCgncmVxdWlyZWQnLCAnJykuc2V0KCdkYXRhLXJlcXVpcmVkJywgbnVsbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOiBlbCwgb25TdWNjZXNzOnVwZGF0ZVZlcnNpb25OdW1iZXJ9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbC52YWx1ZSA9ICcnO1xuXHRcdFx0XHRlbC5jaGVja2VkID0gJyc7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHRpdGVtLmdldEVsZW1lbnRzKCdbcmVxdWlyZWRdJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLnNldCgncmVxdWlyZWQnLCBudWxsKS5zZXQoJ2RhdGEtcmVxdWlyZWQnLCAnJyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOiBlbCwgb25TdWNjZXNzOnVwZGF0ZVZlcnNpb25OdW1iZXJ9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdzdGF0ZSc6MCwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtcblx0XHRcdGZpZWxkOiBlbCxcblx0XHRcdGV2YWxTY3JpcHRzOiBmYWxzZSxcblx0XHRcdG9uUmVxdWVzdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmRpc3BsYXlCb3goQ29udGFvLmxhbmcubG9hZGluZyArICcg4oCmJyk7XG5cdFx0XHR9LFxuXHRcdFx0b25TdWNjZXNzOiBmdW5jdGlvbih0eHQsIGpzb24pIHtcblx0XHRcdFx0dmFyIGRpdiA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdFx0J2lkJzogaWQsXG5cdFx0XHRcdFx0J2NsYXNzJzogJ3N1YnBhbCB3aWRnZXQtZ3JvdXAnLFxuXHRcdFx0XHRcdCdodG1sJzogdHh0XG5cdFx0XHRcdH0pLmluamVjdCgkKGVsKS5nZXRQYXJlbnQoJ2RpdicpLmdldFBhcmVudCgnZGl2JyksICdhZnRlcicpO1xuXG5cdFx0XHRcdC8vIEV4ZWN1dGUgc2NyaXB0cyBhZnRlciB0aGUgRE9NIGhhcyBiZWVuIHVwZGF0ZWRcblx0XHRcdFx0aWYgKGpzb24uamF2YXNjcmlwdCkge1xuXG5cdFx0XHRcdFx0Ly8gVXNlIEFzc2V0LmphdmFzY3JpcHQoKSBpbnN0ZWFkIG9mIGRvY3VtZW50LndyaXRlKCkgdG8gbG9hZCBhXG5cdFx0XHRcdFx0Ly8gSmF2YVNjcmlwdCBmaWxlIGFuZCByZS1leGVjdXRlIHRoZSBjb2RlIGFmdGVyIGl0IGhhcyBiZWVuIGxvYWRlZFxuXHRcdFx0XHRcdGRvY3VtZW50LndyaXRlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0XHRcdFx0XHR2YXIgc3JjID0gJyc7XG5cdFx0XHRcdFx0XHRzdHIucmVwbGFjZSgvPHNjcmlwdCBzcmM9XCIoW15cIl0rKVwiL2ksIGZ1bmN0aW9uKGFsbCwgbWF0Y2gpe1xuXHRcdFx0XHRcdFx0XHRzcmMgPSBtYXRjaDtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0c3JjICYmIEFzc2V0LmphdmFzY3JpcHQoc3JjLCB7XG5cdFx0XHRcdFx0XHRcdG9uTG9hZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0QnJvd3Nlci5leGVjKGpzb24uamF2YXNjcmlwdCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRCcm93c2VyLmV4ZWMoanNvbi5qYXZhc2NyaXB0KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGVsLnZhbHVlID0gMTtcblx0XHRcdFx0ZWwuY2hlY2tlZCA9ICdjaGVja2VkJztcblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHJlZmVyZXIgSURcblx0XHRcdFx0ZGl2LmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLmhyZWYgPSBlbC5ocmVmLnJlcGxhY2UoLyZyZWY9W2EtZjAtOV0rLywgJyZyZWY9JyArIENvbnRhby5yZWZlcmVyX2lkKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dXBkYXRlVmVyc2lvbk51bWJlcih0eHQpO1xuXG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmhpZGVCb3goKTtcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcblx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdsb2FkJzoxLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXG5cdFx0ZnVuY3Rpb24gdXBkYXRlVmVyc2lvbk51bWJlcihodG1sKSB7XG5cdFx0XHR2YXIgZmllbGRzID0gZWwuZm9ybS5lbGVtZW50cy5WRVJTSU9OX05VTUJFUiB8fCBbXTtcblx0XHRcdGlmICghZmllbGRzLmZvckVhY2gpIHtcblx0XHRcdFx0ZmllbGRzID0gW2ZpZWxkc107XG5cdFx0XHR9XG5cdFx0XHRmaWVsZHMuZm9yRWFjaChmdW5jdGlvbihmaWVsZCkge1xuXHRcdFx0XHRmaWVsZC52YWx1ZSA9IC88aW5wdXRcXHMrW14+XSo/bmFtZT1cIlZFUlNJT05fTlVNQkVSXCJcXHMrW14+XSo/dmFsdWU9XCIoW15cIl0qKVwiL2kuZXhlYyhodG1sKVsxXTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIHRoZSBzdGF0ZSBvZiBhIGNoZWNrYm94IGZpZWxkXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSAgZWwgICAgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7Ym9vbGVhbn0gcm93SWNvbiAgV2hldGhlciB0aGUgcm93IGljb24gc2hvdWxkIGJlIHRvZ2dsZWQgYXMgd2VsbFxuXHQgKiBAcGFyYW0ge2Jvb2xlYW59IGljb25Pbmx5IElmIG9ubHkgdGhlIGljb24gc2hvdWxkIGJlIHRvZ2dsZWQgKHdpdGhvdXQgc2VuZGluZyBhIHJlcXVlc3QpXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0dG9nZ2xlRmllbGQ6IGZ1bmN0aW9uKGVsLCByb3dJY29uLCBpY29uT25seSA9IGZhbHNlKSB7XG5cdFx0dmFyIGltZyA9IG51bGwsXG5cdFx0XHRpbWFnZXMgPSAkKGVsKS5nZXRFbGVtZW50cygnaW1nJyksXG5cdFx0XHRwdWJsaXNoZWQgPSAoaW1hZ2VzWzBdLmdldCgnZGF0YS1zdGF0ZScpID09IDEpLFxuXHRcdFx0ZGl2LCBuZXh0LCBwYSwgdGl0bGU7XG5cblx0XHRpZiAocm93SWNvbiAmJiAhaWNvbk9ubHkpIHtcblx0XHRcdC8vIEZpbmQgdGhlIGljb24gZGVwZW5kaW5nIG9uIHRoZSB2aWV3ICh0cmVlIHZpZXcsIGxpc3QgdmlldywgcGFyZW50IHZpZXcpXG5cdFx0XHRpZiAoKGRpdiA9IGVsLmNsb3Nlc3QoJy50bF9yaWdodCcpKSkge1xuXHRcdFx0XHRpbWcgPSBkaXYuZ2V0UHJldmlvdXMoJ2RpdicpLmdldEVsZW1lbnRzKCdpbWcnKTtcblx0XHRcdH0gZWxzZSBpZiAoKGRpdiA9IGVsLmNsb3Nlc3QoJy50bF9jb250ZW50X3JpZ2h0JykpICYmIChuZXh0ID0gZGl2LmdldE5leHQoJ2RpdicpKSkge1xuXHRcdFx0XHRpZiAobmV4dC5oYXNDbGFzcygnY3RlX3R5cGUnKSkge1xuXHRcdFx0XHRcdGltZyA9IG5leHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGltZyA9PT0gbnVsbCkgeyAvLyBuZXdzbGV0dGVyIHJlY2lwaWVudHNcblx0XHRcdFx0XHRpbWcgPSBuZXh0LmdldEZpcnN0KCdkaXYubGlzdF9pY29uJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAoZWwuY2xvc2VzdCgnLnRsX2xpc3RpbmdfY29udGFpbmVyJykgJiYgZWwuZ2V0UGFyZW50KCd0cicpKSB7XG5cdFx0XHRcdGltZyA9IGVsLmdldFBhcmVudCgndGQnKS5nZXRQcmV2aW91cygndGQnKS5nZXRGaXJzdCgnZGl2Lmxpc3RfaWNvbicpO1xuXHRcdFx0XHRpZiAoaW1nID09PSBudWxsKSB7IC8vIGNvbW1lbnRzXG5cdFx0XHRcdFx0aW1nID0gZWwuZ2V0UGFyZW50KCd0ZCcpLmdldFByZXZpb3VzKCd0ZCcpLmdldEVsZW1lbnQoJ2Rpdi5jdGVfdHlwZScpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpbWcgPT09IG51bGwpIHsgLy8gc2hvd0NvbHVtbnNcblx0XHRcdFx0XHRpbWcgPSBlbC5nZXRQYXJlbnQoJ3RyJykuZ2V0Rmlyc3QoJ3RkJykuZ2V0RWxlbWVudCgnZGl2Lmxpc3RfaWNvbl9uZXcnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGFuZ2UgdGhlIHJvdyBpY29uXG5cdFx0XHRpZiAoaW1nICE9PSBudWxsKSB7XG5cdFx0XHRcdC8vIFRyZWUgdmlld1xuXHRcdFx0XHRpZiAoIShpbWcgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgJiYgaW1nLmZvckVhY2gpIHtcblx0XHRcdFx0XHRpbWcuZm9yRWFjaCgoaW1nKSA9PiB7XG5cdFx0XHRcdFx0XHRpZiAoaW1nIGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoIWltZy5nZXRQYXJlbnQoJ3VsLnRsX2xpc3RpbmcnKS5oYXNDbGFzcygndGxfdHJlZV94dG5kJykpIHtcblx0XHRcdFx0XHRcdFx0XHRwYSA9IGltZy5nZXRQYXJlbnQoJ2EnKTtcblxuXHRcdFx0XHRcdFx0XHRcdGlmIChwYSAmJiBwYS5ocmVmLmluZGV4T2YoJ2NvbnRhby9wcmV2aWV3JykgPT0gLTEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChuZXh0ID0gcGEuZ2V0TmV4dCgnYScpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGltZyA9IG5leHQuZ2V0RWxlbWVudCgnaW1nJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpbWcgPSBuZXcgRWxlbWVudCgnaW1nJyk7IC8vIG5vIGljb25zIHVzZWQgKHNlZSAjMjI4Nilcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRjb25zdCBuZXdTcmMgPSAhcHVibGlzaGVkID8gaW1nLmdldCgnZGF0YS1pY29uJykgOiBpbWcuZ2V0KCdkYXRhLWljb24tZGlzYWJsZWQnKTtcblx0XHRcdFx0XHRcdFx0aW1nLnNyYyA9IChpbWcuc3JjLmluY2x1ZGVzKCcvJykgJiYgIW5ld1NyYy5pbmNsdWRlcygnLycpKSA/IGltZy5zcmMuc2xpY2UoMCwgaW1nLnNyYy5sYXN0SW5kZXhPZignLycpICsgMSkgKyBuZXdTcmMgOiBuZXdTcmM7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBQYXJlbnQgdmlld1xuXHRcdFx0XHRlbHNlIGlmIChpbWcuaGFzQ2xhc3MoJ2N0ZV90eXBlJykpIHtcblx0XHRcdFx0XHRpZiAoIXB1Ymxpc2hlZCkge1xuXHRcdFx0XHRcdFx0aW1nLmFkZENsYXNzKCdwdWJsaXNoZWQnKTtcblx0XHRcdFx0XHRcdGltZy5yZW1vdmVDbGFzcygndW5wdWJsaXNoZWQnKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aW1nLmFkZENsYXNzKCd1bnB1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdFx0aW1nLnJlbW92ZUNsYXNzKCdwdWJsaXNoZWQnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gTGlzdCB2aWV3XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdGltZy5zZXRTdHlsZSgnYmFja2dyb3VuZC1pbWFnZScsICd1cmwoJyArICghcHVibGlzaGVkID8gaW1nLmdldCgnZGF0YS1pY29uJykgOiBpbWcuZ2V0KCdkYXRhLWljb24tZGlzYWJsZWQnKSkgKyAnKScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU2VuZCByZXF1ZXN0XG5cdFx0aW1hZ2VzLmZvckVhY2goZnVuY3Rpb24oaW1hZ2UpIHtcblx0XHRcdGNvbnN0IG5ld1NyYyA9ICFwdWJsaXNoZWQgPyBpbWFnZS5nZXQoJ2RhdGEtaWNvbicpIDogaW1hZ2UuZ2V0KCdkYXRhLWljb24tZGlzYWJsZWQnKTtcblx0XHRcdGltYWdlLnNyYyA9IChpbWFnZS5zcmMuaW5jbHVkZXMoJy8nKSAmJiAhbmV3U3JjLmluY2x1ZGVzKCcvJykpID8gaW1hZ2Uuc3JjLnNsaWNlKDAsIGltYWdlLnNyYy5sYXN0SW5kZXhPZignLycpICsgMSkgKyBuZXdTcmMgOiBuZXdTcmM7XG5cdFx0XHRpbWFnZS5hbHQgPSB0aXRsZSA9ICFwdWJsaXNoZWQgPyBpbWFnZS5nZXQoJ2RhdGEtYWx0JykgOiBpbWFnZS5nZXQoJ2RhdGEtYWx0LWRpc2FibGVkJyk7XG5cdFx0XHRpbWFnZS5zZXQoJ2RhdGEtc3RhdGUnLCAhcHVibGlzaGVkID8gMSA6IDApO1xuXHRcdH0pO1xuXG5cdFx0aWYgKCFwdWJsaXNoZWQgJiYgJChlbCkuZ2V0KCdkYXRhLXRpdGxlJykpIHtcblx0XHRcdGVsLnRpdGxlID0gdGl0bGUgPSAkKGVsKS5nZXQoJ2RhdGEtdGl0bGUnKTtcblx0XHR9IGVsc2UgaWYgKHB1Ymxpc2hlZCAmJiAkKGVsKS5nZXQoJ2RhdGEtdGl0bGUtZGlzYWJsZWQnKSkge1xuXHRcdFx0ZWwudGl0bGUgPSB0aXRsZSA9ICQoZWwpLmdldCgnZGF0YS10aXRsZS1kaXNhYmxlZCcpO1xuXHRcdH1cblxuXHRcdGlmICh0aXRsZSkge1xuXHRcdFx0ZWwuY2hpbGROb2Rlcy5mb3JFYWNoKChjaGlsZCkgPT4ge1xuXHRcdFx0XHRpZiAoY2hpbGQgaW5zdGFuY2VvZiBUZXh0ICYmIGNoaWxkLm5vZGVWYWx1ZS50cmltKCkpIHtcblx0XHRcdFx0XHRjaGlsZC5yZXBsYWNlV2l0aChuZXcgVGV4dCh0aXRsZSkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoIWljb25Pbmx5KSB7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoYGFbaHJlZj1cIiR7ZWwuZ2V0QXR0cmlidXRlKCdocmVmJyl9XCJdYCkuZm9yRWFjaCgoY2xvbmUpID0+IHtcblx0XHRcdFx0aWYgKGVsICE9PSBjbG9uZSkge1xuXHRcdFx0XHRcdEFqYXhSZXF1ZXN0LnRvZ2dsZUZpZWxkKGNsb25lLCByb3dJY29uLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7J3VybCc6ZWwuaHJlZiwgJ2ZvbGxvd1JlZGlyZWN0cyc6ZmFsc2V9KS5nZXQoKTtcblx0XHR9XG5cblx0XHQvLyBSZXR1cm4gZmFsc2UgdG8gc3RvcCB0aGUgY2xpY2sgZXZlbnQgb24gbGlua1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIGEgZ3JvdXAgb2YgYSBtdWx0aS1jaGVja2JveCBmaWVsZFxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0dG9nZ2xlQ2hlY2tib3hHcm91cDogZnVuY3Rpb24oZWwsIGlkKSB7XG5cdFx0dmFyIGl0ZW0gPSAkKGlkKTtcblxuXHRcdGlmIChpdGVtKSB7XG5cdFx0XHRpZiAoaXRlbS5nZXRTdHlsZSgnZGlzcGxheScpID09ICdub25lJykge1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cdFx0XHRcdCQoZWwpLmFkZENsYXNzKCdmb2xkYWJsZS0tb3BlbicpO1xuXG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbygpLnBvc3QoeydhY3Rpb24nOid0b2dnbGVDaGVja2JveEdyb3VwJywgJ2lkJzppZCwgJ3N0YXRlJzoxLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHQkKGVsKS5yZW1vdmVDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oKS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlQ2hlY2tib3hHcm91cCcsICdpZCc6aWQsICdzdGF0ZSc6MCwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIERpc3BsYXkgdGhlIFwibG9hZGluZyBkYXRhXCIgbWVzc2FnZVxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgbWVzc2FnZSB0ZXh0XG5cdCAqL1xuXHRkaXNwbGF5Qm94OiBmdW5jdGlvbihtZXNzYWdlKSB7XG5cdFx0dmFyIGJveCA9ICQoJ3RsX2FqYXhCb3gnKSxcblx0XHRcdG92ZXJsYXkgPSAkKCd0bF9hamF4T3ZlcmxheScpLFxuXHRcdFx0c2Nyb2xsID0gd2luZG93LmdldFNjcm9sbCgpO1xuXG5cdFx0aWYgKG92ZXJsYXkgPT09IG51bGwpIHtcblx0XHRcdG92ZXJsYXkgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHQnaWQnOiAndGxfYWpheE92ZXJsYXknXG5cdFx0XHR9KS5pbmplY3QoJChkb2N1bWVudC5ib2R5KSwgJ2JvdHRvbScpO1xuXHRcdH1cblxuXHRcdG92ZXJsYXkuc2V0KHtcblx0XHRcdCdzdHlsZXMnOiB7XG5cdFx0XHRcdCdkaXNwbGF5JzogJ2Jsb2NrJyxcblx0XHRcdFx0J3RvcCc6IHNjcm9sbC55ICsgJ3B4J1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGJveCA9PT0gbnVsbCkge1xuXHRcdFx0Ym94ID0gbmV3IEVsZW1lbnQoJ2RpdicsIHtcblx0XHRcdFx0J2lkJzogJ3RsX2FqYXhCb3gnXG5cdFx0XHR9KS5pbmplY3QoJChkb2N1bWVudC5ib2R5KSwgJ2JvdHRvbScpO1xuXHRcdH1cblxuXHRcdGJveC5zZXQoe1xuXHRcdFx0J2h0bWwnOiBtZXNzYWdlLFxuXHRcdFx0J3N0eWxlcyc6IHtcblx0XHRcdFx0J2Rpc3BsYXknOiAnYmxvY2snLFxuXHRcdFx0XHQndG9wJzogKHNjcm9sbC55ICsgMTAwKSArICdweCdcblx0XHRcdH1cblx0XHR9KVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBIaWRlIHRoZSBcImxvYWRpbmcgZGF0YVwiIG1lc3NhZ2Vcblx0ICovXG5cdGhpZGVCb3g6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBib3ggPSAkKCd0bF9hamF4Qm94JyksXG5cdFx0XHRvdmVybGF5ID0gJCgndGxfYWpheE92ZXJsYXknKTtcblxuXHRcdGlmIChvdmVybGF5KSB7XG5cdFx0XHRvdmVybGF5LnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHR9XG5cblx0XHRpZiAoYm94KSB7XG5cdFx0XHRib3guc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdH1cblx0fVxufTtcblxuLyoqXG4gKiBQcm92aWRlIG1ldGhvZHMgdG8gaGFuZGxlIGJhY2sgZW5kIHRhc2tzLlxuICpcbiAqIEBhdXRob3IgTGVvIEZleWVyIDxodHRwczovL2dpdGh1Yi5jb20vbGVvZmV5ZXI+XG4gKi9cbndpbmRvdy5CYWNrZW5kID1cbntcblx0LyoqXG5cdCAqIFRoZSBjdXJyZW50IElEXG5cdCAqIEBtZW1iZXIgeyhzdHJpbmd8bnVsbCl9XG5cdCAqL1xuXHRjdXJyZW50SWQ6IG51bGwsXG5cblx0LyoqXG5cdCAqIFRoZSBwb3B1cCB3aW5kb3dcblx0ICogQG1lbWJlciB7b2JqZWN0fVxuXHQgKi9cblx0cG9wdXBXaW5kb3c6IG51bGwsXG5cblx0LyoqXG5cdCAqIFRoZSB0aGVtZSBwYXRoXG5cdCAqIEBtZW1iZXIge3N0cmluZ31cblx0ICovXG5cdHRoZW1lUGF0aDogQ29udGFvLnNjcmlwdF91cmwgKyAnc3lzdGVtL3RoZW1lcy8nICsgQ29udGFvLnRoZW1lICsgJy8nLFxuXG5cdC8qKlxuXHQgKiBPcGVuIGEgbW9kYWwgd2luZG93XG5cdCAqXG5cdCAqIEBwYXJhbSB7aW50fSAgICB3aWR0aCAgIFRoZSB3aWR0aCBpbiBwaXhlbHNcblx0ICogQHBhcmFtIHtzdHJpbmd9IHRpdGxlICAgVGhlIHdpbmRvdydzIHRpdGxlXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBjb250ZW50IFRoZSB3aW5kb3cncyBjb250ZW50XG5cdCAqL1xuXHRvcGVuTW9kYWxXaW5kb3c6IGZ1bmN0aW9uKHdpZHRoLCB0aXRsZSwgY29udGVudCkge1xuXHRcdG5ldyBTaW1wbGVNb2RhbCh7XG5cdFx0XHQnd2lkdGgnOiB3aWR0aCxcblx0XHRcdCdoaWRlRm9vdGVyJzogdHJ1ZSxcblx0XHRcdCdkcmFnZ2FibGUnOiBmYWxzZSxcblx0XHRcdCdvdmVybGF5T3BhY2l0eSc6IC43LFxuXHRcdFx0J292ZXJsYXlDbGljayc6IGZhbHNlLFxuXHRcdFx0J29uU2hvdyc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdoaWRkZW4nKTsgfSxcblx0XHRcdCdvbkhpZGUnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnYXV0bycpOyB9XG5cdFx0fSkuc2hvdyh7XG5cdFx0XHQndGl0bGUnOiB0aXRsZSxcblx0XHRcdCdjb250ZW50cyc6IGNvbnRlbnRcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogT3BlbiBhbiBpbWFnZSBpbiBhIG1vZGFsIHdpbmRvd1xuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBBbiBvcHRpb25hbCBvcHRpb25zIG9iamVjdFxuXHQgKi9cblx0b3Blbk1vZGFsSW1hZ2U6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgb3B0ID0gb3B0aW9ucyB8fCB7fSxcblx0XHRcdG1heFdpZHRoID0gKHdpbmRvdy5nZXRTaXplKCkueCAtIDIwKS50b0ludCgpO1xuXHRcdGlmICghb3B0LndpZHRoIHx8IG9wdC53aWR0aCA+IG1heFdpZHRoKSBvcHQud2lkdGggPSBNYXRoLm1pbihtYXhXaWR0aCwgOTAwKTtcblx0XHR2YXIgTSA9IG5ldyBTaW1wbGVNb2RhbCh7XG5cdFx0XHQnd2lkdGgnOiBvcHQud2lkdGgsXG5cdFx0XHQnaGlkZUZvb3Rlcic6IHRydWUsXG5cdFx0XHQnZHJhZ2dhYmxlJzogZmFsc2UsXG5cdFx0XHQnb3ZlcmxheU9wYWNpdHknOiAuNyxcblx0XHRcdCdvblNob3cnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7IH0sXG5cdFx0XHQnb25IaWRlJzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2F1dG8nKTsgfVxuXHRcdH0pO1xuXHRcdE0uc2hvdyh7XG5cdFx0XHQndGl0bGUnOiBvcHQudGl0bGU/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKSxcblx0XHRcdCdjb250ZW50cyc6ICc8aW1nIHNyYz1cIicgKyBvcHQudXJsICsgJ1wiIGFsdD1cIlwiPidcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogT3BlbiBhbiBpZnJhbWUgaW4gYSBtb2RhbCB3aW5kb3dcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9uYWwgb3B0aW9ucyBvYmplY3Rcblx0ICovXG5cdG9wZW5Nb2RhbElmcmFtZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBvcHQgPSBvcHRpb25zIHx8IHt9LFxuXHRcdFx0bWF4V2lkdGggPSAod2luZG93LmdldFNpemUoKS54IC0gMjApLnRvSW50KCksXG5cdFx0XHRtYXhIZWlnaHQgPSAod2luZG93LmdldFNpemUoKS55IC0gMTM3KS50b0ludCgpO1xuXHRcdGlmICghb3B0LndpZHRoIHx8IG9wdC53aWR0aCA+IG1heFdpZHRoKSBvcHQud2lkdGggPSBNYXRoLm1pbihtYXhXaWR0aCwgOTAwKTtcblx0XHRpZiAoIW9wdC5oZWlnaHQgfHwgb3B0LmhlaWdodCA+IG1heEhlaWdodCkgb3B0LmhlaWdodCA9IG1heEhlaWdodDtcblx0XHR2YXIgTSA9IG5ldyBTaW1wbGVNb2RhbCh7XG5cdFx0XHQnd2lkdGgnOiBvcHQud2lkdGgsXG5cdFx0XHQnaGlkZUZvb3Rlcic6IHRydWUsXG5cdFx0XHQnZHJhZ2dhYmxlJzogZmFsc2UsXG5cdFx0XHQnb3ZlcmxheU9wYWNpdHknOiAuNyxcblx0XHRcdCdvdmVybGF5Q2xpY2snOiBmYWxzZSxcblx0XHRcdCdvblNob3cnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7IH0sXG5cdFx0XHQnb25IaWRlJzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2F1dG8nKTsgfVxuXHRcdH0pO1xuXHRcdE0uc2hvdyh7XG5cdFx0XHQndGl0bGUnOiBvcHQudGl0bGU/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKSxcblx0XHRcdCdjb250ZW50cyc6ICc8aWZyYW1lIHNyYz1cIicgKyBvcHQudXJsICsgJ1wiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIicgKyBvcHQuaGVpZ2h0ICsgJ1wiIGZyYW1lYm9yZGVyPVwiMFwiPjwvaWZyYW1lPicsXG5cdFx0XHQnbW9kZWwnOiAnbW9kYWwnXG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wZW4gYSBzZWxlY3RvciBwYWdlIGluIGEgbW9kYWwgd2luZG93XG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0XG5cdCAqL1xuXHRvcGVuTW9kYWxTZWxlY3RvcjogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBvcHQgPSBvcHRpb25zIHx8IHt9LFxuXHRcdFx0bWF4V2lkdGggPSAod2luZG93LmdldFNpemUoKS54IC0gMjApLnRvSW50KCksXG5cdFx0XHRtYXhIZWlnaHQgPSAod2luZG93LmdldFNpemUoKS55IC0gMTkyKS50b0ludCgpO1xuXHRcdGlmICghb3B0LmlkKSBvcHQuaWQgPSAndGxfc2VsZWN0Jztcblx0XHRpZiAoIW9wdC53aWR0aCB8fCBvcHQud2lkdGggPiBtYXhXaWR0aCkgb3B0LndpZHRoID0gTWF0aC5taW4obWF4V2lkdGgsIDkwMCk7XG5cdFx0aWYgKCFvcHQuaGVpZ2h0IHx8IG9wdC5oZWlnaHQgPiBtYXhIZWlnaHQpIG9wdC5oZWlnaHQgPSBtYXhIZWlnaHQ7XG5cdFx0dmFyIE0gPSBuZXcgU2ltcGxlTW9kYWwoe1xuXHRcdFx0J3dpZHRoJzogb3B0LndpZHRoLFxuXHRcdFx0J2RyYWdnYWJsZSc6IGZhbHNlLFxuXHRcdFx0J292ZXJsYXlPcGFjaXR5JzogLjcsXG5cdFx0XHQnb3ZlcmxheUNsaWNrJzogZmFsc2UsXG5cdFx0XHQnb25TaG93JzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2hpZGRlbicpOyB9LFxuXHRcdFx0J29uSGlkZSc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdhdXRvJyk7IH1cblx0XHR9KTtcblx0XHRNLmFkZEJ1dHRvbihDb250YW8ubGFuZy5jYW5jZWwsICdidG4nLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLmJ1dHRvbnNbMF0uaGFzQ2xhc3MoJ2J0bi1kaXNhYmxlZCcpKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHRoaXMuaGlkZSgpO1xuXHRcdH0pO1xuXHRcdE0uYWRkQnV0dG9uKENvbnRhby5sYW5nLmFwcGx5LCAnYnRuIHByaW1hcnknLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLmJ1dHRvbnNbMV0uaGFzQ2xhc3MoJ2J0bi1kaXNhYmxlZCcpKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHZhciBmcm0gPSB3aW5kb3cuZnJhbWVzWydzaW1wbGUtbW9kYWwtaWZyYW1lJ10sXG5cdFx0XHRcdHZhbCA9IFtdLCB1bCwgaW5wLCBpLCBwaWNrZXJWYWx1ZSwgc0luZGV4O1xuXHRcdFx0aWYgKGZybSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGFsZXJ0KCdDb3VsZCBub3QgZmluZCB0aGUgU2ltcGxlTW9kYWwgZnJhbWUnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dWwgPSBmcm0uZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3B0LmlkKTtcblx0XHRcdC8vIExvYWQgdGhlIHByZXZpb3VzIHZhbHVlcyAoIzE4MTYpXG5cdFx0XHRpZiAocGlja2VyVmFsdWUgPSB1bC5nZXQoJ2RhdGEtcGlja2VyLXZhbHVlJykpIHtcblx0XHRcdFx0dmFsID0gSlNPTi5wYXJzZShwaWNrZXJWYWx1ZSk7XG5cdFx0XHR9XG5cdFx0XHRpbnAgPSB1bC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW5wdXQnKTtcblx0XHRcdGZvciAoaT0wOyBpPGlucC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAoaW5wW2ldLmlkLm1hdGNoKC9eKGNoZWNrX2FsbF98cmVzZXRfKS8pKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gQWRkIGN1cnJlbnRseSBzZWxlY3RlZCB2YWx1ZSwgb3RoZXJ3aXNlIHJlbW92ZSAoIzE4MTYpXG5cdFx0XHRcdHNJbmRleCA9IHZhbC5pbmRleE9mKGlucFtpXS5nZXQoJ3ZhbHVlJykpO1xuXHRcdFx0XHRpZiAoaW5wW2ldLmNoZWNrZWQpIHtcblx0XHRcdFx0XHRpZiAoc0luZGV4ID09IC0xKSB7XG5cdFx0XHRcdFx0XHR2YWwucHVzaChpbnBbaV0uZ2V0KCd2YWx1ZScpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSBpZiAoc0luZGV4ICE9IC0xKSB7XG5cdFx0XHRcdFx0dmFsLnNwbGljZShzSW5kZXgsIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRvcHQuY2FsbGJhY2sodWwuZ2V0KCdkYXRhLXRhYmxlJyksIHZhbCk7XG5cdFx0XHR0aGlzLmhpZGUoKTtcblx0XHR9KTtcblx0XHRNLnNob3coe1xuXHRcdFx0J3RpdGxlJzogb3B0LnRpdGxlPy5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLzwvZywgJyZsdDsnKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykucmVwbGFjZSgvJy9nLCAnJmFwb3M7JyksXG5cdFx0XHQnY29udGVudHMnOiAnPGlmcmFtZSBzcmM9XCInICsgb3B0LnVybCArICdcIiBuYW1lPVwic2ltcGxlLW1vZGFsLWlmcmFtZVwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIicgKyBvcHQuaGVpZ2h0ICsgJ1wiIGZyYW1lYm9yZGVyPVwiMFwiPjwvaWZyYW1lPicsXG5cdFx0XHQnbW9kZWwnOiAnbW9kYWwnXG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wZW4gYSBUaW55TUNFIGZpbGUgYnJvd3NlciBpbiBhIG1vZGFsIHdpbmRvd1xuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZmllbGRfbmFtZSBUaGUgZmllbGQgbmFtZVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsICAgICAgICBUaGUgVVJMXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlICAgICAgIFRoZSBwaWNrZXIgdHlwZVxuXHQgKiBAcGFyYW0ge29iamVjdH0gd2luICAgICAgICBUaGUgd2luZG93IG9iamVjdFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlICAgICBUaGUgc291cmNlIHJlY29yZFxuXHQgKi9cblx0b3Blbk1vZGFsQnJvd3NlcjogZnVuY3Rpb24oZmllbGRfbmFtZSwgdXJsLCB0eXBlLCB3aW4sIHNvdXJjZSkge1xuXHRcdEJhY2tlbmQub3Blbk1vZGFsU2VsZWN0b3Ioe1xuXHRcdFx0J2lkJzogJ3RsX2xpc3RpbmcnLFxuXHRcdFx0J3RpdGxlJzogd2luLmRvY3VtZW50LmdldEVsZW1lbnQoJ2Rpdi5tY2UtdGl0bGUnKS5nZXQoJ3RleHQnKSxcblx0XHRcdCd1cmwnOiBDb250YW8ucm91dGVzLmJhY2tlbmRfcGlja2VyICsgJz9jb250ZXh0PScgKyAodHlwZSA9PSAnZmlsZScgPyAnbGluaycgOiAnZmlsZScpICsgJyZhbXA7ZXh0cmFzW2ZpZWxkVHlwZV09cmFkaW8mYW1wO2V4dHJhc1tmaWxlc09ubHldPXRydWUmYW1wO2V4dHJhc1tzb3VyY2VdPScgKyBzb3VyY2UgKyAnJmFtcDt2YWx1ZT0nICsgdXJsICsgJyZhbXA7cG9wdXA9MScsXG5cdFx0XHQnY2FsbGJhY2snOiBmdW5jdGlvbih0YWJsZSwgdmFsdWUpIHtcblx0XHRcdFx0d2luLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZpZWxkX25hbWUpLnZhbHVlID0gdmFsdWUuam9pbignLCcpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBBdXRvbWF0aWNhbGx5IHN1Ym1pdCBhIGZvcm1cblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKi9cblx0YXV0b1N1Ym1pdDogZnVuY3Rpb24oZWwpIHtcblx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cblx0XHR2YXIgaGlkZGVuID0gbmV3IEVsZW1lbnQoJ2lucHV0Jywge1xuXHRcdFx0J3R5cGUnOiAnaGlkZGVuJyxcblx0XHRcdCduYW1lJzogJ1NVQk1JVF9UWVBFJyxcblx0XHRcdCd2YWx1ZSc6ICdhdXRvJ1xuXHRcdH0pO1xuXG5cdFx0dmFyIGZvcm0gPSAkKGVsKSB8fCBlbDtcblx0XHRoaWRkZW4uaW5qZWN0KGZvcm0sICdib3R0b20nKTtcblx0XHRmb3JtLnN1Ym1pdCgpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBTY3JvbGwgdGhlIHdpbmRvdyB0byBhIGNlcnRhaW4gdmVydGljYWwgcG9zaXRpb25cblx0ICpcblx0ICogQHBhcmFtIHtpbnR9IG9mZnNldCBUaGUgb2Zmc2V0IHRvIHNjcm9sbCB0b1xuXHQgKi9cblx0dlNjcm9sbFRvOiBmdW5jdGlvbihvZmZzZXQpIHtcblx0XHRpZiAod2luZG93LmNvbnNvbGUpIHtcblx0XHRcdGNvbnNvbGUud2FybignQmFja2VuZC52U2Nyb2xsVG8oKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBTdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG5cdFx0fVxuXG5cdFx0d2luZG93LmFkZEV2ZW50KCdsb2FkJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR3aW5kb3cuc2Nyb2xsVG8obnVsbCwgcGFyc2VJbnQob2Zmc2V0KSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSBjaGVja2JveGVzXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgIFRoZSBET00gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gW2lkXSBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHR0b2dnbGVDaGVja2JveGVzOiBmdW5jdGlvbihlbCwgaWQpIHtcblx0XHR2YXIgaXRlbXMgPSAkJCgnaW5wdXQnKSxcblx0XHRcdHN0YXR1cyA9ICQoZWwpLmNoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJztcblxuXHRcdGZvciAodmFyIGk9MDsgaTxpdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKGl0ZW1zW2ldLnR5cGUudG9Mb3dlckNhc2UoKSAhPSAnY2hlY2tib3gnKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGlkICE9PSB1bmRlZmluZWQgJiYgaWQgIT0gaXRlbXNbaV0uaWQuc3Vic3RyKDAsIGlkLmxlbmd0aCkpIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cdFx0XHRpdGVtc1tpXS5jaGVja2VkID0gc3RhdHVzO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIGEgY2hlY2tib3ggZ3JvdXBcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0dG9nZ2xlQ2hlY2tib3hHcm91cDogZnVuY3Rpb24oZWwsIGlkKSB7XG5cdFx0dmFyIGNscyA9ICQoZWwpLmNsYXNzTmFtZSxcblx0XHRcdHN0YXR1cyA9ICQoZWwpLmNoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJztcblxuXHRcdGlmIChjbHMgPT0gJ3RsX2NoZWNrYm94Jykge1xuXHRcdFx0dmFyIGNieCA9ICQoaWQpID8gJCQoJyMnICsgaWQgKyAnIC50bF9jaGVja2JveCcpIDogJChlbCkuZ2V0UGFyZW50KCdmaWVsZHNldCcpLmdldEVsZW1lbnRzKCcudGxfY2hlY2tib3gnKTtcblx0XHRcdGNieC5lYWNoKGZ1bmN0aW9uKGNoZWNrYm94KSB7XG5cdFx0XHRcdGNoZWNrYm94LmNoZWNrZWQgPSBzdGF0dXM7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKGNscyA9PSAndGxfdHJlZV9jaGVja2JveCcpIHtcblx0XHRcdCQkKCcjJyArIGlkICsgJyAucGFyZW50IC50bF90cmVlX2NoZWNrYm94JykuZWFjaChmdW5jdGlvbihjaGVja2JveCkge1xuXHRcdFx0XHRjaGVja2JveC5jaGVja2VkID0gc3RhdHVzO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgY2hlY2tib3ggZWxlbWVudHNcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGVsICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGNscyBUaGUgQ1NTIGNsYXNzIG5hbWVcblx0ICovXG5cdHRvZ2dsZUNoZWNrYm94RWxlbWVudHM6IGZ1bmN0aW9uKGVsLCBjbHMpIHtcblx0XHR2YXIgc3RhdHVzID0gJChlbCkuY2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnO1xuXG5cdFx0JCQoJy4nICsgY2xzKS5lYWNoKGZ1bmN0aW9uKGNoZWNrYm94KSB7XG5cdFx0XHRpZiAoY2hlY2tib3guaGFzQ2xhc3MoJ3RsX2NoZWNrYm94JykpIHtcblx0XHRcdFx0Y2hlY2tib3guY2hlY2tlZCA9IHN0YXR1cztcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0fSxcblxuXHQvKipcblx0ICogTWFrZSBwYXJlbnQgdmlldyBpdGVtcyBzb3J0YWJsZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gdWwgVGhlIERPTSBlbGVtZW50XG5cdCAqXG5cdCAqIEBhdXRob3IgSm9lIFJheSBHcmVnb3J5XG5cdCAqIEBhdXRob3IgTWFydGluIEF1c3fDtmdlclxuXHQgKi9cblx0bWFrZVBhcmVudFZpZXdTb3J0YWJsZTogZnVuY3Rpb24odWwpIHtcblx0XHR2YXIgZHMgPSBuZXcgU2Nyb2xsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudCgnYm9keScpLCB7XG5cdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oeCwgeSkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuc2Nyb2xsVG8odGhpcy5lbGVtZW50LmdldFNjcm9sbCgpLngsIHkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dmFyIGxpc3QgPSBuZXcgU29ydGFibGVzKHVsLCB7XG5cdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRvblN0YXJ0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZHMuc3RhcnQoKTtcblx0XHRcdH0sXG5cdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZHMuc3RvcCgpO1xuXHRcdFx0fSxcblx0XHRcdG9uU29ydDogZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0dmFyIHVsID0gZWwuZ2V0UGFyZW50KCd1bCcpLFxuXHRcdFx0XHRcdHdyYXBMZXZlbCA9IDAsIGRpdnMsIGk7XG5cblx0XHRcdFx0aWYgKCF1bCkgcmV0dXJuO1xuXG5cdFx0XHRcdGRpdnMgPSB1bC5nZXRDaGlsZHJlbignbGkgPiBkaXY6Zmlyc3QtY2hpbGQnKTtcblxuXHRcdFx0XHRpZiAoIWRpdnMpIHJldHVybjtcblxuXHRcdFx0XHRmb3IgKGk9MDsgaTxkaXZzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGRpdnNbaV0uaGFzQ2xhc3MoJ3dyYXBwZXJfc3RvcCcpICYmIHdyYXBMZXZlbCA+IDApIHtcblx0XHRcdFx0XHRcdHdyYXBMZXZlbC0tO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRpdnNbaV0uY2xhc3NOYW1lID0gZGl2c1tpXS5jbGFzc05hbWUucmVwbGFjZSgvKF58XFxzKWluZGVudFteXFxzXSovZywgJycpO1xuXG5cdFx0XHRcdFx0aWYgKHdyYXBMZXZlbCA+IDApIHtcblx0XHRcdFx0XHRcdGRpdnNbaV0uYWRkQ2xhc3MoJ2luZGVudCcpLmFkZENsYXNzKCdpbmRlbnRfJyArIHdyYXBMZXZlbCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGRpdnNbaV0uaGFzQ2xhc3MoJ3dyYXBwZXJfc3RhcnQnKSkge1xuXHRcdFx0XHRcdFx0d3JhcExldmVsKys7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZGl2c1tpXS5yZW1vdmVDbGFzcygnaW5kZW50X2ZpcnN0Jyk7XG5cdFx0XHRcdFx0ZGl2c1tpXS5yZW1vdmVDbGFzcygnaW5kZW50X2xhc3QnKTtcblxuXHRcdFx0XHRcdGlmIChkaXZzW2ktMV0gJiYgZGl2c1tpLTFdLmhhc0NsYXNzKCd3cmFwcGVyX3N0YXJ0JykpIHtcblx0XHRcdFx0XHRcdGRpdnNbaV0uYWRkQ2xhc3MoJ2luZGVudF9maXJzdCcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChkaXZzW2krMV0gJiYgZGl2c1tpKzFdLmhhc0NsYXNzKCd3cmFwcGVyX3N0b3AnKSkge1xuXHRcdFx0XHRcdFx0ZGl2c1tpXS5hZGRDbGFzcygnaW5kZW50X2xhc3QnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnXG5cdFx0fSk7XG5cblx0XHRsaXN0LmFjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0bGlzdC5hZGRFdmVudCgnc3RhcnQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGxpc3QuYWN0aXZlID0gdHJ1ZTtcblx0XHR9KTtcblxuXHRcdGxpc3QuYWRkRXZlbnQoJ2NvbXBsZXRlJywgZnVuY3Rpb24oZWwpIHtcblx0XHRcdGlmICghbGlzdC5hY3RpdmUpIHJldHVybjtcblx0XHRcdHZhciBpZCwgcGlkLCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcblxuXHRcdFx0dXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3J0JywgQ29udGFvLnJlcXVlc3RfdG9rZW4pO1xuXHRcdFx0dXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2FjdCcsICdjdXQnKTtcblxuXHRcdFx0aWYgKGVsLmdldFByZXZpb3VzKCdsaScpKSB7XG5cdFx0XHRcdGlkID0gZWwuZ2V0KCdpZCcpLnJlcGxhY2UoL2xpXy8sICcnKTtcblx0XHRcdFx0cGlkID0gZWwuZ2V0UHJldmlvdXMoJ2xpJykuZ2V0KCdpZCcpLnJlcGxhY2UoL2xpXy8sICcnKTtcblx0XHRcdFx0dXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2lkJywgaWQpO1xuXHRcdFx0XHR1cmwuc2VhcmNoUGFyYW1zLnNldCgncGlkJywgcGlkKTtcblx0XHRcdFx0dXJsLnNlYXJjaFBhcmFtcy5zZXQoJ21vZGUnLCAxKTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHsndXJsJzp1cmwudG9TdHJpbmcoKSwgJ2ZvbGxvd1JlZGlyZWN0cyc6ZmFsc2V9KS5nZXQoKTtcblx0XHRcdH0gZWxzZSBpZiAoZWwuZ2V0UGFyZW50KCd1bCcpKSB7XG5cdFx0XHRcdGlkID0gZWwuZ2V0KCdpZCcpLnJlcGxhY2UoL2xpXy8sICcnKTtcblx0XHRcdFx0cGlkID0gZWwuZ2V0UGFyZW50KCd1bCcpLmdldCgnaWQnKS5yZXBsYWNlKC91bF8vLCAnJyk7XG5cdFx0XHRcdHVybC5zZWFyY2hQYXJhbXMuc2V0KCdpZCcsIGlkKTtcblx0XHRcdFx0dXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3BpZCcsIHBpZCk7XG5cdFx0XHRcdHVybC5zZWFyY2hQYXJhbXMuc2V0KCdtb2RlJywgMik7XG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7J3VybCc6dXJsLnRvU3RyaW5nKCksICdmb2xsb3dSZWRpcmVjdHMnOmZhbHNlfSkuZ2V0KCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE1ha2UgbXVsdGlTUkMgaXRlbXMgc29ydGFibGVcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkICBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBvaWQgVGhlIG9yZGVyIGZpZWxkXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB2YWwgVGhlIHZhbHVlIGZpZWxkXG5cdCAqL1xuXHRtYWtlTXVsdGlTcmNTb3J0YWJsZTogZnVuY3Rpb24oaWQsIG9pZCwgdmFsKSB7XG5cdFx0dmFyIGxpc3QgPSBuZXcgU29ydGFibGVzKCQoaWQpLCB7XG5cdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRvcGFjaXR5OiAwLjZcblx0XHR9KS5hZGRFdmVudCgnY29tcGxldGUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBlbHMgPSBbXSxcblx0XHRcdFx0bGlzID0gJChpZCkuZ2V0Q2hpbGRyZW4oJ1tkYXRhLWlkXScpLFxuXHRcdFx0XHRpO1xuXHRcdFx0Zm9yIChpPTA7IGk8bGlzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGVscy5wdXNoKGxpc1tpXS5nZXQoJ2RhdGEtaWQnKSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAob2lkID09PSB2YWwpIHtcblx0XHRcdFx0JCh2YWwpLnZhbHVlLnNwbGl0KCcsJykuZm9yRWFjaChmdW5jdGlvbihqKSB7XG5cdFx0XHRcdFx0aWYgKGVscy5pbmRleE9mKGopID09PSAtMSkge1xuXHRcdFx0XHRcdFx0ZWxzLnB1c2goaik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdCQob2lkKS52YWx1ZSA9IGVscy5qb2luKCcsJyk7XG5cdFx0fSk7XG5cdFx0JChpZCkuZ2V0RWxlbWVudHMoJy5naW1hZ2UnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRpZiAoZWwuaGFzQ2xhc3MoJ3JlbW92YWJsZScpKSB7XG5cdFx0XHRcdG5ldyBFbGVtZW50KCdidXR0b24nLCB7XG5cdFx0XHRcdFx0dHlwZTogJ2J1dHRvbicsXG5cdFx0XHRcdFx0aHRtbDogJyZ0aW1lczsnLFxuXHRcdFx0XHRcdCdjbGFzcyc6ICd0bF9yZWQnXG5cdFx0XHRcdH0pLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBsaSA9IGVsLmdldFBhcmVudCgnbGknKSxcblx0XHRcdFx0XHRcdGRpZCA9IGxpLmdldCgnZGF0YS1pZCcpO1xuXHRcdFx0XHRcdCQodmFsKS52YWx1ZSA9ICQodmFsKS52YWx1ZS5zcGxpdCgnLCcpLmZpbHRlcihmdW5jdGlvbihqKSB7IHJldHVybiBqICE9IGRpZDsgfSkuam9pbignLCcpO1xuXHRcdFx0XHRcdCQob2lkKS52YWx1ZSA9ICQob2lkKS52YWx1ZS5zcGxpdCgnLCcpLmZpbHRlcihmdW5jdGlvbihqKSB7IHJldHVybiBqICE9IGRpZDsgfSkuam9pbignLCcpO1xuXHRcdFx0XHRcdGxpLmRpc3Bvc2UoKTtcblx0XHRcdFx0fSkuaW5qZWN0KGVsLCAnYWZ0ZXInKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5ldyBFbGVtZW50KCdidXR0b24nLCB7XG5cdFx0XHRcdFx0dHlwZTogJ2J1dHRvbicsXG5cdFx0XHRcdFx0aHRtbDogJyZ0aW1lcycsXG5cdFx0XHRcdFx0ZGlzYWJsZWQ6IHRydWVcblx0XHRcdFx0fSkuaW5qZWN0KGVsLCAnYWZ0ZXInKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRsaXN0LmZpcmVFdmVudChcImNvbXBsZXRlXCIpOyAvLyBJbml0aWFsIHNvcnRpbmdcblx0fSxcblxuXHQvKipcblx0ICogRW5hYmxlIGRyYWcgYW5kIGRyb3AgZm9yIHRoZSBmaWxlIHRyZWVcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IHVsICAgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0XG5cdCAqL1xuXHRlbmFibGVGaWxlVHJlZURyYWdBbmREcm9wOiBmdW5jdGlvbih1bCwgb3B0aW9ucykge1xuXHRcdHZhciBkcyA9IG5ldyBTY3JvbGxlcihkb2N1bWVudC5nZXRFbGVtZW50KCdib2R5JyksIHtcblx0XHRcdG9uQ2hhbmdlOiBmdW5jdGlvbih4LCB5KSB7XG5cdFx0XHRcdHRoaXMuZWxlbWVudC5zY3JvbGxUbyh0aGlzLmVsZW1lbnQuZ2V0U2Nyb2xsKCkueCwgeSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR1bC5hZGRFdmVudCgnbW91c2Vkb3duJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdHZhciBkcmFnSGFuZGxlID0gZXZlbnQudGFyZ2V0Lmhhc0NsYXNzKCdkcmFnLWhhbmRsZScpID8gZXZlbnQudGFyZ2V0IDogZXZlbnQudGFyZ2V0LmdldFBhcmVudCgnLmRyYWctaGFuZGxlJyk7XG5cdFx0XHR2YXIgZHJhZ0VsZW1lbnQgPSBldmVudC50YXJnZXQuZ2V0UGFyZW50KCcudGxfZmlsZSwudGxfZm9sZGVyJyk7XG5cblx0XHRcdGlmICghZHJhZ0hhbmRsZSB8fCAhZHJhZ0VsZW1lbnQgfHwgZXZlbnQucmlnaHRDbGljaykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGRzLnN0YXJ0KCk7XG5cdFx0XHR1bC5hZGRDbGFzcygndGxfbGlzdGluZ19kcmFnZ2luZycpO1xuXG5cdFx0XHR2YXIgY2xvbmVCYXNlID0gKGRyYWdFbGVtZW50LmdldEVsZW1lbnRzKCcudGxfbGVmdCcpWzBdIHx8IGRyYWdFbGVtZW50KSxcblx0XHRcdFx0Y2xvbmUgPSBjbG9uZUJhc2UuY2xvbmUodHJ1ZSlcblx0XHRcdFx0XHQuaW5qZWN0KHVsKVxuXHRcdFx0XHRcdC5hZGRDbGFzcygndGxfbGVmdF9kcmFnZ2luZycpLFxuXHRcdFx0XHRjdXJyZW50SG92ZXIsIGN1cnJlbnRIb3ZlclRpbWUsIGV4cGFuZExpbms7XG5cblx0XHRcdGNsb25lLnNldFBvc2l0aW9uKHtcblx0XHRcdFx0eDogZXZlbnQucGFnZS54IC0gY2xvbmVCYXNlLmdldE9mZnNldFBhcmVudCgpLmdldFBvc2l0aW9uKCkueCAtIGNsb25lLmdldFNpemUoKS54LFxuXHRcdFx0XHR5OiBjbG9uZUJhc2UuZ2V0UG9zaXRpb24oY2xvbmVCYXNlLmdldE9mZnNldFBhcmVudCgpKS55XG5cdFx0XHR9KS5zZXRTdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cblx0XHRcdHZhciBtb3ZlID0gbmV3IERyYWcuTW92ZShjbG9uZSwge1xuXHRcdFx0XHRkcm9wcGFibGVzOiAkJChbdWxdKS5hcHBlbmQodWwuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXIsbGkucGFyZW50LC50bF9mb2xkZXJfdG9wJykpLFxuXHRcdFx0XHR1bkRyYWdnYWJsZVRhZ3M6IFtdLFxuXHRcdFx0XHRtb2RpZmllcnM6IHtcblx0XHRcdFx0XHR4OiAnbGVmdCcsXG5cdFx0XHRcdFx0eTogJ3RvcCdcblx0XHRcdFx0fSxcblx0XHRcdFx0b25TdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y2xvbmUuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnJyk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uRW50ZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGRyb3BwYWJsZSkge1xuXHRcdFx0XHRcdGRyb3BwYWJsZSA9IGZpeERyb3BwYWJsZShkcm9wcGFibGUpO1xuXHRcdFx0XHRcdGRyb3BwYWJsZS5hZGRDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cblx0XHRcdFx0XHRpZiAoZHJvcHBhYmxlLmhhc0NsYXNzKCd0bF9mb2xkZXInKSAmJiBjdXJyZW50SG92ZXIgIT09IGRyb3BwYWJsZSkge1xuXHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gZHJvcHBhYmxlO1xuXHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHRcdFx0XHRcdFx0ZXhwYW5kTGluayA9IGRyb3BwYWJsZS5nZXRFbGVtZW50KCdhLmZvbGRhYmxlJyk7XG5cblx0XHRcdFx0XHRcdGlmIChleHBhbmRMaW5rICYmICFleHBhbmRMaW5rLmhhc0NsYXNzKCdmb2xkYWJsZS0tb3BlbicpKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEV4cGFuZCB0aGUgZm9sZGVyIGFmdGVyIG9uZSBzZWNvbmQgaG92ZXIgdGltZVxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChjdXJyZW50SG92ZXIgPT09IGRyb3BwYWJsZSAmJiBjdXJyZW50SG92ZXJUaW1lICsgOTAwIDwgbmV3IERhdGUoKS5nZXRUaW1lKCkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdIVE1MRXZlbnRzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRldmVudC5pbml0RXZlbnQoJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRleHBhbmRMaW5rLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuYWRkRXZlbnQoJ2FqYXhfY2hhbmdlJywgZnVuY3Rpb24gb25BamF4KCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobW92ZSAmJiBtb3ZlLmRyb3BwYWJsZXMgJiYgdWwgJiYgdWwuZ2V0RWxlbWVudHMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRtb3ZlLmRyb3BwYWJsZXMgPSAkJChbdWxdKS5hcHBlbmQodWwuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXIsbGkucGFyZW50JykpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5yZW1vdmVFdmVudCgnYWpheF9jaGFuZ2UnLCBvbkFqYXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9LCAxMDAwKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uQ2FuY2VsOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IHVuZGVmaW5lZDtcblxuXHRcdFx0XHRcdGRzLnN0b3AoKTtcblx0XHRcdFx0XHRjbG9uZS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0d2luZG93LnJlbW92ZUV2ZW50KCdrZXl1cCcsIG9uS2V5dXApO1xuXHRcdFx0XHRcdHVsLmdldEVsZW1lbnRzKCcudGxfZm9sZGVyX2Ryb3BwaW5nJykucmVtb3ZlQ2xhc3MoJ3RsX2ZvbGRlcl9kcm9wcGluZycpO1xuXHRcdFx0XHRcdHVsLnJlbW92ZUNsYXNzKCd0bF9saXN0aW5nX2RyYWdnaW5nJyk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uRHJvcDogZnVuY3Rpb24oZWxlbWVudCwgZHJvcHBhYmxlKSB7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cblx0XHRcdFx0XHRkcy5zdG9wKCk7XG5cdFx0XHRcdFx0Y2xvbmUuZGVzdHJveSgpO1xuXHRcdFx0XHRcdHdpbmRvdy5yZW1vdmVFdmVudCgna2V5dXAnLCBvbktleXVwKTtcblx0XHRcdFx0XHR1bC5nZXRFbGVtZW50cygnLnRsX2ZvbGRlcl9kcm9wcGluZycpLnJlbW92ZUNsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblx0XHRcdFx0XHR1bC5yZW1vdmVDbGFzcygndGxfbGlzdGluZ19kcmFnZ2luZycpO1xuXG5cdFx0XHRcdFx0ZHJvcHBhYmxlID0gZml4RHJvcHBhYmxlKGRyb3BwYWJsZSk7XG5cblx0XHRcdFx0XHRpZiAoIWRyb3BwYWJsZSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBpZCA9IGRyYWdFbGVtZW50LmdldCgnZGF0YS1pZCcpLFxuXHRcdFx0XHRcdFx0cGlkID0gZHJvcHBhYmxlLmdldCgnZGF0YS1pZCcpIHx8IGRlY29kZVVSSUNvbXBvbmVudChvcHRpb25zLnVybC5zcGxpdCgvWz8mXXBpZD0vKVsxXS5zcGxpdCgnJicpWzBdKTtcblxuXHRcdFx0XHRcdC8vIElnbm9yZSBpbnZhbGlkIG1vdmUgb3BlcmF0aW9uc1xuXHRcdFx0XHRcdGlmIChpZCAmJiBwaWQgJiYgKChwaWQrJy8nKS5pbmRleE9mKGlkKycvJykgPT09IDAgfHwgcGlkKycvJyA9PT0gaWQucmVwbGFjZSgvW14vXSskLywgJycpKSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRkb2N1bWVudC5sb2NhdGlvbi5ocmVmID0gb3B0aW9ucy51cmwgKyAnJmlkPScgKyBlbmNvZGVVUklDb21wb25lbnQoaWQpICsgJyZwaWQ9JyArIGVuY29kZVVSSUNvbXBvbmVudChwaWQpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRvbkxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBkcm9wcGFibGUpIHtcblx0XHRcdFx0XHRkcm9wcGFibGUgPSBmaXhEcm9wcGFibGUoZHJvcHBhYmxlKTtcblx0XHRcdFx0XHRkcm9wcGFibGUucmVtb3ZlQ2xhc3MoJ3RsX2ZvbGRlcl9kcm9wcGluZycpO1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlciA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0bW92ZS5zdGFydChldmVudCk7XG5cdFx0XHR3aW5kb3cuYWRkRXZlbnQoJ2tleXVwJywgb25LZXl1cCk7XG5cblx0XHRcdGZ1bmN0aW9uIG9uS2V5dXAoZXZlbnQpIHtcblx0XHRcdFx0aWYgKGV2ZW50LmtleSA9PT0gJ2VzYycgJiYgbW92ZSAmJiBtb3ZlLnN0b3ApIHtcblx0XHRcdFx0XHRtb3ZlLmRyb3BwYWJsZXMgPSAkJChbXSk7XG5cdFx0XHRcdFx0bW92ZS5zdG9wKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGZ1bmN0aW9uIGZpeERyb3BwYWJsZShkcm9wcGFibGUpIHtcblx0XHRcdGlmIChkcm9wcGFibGUgJiYgZHJvcHBhYmxlLmhhc0NsYXNzKCdwYXJlbnQnKSAmJiBkcm9wcGFibGUuZ2V0UHJldmlvdXMoJy50bF9mb2xkZXInKSkge1xuXHRcdFx0XHRyZXR1cm4gZHJvcHBhYmxlLmdldFByZXZpb3VzKCcudGxfZm9sZGVyJyk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBkcm9wcGFibGU7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBMaXN0IHdpemFyZFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0bGlzdFdpemFyZDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgdWwgPSAkKGlkKSxcblx0XHRcdG1ha2VTb3J0YWJsZSA9IGZ1bmN0aW9uKHVsKSB7XG5cdFx0XHRcdG5ldyBTb3J0YWJsZXModWwsIHtcblx0XHRcdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRcdFx0b3BhY2l0eTogMC42LFxuXHRcdFx0XHRcdGhhbmRsZTogJy5kcmFnLWhhbmRsZSdcblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0YWRkRXZlbnRzVG8gPSBmdW5jdGlvbihsaSkge1xuXHRcdFx0XHR2YXIgY29tbWFuZCwgY2xvbmUsIGlucHV0LCBwcmV2aW91cywgbmV4dDtcblxuXHRcdFx0XHRsaS5nZXRFbGVtZW50cygnYnV0dG9uJykuZWFjaChmdW5jdGlvbihidCkge1xuXHRcdFx0XHRcdGlmIChidC5oYXNFdmVudCgnY2xpY2snKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGNvbW1hbmQgPSBidC5nZXRQcm9wZXJ0eSgnZGF0YS1jb21tYW5kJyk7XG5cblx0XHRcdFx0XHRzd2l0Y2ggKGNvbW1hbmQpIHtcblx0XHRcdFx0XHRcdGNhc2UgJ2NvcHknOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0Y2xvbmUgPSBsaS5jbG9uZSh0cnVlKS5pbmplY3QobGksICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQgPSBsaS5nZXRGaXJzdCgnaW5wdXQnKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y2xvbmUuZ2V0Rmlyc3QoJ2lucHV0JykudmFsdWUgPSBpbnB1dC52YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0YWRkRXZlbnRzVG8oY2xvbmUpO1xuXHRcdFx0XHRcdFx0XHRcdGlucHV0LnNlbGVjdCgpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHVsLmdldENoaWxkcmVuKCkubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0bGkuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSBudWxsOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZS5ldmVudC5rZXlDb2RlID09IDM4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAocHJldmlvdXMgPSBsaS5nZXRQcmV2aW91cygnbGknKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsaS5pbmplY3QocHJldmlvdXMsICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpLmluamVjdCh1bCwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGUuZXZlbnQua2V5Q29kZSA9PSA0MCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG5leHQgPSBsaS5nZXROZXh0KCdsaScpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpLmluamVjdChuZXh0LCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpLmluamVjdCh1bC5nZXRGaXJzdCgnbGknKSwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdG1ha2VTb3J0YWJsZSh1bCk7XG5cblx0XHR1bC5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24obGkpIHtcblx0XHRcdGFkZEV2ZW50c1RvKGxpKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogVGFibGUgd2l6YXJkXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHR0YWJsZVdpemFyZDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgdGFibGUgPSAkKGlkKSxcblx0XHRcdHRoZWFkID0gdGFibGUuZ2V0RWxlbWVudCgndGhlYWQnKSxcblx0XHRcdHRib2R5ID0gdGFibGUuZ2V0RWxlbWVudCgndGJvZHknKSxcblx0XHRcdG1ha2VTb3J0YWJsZSA9IGZ1bmN0aW9uKHRib2R5KSB7XG5cdFx0XHRcdHZhciByb3dzID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKSxcblx0XHRcdFx0XHR0ZXh0YXJlYSwgY2hpbGRyZW4sIGksIGo7XG5cblx0XHRcdFx0Zm9yIChpPTA7IGk8cm93cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGNoaWxkcmVuID0gcm93c1tpXS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdGZvciAoaj0wOyBqPGNoaWxkcmVuLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0XHRpZiAodGV4dGFyZWEgPSBjaGlsZHJlbltqXS5nZXRGaXJzdCgndGV4dGFyZWEnKSkge1xuXHRcdFx0XHRcdFx0XHR0ZXh0YXJlYS5uYW1lID0gdGV4dGFyZWEubmFtZS5yZXBsYWNlKC9cXFtbMC05XStdW1swLTldK10vZywgJ1snICsgaSArICddWycgKyBqICsgJ10nKVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG5ldyBTb3J0YWJsZXModGJvZHksIHtcblx0XHRcdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRcdFx0b3BhY2l0eTogMC42LFxuXHRcdFx0XHRcdGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG5cdFx0XHRcdFx0b25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0YWRkRXZlbnRzVG8gPSBmdW5jdGlvbih0cikge1xuXHRcdFx0XHR2YXIgaGVhZCA9IHRoZWFkLmdldEZpcnN0KCd0cicpLFxuXHRcdFx0XHRcdGNvbW1hbmQsIHRleHRhcmVhLCBjdXJyZW50LCBuZXh0LCBudHIsIGNoaWxkcmVuLCBpbmRleCwgaTtcblxuXHRcdFx0XHR0ci5nZXRFbGVtZW50cygnYnV0dG9uJykuZWFjaChmdW5jdGlvbihidCkge1xuXHRcdFx0XHRcdGlmIChidC5oYXNFdmVudCgnY2xpY2snKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGNvbW1hbmQgPSBidC5nZXRQcm9wZXJ0eSgnZGF0YS1jb21tYW5kJyk7XG5cblx0XHRcdFx0XHRzd2l0Y2ggKGNvbW1hbmQpIHtcblx0XHRcdFx0XHRcdGNhc2UgJ3Jjb3B5Jzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdG50ciA9IG5ldyBFbGVtZW50KCd0cicpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdHIuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0bmV4dCA9IGNoaWxkcmVuW2ldLmNsb25lKHRydWUpLmluamVjdChudHIsICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0ZXh0YXJlYSA9IGNoaWxkcmVuW2ldLmdldEZpcnN0KCd0ZXh0YXJlYScpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG5leHQuZ2V0Rmlyc3QoJ3RleHRhcmVhJykudmFsdWUgPSB0ZXh0YXJlYS52YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bnRyLmluamVjdCh0ciwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0YWRkRXZlbnRzVG8obnRyKTtcblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdG50ci5nZXRGaXJzdCgndGQnKS5nZXRGaXJzdCgndGV4dGFyZWEnKS5zZWxlY3QoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAncmRlbGV0ZSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGJvZHkuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0ci5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2Njb3B5Jzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGluZGV4ID0gZ2V0SW5kZXgoYnQpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IGNoaWxkcmVuW2ldLmdldENoaWxkcmVuKClbaW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0bmV4dCA9IGN1cnJlbnQuY2xvbmUodHJ1ZSkuaW5qZWN0KGN1cnJlbnQsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRleHRhcmVhID0gY3VycmVudC5nZXRGaXJzdCgndGV4dGFyZWEnKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRuZXh0LmdldEZpcnN0KCd0ZXh0YXJlYScpLnZhbHVlID0gdGV4dGFyZWEudmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRhZGRFdmVudHNUbyhuZXh0KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGhlYWRGaXJzdCA9IGhlYWQuZ2V0Rmlyc3QoJ3RkJyk7XG5cdFx0XHRcdFx0XHRcdFx0bmV4dCA9IGhlYWRGaXJzdC5jbG9uZSh0cnVlKS5pbmplY3QoaGVhZC5nZXRMYXN0KCd0ZCcpLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0YWRkRXZlbnRzVG8obmV4dCk7XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlblswXS5nZXRDaGlsZHJlbigpW2luZGV4ICsgMV0uZ2V0Rmlyc3QoJ3RleHRhcmVhJykuc2VsZWN0KCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2Ntb3ZlbCc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpbmRleCA9IGdldEluZGV4KGJ0KTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRib2R5LmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGluZGV4ID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IGNoaWxkcmVuW2ldLmdldENoaWxkcmVuKClbaW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50LmluamVjdChjdXJyZW50LmdldFByZXZpb3VzKCksICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IGNoaWxkcmVuW2ldLmdldENoaWxkcmVuKClbaW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50LmluamVjdChjaGlsZHJlbltpXS5nZXRMYXN0KCksICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnY21vdmVyJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGluZGV4ID0gZ2V0SW5kZXgoYnQpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoaW5kZXggPCAodHIuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggLSAyKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IGNoaWxkcmVuW2ldLmdldENoaWxkcmVuKClbaW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50LmluamVjdChjdXJyZW50LmdldE5leHQoKSwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQgPSBjaGlsZHJlbltpXS5nZXRDaGlsZHJlbigpW2luZGV4XTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudC5pbmplY3QoY2hpbGRyZW5baV0uZ2V0Rmlyc3QoKSwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdjZGVsZXRlJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGluZGV4ID0gZ2V0SW5kZXgoYnQpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodHIuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggPiAyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbltpXS5nZXRDaGlsZHJlbigpW2luZGV4XS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRoZWFkLmdldEZpcnN0KCd0ZCcpLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSBudWxsOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZS5ldmVudC5rZXlDb2RlID09IDM4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobnRyID0gdHIuZ2V0UHJldmlvdXMoJ3RyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KG50ciwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KHRib2R5LCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGUuZXZlbnQua2V5Q29kZSA9PSA0MCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG50ciA9IHRyLmdldE5leHQoJ3RyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KG50ciwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QodGJvZHksICd0b3AnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0Z2V0SW5kZXggPSBmdW5jdGlvbihidCkge1xuXHRcdFx0XHR2YXIgdGQgPSAkKGJ0KS5nZXRQYXJlbnQoJ3RkJyksXG5cdFx0XHRcdFx0dHIgPSB0ZC5nZXRQYXJlbnQoJ3RyJyksXG5cdFx0XHRcdFx0Y29scyA9IHRyLmdldENoaWxkcmVuKCksXG5cdFx0XHRcdFx0aW5kZXggPSAwLCBpO1xuXG5cdFx0XHRcdGZvciAoaT0wOyBpPGNvbHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAoY29sc1tpXSA9PSB0ZCkge1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gaW5kZXg7XG5cdFx0XHR9O1xuXG5cdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblxuXHRcdHRoZWFkLmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbih0cikge1xuXHRcdFx0YWRkRXZlbnRzVG8odHIpO1xuXHRcdH0pO1xuXG5cdFx0dGJvZHkuZ2V0Q2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRhZGRFdmVudHNUbyh0cik7XG5cdFx0fSk7XG5cblx0XHRCYWNrZW5kLnRhYmxlV2l6YXJkUmVzaXplKCk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFJlc2l6ZSB0aGUgdGFibGUgd2l6YXJkIGZpZWxkcyBvbiBmb2N1c1xuXHQgKlxuXHQgKiBAcGFyYW0ge2Zsb2F0fSBbZmFjdG9yXSBUaGUgcmVzaXplIGZhY3RvclxuXHQgKi9cblx0dGFibGVXaXphcmRSZXNpemU6IGZ1bmN0aW9uKGZhY3Rvcikge1xuXHRcdHZhciBzaXplID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjb250YW9fdGFibGVfd2l6YXJkX2NlbGxfc2l6ZScpO1xuXG5cdFx0aWYgKGZhY3RvciAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRzaXplID0gJyc7XG5cdFx0XHQkJCgnLnRsX3RhYmxld2l6YXJkIHRleHRhcmVhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRlbC5zZXRTdHlsZSgnd2lkdGgnLCAoZWwuZ2V0U3R5bGUoJ3dpZHRoJykudG9JbnQoKSAqIGZhY3Rvcikucm91bmQoKS5saW1pdCgxNDIsIDI4NCkpO1xuXHRcdFx0XHRlbC5zZXRTdHlsZSgnaGVpZ2h0JywgKGVsLmdldFN0eWxlKCdoZWlnaHQnKS50b0ludCgpICogZmFjdG9yKS5yb3VuZCgpLmxpbWl0KDY2LCAxMzIpKTtcblx0XHRcdFx0aWYgKHNpemUgPT0gJycpIHtcblx0XHRcdFx0XHRzaXplID0gZWwuZ2V0U3R5bGUoJ3dpZHRoJykgKyAnfCcgKyBlbC5nZXRTdHlsZSgnaGVpZ2h0Jyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjb250YW9fdGFibGVfd2l6YXJkX2NlbGxfc2l6ZScsIHNpemUpO1xuXHRcdH0gZWxzZSBpZiAoc2l6ZSAhPT0gbnVsbCkge1xuXHRcdFx0dmFyIGNodW5rcyA9IHNpemUuc3BsaXQoJ3wnKTtcblx0XHRcdCQkKCcudGxfdGFibGV3aXphcmQgdGV4dGFyZWEnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdGVsLnNldFN0eWxlKCd3aWR0aCcsIGNodW5rc1swXSk7XG5cdFx0XHRcdGVsLnNldFN0eWxlKCdoZWlnaHQnLCBjaHVua3NbMV0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBTZXQgdGhlIHdpZHRoIG9mIHRoZSB0YWJsZSB3aXphcmRcblx0ICovXG5cdHRhYmxlV2l6YXJkU2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB3cmFwID0gJCgndGxfdGFibGV3aXphcmQnKTtcblx0XHRpZiAoIXdyYXApIHJldHVybjtcblx0XHR3cmFwLnNldFN0eWxlKCd3aWR0aCcsIE1hdGgucm91bmQod3JhcC5nZXRQYXJlbnQoJy50bF9mb3JtYm9keV9lZGl0JykuZ2V0Q29tcHV0ZWRTaXplKCkud2lkdGggKiAwLjk2KSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wdGlvbnMgd2l6YXJkXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHRvcHRpb25zV2l6YXJkOiBmdW5jdGlvbihpZCkge1xuXHRcdHZhciB0YWJsZSA9ICQoaWQpLFxuXHRcdFx0dGJvZHkgPSB0YWJsZS5nZXRFbGVtZW50KCd0Ym9keScpLFxuXHRcdFx0bWFrZVNvcnRhYmxlID0gZnVuY3Rpb24odGJvZHkpIHtcblx0XHRcdFx0dmFyIHJvd3MgPSB0Ym9keS5nZXRDaGlsZHJlbigpLFxuXHRcdFx0XHRcdGNoaWxkcmVuLCBpLCBqLCBpbnB1dDtcblxuXHRcdFx0XHRmb3IgKGk9MDsgaTxyb3dzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Y2hpbGRyZW4gPSByb3dzW2ldLmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0Zm9yIChqPTA7IGo8Y2hpbGRyZW4ubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdGlmIChpbnB1dCA9IGNoaWxkcmVuW2pdLmdldEZpcnN0KCdpbnB1dCcpKSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0Lm5hbWUgPSBpbnB1dC5uYW1lLnJlcGxhY2UoL1xcW1swLTldK10vZywgJ1snICsgaSArICddJyk7XG5cdFx0XHRcdFx0XHRcdGlmIChpbnB1dC50eXBlID09ICdjaGVja2JveCcpIHtcblx0XHRcdFx0XHRcdFx0XHRpbnB1dC5pZCA9IGlucHV0Lm5hbWUucmVwbGFjZSgvXFxbWzAtOV0rXS9nLCAnJykucmVwbGFjZSgvXFxbL2csICdfJykucmVwbGFjZSgvXS9nLCAnJykgKyAnXycgKyBpO1xuXHRcdFx0XHRcdFx0XHRcdGlucHV0LmdldE5leHQoJ2xhYmVsJykuc2V0KCdmb3InLCBpbnB1dC5pZCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRuZXcgU29ydGFibGVzKHRib2R5LCB7XG5cdFx0XHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0XHRcdG9wYWNpdHk6IDAuNixcblx0XHRcdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuXHRcdFx0XHRcdG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdGFkZEV2ZW50c1RvID0gZnVuY3Rpb24odHIpIHtcblx0XHRcdFx0dmFyIGNvbW1hbmQsIGlucHV0LCBuZXh0LCBudHIsIGNoaWxkcmVuLCBpO1xuXHRcdFx0XHR0ci5nZXRFbGVtZW50cygnYnV0dG9uJykuZWFjaChmdW5jdGlvbihidCkge1xuXHRcdFx0XHRcdGlmIChidC5oYXNFdmVudCgnY2xpY2snKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGNvbW1hbmQgPSBidC5nZXRQcm9wZXJ0eSgnZGF0YS1jb21tYW5kJyk7XG5cblx0XHRcdFx0XHRzd2l0Y2ggKGNvbW1hbmQpIHtcblx0XHRcdFx0XHRcdGNhc2UgJ2NvcHknOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0bnRyID0gbmV3IEVsZW1lbnQoJ3RyJyk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0ci5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXh0ID0gY2hpbGRyZW5baV0uY2xvbmUodHJ1ZSkuaW5qZWN0KG50ciwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGlucHV0ID0gY2hpbGRyZW5baV0uZ2V0Rmlyc3QoJ2lucHV0JykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmV4dC5nZXRGaXJzdCgnaW5wdXQnKS52YWx1ZSA9IGlucHV0LnZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQudHlwZSA9PSAnY2hlY2tib3gnKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bmV4dC5nZXRGaXJzdCgnaW5wdXQnKS5jaGVja2VkID0gaW5wdXQuY2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG50ci5pbmplY3QodHIsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdGFkZEV2ZW50c1RvKG50cik7XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHRudHIuZ2V0Rmlyc3QoJ3RkJykuZ2V0Rmlyc3QoJ2lucHV0Jykuc2VsZWN0KCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGJvZHkuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0ci5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgbnVsbDpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGUuZXZlbnQua2V5Q29kZSA9PSAzOCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG50ciA9IHRyLmdldFByZXZpb3VzKCd0cicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdChudHIsICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdCh0Ym9keSwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChlLmV2ZW50LmtleUNvZGUgPT0gNDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChudHIgPSB0ci5nZXROZXh0KCd0cicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdChudHIsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KHRib2R5LCAndG9wJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cblx0XHR0Ym9keS5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24odHIpIHtcblx0XHRcdGFkZEV2ZW50c1RvKHRyKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogS2V5L3ZhbHVlIHdpemFyZFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0a2V5VmFsdWVXaXphcmQ6IGZ1bmN0aW9uKGlkKSB7XG5cdFx0dmFyIHRhYmxlID0gJChpZCksXG5cdFx0XHR0Ym9keSA9IHRhYmxlLmdldEVsZW1lbnQoJ3Rib2R5JyksXG5cdFx0XHRtYWtlU29ydGFibGUgPSBmdW5jdGlvbih0Ym9keSkge1xuXHRcdFx0XHR2YXIgcm93cyA9IHRib2R5LmdldENoaWxkcmVuKCksXG5cdFx0XHRcdFx0Y2hpbGRyZW4sIGksIGosIGlucHV0O1xuXG5cdFx0XHRcdGZvciAoaT0wOyBpPHJvd3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRjaGlsZHJlbiA9IHJvd3NbaV0uZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRmb3IgKGo9MDsgajxjaGlsZHJlbi5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0aWYgKGlucHV0ID0gY2hpbGRyZW5bal0uZ2V0Rmlyc3QoJ2lucHV0JykpIHtcblx0XHRcdFx0XHRcdFx0aW5wdXQubmFtZSA9IGlucHV0Lm5hbWUucmVwbGFjZSgvXFxbWzAtOV0rXS9nLCAnWycgKyBpICsgJ10nKVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG5ldyBTb3J0YWJsZXModGJvZHksIHtcblx0XHRcdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRcdFx0b3BhY2l0eTogMC42LFxuXHRcdFx0XHRcdGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG5cdFx0XHRcdFx0b25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0YWRkRXZlbnRzVG8gPSBmdW5jdGlvbih0cikge1xuXHRcdFx0XHR2YXIgY29tbWFuZCwgaW5wdXQsIG5leHQsIG50ciwgY2hpbGRyZW4sIGk7XG5cdFx0XHRcdHRyLmdldEVsZW1lbnRzKCdidXR0b24nKS5lYWNoKGZ1bmN0aW9uKGJ0KSB7XG5cdFx0XHRcdFx0aWYgKGJ0Lmhhc0V2ZW50KCdjbGljaycpKSByZXR1cm47XG5cdFx0XHRcdFx0Y29tbWFuZCA9IGJ0LmdldFByb3BlcnR5KCdkYXRhLWNvbW1hbmQnKTtcblxuXHRcdFx0XHRcdHN3aXRjaCAoY29tbWFuZCkge1xuXHRcdFx0XHRcdFx0Y2FzZSAnY29weSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRudHIgPSBuZXcgRWxlbWVudCgndHInKTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRyLmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdG5leHQgPSBjaGlsZHJlbltpXS5jbG9uZSh0cnVlKS5pbmplY3QobnRyLCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQgPSBjaGlsZHJlbltpXS5nZXRGaXJzdCgnaW5wdXQnKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRuZXh0LmdldEZpcnN0KCkudmFsdWUgPSBpbnB1dC52YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bnRyLmluamVjdCh0ciwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0YWRkRXZlbnRzVG8obnRyKTtcblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdG50ci5nZXRGaXJzdCgndGQnKS5nZXRGaXJzdCgnaW5wdXQnKS5zZWxlY3QoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0Ym9keS5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSBudWxsOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZS5ldmVudC5rZXlDb2RlID09IDM4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobnRyID0gdHIuZ2V0UHJldmlvdXMoJ3RyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KG50ciwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KHRib2R5LCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGUuZXZlbnQua2V5Q29kZSA9PSA0MCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG50ciA9IHRyLmdldE5leHQoJ3RyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KG50ciwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QodGJvZHksICd0b3AnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9O1xuXG5cdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblxuXHRcdHRib2R5LmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbih0cikge1xuXHRcdFx0YWRkRXZlbnRzVG8odHIpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBDaGVja2JveCB3aXphcmRcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICovXG5cdGNoZWNrYm94V2l6YXJkOiBmdW5jdGlvbihpZCkge1xuXHRcdHZhciBjb250YWluZXIgPSAkKGlkKS5nZXRFbGVtZW50KCcuc29ydGFibGUnKSxcblx0XHRcdG1ha2VTb3J0YWJsZSA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xuXHRcdFx0XHRuZXcgU29ydGFibGVzKGNvbnRhaW5lciwge1xuXHRcdFx0XHRcdGNvbnN0cmFpbjogdHJ1ZSxcblx0XHRcdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRcdFx0aGFuZGxlOiAnLmRyYWctaGFuZGxlJ1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRhZGRFdmVudHNUbyA9IGZ1bmN0aW9uKHNwYW4pIHtcblx0XHRcdFx0dmFyIG5zcGFuO1xuXHRcdFx0XHRzcGFuLmdldEVsZW1lbnRzKCdidXR0b24nKS5lYWNoKGZ1bmN0aW9uKGJ0KSB7XG5cdFx0XHRcdFx0aWYgKGJ0Lmhhc0V2ZW50KCdjbGljaycpKSByZXR1cm47XG5cdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRpZiAoZS5ldmVudC5rZXlDb2RlID09IDM4KSB7XG5cdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0aWYgKChuc3BhbiA9IHNwYW4uZ2V0UHJldmlvdXMoJ3NwYW4nKSkpIHtcblx0XHRcdFx0XHRcdFx0XHRzcGFuLmluamVjdChuc3BhbiwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdHNwYW4uaW5qZWN0KGNvbnRhaW5lciwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGUuZXZlbnQua2V5Q29kZSA9PSA0MCkge1xuXHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdGlmIChuc3BhbiA9IHNwYW4uZ2V0TmV4dCgnc3BhbicpKSB7XG5cdFx0XHRcdFx0XHRcdFx0c3Bhbi5pbmplY3QobnNwYW4sICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdHNwYW4uaW5qZWN0KGNvbnRhaW5lciwgJ3RvcCcpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdG1ha2VTb3J0YWJsZShjb250YWluZXIpO1xuXG5cdFx0Y29udGFpbmVyLmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbihzcGFuKSB7XG5cdFx0XHRhZGRFdmVudHNUbyhzcGFuKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogVXBkYXRlIHRoZSBmaWVsZHMgb2YgdGhlIGltYWdlU2l6ZSB3aWRnZXQgdXBvbiBjaGFuZ2Vcblx0ICovXG5cdGVuYWJsZUltYWdlU2l6ZVdpZGdldHM6IGZ1bmN0aW9uKCkge1xuXHRcdCQkKCcudGxfaW1hZ2Vfc2l6ZScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdHZhciBzZWxlY3QgPSBlbC5nZXRFbGVtZW50KCdzZWxlY3QnKSxcblx0XHRcdFx0d2lkdGhJbnB1dCA9IGVsLmdldENoaWxkcmVuKCdpbnB1dCcpWzBdLFxuXHRcdFx0XHRoZWlnaHRJbnB1dCA9IGVsLmdldENoaWxkcmVuKCdpbnB1dCcpWzFdLFxuXHRcdFx0XHR1cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoc2VsZWN0LmdldCgndmFsdWUnKSA9PT0gJycgfHwgc2VsZWN0LmdldCgndmFsdWUnKS5pbmRleE9mKCdfJykgPT09IDAgfHwgc2VsZWN0LmdldCgndmFsdWUnKS50b0ludCgpLnRvU3RyaW5nKCkgPT09IHNlbGVjdC5nZXQoJ3ZhbHVlJykpIHtcblx0XHRcdFx0XHRcdHdpZHRoSW5wdXQucmVhZE9ubHkgPSB0cnVlO1xuXHRcdFx0XHRcdFx0aGVpZ2h0SW5wdXQucmVhZE9ubHkgPSB0cnVlO1xuXHRcdFx0XHRcdFx0dmFyIGRpbWVuc2lvbnMgPSAkKHNlbGVjdC5nZXRTZWxlY3RlZCgpWzBdKS5nZXQoJ3RleHQnKTtcblx0XHRcdFx0XHRcdGRpbWVuc2lvbnMgPSBkaW1lbnNpb25zLnNwbGl0KCcoJykubGVuZ3RoID4gMVxuXHRcdFx0XHRcdFx0XHQ/IGRpbWVuc2lvbnMuc3BsaXQoJygnKS5nZXRMYXN0KCkuc3BsaXQoJyknKVswXS5zcGxpdCgneCcpXG5cdFx0XHRcdFx0XHRcdDogWycnLCAnJ107XG5cdFx0XHRcdFx0XHR3aWR0aElucHV0LnNldCgndmFsdWUnLCAnJykuc2V0KCdwbGFjZWhvbGRlcicsIGRpbWVuc2lvbnNbMF0gKiAxIHx8ICcnKTtcblx0XHRcdFx0XHRcdGhlaWdodElucHV0LnNldCgndmFsdWUnLCAnJykuc2V0KCdwbGFjZWhvbGRlcicsIGRpbWVuc2lvbnNbMV0gKiAxIHx8ICcnKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0d2lkdGhJbnB1dC5zZXQoJ3BsYWNlaG9sZGVyJywgJycpO1xuXHRcdFx0XHRcdFx0aGVpZ2h0SW5wdXQuc2V0KCdwbGFjZWhvbGRlcicsICcnKTtcblx0XHRcdFx0XHRcdHdpZHRoSW5wdXQucmVhZE9ubHkgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGhlaWdodElucHV0LnJlYWRPbmx5ID0gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHQ7XG5cblx0XHRcdHVwZGF0ZSgpO1xuXHRcdFx0c2VsZWN0LmFkZEV2ZW50KCdjaGFuZ2UnLCB1cGRhdGUpO1xuXHRcdFx0c2VsZWN0LmFkZEV2ZW50KCdrZXl1cCcsIHVwZGF0ZSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEFsbG93IHRvZ2dsaW5nIGNoZWNrYm94ZXMgb3IgcmFkaW8gYnV0dG9ucyBieSBjbGlja2luZyBhIHJvd1xuXHQgKlxuXHQgKiBAYXV0aG9yIEthbWlsIEt1em1pbnNraVxuXHQgKi9cblx0ZW5hYmxlVG9nZ2xlU2VsZWN0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY29udGFpbmVyID0gJCgndGxfbGlzdGluZycpLFxuXHRcdFx0c2hpZnRUb2dnbGUgPSBmdW5jdGlvbihlbCkge1xuXHRcdFx0XHR0aGlzSW5kZXggPSBjaGVja2JveGVzLmluZGV4T2YoZWwpO1xuXHRcdFx0XHRzdGFydEluZGV4ID0gY2hlY2tib3hlcy5pbmRleE9mKHN0YXJ0KTtcblx0XHRcdFx0ZnJvbSA9IE1hdGgubWluKHRoaXNJbmRleCwgc3RhcnRJbmRleCk7XG5cdFx0XHRcdHRvID0gTWF0aC5tYXgodGhpc0luZGV4LCBzdGFydEluZGV4KTtcblx0XHRcdFx0c3RhdHVzID0gISFjaGVja2JveGVzW3N0YXJ0SW5kZXhdLmNoZWNrZWQ7XG5cblx0XHRcdFx0Zm9yIChmcm9tOyBmcm9tPD10bzsgZnJvbSsrKSB7XG5cdFx0XHRcdFx0Y2hlY2tib3hlc1tmcm9tXS5jaGVja2VkID0gc3RhdHVzO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0Y2xpY2tFdmVudCA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0aWYgKGUudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCB8fCBlLnRhcmdldCBpbnN0YW5jZW9mIEhUTUxBbmNob3JFbGVtZW50IHx8IGUudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEJ1dHRvbkVsZW1lbnQpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgaW5wdXQgPSB0aGlzLmdldEVsZW1lbnQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXSxpbnB1dFt0eXBlPVwicmFkaW9cIl0nKSxcblx0XHRcdFx0XHRsaW1pdFRvZ2dsZXIgPSAkKGUudGFyZ2V0KS5nZXRQYXJlbnQoJy5saW1pdF90b2dnbGVyJyk7XG5cblx0XHRcdFx0aWYgKCFpbnB1dCB8fCBpbnB1dC5nZXQoJ2Rpc2FibGVkJykgfHwgbGltaXRUb2dnbGVyICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmFkaW8gYnV0dG9uc1xuXHRcdFx0XHRpZiAoaW5wdXQudHlwZSA9PSAncmFkaW8nKSB7XG5cdFx0XHRcdFx0aWYgKCFpbnB1dC5jaGVja2VkKSB7XG5cdFx0XHRcdFx0XHRpbnB1dC5jaGVja2VkID0gJ2NoZWNrZWQnO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrYm94ZXNcblx0XHRcdFx0aWYgKGUuc2hpZnQgJiYgc3RhcnQpIHtcblx0XHRcdFx0XHRzaGlmdFRvZ2dsZShpbnB1dCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aW5wdXQuY2hlY2tlZCA9IGlucHV0LmNoZWNrZWQgPyAnJyA6ICdjaGVja2VkJztcblxuXHRcdFx0XHRcdGlmIChpbnB1dC5nZXQoJ29uY2xpY2snKSA9PSAnQmFja2VuZC50b2dnbGVDaGVja2JveGVzKHRoaXMpJykge1xuXHRcdFx0XHRcdFx0QmFja2VuZC50b2dnbGVDaGVja2JveGVzKGlucHV0KTsgLy8gc2VlICM2Mzk5XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3RhcnQgPSBpbnB1dDtcblx0XHRcdH0sXG5cdFx0XHRjaGVja2JveGVzID0gW10sIHN0YXJ0LCB0aGlzSW5kZXgsIHN0YXJ0SW5kZXgsIHN0YXR1cywgZnJvbSwgdG87XG5cblx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0XHRjaGVja2JveGVzID0gY29udGFpbmVyLmdldEVsZW1lbnRzKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcblx0XHR9XG5cblx0XHQvLyBSb3cgY2xpY2tcblx0XHQkJCgnLnRvZ2dsZV9zZWxlY3QnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHR2YXIgYm91bmRFdmVudCA9IGVsLnJldHJpZXZlKCdib3VuZEV2ZW50Jyk7XG5cblx0XHRcdGlmIChib3VuZEV2ZW50KSB7XG5cdFx0XHRcdGVsLnJlbW92ZUV2ZW50KCdjbGljaycsIGJvdW5kRXZlbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEbyBub3QgcHJvcGFnYXRlIHRoZSBmb3JtIGZpZWxkIGNsaWNrIGV2ZW50c1xuXHRcdFx0ZWwuZ2V0RWxlbWVudHMoJ2xhYmVsLGlucHV0W3R5cGU9XCJjaGVja2JveFwiXSxpbnB1dFt0eXBlPVwicmFkaW9cIl0nKS5lYWNoKGZ1bmN0aW9uKGkpIHtcblx0XHRcdFx0aS5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ym91bmRFdmVudCA9IGNsaWNrRXZlbnQuYmluZChlbCk7XG5cblx0XHRcdGVsLmFkZEV2ZW50KCdjbGljaycsIGJvdW5kRXZlbnQpO1xuXHRcdFx0ZWwuc3RvcmUoJ2JvdW5kRXZlbnQnLCBib3VuZEV2ZW50KTtcblx0XHR9KTtcblxuXHRcdC8vIENoZWNrYm94IGNsaWNrXG5cdFx0Y2hlY2tib3hlcy5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRlbC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGlmIChlLnNoaWZ0ICYmIHN0YXJ0KSB7XG5cdFx0XHRcdFx0c2hpZnRUb2dnbGUodGhpcyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzdGFydCA9IHRoaXM7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogQWxsb3cgdG8gbWFyayB0aGUgaW1wb3J0YW50IHBhcnQgb2YgYW4gaW1hZ2Vcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKi9cblx0ZWRpdFByZXZpZXdXaXphcmQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0ZWwgPSAkKGVsKTtcblx0XHR2YXIgaW1hZ2VFbGVtZW50ID0gZWwuZ2V0RWxlbWVudCgnaW1nJyksXG5cdFx0XHRpbnB1dEVsZW1lbnRzID0ge30sXG5cdFx0XHRpc0RyYXdpbmcgPSBmYWxzZSxcblx0XHRcdHBhcnRFbGVtZW50LCBzdGFydFBvcyxcblx0XHRcdGdldFNjYWxlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0eDogaW1hZ2VFbGVtZW50LmdldENvbXB1dGVkU2l6ZSgpLndpZHRoLFxuXHRcdFx0XHRcdHk6IGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKS5oZWlnaHRcblx0XHRcdFx0fTtcblx0XHRcdH0sXG5cdFx0XHR1cGRhdGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgc2NhbGUgPSBnZXRTY2FsZSgpLFxuXHRcdFx0XHRcdGltYWdlU2l6ZSA9IGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKTtcblx0XHRcdFx0cGFydEVsZW1lbnQuc2V0U3R5bGVzKHtcblx0XHRcdFx0XHR0b3A6IGltYWdlU2l6ZS5jb21wdXRlZFRvcCArIChpbnB1dEVsZW1lbnRzLnkuZ2V0KCd2YWx1ZScpICogc2NhbGUueSkucm91bmQoKSArICdweCcsXG5cdFx0XHRcdFx0bGVmdDogaW1hZ2VTaXplLmNvbXB1dGVkTGVmdCArIChpbnB1dEVsZW1lbnRzLnguZ2V0KCd2YWx1ZScpICogc2NhbGUueCkucm91bmQoKSArICdweCcsXG5cdFx0XHRcdFx0d2lkdGg6IChpbnB1dEVsZW1lbnRzLndpZHRoLmdldCgndmFsdWUnKSAqIHNjYWxlLngpLnJvdW5kKCkgKyAncHgnLFxuXHRcdFx0XHRcdGhlaWdodDogKGlucHV0RWxlbWVudHMuaGVpZ2h0LmdldCgndmFsdWUnKSAqIHNjYWxlLnkpLnJvdW5kKCkgKyAncHgnXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoIWlucHV0RWxlbWVudHMud2lkdGguZ2V0KCd2YWx1ZScpLnRvRmxvYXQoKSB8fCAhaW5wdXRFbGVtZW50cy5oZWlnaHQuZ2V0KCd2YWx1ZScpLnRvRmxvYXQoKSkge1xuXHRcdFx0XHRcdHBhcnRFbGVtZW50LnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwYXJ0RWxlbWVudC5zZXRTdHlsZSgnZGlzcGxheScsIG51bGwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0dXBkYXRlVmFsdWVzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzY2FsZSA9IGdldFNjYWxlKCksXG5cdFx0XHRcdFx0c3R5bGVzID0gcGFydEVsZW1lbnQuZ2V0U3R5bGVzKCd0b3AnLCAnbGVmdCcsICd3aWR0aCcsICdoZWlnaHQnKSxcblx0XHRcdFx0XHRpbWFnZVNpemUgPSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCksXG5cdFx0XHRcdFx0dmFsdWVzID0ge1xuXHRcdFx0XHRcdFx0eDogTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHN0eWxlcy5sZWZ0LnRvRmxvYXQoKSAtIGltYWdlU2l6ZS5jb21wdXRlZExlZnQpIC8gc2NhbGUueCkpLFxuXHRcdFx0XHRcdFx0eTogTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHN0eWxlcy50b3AudG9GbG9hdCgpIC0gaW1hZ2VTaXplLmNvbXB1dGVkVG9wKSAvIHNjYWxlLnkpKVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdHZhbHVlcy53aWR0aCA9IE1hdGgubWluKDEgLSB2YWx1ZXMueCwgc3R5bGVzLndpZHRoLnRvRmxvYXQoKSAvIHNjYWxlLngpO1xuXHRcdFx0XHR2YWx1ZXMuaGVpZ2h0ID0gTWF0aC5taW4oMSAtIHZhbHVlcy55LCBzdHlsZXMuaGVpZ2h0LnRvRmxvYXQoKSAvIHNjYWxlLnkpO1xuXHRcdFx0XHRpZiAoIXZhbHVlcy53aWR0aCB8fCAhdmFsdWVzLmhlaWdodCkge1xuXHRcdFx0XHRcdHZhbHVlcy54ID0gdmFsdWVzLnkgPSB2YWx1ZXMud2lkdGggPSB2YWx1ZXMuaGVpZ2h0ID0gJyc7XG5cdFx0XHRcdFx0cGFydEVsZW1lbnQuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBhcnRFbGVtZW50LnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0T2JqZWN0LmVhY2godmFsdWVzLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdFx0XHRcdFx0aW5wdXRFbGVtZW50c1trZXldLnNldCgndmFsdWUnLCB2YWx1ZSA9PT0gJycgPyAnJyA6IE51bWJlcih2YWx1ZSkudG9GaXhlZCgxNSkpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRzdGFydCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGlmIChpc0RyYXdpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0aXNEcmF3aW5nID0gdHJ1ZTtcblx0XHRcdFx0c3RhcnRQb3MgPSB7XG5cdFx0XHRcdFx0eDogZXZlbnQucGFnZS54IC0gZWwuZ2V0UG9zaXRpb24oKS54IC0gaW1hZ2VFbGVtZW50LmdldENvbXB1dGVkU2l6ZSgpLmNvbXB1dGVkTGVmdCxcblx0XHRcdFx0XHR5OiBldmVudC5wYWdlLnkgLSBlbC5nZXRQb3NpdGlvbigpLnkgLSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCkuY29tcHV0ZWRUb3Bcblx0XHRcdFx0fTtcblx0XHRcdFx0bW92ZShldmVudCk7XG5cdFx0XHR9LFxuXHRcdFx0bW92ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdGlmICghaXNEcmF3aW5nKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHZhciBpbWFnZVNpemUgPSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCk7XG5cdFx0XHRcdHZhciByZWN0ID0ge1xuXHRcdFx0XHRcdHg6IFtcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIE1hdGgubWluKGltYWdlU2l6ZS53aWR0aCwgc3RhcnRQb3MueCkpLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgTWF0aC5taW4oaW1hZ2VTaXplLndpZHRoLCBldmVudC5wYWdlLnggLSBlbC5nZXRQb3NpdGlvbigpLnggLSBpbWFnZVNpemUuY29tcHV0ZWRMZWZ0KSlcblx0XHRcdFx0XHRdLFxuXHRcdFx0XHRcdHk6IFtcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIE1hdGgubWluKGltYWdlU2l6ZS5oZWlnaHQsIHN0YXJ0UG9zLnkpKSxcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIE1hdGgubWluKGltYWdlU2l6ZS5oZWlnaHQsIGV2ZW50LnBhZ2UueSAtIGVsLmdldFBvc2l0aW9uKCkueSAtIGltYWdlU2l6ZS5jb21wdXRlZFRvcCkpXG5cdFx0XHRcdFx0XVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRwYXJ0RWxlbWVudC5zZXRTdHlsZXMoe1xuXHRcdFx0XHRcdHRvcDogTWF0aC5taW4ocmVjdC55WzBdLCByZWN0LnlbMV0pICsgaW1hZ2VTaXplLmNvbXB1dGVkVG9wICsgJ3B4Jyxcblx0XHRcdFx0XHRsZWZ0OiBNYXRoLm1pbihyZWN0LnhbMF0sIHJlY3QueFsxXSkgKyBpbWFnZVNpemUuY29tcHV0ZWRMZWZ0ICsgJ3B4Jyxcblx0XHRcdFx0XHR3aWR0aDogTWF0aC5hYnMocmVjdC54WzBdIC0gcmVjdC54WzFdKSArICdweCcsXG5cdFx0XHRcdFx0aGVpZ2h0OiBNYXRoLmFicyhyZWN0LnlbMF0gLSByZWN0LnlbMV0pICsgJ3B4J1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0dXBkYXRlVmFsdWVzKCk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdG1vdmUoZXZlbnQpO1xuXHRcdFx0XHRpc0RyYXdpbmcgPSBmYWxzZTtcblx0XHRcdH0sXG5cdFx0XHRpbml0ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGVsLmdldFBhcmVudCgnLnRsX3Rib3gsLnRsX2JveCcpLmdldEVsZW1lbnRzKCdpbnB1dFtuYW1lXj1cImltcG9ydGFudFBhcnRcIl0nKS5lYWNoKGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0XHRcdFx0Wyd4JywgJ3knLCAnd2lkdGgnLCAnaGVpZ2h0J10uZWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHRcdFx0XHRcdGlmIChpbnB1dC5nZXQoJ25hbWUnKS5zdWJzdHIoMTMsIGtleS5sZW5ndGgpID09PSBrZXkuY2FwaXRhbGl6ZSgpKSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0RWxlbWVudHNba2V5XSA9IGlucHV0ID0gJChpbnB1dCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoT2JqZWN0LmdldExlbmd0aChpbnB1dEVsZW1lbnRzKSAhPT0gNCkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRPYmplY3QuZWFjaChpbnB1dEVsZW1lbnRzLCBmdW5jdGlvbihpbnB1dCkge1xuXHRcdFx0XHRcdGlucHV0LmdldFBhcmVudCgpLnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGVsLmFkZENsYXNzKCd0bF9lZGl0X3ByZXZpZXdfZW5hYmxlZCcpO1xuXHRcdFx0XHRwYXJ0RWxlbWVudCA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdFx0J2NsYXNzJzogJ3RsX2VkaXRfcHJldmlld19pbXBvcnRhbnRfcGFydCdcblx0XHRcdFx0fSkuaW5qZWN0KGVsKTtcblx0XHRcdFx0dXBkYXRlSW1hZ2UoKTtcblx0XHRcdFx0aW1hZ2VFbGVtZW50LmFkZEV2ZW50KCdsb2FkJywgdXBkYXRlSW1hZ2UpO1xuXHRcdFx0XHRlbC5hZGRFdmVudHMoe1xuXHRcdFx0XHRcdG1vdXNlZG93bjogc3RhcnQsXG5cdFx0XHRcdFx0dG91Y2hzdGFydDogc3RhcnRcblx0XHRcdFx0fSk7XG5cdFx0XHRcdCQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hZGRFdmVudHMoe1xuXHRcdFx0XHRcdG1vdXNlbW92ZTogbW92ZSxcblx0XHRcdFx0XHR0b3VjaG1vdmU6IG1vdmUsXG5cdFx0XHRcdFx0bW91c2V1cDogc3RvcCxcblx0XHRcdFx0XHR0b3VjaGVuZDogc3RvcCxcblx0XHRcdFx0XHR0b3VjaGNhbmNlbDogc3RvcCxcblx0XHRcdFx0XHRyZXNpemU6IHVwZGF0ZUltYWdlXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdDtcblxuXHRcdHdpbmRvdy5hZGRFdmVudCgnZG9tcmVhZHknLCBpbml0KTtcblx0fSxcblxuXHQvKipcblx0ICogRW5hYmxlIGRyYWcgYW5kIGRyb3AgZmlsZSB1cGxvYWQgZm9yIHRoZSBmaWxlIHRyZWVcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IHdyYXAgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0XG5cdCAqL1xuXHRlbmFibGVGaWxlVHJlZVVwbG9hZDogZnVuY3Rpb24od3JhcCwgb3B0aW9ucykge1xuXHRcdHdyYXAgPSAkKHdyYXApO1xuXG5cdFx0dmFyIGZhbGxiYWNrVXJsID0gb3B0aW9ucy51cmwsXG5cdFx0XHRkekVsZW1lbnQgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHQnY2xhc3MnOiAnZHJvcHpvbmUgZHJvcHpvbmUtZmlsZXRyZWUnLFxuXHRcdFx0XHRodG1sOiAnPHNwYW4gY2xhc3M9XCJkcm9wem9uZS1wcmV2aWV3c1wiPjwvc3Bhbj4nXG5cdFx0XHR9KS5pbmplY3Qod3JhcCwgJ3RvcCcpLFxuXHRcdFx0Y3VycmVudEhvdmVyLCBjdXJyZW50SG92ZXJUaW1lLCBleHBhbmRMaW5rO1xuXG5cdFx0b3B0aW9ucy5wcmV2aWV3c0NvbnRhaW5lciA9IGR6RWxlbWVudC5nZXRFbGVtZW50KCcuZHJvcHpvbmUtcHJldmlld3MnKTtcblx0XHRvcHRpb25zLmNsaWNrYWJsZSA9IGZhbHNlO1xuXG5cdFx0dmFyIGR6ID0gbmV3IERyb3B6b25lKHdyYXAsIG9wdGlvbnMpO1xuXG5cdFx0ZHoub24oJ3F1ZXVlY29tcGxldGUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcblx0XHR9KTtcblxuXHRcdGR6Lm9uKCdkcmFnb3ZlcicsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoIWV2ZW50LmRhdGFUcmFuc2ZlciB8fCAhZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzIHx8IGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlcy5pbmRleE9mKCdGaWxlcycpID09PSAtMSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHdyYXAuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXJfZHJvcHBpbmcnKS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0ICYmICQoZXZlbnQudGFyZ2V0KTtcblxuXHRcdFx0aWYgKHRhcmdldCkge1xuXHRcdFx0XHR2YXIgZm9sZGVyID0gdGFyZ2V0Lm1hdGNoKCcudGxfZm9sZGVyJykgPyB0YXJnZXQgOiB0YXJnZXQuZ2V0UGFyZW50KCcudGxfZm9sZGVyJyk7XG5cblx0XHRcdFx0aWYgKCFmb2xkZXIpIHtcblx0XHRcdFx0XHRmb2xkZXIgPSB0YXJnZXQuZ2V0UGFyZW50KCcucGFyZW50Jyk7XG5cdFx0XHRcdFx0Zm9sZGVyID0gZm9sZGVyICYmIGZvbGRlci5nZXRQcmV2aW91cygnLnRsX2ZvbGRlcicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGZvbGRlcikge1xuXHRcdFx0XHRcdHZhciBsaW5rID0gZm9sZGVyLmdldEVsZW1lbnQoJ2ltZ1tzcmMkPVwiL2ljb25zL25ldy5zdmdcIl0nKTtcblx0XHRcdFx0XHRsaW5rID0gbGluayAmJiBsaW5rLmdldFBhcmVudCgnYScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChsaW5rICYmIGxpbmsuaHJlZikge1xuXHRcdFx0XHRkei5vcHRpb25zLnVybCA9ICcnK2xpbmsuaHJlZjtcblx0XHRcdFx0Zm9sZGVyLmFkZENsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblxuXHRcdFx0XHRpZiAoY3VycmVudEhvdmVyICE9PSBmb2xkZXIpIHtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSBmb2xkZXI7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHRcdFx0XHRcdGV4cGFuZExpbmsgPSBmb2xkZXIuZ2V0RWxlbWVudCgnYS5mb2xkYWJsZScpO1xuXG5cdFx0XHRcdFx0aWYgKGV4cGFuZExpbmsgJiYgIWV4cGFuZExpbmsuaGFzQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJykpIHtcblx0XHRcdFx0XHRcdC8vIEV4cGFuZCB0aGUgZm9sZGVyIGFmdGVyIG9uZSBzZWNvbmQgaG92ZXIgdGltZVxuXHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRIb3ZlciA9PT0gZm9sZGVyICYmIGN1cnJlbnRIb3ZlclRpbWUgKyA5MDAgPCBuZXcgRGF0ZSgpLmdldFRpbWUoKSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdIVE1MRXZlbnRzJyk7XG5cdFx0XHRcdFx0XHRcdFx0ZXZlbnQuaW5pdEV2ZW50KCdjbGljaycsIHRydWUsIHRydWUpO1xuXHRcdFx0XHRcdFx0XHRcdGV4cGFuZExpbmsuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cdFx0XHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0sIDEwMDApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZHoub3B0aW9ucy51cmwgPSBmYWxsYmFja1VybDtcblx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZHoub24oJ2Ryb3AnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0aWYgKCFldmVudC5kYXRhVHJhbnNmZXIgfHwgIWV2ZW50LmRhdGFUcmFuc2Zlci50eXBlcyB8fCBldmVudC5kYXRhVHJhbnNmZXIudHlwZXMuaW5kZXhPZignRmlsZXMnKSA9PT0gLTEpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRkekVsZW1lbnQuYWRkQ2xhc3MoJ2Ryb3B6b25lLWZpbGV0cmVlLWVuYWJsZWQnKTtcblx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHR9KTtcblxuXHRcdGR6Lm9uKCdkcmFnbGVhdmUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHdyYXAuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXJfZHJvcHBpbmcnKS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBDcmF3bCB0aGUgd2Vic2l0ZVxuXHQgKi9cblx0Y3Jhd2w6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aW1lb3V0ID0gMjAwMCxcblx0XHRcdGNyYXdsID0gJCgndGxfY3Jhd2wnKSxcblx0XHRcdHByb2dyZXNzQmFyID0gY3Jhd2wuZ2V0RWxlbWVudCgnZGl2LnByb2dyZXNzLWJhcicpLFxuXHRcdFx0cHJvZ3Jlc3NDb3VudCA9IGNyYXdsLmdldEVsZW1lbnQoJ3AucHJvZ3Jlc3MtY291bnQnKSxcblx0XHRcdHJlc3VsdHMgPSBjcmF3bC5nZXRFbGVtZW50KCdkaXYucmVzdWx0cycpLFxuXHRcdFx0ZGVidWdMb2cgPSBjcmF3bC5nZXRFbGVtZW50KCdwLmRlYnVnLWxvZycpO1xuXG5cdFx0ZnVuY3Rpb24gdXBkYXRlRGF0YShyZXNwb25zZSkge1xuXHRcdFx0dmFyIHRvdGFsID0gcmVzcG9uc2UudG90YWwsXG5cdFx0XHRcdGRvbmUgPSB0b3RhbCAtIHJlc3BvbnNlLnBlbmRpbmcsXG5cdFx0XHRcdHBlcmNlbnRhZ2UgPSB0b3RhbCA+IDAgPyBwYXJzZUludChkb25lIC8gdG90YWwgKiAxMDAsIDEwKSA6IDEwMCxcblx0XHRcdFx0cmVzdWx0O1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIHRoZSBzdGF0dXMgYmFyIGF0IDEwJVxuXHRcdFx0aWYgKGRvbmUgPCAxICYmIHBlcmNlbnRhZ2UgPCAxKSB7XG5cdFx0XHRcdGRvbmUgPSAxO1xuXHRcdFx0XHRwZXJjZW50YWdlID0gMTA7XG5cdFx0XHRcdHRvdGFsID0gMTA7XG5cdFx0XHR9XG5cblx0XHRcdHByb2dyZXNzQmFyLnNldFN0eWxlKCd3aWR0aCcsIHBlcmNlbnRhZ2UgKyAnJScpO1xuXHRcdFx0cHJvZ3Jlc3NCYXIuc2V0KCdodG1sJywgcGVyY2VudGFnZSArICclJyk7XG5cdFx0XHRwcm9ncmVzc0Jhci5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCBwZXJjZW50YWdlKTtcblx0XHRcdHByb2dyZXNzQ291bnQuc2V0KCdodG1sJywgZG9uZSArICcgLyAnICsgdG90YWwpO1xuXG5cdFx0XHRpZiAocmVzcG9uc2UuaGFzRGVidWdMb2cpIHtcblx0XHRcdFx0ZGVidWdMb2cuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHJlc3BvbnNlLmhhc0RlYnVnTG9nKSB7XG5cdFx0XHRcdGRlYnVnTG9nLnNldFN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghcmVzcG9uc2UuZmluaXNoZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRwcm9ncmVzc0Jhci5yZW1vdmVDbGFzcygncnVubmluZycpLmFkZENsYXNzKCdmaW5pc2hlZCcpO1xuXHRcdFx0cmVzdWx0cy5yZW1vdmVDbGFzcygncnVubmluZycpLmFkZENsYXNzKCdmaW5pc2hlZCcpO1xuXG5cdFx0XHRmb3IgKHJlc3VsdCBpbiByZXNwb25zZS5yZXN1bHRzKSB7XG5cdFx0XHRcdGlmIChyZXNwb25zZS5yZXN1bHRzLmhhc093blByb3BlcnR5KHJlc3VsdCkpIHtcblx0XHRcdFx0XHR2YXIgc3VtbWFyeSA9IHJlc3VsdHMuZ2V0RWxlbWVudCgnLnJlc3VsdFtkYXRhLXN1YnNjcmliZXI9XCInICsgcmVzdWx0ICsgJ1wiXSBwLnN1bW1hcnknKSxcblx0XHRcdFx0XHRcdHdhcm5pbmcgPSByZXN1bHRzLmdldEVsZW1lbnQoJy5yZXN1bHRbZGF0YS1zdWJzY3JpYmVyPVwiJyArIHJlc3VsdCArICdcIl0gcC53YXJuaW5nJyksXG5cdFx0XHRcdFx0XHRsb2cgPSByZXN1bHRzLmdldEVsZW1lbnQoJy5yZXN1bHRbZGF0YS1zdWJzY3JpYmVyPVwiJyArIHJlc3VsdCArICdcIl0gcC5zdWJzY3JpYmVyLWxvZycpLFxuXHRcdFx0XHRcdFx0c3Vic2NyaWJlclJlc3VsdHMgPSByZXNwb25zZS5yZXN1bHRzW3Jlc3VsdF0sXG5cdFx0XHRcdFx0XHRzdWJzY3JpYmVyU3VtbWFyeSA9IHN1YnNjcmliZXJSZXN1bHRzLnN1bW1hcnk7XG5cblx0XHRcdFx0XHRpZiAoc3Vic2NyaWJlclJlc3VsdHMud2FybmluZykge1xuXHRcdFx0XHRcdFx0d2FybmluZy5zZXQoJ2h0bWwnLCBzdWJzY3JpYmVyUmVzdWx0cy53YXJuaW5nKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoc3Vic2NyaWJlclJlc3VsdHMuaGFzTG9nKSB7XG5cdFx0XHRcdFx0XHRsb2cuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRzdW1tYXJ5LmFkZENsYXNzKHN1YnNjcmliZXJSZXN1bHRzLndhc1N1Y2Nlc3NmdWwgPyAnc3VjY2VzcycgOiAnZmFpbHVyZScpO1xuXHRcdFx0XHRcdHN1bW1hcnkuc2V0KCdodG1sJywgc3Vic2NyaWJlclN1bW1hcnkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZXhlY1JlcXVlc3Qob25seVN0YXR1c1VwZGF0ZSA9IGZhbHNlKSB7XG5cdFx0XHRuZXcgUmVxdWVzdCh7XG5cdFx0XHRcdHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnT25seS1TdGF0dXMtVXBkYXRlJzogb25seVN0YXR1c1VwZGF0ZVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRvblN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlVGV4dCkge1xuXHRcdFx0XHRcdHZhciByZXNwb25zZSA9IEpTT04uZGVjb2RlKHJlc3BvbnNlVGV4dCk7XG5cblx0XHRcdFx0XHR1cGRhdGVEYXRhKHJlc3BvbnNlKTtcblxuXHRcdFx0XHRcdGlmICghcmVzcG9uc2UuZmluaXNoZWQpIHtcblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZXhlY1JlcXVlc3QsIHRpbWVvdXQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSkuc2VuZCgpO1xuXHRcdH1cblxuXHRcdGV4ZWNSZXF1ZXN0KHRydWUpO1xuXHR9XG59O1xuXG53aW5kb3cuVGhlbWUgPVxue1xuXHQvKipcblx0ICogQ2hlY2sgZm9yIFdlYktpdFxuXHQgKiBAbWVtYmVyIHtib29sZWFufVxuIFx0ICovXG5cdGlzV2Via2l0OiAoQnJvd3Nlci5jaHJvbWUgfHwgQnJvd3Nlci5zYWZhcmkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvKD86d2Via2l0fGtodG1sKS9pKSksXG5cblx0LyoqXG5cdCAqIFN0b3AgdGhlIHByb3BhZ2F0aW9uIG9mIGNsaWNrIGV2ZW50cyBvZiBjZXJ0YWluIGVsZW1lbnRzXG5cdCAqL1xuXHRzdG9wQ2xpY2tQcm9wYWdhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gRG8gbm90IHByb3BhZ2F0ZSB0aGUgY2xpY2sgZXZlbnRzIG9mIHRoZSBpY29uc1xuXHRcdCQkKCcucGlja2VyX3NlbGVjdG9yJykuZWFjaChmdW5jdGlvbih1bCkge1xuXHRcdFx0dWwuZ2V0RWxlbWVudHMoJ2EnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdGVsLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gRG8gbm90IHByb3BhZ2F0ZSB0aGUgY2xpY2sgZXZlbnRzIG9mIHRoZSBjaGVja2JveGVzXG5cdFx0JCQoJy5waWNrZXJfc2VsZWN0b3IsLmNsaWNrMmVkaXQnKS5lYWNoKGZ1bmN0aW9uKHVsKSB7XG5cdFx0XHR1bC5nZXRFbGVtZW50cygnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRlbC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSB0ZXh0YXJlYSByZXNpemluZ1xuXHQgKi9cblx0c2V0dXBUZXh0YXJlYVJlc2l6aW5nOiBmdW5jdGlvbigpIHtcblx0XHQkJCgnLnRsX3RleHRhcmVhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0aWYgKEJyb3dzZXIuaWU2IHx8IEJyb3dzZXIuaWU3IHx8IEJyb3dzZXIuaWU4KSByZXR1cm47XG5cdFx0XHRpZiAoZWwuaGFzQ2xhc3MoJ25vcmVzaXplJykgfHwgZWwucmV0cmlldmUoJ2F1dG9ncm93JykpIHJldHVybjtcblxuXHRcdFx0Ly8gU2V0IHVwIHRoZSBkdW1teSBlbGVtZW50XG5cdFx0XHR2YXIgZHVtbXkgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHRodG1sOiAnWCcsXG5cdFx0XHRcdHN0eWxlczoge1xuXHRcdFx0XHRcdCdwb3NpdGlvbic6J2Fic29sdXRlJyxcblx0XHRcdFx0XHQndG9wJzowLFxuXHRcdFx0XHRcdCdsZWZ0JzonLTk5OWVtJyxcblx0XHRcdFx0XHQnb3ZlcmZsb3cteCc6J2hpZGRlbidcblx0XHRcdFx0fVxuXHRcdFx0fSkuc2V0U3R5bGVzKFxuXHRcdFx0XHRlbC5nZXRTdHlsZXMoJ2ZvbnQtc2l6ZScsICdmb250LWZhbWlseScsICd3aWR0aCcsICdsaW5lLWhlaWdodCcpXG5cdFx0XHQpLmluamVjdChkb2N1bWVudC5ib2R5KTtcblxuXHRcdFx0Ly8gQWxzbyBjb25zaWRlciB0aGUgYm94LXNpemluZ1xuXHRcdFx0aWYgKGVsLmdldFN0eWxlKCctbW96LWJveC1zaXppbmcnKSA9PSAnYm9yZGVyLWJveCcgfHwgZWwuZ2V0U3R5bGUoJy13ZWJraXQtYm94LXNpemluZycpID09ICdib3JkZXItYm94JyB8fCBlbC5nZXRTdHlsZSgnYm94LXNpemluZycpID09ICdib3JkZXItYm94Jykge1xuXHRcdFx0XHRkdW1teS5zZXRTdHlsZXMoe1xuXHRcdFx0XHRcdCdwYWRkaW5nJzogZWwuZ2V0U3R5bGUoJ3BhZGRpbmcnKSxcblx0XHRcdFx0XHQnYm9yZGVyJzogZWwuZ2V0U3R5bGUoJ2JvcmRlci1sZWZ0Jylcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNpbmdsZSBsaW5lIGhlaWdodFxuXHRcdFx0dmFyIGxpbmUgPSBNYXRoLm1heChkdW1teS5jbGllbnRIZWlnaHQsIDMwKTtcblxuXHRcdFx0Ly8gUmVzcG9uZCB0byB0aGUgXCJpbnB1dFwiIGV2ZW50XG5cdFx0XHRlbC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZHVtbXkuc2V0KCdodG1sJywgdGhpcy5nZXQoJ3ZhbHVlJylcblx0XHRcdFx0XHQucmVwbGFjZSgvPC9nLCAnJmx0OycpXG5cdFx0XHRcdFx0LnJlcGxhY2UoLz4vZywgJyZndDsnKVxuXHRcdFx0XHRcdC5yZXBsYWNlKC9cXG58XFxyXFxuL2csICc8YnI+WCcpKTtcblx0XHRcdFx0dmFyIGhlaWdodCA9IE1hdGgubWF4KGxpbmUsIGR1bW15LmdldFNpemUoKS55KTtcblx0XHRcdFx0aWYgKHRoaXMuY2xpZW50SGVpZ2h0ICE9IGhlaWdodCkgdGhpcy50d2VlbignaGVpZ2h0JywgaGVpZ2h0KTtcblx0XHRcdH0pLnNldCgndHdlZW4nLCB7ICdkdXJhdGlvbic6MTAwIH0pLnNldFN0eWxlKCdoZWlnaHQnLCBsaW5lICsgJ3B4Jyk7XG5cblx0XHRcdC8vIEZpcmUgdGhlIGV2ZW50XG5cdFx0XHRlbC5maXJlRXZlbnQoJ2lucHV0Jyk7XG5cdFx0XHRlbC5zdG9yZSgnYXV0b2dyb3cnLCB0cnVlKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBtZW51IHRvZ2dsZVxuXHQgKi9cblx0c2V0dXBNZW51VG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYnVyZ2VyID0gJCgnYnVyZ2VyJyk7XG5cdFx0aWYgKCFidXJnZXIpIHJldHVybjtcblxuXHRcdGJ1cmdlclxuXHRcdFx0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LnRvZ2dsZUNsYXNzKCdzaG93LW5hdmlnYXRpb24nKTtcblx0XHRcdFx0YnVyZ2VyLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGRvY3VtZW50LmJvZHkuaGFzQ2xhc3MoJ3Nob3ctbmF2aWdhdGlvbicpID8gJ3RydWUnIDogJ2ZhbHNlJylcblx0XHRcdH0pXG5cdFx0XHQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMjcpIHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdzaG93LW5hdmlnYXRpb24nKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHQ7XG5cblx0XHRpZiAod2luZG93Lm1hdGNoTWVkaWEpIHtcblx0XHRcdHZhciBtYXRjaE1lZGlhID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6OTkxcHgpJyk7XG5cdFx0XHR2YXIgc2V0QXJpYUNvbnRyb2xzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChtYXRjaE1lZGlhLm1hdGNoZXMpIHtcblx0XHRcdFx0XHRidXJnZXIuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgJ2xlZnQnKVxuXHRcdFx0XHRcdGJ1cmdlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBkb2N1bWVudC5ib2R5Lmhhc0NsYXNzKCdzaG93LW5hdmlnYXRpb24nKSA/ICd0cnVlJyA6ICdmYWxzZScpXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YnVyZ2VyLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xuXHRcdFx0XHRcdGJ1cmdlci5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdG1hdGNoTWVkaWEuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2V0QXJpYUNvbnRyb2xzKTtcblx0XHRcdHNldEFyaWFDb250cm9scygpO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBwcm9maWxlIHRvZ2dsZVxuXHQgKi9cblx0c2V0dXBQcm9maWxlVG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAod2luZG93LmNvbnNvbGUpIHtcblx0XHRcdGNvbnNvbGUud2FybignVGhlbWUuc2V0dXBQcm9maWxlVG9nZ2xlKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgc3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuXHRcdH1cblxuXHRcdHZhciB0bWVudSA9ICQoJ3RtZW51Jyk7XG5cdFx0aWYgKCF0bWVudSkgcmV0dXJuO1xuXG5cdFx0dmFyIGxpID0gdG1lbnUuZ2V0RWxlbWVudCgnLnN1Ym1lbnUnKSxcblx0XHRcdGJ1dHRvbiA9IGxpLmdldEZpcnN0KCdzcGFuJykuZ2V0Rmlyc3QoJ2J1dHRvbicpLFxuXHRcdFx0bWVudSA9IGxpLmdldEZpcnN0KCd1bCcpO1xuXHRcdGlmICghbGkgfHwgIWJ1dHRvbiB8fCAhbWVudSkgcmV0dXJuO1xuXG5cdFx0YnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsICd0bWVudV9fcHJvZmlsZScpO1xuXHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcblxuXHRcdG1lbnUuaWQgPSAndG1lbnVfX3Byb2ZpbGUnO1xuXG5cdFx0YnV0dG9uLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmIChsaS5oYXNDbGFzcygnYWN0aXZlJykpIHtcblx0XHRcdFx0bGkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsaS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuXHRcdFx0fVxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9KTtcblxuXHRcdCQoZG9jdW1lbnQuYm9keSkuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAobGkuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG5cdFx0XHRcdGxpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBzcGxpdCBidXR0b24gdG9nZ2xlXG5cdCAqL1xuXHRzZXR1cFNwbGl0QnV0dG9uVG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdG9nZ2xlID0gJCgnc2J0b2cnKTtcblx0XHRpZiAoIXRvZ2dsZSkgcmV0dXJuO1xuXG5cdFx0dmFyIHVsID0gdG9nZ2xlLmdldFBhcmVudCgnLnNwbGl0LWJ1dHRvbicpLmdldEVsZW1lbnQoJ3VsJyksXG5cdFx0XHR0YWIsIHRpbWVyO1xuXG5cdFx0dG9nZ2xlLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRhYiA9IGZhbHNlO1xuXHRcdFx0dWwudG9nZ2xlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXHRcdFx0dG9nZ2xlLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cblx0XHQkKGRvY3VtZW50LmJvZHkpLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGFiID0gZmFsc2U7XG5cdFx0XHR1bC5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG5cdFx0XHR0b2dnbGUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdH0pO1xuXG5cdFx0JChkb2N1bWVudC5ib2R5KS5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRhYiA9IChlLmV2ZW50LmtleUNvZGUgPT0gOSk7XG5cdFx0fSk7XG5cblx0XHRbdG9nZ2xlXS5hcHBlbmQodWwuZ2V0RWxlbWVudHMoJ2J1dHRvbicpKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRlbC5hZGRFdmVudCgnZm9jdXMnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCF0YWIpIHJldHVybjtcblx0XHRcdFx0dWwucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXHRcdFx0XHR0b2dnbGUuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGVsLmFkZEV2ZW50KCdibHVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghdGFiKSByZXR1cm47XG5cdFx0XHRcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR1bC5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG5cdFx0XHRcdFx0dG9nZ2xlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0dG9nZ2xlLnNldCgndGFiaW5kZXgnLCAnLTEnKTtcblx0fVxufTtcblxuLy8gSW5pdGlhbGl6ZSB0aGUgYmFjayBlbmQgc2NyaXB0XG53aW5kb3cuYWRkRXZlbnQoJ2RvbXJlYWR5JywgZnVuY3Rpb24oKSB7XG5cdCQoZG9jdW1lbnQuYm9keSkuYWRkQ2xhc3MoJ2pzJyk7XG5cblx0Ly8gTWFyayB0b3VjaCBkZXZpY2VzIChzZWUgIzU1NjMpXG5cdGlmIChCcm93c2VyLkZlYXR1cmVzLlRvdWNoKSB7XG5cdFx0JChkb2N1bWVudC5ib2R5KS5hZGRDbGFzcygndG91Y2gnKTtcblx0fVxuXG5cdEJhY2tlbmQudGFibGVXaXphcmRTZXRXaWR0aCgpO1xuXHRCYWNrZW5kLmVuYWJsZUltYWdlU2l6ZVdpZGdldHMoKTtcblx0QmFja2VuZC5lbmFibGVUb2dnbGVTZWxlY3QoKTtcblxuXHRUaGVtZS5zdG9wQ2xpY2tQcm9wYWdhdGlvbigpO1xuXHRUaGVtZS5zZXR1cFRleHRhcmVhUmVzaXppbmcoKTtcblx0VGhlbWUuc2V0dXBNZW51VG9nZ2xlKCk7XG5cdFRoZW1lLnNldHVwU3BsaXRCdXR0b25Ub2dnbGUoKTtcbn0pO1xuXG4vLyBSZXNpemUgdGhlIHRhYmxlIHdpemFyZFxud2luZG93LmFkZEV2ZW50KCdyZXNpemUnLCBmdW5jdGlvbigpIHtcblx0QmFja2VuZC50YWJsZVdpemFyZFNldFdpZHRoKCk7XG59KTtcblxuLy8gUmUtYXBwbHkgY2VydGFpbiBjaGFuZ2VzIHVwb24gYWpheF9jaGFuZ2VcbndpbmRvdy5hZGRFdmVudCgnYWpheF9jaGFuZ2UnLCBmdW5jdGlvbigpIHtcblx0QmFja2VuZC5lbmFibGVJbWFnZVNpemVXaWRnZXRzKCk7XG5cdEJhY2tlbmQuZW5hYmxlVG9nZ2xlU2VsZWN0KCk7XG5cblx0VGhlbWUuc3RvcENsaWNrUHJvcGFnYXRpb24oKTtcblx0VGhlbWUuc2V0dXBUZXh0YXJlYVJlc2l6aW5nKCk7XG59KTtcbiIsIndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LmxpbWl0X2hlaWdodCcpLmZvckVhY2goZnVuY3Rpb24oZGl2KSB7XG4gICAgICAgIGlmICh3aW5kb3cuY29uc29sZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdVc2luZyBcImxpbWl0X2hlaWdodFwiIGNsYXNzIG9uIGNoaWxkX3JlY29yZF9jYWxsYmFjayBpcyBkZXByZWNhdGVkLiBTZXQgYSBsaXN0LnNvcnRpbmcubGltaXRIZWlnaHQgaW4geW91ciBEQ0EgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGRpdi5wYXJlbnROb2RlLmNsb3Nlc3QoJy50bF9jb250ZW50Jyk7XG5cbiAgICAgICAgLy8gUmV0dXJuIGlmIHRoZSBlbGVtZW50IGlzIGEgd3JhcHBlclxuICAgICAgICBpZiAocGFyZW50ICYmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCd3cmFwcGVyX3N0YXJ0JykgfHwgcGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnd3JhcHBlcl9zdG9wJykpKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgaGd0ID0gTnVtYmVyKGRpdi5jbGFzc05hbWUucmVwbGFjZSgvW14wLTldKi8sICcnKSk7XG5cbiAgICAgICAgLy8gUmV0dXJuIGlmIHRoZXJlIGlzIG5vIGhlaWdodCB2YWx1ZVxuICAgICAgICBpZiAoIWhndCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LCBudWxsKTtcbiAgICAgICAgY29uc3QgcGFkZGluZyA9IHBhcnNlRmxvYXQoc3R5bGUucGFkZGluZ1RvcCkgKyBwYXJzZUZsb2F0KHN0eWxlLnBhZGRpbmdCb3R0b20pO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBkaXYuY2xpZW50SGVpZ2h0IC0gcGFkZGluZztcblxuICAgICAgICAvLyBEbyBub3QgYWRkIHRoZSB0b2dnbGUgaWYgdGhlIHByZXZpZXcgaGVpZ2h0IGlzIGJlbG93IHRoZSBtYXgtaGVpZ2h0XG4gICAgICAgIGlmIChoZWlnaHQgPD0gaGd0KSByZXR1cm47XG5cbiAgICAgICAgLy8gUmVzaXplIHRoZSBlbGVtZW50IGlmIGl0IGlzIGhpZ2hlciB0aGFuIHRoZSBtYXhpbXVtIGhlaWdodFxuICAgICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gaGd0KydweCc7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi50aXRsZSA9IENvbnRhby5sYW5nLmV4cGFuZDtcbiAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9ICc8c3Bhbj4uLi48L3NwYW4+JztcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Vuc2VsZWN0YWJsZScpO1xuXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGRpdi5zdHlsZS5oZWlnaHQgPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgZGl2LnN0eWxlLmhlaWdodCA9IGhndCsncHgnO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi50aXRsZSA9IENvbnRhby5sYW5nLmV4cGFuZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGl2LnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgICAgICAgICBidXR0b24udGl0bGUgPSBDb250YW8ubGFuZy5jb2xsYXBzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0b2dnbGVyLmNsYXNzTGlzdC5hZGQoJ2xpbWl0X3RvZ2dsZXInKTtcbiAgICAgICAgdG9nZ2xlci5hcHBlbmQoYnV0dG9uKTtcblxuICAgICAgICBkaXYuYXBwZW5kKHRvZ2dsZXIpO1xuICAgIH0pO1xufSk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBjb25zdCBpbml0aWFsaXplZFJvd3MgPSBuZXcgV2Vha01hcCgpO1xuICAgIGNvbnN0IHNhdmVTY3JvbGxPZmZzZXRFdmVudCA9IG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpO1xuXG4gICAgY29uc3QgaW5pdCA9IChyb3cpID0+IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyByb3cgaGFzIGFscmVhZHkgYmVlbiBpbml0aWFsaXplZFxuICAgICAgICBpZiAoaW5pdGlhbGl6ZWRSb3dzLmhhcyhyb3cpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcm93IGhhcyBhbGwgbmVjZXNzYXJ5IGVsZW1lbnRzIHRvIHByZXZlbnQgdGhlIG11dGF0aW9uIG9ic2VydmVyXG4gICAgICAgIC8vIGZyb20gaW5pdGlhbGl6aW5nIHRoZSBpbmNvbXBsZXRlIHdpZGdldC5cbiAgICAgICAgaWYgKCFyb3cucXVlcnlTZWxlY3RvcignYnV0dG9uLmRyYWctaGFuZGxlJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGluaXRpYWxpemVkUm93cy5zZXQocm93LCB0cnVlKTtcblxuICAgICAgICBjb25zdCB0Ym9keSA9IHJvdy5jbG9zZXN0KCd0Ym9keScpO1xuXG4gICAgICAgIGNvbnN0IG1ha2VTb3J0YWJsZSA9ICh0Ym9keSkgPT4ge1xuICAgICAgICAgICAgQXJyYXkuZnJvbSh0Ym9keS5jaGlsZHJlbikuZm9yRWFjaCgodHIsIGkpID0+IHtcbiAgICAgICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgc2VsZWN0JykuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZWwubmFtZSA9IGVsLm5hbWUucmVwbGFjZSgvXFxbWzAtOV0rXS9nLCAnWycgKyBpICsgJ10nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiByZXBsYWNlIHRoaXMgd2l0aCBhIHZhbmlsbGEgSlMgc29sdXRpb25cbiAgICAgICAgICAgIG5ldyBTb3J0YWJsZXModGJvZHksIHtcbiAgICAgICAgICAgICAgICBjb25zdHJhaW46IHRydWUsXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMC42LFxuICAgICAgICAgICAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICAgICAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgYWRkRXZlbnRzVG8gPSAodHIpID0+IHtcbiAgICAgICAgICAgIHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpLmZvckVhY2goKGJ0KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IGJ0LmRhdGFzZXQuY29tbWFuZDtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb3B5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBudHIgPSB0ci5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0cyA9IHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5zZWxlY3RzID0gbnRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaj0wOyBqPHNlbGVjdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnNlbGVjdHNbal0udmFsdWUgPSBzZWxlY3RzW2pdLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG50ci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1vcmlnaW5hbC10aXRsZV0nKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVkUm93cy5zZXQobnRyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShudHIsIHRyLm5leHRTaWJsaW5nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50c1RvKG50cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGJvZHkuY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB2YWx1ZXMgZm9yIGxhc3QgZWxlbWVudCAoIzY4OSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JykuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QudmFsdWUgPSBzZWxlY3QuY2hpbGRyZW5bMF0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VuYWJsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYnggPSBidC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNieC5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNieC5jaGVja2VkID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2J4LmNoZWNrZWQgPSAnY2hlY2tlZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0LmNsYXNzTGlzdC5jb250YWlucygnZHJhZy1oYW5kbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd1VwJyB8fCBldmVudC5rZXlDb2RlID09PSAzOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJyB8fCBldmVudC5rZXlDb2RlID09PSA0MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLm5leHRFbGVtZW50U2libGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLm5leHRFbGVtZW50U2libGluZy5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ID0gdHIucXVlcnlTZWxlY3RvcigndGQ6Zmlyc3QtY2hpbGQgc2VsZWN0Jyk7XG5cbiAgICAgICAgICAgIGlmICghc2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdHIucXVlcnlTZWxlY3RvcignYS5tb2R1bGVfbGluaycpO1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VzID0gdHIucXVlcnlTZWxlY3RvckFsbCgnaW1nLm1vZHVsZV9pbWFnZScpO1xuXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVMaW5rID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IGxpbmsuaHJlZi5yZXBsYWNlKC9pZD1bMC05XSsvLCAnaWQ9JyArIHNlbGVjdC52YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0LnZhbHVlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgICAgIGltYWdlcy5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VzLmZvckVhY2goKGltYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZUxpbmspO1xuICAgICAgICB9O1xuXG4gICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgIGFkZEV2ZW50c1RvKHJvdyk7XG4gICAgfTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50bF9tb2R1bGV3aXphcmQgdHInKS5mb3JFYWNoKGluaXQpO1xuXG4gICAgbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24obXV0YXRpb25zTGlzdCkge1xuICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9uc0xpc3QpIHtcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lm1hdGNoZXMgJiYgZWxlbWVudC5tYXRjaGVzKCcudGxfbW9kdWxld2l6YXJkIHRyLCAudGxfbW9kdWxld2l6YXJkIHRyIConKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdChlbGVtZW50LmNsb3Nlc3QoJ3RyJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgICAgYXR0cmlidXRlczogZmFsc2UsXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgIH0pO1xufSkoKTtcbiIsIi8qXG4tLS1cblxubmFtZTogUmVxdWVzdC5Db250YW9cblxuZGVzY3JpcHRpb246IEV4dGVuZHMgdGhlIE1vb1Rvb2xzIFJlcXVlc3QuSlNPTiBjbGFzcyB3aXRoIENvbnRhby1zcGVjaWZpYyByb3V0aW5lcy5cblxubGljZW5zZTogTEdQTHYzXG5cbmF1dGhvcnM6XG4gLSBMZW8gRmV5ZXJcblxucmVxdWlyZXM6IFtSZXF1ZXN0LCBKU09OXVxuXG5wcm92aWRlczogUmVxdWVzdC5Db250YW9cblxuLi4uXG4qL1xuXG5SZXF1ZXN0LkNvbnRhbyA9IG5ldyBDbGFzcyhcbntcblx0RXh0ZW5kczogUmVxdWVzdC5KU09OLFxuXG5cdG9wdGlvbnM6IHtcblx0XHRmb2xsb3dSZWRpcmVjdHM6IHRydWUsXG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdGlmICghb3B0aW9ucykge1xuXHRcdFx0b3B0aW9ucyA9IHt9O1xuXHRcdH1cblxuXHRcdGlmICghb3B0aW9ucy51cmwgJiYgb3B0aW9ucy5maWVsZCAmJiBvcHRpb25zLmZpZWxkLmZvcm0gJiYgb3B0aW9ucy5maWVsZC5mb3JtLmFjdGlvbikge1xuXHRcdFx0b3B0aW9ucy51cmwgPSBvcHRpb25zLmZpZWxkLmZvcm0uYWN0aW9uO1xuXHRcdH1cblxuXHRcdGlmICghb3B0aW9ucy51cmwpIHtcblx0XHRcdG9wdGlvbnMudXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG5cdFx0fVxuXG5cdFx0dGhpcy5wYXJlbnQob3B0aW9ucyk7XG5cdH0sXG5cblx0c3VjY2VzczogZnVuY3Rpb24odGV4dCkge1xuXHRcdHZhciB1cmwgPSB0aGlzLmdldEhlYWRlcignWC1BamF4LUxvY2F0aW9uJyksXG5cdFx0XHRqc29uO1xuXG5cdFx0aWYgKHVybCAmJiB0aGlzLm9wdGlvbnMuZm9sbG93UmVkaXJlY3RzKSB7XG5cdFx0XHRsb2NhdGlvbi5yZXBsYWNlKHVybCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gU3VwcG9ydCBib3RoIHBsYWluIHRleHQgYW5kIEpTT04gcmVzcG9uc2VzXG5cdFx0dHJ5IHtcblx0XHRcdGpzb24gPSB0aGlzLnJlc3BvbnNlLmpzb24gPSBKU09OLmRlY29kZSh0ZXh0LCB0aGlzLm9wdGlvbnMuc2VjdXJlKTtcblx0XHR9IGNhdGNoKGUpIHtcblx0XHRcdGpzb24gPSB7J2NvbnRlbnQnOnRleHR9O1xuXHRcdH1cblxuXHRcdC8vIEVtcHR5IHJlc3BvbnNlXG5cdFx0aWYgKGpzb24gPT09IG51bGwpIHtcblx0XHRcdGpzb24gPSB7J2NvbnRlbnQnOicnfTtcblx0XHR9IGVsc2UgaWYgKHR5cGVvZihqc29uKSAhPSAnb2JqZWN0Jykge1xuXHRcdFx0anNvbiA9IHsnY29udGVudCc6dGV4dH07XG5cdFx0fVxuXG5cdFx0Ly8gSXNvbGF0ZSBzY3JpcHRzIGFuZCBleGVjdXRlIHRoZW1cblx0XHRpZiAoanNvbi5jb250ZW50ICE9ICcnKSB7XG5cdFx0XHRqc29uLmNvbnRlbnQgPSBqc29uLmNvbnRlbnQuc3RyaXBTY3JpcHRzKGZ1bmN0aW9uKHNjcmlwdCkge1xuXHRcdFx0XHRqc29uLmphdmFzY3JpcHQgPSBzY3JpcHQucmVwbGFjZSgvPCEtLXxcXC9cXC8tLT58PCFcXFtDREFUQVxcW1xcL1xcLz58PCFdXT4vZywgJycpO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAoanNvbi5qYXZhc2NyaXB0ICYmIHRoaXMub3B0aW9ucy5ldmFsU2NyaXB0cykge1xuXHRcdFx0XHRCcm93c2VyLmV4ZWMoanNvbi5qYXZhc2NyaXB0KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLm9uU3VjY2Vzcyhqc29uLmNvbnRlbnQsIGpzb24pO1xuXHR9LFxuXG5cdGZhaWx1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB1cmwgPSB0aGlzLmdldEhlYWRlcignWC1BamF4LUxvY2F0aW9uJyk7XG5cblx0XHRpZiAodXJsICYmIDQwMSA9PT0gdGhpcy5zdGF0dXMpIHtcblx0XHRcdGxvY2F0aW9uLnJlcGxhY2UodXJsKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodXJsICYmIHRoaXMub3B0aW9ucy5mb2xsb3dSZWRpcmVjdHMgJiYgdGhpcy5zdGF0dXMgPj0gMzAwICYmIHRoaXMuc3RhdHVzIDwgNDAwKSB7XG5cdFx0XHRsb2NhdGlvbi5yZXBsYWNlKHVybCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5vbkZhaWx1cmUoKTtcblx0fVxufSk7XG5cblxuLypcbi0tLVxuXG5uYW1lOiBEcmFnXG5cbmRlc2NyaXB0aW9uOiBFeHRlbmRzIHRoZSBiYXNlIERyYWcgY2xhc3Mgd2l0aCB0b3VjaCBzdXBwb3J0LlxuXG5saWNlbnNlOiBMR1BMdjNcblxuYXV0aG9yczpcbiAtIEFuZHJlYXMgU2NoZW1wcFxuXG5yZXF1aXJlczogW0RyYWddXG5cbnByb3ZpZGVzOiBEcmFnXG5cbi4uLlxuKi9cblxuQ2xhc3MucmVmYWN0b3IoRHJhZyxcbntcblx0YXR0YWNoOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmhhbmRsZXMuYWRkRXZlbnQoJ3RvdWNoc3RhcnQnLCB0aGlzLmJvdW5kLnN0YXJ0KTtcblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdGRldGFjaDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5oYW5kbGVzLnJlbW92ZUV2ZW50KCd0b3VjaHN0YXJ0JywgdGhpcy5ib3VuZC5zdGFydCk7XG5cdFx0cmV0dXJuIHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRzKHtcblx0XHRcdHRvdWNobW92ZTogdGhpcy5ib3VuZC5jaGVjayxcblx0XHRcdHRvdWNoZW5kOiB0aGlzLmJvdW5kLmNhbmNlbFxuXHRcdH0pO1xuXHRcdHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRjaGVjazogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRpZiAodGhpcy5vcHRpb25zLnByZXZlbnREZWZhdWx0KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciBkaXN0YW5jZSA9IE1hdGgucm91bmQoTWF0aC5zcXJ0KE1hdGgucG93KGV2ZW50LnBhZ2UueCAtIHRoaXMubW91c2Uuc3RhcnQueCwgMikgKyBNYXRoLnBvdyhldmVudC5wYWdlLnkgLSB0aGlzLm1vdXNlLnN0YXJ0LnksIDIpKSk7XG5cdFx0aWYgKGRpc3RhbmNlID4gdGhpcy5vcHRpb25zLnNuYXApIHtcblx0XHRcdHRoaXMuY2FuY2VsKCk7XG5cdFx0XHR0aGlzLmRvY3VtZW50LmFkZEV2ZW50cyh7XG5cdFx0XHRcdG1vdXNlbW92ZTogdGhpcy5ib3VuZC5kcmFnLFxuXHRcdFx0XHRtb3VzZXVwOiB0aGlzLmJvdW5kLnN0b3Bcblx0XHRcdH0pO1xuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRzKHtcblx0XHRcdFx0dG91Y2htb3ZlOiB0aGlzLmJvdW5kLmRyYWcsXG5cdFx0XHRcdHRvdWNoZW5kOiB0aGlzLmJvdW5kLnN0b3Bcblx0XHRcdH0pO1xuXHRcdFx0dGhpcy5maXJlRXZlbnQoJ3N0YXJ0JywgW3RoaXMuZWxlbWVudCwgZXZlbnRdKS5maXJlRXZlbnQoJ3NuYXAnLCB0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0fSxcblxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50cyh7XG5cdFx0XHR0b3VjaG1vdmU6IHRoaXMuYm91bmQuY2hlY2ssXG5cdFx0XHR0b3VjaGVuZDogdGhpcy5ib3VuZC5jYW5jZWxcblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdHN0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50cyh7XG5cdFx0XHR0b3VjaG1vdmU6IHRoaXMuYm91bmQuZHJhZyxcblx0XHRcdHRvdWNoZW5kOiB0aGlzLmJvdW5kLnN0b3Bcblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9XG59KTtcblxuLypcbi0tLVxuXG5uYW1lOiBTb3J0YWJsZXNcblxuZGVzY3JpcHRpb246IEV4dGVuZHMgdGhlIGJhc2UgU29ydGFibGVzIGNsYXNzIHdpdGggdG91Y2ggc3VwcG9ydC5cblxubGljZW5zZTogTEdQTHYzXG5cbmF1dGhvcnM6XG4gLSBBbmRyZWFzIFNjaGVtcHBcblxucmVxdWlyZXM6IFtTb3J0YWJsZXNdXG5cbnByb3ZpZGVzOiBTb3J0YWJsZXNcblxuLi4uXG4qL1xuXG5DbGFzcy5yZWZhY3RvcihTb3J0YWJsZXMsXG57XG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKGxpc3RzLCBvcHRpb25zKSB7XG5cdFx0b3B0aW9ucy5kcmFnT3B0aW9ucyA9IE9iamVjdC5tZXJnZShvcHRpb25zLmRyYWdPcHRpb25zIHx8IHt9LCB7IHByZXZlbnREZWZhdWx0OiAob3B0aW9ucy5kcmFnT3B0aW9ucyAmJiBvcHRpb25zLmRyYWdPcHRpb25zLnByZXZlbnREZWZhdWx0KSB8fCBCcm93c2VyLkZlYXR1cmVzLlRvdWNoIH0pO1xuXHRcdGlmIChvcHRpb25zLmRyYWdPcHRpb25zLnVuRHJhZ2dhYmxlVGFncyA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRvcHRpb25zLmRyYWdPcHRpb25zLnVuRHJhZ2dhYmxlVGFncyA9IHRoaXMub3B0aW9ucy51bkRyYWdnYWJsZVRhZ3MuZmlsdGVyKGZ1bmN0aW9uKHRhZykge1xuXHRcdFx0XHRyZXR1cm4gdGFnICE9ICdidXR0b24nO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnByZXZpb3VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0YWRkSXRlbXM6IGZ1bmN0aW9uKCkge1xuXHRcdEFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5lYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHRcdHRoaXMuZWxlbWVudHMucHVzaChlbGVtZW50KTtcblx0XHRcdHZhciBzdGFydCA9IGVsZW1lbnQucmV0cmlldmUoJ3NvcnRhYmxlczpzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdHRoaXMuc3RhcnQuY2FsbCh0aGlzLCBldmVudCwgZWxlbWVudCk7XG5cdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdFx0KHRoaXMub3B0aW9ucy5oYW5kbGUgPyBlbGVtZW50LmdldEVsZW1lbnQodGhpcy5vcHRpb25zLmhhbmRsZSkgfHwgZWxlbWVudCA6IGVsZW1lbnQpLmFkZEV2ZW50cyh7XG5cdFx0XHRcdG1vdXNlZG93bjogc3RhcnQsXG5cdFx0XHRcdHRvdWNoc3RhcnQ6IHN0YXJ0XG5cdFx0XHR9KTtcblx0XHR9LCB0aGlzKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZW1vdmVJdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICQkKEFycmF5LmZsYXR0ZW4oYXJndW1lbnRzKS5tYXAoZnVuY3Rpb24oZWxlbWVudCkge1xuXHRcdFx0dGhpcy5lbGVtZW50cy5lcmFzZShlbGVtZW50KTtcblx0XHRcdHZhciBzdGFydCA9IGVsZW1lbnQucmV0cmlldmUoJ3NvcnRhYmxlczpzdGFydCcpO1xuXHRcdFx0KHRoaXMub3B0aW9ucy5oYW5kbGUgPyBlbGVtZW50LmdldEVsZW1lbnQodGhpcy5vcHRpb25zLmhhbmRsZSkgfHwgZWxlbWVudCA6IGVsZW1lbnQpLnJlbW92ZUV2ZW50cyh7XG5cdFx0XHRcdG1vdXNlZG93bjogc3RhcnQsXG5cdFx0XHRcdHRvdWNoZW5kOiBzdGFydFxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZWxlbWVudDtcblx0XHR9LCB0aGlzKSk7XG5cdH0sXG5cblx0Z2V0Q2xvbmU6IGZ1bmN0aW9uKGV2ZW50LCBlbGVtZW50KSB7XG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuY2xvbmUpIHJldHVybiBuZXcgRWxlbWVudChlbGVtZW50LnRhZ05hbWUpLmluamVjdChkb2N1bWVudC5ib2R5KTtcblx0XHRpZiAodHlwZU9mKHRoaXMub3B0aW9ucy5jbG9uZSkgPT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHRoaXMub3B0aW9ucy5jbG9uZS5jYWxsKHRoaXMsIGV2ZW50LCBlbGVtZW50LCB0aGlzLmxpc3QpO1xuXHRcdHZhciBjbG9uZSA9IHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRjbG9uZS5hZGRFdmVudCgndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRlbGVtZW50LmZpcmVFdmVudCgndG91Y2hzdGFydCcsIGV2ZW50KTtcblx0XHR9KTtcblx0XHRyZXR1cm4gY2xvbmU7XG5cdH1cbn0pO1xuXG4vKlxuLS0tXG5cbnNjcmlwdDogUmVxdWVzdC5RdWV1ZS5qc1xuXG5uYW1lOiBSZXF1ZXN0LlF1ZXVlXG5cbmRlc2NyaXB0aW9uOiBFeHRlbmRzIHRoZSBiYXNlIFJlcXVlc3QuUXVldWUgY2xhc3MgYW5kIGF0dGVtcHRzIHRvIGZpeCBzb21lIGlzc3Vlcy5cblxubGljZW5zZTogTUlULXN0eWxlIGxpY2Vuc2VcblxuYXV0aG9yczpcbiAtIExlbyBGZXllclxuXG5yZXF1aXJlczpcblx0LSBDb3JlL0VsZW1lbnRcblx0LSBDb3JlL1JlcXVlc3Rcblx0LSBDbGFzcy5CaW5kc1xuXG5wcm92aWRlczogW1JlcXVlc3QuUXVldWVdXG5cbi4uLlxuKi9cblxuQ2xhc3MucmVmYWN0b3IoUmVxdWVzdC5RdWV1ZSxcbntcblx0Ly8gRG8gbm90IGZpcmUgdGhlIFwiZW5kXCIgZXZlbnQgaGVyZVxuXHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMuZmlyZUV2ZW50KCdjb21wbGV0ZScsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0Ly8gQ2FsbCByZXN1bWUoKSBpbnN0ZWFkIG9mIHJ1bk5leHQoKVxuXHRvbkNhbmNlbDogZnVuY3Rpb24oKXtcblx0XHRpZiAodGhpcy5vcHRpb25zLmF1dG9BZHZhbmNlICYmICF0aGlzLmVycm9yKSB0aGlzLnJlc3VtZSgpO1xuXHRcdHRoaXMuZmlyZUV2ZW50KCdjYW5jZWwnLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdC8vIENhbGwgcmVzdW1lKCkgaW5zdGVhZCBvZiBydW5OZXh0KCkgYW5kIGZpcmUgdGhlIFwiZW5kXCIgZXZlbnRcblx0b25TdWNjZXNzOiBmdW5jdGlvbigpe1xuXHRcdGlmICh0aGlzLm9wdGlvbnMuYXV0b0FkdmFuY2UgJiYgIXRoaXMuZXJyb3IpIHRoaXMucmVzdW1lKCk7XG5cdFx0dGhpcy5maXJlRXZlbnQoJ3N1Y2Nlc3MnLCBhcmd1bWVudHMpO1xuXHRcdGlmICghdGhpcy5xdWV1ZS5sZW5ndGggJiYgIXRoaXMuaXNSdW5uaW5nKCkpIHRoaXMuZmlyZUV2ZW50KCdlbmQnKTtcblx0fSxcblxuXHQvLyBDYWxsIHJlc3VtZSgpIGluc3RlYWQgb2YgcnVuTmV4dCgpIGFuZCBmaXJlIHRoZSBcImVuZFwiIGV2ZW50XG5cdG9uRmFpbHVyZTogZnVuY3Rpb24oKXtcblx0XHR0aGlzLmVycm9yID0gdHJ1ZTtcblx0XHRpZiAoIXRoaXMub3B0aW9ucy5zdG9wT25GYWlsdXJlICYmIHRoaXMub3B0aW9ucy5hdXRvQWR2YW5jZSkgdGhpcy5yZXN1bWUoKTtcblx0XHR0aGlzLmZpcmVFdmVudCgnZmFpbHVyZScsIGFyZ3VtZW50cyk7XG5cdFx0aWYgKCF0aGlzLnF1ZXVlLmxlbmd0aCAmJiAhdGhpcy5pc1J1bm5pbmcoKSkgdGhpcy5maXJlRXZlbnQoJ2VuZCcpO1xuXHR9LFxuXG5cdC8vIENhbGwgcmVzdW1lKCkgaW5zdGVhZCBvZiBydW5OZXh0KClcblx0b25FeGNlcHRpb246IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5lcnJvciA9IHRydWU7XG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuc3RvcE9uRmFpbHVyZSAmJiB0aGlzLm9wdGlvbnMuYXV0b0FkdmFuY2UpIHRoaXMucmVzdW1lKCk7XG5cdFx0dGhpcy5maXJlRXZlbnQoJ2V4Y2VwdGlvbicsIGFyZ3VtZW50cyk7XG5cdH1cbn0pO1xuXG4vKlxuLS0tXG5cbm5hbWU6IENvbnRhby5TZXJwUHJldmlld1xuXG5kZXNjcmlwdGlvbjogR2VuZXJhdGVzIGEgU0VSUCBwcmV2aWV3XG5cbmxpY2Vuc2U6IExHUEx2M1xuXG5hdXRob3JzOlxuIC0gTGVvIEZleWVyXG5cbnJlcXVpcmVzOiBbUmVxdWVzdCwgSlNPTl1cblxucHJvdmlkZXM6IENvbnRhby5TZXJwUHJldmlld1xuXG4uLi5cbiovXG5cbkNvbnRhby5TZXJwUHJldmlldyA9IG5ldyBDbGFzcyhcbntcblx0b3B0aW9uczoge1xuXHRcdGlkOiAwLFxuXHRcdHRyYWlsOiBudWxsLFxuXHRcdHRpdGxlRmllbGQ6IG51bGwsXG5cdFx0dGl0bGVGYWxsYmFja0ZpZWxkOiBudWxsLFxuXHRcdGFsaWFzRmllbGQ6IG51bGwsXG5cdFx0ZGVzY3JpcHRpb25GaWVsZDogbnVsbCxcblx0XHRkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQ6IG51bGwsXG5cdFx0dGl0bGVUYWc6IG51bGxcblx0fSxcblxuXHRzaG9ydGVuOiBmdW5jdGlvbihzdHIsIG1heCkge1xuXHRcdGlmIChzdHIubGVuZ3RoIDw9IG1heCkge1xuXHRcdFx0cmV0dXJuIHN0cjtcblx0XHR9XG5cdFx0cmV0dXJuIHN0ci5zdWJzdHIoMCwgc3RyLmxhc3RJbmRleE9mKCcgJywgbWF4KSkgKyAnIOKApic7XG5cdH0sXG5cblx0aHRtbDJzdHJpbmc6IGZ1bmN0aW9uKGh0bWwpIHtcblx0XHRyZXR1cm4gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sLCAndGV4dC9odG1sJykuYm9keS50ZXh0Q29udGVudC5yZXBsYWNlKC9cXFstXS9nLCAnXFx4QUQnKS5yZXBsYWNlKC9cXFtuYnNwXS9nLCAnXFx4QTAnKTtcblx0fSxcblxuXHRnZXRUaW55bWNlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAod2luZG93LnRpbnlNQ0UgJiYgdGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCkge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy50aW55TUNFLmdldCh0aGlzLm9wdGlvbnMuZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkKTtcblx0XHR9XG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0VHVyYm8uY2FjaGUuZXhlbXB0UGFnZUZyb21DYWNoZSgpO1xuXG5cdFx0dGhpcy5vcHRpb25zID0gT2JqZWN0Lm1lcmdlLmFwcGx5KG51bGwsIFt7fSwgdGhpcy5vcHRpb25zXS5hcHBlbmQoYXJndW1lbnRzKSk7XG5cblx0XHR2YXIgc2VycFRpdGxlID0gJCgnc2VycF90aXRsZV8nICsgdGhpcy5vcHRpb25zLmlkKSxcblx0XHRcdHNlcnBVcmwgPSAkKCdzZXJwX3VybF8nICsgdGhpcy5vcHRpb25zLmlkKSxcblx0XHRcdHNlcnBEZXNjcmlwdGlvbiA9ICQoJ3NlcnBfZGVzY3JpcHRpb25fJyArIHRoaXMub3B0aW9ucy5pZCksXG5cdFx0XHR0aXRsZUZpZWxkID0gJCh0aGlzLm9wdGlvbnMudGl0bGVGaWVsZCksXG5cdFx0XHR0aXRsZUZhbGxiYWNrRmllbGQgPSAkKHRoaXMub3B0aW9ucy50aXRsZUZhbGxiYWNrRmllbGQpLFxuXHRcdFx0YWxpYXNGaWVsZCA9ICQodGhpcy5vcHRpb25zLmFsaWFzRmllbGQpLFxuXHRcdFx0ZGVzY3JpcHRpb25GaWVsZCA9ICQodGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uRmllbGQpLFxuXHRcdFx0ZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkID0gJCh0aGlzLm9wdGlvbnMuZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkKSxcblx0XHRcdGluZGV4RW1wdHkgPSB0aGlzLm9wdGlvbnMudHJhaWwuaW5kZXhPZign4oC6JykgPT09IC0xLFxuXHRcdFx0dGl0bGVUYWcgPSB0aGlzLm9wdGlvbnMudGl0bGVUYWcgfHwgJyVzJztcblxuXHRcdHRpdGxlRmllbGQgJiYgdGl0bGVGaWVsZC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aXRsZUZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBUaXRsZS5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh0aXRsZVRhZy5yZXBsYWNlKC8lcy8sIHRpdGxlRmllbGQudmFsdWUpKS5yZXBsYWNlKC8lJS9nLCAnJScpLCA2NCkpO1xuXHRcdFx0fSBlbHNlIGlmICh0aXRsZUZhbGxiYWNrRmllbGQgJiYgdGl0bGVGYWxsYmFja0ZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBUaXRsZS5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh0aXRsZVRhZy5yZXBsYWNlKC8lcy8sIHRpdGxlRmFsbGJhY2tGaWVsZC52YWx1ZSkpLnJlcGxhY2UoLyUlL2csICclJyksIDY0KSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXJwVGl0bGUuc2V0KCd0ZXh0JywgJycpO1xuXHRcdFx0fVxuXHRcdH0uYmluZCh0aGlzKSk7XG5cblx0XHR0aXRsZUZhbGxiYWNrRmllbGQgJiYgdGl0bGVGYWxsYmFja0ZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKHRpdGxlRmllbGQgJiYgdGl0bGVGaWVsZC52YWx1ZSkgcmV0dXJuO1xuXHRcdFx0c2VycFRpdGxlLnNldCgndGV4dCcsIHRoaXMuc2hvcnRlbih0aGlzLmh0bWwyc3RyaW5nKHRpdGxlVGFnLnJlcGxhY2UoLyVzLywgdGl0bGVGYWxsYmFja0ZpZWxkLnZhbHVlKSkucmVwbGFjZSgvJSUvZywgJyUnKSwgNjQpKTtcblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0YWxpYXNGaWVsZCAmJiBhbGlhc0ZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGFsaWFzRmllbGQudmFsdWUgPT0gJ2luZGV4JyAmJiBpbmRleEVtcHR5KSB7XG5cdFx0XHRcdHNlcnBVcmwuc2V0KCd0ZXh0JywgdGhpcy5vcHRpb25zLnRyYWlsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlcnBVcmwuc2V0KCd0ZXh0JywgdGhpcy5vcHRpb25zLnRyYWlsICsgJyDigLogJyArIChhbGlhc0ZpZWxkLnZhbHVlIHx8IHRoaXMub3B0aW9ucy5pZCkucmVwbGFjZSgvXFwvL2csICcg4oC6ICcpKTtcblx0XHRcdH1cblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0ZGVzY3JpcHRpb25GaWVsZCAmJiBkZXNjcmlwdGlvbkZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGRlc2NyaXB0aW9uRmllbGQudmFsdWUpIHtcblx0XHRcdFx0c2VycERlc2NyaXB0aW9uLnNldCgndGV4dCcsIHRoaXMuc2hvcnRlbihkZXNjcmlwdGlvbkZpZWxkLnZhbHVlLCAxNjApKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGVkaXRvciA9IHRoaXMuZ2V0VGlueW1jZSgpO1xuXHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcoZWRpdG9yLmdldENvbnRlbnQoKSksIDE2MCkpO1xuXHRcdFx0fSBlbHNlIGlmIChkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQgJiYgZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyhkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQudmFsdWUpLCAxNjApKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCAnJyk7XG5cdFx0XHR9XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdGRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCAmJiBkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQuYWRkRXZlbnQoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoZGVzY3JpcHRpb25GaWVsZCAmJiBkZXNjcmlwdGlvbkZpZWxkLnZhbHVlKSByZXR1cm47XG5cdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcoZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkLnZhbHVlKSwgMTYwKSk7XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZWRpdG9yID0gdGhpcy5nZXRUaW55bWNlKCk7XG5cdFx0XHRlZGl0b3IgJiYgZWRpdG9yLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoZGVzY3JpcHRpb25GaWVsZCAmJiBkZXNjcmlwdGlvbkZpZWxkLnZhbHVlKSByZXR1cm47XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh3aW5kb3cudGlueU1DRS5hY3RpdmVFZGl0b3IuZ2V0Q29udGVudCgpKSwgMTYwKSk7XG5cdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdH0uYmluZCh0aGlzKSwgNCk7XG5cdH1cbn0pO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgY29uc3QgaW5pdGlhbGl6ZWRSb3dzID0gbmV3IFdlYWtNYXAoKTtcbiAgICBjb25zdCBzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQgPSBuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKTtcblxuICAgIGNvbnN0IGluaXQgPSAocm93KSA9PiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoaXMgcm93IGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGl6ZWRcbiAgICAgICAgaWYgKGluaXRpYWxpemVkUm93cy5oYXMocm93KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJvdyBoYXMgYWxsIG5lY2Vzc2FyeSBlbGVtZW50cyB0byBwcmV2ZW50IHRoZSBtdXRhdGlvbiBvYnNlcnZlclxuICAgICAgICAvLyBmcm9tIGluaXRpYWxpemluZyB0aGUgaW5jb21wbGV0ZSB3aWRnZXQuXG4gICAgICAgIGlmICghcm93LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbi5kcmFnLWhhbmRsZScpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpbml0aWFsaXplZFJvd3Muc2V0KHJvdywgdHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgdGJvZHkgPSByb3cuY2xvc2VzdCgndGJvZHknKTtcblxuICAgICAgICBjb25zdCBtYWtlU29ydGFibGUgPSAodGJvZHkpID0+IHtcbiAgICAgICAgICAgIEFycmF5LmZyb20odGJvZHkuY2hpbGRyZW4pLmZvckVhY2goKHRyLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHNlbGVjdCcpLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGVsLm5hbWUgPSBlbC5uYW1lLnJlcGxhY2UoL1xcW1swLTldK10vZywgJ1snICsgaSArICddJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVE9ETzogcmVwbGFjZSB0aGlzIHdpdGggYSB2YW5pbGxhIEpTIHNvbHV0aW9uXG4gICAgICAgICAgICBuZXcgU29ydGFibGVzKHRib2R5LCB7XG4gICAgICAgICAgICAgICAgY29uc3RyYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNixcbiAgICAgICAgICAgICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgICAgICAgICAgIG9uQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGFkZEV2ZW50c1RvID0gKHRyKSA9PiB7XG4gICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKS5mb3JFYWNoKChidCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBidC5kYXRhc2V0LmNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29weSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG50ciA9IHRyLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RzID0gdHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnNlbGVjdHMgPSBudHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaj0wOyBqPHNlbGVjdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnNlbGVjdHNbal0udmFsdWUgPSBzZWxlY3RzW2pdLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShudHIsIHRyLm5leHRTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudHNUbyhudHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0Ym9keS5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHZhbHVlcyBmb3IgbGFzdCBlbGVtZW50ICgjNjg5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3QnKS5mb3JFYWNoKChzZWxlY3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdC52YWx1ZSA9IHNlbGVjdC5jaGlsZHJlblswXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkcmFnLWhhbmRsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93VXAnIHx8IGV2ZW50LmtleUNvZGUgPT09IDM4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93RG93bicgfHwgZXZlbnQua2V5Q29kZSA9PT0gNDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHIubmV4dEVsZW1lbnRTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIubmV4dEVsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIHRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICBhZGRFdmVudHNUbyhyb3cpO1xuICAgIH07XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGxfc2VjdGlvbndpemFyZCB0cicpLmZvckVhY2goaW5pdCk7XG5cbiAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnNMaXN0KSB7XG4gICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xuICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgbXV0YXRpb24uYWRkZWROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQubWF0Y2hlcyAmJiBlbGVtZW50Lm1hdGNoZXMoJy50bF9zZWN0aW9ud2l6YXJkIHRyLCAudGxfc2VjdGlvbndpemFyZCB0ciAqJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQoZWxlbWVudC5jbG9zZXN0KCd0cicpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KS5vYnNlcnZlKGRvY3VtZW50LCB7XG4gICAgICAgIGF0dHJpYnV0ZXM6IGZhbHNlLFxuICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICB9KTtcbn0pKCk7XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcbmltcG9ydCB7IGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwsIGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuLCBzdGFydEF1dGhlbnRpY2F0aW9uLCBzdGFydFJlZ2lzdHJhdGlvbiB9IGZyb20gJ0BzaW1wbGV3ZWJhdXRobi9icm93c2VyJztcblxuY2xhc3MgZGVmYXVsdF8xIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuY29ubmVjdCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIHJlcXVlc3RSZXN1bHRVcmw6IHRoaXMucmVxdWVzdFJlc3VsdFVybFZhbHVlLFxuICAgICAgICAgICAgICAgIHJlcXVlc3RPcHRpb25zVXJsOiB0aGlzLnJlcXVlc3RPcHRpb25zVXJsVmFsdWUsXG4gICAgICAgICAgICAgICAgcmVxdWVzdFN1Y2Nlc3NSZWRpcmVjdFVyaTogKF9hID0gdGhpcy5yZXF1ZXN0U3VjY2Vzc1JlZGlyZWN0VXJpVmFsdWUpICE9PSBudWxsICYmIF9hICE9PSB1bmRlZmluZWQgPyBfYSA6IG51bGwsXG4gICAgICAgICAgICAgICAgY3JlYXRpb25SZXN1bHRVcmw6IHRoaXMuY3JlYXRpb25SZXN1bHRVcmxWYWx1ZSxcbiAgICAgICAgICAgICAgICBjcmVhdGlvbk9wdGlvbnNVcmw6IHRoaXMuY3JlYXRpb25PcHRpb25zVXJsVmFsdWUsXG4gICAgICAgICAgICAgICAgY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmk6IChfYiA9IHRoaXMuY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSkgIT09IG51bGwgJiYgX2IgIT09IHVuZGVmaW5lZCA/IF9iIDogbnVsbCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCd3ZWJhdXRobjpjb25uZWN0JywgeyBvcHRpb25zIH0pO1xuICAgICAgICAgICAgY29uc3Qgc3VwcG9ydEF1dG9maWxsID0gYXdhaXQgYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbCgpO1xuICAgICAgICAgICAgaWYgKHN1cHBvcnRBdXRvZmlsbCAmJiB0aGlzLnVzZUJyb3dzZXJBdXRvZmlsbFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uc1Jlc3BvbnNlSnNvbiA9IGF3YWl0IHRoaXMuX2dldFB1YmxpY0tleUNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyh7fSk7XG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zUmVzcG9uc2VKc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvY2Vzc1NpZ25pbihvcHRpb25zUmVzcG9uc2VKc29uLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXN5bmMgc2lnbmluKGV2ZW50KSB7XG4gICAgICAgIGlmICghYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4oKSkge1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46dW5zdXBwb3J0ZWQnLCB7fSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uc1Jlc3BvbnNlSnNvbiA9IGF3YWl0IHRoaXMuX2dldFB1YmxpY0tleUNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyhudWxsKTtcbiAgICAgICAgaWYgKCFvcHRpb25zUmVzcG9uc2VKc29uKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcHJvY2Vzc1NpZ25pbihvcHRpb25zUmVzcG9uc2VKc29uLCBmYWxzZSk7XG4gICAgfVxuICAgIGFzeW5jIF9wcm9jZXNzU2lnbmluKG9wdGlvbnNSZXNwb25zZUpzb24sIHVzZUJyb3dzZXJBdXRvZmlsbCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgYXV0aGVudGljYXRvclJlc3BvbnNlID0gYXdhaXQgc3RhcnRBdXRoZW50aWNhdGlvbihvcHRpb25zUmVzcG9uc2VKc29uLCB1c2VCcm93c2VyQXV0b2ZpbGwpO1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46YXV0aGVudGljYXRvcjpyZXNwb25zZScsIHsgcmVzcG9uc2U6IGF1dGhlbnRpY2F0b3JSZXNwb25zZSB9KTtcbiAgICAgICAgICAgIGNvbnN0IGFzc2VydGlvblJlc3BvbnNlID0gYXdhaXQgdGhpcy5fZ2V0QXNzZXJ0aW9uUmVzcG9uc2UoYXV0aGVudGljYXRvclJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmIChhc3NlcnRpb25SZXNwb25zZSAhPT0gZmFsc2UgJiYgdGhpcy5yZXF1ZXN0U3VjY2Vzc1JlZGlyZWN0VXJpVmFsdWUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZSh0aGlzLnJlcXVlc3RTdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3dlYmF1dGhuOmFzc2VydGlvbjpmYWlsdXJlJywgeyBleGNlcHRpb246IGUsIGFzc2VydGlvblJlc3BvbnNlOiBudWxsIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIHNpZ251cChldmVudCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46dW5zdXBwb3J0ZWQnLCB7fSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNSZXNwb25zZUpzb24gPSBhd2FpdCB0aGlzLl9nZXRQdWJsaWNLZXlDcmVkZW50aWFsQ3JlYXRpb25PcHRpb25zKG51bGwpO1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zUmVzcG9uc2VKc29uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXV0aGVudGljYXRvclJlc3BvbnNlID0gYXdhaXQgc3RhcnRSZWdpc3RyYXRpb24ob3B0aW9uc1Jlc3BvbnNlSnNvbik7XG4gICAgICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCd3ZWJhdXRobjphdXRoZW50aWNhdG9yOnJlc3BvbnNlJywgeyByZXNwb25zZTogYXV0aGVudGljYXRvclJlc3BvbnNlIH0pO1xuICAgICAgICAgICAgY29uc3QgYXR0ZXN0YXRpb25SZXNwb25zZUpTT04gPSBhd2FpdCB0aGlzLl9nZXRBdHRlc3RhdGlvblJlc3BvbnNlKGF1dGhlbnRpY2F0b3JSZXNwb25zZSk7XG4gICAgICAgICAgICBpZiAoYXR0ZXN0YXRpb25SZXNwb25zZUpTT04gIT09IGZhbHNlICYmIHRoaXMuY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHRoaXMuY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3dlYmF1dGhuOmF0dGVzdGF0aW9uOmZhaWx1cmUnLCB7IGV4Y2VwdGlvbjogZSwgYXNzZXJ0aW9uUmVzcG9uc2U6IG51bGwgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2Rpc3BhdGNoRXZlbnQobmFtZSwgcGF5bG9hZCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQobmFtZSwgeyBkZXRhaWw6IHBheWxvYWQsIGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgIH1cbiAgICBfZ2V0RGF0YSgpIHtcbiAgICAgICAgbGV0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZXBvcnRWYWxpZGl0eSgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQuY2hlY2tWYWxpZGl0eSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YSA9IG5ldyBGb3JtRGF0YSh0aGlzLmVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlRW1wdHkob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMob2JqKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoKFssIHZdKSA9PiB2ICE9PSBudWxsICYmIHYgIT09ICcnKVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGFjYywgW2ssIHZdKSA9PiAoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBhY2MpLCB7IFtrXTogdiA9PT0gT2JqZWN0KHYpID8gcmVtb3ZlRW1wdHkodikgOiB2IH0pKSwge30pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW1vdmVFbXB0eSh7XG4gICAgICAgICAgICB1c2VybmFtZTogZGF0YS5nZXQodGhpcy51c2VybmFtZUZpZWxkVmFsdWUpLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IGRhdGEuZ2V0KHRoaXMuZGlzcGxheU5hbWVGaWVsZFZhbHVlKSxcbiAgICAgICAgICAgIGF0dGVzdGF0aW9uOiBkYXRhLmdldCh0aGlzLmF0dGVzdGF0aW9uRmllbGRWYWx1ZSksXG4gICAgICAgICAgICB1c2VyVmVyaWZpY2F0aW9uOiBkYXRhLmdldCh0aGlzLnVzZXJWZXJpZmljYXRpb25GaWVsZFZhbHVlKSxcbiAgICAgICAgICAgIHJlc2lkZW50S2V5OiBkYXRhLmdldCh0aGlzLnJlc2lkZW50S2V5RmllbGRWYWx1ZSksXG4gICAgICAgICAgICBhdXRoZW50aWNhdG9yQXR0YWNobWVudDogZGF0YS5nZXQodGhpcy5hdXRoZW50aWNhdG9yQXR0YWNobWVudEZpZWxkVmFsdWUpLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXN5bmMgX2dldFB1YmxpY0tleUNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyhmb3JtRGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0T3B0aW9ucyh0aGlzLnJlcXVlc3RPcHRpb25zVXJsVmFsdWUsIGZvcm1EYXRhKTtcbiAgICB9XG4gICAgYXN5bmMgX2dldFB1YmxpY0tleUNyZWRlbnRpYWxDcmVhdGlvbk9wdGlvbnMoZm9ybURhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldE9wdGlvbnModGhpcy5jcmVhdGlvbk9wdGlvbnNVcmxWYWx1ZSwgZm9ybURhdGEpO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0T3B0aW9ucyh1cmwsIGZvcm1EYXRhKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBmb3JtRGF0YSB8fCB0aGlzLl9nZXREYXRhKCk7XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3dlYmF1dGhuOm9wdGlvbnM6cmVxdWVzdCcsIHsgZGF0YSB9KTtcbiAgICAgICAgY29uc3Qgb3B0aW9uc1Jlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnJlcXVlc3RIZWFkZXJzVmFsdWUpLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFvcHRpb25zUmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3dlYmF1dGhuOm9wdGlvbnM6ZmFpbHVyZScsIHsgZXhjZXB0aW9uOiBudWxsLCBvcHRpb25zUmVzcG9uc2UgfSk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGF3YWl0IG9wdGlvbnNSZXNwb25zZS5qc29uKCk7XG4gICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3dlYmF1dGhuOm9wdGlvbnM6c3VjY2VzcycsIHsgZGF0YTogb3B0aW9ucyB9KTtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuICAgIGFzeW5jIF9nZXRBdHRlc3RhdGlvblJlc3BvbnNlKGF1dGhlbnRpY2F0b3JSZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UmVzdWx0KHRoaXMuY3JlYXRpb25SZXN1bHRVcmxWYWx1ZSwgJ3dlYmF1dGhuOmF0dGVzdGF0aW9uOicsIGF1dGhlbnRpY2F0b3JSZXNwb25zZSk7XG4gICAgfVxuICAgIGFzeW5jIF9nZXRBc3NlcnRpb25SZXNwb25zZShhdXRoZW50aWNhdG9yUmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFJlc3VsdCh0aGlzLnJlcXVlc3RSZXN1bHRVcmxWYWx1ZSwgJ3dlYmF1dGhuOmFzc2VydGlvbjonLCBhdXRoZW50aWNhdG9yUmVzcG9uc2UpO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0UmVzdWx0KHVybCwgZXZlbnRQcmVmaXgsIGF1dGhlbnRpY2F0b3JSZXNwb25zZSkge1xuICAgICAgICBjb25zdCBhdHRlc3RhdGlvblJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnJlcXVlc3RIZWFkZXJzVmFsdWUpLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShhdXRoZW50aWNhdG9yUmVzcG9uc2UpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWF0dGVzdGF0aW9uUmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoZXZlbnRQcmVmaXggKyAnZmFpbHVyZScsIHt9KTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhdHRlc3RhdGlvblJlc3BvbnNlSlNPTiA9IGF3YWl0IGF0dGVzdGF0aW9uUmVzcG9uc2UuanNvbigpO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KGV2ZW50UHJlZml4ICsgJ3N1Y2Nlc3MnLCB7IGRhdGE6IGF0dGVzdGF0aW9uUmVzcG9uc2VKU09OIH0pO1xuICAgICAgICByZXR1cm4gYXR0ZXN0YXRpb25SZXNwb25zZUpTT047XG4gICAgfVxufVxuZGVmYXVsdF8xLnZhbHVlcyA9IHtcbiAgICByZXF1ZXN0UmVzdWx0VXJsOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJy9yZXF1ZXN0JyB9LFxuICAgIHJlcXVlc3RPcHRpb25zVXJsOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJy9yZXF1ZXN0L29wdGlvbnMnIH0sXG4gICAgcmVxdWVzdFN1Y2Nlc3NSZWRpcmVjdFVyaTogU3RyaW5nLFxuICAgIGNyZWF0aW9uUmVzdWx0VXJsOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJy9jcmVhdGlvbicgfSxcbiAgICBjcmVhdGlvbk9wdGlvbnNVcmw6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnL2NyZWF0aW9uL29wdGlvbnMnIH0sXG4gICAgY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmk6IFN0cmluZyxcbiAgICB1c2VybmFtZUZpZWxkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ3VzZXJuYW1lJyB9LFxuICAgIGRpc3BsYXlOYW1lRmllbGQ6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnZGlzcGxheU5hbWUnIH0sXG4gICAgYXR0ZXN0YXRpb25GaWVsZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICdhdHRlc3RhdGlvbicgfSxcbiAgICB1c2VyVmVyaWZpY2F0aW9uRmllbGQ6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAndXNlclZlcmlmaWNhdGlvbicgfSxcbiAgICByZXNpZGVudEtleUZpZWxkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ3Jlc2lkZW50S2V5JyB9LFxuICAgIGF1dGhlbnRpY2F0b3JBdHRhY2htZW50RmllbGQ6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnYXV0aGVudGljYXRvckF0dGFjaG1lbnQnIH0sXG4gICAgdXNlQnJvd3NlckF1dG9maWxsOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IGZhbHNlIH0sXG4gICAgcmVxdWVzdEhlYWRlcnM6IHsgdHlwZTogT2JqZWN0LCBkZWZhdWx0OiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdtb2RlJzogJ25vLWNvcnMnLFxuICAgICAgICAgICAgJ2NyZWRlbnRpYWxzJzogJ2luY2x1ZGUnXG4gICAgICAgIH0gfSxcbn07XG5cbmV4cG9ydCB7IGRlZmF1bHRfMSBhcyBkZWZhdWx0IH07XG4iLCIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cbmV4cG9ydCB7fTsiLCIvKipcbiAqIENvbnZlcnQgZnJvbSBhIEJhc2U2NFVSTC1lbmNvZGVkIHN0cmluZyB0byBhbiBBcnJheSBCdWZmZXIuIEJlc3QgdXNlZCB3aGVuIGNvbnZlcnRpbmcgYVxuICogY3JlZGVudGlhbCBJRCBmcm9tIGEgSlNPTiBzdHJpbmcgdG8gYW4gQXJyYXlCdWZmZXIsIGxpa2UgaW4gYWxsb3dDcmVkZW50aWFscyBvclxuICogZXhjbHVkZUNyZWRlbnRpYWxzXG4gKlxuICogSGVscGVyIG1ldGhvZCB0byBjb21wbGltZW50IGBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZ2BcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJhc2U2NFVSTFN0cmluZ1RvQnVmZmVyKGJhc2U2NFVSTFN0cmluZykge1xuICAgIC8vIENvbnZlcnQgZnJvbSBCYXNlNjRVUkwgdG8gQmFzZTY0XG4gICAgY29uc3QgYmFzZTY0ID0gYmFzZTY0VVJMU3RyaW5nLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJyk7XG4gICAgLyoqXG4gICAgICogUGFkIHdpdGggJz0nIHVudGlsIGl0J3MgYSBtdWx0aXBsZSBvZiBmb3VyXG4gICAgICogKDQgLSAoODUgJSA0ID0gMSkgPSAzKSAlIDQgPSAzIHBhZGRpbmdcbiAgICAgKiAoNCAtICg4NiAlIDQgPSAyKSA9IDIpICUgNCA9IDIgcGFkZGluZ1xuICAgICAqICg0IC0gKDg3ICUgNCA9IDMpID0gMSkgJSA0ID0gMSBwYWRkaW5nXG4gICAgICogKDQgLSAoODggJSA0ID0gMCkgPSA0KSAlIDQgPSAwIHBhZGRpbmdcbiAgICAgKi9cbiAgICBjb25zdCBwYWRMZW5ndGggPSAoNCAtIChiYXNlNjQubGVuZ3RoICUgNCkpICUgNDtcbiAgICBjb25zdCBwYWRkZWQgPSBiYXNlNjQucGFkRW5kKGJhc2U2NC5sZW5ndGggKyBwYWRMZW5ndGgsICc9Jyk7XG4gICAgLy8gQ29udmVydCB0byBhIGJpbmFyeSBzdHJpbmdcbiAgICBjb25zdCBiaW5hcnkgPSBhdG9iKHBhZGRlZCk7XG4gICAgLy8gQ29udmVydCBiaW5hcnkgc3RyaW5nIHRvIGJ1ZmZlclxuICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihiaW5hcnkubGVuZ3RoKTtcbiAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYnl0ZXNbaV0gPSBiaW5hcnkuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZmZlcjtcbn1cbiIsIi8qKlxuICogRGV0ZXJtaW5lIGlmIHRoZSBicm93c2VyIGlzIGNhcGFibGUgb2YgV2ViYXV0aG5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkge1xuICAgIHJldHVybiBfYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5JbnRlcm5hbHMuc3R1YlRoaXMoZ2xvYmFsVGhpcz8uUHVibGljS2V5Q3JlZGVudGlhbCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIHR5cGVvZiBnbG9iYWxUaGlzLlB1YmxpY0tleUNyZWRlbnRpYWwgPT09ICdmdW5jdGlvbicpO1xufVxuLyoqXG4gKiBNYWtlIGl0IHBvc3NpYmxlIHRvIHN0dWIgdGhlIHJldHVybiB2YWx1ZSBkdXJpbmcgdGVzdGluZ1xuICogQGlnbm9yZSBEb24ndCBpbmNsdWRlIHRoaXMgaW4gZG9jcyBvdXRwdXRcbiAqL1xuZXhwb3J0IGNvbnN0IF9icm93c2VyU3VwcG9ydHNXZWJBdXRobkludGVybmFscyA9IHtcbiAgICBzdHViVGhpczogKHZhbHVlKSA9PiB2YWx1ZSxcbn07XG4iLCJpbXBvcnQgeyBicm93c2VyU3VwcG9ydHNXZWJBdXRobiB9IGZyb20gJy4vYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4uanMnO1xuLyoqXG4gKiBEZXRlcm1pbmUgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgY29uZGl0aW9uYWwgVUksIHNvIHRoYXQgV2ViQXV0aG4gY3JlZGVudGlhbHMgY2FuXG4gKiBiZSBzaG93biB0byB0aGUgdXNlciBpbiB0aGUgYnJvd3NlcidzIHR5cGljYWwgcGFzc3dvcmQgYXV0b2ZpbGwgcG9wdXAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBicm93c2VyU3VwcG9ydHNXZWJBdXRobkF1dG9maWxsKCkge1xuICAgIGlmICghYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4oKSkge1xuICAgICAgICByZXR1cm4gX2Jyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGxJbnRlcm5hbHMuc3R1YlRoaXMobmV3IFByb21pc2UoKHJlc29sdmUpID0+IHJlc29sdmUoZmFsc2UpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEkgZG9uJ3QgbGlrZSB0aGUgYGFzIHVua25vd25gIGhlcmUgYnV0IHRoZXJlJ3MgYSBgZGVjbGFyZSB2YXIgUHVibGljS2V5Q3JlZGVudGlhbGAgaW5cbiAgICAgKiBUUycgRE9NIGxpYiB0aGF0J3MgbWFraW5nIGl0IGRpZmZpY3VsdCBmb3IgbWUgdG8ganVzdCBnbyBgYXMgUHVibGljS2V5Q3JlZGVudGlhbEZ1dHVyZWAgYXMgSVxuICAgICAqIHdhbnQuIEkgdGhpbmsgSSdtIGZpbmUgd2l0aCB0aGlzIGZvciBub3cgc2luY2UgaXQncyBfc3VwcG9zZWRfIHRvIGJlIHRlbXBvcmFyeSwgdW50aWwgVFMgdHlwZXNcbiAgICAgKiBoYXZlIGEgY2hhbmNlIHRvIGNhdGNoIHVwLlxuICAgICAqL1xuICAgIGNvbnN0IGdsb2JhbFB1YmxpY0tleUNyZWRlbnRpYWwgPSBnbG9iYWxUaGlzXG4gICAgICAgIC5QdWJsaWNLZXlDcmVkZW50aWFsO1xuICAgIGlmIChnbG9iYWxQdWJsaWNLZXlDcmVkZW50aWFsPy5pc0NvbmRpdGlvbmFsTWVkaWF0aW9uQXZhaWxhYmxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIF9icm93c2VyU3VwcG9ydHNXZWJBdXRobkF1dG9maWxsSW50ZXJuYWxzLnN0dWJUaGlzKG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXNvbHZlKGZhbHNlKSkpO1xuICAgIH1cbiAgICByZXR1cm4gX2Jyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGxJbnRlcm5hbHMuc3R1YlRoaXMoZ2xvYmFsUHVibGljS2V5Q3JlZGVudGlhbC5pc0NvbmRpdGlvbmFsTWVkaWF0aW9uQXZhaWxhYmxlKCkpO1xufVxuLy8gTWFrZSBpdCBwb3NzaWJsZSB0byBzdHViIHRoZSByZXR1cm4gdmFsdWUgZHVyaW5nIHRlc3RpbmdcbmV4cG9ydCBjb25zdCBfYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbEludGVybmFscyA9IHtcbiAgICBzdHViVGhpczogKHZhbHVlKSA9PiB2YWx1ZSxcbn07XG4iLCIvKipcbiAqIENvbnZlcnQgdGhlIGdpdmVuIGFycmF5IGJ1ZmZlciBpbnRvIGEgQmFzZTY0VVJMLWVuY29kZWQgc3RyaW5nLiBJZGVhbCBmb3IgY29udmVydGluZyB2YXJpb3VzXG4gKiBjcmVkZW50aWFsIHJlc3BvbnNlIEFycmF5QnVmZmVycyB0byBzdHJpbmcgZm9yIHNlbmRpbmcgYmFjayB0byB0aGUgc2VydmVyIGFzIEpTT04uXG4gKlxuICogSGVscGVyIG1ldGhvZCB0byBjb21wbGltZW50IGBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlcmBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKGJ1ZmZlcikge1xuICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChjb25zdCBjaGFyQ29kZSBvZiBieXRlcykge1xuICAgICAgICBzdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyQ29kZSk7XG4gICAgfVxuICAgIGNvbnN0IGJhc2U2NFN0cmluZyA9IGJ0b2Eoc3RyKTtcbiAgICByZXR1cm4gYmFzZTY0U3RyaW5nLnJlcGxhY2UoL1xcKy9nLCAnLScpLnJlcGxhY2UoL1xcLy9nLCAnXycpLnJlcGxhY2UoLz0vZywgJycpO1xufVxuIiwiaW1wb3J0IHsgaXNWYWxpZERvbWFpbiB9IGZyb20gJy4vaXNWYWxpZERvbWFpbi5qcyc7XG5pbXBvcnQgeyBXZWJBdXRobkVycm9yIH0gZnJvbSAnLi93ZWJBdXRobkVycm9yLmpzJztcbi8qKlxuICogQXR0ZW1wdCB0byBpbnR1aXQgX3doeV8gYW4gZXJyb3Igd2FzIHJhaXNlZCBhZnRlciBjYWxsaW5nIGBuYXZpZ2F0b3IuY3JlZGVudGlhbHMuZ2V0KClgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpZGVudGlmeUF1dGhlbnRpY2F0aW9uRXJyb3IoeyBlcnJvciwgb3B0aW9ucywgfSkge1xuICAgIGNvbnN0IHsgcHVibGljS2V5IH0gPSBvcHRpb25zO1xuICAgIGlmICghcHVibGljS2V5KSB7XG4gICAgICAgIHRocm93IEVycm9yKCdvcHRpb25zIHdhcyBtaXNzaW5nIHJlcXVpcmVkIHB1YmxpY0tleSBwcm9wZXJ0eScpO1xuICAgIH1cbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgIGlmIChvcHRpb25zLnNpZ25hbCBpbnN0YW5jZW9mIEFib3J0U2lnbmFsKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1jcmVhdGVDcmVkZW50aWFsIChTdGVwIDE2KVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQXV0aGVudGljYXRpb24gY2VyZW1vbnkgd2FzIHNlbnQgYW4gYWJvcnQgc2lnbmFsJyxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfQ0VSRU1PTllfQUJPUlRFRCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ05vdEFsbG93ZWRFcnJvcicpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBhc3MgdGhlIGVycm9yIGRpcmVjdGx5IHRocm91Z2guIFBsYXRmb3JtcyBhcmUgb3ZlcmxvYWRpbmcgdGhpcyBlcnJvciBiZXlvbmQgd2hhdCB0aGUgc3BlY1xuICAgICAgICAgKiBkZWZpbmVzIGFuZCB3ZSBkb24ndCB3YW50IHRvIG92ZXJ3cml0ZSBwb3RlbnRpYWxseSB1c2VmdWwgZXJyb3IgbWVzc2FnZXMuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9QQVNTVEhST1VHSF9TRUVfQ0FVU0VfUFJPUEVSVFknLFxuICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ1NlY3VyaXR5RXJyb3InKSB7XG4gICAgICAgIGNvbnN0IGVmZmVjdGl2ZURvbWFpbiA9IGdsb2JhbFRoaXMubG9jYXRpb24uaG9zdG5hbWU7XG4gICAgICAgIGlmICghaXNWYWxpZERvbWFpbihlZmZlY3RpdmVEb21haW4pKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1kaXNjb3Zlci1mcm9tLWV4dGVybmFsLXNvdXJjZSAoU3RlcCA1KVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgJHtnbG9iYWxUaGlzLmxvY2F0aW9uLmhvc3RuYW1lfSBpcyBhbiBpbnZhbGlkIGRvbWFpbmAsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0lOVkFMSURfRE9NQUlOJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwdWJsaWNLZXkucnBJZCAhPT0gZWZmZWN0aXZlRG9tYWluKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1kaXNjb3Zlci1mcm9tLWV4dGVybmFsLXNvdXJjZSAoU3RlcCA2KVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgVGhlIFJQIElEIFwiJHtwdWJsaWNLZXkucnBJZH1cIiBpcyBpbnZhbGlkIGZvciB0aGlzIGRvbWFpbmAsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0lOVkFMSURfUlBfSUQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdVbmtub3duRXJyb3InKSB7XG4gICAgICAgIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNzY3RuLW9wLWdldC1hc3NlcnRpb24gKFN0ZXAgMSlcbiAgICAgICAgLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL3dlYmF1dGhuLTIvI3NjdG4tb3AtZ2V0LWFzc2VydGlvbiAoU3RlcCAxMilcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUaGUgYXV0aGVudGljYXRvciB3YXMgdW5hYmxlIHRvIHByb2Nlc3MgdGhlIHNwZWNpZmllZCBvcHRpb25zLCBvciBjb3VsZCBub3QgY3JlYXRlIGEgbmV3IGFzc2VydGlvbiBzaWduYXR1cmUnLFxuICAgICAgICAgICAgY29kZTogJ0VSUk9SX0FVVEhFTlRJQ0FUT1JfR0VORVJBTF9FUlJPUicsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXJyb3I7XG59XG4iLCJpbXBvcnQgeyBpc1ZhbGlkRG9tYWluIH0gZnJvbSAnLi9pc1ZhbGlkRG9tYWluLmpzJztcbmltcG9ydCB7IFdlYkF1dGhuRXJyb3IgfSBmcm9tICcuL3dlYkF1dGhuRXJyb3IuanMnO1xuLyoqXG4gKiBBdHRlbXB0IHRvIGludHVpdCBfd2h5XyBhbiBlcnJvciB3YXMgcmFpc2VkIGFmdGVyIGNhbGxpbmcgYG5hdmlnYXRvci5jcmVkZW50aWFscy5jcmVhdGUoKWBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlkZW50aWZ5UmVnaXN0cmF0aW9uRXJyb3IoeyBlcnJvciwgb3B0aW9ucywgfSkge1xuICAgIGNvbnN0IHsgcHVibGljS2V5IH0gPSBvcHRpb25zO1xuICAgIGlmICghcHVibGljS2V5KSB7XG4gICAgICAgIHRocm93IEVycm9yKCdvcHRpb25zIHdhcyBtaXNzaW5nIHJlcXVpcmVkIHB1YmxpY0tleSBwcm9wZXJ0eScpO1xuICAgIH1cbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgIGlmIChvcHRpb25zLnNpZ25hbCBpbnN0YW5jZW9mIEFib3J0U2lnbmFsKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1jcmVhdGVDcmVkZW50aWFsIChTdGVwIDE2KVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnUmVnaXN0cmF0aW9uIGNlcmVtb255IHdhcyBzZW50IGFuIGFib3J0IHNpZ25hbCcsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0NFUkVNT05ZX0FCT1JURUQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdDb25zdHJhaW50RXJyb3InKSB7XG4gICAgICAgIGlmIChwdWJsaWNLZXkuYXV0aGVudGljYXRvclNlbGVjdGlvbj8ucmVxdWlyZVJlc2lkZW50S2V5ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1vcC1tYWtlLWNyZWQgKFN0ZXAgNClcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0Rpc2NvdmVyYWJsZSBjcmVkZW50aWFscyB3ZXJlIHJlcXVpcmVkIGJ1dCBubyBhdmFpbGFibGUgYXV0aGVudGljYXRvciBzdXBwb3J0ZWQgaXQnLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX01JU1NJTkdfRElTQ09WRVJBQkxFX0NSRURFTlRJQUxfU1VQUE9SVCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoXG4gICAgICAgIC8vIEB0cy1pZ25vcmU6IGBtZWRpYXRpb25gIGRvZXNuJ3QgeWV0IGV4aXN0IG9uIENyZWRlbnRpYWxDcmVhdGlvbk9wdGlvbnMgYnV0IGl0J3MgcG9zc2libGUgYXMgb2YgU2VwdCAyMDI0XG4gICAgICAgIG9wdGlvbnMubWVkaWF0aW9uID09PSAnY29uZGl0aW9uYWwnICYmXG4gICAgICAgICAgICBwdWJsaWNLZXkuYXV0aGVudGljYXRvclNlbGVjdGlvbj8udXNlclZlcmlmaWNhdGlvbiA9PT0gJ3JlcXVpcmVkJykge1xuICAgICAgICAgICAgLy8gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL3dlYmF1dGhuLyNzY3RuLWNyZWF0ZUNyZWRlbnRpYWwgKFN0ZXAgMjIuNClcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VzZXIgdmVyaWZpY2F0aW9uIHdhcyByZXF1aXJlZCBkdXJpbmcgYXV0b21hdGljIHJlZ2lzdHJhdGlvbiBidXQgaXQgY291bGQgbm90IGJlIHBlcmZvcm1lZCcsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0FVVE9fUkVHSVNURVJfVVNFUl9WRVJJRklDQVRJT05fRkFJTFVSRScsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHVibGljS2V5LmF1dGhlbnRpY2F0b3JTZWxlY3Rpb24/LnVzZXJWZXJpZmljYXRpb24gPT09ICdyZXF1aXJlZCcpIHtcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNzY3RuLW9wLW1ha2UtY3JlZCAoU3RlcCA1KVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnVXNlciB2ZXJpZmljYXRpb24gd2FzIHJlcXVpcmVkIGJ1dCBubyBhdmFpbGFibGUgYXV0aGVudGljYXRvciBzdXBwb3J0ZWQgaXQnLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX01JU1NJTkdfVVNFUl9WRVJJRklDQVRJT05fU1VQUE9SVCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ0ludmFsaWRTdGF0ZUVycm9yJykge1xuICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1jcmVhdGVDcmVkZW50aWFsIChTdGVwIDIwKVxuICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1vcC1tYWtlLWNyZWQgKFN0ZXAgMylcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUaGUgYXV0aGVudGljYXRvciB3YXMgcHJldmlvdXNseSByZWdpc3RlcmVkJyxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX1BSRVZJT1VTTFlfUkVHSVNURVJFRCcsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnTm90QWxsb3dlZEVycm9yJykge1xuICAgICAgICAvKipcbiAgICAgICAgICogUGFzcyB0aGUgZXJyb3IgZGlyZWN0bHkgdGhyb3VnaC4gUGxhdGZvcm1zIGFyZSBvdmVybG9hZGluZyB0aGlzIGVycm9yIGJleW9uZCB3aGF0IHRoZSBzcGVjXG4gICAgICAgICAqIGRlZmluZXMgYW5kIHdlIGRvbid0IHdhbnQgdG8gb3ZlcndyaXRlIHBvdGVudGlhbGx5IHVzZWZ1bCBlcnJvciBtZXNzYWdlcy5cbiAgICAgICAgICovXG4gICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgY29kZTogJ0VSUk9SX1BBU1NUSFJPVUdIX1NFRV9DQVVTRV9QUk9QRVJUWScsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnTm90U3VwcG9ydGVkRXJyb3InKSB7XG4gICAgICAgIGNvbnN0IHZhbGlkUHViS2V5Q3JlZFBhcmFtcyA9IHB1YmxpY0tleS5wdWJLZXlDcmVkUGFyYW1zLmZpbHRlcigocGFyYW0pID0+IHBhcmFtLnR5cGUgPT09ICdwdWJsaWMta2V5Jyk7XG4gICAgICAgIGlmICh2YWxpZFB1YktleUNyZWRQYXJhbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1jcmVhdGVDcmVkZW50aWFsIChTdGVwIDEwKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnTm8gZW50cnkgaW4gcHViS2V5Q3JlZFBhcmFtcyB3YXMgb2YgdHlwZSBcInB1YmxpYy1rZXlcIicsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX01BTEZPUk1FRF9QVUJLRVlDUkVEUEFSQU1TJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1vcC1tYWtlLWNyZWQgKFN0ZXAgMilcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdObyBhdmFpbGFibGUgYXV0aGVudGljYXRvciBzdXBwb3J0ZWQgYW55IG9mIHRoZSBzcGVjaWZpZWQgcHViS2V5Q3JlZFBhcmFtcyBhbGdvcml0aG1zJyxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX05PX1NVUFBPUlRFRF9QVUJLRVlDUkVEUEFSQU1TX0FMRycsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnU2VjdXJpdHlFcnJvcicpIHtcbiAgICAgICAgY29uc3QgZWZmZWN0aXZlRG9tYWluID0gZ2xvYmFsVGhpcy5sb2NhdGlvbi5ob3N0bmFtZTtcbiAgICAgICAgaWYgKCFpc1ZhbGlkRG9tYWluKGVmZmVjdGl2ZURvbWFpbikpIHtcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNzY3RuLWNyZWF0ZUNyZWRlbnRpYWwgKFN0ZXAgNylcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYCR7Z2xvYmFsVGhpcy5sb2NhdGlvbi5ob3N0bmFtZX0gaXMgYW4gaW52YWxpZCBkb21haW5gLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9JTlZBTElEX0RPTUFJTicsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHVibGljS2V5LnJwLmlkICE9PSBlZmZlY3RpdmVEb21haW4pIHtcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNzY3RuLWNyZWF0ZUNyZWRlbnRpYWwgKFN0ZXAgOClcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYFRoZSBSUCBJRCBcIiR7cHVibGljS2V5LnJwLmlkfVwiIGlzIGludmFsaWQgZm9yIHRoaXMgZG9tYWluYCxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfSU5WQUxJRF9SUF9JRCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ1R5cGVFcnJvcicpIHtcbiAgICAgICAgaWYgKHB1YmxpY0tleS51c2VyLmlkLmJ5dGVMZW5ndGggPCAxIHx8IHB1YmxpY0tleS51c2VyLmlkLmJ5dGVMZW5ndGggPiA2NCkge1xuICAgICAgICAgICAgLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL3dlYmF1dGhuLTIvI3NjdG4tY3JlYXRlQ3JlZGVudGlhbCAoU3RlcCA1KVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnVXNlciBJRCB3YXMgbm90IGJldHdlZW4gMSBhbmQgNjQgY2hhcmFjdGVycycsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0lOVkFMSURfVVNFUl9JRF9MRU5HVEgnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdVbmtub3duRXJyb3InKSB7XG4gICAgICAgIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNzY3RuLW9wLW1ha2UtY3JlZCAoU3RlcCAxKVxuICAgICAgICAvLyBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jc2N0bi1vcC1tYWtlLWNyZWQgKFN0ZXAgOClcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUaGUgYXV0aGVudGljYXRvciB3YXMgdW5hYmxlIHRvIHByb2Nlc3MgdGhlIHNwZWNpZmllZCBvcHRpb25zLCBvciBjb3VsZCBub3QgY3JlYXRlIGEgbmV3IGNyZWRlbnRpYWwnLFxuICAgICAgICAgICAgY29kZTogJ0VSUk9SX0FVVEhFTlRJQ0FUT1JfR0VORVJBTF9FUlJPUicsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXJyb3I7XG59XG4iLCIvKipcbiAqIEEgc2ltcGxlIHRlc3QgdG8gZGV0ZXJtaW5lIGlmIGEgaG9zdG5hbWUgaXMgYSBwcm9wZXJseS1mb3JtYXR0ZWQgZG9tYWluIG5hbWVcbiAqXG4gKiBBIFwidmFsaWQgZG9tYWluXCIgaXMgZGVmaW5lZCBoZXJlOiBodHRwczovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3ZhbGlkLWRvbWFpblxuICpcbiAqIFJlZ2V4IHNvdXJjZWQgZnJvbSBoZXJlOlxuICogaHR0cHM6Ly93d3cub3JlaWxseS5jb20vbGlicmFyeS92aWV3L3JlZ3VsYXItZXhwcmVzc2lvbnMtY29va2Jvb2svOTc4MTQ0OTMyNzQ1My9jaDA4czE1Lmh0bWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWREb21haW4oaG9zdG5hbWUpIHtcbiAgICByZXR1cm4gKFxuICAgIC8vIENvbnNpZGVyIGxvY2FsaG9zdCB2YWxpZCBhcyB3ZWxsIHNpbmNlIGl0J3Mgb2theSB3cnQgU2VjdXJlIENvbnRleHRzXG4gICAgaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnIHx8XG4gICAgICAgIC9eKFthLXowLTldKygtW2EtejAtOV0rKSpcXC4pK1thLXpdezIsfSQvaS50ZXN0KGhvc3RuYW1lKSk7XG59XG4iLCJpbXBvcnQgeyBicm93c2VyU3VwcG9ydHNXZWJBdXRobiB9IGZyb20gJy4vYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4uanMnO1xuLyoqXG4gKiBEZXRlcm1pbmUgd2hldGhlciB0aGUgYnJvd3NlciBjYW4gY29tbXVuaWNhdGUgd2l0aCBhIGJ1aWx0LWluIGF1dGhlbnRpY2F0b3IsIGxpa2VcbiAqIFRvdWNoIElELCBBbmRyb2lkIGZpbmdlcnByaW50IHNjYW5uZXIsIG9yIFdpbmRvd3MgSGVsbG8uXG4gKlxuICogVGhpcyBtZXRob2Qgd2lsbCBfbm90XyBiZSBhYmxlIHRvIHRlbGwgeW91IHRoZSBuYW1lIG9mIHRoZSBwbGF0Zm9ybSBhdXRoZW50aWNhdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGxhdGZvcm1BdXRoZW50aWNhdG9ySXNBdmFpbGFibGUoKSB7XG4gICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVzb2x2ZShmYWxzZSkpO1xuICAgIH1cbiAgICByZXR1cm4gUHVibGljS2V5Q3JlZGVudGlhbC5pc1VzZXJWZXJpZnlpbmdQbGF0Zm9ybUF1dGhlbnRpY2F0b3JBdmFpbGFibGUoKTtcbn1cbiIsImNvbnN0IGF0dGFjaG1lbnRzID0gWydjcm9zcy1wbGF0Zm9ybScsICdwbGF0Zm9ybSddO1xuLyoqXG4gKiBJZiBwb3NzaWJsZSBjb2VyY2UgYSBgc3RyaW5nYCB2YWx1ZSBpbnRvIGEga25vd24gYEF1dGhlbnRpY2F0b3JBdHRhY2htZW50YFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9BdXRoZW50aWNhdG9yQXR0YWNobWVudChhdHRhY2htZW50KSB7XG4gICAgaWYgKCFhdHRhY2htZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGF0dGFjaG1lbnRzLmluZGV4T2YoYXR0YWNobWVudCkgPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIGF0dGFjaG1lbnQ7XG59XG4iLCJpbXBvcnQgeyBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlciB9IGZyb20gJy4vYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIHRvUHVibGljS2V5Q3JlZGVudGlhbERlc2NyaXB0b3IoZGVzY3JpcHRvcikge1xuICAgIGNvbnN0IHsgaWQgfSA9IGRlc2NyaXB0b3I7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZGVzY3JpcHRvcixcbiAgICAgICAgaWQ6IGJhc2U2NFVSTFN0cmluZ1RvQnVmZmVyKGlkKSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGBkZXNjcmlwdG9yLnRyYW5zcG9ydHNgIGlzIGFuIGFycmF5IG9mIG91ciBgQXV0aGVudGljYXRvclRyYW5zcG9ydEZ1dHVyZWAgdGhhdCBpbmNsdWRlcyBuZXdlclxuICAgICAgICAgKiB0cmFuc3BvcnRzIHRoYXQgVHlwZVNjcmlwdCdzIERPTSBsaWIgaXMgaWdub3JhbnQgb2YuIENvbnZpbmNlIFRTIHRoYXQgb3VyIGxpc3Qgb2YgdHJhbnNwb3J0c1xuICAgICAgICAgKiBhcmUgZmluZSB0byBwYXNzIHRvIFdlYkF1dGhuIHNpbmNlIGJyb3dzZXJzIHdpbGwgcmVjb2duaXplIHRoZSBuZXcgdmFsdWUuXG4gICAgICAgICAqL1xuICAgICAgICB0cmFuc3BvcnRzOiBkZXNjcmlwdG9yLnRyYW5zcG9ydHMsXG4gICAgfTtcbn1cbiIsImNsYXNzIEJhc2VXZWJBdXRobkFib3J0U2VydmljZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbnRyb2xsZXJcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlTmV3QWJvcnRTaWduYWwoKSB7XG4gICAgICAgIC8vIEFib3J0IGFueSBleGlzdGluZyBjYWxscyB0byBuYXZpZ2F0b3IuY3JlZGVudGlhbHMuY3JlYXRlKCkgb3IgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmdldCgpXG4gICAgICAgIGlmICh0aGlzLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGFib3J0RXJyb3IgPSBuZXcgRXJyb3IoJ0NhbmNlbGxpbmcgZXhpc3RpbmcgV2ViQXV0aG4gQVBJIGNhbGwgZm9yIG5ldyBvbmUnKTtcbiAgICAgICAgICAgIGFib3J0RXJyb3IubmFtZSA9ICdBYm9ydEVycm9yJztcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5hYm9ydChhYm9ydEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXdDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXdDb250cm9sbGVyO1xuICAgICAgICByZXR1cm4gbmV3Q29udHJvbGxlci5zaWduYWw7XG4gICAgfVxuICAgIGNhbmNlbENlcmVtb255KCkge1xuICAgICAgICBpZiAodGhpcy5jb250cm9sbGVyKSB7XG4gICAgICAgICAgICBjb25zdCBhYm9ydEVycm9yID0gbmV3IEVycm9yKCdNYW51YWxseSBjYW5jZWxsaW5nIGV4aXN0aW5nIFdlYkF1dGhuIEFQSSBjYWxsJyk7XG4gICAgICAgICAgICBhYm9ydEVycm9yLm5hbWUgPSAnQWJvcnRFcnJvcic7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuYWJvcnQoYWJvcnRFcnJvcik7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEEgc2VydmljZSBzaW5nbGV0b24gdG8gaGVscCBlbnN1cmUgdGhhdCBvbmx5IGEgc2luZ2xlIFdlYkF1dGhuIGNlcmVtb255IGlzIGFjdGl2ZSBhdCBhIHRpbWUuXG4gKlxuICogVXNlcnMgb2YgKipAc2ltcGxld2ViYXV0aG4vYnJvd3NlcioqIHNob3VsZG4ndCB0eXBpY2FsbHkgbmVlZCB0byB1c2UgdGhpcywgYnV0IGl0IGNhbiBoZWxwIGUuZy5cbiAqIGRldmVsb3BlcnMgYnVpbGRpbmcgcHJvamVjdHMgdGhhdCB1c2UgY2xpZW50LXNpZGUgcm91dGluZyB0byBiZXR0ZXIgY29udHJvbCB0aGUgYmVoYXZpb3Igb2ZcbiAqIHRoZWlyIFVYIGluIHJlc3BvbnNlIHRvIHJvdXRlciBuYXZpZ2F0aW9uIGV2ZW50cy5cbiAqL1xuZXhwb3J0IGNvbnN0IFdlYkF1dGhuQWJvcnRTZXJ2aWNlID0gbmV3IEJhc2VXZWJBdXRobkFib3J0U2VydmljZSgpO1xuIiwiLyoqXG4gKiBBIGN1c3RvbSBFcnJvciB1c2VkIHRvIHJldHVybiBhIG1vcmUgbnVhbmNlZCBlcnJvciBkZXRhaWxpbmcgX3doeV8gb25lIG9mIHRoZSBlaWdodCBkb2N1bWVudGVkXG4gKiBlcnJvcnMgaW4gdGhlIHNwZWMgd2FzIHJhaXNlZCBhZnRlciBjYWxsaW5nIGBuYXZpZ2F0b3IuY3JlZGVudGlhbHMuY3JlYXRlKClgIG9yXG4gKiBgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmdldCgpYDpcbiAqXG4gKiAtIGBBYm9ydEVycm9yYFxuICogLSBgQ29uc3RyYWludEVycm9yYFxuICogLSBgSW52YWxpZFN0YXRlRXJyb3JgXG4gKiAtIGBOb3RBbGxvd2VkRXJyb3JgXG4gKiAtIGBOb3RTdXBwb3J0ZWRFcnJvcmBcbiAqIC0gYFNlY3VyaXR5RXJyb3JgXG4gKiAtIGBUeXBlRXJyb3JgXG4gKiAtIGBVbmtub3duRXJyb3JgXG4gKlxuICogRXJyb3IgbWVzc2FnZXMgd2VyZSBkZXRlcm1pbmVkIHRocm91Z2ggaW52ZXN0aWdhdGlvbiBvZiB0aGUgc3BlYyB0byBkZXRlcm1pbmUgdW5kZXIgd2hpY2hcbiAqIHNjZW5hcmlvcyBhIGdpdmVuIGVycm9yIHdvdWxkIGJlIHJhaXNlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIFdlYkF1dGhuRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoeyBtZXNzYWdlLCBjb2RlLCBjYXVzZSwgbmFtZSwgfSkge1xuICAgICAgICAvLyBAdHMtaWdub3JlOiBoZWxwIFJvbGx1cCB1bmRlcnN0YW5kIHRoYXQgYGNhdXNlYCBpcyBva2F5IHRvIHNldFxuICAgICAgICBzdXBlcihtZXNzYWdlLCB7IGNhdXNlIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWUgPz8gY2F1c2UubmFtZTtcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB9XG59XG4iLCJleHBvcnQgKiBmcm9tICcuL21ldGhvZHMvc3RhcnRSZWdpc3RyYXRpb24uanMnO1xuZXhwb3J0ICogZnJvbSAnLi9tZXRob2RzL3N0YXJ0QXV0aGVudGljYXRpb24uanMnO1xuZXhwb3J0ICogZnJvbSAnLi9oZWxwZXJzL2Jyb3dzZXJTdXBwb3J0c1dlYkF1dGhuLmpzJztcbmV4cG9ydCAqIGZyb20gJy4vaGVscGVycy9wbGF0Zm9ybUF1dGhlbnRpY2F0b3JJc0F2YWlsYWJsZS5qcyc7XG5leHBvcnQgKiBmcm9tICcuL2hlbHBlcnMvYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbC5qcyc7XG5leHBvcnQgKiBmcm9tICcuL2hlbHBlcnMvYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIuanMnO1xuZXhwb3J0ICogZnJvbSAnLi9oZWxwZXJzL2J1ZmZlclRvQmFzZTY0VVJMU3RyaW5nLmpzJztcbmV4cG9ydCAqIGZyb20gJy4vaGVscGVycy93ZWJBdXRobkFib3J0U2VydmljZS5qcyc7XG5leHBvcnQgKiBmcm9tICcuL2hlbHBlcnMvd2ViQXV0aG5FcnJvci5qcyc7XG5leHBvcnQgKiBmcm9tICcuL3R5cGVzL2luZGV4LmpzJztcbiIsImltcG9ydCB7IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nIH0gZnJvbSAnLi4vaGVscGVycy9idWZmZXJUb0Jhc2U2NFVSTFN0cmluZy5qcyc7XG5pbXBvcnQgeyBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlciB9IGZyb20gJy4uL2hlbHBlcnMvYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIuanMnO1xuaW1wb3J0IHsgYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4gfSBmcm9tICcuLi9oZWxwZXJzL2Jyb3dzZXJTdXBwb3J0c1dlYkF1dGhuLmpzJztcbmltcG9ydCB7IGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwgfSBmcm9tICcuLi9oZWxwZXJzL2Jyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwuanMnO1xuaW1wb3J0IHsgdG9QdWJsaWNLZXlDcmVkZW50aWFsRGVzY3JpcHRvciB9IGZyb20gJy4uL2hlbHBlcnMvdG9QdWJsaWNLZXlDcmVkZW50aWFsRGVzY3JpcHRvci5qcyc7XG5pbXBvcnQgeyBpZGVudGlmeUF1dGhlbnRpY2F0aW9uRXJyb3IgfSBmcm9tICcuLi9oZWxwZXJzL2lkZW50aWZ5QXV0aGVudGljYXRpb25FcnJvci5qcyc7XG5pbXBvcnQgeyBXZWJBdXRobkFib3J0U2VydmljZSB9IGZyb20gJy4uL2hlbHBlcnMvd2ViQXV0aG5BYm9ydFNlcnZpY2UuanMnO1xuaW1wb3J0IHsgdG9BdXRoZW50aWNhdG9yQXR0YWNobWVudCB9IGZyb20gJy4uL2hlbHBlcnMvdG9BdXRoZW50aWNhdG9yQXR0YWNobWVudC5qcyc7XG4vKipcbiAqIEJlZ2luIGF1dGhlbnRpY2F0b3IgXCJsb2dpblwiIHZpYSBXZWJBdXRobiBhc3NlcnRpb25cbiAqXG4gKiBAcGFyYW0gb3B0aW9uc0pTT04gT3V0cHV0IGZyb20gKipAc2ltcGxld2ViYXV0aG4vc2VydmVyKioncyBgZ2VuZXJhdGVBdXRoZW50aWNhdGlvbk9wdGlvbnMoKWBcbiAqIEBwYXJhbSB1c2VCcm93c2VyQXV0b2ZpbGwgKE9wdGlvbmFsKSBJbml0aWFsaXplIGNvbmRpdGlvbmFsIFVJIHRvIGVuYWJsZSBsb2dnaW5nIGluIHZpYSBicm93c2VyIGF1dG9maWxsIHByb21wdHMuIERlZmF1bHRzIHRvIGBmYWxzZWAuXG4gKiBAcGFyYW0gdmVyaWZ5QnJvd3NlckF1dG9maWxsSW5wdXQgKE9wdGlvbmFsKSBFbnN1cmUgYSBzdWl0YWJsZSBgPGlucHV0PmAgZWxlbWVudCBpcyBwcmVzZW50IHdoZW4gYHVzZUJyb3dzZXJBdXRvZmlsbGAgaXMgYHRydWVgLiBEZWZhdWx0cyB0byBgdHJ1ZWAuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFydEF1dGhlbnRpY2F0aW9uKG9wdGlvbnMpIHtcbiAgICAvLyBAdHMtaWdub3JlOiBJbnRlbnRpb25hbGx5IGNoZWNrIGZvciBvbGQgY2FsbCBzdHJ1Y3R1cmUgdG8gd2FybiBhYm91dCBpbXByb3BlciBBUEkgY2FsbFxuICAgIGlmICghb3B0aW9ucy5vcHRpb25zSlNPTiAmJiBvcHRpb25zLmNoYWxsZW5nZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ3N0YXJ0QXV0aGVudGljYXRpb24oKSB3YXMgbm90IGNhbGxlZCBjb3JyZWN0bHkuIEl0IHdpbGwgdHJ5IHRvIGNvbnRpbnVlIHdpdGggdGhlIHByb3ZpZGVkIG9wdGlvbnMsIGJ1dCB0aGlzIGNhbGwgc2hvdWxkIGJlIHJlZmFjdG9yZWQgdG8gdXNlIHRoZSBleHBlY3RlZCBjYWxsIHN0cnVjdHVyZSBpbnN0ZWFkLiBTZWUgaHR0cHM6Ly9zaW1wbGV3ZWJhdXRobi5kZXYvZG9jcy9wYWNrYWdlcy9icm93c2VyI3R5cGVlcnJvci1jYW5ub3QtcmVhZC1wcm9wZXJ0aWVzLW9mLXVuZGVmaW5lZC1yZWFkaW5nLWNoYWxsZW5nZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4nKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZTogUmVhc3NpZ24gdGhlIG9wdGlvbnMsIHBhc3NlZCBpbiBhcyBhIHBvc2l0aW9uYWwgYXJndW1lbnQsIHRvIHRoZSBleHBlY3RlZCB2YXJpYWJsZVxuICAgICAgICBvcHRpb25zID0geyBvcHRpb25zSlNPTjogb3B0aW9ucyB9O1xuICAgIH1cbiAgICBjb25zdCB7IG9wdGlvbnNKU09OLCB1c2VCcm93c2VyQXV0b2ZpbGwgPSBmYWxzZSwgdmVyaWZ5QnJvd3NlckF1dG9maWxsSW5wdXQgPSB0cnVlLCB9ID0gb3B0aW9ucztcbiAgICBpZiAoIWJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXZWJBdXRobiBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlcicpO1xuICAgIH1cbiAgICAvLyBXZSBuZWVkIHRvIGF2b2lkIHBhc3NpbmcgZW1wdHkgYXJyYXkgdG8gYXZvaWQgYmxvY2tpbmcgcmV0cmlldmFsXG4gICAgLy8gb2YgcHVibGljIGtleVxuICAgIGxldCBhbGxvd0NyZWRlbnRpYWxzO1xuICAgIGlmIChvcHRpb25zSlNPTi5hbGxvd0NyZWRlbnRpYWxzPy5sZW5ndGggIT09IDApIHtcbiAgICAgICAgYWxsb3dDcmVkZW50aWFscyA9IG9wdGlvbnNKU09OLmFsbG93Q3JlZGVudGlhbHM/Lm1hcCh0b1B1YmxpY0tleUNyZWRlbnRpYWxEZXNjcmlwdG9yKTtcbiAgICB9XG4gICAgLy8gV2UgbmVlZCB0byBjb252ZXJ0IHNvbWUgdmFsdWVzIHRvIFVpbnQ4QXJyYXlzIGJlZm9yZSBwYXNzaW5nIHRoZSBjcmVkZW50aWFscyB0byB0aGUgbmF2aWdhdG9yXG4gICAgY29uc3QgcHVibGljS2V5ID0ge1xuICAgICAgICAuLi5vcHRpb25zSlNPTixcbiAgICAgICAgY2hhbGxlbmdlOiBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlcihvcHRpb25zSlNPTi5jaGFsbGVuZ2UpLFxuICAgICAgICBhbGxvd0NyZWRlbnRpYWxzLFxuICAgIH07XG4gICAgLy8gUHJlcGFyZSBvcHRpb25zIGZvciBgLmdldCgpYFxuICAgIGNvbnN0IGdldE9wdGlvbnMgPSB7fTtcbiAgICAvKipcbiAgICAgKiBTZXQgdXAgdGhlIHBhZ2UgdG8gcHJvbXB0IHRoZSB1c2VyIHRvIHNlbGVjdCBhIGNyZWRlbnRpYWwgZm9yIGF1dGhlbnRpY2F0aW9uIHZpYSB0aGUgYnJvd3NlcidzXG4gICAgICogaW5wdXQgYXV0b2ZpbGwgbWVjaGFuaXNtLlxuICAgICAqL1xuICAgIGlmICh1c2VCcm93c2VyQXV0b2ZpbGwpIHtcbiAgICAgICAgaWYgKCEoYXdhaXQgYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbCgpKSkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0Jyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBXZWJBdXRobiBhdXRvZmlsbCcpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrIGZvciBhbiA8aW5wdXQ+IHdpdGggXCJ3ZWJhdXRoblwiIGluIGl0cyBgYXV0b2NvbXBsZXRlYCBhdHRyaWJ1dGVcbiAgICAgICAgY29uc3QgZWxpZ2libGVJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbYXV0b2NvbXBsZXRlJD0nd2ViYXV0aG4nXVwiKTtcbiAgICAgICAgLy8gV2ViQXV0aG4gYXV0b2ZpbGwgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIHZhbGlkIGlucHV0XG4gICAgICAgIGlmIChlbGlnaWJsZUlucHV0cy5sZW5ndGggPCAxICYmIHZlcmlmeUJyb3dzZXJBdXRvZmlsbElucHV0KSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignTm8gPGlucHV0PiB3aXRoIFwid2ViYXV0aG5cIiBhcyB0aGUgb25seSBvciBsYXN0IHZhbHVlIGluIGl0cyBgYXV0b2NvbXBsZXRlYCBhdHRyaWJ1dGUgd2FzIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYENyZWRlbnRpYWxNZWRpYXRpb25SZXF1aXJlbWVudGAgZG9lc24ndCBrbm93IGFib3V0IFwiY29uZGl0aW9uYWxcIiB5ZXQgYXMgb2ZcbiAgICAgICAgLy8gdHlwZXNjcmlwdEA0LjYuM1xuICAgICAgICBnZXRPcHRpb25zLm1lZGlhdGlvbiA9ICdjb25kaXRpb25hbCc7XG4gICAgICAgIC8vIENvbmRpdGlvbmFsIFVJIHJlcXVpcmVzIGFuIGVtcHR5IGFsbG93IGxpc3RcbiAgICAgICAgcHVibGljS2V5LmFsbG93Q3JlZGVudGlhbHMgPSBbXTtcbiAgICB9XG4gICAgLy8gRmluYWxpemUgb3B0aW9uc1xuICAgIGdldE9wdGlvbnMucHVibGljS2V5ID0gcHVibGljS2V5O1xuICAgIC8vIFNldCB1cCB0aGUgYWJpbGl0eSB0byBjYW5jZWwgdGhpcyByZXF1ZXN0IGlmIHRoZSB1c2VyIGF0dGVtcHRzIGFub3RoZXJcbiAgICBnZXRPcHRpb25zLnNpZ25hbCA9IFdlYkF1dGhuQWJvcnRTZXJ2aWNlLmNyZWF0ZU5ld0Fib3J0U2lnbmFsKCk7XG4gICAgLy8gV2FpdCBmb3IgdGhlIHVzZXIgdG8gY29tcGxldGUgYXNzZXJ0aW9uXG4gICAgbGV0IGNyZWRlbnRpYWw7XG4gICAgdHJ5IHtcbiAgICAgICAgY3JlZGVudGlhbCA9IChhd2FpdCBuYXZpZ2F0b3IuY3JlZGVudGlhbHMuZ2V0KGdldE9wdGlvbnMpKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBpZGVudGlmeUF1dGhlbnRpY2F0aW9uRXJyb3IoeyBlcnJvcjogZXJyLCBvcHRpb25zOiBnZXRPcHRpb25zIH0pO1xuICAgIH1cbiAgICBpZiAoIWNyZWRlbnRpYWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdXRoZW50aWNhdGlvbiB3YXMgbm90IGNvbXBsZXRlZCcpO1xuICAgIH1cbiAgICBjb25zdCB7IGlkLCByYXdJZCwgcmVzcG9uc2UsIHR5cGUgfSA9IGNyZWRlbnRpYWw7XG4gICAgbGV0IHVzZXJIYW5kbGUgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHJlc3BvbnNlLnVzZXJIYW5kbGUpIHtcbiAgICAgICAgdXNlckhhbmRsZSA9IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLnVzZXJIYW5kbGUpO1xuICAgIH1cbiAgICAvLyBDb252ZXJ0IHZhbHVlcyB0byBiYXNlNjQgdG8gbWFrZSBpdCBlYXNpZXIgdG8gc2VuZCBiYWNrIHRvIHRoZSBzZXJ2ZXJcbiAgICByZXR1cm4ge1xuICAgICAgICBpZCxcbiAgICAgICAgcmF3SWQ6IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJhd0lkKSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0b3JEYXRhOiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyZXNwb25zZS5hdXRoZW50aWNhdG9yRGF0YSksXG4gICAgICAgICAgICBjbGllbnREYXRhSlNPTjogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UuY2xpZW50RGF0YUpTT04pLFxuICAgICAgICAgICAgc2lnbmF0dXJlOiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyZXNwb25zZS5zaWduYXR1cmUpLFxuICAgICAgICAgICAgdXNlckhhbmRsZSxcbiAgICAgICAgfSxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgY2xpZW50RXh0ZW5zaW9uUmVzdWx0czogY3JlZGVudGlhbC5nZXRDbGllbnRFeHRlbnNpb25SZXN1bHRzKCksXG4gICAgICAgIGF1dGhlbnRpY2F0b3JBdHRhY2htZW50OiB0b0F1dGhlbnRpY2F0b3JBdHRhY2htZW50KGNyZWRlbnRpYWwuYXV0aGVudGljYXRvckF0dGFjaG1lbnQpLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyB9IGZyb20gJy4uL2hlbHBlcnMvYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcuanMnO1xuaW1wb3J0IHsgYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIgfSBmcm9tICcuLi9oZWxwZXJzL2Jhc2U2NFVSTFN0cmluZ1RvQnVmZmVyLmpzJztcbmltcG9ydCB7IGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuIH0gZnJvbSAnLi4vaGVscGVycy9icm93c2VyU3VwcG9ydHNXZWJBdXRobi5qcyc7XG5pbXBvcnQgeyB0b1B1YmxpY0tleUNyZWRlbnRpYWxEZXNjcmlwdG9yIH0gZnJvbSAnLi4vaGVscGVycy90b1B1YmxpY0tleUNyZWRlbnRpYWxEZXNjcmlwdG9yLmpzJztcbmltcG9ydCB7IGlkZW50aWZ5UmVnaXN0cmF0aW9uRXJyb3IgfSBmcm9tICcuLi9oZWxwZXJzL2lkZW50aWZ5UmVnaXN0cmF0aW9uRXJyb3IuanMnO1xuaW1wb3J0IHsgV2ViQXV0aG5BYm9ydFNlcnZpY2UgfSBmcm9tICcuLi9oZWxwZXJzL3dlYkF1dGhuQWJvcnRTZXJ2aWNlLmpzJztcbmltcG9ydCB7IHRvQXV0aGVudGljYXRvckF0dGFjaG1lbnQgfSBmcm9tICcuLi9oZWxwZXJzL3RvQXV0aGVudGljYXRvckF0dGFjaG1lbnQuanMnO1xuLyoqXG4gKiBCZWdpbiBhdXRoZW50aWNhdG9yIFwicmVnaXN0cmF0aW9uXCIgdmlhIFdlYkF1dGhuIGF0dGVzdGF0aW9uXG4gKlxuICogQHBhcmFtIG9wdGlvbnNKU09OIE91dHB1dCBmcm9tICoqQHNpbXBsZXdlYmF1dGhuL3NlcnZlcioqJ3MgYGdlbmVyYXRlUmVnaXN0cmF0aW9uT3B0aW9ucygpYFxuICogQHBhcmFtIHVzZUF1dG9SZWdpc3RlciAoT3B0aW9uYWwpIFRyeSB0byBzaWxlbnRseSBjcmVhdGUgYSBwYXNza2V5IHdpdGggdGhlIHBhc3N3b3JkIG1hbmFnZXIgdGhhdCB0aGUgdXNlciBqdXN0IHNpZ25lZCBpbiB3aXRoLiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRSZWdpc3RyYXRpb24ob3B0aW9ucykge1xuICAgIC8vIEB0cy1pZ25vcmU6IEludGVudGlvbmFsbHkgY2hlY2sgZm9yIG9sZCBjYWxsIHN0cnVjdHVyZSB0byB3YXJuIGFib3V0IGltcHJvcGVyIEFQSSBjYWxsXG4gICAgaWYgKCFvcHRpb25zLm9wdGlvbnNKU09OICYmIG9wdGlvbnMuY2hhbGxlbmdlKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybignc3RhcnRSZWdpc3RyYXRpb24oKSB3YXMgbm90IGNhbGxlZCBjb3JyZWN0bHkuIEl0IHdpbGwgdHJ5IHRvIGNvbnRpbnVlIHdpdGggdGhlIHByb3ZpZGVkIG9wdGlvbnMsIGJ1dCB0aGlzIGNhbGwgc2hvdWxkIGJlIHJlZmFjdG9yZWQgdG8gdXNlIHRoZSBleHBlY3RlZCBjYWxsIHN0cnVjdHVyZSBpbnN0ZWFkLiBTZWUgaHR0cHM6Ly9zaW1wbGV3ZWJhdXRobi5kZXYvZG9jcy9wYWNrYWdlcy9icm93c2VyI3R5cGVlcnJvci1jYW5ub3QtcmVhZC1wcm9wZXJ0aWVzLW9mLXVuZGVmaW5lZC1yZWFkaW5nLWNoYWxsZW5nZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4nKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZTogUmVhc3NpZ24gdGhlIG9wdGlvbnMsIHBhc3NlZCBpbiBhcyBhIHBvc2l0aW9uYWwgYXJndW1lbnQsIHRvIHRoZSBleHBlY3RlZCB2YXJpYWJsZVxuICAgICAgICBvcHRpb25zID0geyBvcHRpb25zSlNPTjogb3B0aW9ucyB9O1xuICAgIH1cbiAgICBjb25zdCB7IG9wdGlvbnNKU09OLCB1c2VBdXRvUmVnaXN0ZXIgPSBmYWxzZSB9ID0gb3B0aW9ucztcbiAgICBpZiAoIWJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXZWJBdXRobiBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlcicpO1xuICAgIH1cbiAgICAvLyBXZSBuZWVkIHRvIGNvbnZlcnQgc29tZSB2YWx1ZXMgdG8gVWludDhBcnJheXMgYmVmb3JlIHBhc3NpbmcgdGhlIGNyZWRlbnRpYWxzIHRvIHRoZSBuYXZpZ2F0b3JcbiAgICBjb25zdCBwdWJsaWNLZXkgPSB7XG4gICAgICAgIC4uLm9wdGlvbnNKU09OLFxuICAgICAgICBjaGFsbGVuZ2U6IGJhc2U2NFVSTFN0cmluZ1RvQnVmZmVyKG9wdGlvbnNKU09OLmNoYWxsZW5nZSksXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIC4uLm9wdGlvbnNKU09OLnVzZXIsXG4gICAgICAgICAgICBpZDogYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIob3B0aW9uc0pTT04udXNlci5pZCksXG4gICAgICAgIH0sXG4gICAgICAgIGV4Y2x1ZGVDcmVkZW50aWFsczogb3B0aW9uc0pTT04uZXhjbHVkZUNyZWRlbnRpYWxzPy5tYXAodG9QdWJsaWNLZXlDcmVkZW50aWFsRGVzY3JpcHRvciksXG4gICAgfTtcbiAgICAvLyBQcmVwYXJlIG9wdGlvbnMgZm9yIGAuY3JlYXRlKClgXG4gICAgY29uc3QgY3JlYXRlT3B0aW9ucyA9IHt9O1xuICAgIC8qKlxuICAgICAqIFRyeSB0byB1c2UgY29uZGl0aW9uYWwgY3JlYXRlIHRvIHJlZ2lzdGVyIGEgcGFzc2tleSBmb3IgdGhlIHVzZXIgd2l0aCB0aGUgcGFzc3dvcmQgbWFuYWdlclxuICAgICAqIHRoZSB1c2VyIGp1c3QgdXNlZCB0byBhdXRoZW50aWNhdGUgd2l0aC4gVGhlIHVzZXIgd29uJ3QgYmUgc2hvd24gYW55IHByb21pbmVudCBVSSBieSB0aGVcbiAgICAgKiBicm93c2VyLlxuICAgICAqL1xuICAgIGlmICh1c2VBdXRvUmVnaXN0ZXIpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZTogYG1lZGlhdGlvbmAgZG9lc24ndCB5ZXQgZXhpc3Qgb24gQ3JlZGVudGlhbENyZWF0aW9uT3B0aW9ucyBidXQgaXQncyBwb3NzaWJsZSBhcyBvZiBTZXB0IDIwMjRcbiAgICAgICAgY3JlYXRlT3B0aW9ucy5tZWRpYXRpb24gPSAnY29uZGl0aW9uYWwnO1xuICAgIH1cbiAgICAvLyBGaW5hbGl6ZSBvcHRpb25zXG4gICAgY3JlYXRlT3B0aW9ucy5wdWJsaWNLZXkgPSBwdWJsaWNLZXk7XG4gICAgLy8gU2V0IHVwIHRoZSBhYmlsaXR5IHRvIGNhbmNlbCB0aGlzIHJlcXVlc3QgaWYgdGhlIHVzZXIgYXR0ZW1wdHMgYW5vdGhlclxuICAgIGNyZWF0ZU9wdGlvbnMuc2lnbmFsID0gV2ViQXV0aG5BYm9ydFNlcnZpY2UuY3JlYXRlTmV3QWJvcnRTaWduYWwoKTtcbiAgICAvLyBXYWl0IGZvciB0aGUgdXNlciB0byBjb21wbGV0ZSBhdHRlc3RhdGlvblxuICAgIGxldCBjcmVkZW50aWFsO1xuICAgIHRyeSB7XG4gICAgICAgIGNyZWRlbnRpYWwgPSAoYXdhaXQgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmNyZWF0ZShjcmVhdGVPcHRpb25zKSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgaWRlbnRpZnlSZWdpc3RyYXRpb25FcnJvcih7IGVycm9yOiBlcnIsIG9wdGlvbnM6IGNyZWF0ZU9wdGlvbnMgfSk7XG4gICAgfVxuICAgIGlmICghY3JlZGVudGlhbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlZ2lzdHJhdGlvbiB3YXMgbm90IGNvbXBsZXRlZCcpO1xuICAgIH1cbiAgICBjb25zdCB7IGlkLCByYXdJZCwgcmVzcG9uc2UsIHR5cGUgfSA9IGNyZWRlbnRpYWw7XG4gICAgLy8gQ29udGludWUgdG8gcGxheSBpdCBzYWZlIHdpdGggYGdldFRyYW5zcG9ydHMoKWAgZm9yIG5vdywgZXZlbiB3aGVuIEwzIHR5cGVzIHNheSBpdCdzIHJlcXVpcmVkXG4gICAgbGV0IHRyYW5zcG9ydHMgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGVvZiByZXNwb25zZS5nZXRUcmFuc3BvcnRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRyYW5zcG9ydHMgPSByZXNwb25zZS5nZXRUcmFuc3BvcnRzKCk7XG4gICAgfVxuICAgIC8vIEwzIHNheXMgdGhpcyBpcyByZXF1aXJlZCwgYnV0IGJyb3dzZXIgYW5kIHdlYnZpZXcgc3VwcG9ydCBhcmUgc3RpbGwgbm90IGd1YXJhbnRlZWQuXG4gICAgbGV0IHJlc3BvbnNlUHVibGljS2V5QWxnb3JpdGhtID0gdW5kZWZpbmVkO1xuICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuZ2V0UHVibGljS2V5QWxnb3JpdGhtID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXNwb25zZVB1YmxpY0tleUFsZ29yaXRobSA9IHJlc3BvbnNlLmdldFB1YmxpY0tleUFsZ29yaXRobSgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgd2Fybk9uQnJva2VuSW1wbGVtZW50YXRpb24oJ2dldFB1YmxpY0tleUFsZ29yaXRobSgpJywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxldCByZXNwb25zZVB1YmxpY0tleSA9IHVuZGVmaW5lZDtcbiAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmdldFB1YmxpY0tleSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgX3B1YmxpY0tleSA9IHJlc3BvbnNlLmdldFB1YmxpY0tleSgpO1xuICAgICAgICAgICAgaWYgKF9wdWJsaWNLZXkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZVB1YmxpY0tleSA9IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKF9wdWJsaWNLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgd2Fybk9uQnJva2VuSW1wbGVtZW50YXRpb24oJ2dldFB1YmxpY0tleSgpJywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIEwzIHNheXMgdGhpcyBpcyByZXF1aXJlZCwgYnV0IGJyb3dzZXIgYW5kIHdlYnZpZXcgc3VwcG9ydCBhcmUgc3RpbGwgbm90IGd1YXJhbnRlZWQuXG4gICAgbGV0IHJlc3BvbnNlQXV0aGVudGljYXRvckRhdGE7XG4gICAgaWYgKHR5cGVvZiByZXNwb25zZS5nZXRBdXRoZW50aWNhdG9yRGF0YSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzcG9uc2VBdXRoZW50aWNhdG9yRGF0YSA9IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLmdldEF1dGhlbnRpY2F0b3JEYXRhKCkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgd2Fybk9uQnJva2VuSW1wbGVtZW50YXRpb24oJ2dldEF1dGhlbnRpY2F0b3JEYXRhKCknLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQsXG4gICAgICAgIHJhd0lkOiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyYXdJZCksXG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICBhdHRlc3RhdGlvbk9iamVjdDogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UuYXR0ZXN0YXRpb25PYmplY3QpLFxuICAgICAgICAgICAgY2xpZW50RGF0YUpTT046IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLmNsaWVudERhdGFKU09OKSxcbiAgICAgICAgICAgIHRyYW5zcG9ydHMsXG4gICAgICAgICAgICBwdWJsaWNLZXlBbGdvcml0aG06IHJlc3BvbnNlUHVibGljS2V5QWxnb3JpdGhtLFxuICAgICAgICAgICAgcHVibGljS2V5OiByZXNwb25zZVB1YmxpY0tleSxcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0b3JEYXRhOiByZXNwb25zZUF1dGhlbnRpY2F0b3JEYXRhLFxuICAgICAgICB9LFxuICAgICAgICB0eXBlLFxuICAgICAgICBjbGllbnRFeHRlbnNpb25SZXN1bHRzOiBjcmVkZW50aWFsLmdldENsaWVudEV4dGVuc2lvblJlc3VsdHMoKSxcbiAgICAgICAgYXV0aGVudGljYXRvckF0dGFjaG1lbnQ6IHRvQXV0aGVudGljYXRvckF0dGFjaG1lbnQoY3JlZGVudGlhbC5hdXRoZW50aWNhdG9yQXR0YWNobWVudCksXG4gICAgfTtcbn1cbi8qKlxuICogVmlzaWJseSB3YXJuIHdoZW4gd2UgZGV0ZWN0IGFuIGlzc3VlIHJlbGF0ZWQgdG8gYSBwYXNza2V5IHByb3ZpZGVyIGludGVyY2VwdGluZyBXZWJBdXRobiBBUElcbiAqIGNhbGxzXG4gKi9cbmZ1bmN0aW9uIHdhcm5PbkJyb2tlbkltcGxlbWVudGF0aW9uKG1ldGhvZE5hbWUsIGNhdXNlKSB7XG4gICAgY29uc29sZS53YXJuKGBUaGUgYnJvd3NlciBleHRlbnNpb24gdGhhdCBpbnRlcmNlcHRlZCB0aGlzIFdlYkF1dGhuIEFQSSBjYWxsIGluY29ycmVjdGx5IGltcGxlbWVudGVkICR7bWV0aG9kTmFtZX0uIFlvdSBzaG91bGQgcmVwb3J0IHRoaXMgZXJyb3IgdG8gdGhlbS5cXG5gLCBjYXVzZSk7XG59XG4iLCJleHBvcnQge307XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiO1xuaW1wb3J0IFBpY2tyIGZyb20gXCJAc2ltb253ZXAvcGlja3JcIjtcbmNvbnN0IF9Db2xvclBpY2tlciA9IGNsYXNzIF9Db2xvclBpY2tlciBleHRlbmRzIENvbnRyb2xsZXIge1xuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMub25TYXZlID0gdGhpcy5vblNhdmUuYmluZCh0aGlzKTtcbiAgfVxuICBjb25uZWN0KCkge1xuICAgIHRoaXMucGlja2VyID0gUGlja3IuY3JlYXRlKHtcbiAgICAgIGVsOiB0aGlzLmJ1dHRvblRhcmdldCxcbiAgICAgIHRoZW1lOiB0aGlzLnRoZW1lVmFsdWUsXG4gICAgICBkZWZhdWx0OiB0aGlzLmlucHV0VGFyZ2V0LnZhbHVlLFxuICAgICAgc3dhdGNoZXM6IHRoaXMuc3dhdGNoZXMsXG4gICAgICBjb21wb25lbnRzOiB0aGlzLmNvbXBvbmVudE9wdGlvbnNcbiAgICB9KSwgdGhpcy5waWNrZXIub24oXCJzYXZlXCIsIHRoaXMub25TYXZlKTtcbiAgfVxuICBkaXNjb25uZWN0KCkge1xuICAgIHRoaXMucGlja2VyLmRlc3Ryb3koKTtcbiAgfVxuICBvblNhdmUoY29sb3IpIHtcbiAgICB0aGlzLmlucHV0VGFyZ2V0LnZhbHVlID0gbnVsbCwgY29sb3IgJiYgKHRoaXMuaW5wdXRUYXJnZXQudmFsdWUgPSBjb2xvci50b0hFWEEoKS50b1N0cmluZygpKSwgdGhpcy5waWNrZXIuaGlkZSgpO1xuICB9XG4gIGdldCBjb21wb25lbnRPcHRpb25zKCkge1xuICAgIHJldHVybiB7XG4gICAgICBwcmV2aWV3OiAhMCxcbiAgICAgIGh1ZTogITAsXG4gICAgICBpbnRlcmFjdGlvbjoge1xuICAgICAgICBpbnB1dDogITAsXG4gICAgICAgIGNsZWFyOiAhMCxcbiAgICAgICAgc2F2ZTogITBcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGdldCBzd2F0Y2hlcygpIHtcbiAgICByZXR1cm4gW1xuICAgICAgXCIjQTBBRUMwXCIsXG4gICAgICBcIiNGNTY1NjVcIixcbiAgICAgIFwiI0VEODkzNlwiLFxuICAgICAgXCIjRUNDOTRCXCIsXG4gICAgICBcIiM0OEJCNzhcIixcbiAgICAgIFwiIzM4QjJBQ1wiLFxuICAgICAgXCIjNDI5OUUxXCIsXG4gICAgICBcIiM2NjdFRUFcIixcbiAgICAgIFwiIzlGN0FFQVwiLFxuICAgICAgXCIjRUQ2NEE2XCJcbiAgICBdO1xuICB9XG59O1xuX0NvbG9yUGlja2VyLnRhcmdldHMgPSBbXCJidXR0b25cIiwgXCJpbnB1dFwiXSwgX0NvbG9yUGlja2VyLnZhbHVlcyA9IHtcbiAgdGhlbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogXCJjbGFzc2ljXCJcbiAgfVxufTtcbmxldCBDb2xvclBpY2tlciA9IF9Db2xvclBpY2tlcjtcbmV4cG9ydCB7XG4gIENvbG9yUGlja2VyIGFzIGRlZmF1bHRcbn07XG4iLCJ2YXIgUCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBSID0gKHIsIGUsIHQpID0+IGUgaW4gciA/IFAociwgZSwgeyBlbnVtZXJhYmxlOiAhMCwgY29uZmlndXJhYmxlOiAhMCwgd3JpdGFibGU6ICEwLCB2YWx1ZTogdCB9KSA6IHJbZV0gPSB0O1xudmFyIHUgPSAociwgZSwgdCkgPT4gUihyLCB0eXBlb2YgZSAhPSBcInN5bWJvbFwiID8gZSArIFwiXCIgOiBlLCB0KTtcbmZ1bmN0aW9uIFMociwgZSkge1xuICByID09PSBcIlwiIHx8IHIubGVuZ3RoID09PSAwIHx8ICh0eXBlb2YgciA9PSBcInN0cmluZ1wiID8gZS5jbGFzc0xpc3QuYWRkKHIpIDogZS5jbGFzc0xpc3QuYWRkKC4uLnIpKTtcbn1cbmZ1bmN0aW9uIEQociwgZSkge1xuICByID09PSBcIlwiIHx8IHIubGVuZ3RoID09PSAwIHx8ICh0eXBlb2YgciA9PSBcInN0cmluZ1wiID8gZS5jbGFzc0xpc3QucmVtb3ZlKHIpIDogZS5jbGFzc0xpc3QucmVtb3ZlKC4uLnIpKTtcbn1cbmZ1bmN0aW9uIEEociwgZSkge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgZSAhPSBcIm9iamVjdFwiKSB7XG4gICAgICBjb25zdCB0ID0gdHlwZW9mIGU7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICBgRWxlbWVudHMgZ2l2ZW4gdG8gaXNWYWxpZEluc3RhbmNlKCkgbXVzdCBiZSBpbnNpZGUgb2YgYW4gb2JqZWN0LiBcIiR7dH1cIiBnaXZlbi5gXG4gICAgICApO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IHQgaW4gZSlcbiAgICAgIGlmICghKGVbdF0gaW5zdGFuY2VvZiByKSkge1xuICAgICAgICBjb25zdCBzID0gdHlwZW9mIGVbdF07XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgYCR7dH0gbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiAke3IubmFtZX0uIFwiJHtzfVwiIGdpdmVuLmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMCxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAodCkge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICExLFxuICAgICAgZXJyb3I6IHRcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBjKHIsIGUpIHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIGUgIT0gXCJvYmplY3RcIikge1xuICAgICAgY29uc3QgdCA9IHR5cGVvZiBlO1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgYFZhbHVlcyBnaXZlbiB0byBpc1ZhbGlkVHlwZSgpIG11c3QgYmUgaW5zaWRlIG9mIGFuIG9iamVjdC4gXCIke3R9XCIgZ2l2ZW4uYFxuICAgICAgKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB0IGluIGUpIHtcbiAgICAgIGNvbnN0IHMgPSB0eXBlb2YgZVt0XTtcbiAgICAgIGlmIChzICE9PSByKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAke3R9IG11c3QgYmUgYSAke3J9LiBcIiR7c31cIiBnaXZlbi5gKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITAsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH07XG4gIH0gY2F0Y2ggKHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMSxcbiAgICAgIGVycm9yOiB0XG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24geChyKSB7XG4gIHRyeSB7XG4gICAgaWYgKHR5cGVvZiByICE9IFwib2JqZWN0XCIpIHtcbiAgICAgIGNvbnN0IGUgPSB0eXBlb2YgcjtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIGBWYWx1ZXMgZ2l2ZW4gdG8gaXNRdWVyeVNlbGVjdG9yKCkgbXVzdCBiZSBpbnNpZGUgb2YgYW4gb2JqZWN0LiBcIiR7ZX1cIiBnaXZlbi5gXG4gICAgICApO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGUgaW4gcilcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChyW2VdID09PSBudWxsKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHJbZV0pO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgYCR7ZX0gbXVzdCBiZSBhIHZhbGlkIHF1ZXJ5IHNlbGVjdG9yLiBcIiR7cltlXX1cIiBnaXZlbi5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITAsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMSxcbiAgICAgIGVycm9yOiBlXG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gayhyKSB7XG4gIHRyeSB7XG4gICAgaWYgKHR5cGVvZiByICE9IFwib2JqZWN0XCIgfHwgQXJyYXkuaXNBcnJheShyKSkge1xuICAgICAgY29uc3QgZSA9IHR5cGVvZiByO1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgYFZhbHVlcyBnaXZlbiB0byBpc1ZhbGlkQ2xhc3NMaXN0KCkgbXVzdCBiZSBpbnNpZGUgb2YgYW4gb2JqZWN0LiBcIiR7ZX1cIiBnaXZlbi5gXG4gICAgICApO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGUgaW4gcikge1xuICAgICAgY29uc3QgdCA9IHR5cGVvZiByW2VdO1xuICAgICAgaWYgKHQgIT09IFwic3RyaW5nXCIpXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJbZV0pKVxuICAgICAgICAgIHJbZV0uZm9yRWFjaCgocykgPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzICE9IFwic3RyaW5nXCIpXG4gICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgICAgICAgYCR7ZX0gbXVzdCBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzLiBBbiBhcnJheSBjb250YWluaW5nIG5vbi1zdHJpbmdzIGdpdmVuLmBcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgICBgJHtlfSBtdXN0IGJlIGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MuIFwiJHt0fVwiIGdpdmVuLmBcbiAgICAgICAgICApO1xuICAgICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHMgPSB7fTtcbiAgICAgICAgc1tlXSA9IHJbZV0sIHgocyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICEwLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITEsXG4gICAgICBlcnJvcjogZVxuICAgIH07XG4gIH1cbn1cbmZ1bmN0aW9uIFUocikge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgciAhPSBcIm9iamVjdFwiKSB7XG4gICAgICBjb25zdCB0ID0gdHlwZW9mIHI7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICBgVmFsdWVzIGdpdmVuIHRvIGlzVmFsaWRTdGF0ZSgpIG11c3QgYmUgaW5zaWRlIG9mIGFuIG9iamVjdC4gXCIke3R9XCIgZ2l2ZW4uYFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgZSA9IFtcIm5vbmVcIiwgXCJzZWxmXCIsIFwiY2hpbGRcIl07XG4gICAgZm9yIChjb25zdCB0IGluIHIpXG4gICAgICBpZiAoIWUuaW5jbHVkZXMoclt0XSkpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgYCR7dH0gbXVzdCBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZXM6ICR7ZS5qb2luKFxuICAgICAgICAgICAgXCIsIFwiXG4gICAgICAgICAgKX0uIFwiJHtyW3RdfVwiIGdpdmVuLmBcbiAgICAgICAgKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMCxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICExLFxuICAgICAgZXJyb3I6IGVcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBXKHIpIHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHIgIT0gXCJvYmplY3RcIikge1xuICAgICAgY29uc3QgdCA9IHR5cGVvZiByO1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgYFZhbHVlcyBnaXZlbiB0byBpc1ZhbGlkRXZlbnQoKSBtdXN0IGJlIGluc2lkZSBvZiBhbiBvYmplY3QuIFwiJHt0fVwiIGdpdmVuLmBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGUgPSBbXCJub25lXCIsIFwibW91c2VcIiwgXCJrZXlib2FyZFwiLCBcImNoYXJhY3RlclwiXTtcbiAgICBmb3IgKGNvbnN0IHQgaW4gcilcbiAgICAgIGlmICghZS5pbmNsdWRlcyhyW3RdKSlcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICBgJHt0fSBtdXN0IGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlczogJHtlLmpvaW4oXG4gICAgICAgICAgICBcIiwgXCJcbiAgICAgICAgICApfS4gXCIke3JbdF19XCIgZ2l2ZW4uYFxuICAgICAgICApO1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICEwLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITEsXG4gICAgICBlcnJvcjogZVxuICAgIH07XG4gIH1cbn1cbmZ1bmN0aW9uIE4ocikge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgciAhPSBcIm9iamVjdFwiKSB7XG4gICAgICBjb25zdCB0ID0gdHlwZW9mIHI7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICBgVmFsdWVzIGdpdmVuIHRvIGlzVmFsaWRIb3ZlclR5cGUoKSBtdXN0IGJlIGluc2lkZSBvZiBhbiBvYmplY3QuIFwiJHt0fVwiIGdpdmVuLmBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGUgPSBbXCJvZmZcIiwgXCJvblwiLCBcImR5bmFtaWNcIl07XG4gICAgZm9yIChjb25zdCB0IGluIHIpXG4gICAgICBpZiAoIWUuaW5jbHVkZXMoclt0XSkpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgYCR7dH0gbXVzdCBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZXM6ICR7ZS5qb2luKFxuICAgICAgICAgICAgXCIsIFwiXG4gICAgICAgICAgKX0uIFwiJHtyW3RdfVwiIGdpdmVuLmBcbiAgICAgICAgKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMCxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICExLFxuICAgICAgZXJyb3I6IGVcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBGKHIsIGUpIHtcbiAgaWYgKGMoXCJzdHJpbmdcIiwgeyB0YWdOYW1lOiByIH0pLnN0YXR1cyAmJiBBKEhUTUxFbGVtZW50LCBlKS5zdGF0dXMpIHtcbiAgICBjb25zdCB0ID0gci50b0xvd2VyQ2FzZSgpO1xuICAgIGxldCBzID0gITA7XG4gICAgZm9yIChjb25zdCBuIGluIGUpXG4gICAgICBlW25dLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gdCAmJiAocyA9ICExKTtcbiAgICByZXR1cm4gcztcbiAgfSBlbHNlXG4gICAgcmV0dXJuICExO1xufVxuY2xhc3MgTCB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBCYXNlTWVudVRvZ2dsZWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgIG9wdGlvbnMgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51IHRvZ2dsZS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gb3B0aW9ucy5tZW51VG9nZ2xlRWxlbWVudCAgIC0gVGhlIHRvZ2dsZSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG9wdGlvbnMucGFyZW50RWxlbWVudCAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICogQHBhcmFtIHtCYXNlTWVudX0gICAgb3B0aW9ucy5jb250cm9sbGVkTWVudSAgICAgIC0gVGhlIG1lbnUgY29udHJvbGxlZCBieSB0aGlzIHRvZ2dsZS5cbiAgICogQHBhcmFtIHs/QmFzZU1lbnV9ICAgW29wdGlvbnMucGFyZW50TWVudSA9IG51bGxdIC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIHRvZ2dsZS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51VG9nZ2xlRWxlbWVudDogZSxcbiAgICBwYXJlbnRFbGVtZW50OiB0LFxuICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgIHBhcmVudE1lbnU6IG4gPSBudWxsXG4gIH0pIHtcbiAgICAvKipcbiAgICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSB0b2dnbGUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7T2JqZWN0PEhUTUxFbGVtZW50Pn1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7SFRNTEVsZW1lbnR9IHRvZ2dsZSAtIFRoZSBtZW51IHRvZ2dsZS5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSBwYXJlbnQgLSBUaGUgbWVudSBjb250YWluaW5nIHRoaXMgdG9nZ2xlLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZG9tXCIsIHtcbiAgICAgIHRvZ2dsZTogbnVsbCxcbiAgICAgIHBhcmVudDogbnVsbFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWNsYXJlZCBhY2Nlc3NpYmxlLW1lbnUgZWxlbWVudHMgd2l0aGluIHRoZSBtZW51IHRvZ2dsZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3Q8QmFzZU1lbnU+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtCYXNlTWVudX0gY29udHJvbGxlZE1lbnUgLSBUaGUgbWVudSBjb250cm9sbGVkIGJ5IHRoaXMgdG9nZ2xlLlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnV9IHBhcmVudE1lbnUgICAgIC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIHRvZ2dsZS5cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX2VsZW1lbnRzXCIsIHtcbiAgICAgIGNvbnRyb2xsZWRNZW51OiBudWxsLFxuICAgICAgcGFyZW50TWVudTogbnVsbFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBvcGVuIHN0YXRlIG9mIHRoZSBtZW51IHRvZ2dsZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfb3BlblwiLCAhMSk7XG4gICAgLyoqXG4gICAgICogVGhlIGV2ZW50IHRoYXQgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIG1lbnUgdG9nZ2xlIGV4cGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAZXZlbnQgYWNjZXNzaWJsZU1lbnVFeHBhbmRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtDdXN0b21FdmVudH1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgYnViYmxlcyAtIEEgZmxhZyB0byBidWJibGUgdGhlIGV2ZW50LlxuICAgICAqIEBwcm9wZXJ0eSB7T2JqZWN0PEJhc2VNZW51VG9nZ2xlPn0gZGV0YWlscyAtIFRoZSBkZXRhaWxzIG9iamVjdCBjb250YWluaW5nIHRoZSBCYXNlTWVudVRvZ2dsZSBpdHNlbGYuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9leHBhbmRFdmVudFwiLCBuZXcgQ3VzdG9tRXZlbnQoXCJhY2Nlc3NpYmxlTWVudUV4cGFuZFwiLCB7XG4gICAgICBidWJibGVzOiAhMCxcbiAgICAgIGRldGFpbDogeyB0b2dnbGU6IHRoaXMgfVxuICAgIH0pKTtcbiAgICAvKipcbiAgICAgKiBUaGUgZXZlbnQgdGhhdCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgbWVudSB0b2dnbGUgY29sbGFwc2VzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQGV2ZW50IGFjY2Vzc2libGVNZW51Q29sbGFwc2VcbiAgICAgKlxuICAgICAqIEB0eXBlIHtDdXN0b21FdmVudH1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgYnViYmxlcyAtIEEgZmxhZyB0byBidWJibGUgdGhlIGV2ZW50LlxuICAgICAqIEBwcm9wZXJ0eSB7T2JqZWN0PEJhc2VNZW51VG9nZ2xlPn0gZGV0YWlscyAtIFRoZSBkZXRhaWxzIG9iamVjdCBjb250YWluaW5nIHRoZSBCYXNlTWVudVRvZ2dsZSBpdHNlbGYuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9jb2xsYXBzZUV2ZW50XCIsIG5ldyBDdXN0b21FdmVudChcImFjY2Vzc2libGVNZW51Q29sbGFwc2VcIiwge1xuICAgICAgYnViYmxlczogITAsXG4gICAgICBkZXRhaWw6IHsgdG9nZ2xlOiB0aGlzIH1cbiAgICB9KSk7XG4gICAgdGhpcy5fZG9tLnRvZ2dsZSA9IGUsIHRoaXMuX2RvbS5wYXJlbnQgPSB0LCB0aGlzLl9lbGVtZW50cy5jb250cm9sbGVkTWVudSA9IHMsIHRoaXMuX2VsZW1lbnRzLnBhcmVudE1lbnUgPSBuO1xuICB9XG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgbWVudSB0b2dnbGUuXG4gICAqXG4gICAqIFRoZSBmaXJzdCBzdGVwcyBhcmUgdG8gZW5zdXJlIHRoYXQgdGhlIHRvZ2dsZSBhbmQgY29udHJvbGxlZCBtZW51IGhhdmUgSURzXG4gICAqIHVzaW5nIHRoZSBzZXRJZHMgbWV0aG9kLCBhbmQgdG8gc2V0IHRoZSBBUklBIGF0dHJpYnV0ZXMgb24gdGhlIHRvZ2dsZVxuICAgKiBhbmQgY29udHJvbGxlZCBtZW51IHVzaW5nIHRoZSBzZXRBcmlhQXR0cmlidXRlcyBtZXRob2QuXG4gICAqXG4gICAqIFRoZW4gdGhlIGNvbGxhcHNlIG1ldGhvZCBpcyBjYWxsZWQgdG8gbWFrZSBzdXJlIHRoZSBzdWJtZW51IGlzIGNsb3NlZC5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgdGhpcy5fc2V0SWRzKCksIHRoaXMuX3NldEFyaWFBdHRyaWJ1dGVzKCksIHRoaXMuX2NvbGxhcHNlKCExKTtcbiAgfVxuICAvKipcbiAgICogVGhlIERPTSBlbGVtZW50cyB3aXRoaW4gdGhlIHRvZ2dsZS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3Q8SFRNTEVsZW1lbnQ+fVxuICAgKlxuICAgKiBAc2VlIF9kb21cbiAgICovXG4gIGdldCBkb20oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RvbTtcbiAgfVxuICAvKipcbiAgICogVGhlIGRlY2xhcmVkIGFjY2Vzc2libGUtbWVudSBlbGVtZW50cyB3aXRoaW4gdGhlIHRvZ2dsZS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3Q8QmFzZU1lbnU+fVxuICAgKlxuICAgKiBAc2VlIF9lbGVtZW50c1xuICAgKi9cbiAgZ2V0IGVsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50cztcbiAgfVxuICAvKipcbiAgICogVGhlIG9wZW4gc3RhdGUgb24gdGhlIHRvZ2dsZS5cbiAgICpcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqXG4gICAqIEBzZWUgX29wZW5cbiAgICovXG4gIGdldCBpc09wZW4oKSB7XG4gICAgcmV0dXJuIHRoaXMuX29wZW47XG4gIH1cbiAgc2V0IGlzT3BlbihlKSB7XG4gICAgYyhcImJvb2xlYW5cIiwgeyB2YWx1ZTogZSB9KSwgdGhpcy5fb3BlbiA9IGU7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdW5pcXVlIElEcyBmb3IgdGhlIHRvZ2dsZSBhbmQgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBJZiB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUgZG8gbm90IGhhdmUgSURzLCB0aGUgZm9sbG93aW5nIHN0ZXBzIHRha2UgcGxhY2U6XG4gICAqIC0gR2VuZXJhdGUgYSByYW5kb20gc3RyaW5nIDEtMTAgY2hhcmFjdGVycyBsb25nLFxuICAgKiAtIEdldCB0aGUgaW5uZXJUZXh0IG9mIHRoZSB0b2dnbGUsXG4gICAqIC0gU2V0IHRoZSB0b2dnbGUncyBJRCB0bzogYG1lbnUtYnV0dG9uLSR7dG9nZ2xlLWlubmVyLXRleHR9LSR7dGhlLXJhbmRvbS1zdHJpbmd9YFxuICAgKiAtIFNldCB0aGUgbWVudSdzIElEIHRvOiBgbWVudS0ke3RvZ2dsZS1pbm5lci10ZXh0fS0ke3RoZS1yYW5kb20tc3RyaW5nfWBcbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldElkcygpIHtcbiAgICB2YXIgZTtcbiAgICBpZiAodGhpcy5kb20udG9nZ2xlLmlkID09PSBcIlwiIHx8IHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUuaWQgPT09IFwiXCIpIHtcbiAgICAgIGNvbnN0IHQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5yZXBsYWNlKC9bXmEtel0rL2csIFwiXCIpLnN1YnN0cmluZygwLCAxMCk7XG4gICAgICBsZXQgcyA9ICgoZSA9IHRoaXMuZG9tLnRvZ2dsZS5pbm5lclRleHQpID09IG51bGwgPyB2b2lkIDAgOiBlLnJlcGxhY2UoL1teYS16QS1aMC05XFxzXS9nLCBcIlwiKSkgfHwgXCJcIiwgbiA9IHQ7XG4gICAgICAhcy5yZXBsYWNlKC9cXHMvZywgXCJcIikubGVuZ3RoICYmIHRoaXMuZG9tLnRvZ2dsZS5nZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIpICYmIChzID0gdGhpcy5kb20udG9nZ2xlLmdldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIikucmVwbGFjZSgvW15hLXpBLVowLTlcXHNdL2csIFwiXCIpKSwgcy5yZXBsYWNlKC9cXHMvZywgXCJcIikubGVuZ3RoID4gMCAmJiAocyA9IHMudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKSwgcy5zdGFydHNXaXRoKFwiLVwiKSAmJiAocyA9IHMuc3Vic3RyaW5nKDEpKSwgcy5lbmRzV2l0aChcIi1cIikgJiYgKHMgPSBzLnNsaWNlKDAsIC0xKSksIG4gPSBgJHtzfS0ke259YCksIHRoaXMuZG9tLnRvZ2dsZS5pZCA9IHRoaXMuZG9tLnRvZ2dsZS5pZCB8fCBgbWVudS1idXR0b24tJHtufWAsIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUuaWQgPSB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LmlkIHx8IGBtZW51LSR7bn1gO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgQVJJQSBhdHRyaWJ1dGVzIG9uIHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogVGhlIGZpcnN0IHN0ZXBzIGFyZSB0byBlbnN1cmUgdGhhdCB0aGUgdG9nZ2xlIGhhcyBgYXJpYS1leHBhbmRlZGBcbiAgICogaXMgaW5pdGlhbGx5IHNldCB0byBcImZhbHNlXCIuXG4gICAqXG4gICAqIFRoZW4gdXNpbmcgdGhlIHRvZ2dsZSBhbmQgbWVudSdzIElEcywgdGhlIG1lbnUncyBgYXJpYS1sYWJlbGxlZGJ5YCBpcyBzZXQgdG9cbiAgICogdGhlIHRvZ2dsZSdzIElELlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfc2V0QXJpYUF0dHJpYnV0ZXMoKSB7XG4gICAgdGhpcy5kb20udG9nZ2xlLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgXCJmYWxzZVwiKSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudS5zZXRBdHRyaWJ1dGUoXG4gICAgICBcImFyaWEtbGFiZWxsZWRieVwiLFxuICAgICAgdGhpcy5kb20udG9nZ2xlLmlkXG4gICAgKTtcbiAgfVxuICAvKipcbiAgICogRXhwYW5kcyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBTZXRzIHRoZSB0b2dnbGUncyBgYXJpYS1leHBhbmRlZGAgdG8gXCJ0cnVlXCIsIGFkZHMgdGhlXG4gICAqIG9wZW4gY2xhc3MgdG8gdGhlIHRvZ2dsZSdzIHBhcmVudCBtZW51IGl0ZW1cbiAgICogYW5kIGNvbnRyb2xsZWQgbWVudSwgYW5kIHJlbW92ZXMgdGhlIGNsb3NlZCBjbGFzc1xuICAgKiBmcm9tIHRoZSB0b2dnbGUncyBwYXJlbnQgbWVudSBpdGVtIGFuZCBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIElmIGBlbWl0YCBpcyBzZXQgdG8gYHRydWVgLCB0aGlzIHdpbGwgYWxzbyBlbWl0IGEgY3VzdG9tIGV2ZW50XG4gICAqIGNhbGxlZCBhY2Nlc3NpYmxlTWVudUV4cGFuZFxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEBmaXJlcyBhY2Nlc3NpYmxlTWVudUV4cGFuZFxuICAgKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtlbWl0ID0gdHJ1ZV0gLSBBIHRvZ2dsZSB0byBlbWl0IHRoZSBleHBhbmQgZXZlbnQgb25jZSBleHBhbmRlZC5cbiAgICovXG4gIF9leHBhbmQoZSA9ICEwKSB7XG4gICAgY29uc3QgeyBjbG9zZUNsYXNzOiB0LCBvcGVuQ2xhc3M6IHMsIHRyYW5zaXRpb25DbGFzczogbiwgb3BlbkR1cmF0aW9uOiBpIH0gPSB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51O1xuICAgIHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIsIFwidHJ1ZVwiKSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5lbGVtZW50cy5yb290TWVudS5oYXNPcGVuZWQgPSAhMCwgbiAhPT0gXCJcIiA/IChTKG4sIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgRCh0LCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgUyhzLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIEQoXG4gICAgICAgICAgICAgIG4sXG4gICAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSwgaSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSkpIDogKFMocywgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSksIEQodCwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSkpLCBlICYmIHRoaXMuZG9tLnRvZ2dsZS5kaXNwYXRjaEV2ZW50KHRoaXMuX2V4cGFuZEV2ZW50KTtcbiAgfVxuICAvKipcbiAgICogQ29sbGFwc2VzIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIFNldHMgdGhlIHRvZ2dsZSdzIGBhcmlhLWV4cGFuZGVkYCB0byBcImZhbHNlXCIsIGFkZHMgdGhlXG4gICAqIGNsb3NlZCBjbGFzcyB0byB0aGUgdG9nZ2xlJ3MgcGFyZW50IG1lbnUgaXRlbVxuICAgKiBhbmQgY29udHJvbGxlZCBtZW51LCBhbmQgcmVtb3ZlcyB0aGUgb3BlbiBjbGFzc1xuICAgKiBmcm9tIHRoZSB0b2dnbGUncyBwYXJlbnQgbWVudSBpdGVtIGFuZCBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIElmIGBlbWl0YCBpcyBzZXQgdG8gYHRydWVgLCB0aGlzIHdpbGwgYWxzbyBlbWl0IGEgY3VzdG9tIGV2ZW50XG4gICAqIGNhbGxlZCBhY2Nlc3NpYmxlTWVudUNvbGxhcHNlXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICpcbiAgICogQGZpcmVzIGFjY2Vzc2libGVNZW51Q29sbGFwc2VcbiAgICpcbiAgICogQHBhcmFtIHtib29sZWFufSBbZW1pdCA9IHRydWVdIC0gQSB0b2dnbGUgdG8gZW1pdCB0aGUgY29sbGFwc2UgZXZlbnQgb25jZSBjb2xsYXBzZWQuXG4gICAqL1xuICBfY29sbGFwc2UoZSA9ICEwKSB7XG4gICAgY29uc3QgeyBjbG9zZUNsYXNzOiB0LCBvcGVuQ2xhc3M6IHMsIHRyYW5zaXRpb25DbGFzczogbiwgY2xvc2VEdXJhdGlvbjogaSB9ID0gdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudTtcbiAgICB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCBcImZhbHNlXCIpLCBuICE9PSBcIlwiID8gKFMobiwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICBEKHMsIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICBTKHQsIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgRChcbiAgICAgICAgICAgICAgbixcbiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9LCBpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KSkgOiAoUyh0LCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgRChzLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSksIGUgJiYgdGhpcy5kb20udG9nZ2xlLmRpc3BhdGNoRXZlbnQodGhpcy5fY29sbGFwc2VFdmVudCk7XG4gIH1cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIFNldHMgdGhlIGNvbnRyb2xsZWQgbWVudSdzIGZvY3VzIHN0YXRlIHRvIFwic2VsZlwiXG4gICAqIGFuZCB0aGUgcGFyZW50IG1lbnUncyBmb2N1cyBzdGF0ZSB0byBcImNoaWxkXCIsIGNhbGxzIGV4cGFuZCxcbiAgICogYW5kIHNldHMgdGhlIGlzT3BlbiB2YWx1ZSB0byBgdHJ1ZWAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5mb2N1c1N0YXRlID0gXCJzZWxmXCIsIHRoaXMuaXNPcGVuIHx8ICh0aGlzLl9leHBhbmQoKSwgdGhpcy5pc09wZW4gPSAhMCk7XG4gIH1cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBjb250cm9sbGVkIG1lbnUgd2l0aG91dCB0aGUgY3VycmVudCBmb2N1cyBlbnRlcmluZyBpdC5cbiAgICpcbiAgICogU2V0cyB0aGUgY29udHJvbGxlZCBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJzZWxmXCJcbiAgICogYW5kIHRoZSBwYXJlbnQgbWVudSdzIGZvY3VzIHN0YXRlIHRvIFwiY2hpbGRcIixcbiAgICogYW5kIGNhbGxzIGV4cGFuZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgcHJldmlldygpIHtcbiAgICB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgKHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5mb2N1c1N0YXRlID0gXCJzZWxmXCIpLCB0aGlzLmlzT3BlbiB8fCAodGhpcy5fZXhwYW5kKCksIHRoaXMuaXNPcGVuID0gITApO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogU2V0cyB0aGUgY29udHJvbGxlZCBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJub25lXCJcbiAgICogYW5kIHRoZSBwYXJlbnQgbWVudSdzIGZvY3VzIHN0YXRlIHRvIFwic2VsZlwiLCBibHVycyB0aGUgY29udHJvbGxlZCBtZW51XG4gICAqIGFuZCBzZXRzIGl0J3MgY3VycmVudCBjaGlsZCBpbmRleCB0byAwLFxuICAgKiBjYWxscyBjb2xsYXBzZSwgYW5kIHNldHNcbiAgICogdGhlIGlzT3BlbiB2YWx1ZSB0byBgZmFsc2VgLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBjbG9zZSgpIHtcbiAgICB0aGlzLmlzT3BlbiAmJiAodGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5ibHVyKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudSAmJiAodGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzU3RhdGUgPSBcInNlbGZcIiksIHRoaXMuX2NvbGxhcHNlKCksIHRoaXMuaXNPcGVuID0gITEpO1xuICB9XG4gIC8qKlxuICAgKiBUb2dnbGVzIHRoZSBvcGVuIHN0YXRlIG9mIHRoZSBjb250cm9sbGVkIG1lbnUgYmV0d2VlbiBgdHJ1ZWAgYW5kIGBmYWxzZWAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIHRvZ2dsZSgpIHtcbiAgICB0aGlzLmlzT3BlbiA/IHRoaXMuY2xvc2UoKSA6IHRoaXMub3BlbigpO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZXMgYWxsIHNpYmxpbmcgbWVudXMuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGNsb3NlU2libGluZ3MoKSB7XG4gICAgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51ICYmIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBlICE9PSB0aGlzICYmIGUuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogQ2xvc2VzIGFsbCBjaGlsZCBtZW51cy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgY2xvc2VDaGlsZHJlbigpIHtcbiAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLmZvckVhY2goXG4gICAgICAoZSkgPT4gZS5jbG9zZSgpXG4gICAgKTtcbiAgfVxufVxuY2xhc3MgTyB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBCYXNlTWVudUl0ZW1gLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51IGl0ZW0uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICBvcHRpb25zLm1lbnVJdGVtRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgb3B0aW9ucy5tZW51TGlua0VsZW1lbnQgICAgICAgICAtIFRoZSBtZW51IGl0ZW0ncyBsaW5rIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7QmFzZU1lbnV9ICAgICAgICBvcHRpb25zLnBhcmVudE1lbnUgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgW29wdGlvbnMuaXNTdWJtZW51SXRlbSA9IGZhbHNlXSAtIEEgZmxhZyB0byBtYXJrIGlmIHRoZSBtZW51IGl0ZW0gaXMgY29udHJvbGxpbmcgYSBzdWJtZW51LlxuICAgKiBAcGFyYW0gez9CYXNlTWVudX0gICAgICAgW29wdGlvbnMuY2hpbGRNZW51ID0gbnVsbF0gICAgICAtIFRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0gez9CYXNlTWVudVRvZ2dsZX0gW29wdGlvbnMudG9nZ2xlID0gbnVsbF0gICAgICAgICAtIFRoZSBjb250cm9sbGVyIGZvciB0aGUgY2hpbGQgbWVudS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51SXRlbUVsZW1lbnQ6IGUsXG4gICAgbWVudUxpbmtFbGVtZW50OiB0LFxuICAgIHBhcmVudE1lbnU6IHMsXG4gICAgaXNTdWJtZW51SXRlbTogbiA9ICExLFxuICAgIGNoaWxkTWVudTogaSA9IG51bGwsXG4gICAgdG9nZ2xlOiBsID0gbnVsbFxuICB9KSB7XG4gICAgLyoqXG4gICAgICogVGhlIERPTSBlbGVtZW50cyB3aXRoaW4gdGhlIG1lbnUgaXRlbS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3Q8SFRNTEVsZW1lbnQ+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudH0gaXRlbSAtIFRoZSBtZW51IGl0ZW0uXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudH0gbGluayAtIFRoZSBtZW51IGl0ZW0ncyBsaW5rLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZG9tXCIsIHtcbiAgICAgIGl0ZW06IG51bGwsXG4gICAgICBsaW5rOiBudWxsXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogVGhlIGRlY2xhcmVkIGFjY2Vzc2libGUtbWVudSBlbGVtZW50cyB3aXRoaW4gdGhlIG1lbnUgaXRlbS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3Q8QmFzZU1lbnUsIEJhc2VNZW51VG9nZ2xlPn1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnV9ICAgICAgICBwYXJlbnRNZW51IC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIG1lbnUgaXRlbS5cbiAgICAgKiBAcHJvcGVydHkgez9CYXNlTWVudX0gICAgICAgY2hpbGRNZW51ICAtIFRoZSBtZW51IGNvbnRhaW5lZCB3aXRoaW4gdGhpcyBtZW51IGl0ZW0uXG4gICAgICogQHByb3BlcnR5IHs/QmFzZU1lbnVUb2dnbGV9IHRvZ2dsZSAgICAgLSBUaGUgbWVudSB0b2dnbGUgd2l0aGluIHRoaXMgbWVudSBpdGVtIHRoYXQgY29udHJvbHMgdGhlIGBjaGlsZE1lbnVgLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZWxlbWVudHNcIiwge1xuICAgICAgcGFyZW50TWVudTogbnVsbCxcbiAgICAgIGNoaWxkTWVudTogbnVsbCxcbiAgICAgIHRvZ2dsZTogbnVsbFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIEEgZmxhZyBtYXJraW5nIGEgc3VibWVudSBpdGVtLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9zdWJtZW51XCIsICExKTtcbiAgICB0aGlzLl9kb20uaXRlbSA9IGUsIHRoaXMuX2RvbS5saW5rID0gdCwgdGhpcy5fZWxlbWVudHMucGFyZW50TWVudSA9IHMsIHRoaXMuX2VsZW1lbnRzLmNoaWxkTWVudSA9IGksIHRoaXMuX2VsZW1lbnRzLnRvZ2dsZSA9IGwsIHRoaXMuX3N1Ym1lbnUgPSBuO1xuICB9XG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBtZW51IGl0ZW0uXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICB9XG4gIC8qKlxuICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSBpdGVtLlxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHR5cGUge09iamVjdDxIVE1MRWxlbWVudD59XG4gICAqXG4gICAqIEBzZWUgX2RvbVxuICAgKi9cbiAgZ2V0IGRvbSgpIHtcbiAgICByZXR1cm4gdGhpcy5fZG9tO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZGVjbGFyZWQgYWNjZXNzaWJsZS1tZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSBpdGVtLlxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHR5cGUge09iamVjdDxCYXNlTWVudSwgQmFzZU1lbnVUb2dnbGU+fVxuICAgKlxuICAgKiBAc2VlIF9lbGVtZW50c1xuICAgKi9cbiAgZ2V0IGVsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50cztcbiAgfVxuICAvKipcbiAgICogQSBmbGFnIG1hcmtpbmcgYSBzdWJtZW51IGl0ZW0uXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICpcbiAgICogQHNlZSBfc3VibWVudVxuICAgKi9cbiAgZ2V0IGlzU3VibWVudUl0ZW0oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N1Ym1lbnU7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIG1lbnUgaXRlbSdzIGxpbmsgaWYgdGhlIHBhcmVudCBtZW51J3NcbiAgICogc2hvdWxkRm9jdXMgdmFsdWUgaXMgYHRydWVgLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1cygpIHtcbiAgICB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuc2hvdWxkRm9jdXMgJiYgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgIHRoaXMuZG9tLmxpbmsuZm9jdXMoKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogQmx1cnMgdGhlIG1lbnUgaXRlbSdzIGxpbmsgaWYgdGhlIHBhcmVudCBtZW51J3NcbiAgICogc2hvdWxkRm9jdXMgdmFsdWUgaXMgYHRydWVgLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBibHVyKCkge1xuICAgIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5zaG91bGRGb2N1cyAmJiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5kb20ubGluay5ibHVyKCk7XG4gICAgfSk7XG4gIH1cbn1cbmZ1bmN0aW9uIF8ocikge1xuICB0cnkge1xuICAgIGNvbnN0IGUgPSByLmtleSB8fCByLmtleUNvZGUsIHQgPSB7XG4gICAgICBFbnRlcjogZSA9PT0gXCJFbnRlclwiIHx8IGUgPT09IDEzLFxuICAgICAgU3BhY2U6IGUgPT09IFwiIFwiIHx8IGUgPT09IFwiU3BhY2ViYXJcIiB8fCBlID09PSAzMixcbiAgICAgIEVzY2FwZTogZSA9PT0gXCJFc2NhcGVcIiB8fCBlID09PSBcIkVzY1wiIHx8IGUgPT09IDI3LFxuICAgICAgQXJyb3dVcDogZSA9PT0gXCJBcnJvd1VwXCIgfHwgZSA9PT0gXCJVcFwiIHx8IGUgPT09IDM4LFxuICAgICAgQXJyb3dSaWdodDogZSA9PT0gXCJBcnJvd1JpZ2h0XCIgfHwgZSA9PT0gXCJSaWdodFwiIHx8IGUgPT09IDM5LFxuICAgICAgQXJyb3dEb3duOiBlID09PSBcIkFycm93RG93blwiIHx8IGUgPT09IFwiRG93blwiIHx8IGUgPT09IDQwLFxuICAgICAgQXJyb3dMZWZ0OiBlID09PSBcIkFycm93TGVmdFwiIHx8IGUgPT09IFwiTGVmdFwiIHx8IGUgPT09IDM3LFxuICAgICAgSG9tZTogZSA9PT0gXCJIb21lXCIgfHwgZSA9PT0gMzYsXG4gICAgICBFbmQ6IGUgPT09IFwiRW5kXCIgfHwgZSA9PT0gMzUsXG4gICAgICBDaGFyYWN0ZXI6IGlzTmFOKGUpICYmICEhZS5tYXRjaCgvXlthLXpBLVpdezF9JC8pLFxuICAgICAgVGFiOiBlID09PSBcIlRhYlwiIHx8IGUgPT09IDksXG4gICAgICBBc3RlcmlzazogZSA9PT0gXCIqXCIgfHwgZSA9PT0gNTZcbiAgICB9O1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0KS5maW5kKChzKSA9PiB0W3NdID09PSAhMCkgfHwgXCJcIjtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIFwiXCI7XG4gIH1cbn1cbmZ1bmN0aW9uIG8ocikge1xuICByLnByZXZlbnREZWZhdWx0KCksIHIuc3RvcFByb3BhZ2F0aW9uKCk7XG59XG5jbGFzcyB3IHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYEJhc2VNZW51YC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgIG9wdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51LlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgICAgb3B0aW9ucy5tZW51RWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG1lbnUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMubWVudUl0ZW1TZWxlY3RvciA9IGxpXSAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBpdGVtcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLm1lbnVMaW5rU2VsZWN0b3IgPSBhXSAgICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgbGlua3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51SXRlbVNlbGVjdG9yID0gbGk6aGFzKHVsKV0gLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGl0ZW1zIGNvbnRhaW5pbmcgc3VibWVudXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51VG9nZ2xlU2VsZWN0b3IgPSBhXSAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51IHRvZ2dsZSBidXR0b25zL2xpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudVNlbGVjdG9yID0gdWxdICAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3Igc3VibWVudXMuXG4gICAqIEBwYXJhbSB7P0hUTUxFbGVtZW50fSAgICAgICBbb3B0aW9ucy5jb250cm9sbGVyRWxlbWVudCA9IG51bGxdICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250cm9sbGluZyB0aGUgbWVudSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0gez9IVE1MRWxlbWVudH0gICAgICAgW29wdGlvbnMuY29udGFpbmVyRWxlbWVudCA9IG51bGxdICAgICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgbWVudSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMub3BlbkNsYXNzID0gc2hvd10gICAgICAgICAgICAgICAgIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIFwib3BlblwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMuY2xvc2VDbGFzcyA9IGhpZGVdICAgICAgICAgICAgICAgIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIFwiY2xvc2VkXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy50cmFuc2l0aW9uQ2xhc3MgPSB0cmFuc2l0aW9uaW5nXSAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgdHJhbnNpdGlvbmluZyBiZXR3ZWVuIFwib3BlblwiIGFuZCBcImNsb3NlZFwiIHN0YXRlcy5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbiA9IDI1MF0gICAgICAgICAtIFRoZSBkdXJhdGlvbiBvZiB0aGUgdHJhbnNpdGlvbiBiZXR3ZWVuIFwib3BlblwiIGFuZCBcImNsb3NlZFwiIHN0YXRlcyAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgIFtvcHRpb25zLm9wZW5EdXJhdGlvbiA9IC0xXSAgICAgICAgICAgICAgICAtIFRoZSBkdXJhdGlvbiBvZiB0aGUgdHJhbnNpdGlvbiBmcm9tIFwiY2xvc2VkXCIgdG8gXCJvcGVuXCIgc3RhdGVzIChpbiBtaWxsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuY2xvc2VEdXJhdGlvbiA9IC0xXSAgICAgICAgICAgICAgIC0gVGhlIGR1cmF0aW9uIG9mIHRoZSB0cmFuc2l0aW9uIGZyb20gXCJvcGVuXCIgdG8gXCJjbG9zZWRcIiBzdGF0ZXMgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5pc1RvcExldmVsID0gZmFsc2VdICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gbWFyayB0aGUgcm9vdCBtZW51LlxuICAgKiBAcGFyYW0gez9CYXNlTWVudX0gICAgICAgICAgW29wdGlvbnMucGFyZW50TWVudSA9IG51bGxdICAgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51IHRvIHRoaXMgbWVudS5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyVHlwZSA9IG9mZl0gICAgICAgICAgICAgICAgICAtIFRoZSB0eXBlIG9mIGhvdmVyYWJpbGl0eSBhIG1lbnUgaGFzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgW29wdGlvbnMuaG92ZXJEZWxheSA9IDI1MF0gICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIG1lbnVzIGlmIHRoZSBtZW51IGlzIGhvdmVyYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmVudGVyRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy5sZWF2ZURlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIGNsb3NpbmcgbWVudXMgaWYgdGhlIG1lbnUgaXMgaG92ZXJhYmxlIChpbiBtaWxsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0gez9zdHJpbmd9ICAgICAgICAgICAgW29wdGlvbnMucHJlZml4ID0gYW0tXSAgICAgICAgICAgICAgICAgICAgIC0gVGhlIHByZWZpeCB0byB1c2UgZm9yIENTUyBjdXN0b20gcHJvcGVydGllcy5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51RWxlbWVudDogZSxcbiAgICBtZW51SXRlbVNlbGVjdG9yOiB0ID0gXCJsaVwiLFxuICAgIG1lbnVMaW5rU2VsZWN0b3I6IHMgPSBcImFcIixcbiAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiBuID0gXCJsaTpoYXModWwpXCIsXG4gICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiBpID0gXCJhXCIsXG4gICAgc3VibWVudVNlbGVjdG9yOiBsID0gXCJ1bFwiLFxuICAgIGNvbnRyb2xsZXJFbGVtZW50OiBoID0gbnVsbCxcbiAgICBjb250YWluZXJFbGVtZW50OiBtID0gbnVsbCxcbiAgICBvcGVuQ2xhc3M6IGEgPSBcInNob3dcIixcbiAgICBjbG9zZUNsYXNzOiBmID0gXCJoaWRlXCIsXG4gICAgdHJhbnNpdGlvbkNsYXNzOiBwID0gXCJ0cmFuc2l0aW9uaW5nXCIsXG4gICAgdHJhbnNpdGlvbkR1cmF0aW9uOiBnID0gMjUwLFxuICAgIG9wZW5EdXJhdGlvbjogZCA9IC0xLFxuICAgIGNsb3NlRHVyYXRpb246IE0gPSAtMSxcbiAgICBpc1RvcExldmVsOiB5ID0gITAsXG4gICAgcGFyZW50TWVudTogYiA9IG51bGwsXG4gICAgaG92ZXJUeXBlOiBDID0gXCJvZmZcIixcbiAgICBob3ZlckRlbGF5OiBUID0gMjUwLFxuICAgIGVudGVyRGVsYXk6IEUgPSAtMSxcbiAgICBsZWF2ZURlbGF5OiBJID0gLTEsXG4gICAgcHJlZml4OiB2ID0gXCJhbS1cIlxuICB9KSB7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgc3VibWVudXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7dHlwZW9mIEJhc2VNZW51fVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudVR5cGVcIiwgdyk7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgbWVudSBpdGVtcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgQmFzZU1lbnVJdGVtfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudUl0ZW1UeXBlXCIsIE8pO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgQmFzZU1lbnVUb2dnbGV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VG9nZ2xlVHlwZVwiLCBMKTtcbiAgICAvKipcbiAgICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3Q8SFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50W10+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudH0gICBtZW51ICAgICAgICAgICAtIFRoZSBtZW51IGVsZW1lbnQuXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudFtdfSBtZW51SXRlbXMgICAgICAtIEFuIGFycmF5IG9mIG1lbnUgaXRlbXMuXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudFtdfSBzdWJtZW51SXRlbXMgICAtIEFuIGFycmF5IG9mIG1lbnUgaXRlbXMgdGhhdCBhbHNvIGNvbnRhaW4gc3VibWVudSBlbGVtZW50cy5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50W119IHN1Ym1lbnVUb2dnbGVzIC0gQW4gYXJyYXkgb2YgbWVudSBsaW5rcyB0aGF0IGZ1bmN0aW9uIGFzIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50W119IHN1Ym1lbnVzICAgICAgIC0gQW4gYXJyYXkgb2Ygc3VibWVudSBlbGVtZW50cy5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSAgIGNvbnRyb2xsZXIgICAgIC0gVGhlIHRvZ2dsZSBmb3IgdGhpcyBtZW51LlxuICAgICAqIEBwcm9wZXJ0eSB7SFRNTEVsZW1lbnR9ICAgY29udGFpbmVyICAgICAgLSBUaGUgY29udGFpbmVyIGZvciB0aGlzIG1lbnUuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9kb21cIiwge1xuICAgICAgbWVudTogbnVsbCxcbiAgICAgIG1lbnVJdGVtczogW10sXG4gICAgICBzdWJtZW51SXRlbXM6IFtdLFxuICAgICAgc3VibWVudVRvZ2dsZXM6IFtdLFxuICAgICAgc3VibWVudXM6IFtdLFxuICAgICAgY29udHJvbGxlcjogbnVsbCxcbiAgICAgIGNvbnRhaW5lcjogbnVsbFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBzZWxlY3RvcnMgdXNlZCBieSB0aGUgbWVudSB0byBwb3B1bGF0ZSB0aGUgZG9tLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxzdHJpbmc+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IG1lbnVJdGVtcyAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIGZvciBtZW51IGl0ZW1zLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBtZW51TGlua3MgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBmb3IgbWVudSBsaW5rcy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudUl0ZW1zICAgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgaXRlbXMgY29udGFpbmluZyBzdWJtZW51cy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudVRvZ2dsZXMgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgbGlua3MgdGhhdCBmdW5jdGlvbiBhcyBzdWJtZW51IHRvZ2dsZXMuXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IHN1Ym1lbnVzICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIGZvciBmb3Igc3VibWVudXMuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9zZWxlY3RvcnNcIiwge1xuICAgICAgbWVudUl0ZW1zOiBcIlwiLFxuICAgICAgbWVudUxpbmtzOiBcIlwiLFxuICAgICAgc3VibWVudUl0ZW1zOiBcIlwiLFxuICAgICAgc3VibWVudVRvZ2dsZXM6IFwiXCIsXG4gICAgICBzdWJtZW51czogXCJcIlxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWNsYXJlZCBhY2Nlc3NpYmxlLW1lbnUgZWxlbWVudHMgd2l0aGluIHRoZSBtZW51LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxCYXNlTWVudSwgQmFzZU1lbnVUb2dnbGUsIEJhc2VNZW51SXRlbVtdLCBCYXNlTWVudVRvZ2dsZVtdPn1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnVJdGVtW119ICAgbWVudUl0ZW1zICAgICAgLSBBbiBhcnJheSBvZiBtZW51IGl0ZW1zLlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnVUb2dnbGVbXX0gc3VibWVudVRvZ2dsZXMgLSBBbiBhcnJheSBvZiBtZW51IHRvZ2dsZXMuXG4gICAgICogQHByb3BlcnR5IHs/QmFzZU1lbnVUb2dnbGV9ICBjb250cm9sbGVyICAgICAtIEEgbWVudSB0b2dnbGUgdGhhdCBjb250cm9scyB0aGlzIG1lbnUuXG4gICAgICogQHByb3BlcnR5IHs/QmFzZU1lbnV9ICAgICAgICBwYXJlbnRNZW51ICAgICAtIFRoZSBwYXJlbnQgbWVudS5cbiAgICAgKiBAcHJvcGVydHkgez9CYXNlTWVudX0gICAgICAgIHJvb3RNZW51ICAgICAgIC0gVGhlIHJvb3QgbWVudSBvZiB0aGUgbWVudSB0cmVlLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZWxlbWVudHNcIiwge1xuICAgICAgbWVudUl0ZW1zOiBbXSxcbiAgICAgIHN1Ym1lbnVUb2dnbGVzOiBbXSxcbiAgICAgIGNvbnRyb2xsZXI6IG51bGwsXG4gICAgICBwYXJlbnRNZW51OiBudWxsLFxuICAgICAgcm9vdE1lbnU6IG51bGxcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MoZXMpIHRvIGFwcGx5IHdoZW4gdGhlIG1lbnUgaXMgb3Blbi5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd8c3RyaW5nW119XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9vcGVuQ2xhc3NcIiwgXCJzaG93XCIpO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyhlcykgdG8gYXBwbHkgd2hlbiB0aGUgbWVudSBpcyBjbG9zZWQuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfHN0cmluZ1tdfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfY2xvc2VDbGFzc1wiLCBcImhpZGVcIik7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzKGVzKSB0byBhcHBseSB3aGVuIHRoZSBtZW51IGlzIHRyYW5zaXRpb25pbmcgYmV0d2VlbiBzdGF0ZXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfHN0cmluZ1tdfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfdHJhbnNpdGlvbkNsYXNzXCIsIFwidHJhbnNpdGlvbmluZ1wiKTtcbiAgICAvKipcbiAgICAgKiBUaGUgZHVyYXRpb24gdGltZSAoaW4gbWlsbGlzZWNvbmRzKSBmb3IgdGhlIHRyYW5zaXRpb24gYmV0d2VlbiBvcGVuIGFuZCBjbG9zZWQgc3RhdGVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX3RyYW5zaXRpb25EdXJhdGlvblwiLCAyNTApO1xuICAgIC8qKlxuICAgICAqIFRoZSBkdXJhdGlvbiB0aW1lIChpbiBtaWxsaXNlY29uZHMpIGZvciB0aGUgdHJhbnNpdGlvbiBmcm9tIGNsb3NlZCB0byBvcGVuIHN0YXRlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9vcGVuRHVyYXRpb25cIiwgLTEpO1xuICAgIC8qKlxuICAgICAqIFRoZSBkdXJhdGlvbiB0aW1lIChpbiBtaWxsaXNlY29uZHMpIGZvciB0aGUgdHJhbnNpdGlvbiBmcm9tIG9wZW4gdG8gY2xvc2VkIHN0YXRlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9jbG9zZUR1cmF0aW9uXCIsIC0xKTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgbWFya2luZyB0aGUgcm9vdCBtZW51LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9yb290XCIsICEwKTtcbiAgICAvKipcbiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtZW51IGl0ZW0gaW4gdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfY3VycmVudENoaWxkXCIsIDApO1xuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBtZW51J3MgZm9jdXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZm9jdXNTdGF0ZVwiLCBcIm5vbmVcIik7XG4gICAgLyoqXG4gICAgICogVGhpcyBsYXN0IGV2ZW50IHRyaWdnZXJlZCBvbiB0aGUgbWVudS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9jdXJyZW50RXZlbnRcIiwgXCJub25lXCIpO1xuICAgIC8qKlxuICAgICAqIFRoZSB0eXBlIG9mIGhvdmVyYWJpbGl0eSBmb3IgdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfaG92ZXJUeXBlXCIsIFwib2ZmXCIpO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxsaXNlY29uZHMpIHVzZWQgZm9yIHBvaW50ZXJlbnRlci9wb2ludGVybGVhdmUgZXZlbnRzIHRvIHRha2UgcGxhY2UuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfaG92ZXJEZWxheVwiLCAyNTApO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxsaXNlY29uZHMpIHVzZWQgZm9yIHBvaW50ZXJlbnRlciBldmVudHMgdG8gdGFrZSBwbGFjZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9lbnRlckRlbGF5XCIsIC0xKTtcbiAgICAvKipcbiAgICAgKiBUaGUgZGVsYXkgdGltZSAoaW4gbWlsbGlzZWNvbmRzKSB1c2VkIGZvciBwb2ludGVybGVhdmUgZXZlbnRzIHRvIHRha2UgcGxhY2UuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfbGVhdmVEZWxheVwiLCAtMSk7XG4gICAgLyoqXG4gICAgICogVGhlIHByZWZpeCB0byB1c2UgZm9yIENTUyBjdXN0b20gcHJvcGVydGllcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9wcmVmaXhcIiwgXCJhbS1cIik7XG4gICAgLyoqXG4gICAgICogQSB2YXJpYWJsZSB0byBob2xkIHRoZSBob3ZlciB0aW1lb3V0IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUgez9GdW5jdGlvbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX2hvdmVyVGltZW91dFwiLCBudWxsKTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgdG8gY2hlY2sgaWYgdGhlIG1lbnUgY2FuIGR5bmFtaWNhbGx5IGhvdmVyIGJhc2VkIG9uIGlmIGEgbWVudSBoYXMgYmVlbiBvcGVuZWQgYWxyZWFkeS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfaGFzT3BlbmVkXCIsICExKTtcbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSBvZiBlcnJvciBtZXNzYWdlcyBnZW5lcmF0ZWQgYnkgdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9lcnJvcnNcIiwgW10pO1xuICAgIHRoaXMuX2RvbS5tZW51ID0gZSwgdGhpcy5fZG9tLmNvbnRyb2xsZXIgPSBoLCB0aGlzLl9kb20uY29udGFpbmVyID0gbSwgdGhpcy5fc2VsZWN0b3JzLm1lbnVJdGVtcyA9IHQsIHRoaXMuX3NlbGVjdG9ycy5tZW51TGlua3MgPSBzLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudUl0ZW1zID0gbiwgdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVUb2dnbGVzID0gaSwgdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVzID0gbCwgdGhpcy5fZWxlbWVudHMubWVudUl0ZW1zID0gW10sIHRoaXMuX2VsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzID0gW10sIHRoaXMuX2VsZW1lbnRzLmNvbnRyb2xsZXIgPSBudWxsLCB0aGlzLl9lbGVtZW50cy5wYXJlbnRNZW51ID0gYiwgdGhpcy5fZWxlbWVudHMucm9vdE1lbnUgPSB5ID8gdGhpcyA6IG51bGwsIHRoaXMuX29wZW5DbGFzcyA9IGEgfHwgXCJcIiwgdGhpcy5fY2xvc2VDbGFzcyA9IGYgfHwgXCJcIiwgdGhpcy5fdHJhbnNpdGlvbkNsYXNzID0gcCB8fCBcIlwiLCB0aGlzLl90cmFuc2l0aW9uRHVyYXRpb24gPSBnLCB0aGlzLl9vcGVuRHVyYXRpb24gPSBkLCB0aGlzLl9jbG9zZUR1cmF0aW9uID0gTSwgdGhpcy5fcHJlZml4ID0gdiB8fCBcIlwiLCB0aGlzLl9yb290ID0geSwgdGhpcy5faG92ZXJUeXBlID0gQywgdGhpcy5faG92ZXJEZWxheSA9IFQsIHRoaXMuX2VudGVyRGVsYXkgPSBFLCB0aGlzLl9sZWF2ZURlbGF5ID0gSTtcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIG1lbnUuXG4gICAqXG4gICAqIFRoZSBmb2xsb3dpbmcgc3RlcHMgd2lsbCBiZSB0YWtlbiB0byBpbml0aWFsaXplIHRoZSBtZW51OlxuICAgKiAtIFZhbGlkYXRlIHRoYXQgdGhlIG1lbnUgY2FuIGluaXRpYWxpemUuXG4gICAqIC0gRmluZCB0aGUgcm9vdCBtZW51IG9mIHRoZSBtZW51IHRyZWUgaWYgaXQgaXNuJ3QgYWxyZWFkeSBzZXQuXG4gICAqIC0gUG9wdWxhdGUgYWxsIERPTSBlbGVtZW50cyB3aXRoaW4gdGhlIGRvbS5cbiAgICogLSBJZiB0aGUgY3VycmVudCBtZW51IGlzIHRoZSByb290IG1lbnUgX2FuZF8gaGFzIGEgY29udHJvbGxlciwgaW5pdGlhbGl6ZVxuICAgKiAgIHRoZSBjb250cm9sbGVyLlxuICAgKiAtIFBvcHVsYXRlIHRoZSBtZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgZWxlbWVudHMuXG4gICAqIC0gU2V0IHRoZSB0cmFuc2l0aW9uIGR1cmF0aW9uIGN1c3RvbSBwcm9wIGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKlxuICAgKiBAdGhyb3dzIHtFcnJvcn0gV2lsbCB0aHJvdyBhbiBFcnJvciBpZiB2YWxpZGF0ZSByZXR1cm5zIGBmYWxzZWAuXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIGlmICghdGhpcy5fdmFsaWRhdGUoKSlcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEFjY2Vzc2libGVNZW51OiBjYW5ub3QgaW5pdGlhbGl6ZSBtZW51LiBUaGUgZm9sbG93aW5nIGVycm9ycyBoYXZlIGJlZW4gZm91bmQ6XG4gLSAke3RoaXMuZXJyb3JzLmpvaW4oXG4gICAgICAgICAgYFxuIC0gYFxuICAgICAgICApfWBcbiAgICAgICk7XG4gICAgaWYgKHRoaXMuZWxlbWVudHMucm9vdE1lbnUgPT09IG51bGwgJiYgdGhpcy5fZmluZFJvb3RNZW51KHRoaXMpLCB0aGlzLl9zZXRET01FbGVtZW50cygpLCB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5kb20uY29udHJvbGxlciAmJiB0aGlzLmRvbS5jb250YWluZXIpIHtcbiAgICAgIGNvbnN0IGUgPSBuZXcgdGhpcy5fTWVudVRvZ2dsZVR5cGUoe1xuICAgICAgICBtZW51VG9nZ2xlRWxlbWVudDogdGhpcy5kb20uY29udHJvbGxlcixcbiAgICAgICAgcGFyZW50RWxlbWVudDogdGhpcy5kb20uY29udGFpbmVyLFxuICAgICAgICBjb250cm9sbGVkTWVudTogdGhpc1xuICAgICAgfSk7XG4gICAgICBGKFwiYnV0dG9uXCIsIHsgdG9nZ2xlOiBlLmRvbS50b2dnbGUgfSkgfHwgZS5kb20udG9nZ2xlLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJidXR0b25cIiksIGUuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNvbnRyb2xzXCIsIHRoaXMuZG9tLm1lbnUuaWQpLCB0aGlzLl9lbGVtZW50cy5jb250cm9sbGVyID0gZTtcbiAgICB9XG4gICAgdGhpcy5fY3JlYXRlQ2hpbGRFbGVtZW50cygpLCB0aGlzLl9zZXRUcmFuc2l0aW9uRHVyYXRpb25zKCksIHRoaXMuaXNUb3BMZXZlbCAmJiAod2luZG93LkFjY2Vzc2libGVNZW51ID0gd2luZG93LkFjY2Vzc2libGVNZW51IHx8IHtcbiAgICAgIG1lbnVzOiB7fVxuICAgIH0sIHdpbmRvdy5BY2Nlc3NpYmxlTWVudS5tZW51c1t0aGlzLmRvbS5tZW51LmlkXSA9IHRoaXMpO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3Q8SFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50W10+fVxuICAgKlxuICAgKiBAc2VlIF9kb21cbiAgICovXG4gIGdldCBkb20oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RvbTtcbiAgfVxuICAvKipcbiAgICogVGhlIHF1ZXJ5IHNlbGVjdG9ycyB1c2VkIGJ5IHRoZSBtZW51IHRvIHBvcHVsYXRlIHRoZSBkb20uXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0PHN0cmluZz59XG4gICAqXG4gICAqIEBzZWUgX3NlbGVjdG9yc1xuICAgKi9cbiAgZ2V0IHNlbGVjdG9ycygpIHtcbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3JzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZGVjbGFyZWQgYWNjZXNzaWJsZS1tZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3Q8QmFzZU1lbnUsIEJhc2VNZW51VG9nZ2xlLCBCYXNlTWVudUl0ZW1bXSwgQmFzZU1lbnVUb2dnbGVbXT59XG4gICAqXG4gICAqIEBzZWUgX2VsZW1lbnRzXG4gICAqL1xuICBnZXQgZWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZmxhZyBtYXJraW5nIHRoZSByb290IG1lbnUuXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICpcbiAgICogQHNlZSBfcm9vdFxuICAgKi9cbiAgZ2V0IGlzVG9wTGV2ZWwoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jvb3Q7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBjbGFzcyhlcykgdG8gYXBwbHkgd2hlbiB0aGUgbWVudSBpcyBvcGVuLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3Mgb3BlbiBjbGFzcyhlcykuXG4gICAqXG4gICAqIEB0eXBlIHtzdHJpbmd8c3RyaW5nW119XG4gICAqXG4gICAqIEBzZWUgX29wZW5DbGFzc1xuICAgKi9cbiAgZ2V0IG9wZW5DbGFzcygpIHtcbiAgICByZXR1cm4gdGhpcy5pc1RvcExldmVsID8gdGhpcy5fb3BlbkNsYXNzIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5vcGVuQ2xhc3M7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBjbGFzcyhlcykgdG8gYXBwbHkgd2hlbiB0aGUgbWVudSBpcyBjbG9zZWQuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBjbG9zZSBjbGFzcyhlcykuXG4gICAqXG4gICAqIEB0eXBlIHtzdHJpbmd8c3RyaW5nW119XG4gICAqXG4gICAqIEBzZWUgX2Nsb3NlQ2xhc3NcbiAgICovXG4gIGdldCBjbG9zZUNsYXNzKCkge1xuICAgIHJldHVybiB0aGlzLmlzVG9wTGV2ZWwgPyB0aGlzLl9jbG9zZUNsYXNzIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5jbG9zZUNsYXNzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgY2xhc3MoZXMpIHRvIGFwcGx5IHdoZW4gdGhlIG1lbnUgaXMgdHJhbnNpdGlvbmluZyBiZXR3ZWVuIG9wZW4gYW5kIGNsb3NlZC5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgZGlmZmVyZW50bHkgZm9yIHJvb3QgdnMuIHN1Ym1lbnVzLlxuICAgKiBTdWJtZW51cyB3aWxsIGFsd2F5cyBpbmhlcml0IHRoZWlyIHJvb3QgbWVudSdzIHRyYW5zaXRpb24gY2xhc3MoZXMpLlxuICAgKlxuICAgKiBAdHlwZSB7c3RyaW5nfHN0cmluZ1tdfVxuICAgKlxuICAgKiBAc2VlIF90cmFuc2l0aW9uQ2xhc3NcbiAgICovXG4gIGdldCB0cmFuc2l0aW9uQ2xhc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX3RyYW5zaXRpb25DbGFzcyA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUudHJhbnNpdGlvbkNsYXNzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZHVyYXRpb24gdGltZSAoaW4gbWlsbGlzZWNvbmRzKSBmb3IgdGhlIHRyYW5zaXRpb24gYmV0d2VlbiBvcGVuIGFuZCBjbG9zZWQgc3RhdGVzLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3MgdHJhbnNpdGlvbiBkdXJhdGlvbi5cbiAgICpcbiAgICogU2V0dGluZyB0aGlzIHZhbHVlIHdpbGwgYWxzbyBzZXQgdGhlIC0tYW0tdHJhbnNpdGlvbi1kdXJhdGlvbiBDU1MgY3VzdG9tIHByb3BlcnR5IG9uIHRoZSBtZW51LlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF90cmFuc2l0aW9uRHVyYXRpb25cbiAgICovXG4gIGdldCB0cmFuc2l0aW9uRHVyYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX3RyYW5zaXRpb25EdXJhdGlvbiA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUudHJhbnNpdGlvbkR1cmF0aW9uO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZHVyYXRpb24gdGltZSAoaW4gbWlsbGlzZWNvbmRzKSBmb3IgdGhlIHRyYW5zaXRpb24gZnJvbSBjbG9zZWQgdG8gb3BlbiBzdGF0ZXMuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBvcGVuRHVyYXRpb24uXG4gICAqXG4gICAqIElmIG9wZW5EdXJhdGlvbiBpcyBzZXQgdG8gLTEsIHRoZSB0cmFuc2l0aW9uRHVyYXRpb24gdmFsdWUgd2lsbCBiZSB1c2VkIGluc3RlYWQuXG4gICAqXG4gICAqIFNldHRpbmcgdGhpcyB2YWx1ZSB3aWxsIGFsc28gc2V0IHRoZSAtLWFtLW9wZW4tdHJhbnNpdGlvbi1kdXJhdGlvbiBDU1MgY3VzdG9tIHByb3BlcnR5IG9uIHRoZSBtZW51LlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF9vcGVuRHVyYXRpb25cbiAgICovXG4gIGdldCBvcGVuRHVyYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX29wZW5EdXJhdGlvbiA9PT0gLTEgPyB0aGlzLnRyYW5zaXRpb25EdXJhdGlvbiA6IHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX29wZW5EdXJhdGlvbiA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUub3BlbkR1cmF0aW9uO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZHVyYXRpb24gdGltZSAoaW4gbWlsbGlzZWNvbmRzKSBmb3IgdGhlIHRyYW5zaXRpb24gZnJvbSBvcGVuIHRvIGNsb3NlZCBzdGF0ZXMuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBjbG9zZUR1cmF0aW9uLlxuICAgKlxuICAgKiBJZiBjbG9zZUR1cmF0aW9uIGlzIHNldCB0byAtMSwgdGhlIHRyYW5zaXRpb25EdXJhdGlvbiB2YWx1ZSB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAgICpcbiAgICogU2V0dGluZyB0aGlzIHZhbHVlIHdpbGwgYWxzbyBzZXQgdGhlIC0tYW0tY2xvc2UtdHJhbnNpdGlvbi1kdXJhdGlvbiBDU1MgY3VzdG9tIHByb3BlcnR5IG9uIHRoZSBtZW51LlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF9jbG9zZUR1cmF0aW9uXG4gICAqL1xuICBnZXQgY2xvc2VEdXJhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5fY2xvc2VEdXJhdGlvbiA9PT0gLTEgPyB0aGlzLnRyYW5zaXRpb25EdXJhdGlvbiA6IHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX2Nsb3NlRHVyYXRpb24gOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmNsb3NlRHVyYXRpb247XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBpbmRleCBvZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIG1lbnUgaXRlbSBpbiB0aGUgbWVudS5cbiAgICpcbiAgICogLSBBdHRlbXB0aW5nIHRvIHNldCBhIHZhbHVlIGxlc3MgdGhhbiAtMSB3aWxsIHNldCB0aGUgY3VycmVudCBjaGlsZCB0byAtMS5cbiAgICogLSBBdHRlbXB0aW5nIHRvIHNldCBhIHZhbHVlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgbnVtYmVyIG9mIG1lbnUgaXRlbXNcbiAgICogICB3aWxsIHNldCB0aGUgY3VycmVudCBjaGlsZCB0byB0aGUgaW5kZXggb2YgdGhlIGxhc3QgbWVudSBpdGVtIGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBJZiB0aGUgY3VycmVudCBtZW51IGhhcyBhIHBhcmVudCBtZW51IF9hbmRfIHRoZSBtZW51J3NcbiAgICogY3VycmVudCBldmVudCBpcyBcIm1vdXNlXCIsIFRoZSBwYXJlbnQgbWVudVxuICAgKiB3aWxsIGhhdmUgaXQncyBjdXJyZW50IGNoaWxkIHVwZGF0ZWQgYXMgd2VsbCB0byBoZWxwIHdpdGggdHJhbnNpdGlvbmluZ1xuICAgKiBiZXR3ZWVuIG1vdXNlIGFuZCBrZXlib2FyZCBuYXZpZ2F0aW9uLlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF9jdXJyZW50Q2hpbGRcbiAgICovXG4gIGdldCBjdXJyZW50Q2hpbGQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRDaGlsZDtcbiAgfVxuICAvKipcbiAgICogVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIG1lbnUncyBmb2N1cy5cbiAgICpcbiAgICogLSBJZiB0aGUgbWVudSBoYXMgc3VibWVudXMsIHNldHRpbmcgdGhlIGZvY3VzIHN0YXRlIHRvIFwibm9uZVwiIG9yIFwic2VsZlwiIHdpbGxcbiAgICogICB1cGRhdGUgYWxsIGNoaWxkIG1lbnVzIHRvIGhhdmUgdGhlIGZvY3VzIHN0YXRlIG9mIFwibm9uZVwiLlxuICAgKiAtIElmIHRoZSBtZW51IGhhcyBhIHBhcmVudCBtZW51LCBzZXR0aW5nIHRoZSBmb2N1cyBzdGF0ZSB0byBcInNlbGZcIiBvciBcImNoaWxkXCJcbiAgICogICB3aWxsIHVwZGF0ZSBhbGwgcGFyZW50IG1lbnVzIHRvIGhhdmUgdGhlIGZvY3VzIHN0YXRlIG9mIFwiY2hpbGRcIi5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICpcbiAgICogQHNlZSBfZm9jdXNTdGF0ZVxuICAgKi9cbiAgZ2V0IGZvY3VzU3RhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZvY3VzU3RhdGU7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBsYXN0IGV2ZW50IHRyaWdnZXJlZCBvbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICpcbiAgICogQHNlZSBfY3VycmVudEV2ZW50XG4gICAqL1xuICBnZXQgY3VycmVudEV2ZW50KCkge1xuICAgIHJldHVybiB0aGlzLl9jdXJyZW50RXZlbnQ7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbWVudSBpdGVtLlxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHR5cGUge0Jhc2VNZW51SXRlbX1cbiAgICovXG4gIGdldCBjdXJyZW50TWVudUl0ZW0oKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zW3RoaXMuY3VycmVudENoaWxkXTtcbiAgfVxuICAvKipcbiAgICogVGhlIHR5cGUgb2YgaG92ZXJhYmlsaXR5IGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgZGlmZmVyZW50bHkgZm9yIHJvb3QgdnMuIHN1Ym1lbnVzLlxuICAgKiBTdWJtZW51cyB3aWxsIGFsd2F5cyBpbmhlcml0IHRoZWlyIHJvb3QgbWVudSdzIGhvdmVyYWJpbGl0eS5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICpcbiAgICogQHNlZSBfaG92ZXJUeXBlXG4gICAqL1xuICBnZXQgaG92ZXJUeXBlKCkge1xuICAgIHJldHVybiB0aGlzLl9yb290ID8gdGhpcy5faG92ZXJUeXBlIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5ob3ZlclR5cGU7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxsaXNlY29uZHMpIHVzZWQgZm9yIHBvaW50ZXJlbnRlci9wb2ludGVybGVhdmUgZXZlbnRzIHRvIHRha2UgcGxhY2UuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBob3ZlciBkZWxheS5cbiAgICpcbiAgICogQHR5cGUge251bWJlcn1cbiAgICpcbiAgICogQHNlZSBfaG92ZXJEZWxheVxuICAgKi9cbiAgZ2V0IGhvdmVyRGVsYXkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jvb3QgPyB0aGlzLl9ob3ZlckRlbGF5IDogdGhpcy5lbGVtZW50cy5yb290TWVudS5ob3ZlckRlbGF5O1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZGVsYXkgdGltZSAoaW4gbWlsbGlzZWNvbmRzKSB1c2VkIGZvciBwb2ludGVyZW50ZXIgZXZlbnRzIHRvIHRha2UgcGxhY2UuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBlbnRlciBkZWxheS5cbiAgICpcbiAgICogSWYgZW50ZXJEZWxheSBpcyBzZXQgdG8gLTEsIHRoZSBob3ZlckRlbGF5IHZhbHVlIHdpbGwgYmUgdXNlZCBpbnN0ZWFkLlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF9lbnRlckRlbGF5XG4gICAqL1xuICBnZXQgZW50ZXJEZWxheSgpIHtcbiAgICByZXR1cm4gdGhpcy5fZW50ZXJEZWxheSA9PT0gLTEgPyB0aGlzLmhvdmVyRGVsYXkgOiB0aGlzLl9yb290ID8gdGhpcy5fZW50ZXJEZWxheSA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUuZW50ZXJEZWxheTtcbiAgfVxuICAvKipcbiAgICogVGhlIGRlbGF5IHRpbWUgKGluIG1pbGxpc2Vjb25kcykgdXNlZCBmb3IgcG9pbnRlcmxlYXZlIGV2ZW50cyB0byB0YWtlIHBsYWNlLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3MgbGVhdmUgZGVsYXkuXG4gICAqXG4gICAqIElmIGxlYXZlRGVsYXkgaXMgc2V0IHRvIC0xLCB0aGUgaG92ZXJEZWxheSB2YWx1ZSB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAgICpcbiAgICogQHR5cGUge251bWJlcn1cbiAgICpcbiAgICogQHNlZSBfbGVhdmVEZWxheVxuICAgKi9cbiAgZ2V0IGxlYXZlRGVsYXkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xlYXZlRGVsYXkgPT09IC0xID8gdGhpcy5ob3ZlckRlbGF5IDogdGhpcy5fcm9vdCA/IHRoaXMuX2xlYXZlRGVsYXkgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmxlYXZlRGVsYXk7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBwcmVmaXggdG8gdXNlIGZvciBDU1MgY3VzdG9tIHByb3BlcnRpZXMuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBwcmVmaXguXG4gICAqXG4gICAqIEB0eXBlIHtzdHJpbmd9XG4gICAqXG4gICAqIEBzZWUgX3ByZWZpeFxuICAgKi9cbiAgZ2V0IHByZWZpeCgpIHtcbiAgICByZXR1cm4gdGhpcy5fcm9vdCA/IHRoaXMuX3ByZWZpeCA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUucHJlZml4O1xuICB9XG4gIC8qKlxuICAgKiBBIGZsYWcgdG8gY2hlY2sgaWYgdGhlIG1lbnUncyBmb2N1cyBtZXRob2RzIHNob3VsZCBfYWN0dWFsbHlfIG1vdmUgdGhlIGZvY3VzIGluIHRoZSBET00uXG4gICAqXG4gICAqIFRoaXMgd2lsbCBiZSBgZmFsc2VgIHVubGVzcyBhbnkgb2YgdGhlIGZvbGxvd2luZyBjcml0ZXJpYSBhcmUgbWV0OlxuICAgKiAtIFRoZSBtZW51J3MgY3VycmVudCBldmVudCBpcyBcImtleWJvYXJkXCIuXG4gICAqIC0gVGhlIG1lbnUncyBjdXJyZW50IGV2ZW50IGlzIFwiY2hhcmFjdGVyXCIuXG4gICAqIC0gVGhlIG1lbnUncyBjdXJyZW50IGV2ZW50IGlzIFwibW91c2VcIiBfYW5kXyB0aGUgbWVudSdzXG4gICAqICAgaG92ZXIgdHlwZSBpcyBcImR5bmFtaWNcIi5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKi9cbiAgZ2V0IHNob3VsZEZvY3VzKCkge1xuICAgIGxldCBlID0gITE7XG4gICAgcmV0dXJuICh0aGlzLmN1cnJlbnRFdmVudCA9PT0gXCJrZXlib2FyZFwiIHx8IHRoaXMuY3VycmVudEV2ZW50ID09PSBcImNoYXJhY3RlclwiKSAmJiAoZSA9ICEwKSwgdGhpcy5jdXJyZW50RXZlbnQgPT09IFwibW91c2VcIiAmJiB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKGUgPSAhMCksIGU7XG4gIH1cbiAgLyoqXG4gICAqIEEgZmxhZyB0byBjaGVjayBpZiB0aGUgbWVudSBjYW4gZHluYW1pY2FsbHkgaG92ZXIuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBoYXNPcGVuZWQuXG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKlxuICAgKiBAc2VlIF9oYXNPcGVuZWRcbiAgICovXG4gIGdldCBoYXNPcGVuZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jvb3QgPyB0aGlzLl9oYXNPcGVuZWQgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51Lmhhc09wZW5lZDtcbiAgfVxuICAvKipcbiAgICogQW4gYXJyYXkgb2YgZXJyb3IgbWVzc2FnZXMgZ2VuZXJhdGVkIGJ5IHRoZSBtZW51LlxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgKlxuICAgKiBAc2VlIF9lcnJvcnNcbiAgICovXG4gIGdldCBlcnJvcnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2Vycm9ycztcbiAgfVxuICBzZXQgb3BlbkNsYXNzKGUpIHtcbiAgICBrKHsgb3BlbkNsYXNzOiBlIH0pLCB0aGlzLl9vcGVuQ2xhc3MgIT09IGUgJiYgKHRoaXMuX29wZW5DbGFzcyA9IGUpO1xuICB9XG4gIHNldCBjbG9zZUNsYXNzKGUpIHtcbiAgICBrKHsgY2xvc2VDbGFzczogZSB9KSwgdGhpcy5fY2xvc2VDbGFzcyAhPT0gZSAmJiAodGhpcy5fY2xvc2VDbGFzcyA9IGUpO1xuICB9XG4gIHNldCB0cmFuc2l0aW9uQ2xhc3MoZSkge1xuICAgIGsoeyB0cmFuc2l0aW9uQ2xhc3M6IGUgfSksIHRoaXMuX3RyYW5zaXRpb25DbGFzcyAhPT0gZSAmJiAodGhpcy5fdHJhbnNpdGlvbkNsYXNzID0gZSk7XG4gIH1cbiAgc2V0IHRyYW5zaXRpb25EdXJhdGlvbihlKSB7XG4gICAgYyhcIm51bWJlclwiLCB7IHZhbHVlOiBlIH0pLCB0aGlzLl90cmFuc2l0aW9uRHVyYXRpb24gIT09IGUgJiYgKHRoaXMuX3RyYW5zaXRpb25EdXJhdGlvbiA9IGUsIHRoaXMuX3NldFRyYW5zaXRpb25EdXJhdGlvbnMoKSk7XG4gIH1cbiAgc2V0IG9wZW5EdXJhdGlvbihlKSB7XG4gICAgYyhcIm51bWJlclwiLCB7IHZhbHVlOiBlIH0pLCB0aGlzLl9vcGVuRHVyYXRpb24gIT09IGUgJiYgKHRoaXMuX29wZW5EdXJhdGlvbiA9IGUsIHRoaXMuX3NldFRyYW5zaXRpb25EdXJhdGlvbnMoKSk7XG4gIH1cbiAgc2V0IGNsb3NlRHVyYXRpb24oZSkge1xuICAgIGMoXCJudW1iZXJcIiwgeyB2YWx1ZTogZSB9KSwgdGhpcy5fY2xvc2VEdXJhdGlvbiAhPT0gZSAmJiAodGhpcy5fY2xvc2VEdXJhdGlvbiA9IGUsIHRoaXMuX3NldFRyYW5zaXRpb25EdXJhdGlvbnMoKSk7XG4gIH1cbiAgc2V0IGN1cnJlbnRDaGlsZChlKSB7XG4gICAgYyhcIm51bWJlclwiLCB7IHZhbHVlOiBlIH0pO1xuICAgIGZ1bmN0aW9uIHQocykge1xuICAgICAgaWYgKFtcIm1vdXNlXCIsIFwiY2hhcmFjdGVyXCJdLmluY2x1ZGVzKHMuY3VycmVudEV2ZW50KSAmJiBzLmVsZW1lbnRzLnBhcmVudE1lbnUpIHtcbiAgICAgICAgbGV0IGkgPSAwLCBsID0gITE7XG4gICAgICAgIGZvciAoOyAhbCAmJiBpIDwgcy5lbGVtZW50cy5wYXJlbnRNZW51LmVsZW1lbnRzLm1lbnVJdGVtcy5sZW5ndGg7ICkge1xuICAgICAgICAgIGNvbnN0IGggPSBzLmVsZW1lbnRzLnBhcmVudE1lbnUuZWxlbWVudHMubWVudUl0ZW1zW2ldO1xuICAgICAgICAgIGguaXNTdWJtZW51SXRlbSAmJiBoLmVsZW1lbnRzLnRvZ2dsZS5lbGVtZW50cy5jb250cm9sbGVkTWVudSA9PT0gcyAmJiAobCA9ICEwLCBzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudEV2ZW50ID0gcy5jdXJyZW50RXZlbnQsIHMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50Q2hpbGQgPSBpKSwgaSsrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGUgPCAtMSA/ICh0aGlzLl9jdXJyZW50Q2hpbGQgPSAtMSwgdCh0aGlzKSkgOiBlID49IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCA/ICh0aGlzLl9jdXJyZW50Q2hpbGQgPSB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5sZW5ndGggLSAxLCB0KHRoaXMpKSA6IHRoaXMuZm9jdXNDaGlsZCAhPT0gZSAmJiAodGhpcy5fY3VycmVudENoaWxkID0gZSwgdCh0aGlzKSk7XG4gIH1cbiAgc2V0IGZvY3VzU3RhdGUoZSkge1xuICAgIFUoeyB2YWx1ZTogZSB9KSwgdGhpcy5fZm9jdXNTdGF0ZSAhPT0gZSAmJiAodGhpcy5fZm9jdXNTdGF0ZSA9IGUpLCB0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLmxlbmd0aCA+IDAgJiYgKGUgPT09IFwic2VsZlwiIHx8IGUgPT09IFwibm9uZVwiKSAmJiB0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLmZvckVhY2goKHQpID0+IHtcbiAgICAgIHQuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZm9jdXNTdGF0ZSA9IFwibm9uZVwiO1xuICAgIH0pLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgKGUgPT09IFwic2VsZlwiIHx8IGUgPT09IFwiY2hpbGRcIikgJiYgKHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5mb2N1c1N0YXRlID0gXCJjaGlsZFwiKTtcbiAgfVxuICBzZXQgY3VycmVudEV2ZW50KGUpIHtcbiAgICBXKHsgdmFsdWU6IGUgfSksIHRoaXMuX2N1cnJlbnRFdmVudCAhPT0gZSAmJiAodGhpcy5fY3VycmVudEV2ZW50ID0gZSwgdGhpcy5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5sZW5ndGggPiAwICYmIHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuZm9yRWFjaCgodCkgPT4ge1xuICAgICAgdC5lbGVtZW50cy5jb250cm9sbGVkTWVudS5jdXJyZW50RXZlbnQgPSBlO1xuICAgIH0pKTtcbiAgfVxuICBzZXQgaG92ZXJUeXBlKGUpIHtcbiAgICBOKHsgdmFsdWU6IGUgfSksIHRoaXMuX2hvdmVyVHlwZSAhPT0gZSAmJiAodGhpcy5faG92ZXJUeXBlID0gZSk7XG4gIH1cbiAgc2V0IGhvdmVyRGVsYXkoZSkge1xuICAgIGMoXCJudW1iZXJcIiwgeyB2YWx1ZTogZSB9KSwgdGhpcy5faG92ZXJEZWxheSAhPT0gZSAmJiAodGhpcy5faG92ZXJEZWxheSA9IGUpO1xuICB9XG4gIHNldCBlbnRlckRlbGF5KGUpIHtcbiAgICBjKFwibnVtYmVyXCIsIHsgdmFsdWU6IGUgfSksIHRoaXMuX2VudGVyRGVsYXkgIT09IGUgJiYgKHRoaXMuX2VudGVyRGVsYXkgPSBlKTtcbiAgfVxuICBzZXQgbGVhdmVEZWxheShlKSB7XG4gICAgYyhcIm51bWJlclwiLCB7IHZhbHVlOiBlIH0pLCB0aGlzLl9sZWF2ZURlbGF5ICE9PSBlICYmICh0aGlzLl9sZWF2ZURlbGF5ID0gZSk7XG4gIH1cbiAgc2V0IHByZWZpeChlKSB7XG4gICAgYyhcInN0cmluZ1wiLCB7IHZhbHVlOiBlIH0pLCB0aGlzLl9wcmVmaXggIT09IGUgJiYgKHRoaXMuX3ByZWZpeCA9IGUpO1xuICB9XG4gIHNldCBoYXNPcGVuZWQoZSkge1xuICAgIGMoXCJib29sZWFuXCIsIHsgdmFsdWU6IGUgfSksIHRoaXMuX2hhc09wZW5lZCAhPT0gZSAmJiAodGhpcy5faGFzT3BlbmVkID0gZSk7XG4gIH1cbiAgLyoqXG4gICAqIFZhbGlkYXRlcyBhbGwgYXNwZWN0cyBvZiB0aGUgbWVudSB0byBlbnN1cmUgcHJvcGVyIGZ1bmN0aW9uYWxpdHkuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICpcbiAgICogQHJldHVybiB7Ym9vbGVhbn0gLSBUaGUgcmVzdWx0IG9mIHRoZSB2YWxpZGF0aW9uLlxuICAgKi9cbiAgX3ZhbGlkYXRlKCkge1xuICAgIGxldCBlID0gITAsIHQ7XG4gICAgdGhpcy5fZG9tLmNvbnRhaW5lciAhPT0gbnVsbCB8fCB0aGlzLl9kb20uY29udHJvbGxlciAhPT0gbnVsbCA/IHQgPSBBKEhUTUxFbGVtZW50LCB7XG4gICAgICBtZW51RWxlbWVudDogdGhpcy5fZG9tLm1lbnUsXG4gICAgICBjb250cm9sbGVyRWxlbWVudDogdGhpcy5fZG9tLmNvbnRyb2xsZXIsXG4gICAgICBjb250YWluZXJFbGVtZW50OiB0aGlzLl9kb20uY29udGFpbmVyXG4gICAgfSkgOiB0ID0gQShIVE1MRWxlbWVudCwge1xuICAgICAgbWVudUVsZW1lbnQ6IHRoaXMuX2RvbS5tZW51XG4gICAgfSksIHQuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaCh0LmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIGxldCBzO1xuICAgIGlmICh0aGlzLl9zZWxlY3RvcnMuc3VibWVudUl0ZW1zICE9PSBcIlwiID8gcyA9IHgoe1xuICAgICAgbWVudUl0ZW1TZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JzLm1lbnVJdGVtcyxcbiAgICAgIG1lbnVMaW5rU2VsZWN0b3I6IHRoaXMuX3NlbGVjdG9ycy5tZW51TGlua3MsXG4gICAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiB0aGlzLl9zZWxlY3RvcnMuc3VibWVudUl0ZW1zLFxuICAgICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiB0aGlzLl9zZWxlY3RvcnMuc3VibWVudVRvZ2dsZXMsXG4gICAgICBzdWJtZW51U2VsZWN0b3I6IHRoaXMuX3NlbGVjdG9ycy5zdWJtZW51c1xuICAgIH0pIDogcyA9IHgoe1xuICAgICAgbWVudUl0ZW1TZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JzLm1lbnVJdGVtcyxcbiAgICAgIG1lbnVMaW5rU2VsZWN0b3I6IHRoaXMuX3NlbGVjdG9ycy5tZW51TGlua3NcbiAgICB9KSwgcy5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKHMuZXJyb3IubWVzc2FnZSksIGUgPSAhMSksIHRoaXMuX29wZW5DbGFzcyAhPT0gXCJcIikge1xuICAgICAgY29uc3QgZCA9IGsoeyBvcGVuQ2xhc3M6IHRoaXMuX29wZW5DbGFzcyB9KTtcbiAgICAgIGQuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChkLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fY2xvc2VDbGFzcyAhPT0gXCJcIikge1xuICAgICAgY29uc3QgZCA9IGsoe1xuICAgICAgICBjbG9zZUNsYXNzOiB0aGlzLl9jbG9zZUNsYXNzXG4gICAgICB9KTtcbiAgICAgIGQuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChkLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fdHJhbnNpdGlvbkNsYXNzICE9PSBcIlwiKSB7XG4gICAgICBjb25zdCBkID0gayh7XG4gICAgICAgIHRyYW5zaXRpb25DbGFzczogdGhpcy5fdHJhbnNpdGlvbkNsYXNzXG4gICAgICB9KTtcbiAgICAgIGQuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChkLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIH1cbiAgICBjb25zdCBuID0gYyhcIm51bWJlclwiLCB7XG4gICAgICB0cmFuc2l0aW9uRHVyYXRpb246IHRoaXMuX3RyYW5zaXRpb25EdXJhdGlvblxuICAgIH0pO1xuICAgIG4uc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChuLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIGNvbnN0IGkgPSBjKFwibnVtYmVyXCIsIHtcbiAgICAgIG9wZW5EdXJhdGlvbjogdGhpcy5fb3BlbkR1cmF0aW9uXG4gICAgfSk7XG4gICAgaS5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKGkuZXJyb3IubWVzc2FnZSksIGUgPSAhMSk7XG4gICAgY29uc3QgbCA9IGMoXCJudW1iZXJcIiwge1xuICAgICAgY2xvc2VEdXJhdGlvbjogdGhpcy5fY2xvc2VEdXJhdGlvblxuICAgIH0pO1xuICAgIGwuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChsLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIGNvbnN0IGggPSBjKFwiYm9vbGVhblwiLCB7IGlzVG9wTGV2ZWw6IHRoaXMuX3Jvb3QgfSk7XG4gICAgaWYgKGguc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChoLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpLCB0aGlzLl9lbGVtZW50cy5wYXJlbnRNZW51ICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBkID0gQSh3LCB7XG4gICAgICAgIHBhcmVudE1lbnU6IHRoaXMuX2VsZW1lbnRzLnBhcmVudE1lbnVcbiAgICAgIH0pO1xuICAgICAgZC5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKGQuZXJyb3IubWVzc2FnZSksIGUgPSAhMSk7XG4gICAgfVxuICAgIGNvbnN0IG0gPSBOKHsgaG92ZXJUeXBlOiB0aGlzLl9ob3ZlclR5cGUgfSk7XG4gICAgbS5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKG0uZXJyb3IubWVzc2FnZSksIGUgPSAhMSk7XG4gICAgY29uc3QgYSA9IGMoXCJudW1iZXJcIiwge1xuICAgICAgaG92ZXJEZWxheTogdGhpcy5faG92ZXJEZWxheVxuICAgIH0pO1xuICAgIGEuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChhLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpO1xuICAgIGNvbnN0IGYgPSBjKFwibnVtYmVyXCIsIHtcbiAgICAgIGVudGVyRGVsYXk6IHRoaXMuX2VudGVyRGVsYXlcbiAgICB9KTtcbiAgICBmLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goZi5lcnJvci5tZXNzYWdlKSwgZSA9ICExKTtcbiAgICBjb25zdCBwID0gYyhcIm51bWJlclwiLCB7XG4gICAgICBsZWF2ZURlbGF5OiB0aGlzLl9sZWF2ZURlbGF5XG4gICAgfSk7XG4gICAgcC5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKHAuZXJyb3IubWVzc2FnZSksIGUgPSAhMSk7XG4gICAgY29uc3QgZyA9IGMoXCJzdHJpbmdcIiwgeyBwcmVmaXg6IHRoaXMuX3ByZWZpeCB9KTtcbiAgICByZXR1cm4gZy5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKGcuZXJyb3IubWVzc2FnZSksIGUgPSAhMSksIGU7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICpcbiAgICogRWxlbWVudHMgdGhhdCBhcmUgbm90IHN0b3JlZCBpbnNpZGUgYW4gYXJyYXkgY2Fubm90IGJlIHNldCB0aHJvdWdoIHRoaXMgbWV0aG9kLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgIGVsZW1lbnRUeXBlICAgICAgICAgICAgLSBUaGUgdHlwZSBvZiBlbGVtZW50IHRvIHBvcHVsYXRlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBbYmFzZSA9IHRoaXMuZG9tLm1lbnVdIC0gVGhlIGVsZW1lbnQgdXNlZCBhcyB0aGUgYmFzZSBmb3IgdGhlIHF1ZXJ5U2VsZWN0LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICBbb3ZlcndyaXRlID0gdHJ1ZV0gICAgIC0gQSBmbGFnIHRvIHNldCBpZiB0aGUgZXhpc3RpbmcgZWxlbWVudHMgd2lsbCBiZSBvdmVyd3JpdHRlbi5cbiAgICovXG4gIF9zZXRET01FbGVtZW50VHlwZShlLCB0ID0gdGhpcy5kb20ubWVudSwgcyA9ICEwKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLnNlbGVjdG9yc1tlXSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5kb21bZV0pKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYEFjY2Vzc2libGVNZW51OiBUaGUgXCIke2V9XCIgZWxlbWVudCBjYW5ub3QgYmUgc2V0IHRocm91Z2ggX3NldERPTUVsZW1lbnRUeXBlLmBcbiAgICAgICAgKTtcbiAgICAgIHQgIT09IHRoaXMuZG9tLm1lbnUgJiYgQShIVE1MRWxlbWVudCwgeyBiYXNlOiB0IH0pO1xuICAgICAgY29uc3QgaSA9IEFycmF5LmZyb20oXG4gICAgICAgIHQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yc1tlXSlcbiAgICAgICkuZmlsdGVyKFxuICAgICAgICAobCkgPT4gbC5wYXJlbnRFbGVtZW50ID09PSB0XG4gICAgICApO1xuICAgICAgcyA/IHRoaXMuX2RvbVtlXSA9IGkgOiB0aGlzLl9kb21bZV0gPSBbXG4gICAgICAgIC4uLnRoaXMuX2RvbVtlXSxcbiAgICAgICAgLi4uaVxuICAgICAgXTtcbiAgICB9IGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEFjY2Vzc2libGVNZW51OiBcIiR7ZX1cIiBpcyBub3QgYSB2YWxpZCBlbGVtZW50IHR5cGUgd2l0aGluIHRoZSBtZW51LmBcbiAgICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIFJlc2V0cyBET00gZWxlbWVudHMgd2l0aGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBFbGVtZW50cyB0aGF0IGFyZSBub3Qgc3RvcmVkIGluc2lkZSBhbiBhcnJheSBjYW5ub3QgYmUgcmVzZXQgdGhyb3VnaCB0aGlzIG1ldGhvZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudFR5cGUgLSBUaGUgdHlwZSBvZiBlbGVtZW50IHRvIGNsZWFyLlxuICAgKi9cbiAgX3Jlc2V0RE9NRWxlbWVudFR5cGUoZSkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5kb21bZV0gPCBcInVcIikge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRoaXMuZG9tW2VdKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIGBBY2Nlc3NpYmxlTWVudTogVGhlIFwiJHtlfVwiIGVsZW1lbnQgY2Fubm90IGJlIHJlc2V0IHRocm91Z2ggX3Jlc2V0RE9NRWxlbWVudFR5cGUuYFxuICAgICAgICApO1xuICAgICAgdGhpcy5fZG9tW2VdID0gW107XG4gICAgfSBlbHNlXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBBY2Nlc3NpYmxlTWVudTogXCIke2V9XCIgaXMgbm90IGEgdmFsaWQgZWxlbWVudCB0eXBlIHdpdGhpbiB0aGUgbWVudS5gXG4gICAgICApO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIGFsbCBET00gZWxlbWVudHMgd2l0aGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBVdGlsaXplcyBfc2V0RE9NRWxlbWVudFR5cGUgYW5kXG4gICAqIF9yZXNldERPTUVsZW1lbnRUeXBlLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfc2V0RE9NRWxlbWVudHMoKSB7XG4gICAgdGhpcy5fc2V0RE9NRWxlbWVudFR5cGUoXCJtZW51SXRlbXNcIiksIHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVJdGVtcyAhPT0gXCJcIiAmJiAodGhpcy5fc2V0RE9NRWxlbWVudFR5cGUoXCJzdWJtZW51SXRlbXNcIiksIHRoaXMuX3Jlc2V0RE9NRWxlbWVudFR5cGUoXCJzdWJtZW51VG9nZ2xlc1wiKSwgdGhpcy5fcmVzZXRET01FbGVtZW50VHlwZShcInN1Ym1lbnVzXCIpLCB0aGlzLmRvbS5zdWJtZW51SXRlbXMuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgdGhpcy5fc2V0RE9NRWxlbWVudFR5cGUoXCJzdWJtZW51VG9nZ2xlc1wiLCBlLCAhMSksIHRoaXMuX3NldERPTUVsZW1lbnRUeXBlKFwic3VibWVudXNcIiwgZSwgITEpO1xuICAgIH0pKTtcbiAgfVxuICAvKipcbiAgICogRmluZHMgdGhlIHJvb3QgbWVudSBlbGVtZW50LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEBwYXJhbSB7QmFzZU1lbnV9IG1lbnUgLSBUaGUgbWVudSB0byBjaGVjay5cbiAgICovXG4gIF9maW5kUm9vdE1lbnUoZSkge1xuICAgIGlmIChlLmlzVG9wTGV2ZWwpXG4gICAgICB0aGlzLl9lbGVtZW50cy5yb290TWVudSA9IGU7XG4gICAgZWxzZSBpZiAoZS5lbGVtZW50cy5wYXJlbnRNZW51ICE9PSBudWxsKVxuICAgICAgdGhpcy5fZmluZFJvb3RNZW51KGUuZWxlbWVudHMucGFyZW50TWVudSk7XG4gICAgZWxzZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgcm9vdCBtZW51LlwiKTtcbiAgfVxuICAvKipcbiAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYWxsIG1lbnUgaXRlbXMgYW5kIHN1Ym1lbnVzLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfY3JlYXRlQ2hpbGRFbGVtZW50cygpIHtcbiAgICB0aGlzLmRvbS5tZW51SXRlbXMuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgbGV0IHQ7XG4gICAgICBpZiAodGhpcy5kb20uc3VibWVudUl0ZW1zLmluY2x1ZGVzKGUpKSB7XG4gICAgICAgIGNvbnN0IHMgPSBlLnF1ZXJ5U2VsZWN0b3IodGhpcy5zZWxlY3RvcnMuc3VibWVudVRvZ2dsZXMpLCBuID0gZS5xdWVyeVNlbGVjdG9yKHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVzKSwgaSA9IG5ldyB0aGlzLl9NZW51VHlwZSh7XG4gICAgICAgICAgbWVudUVsZW1lbnQ6IG4sXG4gICAgICAgICAgbWVudUl0ZW1TZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMubWVudUl0ZW1zLFxuICAgICAgICAgIG1lbnVMaW5rU2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLm1lbnVMaW5rcyxcbiAgICAgICAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5zdWJtZW51SXRlbXMsXG4gICAgICAgICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5zdWJtZW51VG9nZ2xlcyxcbiAgICAgICAgICBzdWJtZW51U2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVzLFxuICAgICAgICAgIG9wZW5DbGFzczogdGhpcy5vcGVuQ2xhc3MsXG4gICAgICAgICAgY2xvc2VDbGFzczogdGhpcy5jbG9zZUNsYXNzLFxuICAgICAgICAgIHRyYW5zaXRpb25DbGFzczogdGhpcy50cmFuc2l0aW9uQ2xhc3MsXG4gICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiB0aGlzLnRyYW5zaXRpb25EdXJhdGlvbixcbiAgICAgICAgICBvcGVuRHVyYXRpb246IHRoaXMub3BlbkR1cmF0aW9uLFxuICAgICAgICAgIGNsb3NlRHVyYXRpb246IHRoaXMuY2xvc2VEdXJhdGlvbixcbiAgICAgICAgICBpc1RvcExldmVsOiAhMSxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzLFxuICAgICAgICAgIGhvdmVyVHlwZTogdGhpcy5ob3ZlclR5cGUsXG4gICAgICAgICAgaG92ZXJEZWxheTogdGhpcy5ob3ZlckRlbGF5LFxuICAgICAgICAgIGVudGVyRGVsYXk6IHRoaXMuZW50ZXJEZWxheSxcbiAgICAgICAgICBsZWF2ZURlbGF5OiB0aGlzLmxlYXZlRGVsYXlcbiAgICAgICAgfSksIGwgPSBuZXcgdGhpcy5fTWVudVRvZ2dsZVR5cGUoe1xuICAgICAgICAgIG1lbnVUb2dnbGVFbGVtZW50OiBzLFxuICAgICAgICAgIHBhcmVudEVsZW1lbnQ6IGUsXG4gICAgICAgICAgY29udHJvbGxlZE1lbnU6IGksXG4gICAgICAgICAgcGFyZW50TWVudTogdGhpc1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fZWxlbWVudHMuc3VibWVudVRvZ2dsZXMucHVzaChsKSwgdCA9IG5ldyB0aGlzLl9NZW51SXRlbVR5cGUoe1xuICAgICAgICAgIG1lbnVJdGVtRWxlbWVudDogZSxcbiAgICAgICAgICBtZW51TGlua0VsZW1lbnQ6IHMsXG4gICAgICAgICAgcGFyZW50TWVudTogdGhpcyxcbiAgICAgICAgICBpc1N1Ym1lbnVJdGVtOiAhMCxcbiAgICAgICAgICBjaGlsZE1lbnU6IGksXG4gICAgICAgICAgdG9nZ2xlOiBsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgcyA9IGUucXVlcnlTZWxlY3Rvcih0aGlzLnNlbGVjdG9ycy5tZW51TGlua3MpO1xuICAgICAgICB0ID0gbmV3IHRoaXMuX01lbnVJdGVtVHlwZSh7XG4gICAgICAgICAgbWVudUl0ZW1FbGVtZW50OiBlLFxuICAgICAgICAgIG1lbnVMaW5rRWxlbWVudDogcyxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy5fZWxlbWVudHMubWVudUl0ZW1zLnB1c2godCk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIENsZWFycyB0aGUgaG92ZXIgdGltZW91dC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2NsZWFyVGltZW91dCgpIHtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5faG92ZXJUaW1lb3V0KTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgaG92ZXIgdGltZW91dC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIFRoZSBjYWxsYmFjayBmdW5jdGlvbiB0byBleGVjdXRlLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICBkZWxheSAgICAtIFRoZSBkZWxheSB0aW1lIGluIG1pbGxpc2Vjb25kcy5cbiAgICovXG4gIF9zZXRUaW1lb3V0KGUsIHQpIHtcbiAgICBjKFwiZnVuY3Rpb25cIiwgeyBjYWxsYmFjazogZSB9KSwgYyhcIm51bWJlclwiLCB7IGRlbGF5OiB0IH0pLCB0aGlzLl9ob3ZlclRpbWVvdXQgPSBzZXRUaW1lb3V0KGUsIHQpO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGZvY3VzIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIC0gQWRkcyBhIGBmb2N1c2AgbGlzdGVuZXIgdG8gZXZlcnkgbWVudSBpdGVtIHNvIHdoZW4gaXQgZ2FpbnMgZm9jdXMsXG4gICAqICAgaXQgd2lsbCBzZXQgdGhlIGl0ZW0ncyBjb250YWluaW5nIG1lbnUncyBmb2N1cyBzdGF0ZVxuICAgKiAgIHRvIFwic2VsZlwiLlxuICAgKiAtIEFkZHMgYSBgZm9jdXNvdXRgIGxpc3RlbmVyIHRvIHRoZSBtZW51IHNvIHdoZW4gdGhlIG1lbnUgbG9zZXMgZm9jdXMsXG4gICAqICAgaXQgd2lsbCBjbG9zZS5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUZvY3VzKCkge1xuICAgIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmZvckVhY2goKGUsIHQpID0+IHtcbiAgICAgIGUuZG9tLmxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5mb2N1c1N0YXRlID0gXCJzZWxmXCIsIHRoaXMuY3VycmVudENoaWxkID0gdDtcbiAgICAgIH0pO1xuICAgIH0pLCB0aGlzLmRvbS5tZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c291dFwiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgIT09IFwia2V5Ym9hcmRcIiB8fCBlLnJlbGF0ZWRUYXJnZXQgPT09IG51bGwgfHwgdGhpcy5kb20ubWVudS5jb250YWlucyhlLnJlbGF0ZWRUYXJnZXQpIHx8ICh0aGlzLmZvY3VzU3RhdGUgPSBcIm5vbmVcIiwgdGhpcy5jbG9zZUNoaWxkcmVuKCkpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGNsaWNrIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgdXNlLlxuICAgKlxuICAgKiAtIEFkZHMgYSBgcG9pbnRlcmRvd25gIGxpc3RlbmVyIHRvIGV2ZXJ5IG1lbnUgaXRlbSB0aGF0IHdpbGwgYmx1clxuICAgKiAgIGFsbCBtZW51IGl0ZW1zIGluIHRoZSBlbnRpcmUgbWVudSBzdHJ1Y3R1cmUgKHN0YXJ0aW5nIGF0IHRoZSByb290IG1lbnUpIGFuZFxuICAgKiAgIHRoZW4gcHJvcGVybHkgZm9jdXMgdGhlIGNsaWNrZWQgaXRlbS5cbiAgICogLSBBZGRzIGEgYHBvaW50ZXJ1cGAgbGlzdGVuZXIgdG8gZXZlcnkgc3VibWVudSBpdGVtIHRoYXQgd2lsbCBwcm9wZXJseVxuICAgKiAgIHRvZ2dsZSB0aGUgc3VibWVudSBvcGVuL2Nsb3NlZC5cbiAgICogLSBBZGRzIGEgYHBvaW50ZXJ1cGAgbGlzdGVuZXIgdG8gdGhlIG1lbnUncyBjb250cm9sbGVyXG4gICAqICAgKGlmIHRoZSBtZW51IGlzIHRoZSByb290IG1lbnUpIHNvIHdoZW4gaXQgaXMgY2xpY2tlZCBpdCB3aWxsIHByb3Blcmx5XG4gICAqICAgdG9nZ2xlIG9wZW4vY2xvc2VkLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlQ2xpY2soKSB7XG4gICAgZnVuY3Rpb24gZSh0LCBzLCBuKSB7XG4gICAgICBvKG4pLCBuLmJ1dHRvbiA9PT0gMCAmJiAocy50b2dnbGUoKSwgcy5pc09wZW4gJiYgKHQuZm9jdXNTdGF0ZSA9IFwic2VsZlwiLCBzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmZvY3VzU3RhdGUgPSBcIm5vbmVcIikpO1xuICAgIH1cbiAgICB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5mb3JFYWNoKCh0LCBzKSA9PiB7XG4gICAgICB0LmRvbS5saW5rLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwicG9pbnRlcmRvd25cIixcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5mb2N1c0NoaWxkKHMpO1xuICAgICAgICB9LFxuICAgICAgICB7IHBhc3NpdmU6ICEwIH1cbiAgICAgICksIHQuaXNTdWJtZW51SXRlbSAmJiB0LmVsZW1lbnRzLnRvZ2dsZS5kb20udG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgIFwicG9pbnRlcnVwXCIsXG4gICAgICAgIChuKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIGUodGhpcywgdC5lbGVtZW50cy50b2dnbGUsIG4pO1xuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pLCB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5kb20udG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBcInBvaW50ZXJ1cFwiLFxuICAgICAgKHQpID0+IHtcbiAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIGUodGhpcywgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLCB0KTtcbiAgICAgIH1cbiAgICApLCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsICh0KSA9PiB7XG4gICAgICB0aGlzLmZvY3VzU3RhdGUgIT09IFwibm9uZVwiICYmICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgIXRoaXMuZG9tLm1lbnUuY29udGFpbnModC50YXJnZXQpICYmICF0aGlzLmRvbS5tZW51ICE9PSB0LnRhcmdldCAmJiAodGhpcy5lbGVtZW50cy5yb290TWVudS5oYXNPcGVuZWQgPSB0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLnNvbWUoXG4gICAgICAgIChzKSA9PiBzLmlzT3BlblxuICAgICAgKSkpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGhvdmVyIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgdXNlLlxuICAgKlxuICAgKiBBZGRzIGBwb2ludGVyZW50ZXJgIGxpc3RlbmVycyB0byBhbGwgbWVudSBpdGVtcyBhbmQgYHBvaW50ZXJsZWF2ZWAgbGlzdGVuZXJzXG4gICAqIHRvIGFsbCBzdWJtZW51IGl0ZW1zIHdoaWNoIGZ1bmN0aW9uIGRpZmZlcmVudGx5IGRlcGVuZGluZyBvblxuICAgKiB0aGUgbWVudSdzIGhvdmVyIHR5cGUuXG4gICAqXG4gICAqIEJlZm9yZSBleGVjdXRpbmcgYW55dGhpbmcsIHRoZSBldmVudCBpcyBjaGVja2VkIHRvIG1ha2Ugc3VyZSB0aGUgZXZlbnQgd2Fzbid0XG4gICAqIHRyaWdnZXJlZCBieSBhIHBlbiBvciB0b3VjaC5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwib25cIjwvc3Ryb25nPlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhbnkgbWVudSBpdGVtIHRoZSBtZW51J3NcbiAgICogICAgY3VycmVudCBjaGlsZCB2YWx1ZSB3aWxsIGNoYW5nZSB0byB0aGF0XG4gICAqICAgbWVudSBpdGVtLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIHN1Ym1lbnUgaXRlbSB0aGVcbiAgICogICBwcmV2aWV3IG1ldGhvZCBmb3IgdGhlIHN1Ym1lbnUgaXRlbSdzXG4gICAqICAgdG9nZ2xlIHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmxlYXZlYCBldmVudCB0cmlnZ2VycyBvbiBhbiBvcGVuIHN1Ym1lbnUgaXRlbSB0aGVcbiAgICogICBjbG9zZSBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0ncyB0b2dnbGVcbiAgICogICB3aWxsIGJlIGNhbGxlZCBhZnRlciBhIGRlbGF5IHNldCBieSB0aGUgbWVudSdzIGhvdmVyIGRlbGF5LlxuICAgKlxuICAgKiA8c3Ryb25nPkhvdmVyIFR5cGUgXCJkeW5hbWljXCI8L3N0cm9uZz5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSB0aGUgbWVudSdzXG4gICAqICAgY3VycmVudCBjaGlsZCB2YWx1ZSB3aWxsIGNoYW5nZSB0byB0aGF0IG1lbnUgaXRlbS5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSwgYW5kIHRoZSBtZW51J3NcbiAgICogICBmb2N1cyBzdGF0ZSBpcyBub3QgXCJub25lXCIsIHRoZSBtZW51IGl0ZW1cbiAgICogICB3aWxsIGJlIGZvY3VzZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgc3VibWVudSBpdGVtLCBhbmQgYSBzdWJtZW51IGlzXG4gICAqICAgYWxyZWFkeSBvcGVuLCB0aGUgcHJldmlldyBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0ncyB0b2dnbGUgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgbm9uLXN1Ym1lbnUgaXRlbSwgYW5kIGEgc3VibWVudVxuICAgKiAgIGlzIGFscmVhZHkgb3BlbiwgdGhlIGNsb3NlQ2hpbGRyZW4gbWV0aG9kIGZvciB0aGUgbWVudSB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBzdWJtZW51IGl0ZW0sIGFuZCBubyBzdWJtZW51IGlzXG4gICAqICAgb3Blbiwgbm8gc3VibWVudS1zcGVjaWZpYyBtZXRob2RzIHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmxlYXZlYCBldmVudCB0cmlnZ2VycyBvbiBhbiBvcGVuIHN1Ym1lbnUgaXRlbSB0aGF0IGlzIG5vdCBhXG4gICAqICAgcm9vdC1sZXZlbCBzdWJtZW51IGl0ZW0gdGhlIGNsb3NlIG1ldGhvZCBmb3IgdGhlIHN1Ym1lbnUgaXRlbSdzIHRvZ2dsZVxuICAgKiAgIHdpbGwgYmUgY2FsbGVkIGFuZCB0aGUgc3VibWVudSBpdGVtIHdpbGwgYmUgZm9jdXNlZCBhZnRlciBhIGRlbGF5IHNldCBieVxuICAgKiAgIHRoZSBtZW51J3MgaG92ZXIgZGVsYXkuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVybGVhdmVgIGV2ZW50IHRyaWdnZXJzIG9uIGFuIG9wZW4gc3VibWVudSBpdGVtIHRoYXQgaXMgYVxuICAgKiAgIHJvb3QtbGV2ZWwgc3VibWVudSBpdGVtIG5vIHN1Ym1lbnUtc3BlY2lmaWMgbWV0aG9kcyB3aWxsIGJlIGNhbGxlZC5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwib2ZmXCI8L3N0cm9uZz5cbiAgICogQWxsIGBwb2ludGVyZW50ZXJgIGFuZCBgcG9pbnRlcmxlYXZlYCBldmVudHMgYXJlIGlnbm9yZWQuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVIb3ZlcigpIHtcbiAgICB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5mb3JFYWNoKChlLCB0KSA9PiB7XG4gICAgICBlLmRvbS5saW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZW50ZXJcIiwgKHMpID0+IHtcbiAgICAgICAgcy5wb2ludGVyVHlwZSA9PT0gXCJwZW5cIiB8fCBzLnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIgfHwgKHRoaXMuaG92ZXJUeXBlID09PSBcIm9uXCIgPyAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDaGlsZCh0KSwgZS5pc1N1Ym1lbnVJdGVtICYmICh0aGlzLmVudGVyRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBlLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCk7XG4gICAgICAgIH0sIHRoaXMuZW50ZXJEZWxheSkpIDogZS5lbGVtZW50cy50b2dnbGUucHJldmlldygpKSkgOiB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMuY3VycmVudENoaWxkID0gdCwgKCF0aGlzLmlzVG9wTGV2ZWwgfHwgdGhpcy5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIikgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCkpLCAoIXRoaXMuaXNUb3BMZXZlbCB8fCB0aGlzLmhhc09wZW5lZCkgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCksIGUuaXNTdWJtZW51SXRlbSA/IHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGUuZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKTtcbiAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiBlLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkgOiB0aGlzLmVudGVyRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNsb3NlQ2hpbGRyZW4oKTtcbiAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiB0aGlzLmNsb3NlQ2hpbGRyZW4oKSkpKTtcbiAgICAgIH0pLCBlLmlzU3VibWVudUl0ZW0gJiYgKGUuZG9tLml0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJsZWF2ZVwiLCAocykgPT4ge1xuICAgICAgICBzLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IHMucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiA/IHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCBlLmVsZW1lbnRzLnRvZ2dsZS5jbG9zZSgpO1xuICAgICAgICB9LCB0aGlzLmxlYXZlRGVsYXkpKSA6ICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgZS5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSkgOiB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiO1xuICAgICAgICB9LCB0aGlzLmxlYXZlRGVsYXkpKSA6IHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiKSk7XG4gICAgICB9KSwgZS5kb20uaXRlbS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmVudGVyXCIsIChzKSA9PiB7XG4gICAgICAgIHMucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgcy5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiIHx8IGUuaXNTdWJtZW51SXRlbSAmJiAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiB8fCB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIpICYmIHRoaXMubGVhdmVEZWxheSA+IDAgJiYgdGhpcy5fY2xlYXJUaW1lb3V0KCk7XG4gICAgICB9KSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5ZG93biBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHRoZSBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKlxuICAgKiAtIEFkZHMgYSBga2V5ZG93bmAgbGlzdGVuZXIgdG8gdGhlIG1lbnUncyBjb250cm9sbGVyIChpZiB0aGUgbWVudSBpcyB0aGUgcm9vdCBtZW51KS5cbiAgICogICAtIEJsb2NrcyBwcm9wYWdhdGlvbiBvbiBcIlNwYWNlXCIsIFwiRW50ZXJcIiwgYW5kIFwiRXNjYXBlXCIga2V5cy5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleWRvd24oKSB7XG4gICAgdGhpcy5pc1RvcExldmVsICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuZG9tLnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJrZXlkb3duXCIsXG4gICAgICAoZSkgPT4ge1xuICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIjtcbiAgICAgICAgY29uc3QgdCA9IF8oZSk7XG4gICAgICAgICh0ID09PSBcIlNwYWNlXCIgfHwgdCA9PT0gXCJFbnRlclwiKSAmJiBvKGUpO1xuICAgICAgfVxuICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5dXAgZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciBtZW51IHVzZS5cbiAgICpcbiAgICogLSBBZGRzIGEgYGtleXVwYCBsaXN0ZW5lciB0byB0aGUgbWVudSdzIGNvbnRyb2xsZXIgKGlmIHRoZSBtZW51IGlzIHRoZSByb290IG1lbnUpLlxuICAgKiAgIC0gVG9nZ2xlcyB0aGUgbWVudSB3aGVuIHRoZSB1c2VyIGhpdHMgXCJTcGFjZVwiIG9yIFwiRW50ZXJcIi5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleXVwKCkge1xuICAgIHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmRvbS50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChlKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIjtcbiAgICAgIGNvbnN0IHQgPSBfKGUpO1xuICAgICAgKHQgPT09IFwiU3BhY2VcIiB8fCB0ID09PSBcIkVudGVyXCIpICYmIChvKGUpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIudG9nZ2xlKCksIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5pc09wZW4gJiYgdGhpcy5mb2N1c0ZpcnN0Q2hpbGQoKSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIHRyYW5zaXRpb24gZHVyYXRpb25zIG9mIHRoZSBtZW51IGFzIGEgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzLlxuICAgKlxuICAgKiBUaGUgY3VzdG9tIHByb3BlcnRpZXMgYXJlOlxuICAgKiAgIC0gYC0tYW0tdHJhbnNpdGlvbi1kdXJhdGlvbmAsXG4gICAqICAgLSBgLS1hbS1vcGVuLXRyYW5zaXRpb24tZHVyYXRpb25gLCBhbmRcbiAgICogICAtIGAtLWFtLWNsb3NlLXRyYW5zaXRpb24tZHVyYXRpb25gLlxuICAgKlxuICAgKiBUaGUgcHJlZml4IG9mIGBhbS1gIGNhbiBiZSBjaGFuZ2VkIGJ5IHNldHRpbmcgdGhlIG1lbnUncyBwcmVmaXggdmFsdWUuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9zZXRUcmFuc2l0aW9uRHVyYXRpb25zKCkge1xuICAgIHRoaXMuZG9tLm1lbnUuc3R5bGUuc2V0UHJvcGVydHkoXG4gICAgICBgLS0ke3RoaXMucHJlZml4fXRyYW5zaXRpb24tZHVyYXRpb25gLFxuICAgICAgYCR7dGhpcy50cmFuc2l0aW9uRHVyYXRpb259bXNgXG4gICAgKSwgdGhpcy5kb20ubWVudS5zdHlsZS5zZXRQcm9wZXJ0eShcbiAgICAgIGAtLSR7dGhpcy5wcmVmaXh9b3Blbi10cmFuc2l0aW9uLWR1cmF0aW9uYCxcbiAgICAgIGAke3RoaXMub3BlbkR1cmF0aW9ufW1zYFxuICAgICksIHRoaXMuZG9tLm1lbnUuc3R5bGUuc2V0UHJvcGVydHkoXG4gICAgICBgLS0ke3RoaXMucHJlZml4fWNsb3NlLXRyYW5zaXRpb24tZHVyYXRpb25gLFxuICAgICAgYCR7dGhpcy5jbG9zZUR1cmF0aW9ufW1zYFxuICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51LlxuICAgKlxuICAgKiBTZXRzIHRoZSBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJzZWxmXCIgYW5kXG4gICAqIGZvY3Vzc2VzIHRoZSBtZW51IGlmIHRoZSBtZW51J3Mgc2hvdWxkRm9jdXNcbiAgICogdmFsdWUgaXMgYHRydWVgLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1cygpIHtcbiAgICB0aGlzLmZvY3VzU3RhdGUgPSBcInNlbGZcIiwgdGhpcy5zaG91bGRGb2N1cyAmJiB0aGlzLmRvbS5tZW51LmZvY3VzKCk7XG4gIH1cbiAgLyoqXG4gICAqIFVuZm9jdXMgdGhlIG1lbnUuXG4gICAqXG4gICAqIFNldHMgdGhlIG1lbnUncyBmb2N1cyBzdGF0ZSB0byBcIm5vbmVcIlxuICAgKiBhbmQgYmx1cnMgdGhlIG1lbnUgaWYgdGhlIG1lbnUncyBzaG91bGRGb2N1c1xuICAgKiB2YWx1ZSBpcyBgdHJ1ZWAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGJsdXIoKSB7XG4gICAgdGhpcy5mb2N1c1N0YXRlID0gXCJub25lXCIsIHRoaXMuc2hvdWxkRm9jdXMgJiYgdGhpcy5kb20ubWVudS5ibHVyKCk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51J3MgY3VycmVudCBjaGlsZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNDdXJyZW50Q2hpbGQoKSB7XG4gICAgdGhpcy5mb2N1c1N0YXRlID0gXCJzZWxmXCIsIHRoaXMuY3VycmVudENoaWxkICE9PSAtMSAmJiB0aGlzLmN1cnJlbnRNZW51SXRlbS5mb2N1cygpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBtZW51J3MgY2hpbGQgYXQgYSBnaXZlbiBpbmRleC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgaW5kZXggb2YgdGhlIGNoaWxkIHRvIGZvY3VzLlxuICAgKi9cbiAgZm9jdXNDaGlsZChlKSB7XG4gICAgdGhpcy5ibHVyQ3VycmVudENoaWxkKCksIHRoaXMuY3VycmVudENoaWxkID0gZSwgdGhpcy5mb2N1c0N1cnJlbnRDaGlsZCgpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBtZW51J3MgZmlyc3QgY2hpbGQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzRmlyc3RDaGlsZCgpIHtcbiAgICB0aGlzLmZvY3VzQ2hpbGQoMCk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51J3MgbGFzdCBjaGlsZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNMYXN0Q2hpbGQoKSB7XG4gICAgdGhpcy5mb2N1c0NoaWxkKHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCAtIDEpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIG5leHQgY2hpbGQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzTmV4dENoaWxkKCkge1xuICAgIHRoaXMuY3VycmVudENoaWxkIDwgdGhpcy5lbGVtZW50cy5tZW51SXRlbXMubGVuZ3RoIC0gMSA/IHRoaXMuZm9jdXNDaGlsZCh0aGlzLmN1cnJlbnRDaGlsZCArIDEpIDogdGhpcy5mb2N1c0N1cnJlbnRDaGlsZCgpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIHByZXZpb3VzIGNoaWxkLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c1ByZXZpb3VzQ2hpbGQoKSB7XG4gICAgdGhpcy5jdXJyZW50Q2hpbGQgPiAwID8gdGhpcy5mb2N1c0NoaWxkKHRoaXMuY3VycmVudENoaWxkIC0gMSkgOiB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCk7XG4gIH1cbiAgLyoqXG4gICAqIEJsdXJzIHRoZSBtZW51J3MgY3VycmVudCBjaGlsZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgYmx1ckN1cnJlbnRDaGlsZCgpIHtcbiAgICB0aGlzLmZvY3VzU3RhdGUgPSBcIm5vbmVcIiwgdGhpcy5jdXJyZW50Q2hpbGQgIT09IC0xICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmJsdXIoKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBjb250cm9sbGVyLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c0NvbnRyb2xsZXIoKSB7XG4gICAgdGhpcy5kb20uY29udHJvbGxlciAmJiAodGhpcy5zaG91bGRGb2N1cyAmJiB0aGlzLmRvbS5jb250cm9sbGVyLmZvY3VzKCksIHRoaXMuZm9jdXNTdGF0ZSA9IFwibm9uZVwiKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBjb250YWluZXIuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzQ29udGFpbmVyKCkge1xuICAgIHRoaXMuZG9tLmNvbnRhaW5lciAmJiAodGhpcy5zaG91bGRGb2N1cyAmJiB0aGlzLmRvbS5jb250YWluZXIuZm9jdXMoKSwgdGhpcy5mb2N1c1N0YXRlID0gXCJub25lXCIpO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZSBhbGwgc3VibWVudSBjaGlsZHJlbi5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgY2xvc2VDaGlsZHJlbigpIHtcbiAgICB0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLmZvckVhY2goKGUpID0+IGUuY2xvc2UoKSk7XG4gIH1cbiAgLyoqXG4gICAqIEJsdXJzIGFsbCBjaGlsZHJlbiBhbmQgc3VibWVudSdzIGNoaWxkcmVuLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBibHVyQ2hpbGRyZW4oKSB7XG4gICAgdGhpcy5lbGVtZW50cy5tZW51SXRlbXMuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgZS5ibHVyKCksIGUuaXNTdWJtZW51SXRlbSAmJiBlLmVsZW1lbnRzLmNoaWxkTWVudS5ibHVyQ2hpbGRyZW4oKTtcbiAgICB9KTtcbiAgfVxufVxuY2xhc3MgWiBleHRlbmRzIE8ge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgRGlzY2xvc3VyZU1lbnVJdGVtYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgICAgIG9wdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudSBpdGVtLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgICAgICAgb3B0aW9ucy5tZW51SXRlbUVsZW1lbnQgICAgICAgICAtIFRoZSBtZW51IGl0ZW0gaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgICAgIG9wdGlvbnMubWVudUxpbmtFbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtJ3MgbGluayBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0Rpc2Nsb3N1cmVNZW51fSAgICAgICAgb3B0aW9ucy5wYXJlbnRNZW51ICAgICAgICAgICAgICAtIFRoZSBwYXJlbnQgbWVudS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgICAgIFtvcHRpb25zLmlzU3VibWVudUl0ZW0gPSBmYWxzZV0gLSBBIGZsYWcgdG8gbWFyayBpZiB0aGUgbWVudSBpdGVtIGlzIGNvbnRyb2xsaW5nIGEgc3VibWVudS5cbiAgICogQHBhcmFtIHs/RGlzY2xvc3VyZU1lbnV9ICAgICAgIFtvcHRpb25zLmNoaWxkTWVudSA9IG51bGxdICAgICAgLSBUaGUgY2hpbGQgbWVudS5cbiAgICogQHBhcmFtIHs/RGlzY2xvc3VyZU1lbnVUb2dnbGV9IFtvcHRpb25zLnRvZ2dsZSA9IG51bGxdICAgICAgICAgLSBUaGUgY29udHJvbGxlciBmb3IgdGhlIGNoaWxkIG1lbnUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgaXRlbSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVJdGVtRWxlbWVudDogZSxcbiAgICBtZW51TGlua0VsZW1lbnQ6IHQsXG4gICAgcGFyZW50TWVudTogcyxcbiAgICBpc1N1Ym1lbnVJdGVtOiBuID0gITEsXG4gICAgY2hpbGRNZW51OiBpID0gbnVsbCxcbiAgICB0b2dnbGU6IGwgPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGggPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudUl0ZW1FbGVtZW50OiBlLFxuICAgICAgbWVudUxpbmtFbGVtZW50OiB0LFxuICAgICAgcGFyZW50TWVudTogcyxcbiAgICAgIGlzU3VibWVudUl0ZW06IG4sXG4gICAgICBjaGlsZE1lbnU6IGksXG4gICAgICB0b2dnbGU6IGxcbiAgICB9KSwgaCAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxufVxuY2xhc3MgUSBleHRlbmRzIEwge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgRGlzY2xvc3VyZU1lbnVUb2dnbGVgLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgb3B0aW9ucy5tZW51VG9nZ2xlRWxlbWVudCAgIC0gVGhlIHRvZ2dsZSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICBvcHRpb25zLnBhcmVudEVsZW1lbnQgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqIEBwYXJhbSB7RGlzY2xvc3VyZU1lbnV9ICBvcHRpb25zLmNvbnRyb2xsZWRNZW51ICAgICAgLSBUaGUgbWVudSBjb250cm9sbGVkIGJ5IHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0gez9EaXNjbG9zdXJlTWVudX0gW29wdGlvbnMucGFyZW50TWVudSA9IG51bGxdIC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIHRvZ2dsZS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgIFtvcHRpb25zLmluaXRpYWxpemUgPSB0cnVlXSAtIEEgZmxhZyB0byBpbml0aWFsaXplIHRoZSBtZW51IHRvZ2dsZSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVUb2dnbGVFbGVtZW50OiBlLFxuICAgIHBhcmVudEVsZW1lbnQ6IHQsXG4gICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgcGFyZW50TWVudTogbiA9IG51bGwsXG4gICAgaW5pdGlhbGl6ZTogaSA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51VG9nZ2xlRWxlbWVudDogZSxcbiAgICAgIHBhcmVudEVsZW1lbnQ6IHQsXG4gICAgICBjb250cm9sbGVkTWVudTogcyxcbiAgICAgIHBhcmVudE1lbnU6IG5cbiAgICB9KSwgaSAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgQVJJQSBhdHRyaWJ1dGVzIG9uIHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlIEJhc2VNZW51VG9nZ2xlJ3MgX3NldEFyaWFBdHRyaWJ1dGVzIG1ldGhvZC5cbiAgICpcbiAgICogRW5zdXJlcyB0aGUgdG9nZ2xlIGVsZW1lbnQgaGFzIGEgYHJvbGVgIG9mIFwiYnV0dG9uXCIgaWYgaXQgaXMgbm90XG4gICAqIGFscmVhZHkgYSBidXR0b24uXG4gICAqXG4gICAqIFRoZW4gdXNpbmcgdGhlIHRvZ2dsZSBhbmQgbWVudSdzIElEcywgdGhlIHRvZ2dsZSdzIGBhcmlhLWNvbnRyb2xzYFxuICAgKiBpcyBzZXQgdG8gdGhlIG1lbnUncyBJRC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldEFyaWFBdHRyaWJ1dGVzKCkge1xuICAgIHN1cGVyLl9zZXRBcmlhQXR0cmlidXRlcygpLCBGKFwiYnV0dG9uXCIsIHsgdG9nZ2xlOiB0aGlzLmRvbS50b2dnbGUgfSkgfHwgdGhpcy5kb20udG9nZ2xlLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJidXR0b25cIiksIHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXG4gICAgICBcImFyaWEtY29udHJvbHNcIixcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUuaWRcbiAgICApO1xuICB9XG4gIC8qKlxuICAgKiBPcGVucyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBDYWxscyB0aGUgIGNsb3NlU2libGluZ3MgbWV0aG9kXG4gICAqIGFuZCBfdGhlbl8gQmFzZU1lbnVUb2dnbGUncyBvcGVuIG1ldGhvZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgb3BlbigpIHtcbiAgICB0aGlzLmNsb3NlU2libGluZ3MoKSwgc3VwZXIub3BlbigpO1xuICB9XG4gIC8qKlxuICAgKiBPcGVucyB0aGUgY29udHJvbGxlZCBtZW51IHdpdGhvdXQgdGhlIGN1cnJlbnQgZm9jdXMgZW50ZXJpbmcgaXQuXG4gICAqXG4gICAqIENhbGxzIHRoZSAgY2xvc2VTaWJsaW5ncyBtZXRob2RcbiAgICogYW5kIF90aGVuXyBCYXNlTWVudVRvZ2dsZSdzIHByZXZpZXcgbWV0aG9kLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBwcmV2aWV3KCkge1xuICAgIHRoaXMuY2xvc2VTaWJsaW5ncygpLCBzdXBlci5wcmV2aWV3KCk7XG4gIH1cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBDYWxscyB0aGUgIGNsb3NlQ2hpbGRyZW4gbWV0aG9kXG4gICAqIGFuZCBfdGhlbl8gQmFzZU1lbnVUb2dnbGUncyBjbG9zZSBtZXRob2QuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuaXNPcGVuICYmIHRoaXMuY2xvc2VDaGlsZHJlbigpLCBzdXBlci5jbG9zZSgpO1xuICB9XG59XG5jbGFzcyB6IGV4dGVuZHMgdyB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBEaXNjbG9zdXJlTWVudWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgIG9wdGlvbnMubWVudUVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBtZW51IGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLm1lbnVJdGVtU2VsZWN0b3IgPSBsaV0gICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5tZW51TGlua1NlbGVjdG9yID0gYV0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGxpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudUl0ZW1TZWxlY3RvciA9IGxpOmhhcyh1bCldIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBpdGVtcyBjb250YWluaW5nIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudVRvZ2dsZVNlbGVjdG9yID0gYnV0dG9uXSAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3Igc3VibWVudSB0b2dnbGUgYnV0dG9ucy9saW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVTZWxlY3RvciA9IHVsXSAgICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0gez9IVE1MRWxlbWVudH0gICAgICAgW29wdGlvbnMuY29udHJvbGxlckVsZW1lbnQgPSBudWxsXSAgICAgICAgIC0gVGhlIGVsZW1lbnQgY29udHJvbGxpbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgIFtvcHRpb25zLmNvbnRhaW5lckVsZW1lbnQgPSBudWxsXSAgICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLm9wZW5DbGFzcyA9IHNob3ddICAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcIm9wZW5cIi5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLmNsb3NlQ2xhc3MgPSBoaWRlXSAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcImNsb3NlZFwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMudHJhbnNpdGlvbkNsYXNzID0gdHJhbnNpdGlvbmluZ10gIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIHRyYW5zaXRpb25pbmcgYmV0d2VlbiBcIm9wZW5cIiBhbmQgXCJjbG9zZWRcIiBzdGF0ZXMuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy50cmFuc2l0aW9uRHVyYXRpb24gPSAyNTBdICAgICAgICAgLSBUaGUgZHVyYXRpb24gb2YgdGhlIHRyYW5zaXRpb24gYmV0d2VlbiBcIm9wZW5cIiBhbmQgXCJjbG9zZWRcIiBzdGF0ZXMgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5vcGVuRHVyYXRpb24gPSAtMV0gICAgICAgICAgICAgICAgLSBUaGUgZHVyYXRpb24gb2YgdGhlIHRyYW5zaXRpb24gZnJvbSBcImNsb3NlZFwiIHRvIFwib3BlblwiIHN0YXRlcyAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgIFtvcHRpb25zLmNsb3NlRHVyYXRpb24gPSAtMV0gICAgICAgICAgICAgICAtIFRoZSBkdXJhdGlvbiBvZiB0aGUgdHJhbnNpdGlvbiBmcm9tIFwib3BlblwiIHRvIFwiY2xvc2VkXCIgc3RhdGVzIChpbiBtaWxsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuaXNUb3BMZXZlbCA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIG1hcmsgdGhlIHJvb3QgbWVudS5cbiAgICogQHBhcmFtIHs/RGlzY2xvc3VyZU1lbnV9ICAgIFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAgICAgICAgICAgICAgICAtIFRoZSBwYXJlbnQgbWVudSB0byB0aGlzIG1lbnUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5ob3ZlclR5cGUgPSBvZmZdICAgICAgICAgICAgICAgICAgLSBUaGUgdHlwZSBvZiBob3ZlcmFiaWxpdHkgYSBtZW51IGhhcy5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyRGVsYXkgPSAyNTBdICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhbmQgY2xvc2luZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy5lbnRlckRlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIG9wZW5pbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmxlYXZlRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3IgY2xvc2luZyBhIG1lbnUgaWYgdGhlIG1lbnUgaXMgZm9jdXNhYmxlIChpbiBtaWxsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMub3B0aW9uYWxLZXlTdXBwb3J0ID0gZmFsc2VdICAgICAgIC0gQSBmbGFnIHRvIGFkZCBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0IChBcnJvdyBrZXlzLCBIb21lLCBhbmQgRW5kKSB0byB0aGUgbWVudS5cbiAgICogQHBhcmFtIHs/c3RyaW5nfSAgICAgICAgICAgIFtvcHRpb25zLnByZWZpeCA9IGFtLV0gICAgICAgICAgICAgICAgICAgICAtIFRoZSBwcmVmaXggdG8gdXNlIGZvciBDU1MgY3VzdG9tIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVFbGVtZW50OiB0LFxuICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMgPSBcImxpXCIsXG4gICAgbWVudUxpbmtTZWxlY3RvcjogbiA9IFwiYVwiLFxuICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGkgPSBcImxpOmhhcyh1bClcIixcbiAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IGwgPSBcImJ1dHRvblwiLFxuICAgIHN1Ym1lbnVTZWxlY3RvcjogaCA9IFwidWxcIixcbiAgICBjb250cm9sbGVyRWxlbWVudDogbSA9IG51bGwsXG4gICAgY29udGFpbmVyRWxlbWVudDogYSA9IG51bGwsXG4gICAgb3BlbkNsYXNzOiBmID0gXCJzaG93XCIsXG4gICAgY2xvc2VDbGFzczogcCA9IFwiaGlkZVwiLFxuICAgIHRyYW5zaXRpb25DbGFzczogZyA9IFwidHJhbnNpdGlvbmluZ1wiLFxuICAgIHRyYW5zaXRpb25EdXJhdGlvbjogZCA9IDI1MCxcbiAgICBvcGVuRHVyYXRpb246IE0gPSAtMSxcbiAgICBjbG9zZUR1cmF0aW9uOiB5ID0gLTEsXG4gICAgaXNUb3BMZXZlbDogYiA9ICEwLFxuICAgIHBhcmVudE1lbnU6IEMgPSBudWxsLFxuICAgIGhvdmVyVHlwZTogVCA9IFwib2ZmXCIsXG4gICAgaG92ZXJEZWxheTogRSA9IDI1MCxcbiAgICBlbnRlckRlbGF5OiBJID0gLTEsXG4gICAgbGVhdmVEZWxheTogdiA9IC0xLFxuICAgIG9wdGlvbmFsS2V5U3VwcG9ydDogSyA9ICExLFxuICAgIHByZWZpeDogJCA9IFwiYW0tXCIsXG4gICAgaW5pdGlhbGl6ZTogViA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51RWxlbWVudDogdCxcbiAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMsXG4gICAgICBtZW51TGlua1NlbGVjdG9yOiBuLFxuICAgICAgc3VibWVudUl0ZW1TZWxlY3RvcjogaSxcbiAgICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogbCxcbiAgICAgIHN1Ym1lbnVTZWxlY3RvcjogaCxcbiAgICAgIGNvbnRyb2xsZXJFbGVtZW50OiBtLFxuICAgICAgY29udGFpbmVyRWxlbWVudDogYSxcbiAgICAgIG9wZW5DbGFzczogZixcbiAgICAgIGNsb3NlQ2xhc3M6IHAsXG4gICAgICB0cmFuc2l0aW9uQ2xhc3M6IGcsXG4gICAgICB0cmFuc2l0aW9uRHVyYXRpb246IGQsXG4gICAgICBvcGVuRHVyYXRpb246IE0sXG4gICAgICBjbG9zZUR1cmF0aW9uOiB5LFxuICAgICAgaXNUb3BMZXZlbDogYixcbiAgICAgIHBhcmVudE1lbnU6IEMsXG4gICAgICBob3ZlclR5cGU6IFQsXG4gICAgICBob3ZlckRlbGF5OiBFLFxuICAgICAgZW50ZXJEZWxheTogSSxcbiAgICAgIGxlYXZlRGVsYXk6IHYsXG4gICAgICBwcmVmaXg6ICRcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBzdWJtZW51cy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgRGlzY2xvc3VyZU1lbnV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VHlwZVwiLCB6KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBtZW51IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBEaXNjbG9zdXJlTWVudUl0ZW19XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51SXRlbVR5cGVcIiwgWik7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgc3VibWVudSB0b2dnbGVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBEaXNjbG9zdXJlTWVudVRvZ2dsZX1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVUb2dnbGVUeXBlXCIsIFEpO1xuICAgIC8qKlxuICAgICAqIFRoZSBpbmRleCBvZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIG1lbnUgaXRlbSBpbiB0aGUgbWVudS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9jdXJyZW50Q2hpbGRcIiwgLTEpO1xuICAgIC8qKlxuICAgICAqIEEgZmxhZyB0byBhZGQgb3B0aW9uYWwga2V5Ym9hcmQgc3VwcG9ydCAoQXJyb3cga2V5cywgXCJIb21lXCIsIGFuZCBcIkVuZFwiKSB0byB0aGUgbWVudS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfb3B0aW9uYWxTdXBwb3J0XCIsICExKTtcbiAgICB0aGlzLl9vcHRpb25hbFN1cHBvcnQgPSBLLCBWICYmIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICB9XG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgbWVudS5cbiAgICpcbiAgICogSW5pdGlhbGl6ZSB3aWxsIGNhbGwgQmFzZU1lbnUncyBpbml0aWFsaXplIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB1cCBmb2N1cyxcbiAgICogY2xpY2ssXG4gICAqIGhvdmVyLFxuICAgKiBrZXlkb3duLCBhbmRcbiAgICoga2V5dXAgZXZlbnRzIGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogSWYgdGhlIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2QgdGhyb3dzIGFuIGVycm9yLFxuICAgKiB0aGlzIHdpbGwgY2F0Y2ggaXQgYW5kIGxvZyBpdCB0byB0aGUgY29uc29sZS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHN1cGVyLmluaXRpYWxpemUoKSwgdGhpcy5faGFuZGxlRm9jdXMoKSwgdGhpcy5faGFuZGxlQ2xpY2soKSwgdGhpcy5faGFuZGxlSG92ZXIoKSwgdGhpcy5faGFuZGxlS2V5ZG93bigpLCB0aGlzLl9oYW5kbGVLZXl1cCgpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IodCk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIikgdG8gdGhlIG1lbnUuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBvcHRpb25hbEtleVN1cHBvcnQuXG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKlxuICAgKiBAc2VlIF9vcHRpb25hbFN1cHBvcnRcbiAgICovXG4gIGdldCBvcHRpb25hbEtleVN1cHBvcnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX29wdGlvbmFsU3VwcG9ydCA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUub3B0aW9uYWxLZXlTdXBwb3J0O1xuICB9XG4gIHNldCBvcHRpb25hbEtleVN1cHBvcnQodCkge1xuICAgIGMoXCJib29sZWFuXCIsIHsgb3B0aW9uYWxLZXlTdXBwb3J0OiB0IH0pLCB0aGlzLl9vcHRpb25hbFN1cHBvcnQgPSB0O1xuICB9XG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgYWxsIGFzcGVjdHMgb2YgdGhlIG1lbnUgdG8gZW5zdXJlIHByb3BlciBmdW5jdGlvbmFsaXR5LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IC0gVGhlIHJlc3VsdCBvZiB0aGUgdmFsaWRhdGlvbi5cbiAgICovXG4gIF92YWxpZGF0ZSgpIHtcbiAgICBsZXQgdCA9IHN1cGVyLl92YWxpZGF0ZSgpO1xuICAgIGNvbnN0IHMgPSBjKFwiYm9vbGVhblwiLCB7XG4gICAgICBvcHRpb25hbEtleVN1cHBvcnQ6IHRoaXMuX29wdGlvbmFsU3VwcG9ydFxuICAgIH0pO1xuICAgIHJldHVybiBzLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2gocy5lcnJvci5tZXNzYWdlKSwgdCA9ICExKSwgdDtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBjbGljayBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIHVzZS5cbiAgICpcbiAgICogLSBBZGRzIGFsbCBldmVudCBsaXN0ZW5lcnMgbGlzdGVkIGluXG4gICAqICAgQmFzZU1lbnUncyBfaGFuZGxlQ2xpY2sgbWV0aG9kLlxuICAgKiAtIEFkZHMgYSBgcG9pbnRlcnVwYCBsaXN0ZW5lciB0byB0aGUgYGRvY3VtZW50YCBzbyBpZiB0aGUgdXNlclxuICAgKiAgIGNsaWNrcyBvdXRzaWRlIG9mIHRoZSBtZW51IGl0IHdpbGwgY2xvc2UgaWYgaXQgaXMgb3Blbi5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUNsaWNrKCkge1xuICAgIHN1cGVyLl9oYW5kbGVDbGljaygpLCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsICh0KSA9PiB7XG4gICAgICB0aGlzLmZvY3VzU3RhdGUgIT09IFwibm9uZVwiICYmICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgIXRoaXMuZG9tLm1lbnUuY29udGFpbnModC50YXJnZXQpICYmICF0aGlzLmRvbS5tZW51ICE9PSB0LnRhcmdldCAmJiAodGhpcy5jbG9zZUNoaWxkcmVuKCksIHRoaXMuYmx1cigpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmNsb3NlKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuaGFzT3BlbmVkID0gITEpKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXlkb3duIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIFRoaXMgbWV0aG9kIGV4aXN0cyB0byBhc3Npc3QgdGhlIF9oYW5kbGVLZXl1cCBtZXRob2QuXG4gICAqIC0gQWRkcyBhbGwgYGtleWRvd25gIGxpc3RlbmVycyBmcm9tIEJhc2VNZW51J3MgX2hhbmRsZUtleWRvd24gbWV0aG9kXG4gICAqIC0gQWRkcyBhIGBrZXlkb3duYCBsaXN0ZW5lciB0byB0aGUgbWVudS9hbGwgc3VibWVudXMuXG4gICAqICAgLSBCbG9ja3MgcHJvcGFnYXRpb24gb24gdGhlIGZvbGxvd2luZyBrZXlzOiBcIlNwYWNlXCIsIFwiRW50ZXJcIiwgYW5kIFwiRXNjYXBlXCIuXG4gICAqICAgLSBfSWZfIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnRcbiAgICogICAgIGlzIGVuYWJsZWQsIGJsb2NrcyBwcm9wYWdhdGlvbiBvbiB0aGUgZm9sbG93aW5nIGtleXM6XG4gICAqICAgICBcIkFycm93VXBcIiwgXCJBcnJvd1JpZ2h0XCIsIFwiQXJyb3dEb3duXCIsIFwiQXJyb3dMZWZ0XCIsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIi5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleWRvd24oKSB7XG4gICAgc3VwZXIuX2hhbmRsZUtleWRvd24oKSwgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAodCkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBzID0gXyh0KTtcbiAgICAgIGlmICh0aGlzLmZvY3VzU3RhdGUgPT09IFwic2VsZlwiKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXCJTcGFjZVwiLCBcIkVudGVyXCJdLCBpID0gW1wiRXNjYXBlXCJdLCBsID0gW1wiRXNjYXBlXCJdO1xuICAgICAgICB0aGlzLm9wdGlvbmFsS2V5U3VwcG9ydCA/IFtcbiAgICAgICAgICBcIkFycm93VXBcIixcbiAgICAgICAgICBcIkFycm93UmlnaHRcIixcbiAgICAgICAgICBcIkFycm93RG93blwiLFxuICAgICAgICAgIFwiQXJyb3dMZWZ0XCIsXG4gICAgICAgICAgXCJIb21lXCIsXG4gICAgICAgICAgXCJFbmRcIlxuICAgICAgICBdLmluY2x1ZGVzKHMpICYmIG8odCkgOiAodGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiBuLmluY2x1ZGVzKHMpIHx8IHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiBpLmluY2x1ZGVzKHMpIHx8IHRoaXMuZWxlbWVudHMucGFyZW50TWVudSAmJiBsLmluY2x1ZGVzKHMpKSAmJiBvKHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGtleXVwIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIEFkZHMgYWxsIGBrZXl1cGAgbGlzdGVuZXJzIGZyb20gQmFzZU1lbnUncyBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKlxuICAgKiBBZGRzIHRoZSBmb2xsb3dpbmcga2V5YmluZGluZ3MgKGV4cGxhbmF0aW9ucyBhcmUgdGFrZW4gZnJvbSB0aGVcbiAgICogV0FJIEFSSUEgUHJhY3RpY2VzIEV4YW1wbGUgRGlzY2xvc3VyZSBmb3IgTmF2aWdhdGlvbiBNZW51cyk6XG4gICAqXG4gICAqIHwgS2V5IHwgRnVuY3Rpb24gfFxuICAgKiB8IC0tLSB8IC0tLSB8XG4gICAqIHwgX1RhYl8gb3IgX1NoaWZ0ICsgVGFiXyB8IE1vdmUga2V5Ym9hcmQgZm9jdXMgYW1vbmcgdG9wLWxldmVsIGJ1dHRvbnMsIGFuZCBpZiBhIGRyb3Bkb3duIGlzIG9wZW4sIGludG8gYW5kIHRocm91Z2ggbGlua3MgaW4gdGhlIGRyb3Bkb3duLiB8XG4gICAqIHwgX1NwYWNlXyBvciBfRW50ZXJfIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGRpc2Nsb3N1cmUgYnV0dG9uLCBhY3RpdmF0ZXMgdGhlIGJ1dHRvbiwgd2hpY2ggdG9nZ2xlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgZHJvcGRvd24uPC9saT48bGk+SWYgZm9jdXMgaXMgb24gYSBsaW5rOjx1bD48bGk+SWYgYW55IGxpbmsgaGFzIGFyaWEtY3VycmVudCBzZXQsIHJlbW92ZXMgaXQuPC9saT48bGk+U2V0cyBhcmlhLWN1cnJlbnQ9XCJwYWdlXCIgb24gdGhlIGZvY3VzZWQgbGluay48L2xpPjxsaT5BY3RpdmF0ZXMgdGhlIGZvY3VzZWQgbGluay48L2xpPjwvdWw+PC9saT48L3VsPiB8XG4gICAqIHwgX0VzY2FwZV8gfCBJZiBhIGRyb3Bkb3duIGlzIG9wZW4sIGNsb3NlcyBpdCBhbmQgc2V0cyBmb2N1cyBvbiB0aGUgYnV0dG9uIHRoYXQgY29udHJvbHMgdGhhdCBkcm9wZG93bi4gfFxuICAgKiB8IF9Eb3duIEFycm93XyBvciBfUmlnaHQgQXJyb3dfIChPcHRpb25hbH0pIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGJ1dHRvbiBhbmQgaXRzIGRyb3Bkb3duIGlzIGNvbGxhcHNlZCwgYW5kIGl0IGlzIG5vdCB0aGUgbGFzdCBidXR0b24sIG1vdmVzIGZvY3VzIHRvIHRoZSBuZXh0IGJ1dHRvbi48L2xpPjxsaT5pZiBmb2N1cyBpcyBvbiBhIGJ1dHRvbiBhbmQgaXRzIGRyb3Bkb3duIGlzIGV4cGFuZGVkLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgbGluayBpbiB0aGUgZHJvcGRvd24uPC9saT48bGk+SWYgZm9jdXMgaXMgb24gYSBsaW5rLCBhbmQgaXQgaXMgbm90IHRoZSBsYXN0IGxpbmssIG1vdmVzIGZvY3VzIHRvIHRoZSBuZXh0IGxpbmsuPC9saT48L3VsPiB8XG4gICAqIHwgX1VwIEFycm93XyBvciBfTGVmdCBBcnJvd18gKE9wdGlvbmFsfSkgfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgYnV0dG9uLCBhbmQgaXQgaXMgbm90IHRoZSBmaXJzdCBidXR0b24sIG1vdmVzIGZvY3VzIHRvIHRoZSBwcmV2aW91cyBidXR0b24uPC9saT48bGk+SWYgZm9jdXMgaXMgb24gYSBsaW5rLCBhbmQgaXQgaXMgbm90IHRoZSBmaXJzdCBsaW5rLCBtb3ZlcyBmb2N1cyB0byB0aGUgcHJldmlvdXMgbGluay48L2xpPjwvdWw+IHxcbiAgICogfCBfSG9tZV8gKE9wdGlvbmFsKSB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBidXR0b24sIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGJ1dHRvbi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGxpbmssIG1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBsaW5rLjwvbGk+PC91bD4gfFxuICAgKiB8IF9FbmRfIChPcHRpb25hbCkgfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgYnV0dG9uLCBhbmQgaXQgaXMgbm90IHRoZSBsYXN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIGxhc3QgYnV0dG9uLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluaywgYW5kIGl0IGlzIG5vdCB0aGUgbGFzdCBsaW5rLCBtb3ZlcyBmb2N1cyB0byB0aGUgbGFzdCBsaW5rLjwvbGk+PC91bD4gfFxuICAgKlxuICAgKiBUaGUgb3B0aW9uYWwga2V5YmluZGluZ3MgYXJlIGNvbnRyb2xsZWQgYnkgdGhlIG1lbnUncyBvcHRpb25hbEtleVN1cHBvcnQgdmFsdWUuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXl1cCgpIHtcbiAgICBzdXBlci5faGFuZGxlS2V5dXAoKSwgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKHQpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IF8odCk7XG4gICAgICB0aGlzLmZvY3VzU3RhdGUgPT09IFwic2VsZlwiICYmIChzID09PSBcIlNwYWNlXCIgfHwgcyA9PT0gXCJFbnRlclwiID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmNsb3NlKCkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUucHJldmlldygpKSA6IHRoaXMuY3VycmVudE1lbnVJdGVtLmRvbS5saW5rLmNsaWNrKCkgOiBzID09PSBcIkVzY2FwZVwiID8gdGhpcy5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5zb21lKFxuICAgICAgICAoaSkgPT4gaS5pc09wZW5cbiAgICAgICkgPyAobyh0KSwgdGhpcy5jbG9zZUNoaWxkcmVuKCkpIDogdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51ID8gKG8odCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50RXZlbnQgPSB0aGlzLmN1cnJlbnRFdmVudCwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzQ3VycmVudENoaWxkKCkpIDogdGhpcy5pc1RvcExldmVsICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuaXNPcGVuICYmICh0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuY2xvc2UoKSwgdGhpcy5mb2N1c0NvbnRyb2xsZXIoKSkgOiB0aGlzLm9wdGlvbmFsS2V5U3VwcG9ydCAmJiAocyA9PT0gXCJBcnJvd0Rvd25cIiB8fCBzID09PSBcIkFycm93UmlnaHRcIiA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIiwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzRmlyc3RDaGlsZCgpKSA6IHRoaXMuZm9jdXNOZXh0Q2hpbGQoKSkgOiBzID09PSBcIkFycm93VXBcIiB8fCBzID09PSBcIkFycm93TGVmdFwiID8gKG8odCksIHRoaXMuZm9jdXNQcmV2aW91c0NoaWxkKCkpIDogcyA9PT0gXCJIb21lXCIgPyAobyh0KSwgdGhpcy5mb2N1c0ZpcnN0Q2hpbGQoKSkgOiBzID09PSBcIkVuZFwiICYmIChvKHQpLCB0aGlzLmZvY3VzTGFzdENoaWxkKCkpKSk7XG4gICAgfSk7XG4gIH1cbn1cbmNsYXNzIEIgZXh0ZW5kcyBPIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYE1lbnViYXJJdGVtYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51IGl0ZW0uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgIG9wdGlvbnMubWVudUl0ZW1FbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgIG9wdGlvbnMubWVudUxpbmtFbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtJ3MgbGluayBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge01lbnViYXJ9ICAgICAgICBvcHRpb25zLnBhcmVudE1lbnUgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICBbb3B0aW9ucy5pc1N1Ym1lbnVJdGVtID0gZmFsc2VdIC0gQSBmbGFnIHRvIG1hcmsgaWYgdGhlIG1lbnUgaXRlbSBpcyBjb250cm9sbGluZyBhIHN1Ym1lbnUuXG4gICAqIEBwYXJhbSB7P01lbnViYXJ9ICAgICAgIFtvcHRpb25zLmNoaWxkTWVudSA9IG51bGxdICAgICAgLSBUaGUgY2hpbGQgbWVudS5cbiAgICogQHBhcmFtIHs/TWVudWJhclRvZ2dsZX0gW29wdGlvbnMudG9nZ2xlID0gbnVsbF0gICAgICAgICAtIFRoZSBjb250cm9sbGVyIGZvciB0aGUgY2hpbGQgbWVudS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdICAgICAtIEEgZmxhZyB0byBpbml0aWFsaXplIHRoZSBtZW51IGl0ZW0gaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51SXRlbUVsZW1lbnQ6IGUsXG4gICAgbWVudUxpbmtFbGVtZW50OiB0LFxuICAgIHBhcmVudE1lbnU6IHMsXG4gICAgaXNTdWJtZW51SXRlbTogbiA9ICExLFxuICAgIGNoaWxkTWVudTogaSA9IG51bGwsXG4gICAgdG9nZ2xlOiBsID0gbnVsbCxcbiAgICBpbml0aWFsaXplOiBoID0gITBcbiAgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG1lbnVJdGVtRWxlbWVudDogZSxcbiAgICAgIG1lbnVMaW5rRWxlbWVudDogdCxcbiAgICAgIHBhcmVudE1lbnU6IHMsXG4gICAgICBpc1N1Ym1lbnVJdGVtOiBuLFxuICAgICAgY2hpbGRNZW51OiBpLFxuICAgICAgdG9nZ2xlOiBsXG4gICAgfSksIGggJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIG1lbnUgaXRlbS5cbiAgICpcbiAgICogSW5pdGlhbGl6ZSB3aWxsIGNhbGwgdGhlIEJhc2VNZW51SXRlbSdzIGluaXRpYWxpemUgbWV0aG9kXG4gICAqIGFzIHdlbGwgYXMgc2V0IHRoZSBtZW51IGl0ZW0ncyBgcm9sZWAgdG8gXCJub25lXCIsXG4gICAqIHRoZSBtZW51IGxpbmsncyBgcm9sZWAgdG8gXCJtZW51aXRlbVwiLCBhbmRcbiAgICogdGhlIG1lbnUgbGluaydzIGB0YWJJbmRleGAgdG8gLTEgaW4gdGhlIERPTS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgc3VwZXIuaW5pdGlhbGl6ZSgpLCB0aGlzLmRvbS5pdGVtLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJub25lXCIpLCB0aGlzLmRvbS5saW5rLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJtZW51aXRlbVwiKSwgdGhpcy5kb20ubGluay50YWJJbmRleCA9IC0xO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBtZW51IGl0ZW0ncyBsaW5rIGlmIHRoZSBwYXJlbnQgbWVudSdzXG4gICAqIHNob3VsZEZvY3VzIHZhbHVlIGlzIGB0cnVlYC5cbiAgICpcbiAgICogVGhpcyB3aWxsIGNhbGwgdGhlIEJhc2VNZW51SXRlbSdzIGZvY3VzIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB0aGUgbWVudSBsaW5rJ3MgYHRhYkluZGV4YCB0byAwIGlmIHRoZSBwYXJlbnQgbWVudVxuICAgKiBpcyB0aGUgcm9vdCBtZW51LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1cygpIHtcbiAgICBzdXBlci5mb2N1cygpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuaXNUb3BMZXZlbCAmJiAodGhpcy5kb20ubGluay50YWJJbmRleCA9IDApO1xuICB9XG4gIC8qKlxuICAgKiBCbHVycyB0aGUgbWVudSBpdGVtJ3MgbGluayBpZiB0aGUgcGFyZW50IG1lbnUnc1xuICAgKiBzaG91bGRGb2N1cyB2YWx1ZSBpcyBgdHJ1ZWAuXG4gICAqXG4gICAqIFRoaXMgd2lsbCBjYWxsIHRoZSBCYXNlTWVudUl0ZW0ncyBibHVyIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB0aGUgbWVudSBsaW5rJ3MgYHRhYkluZGV4YCB0byAtMSBpZiB0aGUgcGFyZW50IG1lbnVcbiAgICogaXMgdGhlIHJvb3QgbWVudS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgYmx1cigpIHtcbiAgICBzdXBlci5ibHVyKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5pc1RvcExldmVsICYmICh0aGlzLmRvbS5saW5rLnRhYkluZGV4ID0gLTEpO1xuICB9XG59XG5jbGFzcyBHIGV4dGVuZHMgTCB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBNZW51YmFyVG9nZ2xlYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBvcHRpb25zLm1lbnVUb2dnbGVFbGVtZW50ICAgLSBUaGUgdG9nZ2xlIGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gb3B0aW9ucy5wYXJlbnRFbGVtZW50ICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKiBAcGFyYW0ge01lbnViYXJ9ICAgICBvcHRpb25zLmNvbnRyb2xsZWRNZW51ICAgICAgLSBUaGUgbWVudSBjb250cm9sbGVkIGJ5IHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0gez9NZW51YmFyfSAgICBbb3B0aW9ucy5wYXJlbnRNZW51ID0gbnVsbF0gLSBUaGUgbWVudSBjb250YWluaW5nIHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSB0b2dnbGUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51VG9nZ2xlRWxlbWVudDogZSxcbiAgICBwYXJlbnRFbGVtZW50OiB0LFxuICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgIHBhcmVudE1lbnU6IG4gPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGkgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IGUsXG4gICAgICBwYXJlbnRFbGVtZW50OiB0LFxuICAgICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgICBwYXJlbnRNZW51OiBuXG4gICAgfSksIGkgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIEFSSUEgYXR0cmlidXRlcyBvbiB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIENhbGxzIHRoZSBCYXNlTWVudVRvZ2dsZSdzIF9zZXRBcmlhQXR0cmlidXRlcyBtZXRob2QuXG4gICAqXG4gICAqIFRoZW4gc2V0cyB0aGUgdG9nZ2xlJ3MgYGFyaWEtaGFzcG9wdXBgIGF0dHJpYnV0ZSB0byBcInRydWVcIi5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldEFyaWFBdHRyaWJ1dGVzKCkge1xuICAgIHN1cGVyLl9zZXRBcmlhQXR0cmlidXRlcygpLCB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFwiYXJpYS1oYXNwb3B1cFwiLCBcInRydWVcIik7XG4gIH1cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIENhbGxzIHRoZSAgY2xvc2VTaWJsaW5ncyBtZXRob2RcbiAgICogYW5kIF90aGVuXyBCYXNlTWVudVRvZ2dsZSdzIG9wZW4gbWV0aG9kLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBvcGVuKCkge1xuICAgIHRoaXMuY2xvc2VTaWJsaW5ncygpLCBzdXBlci5vcGVuKCk7XG4gIH1cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBjb250cm9sbGVkIG1lbnUgd2l0aG91dCB0aGUgY3VycmVudCBmb2N1cyBlbnRlcmluZyBpdC5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZVNpYmxpbmdzIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3MgcHJldmlldyBtZXRob2QuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIHByZXZpZXcoKSB7XG4gICAgdGhpcy5jbG9zZVNpYmxpbmdzKCksIHN1cGVyLnByZXZpZXcoKTtcbiAgfVxuICAvKipcbiAgICogQ2xvc2VzIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIENhbGxzIHRoZSAgY2xvc2VDaGlsZHJlbiBtZXRob2RcbiAgICogYW5kIF90aGVuXyBCYXNlTWVudVRvZ2dsZSdzIGNsb3NlIG1ldGhvZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5pc09wZW4gJiYgKHRoaXMuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzQ3VycmVudENoaWxkKCkpLCBzdXBlci5jbG9zZSgpO1xuICB9XG59XG5jbGFzcyBIIGV4dGVuZHMgdyB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBNZW51YmFyYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgIG9wdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51LlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgICAgb3B0aW9ucy5tZW51RWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG1lbnUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMubWVudUl0ZW1TZWxlY3RvciA9IGxpXSAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBpdGVtcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLm1lbnVMaW5rU2VsZWN0b3IgPSBhXSAgICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgbGlua3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51SXRlbVNlbGVjdG9yID0gbGk6aGFzKHVsKV0gLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGl0ZW1zIGNvbnRhaW5pbmcgc3VibWVudXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51VG9nZ2xlU2VsZWN0b3IgPSBhXSAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51IHRvZ2dsZSBidXR0b25zL2xpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudVNlbGVjdG9yID0gdWxdICAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3Igc3VibWVudXMuXG4gICAqIEBwYXJhbSB7P0hUTUxFbGVtZW50fSAgICAgICBbb3B0aW9ucy5jb250cm9sbGVyRWxlbWVudCA9IG51bGxdICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250cm9sbGluZyB0aGUgbWVudSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0gez9IVE1MRWxlbWVudH0gICAgICAgW29wdGlvbnMuY29udGFpbmVyRWxlbWVudCA9IG51bGxdICAgICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgbWVudSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMub3BlbkNsYXNzID0gc2hvd10gICAgICAgICAgICAgICAgIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIFwib3BlblwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMuY2xvc2VDbGFzcyA9IGhpZGVdICAgICAgICAgICAgICAgIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIFwiY2xvc2VkXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy50cmFuc2l0aW9uQ2xhc3MgPSB0cmFuc2l0aW9uaW5nXSAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgdHJhbnNpdGlvbmluZyBiZXR3ZWVuIFwib3BlblwiIGFuZCBcImNsb3NlZFwiIHN0YXRlcy5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbiA9IDI1MF0gICAgICAgICAtIFRoZSBkdXJhdGlvbiBvZiB0aGUgdHJhbnNpdGlvbiBiZXR3ZWVuIFwib3BlblwiIGFuZCBcImNsb3NlZFwiIHN0YXRlcyAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgIFtvcHRpb25zLmlzVG9wTGV2ZWwgPSB0cnVlXSAgICAgICAgICAgICAgICAtIEEgZmxhZyB0byBtYXJrIHRoZSByb290IG1lbnUuXG4gICAqIEBwYXJhbSB7P01lbnViYXJ9ICAgICAgICAgICBbb3B0aW9ucy5wYXJlbnRNZW51ID0gbnVsbF0gICAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUgdG8gdGhpcyBtZW51LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuaG92ZXJUeXBlID0gb2ZmXSAgICAgICAgICAgICAgICAgIC0gVGhlIHR5cGUgb2YgaG92ZXJhYmlsaXR5IGEgbWVudSBoYXMuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy5ob3ZlckRlbGF5ID0gMjUwXSAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIG9wZW5pbmcgYW5kIGNsb3NpbmcgbWVudXMgaWYgdGhlIG1lbnUgaXMgaG92ZXJhYmxlIChpbiBtaWxsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgW29wdGlvbnMuZW50ZXJEZWxheSA9IC0xXSAgICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBvcGVuaW5nIGEgbWVudSBpZiB0aGUgbWVudSBpcyBmb2N1c2FibGUgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy5sZWF2ZURlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIGNsb3NpbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHs/c3RyaW5nfSAgICAgICAgICAgIFtvcHRpb25zLnByZWZpeCA9IGFtLV0gICAgICAgICAgICAgICAgICAgICAtIFRoZSBwcmVmaXggdG8gdXNlIGZvciBDU1MgY3VzdG9tIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVFbGVtZW50OiB0LFxuICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMgPSBcImxpXCIsXG4gICAgbWVudUxpbmtTZWxlY3RvcjogbiA9IFwiYVwiLFxuICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGkgPSBcImxpOmhhcyh1bClcIixcbiAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IGwgPSBcImFcIixcbiAgICBzdWJtZW51U2VsZWN0b3I6IGggPSBcInVsXCIsXG4gICAgY29udHJvbGxlckVsZW1lbnQ6IG0gPSBudWxsLFxuICAgIGNvbnRhaW5lckVsZW1lbnQ6IGEgPSBudWxsLFxuICAgIG9wZW5DbGFzczogZiA9IFwic2hvd1wiLFxuICAgIGNsb3NlQ2xhc3M6IHAgPSBcImhpZGVcIixcbiAgICB0cmFuc2l0aW9uQ2xhc3M6IGcgPSBcInRyYW5zaXRpb25pbmdcIixcbiAgICB0cmFuc2l0aW9uRHVyYXRpb246IGQgPSAyNTAsXG4gICAgaXNUb3BMZXZlbDogTSA9ICEwLFxuICAgIHBhcmVudE1lbnU6IHkgPSBudWxsLFxuICAgIGhvdmVyVHlwZTogYiA9IFwib2ZmXCIsXG4gICAgaG92ZXJEZWxheTogQyA9IDI1MCxcbiAgICBlbnRlckRlbGF5OiBUID0gLTEsXG4gICAgbGVhdmVEZWxheTogRSA9IC0xLFxuICAgIHByZWZpeDogSSA9IFwiYW0tXCIsXG4gICAgaW5pdGlhbGl6ZTogdiA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51RWxlbWVudDogdCxcbiAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMsXG4gICAgICBtZW51TGlua1NlbGVjdG9yOiBuLFxuICAgICAgc3VibWVudUl0ZW1TZWxlY3RvcjogaSxcbiAgICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogbCxcbiAgICAgIHN1Ym1lbnVTZWxlY3RvcjogaCxcbiAgICAgIGNvbnRyb2xsZXJFbGVtZW50OiBtLFxuICAgICAgY29udGFpbmVyRWxlbWVudDogYSxcbiAgICAgIG9wZW5DbGFzczogZixcbiAgICAgIGNsb3NlQ2xhc3M6IHAsXG4gICAgICB0cmFuc2l0aW9uQ2xhc3M6IGcsXG4gICAgICB0cmFuc2l0aW9uRHVyYXRpb246IGQsXG4gICAgICBpc1RvcExldmVsOiBNLFxuICAgICAgcGFyZW50TWVudTogeSxcbiAgICAgIGhvdmVyVHlwZTogYixcbiAgICAgIGhvdmVyRGVsYXk6IEMsXG4gICAgICBlbnRlckRlbGF5OiBULFxuICAgICAgbGVhdmVEZWxheTogRSxcbiAgICAgIHByZWZpeDogSVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBNZW51YmFyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudVR5cGVcIiwgSCk7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgbWVudSBpdGVtcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgTWVudWJhckl0ZW19XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51SXRlbVR5cGVcIiwgQik7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgc3VibWVudSB0b2dnbGVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBNZW51YmFyVG9nZ2xlfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudVRvZ2dsZVR5cGVcIiwgRyk7XG4gICAgdiAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIG1lbnUuXG4gICAqXG4gICAqIEluaXRpYWxpemUgd2lsbCBjYWxsIHRoZSBCYXNlTWVudSdzIGluaXRpYWxpemUgbWV0aG9kXG4gICAqIGFzIHdlbGwgYXMgc2V0IHVwIGZvY3VzLFxuICAgKiBjbGljayxcbiAgICogaG92ZXIsXG4gICAqIGtleWRvd24sIGFuZFxuICAgKiBrZXl1cCBldmVudHMgZm9yIHRoZSBtZW51LlxuICAgKlxuICAgKiBUaGlzIHdpbGwgYWxzbyBzZXQgdGhlIG1lbnUncyBgcm9sZWAgdG8gXCJtZW51YmFyXCIgaW4gdGhlIERPTS5cbiAgICpcbiAgICogSWYgdGhlIG1lbnUgaXMgYSByb290IG1lbnUgdGhlIGZpcnN0IG1lbnUgaXRlbSdzIGB0YWJJbmRleGAgd2lsbCBiZSBzZXQgdG9cbiAgICogMCBpbiB0aGUgRE9NLlxuICAgKlxuICAgKiBJZiB0aGUgQmFzZU1lbnUncyBpbml0aWFsaXplIG1ldGhvZCB0aHJvd3MgYW4gZXJyb3IsXG4gICAqIHRoaXMgd2lsbCBjYXRjaCBpdCBhbmQgbG9nIGl0IHRvIHRoZSBjb25zb2xlLlxuICAgKi9cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICB0cnkge1xuICAgICAgc3VwZXIuaW5pdGlhbGl6ZSgpLCB0aGlzLmlzVG9wTGV2ZWwgPyB0aGlzLmRvbS5tZW51LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJtZW51YmFyXCIpIDogdGhpcy5kb20ubWVudS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwibWVudVwiKSwgdGhpcy5faGFuZGxlRm9jdXMoKSwgdGhpcy5faGFuZGxlQ2xpY2soKSwgdGhpcy5faGFuZGxlSG92ZXIoKSwgdGhpcy5faGFuZGxlS2V5ZG93bigpLCB0aGlzLl9oYW5kbGVLZXl1cCgpLCB0aGlzLmlzVG9wTGV2ZWwgJiYgKHRoaXMuZWxlbWVudHMubWVudUl0ZW1zWzBdLmRvbS5saW5rLnRhYkluZGV4ID0gMCwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5kb20udG9nZ2xlLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtaGFzcG9wdXBcIikpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IodCk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGNsaWNrIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgdXNlLlxuICAgKlxuICAgKiAtIEFkZHMgYWxsIGV2ZW50IGxpc3RlbmVycyBsaXN0ZWQgaW5cbiAgICogICBCYXNlTWVudSdzIF9oYW5kbGVDbGljayBtZXRob2QuXG4gICAqIC0gQWRkcyBhIGBwb2ludGVydXBgIGxpc3RlbmVyIHRvIHRoZSBgZG9jdW1lbnRgIHNvIGlmIHRoZSB1c2VyXG4gICAqICAgY2xpY2tzIG91dHNpZGUgb2YgdGhlIG1lbnUgaXQgd2lsbCBjbG9zZSBpZiBpdCBpcyBvcGVuLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlQ2xpY2soKSB7XG4gICAgc3VwZXIuX2hhbmRsZUNsaWNrKCksIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgKHQpID0+IHtcbiAgICAgIHRoaXMuZm9jdXNTdGF0ZSAhPT0gXCJub25lXCIgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCAhdGhpcy5kb20ubWVudS5jb250YWlucyh0LnRhcmdldCkgJiYgIXRoaXMuZG9tLm1lbnUgIT09IHQudGFyZ2V0ICYmICh0aGlzLmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5ibHVyKCksIHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuY2xvc2UoKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5oYXNPcGVuZWQgPSAhMSkpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGtleWRvd24gZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciBtZW51IHVzZS5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgZXhpc3RzIHRvIGFzc2lzdCB0aGUgX2hhbmRsZUtleXVwIG1ldGhvZC5cbiAgICogLSBBZGRzIGFsbCBga2V5ZG93bmAgbGlzdGVuZXJzIGZyb20gQmFzZU1lbnUncyBfaGFuZGxlS2V5ZG93biBtZXRob2RcbiAgICogLSBBZGRzIGEgYGtleWRvd25gIGxpc3RlbmVyIHRvIHRoZSBtZW51L2FsbCBzdWJtZW51cy5cbiAgICogICAtIEJsb2NrcyBwcm9wYWdhdGlvbiBvbiB0aGUgZm9sbG93aW5nIGtleXM6IFwiQXJyb3dVcFwiLCBcIkFycm93UmlnaHRcIixcbiAgICogICAgIFwiQXJyb3dEb3duXCIsIFwiQXJyb3dMZWZ0XCIsIFwiSG9tZVwiLCBcIkVuZFwiLCBcIlNwYWNlXCIsIFwiRW50ZXJcIiwgXCJFc2NhcGVcIixcbiAgICogICAgIGFuZCBcIkFcIiB0aHJvdWdoIFwiWlwiLlxuICAgKiAgIC0gQ29tcGxldGVseSBjbG9zZXMgdGhlIG1lbnUgYW5kIG1vdmVzIGZvY3VzIG91dCBpZiB0aGUgXCJUYWJcIiBrZXkgaXMgcHJlc3NlZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleWRvd24oKSB7XG4gICAgc3VwZXIuX2hhbmRsZUtleWRvd24oKSwgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAodCkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBzID0gXyh0KTtcbiAgICAgIGlmIChzID09PSBcIlRhYlwiICYmICh0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmZvY3VzU3RhdGUgIT09IFwibm9uZVwiID8gKHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1cigpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmNsb3NlQ2hpbGRyZW4oKSkgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmZvY3VzKCkpLCBzID09PSBcIkNoYXJhY3RlclwiKVxuICAgICAgICBvKHQpO1xuICAgICAgZWxzZSBpZiAodGhpcy5pc1RvcExldmVsKSB7XG4gICAgICAgIGlmICh0aGlzLmZvY3VzU3RhdGUgPT09IFwic2VsZlwiKSB7XG4gICAgICAgICAgY29uc3QgbiA9IFtcIkFycm93UmlnaHRcIiwgXCJBcnJvd0xlZnRcIiwgXCJIb21lXCIsIFwiRW5kXCJdLCBpID0gW1wiU3BhY2VcIiwgXCJFbnRlclwiLCBcIkFycm93RG93blwiLCBcIkFycm93VXBcIl0sIGwgPSBbXCJFc2NhcGVcIl07XG4gICAgICAgICAgKG4uaW5jbHVkZXMocykgfHwgdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiBpLmluY2x1ZGVzKHMpIHx8IHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiBsLmluY2x1ZGVzKHMpKSAmJiBvKHQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBuID0gW1xuICAgICAgICAgIFwiRXNjYXBlXCIsXG4gICAgICAgICAgXCJBcnJvd1JpZ2h0XCIsXG4gICAgICAgICAgXCJBcnJvd0xlZnRcIixcbiAgICAgICAgICBcIkFycm93RG93blwiLFxuICAgICAgICAgIFwiQXJyb3dVcFwiLFxuICAgICAgICAgIFwiSG9tZVwiLFxuICAgICAgICAgIFwiRW5kXCJcbiAgICAgICAgXSwgaSA9IFtcIlNwYWNlXCIsIFwiRW50ZXJcIl07XG4gICAgICAgIChuLmluY2x1ZGVzKHMpIHx8IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgaS5pbmNsdWRlcyhzKSkgJiYgbyh0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXl1cCBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBBZGRzIGFsbCBga2V5dXBgIGxpc3RlbmVycyBmcm9tIEJhc2VNZW51J3MgX2hhbmRsZUtleXVwIG1ldGhvZC5cbiAgICpcbiAgICogQWRkcyB0aGUgZm9sbG93aW5nIGtleWJpbmRpbmdzIChleHBsYW5hdGlvbnMgYXJlIHRha2VuIGZyb20gdGhlXG4gICAqIE5hdmlnYXRpb24gTWVudWJhciBFeGFtcGxlKTpcbiAgICpcbiAgICogPHN0cm9uZz5NZW51YmFyPC9zdHJvbmc+XG4gICAqXG4gICAqIHwgS2V5IHwgRnVuY3Rpb24gfFxuICAgKiB8IC0tLSB8IC0tLSB8XG4gICAqIHwgX1NwYWNlXyBvciBfRW50ZXJfIHwgT3BlbnMgc3VibWVudSBhbmQgbW92ZXMgZm9jdXMgdG8gZmlyc3QgaXRlbSBpbiB0aGUgc3VibWVudS4gfFxuICAgKiB8IF9SaWdodCBBcnJvd18gfCA8dWw+PGxpPk1vdmVzIGZvY3VzIHRvIHRoZSBuZXh0IGl0ZW0gaW4gdGhlIG1lbnViYXIuPC9saT48bGk+SWYgZm9jdXMgaXMgb24gdGhlIGxhc3QgaXRlbSwgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGl0ZW0uPC9saT48L3VsPiB8XG4gICAqIHwgX0xlZnQgQXJyb3dfIHwgPHVsPjxsaT5Nb3ZlcyBmb2N1cyB0byB0aGUgcHJldmlvdXMgaXRlbSBpbiB0aGUgbWVudWJhci48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiB0aGUgZmlyc3QgaXRlbSwgbW92ZXMgZm9jdXMgdG8gdGhlIGxhc3QgaXRlbS48L2xpPjwvdWw+IHxcbiAgICogfCBfRG93biBBcnJvd18gfCBPcGVucyBzdWJtZW51IGFuZCBtb3ZlcyBmb2N1cyB0byBmaXJzdCBpdGVtIGluIHRoZSBzdWJtZW51LiB8XG4gICAqIHwgX1VwIEFycm93XyB8IE9wZW5zIHN1Ym1lbnUgYW5kIG1vdmVzIGZvY3VzIHRvIGxhc3QgaXRlbSBpbiB0aGUgc3VibWVudS4gfFxuICAgKiB8IF9Ib21lXyB8IE1vdmVzIGZvY3VzIHRvIGZpcnN0IGl0ZW0gaW4gdGhlIG1lbnViYXIuIHxcbiAgICogfCBfRW5kXyB8IE1vdmVzIGZvY3VzIHRvIGxhc3QgaXRlbSBpbiB0aGUgbWVudWJhci4gfFxuICAgKiB8IF9DaGFyYWN0ZXJfIHwgPHVsPjxsaT5Nb3ZlcyBmb2N1cyB0byBuZXh0IGl0ZW0gaW4gdGhlIG1lbnViYXIgaGF2aW5nIGEgbmFtZSB0aGF0IHN0YXJ0cyB3aXRoIHRoZSB0eXBlZCBjaGFyYWN0ZXIuPC9saT48bGk+SWYgbm9uZSBvZiB0aGUgaXRlbXMgaGF2ZSBhIG5hbWUgc3RhcnRpbmcgd2l0aCB0aGUgdHlwZWQgY2hhcmFjdGVyLCBmb2N1cyBkb2VzIG5vdCBtb3ZlLjwvbGk+PC91bD4gfFxuICAgKlxuICAgKiA8c3Ryb25nPlN1Ym1lbnU8L3N0cm9uZz5cbiAgICpcbiAgICogfCBLZXkgfCBGdW5jdGlvbiB8XG4gICAqIHwgLS0tIHwgLS0tIHxcbiAgICogfCBfU3BhY2VfIG9yIF9FbnRlcl8gfCA8dWw+PGxpPkFjdGl2YXRlcyBtZW51IGl0ZW0sIGNhdXNpbmcgdGhlIGxpbmsgdG8gYmUgYWN0aXZhdGVkLjwvbGk+PGxpPk5PVEU6IHRoZSBsaW5rcyBnbyB0byBkdW1teSBwYWdlczsgdXNlIHRoZSBicm93c2VyIGdvLWJhY2sgZnVuY3Rpb24gdG8gcmV0dXJuIHRvIHRoaXMgbWVudWJhciBleGFtcGxlIHBhZ2UuPC9saT48L3VsPiB8XG4gICAqIHwgX0VzY2FwZV8gfCA8dWw+PGxpPkNsb3NlcyBzdWJtZW51LjwvbGk+PGxpPk1vdmVzIGZvY3VzIHRvIHBhcmVudCBtZW51YmFyIGl0ZW0uPC9saT48L3VsPiB8XG4gICAqIHwgX1JpZ2h0IEFycm93XyB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYW4gaXRlbSB3aXRoIGEgc3VibWVudSwgb3BlbnMgdGhlIHN1Ym1lbnUgYW5kIHBsYWNlcyBmb2N1cyBvbiB0aGUgZmlyc3QgaXRlbS48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhbiBpdGVtIHRoYXQgZG9lcyBub3QgaGF2ZSBhIHN1Ym1lbnU6PHVsPjxsaT5DbG9zZXMgc3VibWVudS48L2xpPjxsaT5Nb3ZlcyBmb2N1cyB0byBuZXh0IGl0ZW0gaW4gdGhlIG1lbnViYXIuPC9saT48bGk+T3BlbnMgc3VibWVudSBvZiBuZXdseSBmb2N1c2VkIG1lbnViYXIgaXRlbSwga2VlcGluZyBmb2N1cyBvbiB0aGF0IHBhcmVudCBtZW51YmFyIGl0ZW0uPC9saT48L3VsPjwvbGk+PC91bD4gfFxuICAgKiB8IF9MZWZ0IEFycm93XyB8IDx1bD48bGk+Q2xvc2VzIHN1Ym1lbnUgYW5kIG1vdmVzIGZvY3VzIHRvIHBhcmVudCBtZW51IGl0ZW0uPC9saT48bGk+SWYgcGFyZW50IG1lbnUgaXRlbSBpcyBpbiB0aGUgbWVudWJhciwgYWxzbzo8dWw+PGxpPm1vdmVzIGZvY3VzIHRvIHByZXZpb3VzIGl0ZW0gaW4gdGhlIG1lbnViYXIuPC9saT48bGk+T3BlbnMgc3VibWVudSBvZiBuZXdseSBmb2N1c2VkIG1lbnViYXIgaXRlbSwga2VlcGluZyBmb2N1cyBvbiB0aGF0IHBhcmVudCBtZW51YmFyIGl0ZW0uPC9saT48L3VsPjwvbGk+PC91bD4gfFxuICAgKiB8IF9Eb3duIEFycm93XyB8IDx1bD48bGk+TW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgaXRlbSBpbiB0aGUgc3VibWVudS48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiB0aGUgbGFzdCBpdGVtLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgaXRlbS48L2xpPjwvdWw+IHxcbiAgICogfCBfVXAgQXJyb3dfIHwgPHVsPjxsaT5Nb3ZlcyBmb2N1cyB0byBwcmV2aW91cyBpdGVtIGluIHRoZSBzdWJtZW51LjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIHRoZSBmaXJzdCBpdGVtLCBtb3ZlcyBmb2N1cyB0byB0aGUgbGFzdCBpdGVtLjwvbGk+PC91bD4gfFxuICAgKiB8IEhvbWUgfCBNb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgaXRlbSBpbiB0aGUgc3VibWVudS4gfFxuICAgKiB8IEVuZCB8IE1vdmVzIGZvY3VzIHRvIHRoZSBsYXN0IGl0ZW0gaW4gdGhlIHN1Ym1lbnUuIHxcbiAgICogfCBfQ2hhcmFjdGVyXyB8IDx1bD48bGk+TW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgaXRlbSBoYXZpbmcgYSBuYW1lIHRoYXQgc3RhcnRzIHdpdGggdGhlIHR5cGVkIGNoYXJhY3Rlci48L2xpPjxsaT5JZiBub25lIG9mIHRoZSBpdGVtcyBoYXZlIGEgbmFtZSBzdGFydGluZyB3aXRoIHRoZSB0eXBlZCBjaGFyYWN0ZXIsIGZvY3VzIGRvZXMgbm90IG1vdmUuPC9saT48L3VsPiB8XG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXl1cCgpIHtcbiAgICBzdXBlci5faGFuZGxlS2V5dXAoKSwgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKHQpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IF8odCksIHsgYWx0S2V5OiBuLCBjcnRsS2V5OiBpLCBtZXRhS2V5OiBsIH0gPSB0O1xuICAgICAgaWYgKHMgPT09IFwiQ2hhcmFjdGVyXCIgJiYgIShuIHx8IGkgfHwgbCkpXG4gICAgICAgIG8odCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY3VycmVudEV2ZW50ID0gXCJjaGFyYWN0ZXJcIiwgdGhpcy5mb2N1c05leHRDaGlsZFdpdGhDaGFyYWN0ZXIodC5rZXkpO1xuICAgICAgZWxzZSBpZiAodGhpcy5pc1RvcExldmVsKSB7XG4gICAgICAgIGlmICh0aGlzLmZvY3VzU3RhdGUgPT09IFwic2VsZlwiKVxuICAgICAgICAgIGlmIChzID09PSBcIlNwYWNlXCIgfHwgcyA9PT0gXCJFbnRlclwiKVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUub3BlbigpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNGaXJzdENoaWxkKCk7XG4gICAgICAgICAgICB9KSkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5kb20ubGluay5jbGljaygpO1xuICAgICAgICAgIGVsc2UgaWYgKHMgPT09IFwiQXJyb3dSaWdodFwiKSB7XG4gICAgICAgICAgICBvKHQpO1xuICAgICAgICAgICAgY29uc3QgbSA9IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbjtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNOZXh0Q2hpbGQoKSwgbSAmJiAodGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/ICh0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUucHJldmlldygpKSA6IHRoaXMuY2xvc2VDaGlsZHJlbigpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHMgPT09IFwiQXJyb3dMZWZ0XCIpIHtcbiAgICAgICAgICAgIG8odCk7XG4gICAgICAgICAgICBjb25zdCBtID0gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuO1xuICAgICAgICAgICAgdGhpcy5mb2N1c1ByZXZpb3VzQ2hpbGQoKSwgbSAmJiAodGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/ICh0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUucHJldmlldygpKSA6IHRoaXMuY2xvc2VDaGlsZHJlbigpKTtcbiAgICAgICAgICB9IGVsc2UgcyA9PT0gXCJBcnJvd0Rvd25cIiA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgKG8odCksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5vcGVuKCksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNGaXJzdENoaWxkKCk7XG4gICAgICAgICAgfSkpIDogcyA9PT0gXCJBcnJvd1VwXCIgPyB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUub3BlbigpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzTGFzdENoaWxkKCk7XG4gICAgICAgICAgfSkpIDogcyA9PT0gXCJIb21lXCIgPyAobyh0KSwgdGhpcy5mb2N1c0ZpcnN0Q2hpbGQoKSkgOiBzID09PSBcIkVuZFwiID8gKG8odCksIHRoaXMuZm9jdXNMYXN0Q2hpbGQoKSkgOiBzID09PSBcIkVzY2FwZVwiICYmICh0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLnNvbWUoXG4gICAgICAgICAgICAoYSkgPT4gYS5pc09wZW5cbiAgICAgICAgICApID8gKG8odCksIHRoaXMuY2xvc2VDaGlsZHJlbigpKSA6IHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmlzT3BlbiAmJiAobyh0KSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmNsb3NlKCksIHRoaXMuZm9jdXNDb250cm9sbGVyKCkpKTtcbiAgICAgIH0gZWxzZVxuICAgICAgICBzID09PSBcIlNwYWNlXCIgfHwgcyA9PT0gXCJFbnRlclwiID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUub3BlbigpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0ZpcnN0Q2hpbGQoKTtcbiAgICAgICAgfSkpIDogdGhpcy5jdXJyZW50TWVudUl0ZW0uZG9tLmxpbmsuY2xpY2soKSA6IHMgPT09IFwiRXNjYXBlXCIgPyAobyh0KSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5jbG9zZUNoaWxkcmVuKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuZm9jdXNDdXJyZW50Q2hpbGQoKSkgOiBzID09PSBcIkFycm93UmlnaHRcIiA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gPyAobyh0KSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIiwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLm9wZW4oKSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNGaXJzdENoaWxkKCk7XG4gICAgICAgIH0pKSA6IChvKHQpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1c05leHRDaGlsZCgpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpIDogcyA9PT0gXCJBcnJvd0xlZnRcIiA/IHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiAobyh0KSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzQ3VycmVudENoaWxkKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudSA9PT0gdGhpcy5lbGVtZW50cy5yb290TWVudSAmJiAodGhpcy5lbGVtZW50cy5yb290TWVudS5jbG9zZUNoaWxkcmVuKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuZm9jdXNQcmV2aW91c0NoaWxkKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgKHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpKSkgOiBzID09PSBcIkFycm93RG93blwiID8gKG8odCksIHRoaXMuZm9jdXNOZXh0Q2hpbGQoKSkgOiBzID09PSBcIkFycm93VXBcIiA/IChvKHQpLCB0aGlzLmZvY3VzUHJldmlvdXNDaGlsZCgpKSA6IHMgPT09IFwiSG9tZVwiID8gKG8odCksIHRoaXMuZm9jdXNGaXJzdENoaWxkKCkpIDogcyA9PT0gXCJFbmRcIiAmJiAobyh0KSwgdGhpcy5mb2N1c0xhc3RDaGlsZCgpKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBuZXh0IGNoaWxkLlxuICAgKlxuICAgKiBJZiB0aGUgY3VycmVudGx5IGZvY3Vzc2VkIGNoaWxkIGluIHRoZSBtZW51IGlzIHRoZSBsYXN0IGNoaWxkIHRoZW4gdGhpcyB3aWxsXG4gICAqIGZvY3VzIHRoZSBmaXJzdCBjaGlsZCBpbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNOZXh0Q2hpbGQoKSB7XG4gICAgdGhpcy5jdXJyZW50Q2hpbGQgPT09IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCAtIDEgPyB0aGlzLmZvY3VzRmlyc3RDaGlsZCgpIDogdGhpcy5mb2N1c0NoaWxkKHRoaXMuY3VycmVudENoaWxkICsgMSk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51J3MgcHJldmlvdXMgY2hpbGQuXG4gICAqXG4gICAqIElmIHRoZSBjdXJyZW50bHkgZm9jdXNzZWQgY2hpbGQgaW4gdGhlIG1lbnUgaXMgdGhlIGZpcnN0IGNoaWxkIHRoZW4gdGhpcyB3aWxsXG4gICAqIGZvY3VzIHRoZSBsYXN0IGNoaWxkIGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c1ByZXZpb3VzQ2hpbGQoKSB7XG4gICAgdGhpcy5jdXJyZW50Q2hpbGQgPT09IDAgPyB0aGlzLmZvY3VzTGFzdENoaWxkKCkgOiB0aGlzLmZvY3VzQ2hpbGQodGhpcy5jdXJyZW50Q2hpbGQgLSAxKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBuZXh0IGNoaWxkIHN0YXJ0aW5nIHdpdGggYSBzcGVjaWZpYyBsZXR0ZXIuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNoYXIgLSBUaGUgY2hhcmFjdGVyIHRvIGxvb2sgZm9yLlxuICAgKi9cbiAgZm9jdXNOZXh0Q2hpbGRXaXRoQ2hhcmFjdGVyKHQpIHtcbiAgICBjb25zdCBzID0gdC50b0xvd2VyQ2FzZSgpO1xuICAgIGxldCBuID0gdGhpcy5jdXJyZW50Q2hpbGQgKyAxLCBpID0gITE7XG4gICAgZm9yICg7ICFpICYmIG4gPCB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5sZW5ndGg7ICkge1xuICAgICAgbGV0IGwgPSBcIlwiO1xuICAgICAgdGhpcy5lbGVtZW50cy5tZW51SXRlbXNbbl0uZG9tLml0ZW0uaW5uZXJUZXh0ID8gbCA9IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zW25dLmRvbS5pdGVtLmlubmVyVGV4dCA6IGwgPSB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtc1tuXS5kb20uaXRlbS50ZXh0Q29udGVudCwgbCA9IGwucmVwbGFjZSgvW1xcc10vZywgXCJcIikudG9Mb3dlckNhc2UoKS5jaGFyQXQoMCksIGwgPT09IHMgJiYgKGkgPSAhMCwgdGhpcy5mb2N1c0NoaWxkKG4pKSwgbisrO1xuICAgIH1cbiAgfVxufVxuY2xhc3MgSiBleHRlbmRzIE8ge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgVG9wTGlua0Rpc2Nsb3N1cmVNZW51SXRlbWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51IGl0ZW0uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICAgICAgICAgICAgb3B0aW9ucy5tZW51SXRlbUVsZW1lbnQgICAgICAgICAtIFRoZSBtZW51IGl0ZW0gaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgICAgICAgICAgICBvcHRpb25zLm1lbnVMaW5rRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSdzIGxpbmsgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtUb3BMaW5rRGlzY2xvc3VyZU1lbnV9ICAgICAgICBvcHRpb25zLnBhcmVudE1lbnUgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgICAgICAgICAgIFtvcHRpb25zLmlzU3VibWVudUl0ZW0gPSBmYWxzZV0gLSBBIGZsYWcgdG8gbWFyayBpZiB0aGUgbWVudSBpdGVtIGlzIGNvbnRyb2xsaW5nIGEgc3VibWVudS5cbiAgICogQHBhcmFtIHs/VG9wTGlua0Rpc2Nsb3N1cmVNZW51fSAgICAgICBbb3B0aW9ucy5jaGlsZE1lbnUgPSBudWxsXSAgICAgIC0gVGhlIGNoaWxkIG1lbnUuXG4gICAqIEBwYXJhbSB7P1RvcExpbmtEaXNjbG9zdXJlTWVudVRvZ2dsZX0gW29wdGlvbnMudG9nZ2xlID0gbnVsbF0gICAgICAgICAtIFRoZSBjb250cm9sbGVyIGZvciB0aGUgY2hpbGQgbWVudS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgaXRlbSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKiBAcGFyYW0gez9Ub3BMaW5rRGlzY2xvc3VyZU1lbnVJdGVtfSAgIFtvcHRpb25zLnN1Ym1lbnVTaWJsaW5nID0gbnVsbF0gLSBUaGUgc2libGluZyBtZW51IGl0ZW0gdGhhdCBjb250cm9scyBhIHN1Ym1lbnUuXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVudUl0ZW1FbGVtZW50OiB0LFxuICAgIG1lbnVMaW5rRWxlbWVudDogcyxcbiAgICBwYXJlbnRNZW51OiBuLFxuICAgIGlzU3VibWVudUl0ZW06IGkgPSAhMSxcbiAgICBjaGlsZE1lbnU6IGwgPSBudWxsLFxuICAgIHRvZ2dsZTogaCA9IG51bGwsXG4gICAgaW5pdGlhbGl6ZTogbSA9ICEwLFxuICAgIHN1Ym1lbnVTaWJsaW5nOiBhID0gbnVsbFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudUl0ZW1FbGVtZW50OiB0LFxuICAgICAgbWVudUxpbmtFbGVtZW50OiBzLFxuICAgICAgcGFyZW50TWVudTogbixcbiAgICAgIGlzU3VibWVudUl0ZW06IGksXG4gICAgICBjaGlsZE1lbnU6IGwsXG4gICAgICB0b2dnbGU6IGhcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgZGVjbGFyZWQgYWNjZXNzaWJsZS1tZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSBpdGVtLlxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxUb3BMaW5rRGlzY2xvc3VyZU1lbnUsIFRvcExpbmtEaXNjbG9zdXJlTWVudVRvZ2dsZT59XG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge1RvcExpbmtEaXNjbG9zdXJlTWVudX0gICAgICAgICAgICAgICAgICAgcGFyZW50TWVudSAtIFRoZSBtZW51IGNvbnRhaW5pbmcgdGhpcyBtZW51IGl0ZW0uXG4gICAgICogQHByb3BlcnR5IHs/VG9wTGlua0Rpc2Nsb3N1cmVNZW51fSAgICAgICAgICAgICAgICAgIGNoaWxkTWVudSAgLSBUaGUgbWVudSBjb250YWluZWQgd2l0aGluIHRoaXMgbWVudSBpdGVtLlxuICAgICAqIEBwcm9wZXJ0eSB7P1RvcExpbmtEaXNjbG9zdXJlTWVudVRvZ2dsZX0gICAgICAgICAgICB0b2dnbGUgICAgIC0gVGhlIG1lbnUgdG9nZ2xlIHdpdGhpbiB0aGlzIG1lbnUgaXRlbSB0aGF0IGNvbnRyb2xzIHRoZSBgY2hpbGRNZW51YC5cbiAgICAgKiBAcHJvcGVydHkgez9Ub3BMaW5rRGlzY2xvc3VyZU1lbnVJdGVtfSAgICAgICAgICAgICAgc2libGluZyAgICAtIFRoZSBzaWJsaW5nIG1lbnUgaXRlbSB0aGF0IGlzIGEgc3VibWVudSBpdGVtLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZWxlbWVudHNcIiwge1xuICAgICAgcGFyZW50TWVudTogbnVsbCxcbiAgICAgIGNoaWxkTWVudTogbnVsbCxcbiAgICAgIHRvZ2dsZTogbnVsbCxcbiAgICAgIHNpYmxpbmc6IG51bGxcbiAgICB9KTtcbiAgICB0aGlzLl9lbGVtZW50cy5wYXJlbnRNZW51ID0gbiwgdGhpcy5fZWxlbWVudHMuY2hpbGRNZW51ID0gbCwgdGhpcy5fZWxlbWVudHMudG9nZ2xlID0gaCwgdGhpcy5fZWxlbWVudHMuc2libGluZyA9IGEsIG0gJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbn1cbmNsYXNzIFggZXh0ZW5kcyBMIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYFRvcExpbmtEaXNjbG9zdXJlTWVudVRvZ2dsZWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgICAgICAgIG9wdGlvbnMubWVudVRvZ2dsZUVsZW1lbnQgICAtIFRoZSB0b2dnbGUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgICAgICAgIG9wdGlvbnMucGFyZW50RWxlbWVudCAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICogQHBhcmFtIHtUb3BMaW5rRGlzY2xvc3VyZU1lbnV9ICBvcHRpb25zLmNvbnRyb2xsZWRNZW51ICAgICAgLSBUaGUgbWVudSBjb250cm9sbGVkIGJ5IHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0gez9Ub3BMaW5rRGlzY2xvc3VyZU1lbnV9IFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAtIFRoZSBtZW51IGNvbnRhaW5pbmcgdGhpcyB0b2dnbGUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgdG9nZ2xlIGltbWVkaWF0ZWx5IHVwb24gY3JlYXRpb24uXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVudVRvZ2dsZUVsZW1lbnQ6IGUsXG4gICAgcGFyZW50RWxlbWVudDogdCxcbiAgICBjb250cm9sbGVkTWVudTogcyxcbiAgICBwYXJlbnRNZW51OiBuID0gbnVsbCxcbiAgICBpbml0aWFsaXplOiBpID0gITBcbiAgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG1lbnVUb2dnbGVFbGVtZW50OiBlLFxuICAgICAgcGFyZW50RWxlbWVudDogdCxcbiAgICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgICAgcGFyZW50TWVudTogblxuICAgIH0pLCBpICYmIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIHRoZSBBUklBIGF0dHJpYnV0ZXMgb24gdGhlIHRvZ2dsZSBhbmQgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBDYWxscyB0aGUgQmFzZU1lbnVUb2dnbGUncyBfc2V0QXJpYUF0dHJpYnV0ZXMgbWV0aG9kLlxuICAgKlxuICAgKiBFbnN1cmVzIHRoZSB0b2dnbGUgZWxlbWVudCBoYXMgYSBgcm9sZWAgb2YgXCJidXR0b25cIiBpZiBpdCBpcyBub3RcbiAgICogYWxyZWFkeSBhIGJ1dHRvbi5cbiAgICpcbiAgICogVGhlbiB1c2luZyB0aGUgdG9nZ2xlIGFuZCBtZW51J3MgSURzLCB0aGUgdG9nZ2xlJ3MgYGFyaWEtY29udHJvbHNgXG4gICAqIGlzIHNldCB0byB0aGUgbWVudSdzIElELlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfc2V0QXJpYUF0dHJpYnV0ZXMoKSB7XG4gICAgc3VwZXIuX3NldEFyaWFBdHRyaWJ1dGVzKCksIEYoXCJidXR0b25cIiwgeyB0b2dnbGU6IHRoaXMuZG9tLnRvZ2dsZSB9KSB8fCB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImJ1dHRvblwiKSwgdGhpcy5kb20udG9nZ2xlLnNldEF0dHJpYnV0ZShcbiAgICAgIFwiYXJpYS1jb250cm9sc1wiLFxuICAgICAgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudS5pZFxuICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIENhbGxzIHRoZSAgY2xvc2VTaWJsaW5ncyBtZXRob2RcbiAgICogYW5kIF90aGVuXyBCYXNlTWVudVRvZ2dsZSdzIG9wZW4gbWV0aG9kLlxuICAgKi9cbiAgb3BlbigpIHtcbiAgICB0aGlzLmNsb3NlU2libGluZ3MoKSwgc3VwZXIub3BlbigpO1xuICB9XG4gIC8qKlxuICAgKiBPcGVucyB0aGUgY29udHJvbGxlZCBtZW51IHdpdGhvdXQgdGhlIGN1cnJlbnQgZm9jdXMgZW50ZXJpbmcgaXQuXG4gICAqXG4gICAqIENhbGxzIHRoZSAgY2xvc2VTaWJsaW5ncyBtZXRob2RcbiAgICogYW5kIF90aGVuXyBCYXNlTWVudVRvZ2dsZSdzIHByZXZpZXcgbWV0aG9kLlxuICAgKi9cbiAgcHJldmlldygpIHtcbiAgICB0aGlzLmNsb3NlU2libGluZ3MoKSwgc3VwZXIucHJldmlldygpO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZUNoaWxkcmVuIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3MgY2xvc2UgbWV0aG9kLlxuICAgKi9cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5pc09wZW4gJiYgdGhpcy5jbG9zZUNoaWxkcmVuKCksIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cbmNsYXNzIHEgZXh0ZW5kcyB3IHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYFRvcExpbmtEaXNjbG9zdXJlTWVudWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICAgICAgb3B0aW9ucy5tZW51RWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG1lbnUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgICAgIFtvcHRpb25zLm1lbnVJdGVtU2VsZWN0b3IgPSBsaV0gICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICAgICAgW29wdGlvbnMubWVudUxpbmtTZWxlY3RvciA9IGFdICAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBsaW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51SXRlbVNlbGVjdG9yID0gbGk6aGFzKHVsKV0gLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGl0ZW1zIGNvbnRhaW5pbmcgc3VibWVudXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudVRvZ2dsZVNlbGVjdG9yID0gYnV0dG9uXSAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3Igc3VibWVudSB0b2dnbGUgYnV0dG9ucy9saW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51U2VsZWN0b3IgPSB1bF0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51cy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51U3VidG9nZ2xlU2VsZWN0b3IgPSBhXSAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51IHRvZ2dsZSBidXR0b25zL2xpbmtzIGJlbG93IHRoZSB0b3AgbGV2ZWwuXG4gICAqIEBwYXJhbSB7P0hUTUxFbGVtZW50fSAgICAgICAgICAgW29wdGlvbnMuY29udHJvbGxlckVsZW1lbnQgPSBudWxsXSAgICAgICAgIC0gVGhlIGVsZW1lbnQgY29udHJvbGxpbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgICAgICBbb3B0aW9ucy5jb250YWluZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSAgICAgW29wdGlvbnMub3BlbkNsYXNzID0gc2hvd10gICAgICAgICAgICAgICAgIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIFwib3BlblwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gICAgIFtvcHRpb25zLmNsb3NlQ2xhc3MgPSBoaWRlXSAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcImNsb3NlZFwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gICAgIFtvcHRpb25zLnRyYW5zaXRpb25DbGFzcyA9IHRyYW5zaXRpb25pbmddICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyB0cmFuc2l0aW9uaW5nIGJldHdlZW4gXCJvcGVuXCIgYW5kIFwiY2xvc2VkXCIgc3RhdGVzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgICAgIFtvcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbiA9IDI1MF0gICAgICAgICAtIFRoZSBkdXJhdGlvbiBvZiB0aGUgdHJhbnNpdGlvbiBiZXR3ZWVuIFwib3BlblwiIGFuZCBcImNsb3NlZFwiIHN0YXRlcyAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgICAgICBbb3B0aW9ucy5pc1RvcExldmVsID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gbWFyayB0aGUgcm9vdCBtZW51LlxuICAgKiBAcGFyYW0gez9Ub3BMaW5rRGlzY2xvc3VyZU1lbnV9IFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAgICAgICAgICAgICAgICAtIFRoZSBwYXJlbnQgbWVudSB0byB0aGlzIG1lbnUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICAgICAgW29wdGlvbnMuaG92ZXJUeXBlID0gb2ZmXSAgICAgICAgICAgICAgICAgIC0gVGhlIHR5cGUgb2YgaG92ZXJhYmlsaXR5IGEgbWVudSBoYXMuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICAgICAgW29wdGlvbnMuaG92ZXJEZWxheSA9IDI1MF0gICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIG1lbnVzIGlmIHRoZSBtZW51IGlzIGhvdmVyYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5lbnRlckRlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIG9wZW5pbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5sZWF2ZURlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIGNsb3NpbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgICAgICBbb3B0aW9ucy5vcHRpb25hbEtleVN1cHBvcnQgPSBmYWxzZV0gICAgICAgLSBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIEhvbWUsIGFuZCBFbmQpIHRvIHRoZSBtZW51LlxuICAgKiBAcGFyYW0gez9zdHJpbmd9ICAgICAgICAgICAgICAgIFtvcHRpb25zLnByZWZpeCA9IGFtLV0gICAgICAgICAgICAgICAgICAgICAtIFRoZSBwcmVmaXggdG8gdXNlIGZvciBDU1MgY3VzdG9tIHByb3BlcnRpZXMuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51RWxlbWVudDogdCxcbiAgICBtZW51SXRlbVNlbGVjdG9yOiBzID0gXCJsaVwiLFxuICAgIG1lbnVMaW5rU2VsZWN0b3I6IG4gPSBcImFcIixcbiAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiBpID0gXCJsaTpoYXModWwpXCIsXG4gICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiBsID0gXCJidXR0b25cIixcbiAgICBzdWJtZW51U2VsZWN0b3I6IGggPSBcInVsXCIsXG4gICAgc3VibWVudVN1YnRvZ2dsZVNlbGVjdG9yOiBtID0gXCJhXCIsXG4gICAgY29udHJvbGxlckVsZW1lbnQ6IGEgPSBudWxsLFxuICAgIGNvbnRhaW5lckVsZW1lbnQ6IGYgPSBudWxsLFxuICAgIG9wZW5DbGFzczogcCA9IFwic2hvd1wiLFxuICAgIGNsb3NlQ2xhc3M6IGcgPSBcImhpZGVcIixcbiAgICB0cmFuc2l0aW9uQ2xhc3M6IGQgPSBcInRyYW5zaXRpb25pbmdcIixcbiAgICB0cmFuc2l0aW9uRHVyYXRpb246IE0gPSAyNTAsXG4gICAgaXNUb3BMZXZlbDogeSA9ICEwLFxuICAgIHBhcmVudE1lbnU6IGIgPSBudWxsLFxuICAgIGhvdmVyVHlwZTogQyA9IFwib2ZmXCIsXG4gICAgaG92ZXJEZWxheTogVCA9IDI1MCxcbiAgICBlbnRlckRlbGF5OiBFID0gLTEsXG4gICAgbGVhdmVEZWxheTogSSA9IC0xLFxuICAgIG9wdGlvbmFsS2V5U3VwcG9ydDogdiA9ICExLFxuICAgIHByZWZpeDogSyA9IFwiYW0tXCIsXG4gICAgaW5pdGlhbGl6ZTogJCA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51RWxlbWVudDogdCxcbiAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMsXG4gICAgICBtZW51TGlua1NlbGVjdG9yOiBuLFxuICAgICAgc3VibWVudUl0ZW1TZWxlY3RvcjogaSxcbiAgICAgIHN1Ym1lbnVTZWxlY3RvcjogaCxcbiAgICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogbCxcbiAgICAgIGNvbnRyb2xsZXJFbGVtZW50OiBhLFxuICAgICAgY29udGFpbmVyRWxlbWVudDogZixcbiAgICAgIG9wZW5DbGFzczogcCxcbiAgICAgIGNsb3NlQ2xhc3M6IGcsXG4gICAgICB0cmFuc2l0aW9uQ2xhc3M6IGQsXG4gICAgICB0cmFuc2l0aW9uRHVyYXRpb246IE0sXG4gICAgICBpc1RvcExldmVsOiB5LFxuICAgICAgcGFyZW50TWVudTogYixcbiAgICAgIGhvdmVyVHlwZTogQyxcbiAgICAgIGhvdmVyRGVsYXk6IFQsXG4gICAgICBlbnRlckRlbGF5OiBFLFxuICAgICAgbGVhdmVEZWxheTogSSxcbiAgICAgIHByZWZpeDogS1xuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUb3BMaW5rRGlzY2xvc3VyZU1lbnV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VHlwZVwiLCBxKTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBtZW51IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUb3BMaW5rRGlzY2xvc3VyZU1lbnVJdGVtfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudUl0ZW1UeXBlXCIsIEopO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgVG9wTGlua0Rpc2Nsb3N1cmVNZW51VG9nZ2xlfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudVRvZ2dsZVR5cGVcIiwgWCk7XG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IG9mIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbWVudSBpdGVtIGluIHRoZSBtZW51LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX2N1cnJlbnRDaGlsZFwiLCAtMSk7XG4gICAgLyoqXG4gICAgICogVGhlIHF1ZXJ5IHNlbGVjdG9ycyB1c2VkIGJ5IHRoZSBtZW51IHRvIHBvcHVsYXRlIHRoZSBkb20uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7T2JqZWN0PHN0cmluZz59XG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gbWVudUl0ZW1zICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgaXRlbXMuXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IG1lbnVMaW5rcyAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIGZvciBtZW51IGxpbmtzLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdWJtZW51SXRlbXMgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBmb3IgbWVudSBpdGVtcyBjb250YWluaW5nIHN1Ym1lbnVzLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdWJtZW51VG9nZ2xlcyAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBmb3IgbWVudSBsaW5rcyB0aGF0IGZ1bmN0aW9uIGFzIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudXMgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIGZvciBzdWJtZW51cy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudVN1YnRvZ2dsZXMgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgbGlua3MgdGhhdCBmdW5jdGlvbiBhcyBzdWJtZW51IHRvZ2dsZXMgYmVsb3cgdGhlIHRvcCBsZXZlbC5cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX3NlbGVjdG9yc1wiLCB7XG4gICAgICBtZW51SXRlbXM6IFwiXCIsXG4gICAgICBtZW51TGlua3M6IFwiXCIsXG4gICAgICBzdWJtZW51SXRlbXM6IFwiXCIsXG4gICAgICBzdWJtZW51VG9nZ2xlczogXCJcIixcbiAgICAgIHN1Ym1lbnVzOiBcIlwiLFxuICAgICAgc3VibWVudVN1YnRvZ2dsZXM6IFwiXCJcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIikgdG8gdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX29wdGlvbmFsU3VwcG9ydFwiLCAhMSk7XG4gICAgdGhpcy5fb3B0aW9uYWxTdXBwb3J0ID0gdiwgdGhpcy5fc2VsZWN0b3JzLm1lbnVJdGVtcyA9IHMsIHRoaXMuX3NlbGVjdG9ycy5zdWJtZW51SXRlbXMgPSBpLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudVRvZ2dsZXMgPSBsLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudXMgPSBoLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudVN1YnRvZ2dsZXMgPSBtLCB0aGlzLl9zZWxlY3RvcnMubWVudUxpbmtzID0gW1xuICAgICAgLi4uLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW24sIGxdKVxuICAgIF0uam9pbihcIixcIiksICQgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBtZW51LlxuICAgKlxuICAgKiBJbml0aWFsaXplIHdpbGwgY2FsbCB0aGUgQmFzZU1lbnUncyBpbml0aWFsaXplIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB1cCBmb2N1cyxcbiAgICogY2xpY2ssXG4gICAqIGhvdmVyLFxuICAgKiBrZXlkb3duLCBhbmRcbiAgICoga2V5dXAgZXZlbnRzIGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogSWYgdGhlIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2QgdGhyb3dzIGFuIGVycm9yLFxuICAgKiB0aGlzIHdpbGwgY2F0Y2ggaXQgYW5kIGxvZyBpdCB0byB0aGUgY29uc29sZS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHN1cGVyLmluaXRpYWxpemUoKSwgdGhpcy5faGFuZGxlRm9jdXMoKSwgdGhpcy5faGFuZGxlQ2xpY2soKSwgdGhpcy5faGFuZGxlSG92ZXIoKSwgdGhpcy5faGFuZGxlS2V5ZG93bigpLCB0aGlzLl9oYW5kbGVLZXl1cCgpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IodCk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIikgdG8gdGhlIG1lbnUuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBvcHRpb25hbEtleVN1cHBvcnQuXG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKlxuICAgKiBAc2VlIF9vcHRpb25hbFN1cHBvcnRcbiAgICovXG4gIGdldCBvcHRpb25hbEtleVN1cHBvcnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX29wdGlvbmFsU3VwcG9ydCA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUub3B0aW9uYWxLZXlTdXBwb3J0O1xuICB9XG4gIHNldCBvcHRpb25hbEtleVN1cHBvcnQodCkge1xuICAgIGMoXCJib29sZWFuXCIsIHsgb3B0aW9uYWxLZXlTdXBwb3J0OiB0IH0pLCB0aGlzLl9vcHRpb25hbFN1cHBvcnQgPSB0O1xuICB9XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbGwgbWVudSBpdGVtcyBhbmQgc3VibWVudXMuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9jcmVhdGVDaGlsZEVsZW1lbnRzKCkge1xuICAgIHRoaXMuZG9tLm1lbnVJdGVtcy5mb3JFYWNoKCh0KSA9PiB7XG4gICAgICBsZXQgcywgbjtcbiAgICAgIGNvbnN0IGkgPSB0LnF1ZXJ5U2VsZWN0b3IodGhpcy5zZWxlY3RvcnMubWVudUxpbmtzKTtcbiAgICAgIGlmICh0aGlzLmRvbS5zdWJtZW51SXRlbXMuaW5jbHVkZXModCkpIHtcbiAgICAgICAgY29uc3QgbCA9IHQucXVlcnlTZWxlY3Rvcih0aGlzLnNlbGVjdG9ycy5zdWJtZW51VG9nZ2xlcyksIGggPSB0LnF1ZXJ5U2VsZWN0b3IodGhpcy5zZWxlY3RvcnMuc3VibWVudXMpLCBtID0gbmV3IHRoaXMuX01lbnVUeXBlKHtcbiAgICAgICAgICBtZW51RWxlbWVudDogaCxcbiAgICAgICAgICBtZW51SXRlbVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5tZW51SXRlbXMsXG4gICAgICAgICAgbWVudUxpbmtTZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMubWVudUxpbmtzLFxuICAgICAgICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVJdGVtcyxcbiAgICAgICAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVTdWJ0b2dnbGVzLFxuICAgICAgICAgIHN1Ym1lbnVTZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMuc3VibWVudXMsXG4gICAgICAgICAgc3VibWVudVN1YnRvZ2dsZVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5zdWJtZW51U3VidG9nZ2xlcyxcbiAgICAgICAgICBvcGVuQ2xhc3M6IHRoaXMub3BlbkNsYXNzLFxuICAgICAgICAgIGNsb3NlQ2xhc3M6IHRoaXMuY2xvc2VDbGFzcyxcbiAgICAgICAgICB0cmFuc2l0aW9uQ2xhc3M6IHRoaXMudHJhbnNpdGlvbkNsYXNzLFxuICAgICAgICAgIGlzVG9wTGV2ZWw6ICExLFxuICAgICAgICAgIHBhcmVudE1lbnU6IHRoaXMsXG4gICAgICAgICAgaG92ZXJUeXBlOiB0aGlzLmhvdmVyVHlwZSxcbiAgICAgICAgICBob3ZlckRlbGF5OiB0aGlzLmhvdmVyRGVsYXksXG4gICAgICAgICAgZW50ZXJEZWxheTogdGhpcy5lbnRlckRlbGF5LFxuICAgICAgICAgIGxlYXZlRGVsYXk6IHRoaXMubGVhdmVEZWxheVxuICAgICAgICB9KSwgYSA9IG5ldyB0aGlzLl9NZW51VG9nZ2xlVHlwZSh7XG4gICAgICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IGwsXG4gICAgICAgICAgcGFyZW50RWxlbWVudDogdCxcbiAgICAgICAgICBjb250cm9sbGVkTWVudTogbSxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5wdXNoKGEpLCBsICE9PSBpID8gKG4gPSBuZXcgdGhpcy5fTWVudUl0ZW1UeXBlKHtcbiAgICAgICAgICBtZW51SXRlbUVsZW1lbnQ6IHQsXG4gICAgICAgICAgbWVudUxpbmtFbGVtZW50OiBsLFxuICAgICAgICAgIHBhcmVudE1lbnU6IHRoaXMsXG4gICAgICAgICAgaXNTdWJtZW51SXRlbTogITAsXG4gICAgICAgICAgY2hpbGRNZW51OiBtLFxuICAgICAgICAgIHRvZ2dsZTogYVxuICAgICAgICB9KSwgcyA9IG5ldyB0aGlzLl9NZW51SXRlbVR5cGUoe1xuICAgICAgICAgIG1lbnVJdGVtRWxlbWVudDogdCxcbiAgICAgICAgICBtZW51TGlua0VsZW1lbnQ6IGksXG4gICAgICAgICAgcGFyZW50TWVudTogdGhpcyxcbiAgICAgICAgICBzdWJtZW51U2libGluZzogblxuICAgICAgICB9KSkgOiBzID0gbmV3IHRoaXMuX01lbnVJdGVtVHlwZSh7XG4gICAgICAgICAgbWVudUl0ZW1FbGVtZW50OiB0LFxuICAgICAgICAgIG1lbnVMaW5rRWxlbWVudDogaSxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzLFxuICAgICAgICAgIGlzU3VibWVudUl0ZW06ICEwLFxuICAgICAgICAgIGNoaWxkTWVudTogbSxcbiAgICAgICAgICB0b2dnbGU6IGFcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2VcbiAgICAgICAgcyA9IG5ldyB0aGlzLl9NZW51SXRlbVR5cGUoe1xuICAgICAgICAgIG1lbnVJdGVtRWxlbWVudDogdCxcbiAgICAgICAgICBtZW51TGlua0VsZW1lbnQ6IGksXG4gICAgICAgICAgcGFyZW50TWVudTogdGhpc1xuICAgICAgICB9KTtcbiAgICAgIHRoaXMuX2VsZW1lbnRzLm1lbnVJdGVtcy5wdXNoKHMpLCB0eXBlb2YgbiA8IFwidVwiICYmIHRoaXMuX2VsZW1lbnRzLm1lbnVJdGVtcy5wdXNoKG4pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgYWxsIGFzcGVjdHMgb2YgdGhlIG1lbnUgdG8gZW5zdXJlIHByb3BlciBmdW5jdGlvbmFsaXR5LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IC0gVGhlIHJlc3VsdCBvZiB0aGUgdmFsaWRhdGlvbi5cbiAgICovXG4gIF92YWxpZGF0ZSgpIHtcbiAgICBsZXQgdCA9IHN1cGVyLl92YWxpZGF0ZSgpO1xuICAgIGNvbnN0IHMgPSB4KHtcbiAgICAgIHN1Ym1lbnVTdWJ0b2dnbGVTZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVTdWJ0b2dnbGVzXG4gICAgfSk7XG4gICAgcy5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKHMuZXJyb3IubWVzc2FnZSksIHQgPSAhMSk7XG4gICAgY29uc3QgbiA9IGMoXCJib29sZWFuXCIsIHtcbiAgICAgIG9wdGlvbmFsS2V5U3VwcG9ydDogdGhpcy5fb3B0aW9uYWxTdXBwb3J0XG4gICAgfSk7XG4gICAgcmV0dXJuIG4uc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChuLmVycm9yLm1lc3NhZ2UpLCB0ID0gITEpLCB0O1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGNsaWNrIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgdXNlLlxuICAgKlxuICAgKiAtIEFkZHMgYWxsIGV2ZW50IGxpc3RlbmVycyBsaXN0ZWQgaW5cbiAgICogICBCYXNlTWVudSdzIF9oYW5kbGVDbGljayBtZXRob2QsIGFuZFxuICAgKiAtIGFkZHMgYSBgcG9pbnRlcnVwYCBsaXN0ZW5lciB0byB0aGUgYGRvY3VtZW50YCBzbyBpZiB0aGUgdXNlclxuICAgKiAgIGNsaWNrcyBvdXRzaWRlIG9mIHRoZSBtZW51IGl0IHdpbGwgY2xvc2UgaWYgaXQgaXMgb3Blbi5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUNsaWNrKCkge1xuICAgIHN1cGVyLl9oYW5kbGVDbGljaygpLCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsICh0KSA9PiB7XG4gICAgICB0aGlzLmZvY3VzU3RhdGUgIT09IFwibm9uZVwiICYmICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgIXRoaXMuZG9tLm1lbnUuY29udGFpbnModC50YXJnZXQpICYmICF0aGlzLmRvbS5tZW51ICE9PSB0LnRhcmdldCAmJiAodGhpcy5jbG9zZUNoaWxkcmVuKCksIHRoaXMuYmx1cigpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmNsb3NlKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuaGFzT3BlbmVkID0gITEpKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBob3ZlciBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIHVzZS5cbiAgICpcbiAgICogQWRkcyBgcG9pbnRlcmVudGVyYCBsaXN0ZW5lcnMgdG8gYWxsIG1lbnUgaXRlbXMgYW5kIGBwb2ludGVybGVhdmVgIGxpc3RlbmVyc1xuICAgKiB0byBhbGwgc3VibWVudSBpdGVtcyB3aGljaCBmdW5jdGlvbiBkaWZmZXJlbnRseSBkZXBlbmRpbmcgb25cbiAgICogdGhlIG1lbnUncyBob3ZlciB0eXBlLlxuICAgKlxuICAgKiBCZWZvcmUgZXhlY3V0aW5nIGFueXRoaW5nLCB0aGUgZXZlbnQgaXMgY2hlY2tlZCB0byBtYWtlIHN1cmUgdGhlIGV2ZW50IHdhc24ndFxuICAgKiB0cmlnZ2VyZWQgYnkgYSBwZW4gb3IgdG91Y2guXG4gICAqXG4gICAqIDxzdHJvbmc+SG92ZXIgVHlwZSBcIm9uXCI8L3N0cm9uZz5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSB0aGUgbWVudSdzXG4gICAqICAgIGN1cnJlbnQgY2hpbGQgdmFsdWUgd2lsbCBjaGFuZ2UgdG8gdGhhdFxuICAgKiAgIG1lbnUgaXRlbS5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBzdWJtZW51IGl0ZW0gdGhlXG4gICAqICAgcHJldmlldyBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0nc1xuICAgKiAgIHRvZ2dsZSB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJsZWF2ZWAgZXZlbnQgdHJpZ2dlcnMgb24gYW4gb3BlbiBzdWJtZW51IGl0ZW0gdGhlXG4gICAqICAgY2xvc2UgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3MgdG9nZ2xlXG4gICAqICAgd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgYSBkZWxheSBzZXQgYnkgdGhlIG1lbnUncyBob3ZlciBkZWxheS5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwiZHluYW1pY1wiPC9zdHJvbmc+XG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0gdGhlIG1lbnUnc1xuICAgKiAgIGN1cnJlbnQgY2hpbGQgdmFsdWUgd2lsbCBjaGFuZ2UgdG8gdGhhdCBtZW51IGl0ZW0uXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0sIGFuZCB0aGUgbWVudSdzXG4gICAqICAgZm9jdXMgc3RhdGUgaXMgbm90IFwibm9uZVwiLCB0aGUgbWVudSBpdGVtXG4gICAqICAgd2lsbCBiZSBmb2N1c2VkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIHN1Ym1lbnUgaXRlbSwgYW5kIGEgc3VibWVudSBpc1xuICAgKiAgIGFscmVhZHkgb3BlbiwgdGhlIHByZXZpZXcgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3MgdG9nZ2xlIHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIG5vbi1zdWJtZW51IGl0ZW0sIGFuZCBhIHN1Ym1lbnVcbiAgICogICBpcyBhbHJlYWR5IG9wZW4sIHRoZSBjbG9zZUNoaWxkcmVuIG1ldGhvZCBmb3IgdGhlIG1lbnUgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgc3VibWVudSBpdGVtLCBhbmQgbm8gc3VibWVudSBpc1xuICAgKiAgIG9wZW4sIG5vIHN1Ym1lbnUtc3BlY2lmaWMgbWV0aG9kcyB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJsZWF2ZWAgZXZlbnQgdHJpZ2dlcnMgb24gYW4gb3BlbiBzdWJtZW51IGl0ZW0gdGhhdCBpcyBub3QgYVxuICAgKiAgIHJvb3QtbGV2ZWwgc3VibWVudSBpdGVtIHRoZSBjbG9zZSBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0ncyB0b2dnbGVcbiAgICogICB3aWxsIGJlIGNhbGxlZCBhbmQgdGhlIHN1Ym1lbnUgaXRlbSB3aWxsIGJlIGZvY3VzZWQgYWZ0ZXIgYSBkZWxheSBzZXQgYnlcbiAgICogICB0aGUgbWVudSdzIGhvdmVyIGRlbGF5LlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmxlYXZlYCBldmVudCB0cmlnZ2VycyBvbiBhbiBvcGVuIHN1Ym1lbnUgaXRlbSB0aGF0IGlzIGFcbiAgICogICByb290LWxldmVsIHN1Ym1lbnUgaXRlbSBubyBzdWJtZW51LXNwZWNpZmljIG1ldGhvZHMgd2lsbCBiZSBjYWxsZWQuXG4gICAqXG4gICAqIDxzdHJvbmc+SG92ZXIgVHlwZSBcIm9mZlwiPC9zdHJvbmc+XG4gICAqIEFsbCBgcG9pbnRlcmVudGVyYCBhbmQgYHBvaW50ZXJsZWF2ZWAgZXZlbnRzIGFyZSBpZ25vcmVkLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlSG92ZXIoKSB7XG4gICAgdGhpcy5lbGVtZW50cy5tZW51SXRlbXMuZm9yRWFjaCgodCwgcykgPT4ge1xuICAgICAgdC5kb20ubGluay5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmVudGVyXCIsIChuKSA9PiB7XG4gICAgICAgIGlmICghKG4ucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgbi5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiKSkge1xuICAgICAgICAgIGlmICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyQ2hpbGRyZW4oKSwgdGhpcy5mb2N1c0NoaWxkKHMpO1xuICAgICAgICAgICAgbGV0IGkgPSB0LmlzU3VibWVudUl0ZW0gPyB0LmVsZW1lbnRzLnRvZ2dsZSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodC5lbGVtZW50cy5zaWJsaW5nICE9PSBudWxsICYmIChpID0gdC5lbGVtZW50cy5zaWJsaW5nLmVsZW1lbnRzLnRvZ2dsZSksIGkgPT09IG51bGwpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBpLnByZXZpZXcoKTtcbiAgICAgICAgICAgIH0sIHRoaXMuZW50ZXJEZWxheSkpIDogaS5wcmV2aWV3KCk7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMuY3VycmVudENoaWxkID0gcywgKCF0aGlzLmlzVG9wTGV2ZWwgfHwgdGhpcy5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIikgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCkpLCAhdGhpcy5pc1RvcExldmVsIHx8IHRoaXMuaGFzT3BlbmVkKSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKTtcbiAgICAgICAgICAgIGxldCBpID0gdC5pc1N1Ym1lbnVJdGVtID8gdC5lbGVtZW50cy50b2dnbGUgOiBudWxsO1xuICAgICAgICAgICAgdC5lbGVtZW50cy5zaWJsaW5nICE9PSBudWxsICYmIChpID0gdC5lbGVtZW50cy5zaWJsaW5nLmVsZW1lbnRzLnRvZ2dsZSksIGkgIT09IG51bGwgPyB0aGlzLmVudGVyRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgaS5wcmV2aWV3KCk7XG4gICAgICAgICAgICB9LCB0aGlzLmVudGVyRGVsYXkpKSA6IGkucHJldmlldygpIDogdGhpcy5lbnRlckRlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMuY2xvc2VDaGlsZHJlbigpO1xuICAgICAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiB0aGlzLmNsb3NlQ2hpbGRyZW4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLCB0LmlzU3VibWVudUl0ZW0gJiYgKHQuZG9tLml0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJsZWF2ZVwiLCAobikgPT4ge1xuICAgICAgICBuLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IG4ucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiA/IHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0LmVsZW1lbnRzLnRvZ2dsZS5jbG9zZSgpO1xuICAgICAgICB9LCB0aGlzLmxlYXZlRGVsYXkpKSA6ICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdC5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSkgOiB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiO1xuICAgICAgICB9LCB0aGlzLmxlYXZlRGVsYXkpKSA6IHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiKSk7XG4gICAgICB9KSwgdC5kb20uaXRlbS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmVudGVyXCIsIChuKSA9PiB7XG4gICAgICAgIG4ucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgbi5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiIHx8IHQuaXNTdWJtZW51SXRlbSAmJiAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiB8fCB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIpICYmIHRoaXMubGVhdmVEZWxheSA+IDAgJiYgdGhpcy5fY2xlYXJUaW1lb3V0KCk7XG4gICAgICB9KSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5ZG93biBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHRoZSBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKiAtIEFkZHMgYWxsIGBrZXlkb3duYCBsaXN0ZW5lcnMgZnJvbSBCYXNlTWVudSdzIF9oYW5kbGVLZXlkb3duIG1ldGhvZFxuICAgKiAtIEFkZHMgYSBga2V5ZG93bmAgbGlzdGVuZXIgdG8gdGhlIG1lbnUvYWxsIHN1Ym1lbnVzLlxuICAgKiAgIC0gQmxvY2tzIHByb3BhZ2F0aW9uIG9uIHRoZSBmb2xsb3dpbmcga2V5czogXCJTcGFjZVwiLCBcIkVudGVyXCIsIGFuZCBcIkVzY2FwZVwiLlxuICAgKiAgIC0gX0lmXyBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0XG4gICAqICAgICBpcyBlbmFibGVkLCBibG9ja3MgcHJvcGFnYXRpb24gb24gdGhlIGZvbGxvd2luZyBrZXlzOlxuICAgKiAgICAgXCJBcnJvd1VwXCIsIFwiQXJyb3dSaWdodFwiLCBcIkFycm93RG93blwiLCBcIkFycm93TGVmdFwiLCBcIkhvbWVcIiwgYW5kIFwiRW5kXCIuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXlkb3duKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXlkb3duKCksIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKHQpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IF8odCk7XG4gICAgICBpZiAodGhpcy5mb2N1c1N0YXRlID09PSBcInNlbGZcIikge1xuICAgICAgICBjb25zdCBuID0gW1wiU3BhY2VcIiwgXCJFbnRlclwiXSwgaSA9IFtcIkVzY2FwZVwiXSwgbCA9IFtcIkVzY2FwZVwiXTtcbiAgICAgICAgdGhpcy5vcHRpb25hbEtleVN1cHBvcnQgPyBbXG4gICAgICAgICAgXCJBcnJvd1VwXCIsXG4gICAgICAgICAgXCJBcnJvd1JpZ2h0XCIsXG4gICAgICAgICAgXCJBcnJvd0Rvd25cIixcbiAgICAgICAgICBcIkFycm93TGVmdFwiLFxuICAgICAgICAgIFwiSG9tZVwiLFxuICAgICAgICAgIFwiRW5kXCJcbiAgICAgICAgXS5pbmNsdWRlcyhzKSAmJiBvKHQpIDogKHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgbi5pbmNsdWRlcyhzKSB8fCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgaS5pbmNsdWRlcyhzKSB8fCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgbC5pbmNsdWRlcyhzKSkgJiYgbyh0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXl1cCBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBBZGRzIGFsbCBga2V5dXBgIGxpc3RlbmVycyBmcm9tIEJhc2VNZW51J3MgX2hhbmRsZUtleXVwIG1ldGhvZC5cbiAgICpcbiAgICogQWRkcyB0aGUgZm9sbG93aW5nIGtleWJpbmRpbmdzIChleHBsYW5hdGlvbnMgYXJlIHRha2VuIGZyb20gdGhlXG4gICAqIFdBSSBBUklBIFByYWN0aWNlcyBFeGFtcGxlIERpc2Nsb3N1cmUgZm9yIE5hdmlnYXRpb24gTWVudXMpOlxuICAgKlxuICAgKiB8IEtleSB8IEZ1bmN0aW9uIHxcbiAgICogfCAtLS0gfCAtLS0gfFxuICAgKiB8IF9UYWJfIG9yIF9TaGlmdCArIFRhYl8gfCBNb3ZlIGtleWJvYXJkIGZvY3VzIGFtb25nIHRvcC1sZXZlbCBidXR0b25zLCBhbmQgaWYgYSBkcm9wZG93biBpcyBvcGVuLCBpbnRvIGFuZCB0aHJvdWdoIGxpbmtzIGluIHRoZSBkcm9wZG93bi4gfFxuICAgKiB8IF9TcGFjZV8gb3IgX0VudGVyXyB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBkaXNjbG9zdXJlIGJ1dHRvbiwgYWN0aXZhdGVzIHRoZSBidXR0b24sIHdoaWNoIHRvZ2dsZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGRyb3Bkb3duLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluazo8dWw+PGxpPklmIGFueSBsaW5rIGhhcyBhcmlhLWN1cnJlbnQgc2V0LCByZW1vdmVzIGl0LjwvbGk+PGxpPlNldHMgYXJpYS1jdXJyZW50PVwicGFnZVwiIG9uIHRoZSBmb2N1c2VkIGxpbmsuPC9saT48bGk+QWN0aXZhdGVzIHRoZSBmb2N1c2VkIGxpbmsuPC9saT48L3VsPjwvbGk+PC91bD4gfFxuICAgKiB8IF9Fc2NhcGVfIHwgSWYgYSBkcm9wZG93biBpcyBvcGVuLCBjbG9zZXMgaXQgYW5kIHNldHMgZm9jdXMgb24gdGhlIGJ1dHRvbiB0aGF0IGNvbnRyb2xzIHRoYXQgZHJvcGRvd24uIHxcbiAgICogfCBfRG93biBBcnJvd18gb3IgX1JpZ2h0IEFycm93XyAoT3B0aW9uYWx9KSB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBidXR0b24gYW5kIGl0cyBkcm9wZG93biBpcyBjb2xsYXBzZWQsIGFuZCBpdCBpcyBub3QgdGhlIGxhc3QgYnV0dG9uLCBtb3ZlcyBmb2N1cyB0byB0aGUgbmV4dCBidXR0b24uPC9saT48bGk+aWYgZm9jdXMgaXMgb24gYSBidXR0b24gYW5kIGl0cyBkcm9wZG93biBpcyBleHBhbmRlZCwgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGxpbmsgaW4gdGhlIGRyb3Bkb3duLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluaywgYW5kIGl0IGlzIG5vdCB0aGUgbGFzdCBsaW5rLCBtb3ZlcyBmb2N1cyB0byB0aGUgbmV4dCBsaW5rLjwvbGk+PC91bD4gfFxuICAgKiB8IF9VcCBBcnJvd18gb3IgX0xlZnQgQXJyb3dfIChPcHRpb25hbH0pIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGJ1dHRvbiwgYW5kIGl0IGlzIG5vdCB0aGUgZmlyc3QgYnV0dG9uLCBtb3ZlcyBmb2N1cyB0byB0aGUgcHJldmlvdXMgYnV0dG9uLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluaywgYW5kIGl0IGlzIG5vdCB0aGUgZmlyc3QgbGluaywgbW92ZXMgZm9jdXMgdG8gdGhlIHByZXZpb3VzIGxpbmsuPC9saT48L3VsPiB8XG4gICAqIHwgX0hvbWVfIChPcHRpb25hbH0pIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGJ1dHRvbiwgYW5kIGl0IGlzIG5vdCB0aGUgZmlyc3QgYnV0dG9uLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgYnV0dG9uLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluaywgYW5kIGl0IGlzIG5vdCB0aGUgZmlyc3QgbGluaywgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGxpbmsuPC9saT48L3VsPiB8XG4gICAqIHwgX0VuZF8gKE9wdGlvbmFsfSkgfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgYnV0dG9uLCBhbmQgaXQgaXMgbm90IHRoZSBsYXN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIGxhc3QgYnV0dG9uLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluaywgYW5kIGl0IGlzIG5vdCB0aGUgbGFzdCBsaW5rLCBtb3ZlcyBmb2N1cyB0byB0aGUgbGFzdCBsaW5rLjwvbGk+PC91bD4gfFxuICAgKlxuICAgKiBUaGUgb3B0aW9uYWwga2V5YmluZGluZ3MgYXJlIGNvbnRyb2xsZWQgYnkgdGhlIG1lbnUncyBvcHRpb25hbEtleVN1cHBvcnQgdmFsdWUuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXl1cCgpIHtcbiAgICBzdXBlci5faGFuZGxlS2V5dXAoKSwgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKHQpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IF8odCk7XG4gICAgICB0aGlzLmZvY3VzU3RhdGUgPT09IFwic2VsZlwiICYmIChzID09PSBcIlNwYWNlXCIgfHwgcyA9PT0gXCJFbnRlclwiID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmNsb3NlKCkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUucHJldmlldygpKSA6IHRoaXMuY3VycmVudE1lbnVJdGVtLmRvbS5saW5rLmNsaWNrKCkgOiBzID09PSBcIkVzY2FwZVwiID8gdGhpcy5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5zb21lKFxuICAgICAgICAoaSkgPT4gaS5pc09wZW5cbiAgICAgICkgPyAobyh0KSwgdGhpcy5jbG9zZUNoaWxkcmVuKCkpIDogdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51ID8gKG8odCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50RXZlbnQgPSB0aGlzLmN1cnJlbnRFdmVudCwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzQ3VycmVudENoaWxkKCkpIDogdGhpcy5pc1RvcExldmVsICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuaXNPcGVuICYmICh0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuY2xvc2UoKSwgdGhpcy5mb2N1c0NvbnRyb2xsZXIoKSkgOiB0aGlzLm9wdGlvbmFsS2V5U3VwcG9ydCAmJiAocyA9PT0gXCJBcnJvd0Rvd25cIiB8fCBzID09PSBcIkFycm93UmlnaHRcIiA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIiwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzRmlyc3RDaGlsZCgpKSA6IHRoaXMuZm9jdXNOZXh0Q2hpbGQoKSkgOiBzID09PSBcIkFycm93VXBcIiB8fCBzID09PSBcIkFycm93TGVmdFwiID8gKG8odCksIHRoaXMuZm9jdXNQcmV2aW91c0NoaWxkKCkpIDogcyA9PT0gXCJIb21lXCIgPyAobyh0KSwgdGhpcy5mb2N1c0ZpcnN0Q2hpbGQoKSkgOiBzID09PSBcIkVuZFwiICYmIChvKHQpLCB0aGlzLmZvY3VzTGFzdENoaWxkKCkpKSk7XG4gICAgfSk7XG4gIH1cbn1cbmNsYXNzIFkgZXh0ZW5kcyBPIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYFRyZWV2aWV3SXRlbWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgaXRlbS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgIG9wdGlvbnMubWVudUl0ZW1FbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICBvcHRpb25zLm1lbnVMaW5rRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSdzIGxpbmsgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtUcmVldmlld30gICAgICAgIG9wdGlvbnMucGFyZW50TWVudSAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICBbb3B0aW9ucy5pc1N1Ym1lbnVJdGVtID0gZmFsc2VdIC0gQSBmbGFnIHRvIG1hcmsgaWYgdGhlIG1lbnUgaXRlbSBpcyBjb250cm9sbGluZyBhIHN1Ym1lbnUuXG4gICAqIEBwYXJhbSB7P1RyZWV2aWV3fSAgICAgICBbb3B0aW9ucy5jaGlsZE1lbnUgPSBudWxsXSAgICAgIC0gVGhlIGNoaWxkIG1lbnUuXG4gICAqIEBwYXJhbSB7P1RyZWV2aWV3VG9nZ2xlfSBbb3B0aW9ucy50b2dnbGUgPSBudWxsXSAgICAgICAgIC0gVGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdICAgICAtIEEgZmxhZyB0byBpbml0aWFsaXplIHRoZSBtZW51IGl0ZW0gaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51SXRlbUVsZW1lbnQ6IGUsXG4gICAgbWVudUxpbmtFbGVtZW50OiB0LFxuICAgIHBhcmVudE1lbnU6IHMsXG4gICAgaXNTdWJtZW51SXRlbTogbiA9ICExLFxuICAgIGNoaWxkTWVudTogaSA9IG51bGwsXG4gICAgdG9nZ2xlOiBsID0gbnVsbCxcbiAgICBpbml0aWFsaXplOiBoID0gITBcbiAgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG1lbnVJdGVtRWxlbWVudDogZSxcbiAgICAgIG1lbnVMaW5rRWxlbWVudDogdCxcbiAgICAgIHBhcmVudE1lbnU6IHMsXG4gICAgICBpc1N1Ym1lbnVJdGVtOiBuLFxuICAgICAgY2hpbGRNZW51OiBpLFxuICAgICAgdG9nZ2xlOiBsXG4gICAgfSksIGggJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIG1lbnUgaXRlbS5cbiAgICpcbiAgICogSW5pdGlhbGl6ZSB3aWxsIGNhbGwgdGhlIEJhc2VNZW51SXRlbSdzIGluaXRpYWxpemUgbWV0aG9kXG4gICAqIGFzIHdlbGwgYXMgc2V0IHRoZSBtZW51IGl0ZW0ncyBgcm9sZWAgdG8gXCJub25lXCIsXG4gICAqIHRoZSBtZW51IGxpbmsncyBgcm9sZWAgdG8gXCJ0cmVlaXRlbVwiLCBhbmRcbiAgICogdGhlIG1lbnUgbGluaydzIGB0YWJJbmRleGAgdG8gLTEgaW4gdGhlIERPTS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgc3VwZXIuaW5pdGlhbGl6ZSgpLCB0aGlzLmRvbS5pdGVtLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJub25lXCIpLCB0aGlzLmRvbS5saW5rLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJ0cmVlaXRlbVwiKSwgdGhpcy5kb20ubGluay50YWJJbmRleCA9IC0xO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1c2VzIHRoZSBtZW51IGl0ZW0ncyBsaW5rIGlmIHRoZSBwYXJlbnQgbWVudSdzXG4gICAqIHNob3VsZEZvY3VzIHZhbHVlIGlzIGB0cnVlYC5cbiAgICpcbiAgICogVGhpcyB3aWxsIGNhbGwgdGhlIEJhc2VNZW51SXRlbSdzIGZvY3VzIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB0aGUgbWVudSBsaW5rJ3MgYHRhYkluZGV4YCB0byAwLlxuICAgKi9cbiAgZm9jdXMoKSB7XG4gICAgc3VwZXIuZm9jdXMoKSwgdGhpcy5kb20ubGluay50YWJJbmRleCA9IDA7XG4gIH1cbiAgLyoqXG4gICAqIEJsdXJzIHRoZSBtZW51IGl0ZW0ncyBsaW5rIGlmIHRoZSBwYXJlbnQgbWVudSdzXG4gICAqIHNob3VsZEZvY3VzIHZhbHVlIGlzIGB0cnVlYC5cbiAgICpcbiAgICogVGhpcyB3aWxsIGNhbGwgdGhlIEJhc2VNZW51SXRlbSdzIGJsdXIgbWV0aG9kXG4gICAqIGFzIHdlbGwgYXMgc2V0IHRoZSBtZW51IGxpbmsncyBgdGFiSW5kZXhgIHRvIC0xLlxuICAgKi9cbiAgYmx1cigpIHtcbiAgICBzdXBlci5ibHVyKCksIHRoaXMuZG9tLmxpbmsudGFiSW5kZXggPSAtMTtcbiAgfVxufVxuY2xhc3MgZWUgZXh0ZW5kcyBMIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYFRyZWV2aWV3VG9nZ2xlYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBvcHRpb25zLm1lbnVUb2dnbGVFbGVtZW50ICAgLSBUaGUgdG9nZ2xlIGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gb3B0aW9ucy5wYXJlbnRFbGVtZW50ICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKiBAcGFyYW0ge1RyZWV2aWV3fSAgICBvcHRpb25zLmNvbnRyb2xsZWRNZW51ICAgICAgLSBUaGUgbWVudSBjb250cm9sbGVkIGJ5IHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0gez9UcmVldmlld30gICBbb3B0aW9ucy5wYXJlbnRNZW51ID0gbnVsbF0gLSBUaGUgbWVudSBjb250YWluaW5nIHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSB0b2dnbGUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51VG9nZ2xlRWxlbWVudDogZSxcbiAgICBwYXJlbnRFbGVtZW50OiB0LFxuICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgIHBhcmVudE1lbnU6IG4gPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGkgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IGUsXG4gICAgICBwYXJlbnRFbGVtZW50OiB0LFxuICAgICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgICBwYXJlbnRNZW51OiBuXG4gICAgfSksIGkgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBtZW51IHRvZ2dsZS5cbiAgICpcbiAgICogVGhlIGZpcnN0IHN0ZXBzIGFyZSB0byBlbnN1cmUgdGhhdCB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUgaGF2ZSBJRHNcbiAgICogdXNpbmcgdGhlIHNldElkcyBtZXRob2QsIGFuZCB0byBzZXQgdGhlIEFSSUEgYXR0cmlidXRlcyBvbiB0aGUgdG9nZ2xlXG4gICAqIGFuZCBjb250cm9sbGVkIG1lbnUgdXNpbmcgdGhlIHNldEFyaWFBdHRyaWJ1dGVzIG1ldGhvZC5cbiAgICpcbiAgICogVGhlbiB0aGUgb3BlbiBvciBjb2xsYXBzZSBtZXRob2QgaXMgY2FsbGVkIGJhc2VkIG9uIHRoZSBzdGF0ZSBvZiB0aGVcbiAgICogdG9nZ2xlJ3MgYXJpYS1leHBhbmRlZCBhdHRyaWJ1dGUuXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuX3NldElkcygpLCB0aGlzLl9zZXRBcmlhQXR0cmlidXRlcygpLCB0aGlzLmRvbS50b2dnbGUuZ2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiKSA9PT0gXCJ0cnVlXCIgPyB0aGlzLm9wZW4oKSA6IHRoaXMuX2NvbGxhcHNlKCExKTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgQVJJQSBhdHRyaWJ1dGVzIG9uIHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogVGhlIGZpcnN0IHN0ZXBzIGFyZSB0byBlbnN1cmUgdGhhdCB0aGUgdG9nZ2xlIGhhcyBgYXJpYS1leHBhbmRlZGBcbiAgICogc2V0IHRvIFwiZmFsc2VcIiBpZiBpdCdzIG5vdCBhbHJlYWR5IHNldCBleHBsaWNpdGx5IHRvIFwidHJ1ZVwiLlxuICAgKlxuICAgKiBUaGVuIHVzaW5nIHRoZSB0b2dnbGUgYW5kIG1lbnUncyBJRHMsIHRoZSBtZW51J3MgYGFyaWEtbGFiZWxsZWRieWAgaXMgc2V0IHRvXG4gICAqIHRoZSB0b2dnbGUncyBJRCwgYW5kIHRoZSB0b2dnbGUncyBgYXJpYS1vd25zYCBpcyBzZXQgdG8gdGhlIG1lbnUncyBJRC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldEFyaWFBdHRyaWJ1dGVzKCkge1xuICAgIHRoaXMuZG9tLnRvZ2dsZS5nZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIpICE9PSBcInRydWVcIiAmJiB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCBcImZhbHNlXCIpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LnNldEF0dHJpYnV0ZShcbiAgICAgIFwiYXJpYS1sYWJlbGxlZGJ5XCIsXG4gICAgICB0aGlzLmRvbS50b2dnbGUuaWRcbiAgICApLCB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFxuICAgICAgXCJhcmlhLW93bnNcIixcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUuaWRcbiAgICApO1xuICB9XG59XG5jbGFzcyBqIGV4dGVuZHMgdyB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBUcmVldmlld2AuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgIG9wdGlvbnMubWVudUVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBtZW51IGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLm1lbnVJdGVtU2VsZWN0b3IgPSBsaV0gICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5tZW51TGlua1NlbGVjdG9yID0gYV0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGxpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudUl0ZW1TZWxlY3RvciA9IGxpOmhhcyh1bCldIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBpdGVtcyBjb250YWluaW5nIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudVRvZ2dsZVNlbGVjdG9yID0gYV0gICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3Igc3VibWVudSB0b2dnbGUgYnV0dG9ucy9saW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVTZWxlY3RvciA9IHVsXSAgICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0gez9IVE1MRWxlbWVudH0gICAgICAgW29wdGlvbnMuY29udHJvbGxlckVsZW1lbnQgPSBudWxsXSAgICAgICAgIC0gVGhlIGVsZW1lbnQgY29udHJvbGxpbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgIFtvcHRpb25zLmNvbnRhaW5lckVsZW1lbnQgPSBudWxsXSAgICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLm9wZW5DbGFzcyA9IHNob3ddICAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcIm9wZW5cIi5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLmNsb3NlQ2xhc3MgPSBoaWRlXSAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcImNsb3NlZFwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMudHJhbnNpdGlvbkNsYXNzID0gdHJhbnNpdGlvbmluZ10gIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIHRyYW5zaXRpb25pbmcgYmV0d2VlbiBcIm9wZW5cIiBhbmQgXCJjbG9zZWRcIiBzdGF0ZXMuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy50cmFuc2l0aW9uRHVyYXRpb24gPSAyNTBdICAgICAgICAgLSBUaGUgZHVyYXRpb24gb2YgdGhlIHRyYW5zaXRpb24gYmV0d2VlbiBcIm9wZW5cIiBhbmQgXCJjbG9zZWRcIiBzdGF0ZXMgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5pc1RvcExldmVsID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gbWFyayB0aGUgcm9vdCBtZW51LlxuICAgKiBAcGFyYW0gez9UcmVldmlld30gICAgICAgICAgW29wdGlvbnMucGFyZW50TWVudSA9IG51bGxdICAgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51IHRvIHRoaXMgbWVudS5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyVHlwZSA9IG9mZl0gICAgICAgICAgICAgICAgICAtIFRoZSB0eXBlIG9mIGhvdmVyYWJpbGl0eSBhIG1lbnUgaGFzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgW29wdGlvbnMuaG92ZXJEZWxheSA9IDI1MF0gICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIG1lbnVzIGlmIHRoZSBtZW51IGlzIGhvdmVyYWJsZSAoaW4gbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmVudGVyRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhIG1lbnUgaWYgdGhlIG1lbnUgaXMgZm9jdXNhYmxlIChpbiBtaWxsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgW29wdGlvbnMubGVhdmVEZWxheSA9IC0xXSAgICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBjbG9zaW5nIGEgbWVudSBpZiB0aGUgbWVudSBpcyBmb2N1c2FibGUgKGluIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gICAgICAgICAgICBbb3B0aW9ucy5wcmVmaXggPSBhbS1dICAgICAgICAgICAgICAgICAgICAgLSBUaGUgcHJlZml4IHRvIHVzZSBmb3IgQ1NTIGN1c3RvbSBwcm9wZXJ0aWVzLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51RWxlbWVudDogdCxcbiAgICBtZW51SXRlbVNlbGVjdG9yOiBzID0gXCJsaVwiLFxuICAgIG1lbnVMaW5rU2VsZWN0b3I6IG4gPSBcImFcIixcbiAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiBpID0gXCJsaTpoYXModWwpXCIsXG4gICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiBsID0gXCJhXCIsXG4gICAgc3VibWVudVNlbGVjdG9yOiBoID0gXCJ1bFwiLFxuICAgIGNvbnRyb2xsZXJFbGVtZW50OiBtID0gbnVsbCxcbiAgICBjb250YWluZXJFbGVtZW50OiBhID0gbnVsbCxcbiAgICBvcGVuQ2xhc3M6IGYgPSBcInNob3dcIixcbiAgICBjbG9zZUNsYXNzOiBwID0gXCJoaWRlXCIsXG4gICAgdHJhbnNpdGlvbkNsYXNzOiBnID0gXCJ0cmFuc2l0aW9uaW5nXCIsXG4gICAgdHJhbnNpdGlvbkR1cmF0aW9uOiBkID0gMjUwLFxuICAgIGlzVG9wTGV2ZWw6IE0gPSAhMCxcbiAgICBwYXJlbnRNZW51OiB5ID0gbnVsbCxcbiAgICBob3ZlclR5cGU6IGIgPSBcIm9mZlwiLFxuICAgIGhvdmVyRGVsYXk6IEMgPSAyNTAsXG4gICAgZW50ZXJEZWxheTogVCA9IC0xLFxuICAgIGxlYXZlRGVsYXk6IEUgPSAtMSxcbiAgICBwcmVmaXg6IEkgPSBcImFtLVwiLFxuICAgIGluaXRpYWxpemU6IHYgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudUVsZW1lbnQ6IHQsXG4gICAgICBtZW51SXRlbVNlbGVjdG9yOiBzLFxuICAgICAgbWVudUxpbmtTZWxlY3RvcjogbixcbiAgICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGksXG4gICAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IGwsXG4gICAgICBzdWJtZW51U2VsZWN0b3I6IGgsXG4gICAgICBjb250cm9sbGVyRWxlbWVudDogbSxcbiAgICAgIGNvbnRhaW5lckVsZW1lbnQ6IGEsXG4gICAgICBvcGVuQ2xhc3M6IGYsXG4gICAgICBjbG9zZUNsYXNzOiBwLFxuICAgICAgdHJhbnNpdGlvbkNsYXNzOiBnLFxuICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiBkLFxuICAgICAgaXNUb3BMZXZlbDogTSxcbiAgICAgIHBhcmVudE1lbnU6IHksXG4gICAgICBob3ZlclR5cGU6IGIsXG4gICAgICBob3ZlckRlbGF5OiBDLFxuICAgICAgZW50ZXJEZWxheTogVCxcbiAgICAgIGxlYXZlRGVsYXk6IEUsXG4gICAgICBwcmVmaXg6IElcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBzdWJtZW51cy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgVHJlZXZpZXd9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VHlwZVwiLCBqKTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBtZW51IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUcmVldmlld0l0ZW19XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51SXRlbVR5cGVcIiwgWSk7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgc3VibWVudSB0b2dnbGVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUcmVldmlld1RvZ2dsZX1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVUb2dnbGVUeXBlXCIsIGVlKTtcbiAgICB2ICYmIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICB9XG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgbWVudS5cbiAgICpcbiAgICogSW5pdGlhbGl6ZSB3aWxsIGNhbGwgdGhlIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2RcbiAgICogYXMgd2VsbCBhcyBzZXQgdXAgZm9jdXMsXG4gICAqIGNsaWNrLFxuICAgKiBob3ZlcixcbiAgICoga2V5ZG93biwgYW5kXG4gICAqIGtleXVwIGV2ZW50cyBmb3IgdGhlIG1lbnUuXG4gICAqXG4gICAqIElmIHRoZSBtZW51IGlzIGEgcm9vdCBtZW51IGl0J3MgYHJvbGVgIHdpbGwgYmUgc2V0IHRvIFwidHJlZVwiIGFuZCB0aGUgZmlyc3RcbiAgICogbWVudSBpdGVtJ3MgYHRhYkluZGV4YCB3aWxsIGJlIHNldCB0byAwIGluIHRoZSBET00uXG4gICAqXG4gICAqIElmIHRoZSBtZW51IGlzIF9ub3RfIGEgcm9vdCBtZW51IGl0J3MgYHJvbGVgIHdpbGwgYmUgc2V0IHRvIFwiZ3JvdXBcIi5cbiAgICpcbiAgICogSWYgdGhlIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2QgdGhyb3dzIGFuIGVycm9yLFxuICAgKiB0aGlzIHdpbGwgY2F0Y2ggaXQgYW5kIGxvZyBpdCB0byB0aGUgY29uc29sZS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHN1cGVyLmluaXRpYWxpemUoKSwgdGhpcy5pc1RvcExldmVsID8gKHRoaXMuZG9tLm1lbnUuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcInRyZWVcIiksIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zWzBdLmRvbS5saW5rLnRhYkluZGV4ID0gMCkgOiB0aGlzLmRvbS5tZW51LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJncm91cFwiKSwgdGhpcy5faGFuZGxlRm9jdXMoKSwgdGhpcy5faGFuZGxlQ2xpY2soKSwgdGhpcy5faGFuZGxlSG92ZXIoKSwgdGhpcy5faGFuZGxlS2V5ZG93bigpLCB0aGlzLl9oYW5kbGVLZXl1cCgpLCB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5kb20udG9nZ2xlLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtb3duc1wiKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICBjb25zb2xlLmVycm9yKHQpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBob3ZlciBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIHVzZS5cbiAgICpcbiAgICogQWRkcyBgcG9pbnRlcmVudGVyYCBsaXN0ZW5lcnMgdG8gYWxsIG1lbnUgaXRlbXMgYW5kIGBwb2ludGVybGVhdmVgIGxpc3RlbmVyc1xuICAgKiB0byBhbGwgc3VibWVudSBpdGVtcyB3aGljaCBmdW5jdGlvbiBkaWZmZXJlbnRseSBkZXBlbmRpbmcgb25cbiAgICogdGhlIG1lbnUncyBob3ZlciB0eXBlLlxuICAgKlxuICAgKiBCZWZvcmUgZXhlY3V0aW5nIGFueXRoaW5nLCB0aGUgZXZlbnQgaXMgY2hlY2tlZCB0byBtYWtlIHN1cmUgdGhlIGV2ZW50IHdhc24ndFxuICAgKiB0cmlnZ2VyZWQgYnkgYSBwZW4gb3IgdG91Y2guXG4gICAqXG4gICAqIDxzdHJvbmc+SG92ZXIgVHlwZSBcIm9uXCI8L3N0cm9uZz5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSB0aGUgbWVudSdzXG4gICAqICAgIGN1cnJlbnQgY2hpbGQgdmFsdWUgd2lsbCBjaGFuZ2UgdG8gdGhhdFxuICAgKiAgIG1lbnUgaXRlbS5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBzdWJtZW51IGl0ZW0gdGhlXG4gICAqICAgcHJldmlldyBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0nc1xuICAgKiAgIHRvZ2dsZSB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJsZWF2ZWAgZXZlbnQgdHJpZ2dlcnMgb24gdGhlIG1lbnUgaXRzZWxmIHRoZVxuICAgKiAgIGNsb3NlQ2hpbGRyZW4gbWV0aG9kIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGEgZGVsYXlcbiAgICogICBzZXQgYnkgdGhlIG1lbnUncyBob3ZlciBkZWxheS5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwiZHluYW1pY1wiPC9zdHJvbmc+XG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0gdGhlIG1lbnUnc1xuICAgKiAgIGN1cnJlbnQgY2hpbGQgdmFsdWUgd2lsbCBjaGFuZ2UgdG8gdGhhdCBtZW51IGl0ZW0uXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0sIGFuZCB0aGUgbWVudSdzXG4gICAqICAgZm9jdXMgc3RhdGUgaXMgbm90IFwibm9uZVwiLCB0aGUgbWVudSBpdGVtXG4gICAqICAgd2lsbCBiZSBmb2N1c2VkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIHN1Ym1lbnUgaXRlbSwgYW5kIGEgc3VibWVudSBpc1xuICAgKiAgIGFscmVhZHkgb3BlbiwgdGhlIHByZXZpZXcgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3MgdG9nZ2xlIHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIG5vbi1zdWJtZW51IGl0ZW0sIGFuZCBhIHN1Ym1lbnVcbiAgICogICBpcyBhbHJlYWR5IG9wZW4sIHRoZSBjbG9zZUNoaWxkcmVuIG1ldGhvZCBmb3IgdGhlIG1lbnUgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgc3VibWVudSBpdGVtLCBhbmQgbm8gc3VibWVudSBpc1xuICAgKiAgIG9wZW4sIG5vIHN1Ym1lbnUtc3BlY2lmaWMgbWV0aG9kcyB3aWxsIGJlIGNhbGxlZC5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwib2ZmXCI8L3N0cm9uZz5cbiAgICogQWxsIGBwb2ludGVyZW50ZXJgIGFuZCBgcG9pbnRlcmxlYXZlYCBldmVudHMgYXJlIGlnbm9yZWQuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVIb3ZlcigpIHtcbiAgICB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5mb3JFYWNoKCh0LCBzKSA9PiB7XG4gICAgICB0LmRvbS5saW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZW50ZXJcIiwgKG4pID0+IHtcbiAgICAgICAgbi5wb2ludGVyVHlwZSA9PT0gXCJwZW5cIiB8fCBuLnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIgfHwgKHRoaXMuaG92ZXJUeXBlID09PSBcIm9uXCIgPyAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDaGlsZChzKSwgdC5pc1N1Ym1lbnVJdGVtICYmICh0aGlzLmVudGVyRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0LmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCk7XG4gICAgICAgIH0sIHRoaXMuZW50ZXJEZWxheSkpIDogdC5lbGVtZW50cy50b2dnbGUucHJldmlldygpKSkgOiB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMuY3VycmVudENoaWxkID0gcywgKCF0aGlzLmlzVG9wTGV2ZWwgfHwgdGhpcy5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIikgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCkpLCAoIXRoaXMuaXNUb3BMZXZlbCB8fCB0aGlzLmhhc09wZW5lZCkgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCksIHQuaXNTdWJtZW51SXRlbSA/IHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHQuZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKTtcbiAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiB0LmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkgOiB0aGlzLmVudGVyRGVsYXkgPiAwICYmIHRoaXMuX2NsZWFyVGltZW91dCgpKSkpO1xuICAgICAgfSksIHQuaXNTdWJtZW51SXRlbSAmJiAodC5kb20uaXRlbS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmxlYXZlXCIsIChuKSA9PiB7XG4gICAgICAgIG4ucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgbi5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiIHx8ICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiID8gdGhpcy5sZWF2ZURlbGF5ID4gMCAmJiB0aGlzLl9jbGVhclRpbWVvdXQoKSA6IHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIiAmJiAodGhpcy5sZWF2ZURlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCI7XG4gICAgICAgIH0sIHRoaXMubGVhdmVEZWxheSkpIDogdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIpKTtcbiAgICAgIH0pLCB0LmRvbS5pdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZW50ZXJcIiwgKG4pID0+IHtcbiAgICAgICAgbi5wb2ludGVyVHlwZSA9PT0gXCJwZW5cIiB8fCBuLnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIgfHwgdC5pc1N1Ym1lbnVJdGVtICYmICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiIHx8IHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIikgJiYgdGhpcy5sZWF2ZURlbGF5ID4gMCAmJiB0aGlzLl9jbGVhclRpbWVvdXQoKTtcbiAgICAgIH0pKSwgdGhpcy5pc1RvcExldmVsICYmIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJsZWF2ZVwiLCAobikgPT4ge1xuICAgICAgICBuLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IG4ucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCB0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiICYmICh0aGlzLmxlYXZlRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5ibHVyKCk7XG4gICAgICAgIH0sIHRoaXMubGVhdmVEZWxheSkpIDogKHRoaXMuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmJsdXIoKSkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5ZG93biBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHRoZSBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKiAtIEFkZHMgYWxsIGBrZXlkb3duYCBsaXN0ZW5lcnMgZnJvbSBCYXNlTWVudSdzIF9oYW5kbGVLZXlkb3duIG1ldGhvZFxuICAgKiAtIEFkZHMgYSBga2V5ZG93bmAgbGlzdGVuZXIgdG8gdGhlIG1lbnUvYWxsIHN1Ym1lbnVzLlxuICAgKiAgIC0gQmxvY2tzIHByb3BhZ2F0aW9uIG9uIHRoZSBmb2xsb3dpbmcga2V5czogXCJBcnJvd1VwXCIsIFwiQXJyb3dSaWdodFwiLFxuICAgKiAgICAgXCJBcnJvd0Rvd25cIiwgXCJBcnJvd0xlZnRcIiwgXCJIb21lXCIsIFwiRW5kXCIsIFwiU3BhY2VcIiwgXCJFbnRlclwiLCBcIkVzY2FwZVwiLFxuICAgKiAgICAgXCIqXCIgKGFzdGVyaXNrKSwgYW5kIFwiQVwiIHRocm91Z2ggXCJaXCIuXG4gICAqICAgLSBNb3ZlcyBmb2N1cyBvdXQgaWYgdGhlIFwiVGFiXCIga2V5IGlzIHByZXNzZWQuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXlkb3duKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXlkb3duKCksIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKHQpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IF8odCk7XG4gICAgICBpZiAocyA9PT0gXCJUYWJcIiAmJiAodGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIiA/IHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1cigpIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1cygpKSwgdGhpcy5mb2N1c1N0YXRlID09PSBcInNlbGZcIikge1xuICAgICAgICBjb25zdCBuID0gW1xuICAgICAgICAgIFwiU3BhY2VcIixcbiAgICAgICAgICBcIkFycm93VXBcIixcbiAgICAgICAgICBcIkFycm93RG93blwiLFxuICAgICAgICAgIFwiQXJyb3dMZWZ0XCIsXG4gICAgICAgICAgXCJBc3Rlcmlza1wiLFxuICAgICAgICAgIFwiSG9tZVwiLFxuICAgICAgICAgIFwiRW5kXCJcbiAgICAgICAgXSwgaSA9IFtcIkVudGVyXCIsIFwiQXJyb3dSaWdodFwiXSwgbCA9IFtcIkVzY2FwZVwiXTtcbiAgICAgICAgKG4uaW5jbHVkZXMocykgfHwgdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiBpLmluY2x1ZGVzKHMpIHx8IHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiBsLmluY2x1ZGVzKHMpKSAmJiBvKHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGtleXVwIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIEFkZHMgYWxsIGBrZXl1cGAgbGlzdGVuZXJzIGZyb20gQmFzZU1lbnUncyBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKlxuICAgKiBBZGRzIHRoZSBmb2xsb3dpbmcga2V5YmluZGluZ3MgKGV4cGxhbmF0aW9ucyBhcmUgdGFrZW4gZnJvbSB0aGVcbiAgICogTmF2aWdhdGlvbiBUcmVldmlldyBFeGFtcGxlIFVzaW5nIENvbXB1dGVkIFByb3BlcnRpZXMpOlxuICAgKlxuICAgKiB8IEtleSB8IEZ1bmN0aW9uIHxcbiAgICogfCAtLS0gfCAtLS0gfFxuICAgKiB8IF9FbnRlcl8gb3IgX1NwYWNlXyB8IFBlcmZvcm1zIHRoZSBkZWZhdWx0IGFjdGlvbiAoZS5nLiBvbmNsaWNrIGV2ZW50KSBmb3IgdGhlIGZvY3VzZWQgbm9kZS4gfFxuICAgKiB8IF9Eb3duIGFycm93XyB8IDx1bD48bGk+TW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgbm9kZSB0aGF0IGlzIGZvY3VzYWJsZSB3aXRob3V0IG9wZW5pbmcgb3IgY2xvc2luZyBhIG5vZGUuPC9saT48bGk+SWYgZm9jdXMgaXMgb24gdGhlIGxhc3Qgbm9kZSwgZG9lcyBub3RoaW5nLjwvbGk+PC91bD4gfFxuICAgKiB8IF9VcCBhcnJvd18gfCA8dWw+PGxpPk1vdmVzIGZvY3VzIHRvIHRoZSBwcmV2aW91cyBub2RlIHRoYXQgaXMgZm9jdXNhYmxlIHdpdGhvdXQgb3BlbmluZyBvciBjbG9zaW5nIGEgbm9kZS48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiB0aGUgZmlyc3Qgbm9kZSwgZG9lcyBub3RoaW5nLjwvbGk+PC91bD4gfFxuICAgKiB8IF9SaWdodCBhcnJvd18gfCA8dWw+PGxpPldoZW4gZm9jdXMgaXMgb24gYSBjbG9zZWQgbm9kZSwgb3BlbnMgdGhlIG5vZGU7IGZvY3VzIGRvZXMgbm90IG1vdmUuPC9saT48bGk+V2hlbiBmb2N1cyBpcyBvbiBhIG9wZW4gbm9kZSwgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGNoaWxkIG5vZGUuPC9saT48bGk+V2hlbiBmb2N1cyBpcyBvbiBhbiBlbmQgbm9kZSwgZG9lcyBub3RoaW5nLjwvbGk+PC91bD4gfFxuICAgKiB8IF9MZWZ0IGFycm93XyB8IDx1bD48bGk+V2hlbiBmb2N1cyBpcyBvbiBhbiBvcGVuIG5vZGUsIGNsb3NlcyB0aGUgbm9kZS48L2xpPjxsaT5XaGVuIGZvY3VzIGlzIG9uIGEgY2hpbGQgbm9kZSB0aGF0IGlzIGFsc28gZWl0aGVyIGFuIGVuZCBub2RlIG9yIGEgY2xvc2VkIG5vZGUsIG1vdmVzIGZvY3VzIHRvIGl0cyBwYXJlbnQgbm9kZS48L2xpPjxsaT5XaGVuIGZvY3VzIGlzIG9uIGEgcm9vdCBub2RlIHRoYXQgaXMgYWxzbyBlaXRoZXIgYW4gZW5kIG5vZGUgb3IgYSBjbG9zZWQgbm9kZSwgZG9lcyBub3RoaW5nLjwvbGk+PC91bD4gfFxuICAgKiB8IF9Ib21lXyB8IE1vdmVzIGZvY3VzIHRvIGZpcnN0IG5vZGUgd2l0aG91dCBvcGVuaW5nIG9yIGNsb3NpbmcgYSBub2RlLiB8XG4gICAqIHwgX0VuZF8gfCBNb3ZlcyBmb2N1cyB0byB0aGUgbGFzdCBub2RlIHRoYXQgY2FuIGJlIGZvY3VzZWQgd2l0aG91dCBleHBhbmRpbmcgYW55IG5vZGVzIHRoYXQgYXJlIGNsb3NlZC4gfFxuICAgKiB8IF9hLXpfLCBfQS1aXyB8IDx1bD48bGk+Rm9jdXMgbW92ZXMgdG8gdGhlIG5leHQgbm9kZSB3aXRoIGEgbmFtZSB0aGF0IHN0YXJ0cyB3aXRoIHRoZSB0eXBlZCBjaGFyYWN0ZXIuPC9saT48bGk+U2VhcmNoIHdyYXBzIHRvIGZpcnN0IG5vZGUgaWYgYSBtYXRjaGluZyBuYW1lIGlzIG5vdCBmb3VuZCBhbW9uZyB0aGUgbm9kZXMgdGhhdCBmb2xsb3cgdGhlIGZvY3VzZWQgbm9kZS48L2xpPjxsaT5TZWFyY2ggaWdub3JlcyBub2RlcyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiBjbG9zZWQgbm9kZXMuPC9saT48L3VsPiB8XG4gICAqIHwgXyogKGFzdGVyaXNrKV8gfCA8dWw+PGxpPkV4cGFuZHMgYWxsIGNsb3NlZCBzaWJsaW5nIG5vZGVzIHRoYXQgYXJlIGF0IHRoZSBzYW1lIGxldmVsIGFzIHRoZSBmb2N1c2VkIG5vZGUuPC9saT48bGk+Rm9jdXMgZG9lcyBub3QgbW92ZS48L2xpPjwvdWw+IHxcbiAgICogfCBfRXNjYXBlXyB8IElmIHRoZSByb290IG1lbnUgaXMgY29sbGFwc2libGUsIGNvbGxhcHNlcyB0aGUgbWVudSBhbmQgZm9jdXNlcyB0aGUgbWVudSdzIGNvbnRyb2xsaW5nIGVsZW1lbnQuIHxcbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleXVwKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXl1cCgpLCB0aGlzLmRvbS5tZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAodCkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBzID0gXyh0KSwgeyBhbHRLZXk6IG4sIGNydGxLZXk6IGksIG1ldGFLZXk6IGwgfSA9IHQ7XG4gICAgICBpZiAocyA9PT0gXCJDaGFyYWN0ZXJcIiAmJiAhKG4gfHwgaSB8fCBsKSlcbiAgICAgICAgbyh0KSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5jdXJyZW50RXZlbnQgPSBcImNoYXJhY3RlclwiLCB0aGlzLmZvY3VzTmV4dE5vZGVXaXRoQ2hhcmFjdGVyKHQua2V5KTtcbiAgICAgIGVsc2UgaWYgKHRoaXMuZm9jdXNTdGF0ZSA9PT0gXCJzZWxmXCIpXG4gICAgICAgIGlmIChzID09PSBcIkVudGVyXCIgfHwgcyA9PT0gXCJTcGFjZVwiKVxuICAgICAgICAgIG8odCksIHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gPyB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmNsb3NlKCkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUucHJldmlldygpIDogdGhpcy5jdXJyZW50TWVudUl0ZW0uZG9tLmxpbmsuY2xpY2soKTtcbiAgICAgICAgZWxzZSBpZiAocyA9PT0gXCJFc2NhcGVcIilcbiAgICAgICAgICB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5pc09wZW4gJiYgKHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5jbG9zZSgpLCB0aGlzLmZvY3VzQ29udHJvbGxlcigpKTtcbiAgICAgICAgZWxzZSBpZiAocyA9PT0gXCJBcnJvd0Rvd25cIilcbiAgICAgICAgICBvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5ibHVyQ3VycmVudENoaWxkKCksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSB0aGlzLmN1cnJlbnRFdmVudCwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzRmlyc3RDaGlsZCgpKSA6ICF0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5jdXJyZW50Q2hpbGQgPT09IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCAtIDEgPyB0aGlzLmZvY3VzUGFyZW50c05leHRDaGlsZCgpIDogdGhpcy5mb2N1c05leHRDaGlsZCgpO1xuICAgICAgICBlbHNlIGlmIChzID09PSBcIkFycm93VXBcIikge1xuICAgICAgICAgIG8odCk7XG4gICAgICAgICAgY29uc3QgbSA9IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zW3RoaXMuY3VycmVudENoaWxkIC0gMV07XG4gICAgICAgICAgbSAmJiBtLmlzU3VibWVudUl0ZW0gJiYgbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuID8gKHRoaXMuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmN1cnJlbnRDaGlsZCA9IHRoaXMuY3VycmVudENoaWxkIC0gMSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmZvY3VzQ2hpbGRzTGFzdE5vZGUoKSkgOiAhdGhpcy5pc1RvcExldmVsICYmIHRoaXMuY3VycmVudENoaWxkID09PSAwID8gKHRoaXMuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudEV2ZW50ID0gdGhpcy5jdXJyZW50RXZlbnQsIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5mb2N1c0N1cnJlbnRDaGlsZCgpKSA6IHRoaXMuZm9jdXNQcmV2aW91c0NoaWxkKCk7XG4gICAgICAgIH0gZWxzZSBzID09PSBcIkFycm93UmlnaHRcIiA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgKG8odCksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5ibHVyQ3VycmVudENoaWxkKCksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSB0aGlzLmN1cnJlbnRFdmVudCwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzRmlyc3RDaGlsZCgpKSA6IHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpIDogcyA9PT0gXCJBcnJvd0xlZnRcIiA/IChvKHQpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmNsb3NlKCkpIDogdGhpcy5pc1RvcExldmVsIHx8ICh0aGlzLmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNDdXJyZW50Q2hpbGQoKSkpIDogcyA9PT0gXCJIb21lXCIgPyAobyh0KSwgdGhpcy5ibHVyQ3VycmVudENoaWxkKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuZm9jdXNGaXJzdENoaWxkKCkpIDogcyA9PT0gXCJFbmRcIiA/IChvKHQpLCB0aGlzLmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1c0xhc3ROb2RlKCkpIDogcyA9PT0gXCJBc3Rlcmlza1wiICYmIChvKHQpLCB0aGlzLm9wZW5DaGlsZHJlbigpKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBsYXN0IG5vZGUgb2YgdGhlIGVudGlyZSBleHBhbmRlZCBtZW51LlxuICAgKlxuICAgKiBUaGlzIGluY2x1ZGVzIGFsbCBfb3Blbl8gY2hpbGQgbWVudSBpdGVtcy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNMYXN0Tm9kZSgpIHtcbiAgICBjb25zdCB0ID0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXMubGVuZ3RoIC0gMSwgcyA9IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zW3RdO1xuICAgIHMuaXNTdWJtZW51SXRlbSAmJiBzLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5jdXJyZW50Q2hpbGQgPSB0LCBzLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSB0aGlzLmN1cnJlbnRFdmVudCwgcy5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNMYXN0Tm9kZSgpKSA6IHRoaXMuZm9jdXNMYXN0Q2hpbGQoKTtcbiAgfVxuICAvKipcbiAgICogT3BlbiBhbGwgc3VibWVudSBjaGlsZHJlbi5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgb3BlbkNoaWxkcmVuKCkge1xuICAgIHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuZm9yRWFjaCgodCkgPT4gdC5wcmV2aWV3KCkpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIG5leHQgbm9kZSBzdGFydGluZyB3aXRoIGEgc3BlY2lmaWMgbGV0dGVyLlxuICAgKlxuICAgKiBUaGlzIGluY2x1ZGVzIGFsbCBfb3Blbl8gY2hpbGQgbWVudSBpdGVtcy5cbiAgICpcbiAgICogV3JhcHMgdG8gdGhlIGZpcnN0IG5vZGUgaWYgbm8gbWF0Y2ggaXMgZm91bmQgYWZ0ZXIgdGhlIGN1cnJlbnQgbm9kZS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2hhciAtIFRoZSBjaGFyYWN0ZXIgdG8gbG9vayBmb3IuXG4gICAqL1xuICBmb2N1c05leHROb2RlV2l0aENoYXJhY3Rlcih0KSB7XG4gICAgZnVuY3Rpb24gcyhmKSB7XG4gICAgICBsZXQgcCA9IFtdO1xuICAgICAgcmV0dXJuIGYuZWxlbWVudHMubWVudUl0ZW1zLmZvckVhY2goKGcpID0+IHtcbiAgICAgICAgcC5wdXNoKGcpLCBnLmlzU3VibWVudUl0ZW0gJiYgZy5lbGVtZW50cy50b2dnbGUuaXNPcGVuICYmIChwID0gW1xuICAgICAgICAgIC4uLnAsXG4gICAgICAgICAgLi4ucyhcbiAgICAgICAgICAgIGcuZWxlbWVudHMudG9nZ2xlLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51XG4gICAgICAgICAgKVxuICAgICAgICBdKTtcbiAgICAgIH0pLCBwO1xuICAgIH1cbiAgICBjb25zdCBuID0gdC50b0xvd2VyQ2FzZSgpLCBpID0gcyh0aGlzLmVsZW1lbnRzLnJvb3RNZW51KSwgbCA9IGkuaW5kZXhPZih0aGlzLmN1cnJlbnRNZW51SXRlbSkgKyAxLCBoID0gW1xuICAgICAgLi4uaS5zbGljZShsKSxcbiAgICAgIC4uLmkuc2xpY2UoMCwgbClcbiAgICBdO1xuICAgIGxldCBtID0gMCwgYSA9ICExO1xuICAgIGZvciAoOyAhYSAmJiBtIDwgaC5sZW5ndGg7ICkge1xuICAgICAgbGV0IGYgPSBcIlwiO1xuICAgICAgaWYgKGhbbV0uZG9tLml0ZW0uaW5uZXJUZXh0ID8gZiA9IGhbbV0uZG9tLml0ZW0uaW5uZXJUZXh0IDogZiA9IGhbbV0uZG9tLml0ZW0udGV4dENvbnRlbnQsIGYgPSBmLnJlcGxhY2UoL1tcXHNdL2csIFwiXCIpLnRvTG93ZXJDYXNlKCkuY2hhckF0KDApLCBmID09PSBuKSB7XG4gICAgICAgIGEgPSAhMDtcbiAgICAgICAgY29uc3QgcCA9IGhbbV0uZWxlbWVudHMucGFyZW50TWVudSwgZyA9IHAuZWxlbWVudHMubWVudUl0ZW1zLmluZGV4T2YoaFttXSk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHAuZm9jdXNDaGlsZChnKTtcbiAgICAgIH1cbiAgICAgIG0rKztcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBwYXJlbnQgbWVudSdzIG5leHQgY2hpbGQuXG4gICAqXG4gICAqIFRoaXMgd2lsbCBjYXNjYWRlIHVwIHRocm91Z2ggdG8gdGhlIHJvb3QgbWVudS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNQYXJlbnRzTmV4dENoaWxkKCkge1xuICAgIHRoaXMuZWxlbWVudHMucGFyZW50TWVudSAmJiAodGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudENoaWxkID09PSB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCAtIDEgPyAodGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzUGFyZW50c05leHRDaGlsZCgpKSA6ICh0aGlzLmJsdXJDaGlsZHJlbigpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNOZXh0Q2hpbGQoKSkpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbGFzdCBjaGlsZCBvZiB0aGUgY3VycmVudCBjaGlsZCdzIHN1Ym1lbnUuXG4gICAqXG4gICAqIFRoaXMgd2lsbCBjYXNjYWRlIGRvd24gdGhyb3VnaCB0byB0aGUgbGFzdCBvcGVuIG1lbnUuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzQ2hpbGRzTGFzdE5vZGUoKSB7XG4gICAgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNMYXN0Q2hpbGQoKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbiAmJiAodGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzQ2hpbGRzTGFzdE5vZGUoKSk7XG4gIH1cbn1cbmNvbnN0IHNlID0ge1xuICBEaXNjbG9zdXJlTWVudTogeixcbiAgTWVudWJhcjogSCxcbiAgVG9wTGlua0Rpc2Nsb3N1cmVNZW51OiBxLFxuICBUcmVldmlldzogalxufTtcbmV4cG9ydCB7XG4gIHNlIGFzIGRlZmF1bHRcbn07XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZTsgfTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0IHsgQXBwbGljYXRpb24gfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuaW1wb3J0IHsgZGVmaW5pdGlvbkZvck1vZHVsZUFuZElkZW50aWZpZXIsIGlkZW50aWZpZXJGb3JDb250ZXh0S2V5IH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzLXdlYnBhY2staGVscGVycyc7XG5pbXBvcnQgJ0Bob3R3aXJlZC90dXJibyc7XG5pbXBvcnQgV2ViQXV0aG4gZnJvbSAnQHdlYi1hdXRoL3dlYmF1dGhuLXN0aW11bHVzJztcblxuaW1wb3J0ICcuL3NjcmlwdHMvbW9vdGFvLmpzJztcbmltcG9ydCAnLi9zY3JpcHRzL2NvcmUuanMnO1xuaW1wb3J0ICcuL3NjcmlwdHMvbGltaXQtaGVpZ2h0LmpzJztcbmltcG9ydCAnLi9zY3JpcHRzL21vZHVsZXdpemFyZC5qcyc7XG5pbXBvcnQgJy4vc2NyaXB0cy9zZWN0aW9ud2l6YXJkLmpzJztcblxuaW1wb3J0ICcuL3N0eWxlcy9iYWNrZW5kLnBjc3MnO1xuXG4vLyBTdGFydCB0aGUgU3RpbXVsdXMgYXBwbGljYXRpb25cbmNvbnN0IGFwcGxpY2F0aW9uID0gQXBwbGljYXRpb24uc3RhcnQoKTtcbmFwcGxpY2F0aW9uLmRlYnVnID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCc7XG5cbi8vIFJlZ2lzdGVyIGFsbCBjb250cm9sbGVycyB3aXRoIGBjb250YW8tLWAgcHJlZml4XG5jb25zdCBjb250ZXh0ID0gcmVxdWlyZS5jb250ZXh0KCcuL2NvbnRyb2xsZXJzJywgdHJ1ZSwgL1xcLmpzJC8pO1xuYXBwbGljYXRpb24ubG9hZChjb250ZXh0LmtleXMoKVxuICAgIC5tYXAoKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBpZGVudGlmaWVyID0gaWRlbnRpZmllckZvckNvbnRleHRLZXkoa2V5KTtcbiAgICAgICAgaWYgKGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllcihjb250ZXh0KGtleSksIGBjb250YW8tLSR7IGlkZW50aWZpZXIgfWApO1xuICAgICAgICB9XG4gICAgfSkuZmlsdGVyKCh2YWx1ZSkgPT4gdmFsdWUpXG4pO1xuXG5hcHBsaWNhdGlvbi5yZWdpc3RlcignY29udGFvLS13ZWJhdXRobicsIFdlYkF1dGhuKTtcblxuLy8gQ2FuY2VsIGFsbCBwcmVmZXRjaCByZXF1ZXN0cyB0aGF0IGNvbnRhaW4gYSByZXF1ZXN0IHRva2VuIG9yIGFyZSByZWxhdGVkIHRvXG4vLyB0aGUgU3ltZm9ueSB0b29sYmFyXG5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHVyYm86YmVmb3JlLXByZWZldGNoJywgZSA9PiB7XG4gICAgY29uc29sZS5kZWJ1ZyhlLnRhcmdldCwgZS50YXJnZXQuc2VhcmNoKTtcblxuICAgIGlmIChcbiAgICAgICAgKGUudGFyZ2V0LnNlYXJjaCAmJiAobmV3IFVSTFNlYXJjaFBhcmFtcyhlLnRhcmdldC5zZWFyY2gpKS5oYXMoJ3J0JykpXG4gICAgICAgIHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGVhZGVyX2JhY2snKVxuICAgICAgICB8fCBlLnRhcmdldC5jbG9zZXN0KCcuc2YtdG9vbGJhcicpICE9PSBudWxsXG4gICAgICAgIHx8IGUudGFyZ2V0Lm1hdGNoZXMoJ1tvbmNsaWNrXj1cIkJhY2tlbmQub3Blbk1vZGFsSWZyYW1lKFwiXScpXG4gICAgKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG59KTtcblxuLy8gTWFrZSB0aGUgTW9vVG9vbHMgc2NyaXB0cyByZWluaXRpYWxpemUgdGhlbXNlbHZlc1xuY29uc3QgbW9vRG9tcmVhZHkgPSAoKSA9PiB7XG4gICAgaWYgKCFkb2N1bWVudC5ib2R5Lm1vb0RvbXJlYWR5RmlyZWQpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5tb29Eb21yZWFkeUZpcmVkID0gdHJ1ZTtcblxuICAgICAgICBpZiAoRWxlbWVudC5FdmVudHMucmVtb3ZlRXZlbnRzKSB7XG4gICAgICAgICAgICBFbGVtZW50LkV2ZW50cy5yZW1vdmVFdmVudHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHdpbmRvdy5maXJlRXZlbnQoJ2RvbXJlYWR5Jyk7XG4gICAgfVxufVxuXG5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHVyYm86cmVuZGVyJywgbW9vRG9tcmVhZHkpO1xuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOmZyYW1lLXJlbmRlcicsIG1vb0RvbXJlYWR5KTtcblxuLy8gQWx3YXlzIGJyZWFrIG91dCBvZiBhIG1pc3NpbmcgZnJhbWUgKCM3NTAxKVxuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOmZyYW1lLW1pc3NpbmcnLCAoZSkgPT4ge1xuICAgIGlmICh3aW5kb3cuY29uc29sZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1R1cmJvIGZyYW1lICMnK2UudGFyZ2V0LmlkKycgaXMgbWlzc2luZy4nKTtcbiAgICB9XG5cbiAgICAvLyBEbyBub3QgYnJlYWsgb3V0IG9mIGZyYW1lcyB0aGF0IGxvYWQgdGhlaXIgY29udGVudCB2aWEgc3JjXG4gICAgaWYgKGUudGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnc3JjJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLmRldGFpbC52aXNpdChlLmRldGFpbC5yZXNwb25zZSk7XG59KTtcblxuLy8gQ2FsbCB0aGUgYmVmb3JlQ2FjaGUoKSBmdW5jdGlvbiBvbiBhbGwgY29udHJvbGxlcnMgaW1wbGVtZW50aW5nIGl0LiBUaGlzXG4vLyBhbGxvd3MgY29udHJvbGxlcnMgdG8gdGVhciBkb3duIHRoaW5ncyBiZWZvcmUgdGhlIHBhZ2UgZ2V0cyBwdXQgaW50byBjYWNoZS5cbi8vIE5vdGUgdGhhdCBTdGltdWx1cycgZGlzY29ubmVjdCgpIGZ1bmN0aW9uIHdpbGwgbm90IGZpcmUgYXQgdGhpcyBwb2ludCBhbmRcbi8vIHRodXMgY2Fubm90IGJlIHVzZWQgZm9yIHRoaXMgdGFzay5cbmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0dXJibzpiZWZvcmUtY2FjaGUnLCAoZSkgPT4ge1xuICAgIGFwcGxpY2F0aW9uLmNvbnRyb2xsZXJzLmZvckVhY2goY29udHJvbGxlciA9PiB7XG4gICAgICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgY29udHJvbGxlci5iZWZvcmVDYWNoZSkge1xuICAgICAgICAgICAgY29udHJvbGxlci5iZWZvcmVDYWNoZShlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gUmVtb3ZlIHRoZSBTeW1mb255IHRvb2xiYXJcbiAgICBlLnRhcmdldC5xdWVyeVNlbGVjdG9yKCcuc2YtdG9vbGJhcicpPy5yZW1vdmUoKTtcbn0pO1xuIl0sIm5hbWVzIjpbIkNvbnRyb2xsZXIiLCJ2YWx1ZXMiLCJ0eXBlIiwiU3RyaW5nIiwicmVhZE9ubHkiLCJCb29sZWFuIiwiY29ubmVjdCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiZWxlbWVudCIsImNsYXNzTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiLCJuZXh0U2libGluZyIsInN0eWxlIiwiZWRpdG9yIiwiYWNlIiwiZWRpdCIsImdldFNlc3Npb24iLCJzZXRWYWx1ZSIsInZhbHVlIiwib24iLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJnZXRWYWx1ZSIsImNvbW1hbmRzIiwiYmluZEtleSIsImNvbmZpZ0NhbGxiYWNrIiwic2V0TWF4TGluZXMiLCJhZGRFdmVudExpc3RlbmVyIiwiYmluZCIsImRpc2Nvbm5lY3QiLCJkZXN0cm95IiwicmVtb3ZlIiwiYmVmb3JlQ2FjaGUiLCJjb2xvckNoYW5nZSIsImV2ZW50Iiwic2V0VGhlbWUiLCJkZXRhaWwiLCJtb2RlIiwic2V0T3B0aW9uIiwiTWF0aCIsImZsb29yIiwiaW5uZXJIZWlnaHQiLCJsaW5lSGVpZ2h0IiwiQmFja2VuZFNlYXJjaENvbnRyb2xsZXIiLCJ0YXJnZXRzIiwicm91dGUiLCJtaW5DaGFyYWN0ZXJzIiwiTnVtYmVyIiwiZGVmYXVsdCIsImRlbGF5IiwiY2xhc3NlcyIsImFjdGl2ZSIsInRpbWVvdXQiLCJzZXRTdGF0ZSIsInBlcmZvcm1TZWFyY2giLCJpbnB1dFRhcmdldCIsImxlbmd0aCIsIm1pbkNoYXJhY3RlcnNWYWx1ZSIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJsb2FkUmVzdWx0cyIsImRlbGF5VmFsdWUiLCJmZXRjaCIsInNlYXJjaFJvdXRlIiwidGhlbiIsInJlcyIsIm9rIiwiRXJyb3IiLCJzdGF0dXNUZXh0IiwidGV4dCIsImh0bWwiLCJyZXN1bHRzVGFyZ2V0IiwiaW5uZXJIVE1MIiwiY2F0Y2giLCJlIiwib3BlbiIsImNsb3NlIiwiYmx1ciIsIl9yZXNldEZvY3VzYWJsZVJlc3VsdHMiLCJpbnB1dEJsdXIiLCJzdGF0ZSIsImZvY3VzVHJhcE5leHQiLCJhY3RpdmVFbGVtZW50IiwibGFzdEZvY3VzIiwicHJldmVudERlZmF1bHQiLCJmaXJzdEZvY3VzIiwiZm9jdXMiLCJmb2N1c1RyYXBQcmV2IiwiX3NldEZvY3VzYWJsZVJlc3VsdHMiLCJlbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkb2N1bWVudENsaWNrIiwiY29udGFpbnMiLCJ0YXJnZXQiLCJmb3JFYWNoIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicm91dGVWYWx1ZSIsIkNob2ljZXNDb250cm9sbGVyIiwibXV0YXRpb25HdWFyZCIsIl9pc0d1YXJkZWQiLCJfc2V0R3VhcmQiLCJzZWxlY3QiLCJjaG9pY2VzIiwiQ2hvaWNlcyIsInNob3VsZFNvcnQiLCJkdXBsaWNhdGVJdGVtc0FsbG93ZWQiLCJhbGxvd0hUTUwiLCJyZW1vdmVJdGVtQnV0dG9uIiwic2VhcmNoRW5hYmxlZCIsIm9wdGlvbnMiLCJjbGFzc05hbWVzIiwiY29udGFpbmVyT3V0ZXIiLCJBcnJheSIsImZyb20iLCJmbGlwcGVkU3RhdGUiLCJmdXNlT3B0aW9ucyIsImluY2x1ZGVTY29yZSIsInRocmVzaG9sZCIsImNhbGxiYWNrT25Jbml0IiwiY2xvc2VzdCIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhc2V0IiwicGxhY2Vob2xkZXIiLCJfcmVzZXRHdWFyZCIsImxvYWRpbmdUZXh0IiwiQ29udGFvIiwibGFuZyIsImxvYWRpbmciLCJub1Jlc3VsdHNUZXh0Iiwibm9SZXN1bHRzIiwibm9DaG9pY2VzVGV4dCIsIm5vT3B0aW9ucyIsInJlbW92ZUl0ZW1MYWJlbFRleHQiLCJyZW1vdmVJdGVtIiwiY29uY2F0IiwiX3JlbW92ZUNob2ljZXMiLCJjb250ZW50Iiwid3JpdGUiLCJuYXZpZ2F0b3IiLCJjbGlwYm9hcmQiLCJ3cml0ZVRleHQiLCJjb250ZW50VmFsdWUiLCJjbGlwYm9hcmRGYWxsYmFjayIsImlucHV0IiwiYm9keSIsImFwcGVuZENoaWxkIiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJleGVjQ29tbWFuZCIsInJlbW92ZUNoaWxkIiwiQ29sb3JQaWNrZXIiLCJvblNhdmUiLCJjb2xvciIsInRvSEVYQSIsInRvU3RyaW5nIiwiY2hhckF0Iiwic3Vic3RyaW5nIiwidG9Mb3dlckNhc2UiLCJwaWNrZXIiLCJoaWRlIiwicHJlZmVyc0RhcmsiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJzZXRDb2xvclNjaGVtZSIsImRvY3VtZW50RWxlbWVudCIsImNvbG9yU2NoZW1lIiwiaTE4biIsIk9iamVjdCIsImxpZ2h0IiwiZGFyayIsImluaXRpYWxpemUiLCJzZXRMYWJlbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJpc0RhcmsiLCJzZXRJdGVtIiwiZGlzcGF0Y2giLCJoYXNMYWJlbFRhcmdldCIsImxhYmVsIiwiaTE4blZhbHVlIiwibGFiZWxUYXJnZXQiLCJ0aXRsZSIsImlubmVyVGV4dCIsIlR1cmJvIiwiYWZ0ZXJMb2FkIiwiaWRlbnRpZmllciIsInNldHVwQ29udHJvbGxlciIsImVsIiwicHJpbWFyeSIsInNlY29uZGFyeSIsInNldEF0dHJpYnV0ZSIsImNvbnRyb2xsZXIiLCJUaGVtZSIsInNldHVwQ3RybENsaWNrIiwiY29uc29sZSIsIndhcm4iLCJoYW5kbGUiLCJpc1ZhbGlkIiwicHJpbWFyeUtleSIsInBsYXRmb3JtIiwic3RhcnRzV2l0aCIsInNoaWZ0S2V5IiwiaGFzUHJpbWFyeVRhcmdldCIsInByaW1hcnlUYXJnZXQiLCJocmVmIiwidmlzaXQiLCJoYXNTZWNvbmRhcnlUYXJnZXQiLCJzZWNvbmRhcnlUYXJnZXQiLCJwb2ludGVyVHlwZSIsIiR0aW1lciIsImdldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInZpc2l0UHJpbWFyeSIsInZpc2l0U2Vjb25kYXJ5IiwidGFnTmFtZSIsImNvbmZpZyIsInVwZGF0ZVdpemFyZCIsImNhbkVkaXQiLCJidXR0b25UYXJnZXQiLCJjb25maWdWYWx1ZSIsImRpc2FibGVkIiwiaW1hZ2VUYXJnZXRzIiwiaW1nIiwic3JjIiwiaWNvbiIsImljb25EaXNhYmxlZCIsIm9wZW5Nb2RhbCIsIkJhY2tlbmQiLCJvcGVuTW9kYWxJZnJhbWUiLCJ1cmwiLCJzZWxlY3RUYXJnZXQiLCJpZHMiLCJpbmNsdWRlcyIsInNlY3Rpb25UYXJnZXRDb25uZWN0ZWQiLCJyZWJ1aWxkTmF2aWdhdGlvbiIsInNlY3Rpb25UYXJnZXREaXNjb25uZWN0ZWQiLCJoYXNOYXZpZ2F0aW9uVGFyZ2V0IiwibGlua3MiLCJzZWN0aW9uVGFyZ2V0cyIsImFjdGlvbiIsInNjcm9sbEludG9WaWV3IiwibGkiLCJhcHBlbmQiLCJuYXZpZ2F0aW9uVGFyZ2V0IiwicmVwbGFjZUNoaWxkcmVuIiwibWF4IiwiZXhwYW5kIiwiY29sbGFwc2UiLCJleHBhbmRBbGwiLCJleHBhbmRBbGxUaXRsZSIsImNvbGxhcHNlQWxsIiwiY29sbGFwc2VBbGxUaXRsZSIsInRvZ2dsZXJNYXAiLCJXZWFrTWFwIiwibmV4dElkIiwib3BlcmF0aW9uVGFyZ2V0Q29ubmVjdGVkIiwidXBkYXRlT3BlcmF0aW9uIiwibm9kZVRhcmdldENvbm5lY3RlZCIsIm5vZGUiLCJnZXRDb21wdXRlZFN0eWxlIiwicGFkZGluZyIsInBhcnNlRmxvYXQiLCJwYWRkaW5nVG9wIiwicGFkZGluZ0JvdHRvbSIsImhlaWdodCIsImNsaWVudEhlaWdodCIsIm1heFZhbHVlIiwib3ZlcmZsb3ciLCJtYXhIZWlnaHQiLCJidXR0b24iLCJleHBhbmRWYWx1ZSIsImFkZCIsInRvZ2dsZXIiLCJzZXQiLCJub2RlVGFyZ2V0RGlzY29ubmVjdGVkIiwiaGFzIiwiZ2V0IiwiZGVsZXRlIiwiY29sbGFwc2VWYWx1ZSIsInRvZ2dsZUFsbCIsImlzRXhwYW5kZWQiLCJoYXNFeHBhbmRlZCIsImFsdEtleSIsIm5vZGVUYXJnZXRzIiwia2V5cHJlc3MiLCJoYXNPcGVyYXRpb25UYXJnZXQiLCJoYXNUb2dnbGVycyIsImZpbmQiLCJleHBhbmRlZCIsIm9wZXJhdGlvblRhcmdldCIsImRpc3BsYXkiLCJtYXAiLCJqb2luIiwiY29sbGFwc2VBbGxWYWx1ZSIsImNvbGxhcHNlQWxsVGl0bGVWYWx1ZSIsImV4cGFuZEFsbFZhbHVlIiwiZXhwYW5kQWxsVGl0bGVWYWx1ZSIsImlucHV0VGFyZ2V0cyIsIkFjY2Vzc2libGVNZW51IiwiT3BlcmF0aW9uc01lbnVDb250cm9sbGVyIiwiaGFzQ29udHJvbGxlclRhcmdldCIsImhhc01lbnVUYXJnZXQiLCIkbWVudSIsIkRpc2Nsb3N1cmVNZW51IiwibWVudUVsZW1lbnQiLCJtZW51VGFyZ2V0IiwibWVudUxpbmtTZWxlY3RvciIsImNvbnRyb2xsZXJUYXJnZXQiLCJtZW51cyIsIm1lbnUiLCJzdWJtZW51VG9nZ2xlcyIsImlzT3BlbiIsInNldEZpeGVkUG9zaXRpb24iLCJrZXkiLCJlbnRyaWVzIiwidGl0bGVUYXJnZXRDb25uZWN0ZWQiLCJsaW5rIiwiaXNJbnRlcmFjdGl2ZSIsInN0b3BQcm9wYWdhdGlvbiIsInJlY3QiLCJzdWJtZW51VGFyZ2V0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsInkiLCJvZmZzZXQiLCJjbGllbnRYIiwiY2xpZW50WSIsInIiLCJwb3NpdGlvbiIsInJpZ2h0IiwidG9wIiwiaW5uZXJXaWR0aCIsIndpZHRoIiwibGVmdCIsIkhUTUxJbWFnZUVsZW1lbnQiLCJIVE1MQW5jaG9yRWxlbWVudCIsIkhUTUxCdXR0b25FbGVtZW50IiwicGFyZW50IiwicGFyZW50RWxlbWVudCIsIm5hbWVJbnB1dFRhcmdldENvbm5lY3RlZCIsImNhbmNlbEVkaXQiLCJuYW1lSW5wdXRUYXJnZXQiLCJmb3JtVGFyZ2V0IiwicmVxdWVzdFN1Ym1pdCIsIm5hbWUiLCJidXR0b25UYXJnZXRDb25uZWN0ZWQiLCJuYW1lVmFsdWUiLCJtZW51VGFyZ2V0Q29ubmVjdGVkIiwic2Vzc2lvbktleSIsImJlaGF2aW9yIiwiYmxvY2siLCJhcHBsaWNhdGlvbiIsImxvYWRGYWxsYmFjayIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyIiwiY29udHJvbGxlckF0dHJpYnV0ZSIsInNjaGVtYSIsImluaXRTY3JvbGxPZmZzZXQiLCJnZXRTY3JvbGxPZmZzZXQiLCJkaXNjYXJkIiwic3RvcmUiLCJyZXN0b3JlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2Nyb2xsVG8iLCJiZWhhdmlvclZhbHVlIiwiYmxvY2tWYWx1ZSIsInNjcm9sbFRvVGFyZ2V0Q29ubmVjdGVkIiwic2Nyb2xsVG9UYXJnZXQiLCJhdXRvRm9jdXNUYXJnZXRDb25uZWN0ZWQiLCJhdXRvRm9jdXMiLCJhdXRvRm9jdXNUYXJnZXQiLCJyZWFkb25seSIsIm9mZnNldFdpZHRoIiwib2Zmc2V0SGVpZ2h0IiwiYXV0b2NvbXBsZXRlIiwid2lkZ2V0RXJyb3JUYXJnZXRDb25uZWN0ZWQiLCJ3aWRnZXRFcnJvclRhcmdldCIsInNjcm9sbFRvcCIsInNjcm9sbFRvV2lkZ2V0RXJyb3IiLCJoYXNXaWRnZXRFcnJvclRhcmdldCIsInNlc3Npb25TdG9yYWdlIiwic2Vzc2lvbktleVZhbHVlIiwicGFyc2VJbnQiLCJ1bmRlZmluZWQiLCJUYWJzQ29udHJvbGxlciIsImNsb3NlTGFiZWwiLCJhY3RpdmVUYWIiLCJwYW5lbFRhcmdldENvbm5lY3RlZCIsInBhbmVsIiwiaXNSZXN0b3JlIiwidGFiSWQiLCJyYW5kb20iLCJjb250YWluZXJJZCIsInBhbmVsUmVmZXJlbmNlIiwiY29udHJvbFJlZmVyZW5jZSIsInNlbGVjdEJ1dHRvbiIsInNlbGVjdFRhYiIsImNsb3NlQnV0dG9uIiwiY2xvc2VMYWJlbFZhbHVlIiwicGFuZWxUYXJnZXREaXNjb25uZWN0ZWQiLCJnZXRFbGVtZW50QnlJZCIsImhhc1BhbmVsVGFyZ2V0IiwicGFuZWxUYXJnZXQiLCJwYW5lbFRhcmdldHMiLCJpc1RhcmdldCIsInRvZ2dsZUF0dHJpYnV0ZSIsImdldEFjdGl2ZVRhYiIsImdldFRhYnMiLCJyZWR1Y2UiLCJyZXN1bHQiLCJUd2lnRWRpdG9yIiwiZWRpdG9ycyIsIk1hcCIsImZvbGxvd1VybCIsImJsb2NrSW5mb1VybCIsIl92aXNpdCIsImZvbGxvd1VybFZhbHVlIiwiYmxvY2tJbmZvVXJsVmFsdWUiLCJ0aGVtZVNlbGVjdG9yVGFyZ2V0IiwiX2FkZE9wZW5FZGl0b3JUYWJzVG9SZXF1ZXN0IiwiZm9ybVN1Ym1pc3Npb24iLCJzdWJtaXR0ZXIiLCJvcGVyYXRpb24iLCJfYWRkRWRpdG9yQ29udGVudFRvUmVxdWVzdCIsIl9nZXRBY3RpdmVNdXRhYmxlRWRpdG9yIiwiZWRpdG9yVGFyZ2V0Q29ubmVjdGVkIiwiZWRpdG9yVGFyZ2V0RGlzY29ubmVjdGVkIiwiZWRpdG9yQW5ub3RhdGlvbnNUYXJnZXRDb25uZWN0ZWQiLCJzZXRBbm5vdGF0aW9uc0RhdGEiLCJKU09OIiwicGFyc2UiLCJkaWFsb2dUYXJnZXRDb25uZWN0ZWQiLCJzaG93TW9kYWwiLCJzZWFyY2hQYXJhbXMiLCJsb2NhdGlvbiIsInRhYnMiLCJ0YWJzVGFyZ2V0Iiwia2V5cyIsImZldGNoUmVxdWVzdCIsImdldENvbnRlbnQiLCJlZGl0b3JFbGVtZW50c09uQWN0aXZlVGFiIiwiaXNFZGl0YWJsZSIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInJlc3BvbnNlIiwibWV0aG9kIiwiaGVhZGVycyIsInJlZGlyZWN0ZWQiLCJzdGF0dXMiLCJlcnJvciIsInJlbmRlclN0cmVhbU1lc3NhZ2UiLCJ0aW55bWNlQ29uZmlnIiwidGlueW1jZSIsImluaXQiLCJlZGl0b3JJZCIsImxlYXZlIiwicGx1Z2lucyIsImhhc093blByb3BlcnR5IiwiaXNOb3REaXJ0eSIsImRlbGVnYXRlIiwiY3JlYXRlRXZlbnQiLCJpbml0RXZlbnQiLCJjb25maXJtIiwicmV0dXJuVmFsdWUiLCJ0YWJsZSIsImFkZENvbnRyb2xsZXIiLCJmcyIsIm1pZ3JhdGVMZWdhY3kiLCJBamF4UmVxdWVzdCIsInRvZ2dsZUZpZWxkc2V0IiwicmVhZHlTdGF0ZSIsImNvbGxhcHNlZENsYXNzIiwic2V0QXJpYUV4cGFuZGVkIiwic3RvcmVTdGF0ZSIsImZvcm0iLCJpIiwiY2hlY2tWYWxpZGl0eSIsImNsaWNrIiwiaGFzSWRWYWx1ZSIsImhhc1RhYmxlVmFsdWUiLCJpZFZhbHVlIiwidGFibGVWYWx1ZSIsImFyaWFFeHBhbmRlZCIsInJlcXVlc3RUb2tlbiIsImV4cGFuZFRpdGxlIiwiY29sbGFwc2VUaXRsZSIsIl9yZWYiLCJjdXJyZW50VGFyZ2V0IiwiY2F0ZWdvcnkiLCJjb2xsYXBzZWQiLCJleHBhbmRUaXRsZVZhbHVlIiwiY29sbGFwc2VUaXRsZVZhbHVlIiwic2VuZFJlcXVlc3QiLCJ1cmxWYWx1ZSIsIlJFUVVFU1RfVE9LRU4iLCJyZXF1ZXN0VG9rZW5WYWx1ZSIsInRvZ2dsZUFjdGlvbiIsImxvYWRBY3Rpb24iLCJyZWZlcmVySWQiLCJjaGlsZFRhcmdldENvbm5lY3RlZCIsInRvZ2dsZVRvZ2dsZXIiLCJsZXZlbCIsImZvbGRlciIsIml0ZW0iLCJzaG93Q2hpbGQiLCJleHBhbmRUb2dnbGVyIiwidXBkYXRlU3RhdGUiLCJoaWRlQ2hpbGQiLCJjb2xsYXBzZVRvZ2dsZXIiLCJmZXRjaENoaWxkIiwiaGFzQXR0cmlidXRlIiwiZ2V0RWxlbWVudHMiLCJpbWFnZSIsImFsdCIsImxvYWRUb2dnbGVyIiwiZW5hYmxlZCIsIlVSTCIsInNlYXJjaCIsInJlZmVyZXJJZFZhbHVlIiwibG9hZEFjdGlvblZhbHVlIiwidHh0IiwidWwiLCJtb2RlVmFsdWUiLCJhZnRlciIsImlzRm9sZGVyIiwibmV4dCIsInR5cGVPZiIsIm5leHRFbGVtZW50U2libGluZyIsImJlZm9yZSIsIkN1c3RvbUV2ZW50IiwiZmlyZUV2ZW50IiwiaGFzRXhwYW5kZWRSb290IiwidXBkYXRlQWxsU3RhdGUiLCJ0b2dnbGVUYXJnZXRzIiwiY2hpbGRUYXJnZXRzIiwicHJvbWlzZXMiLCJwdXNoIiwiYWxsIiwidG9nZ2xlQWN0aW9uVmFsdWUiLCJyb290Q2hpbGRUYXJnZXRzIiwiVG9vbHRpcHNDb250cm9sbGVyIiwiZGVmYXVsdE9wdGlvbnNNYXAiLCJ1c2VDb250ZW50IiwiYWN0aXZlVGFyZ2V0cyIsIlNldCIsInJlbW92ZUNsaWNrVGFyZ2V0SGFuZGxlckRlbGVnYXRlcyIsInRvb2x0aXAiLCJfY3JlYXRlVGlwQ29udGFpbmVyIiwidG9vbHRpcFRhcmdldENvbm5lY3RlZCIsIl9zaG93VG9vbHRpcCIsIl9oaWRlVG9vbHRpcCIsImNsaWNrVGFyZ2V0IiwiaGFuZGxlciIsInRvb2x0aXBUYXJnZXREaXNjb25uZWN0ZWQiLCJ0b3VjaFN0YXJ0IiwiZmlsdGVyIiwiYXJndW1lbnRzIiwiX2dldE9wdGlvbnNGb3JFbGVtZW50IiwicmVwbGFjZSIsInRpbWVyIiwid2lsbENoYW5nZSIsInJ0bCIsImRpcmVjdGlvbiIsImNsaWVudFdpZHRoIiwic2Nyb2xsWCIsInNjcm9sbFkiLCJjcml0ZXJpYSIsImRlZmF1bHRPcHRpb25zIiwibWF0Y2giLCJ0YXJnZXRTZWxlY3RvcnMiLCJtaWdyYXRlVGFyZ2V0Iiwic2VsIiwiTXV0YXRpb25PYnNlcnZlciIsIm11dGF0aW9uc0xpc3QiLCJtdXRhdGlvbiIsImFkZGVkTm9kZXMiLCJIVE1MRWxlbWVudCIsIm9ic2VydmUiLCJjaGlsZExpc3QiLCJzdWJ0cmVlIiwidW5zdXBwb3J0ZWRNZXNzYWdlIiwiYXNzZXJ0aW9uRmFpbHVyZU1lc3NhZ2UiLCJhdHRlc3RhdGlvbkZhaWx1cmVNZXNzYWdlIiwib3B0aW9uc0ZhaWx1cmVNZXNzYWdlIiwiY3NyZlVybCIsImhhbmRsZVVuc3VwcG9ydGVkIiwibWVzc2FnZVRhcmdldCIsInJlbmRlck1lc3NhZ2UiLCJ1bnN1cHBvcnRlZE1lc3NhZ2VWYWx1ZSIsImhhbmRsZUFzc2VydGlvbkZhaWx1cmUiLCJhc3NlcnRpb25GYWlsdXJlTWVzc2FnZVZhbHVlIiwiaGFuZGxlQXR0ZXN0YXRpb25GYWlsdXJlIiwiYXR0ZXN0YXRpb25GYWlsdXJlTWVzc2FnZVZhbHVlIiwiaGFuZGxlT3B0aW9uc0ZhaWx1cmUiLCJvcHRpb25zRmFpbHVyZU1lc3NhZ2VWYWx1ZSIsImxvYWRDc3JmIiwiY3NyZlNjcmlwdCIsImNzcmZVcmxWYWx1ZSIsImFzeW5jIiwibWVzc2FnZSIsImNvbnN0cnVjdG9yIiwiY29udGFpbmVyQmFja3VwIiwiY2xvbmVOb2RlIiwicmVzb3VyY2VVcmwiLCJtYXhMaW5lcyIsIndyYXAiLCJ1c2VTb2Z0VGFicyIsImF1dG9TY3JvbGxFZGl0b3JJbnRvVmlldyIsImVuYWJsZUxpdmVBdXRvY29tcGxldGlvbiIsImVuYWJsZUtleWJvYXJkQWNjZXNzaWJpbGl0eSIsIndoaXRlc3BhY2UiLCJyZXF1aXJlIiwiZGV0ZWN0SW5kZW50YXRpb24iLCJhZGRDb21tYW5kIiwiZXhlYyIsImFyZ3MiLCJidWJibGVzIiwib25jZSIsInJlZ2lzdGVyQ29kZUxlbnNQcm92aWRlciIsImNvZGVMZW5zIiwicHJvdmlkZUNvZGVMZW5zZXMiLCJzZXNzaW9uIiwiY2FsbGJhY2siLCJkZXN0cm95ZWQiLCJwYXlsb2FkIiwiYW5hbHl6ZVJlZmVyZW5jZXMiLCJyZWZlcmVuY2UiLCJzdGFydCIsInJvdyIsImNvbHVtbiIsImNvbW1hbmQiLCJhbmFseXplQmxvY2tzIiwicmVmZXJlbmNlcyIsImdldExlbmd0aCIsInRva2VucyIsImdldFRva2VucyIsInRlc3QiLCJibG9ja3MiLCJkYXRhIiwiY29tcGxldGVycyIsImdldENvbXBsZXRpb25zIiwicG9zIiwicHJlZml4Iiwic2V0QW5ub3RhdGlvbnMiLCJsaW5lIiwiZ2V0UmVhZE9ubHkiLCJ0ZXh0Q29udGVudCIsInJlcGxhY2VXaXRoIiwidG9nZ2xlTmF2aWdhdGlvbiIsIiQiLCJnZXRQYXJlbnQiLCJoYXNDbGFzcyIsInJlbW92ZUNsYXNzIiwiUmVxdWVzdCIsInBvc3QiLCJyZXF1ZXN0X3Rva2VuIiwiYWRkQ2xhc3MiLCJ0b2dnbGVTdHJ1Y3R1cmUiLCJnZXRTdHlsZSIsInNldFN0eWxlIiwiZmllbGQiLCJldmFsU2NyaXB0cyIsIm9uUmVxdWVzdCIsImRpc3BsYXlCb3giLCJvblN1Y2Nlc3MiLCJFbGVtZW50IiwiaW5qZWN0IiwiZ2V0TmV4dCIsImVhY2giLCJyZWZlcmVyX2lkIiwiaGlkZUJveCIsInRvZ2dsZUZpbGVNYW5hZ2VyIiwidG9nZ2xlU3VicGFsZXR0ZSIsImNoZWNrZWQiLCJ1cGRhdGVWZXJzaW9uTnVtYmVyIiwianNvbiIsImRpdiIsImphdmFzY3JpcHQiLCJzdHIiLCJBc3NldCIsIm9uTG9hZCIsIkJyb3dzZXIiLCJmaWVsZHMiLCJWRVJTSU9OX05VTUJFUiIsInRvZ2dsZUZpZWxkIiwicm93SWNvbiIsImljb25Pbmx5IiwiaW1hZ2VzIiwicHVibGlzaGVkIiwicGEiLCJnZXRQcmV2aW91cyIsImdldEZpcnN0IiwiZ2V0RWxlbWVudCIsImluZGV4T2YiLCJuZXdTcmMiLCJzbGljZSIsImxhc3RJbmRleE9mIiwiY2hpbGROb2RlcyIsImNoaWxkIiwiVGV4dCIsIm5vZGVWYWx1ZSIsInRyaW0iLCJjbG9uZSIsInRvZ2dsZUNoZWNrYm94R3JvdXAiLCJib3giLCJvdmVybGF5Iiwic2Nyb2xsIiwiZ2V0U2Nyb2xsIiwiY3VycmVudElkIiwicG9wdXBXaW5kb3ciLCJ0aGVtZVBhdGgiLCJzY3JpcHRfdXJsIiwidGhlbWUiLCJvcGVuTW9kYWxXaW5kb3ciLCJTaW1wbGVNb2RhbCIsIm9uU2hvdyIsIm9uSGlkZSIsInNob3ciLCJvcGVuTW9kYWxJbWFnZSIsIm9wdCIsIm1heFdpZHRoIiwiZ2V0U2l6ZSIsInRvSW50IiwibWluIiwiTSIsIm9wZW5Nb2RhbFNlbGVjdG9yIiwiYWRkQnV0dG9uIiwiY2FuY2VsIiwiYnV0dG9ucyIsImFwcGx5IiwiZnJtIiwiZnJhbWVzIiwidmFsIiwiaW5wIiwicGlja2VyVmFsdWUiLCJzSW5kZXgiLCJhbGVydCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwic3BsaWNlIiwib3Blbk1vZGFsQnJvd3NlciIsImZpZWxkX25hbWUiLCJ3aW4iLCJzb3VyY2UiLCJyb3V0ZXMiLCJiYWNrZW5kX3BpY2tlciIsImF1dG9TdWJtaXQiLCJoaWRkZW4iLCJzdWJtaXQiLCJ2U2Nyb2xsVG8iLCJhZGRFdmVudCIsInRvZ2dsZUNoZWNrYm94ZXMiLCJpdGVtcyIsIiQkIiwic3Vic3RyIiwiY2xzIiwiY2J4IiwiY2hlY2tib3giLCJ0b2dnbGVDaGVja2JveEVsZW1lbnRzIiwibWFrZVBhcmVudFZpZXdTb3J0YWJsZSIsImRzIiwiU2Nyb2xsZXIiLCJvbkNoYW5nZSIsImxpc3QiLCJTb3J0YWJsZXMiLCJjb25zdHJhaW4iLCJvcGFjaXR5Iiwib25TdGFydCIsIm9uQ29tcGxldGUiLCJzdG9wIiwib25Tb3J0Iiwid3JhcExldmVsIiwiZGl2cyIsImdldENoaWxkcmVuIiwicGlkIiwibWFrZU11bHRpU3JjU29ydGFibGUiLCJvaWQiLCJlbHMiLCJsaXMiLCJzcGxpdCIsImoiLCJkaWQiLCJkaXNwb3NlIiwiZW5hYmxlRmlsZVRyZWVEcmFnQW5kRHJvcCIsImRyYWdIYW5kbGUiLCJkcmFnRWxlbWVudCIsInJpZ2h0Q2xpY2siLCJjbG9uZUJhc2UiLCJjdXJyZW50SG92ZXIiLCJjdXJyZW50SG92ZXJUaW1lIiwiZXhwYW5kTGluayIsInNldFBvc2l0aW9uIiwicGFnZSIsImdldE9mZnNldFBhcmVudCIsImdldFBvc2l0aW9uIiwibW92ZSIsIkRyYWciLCJNb3ZlIiwiZHJvcHBhYmxlcyIsInVuRHJhZ2dhYmxlVGFncyIsIm1vZGlmaWVycyIsIm9uRW50ZXIiLCJkcm9wcGFibGUiLCJmaXhEcm9wcGFibGUiLCJEYXRlIiwiZ2V0VGltZSIsIm9uQWpheCIsInJlbW92ZUV2ZW50Iiwib25DYW5jZWwiLCJvbktleXVwIiwib25Ecm9wIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwib25MZWF2ZSIsImxpc3RXaXphcmQiLCJtYWtlU29ydGFibGUiLCJhZGRFdmVudHNUbyIsInByZXZpb3VzIiwiYnQiLCJoYXNFdmVudCIsImdldFByb3BlcnR5Iiwia2V5Q29kZSIsInRhYmxlV2l6YXJkIiwidGhlYWQiLCJ0Ym9keSIsInJvd3MiLCJ0ZXh0YXJlYSIsImNoaWxkcmVuIiwidHIiLCJoZWFkIiwiY3VycmVudCIsIm50ciIsImluZGV4IiwiZ2V0SW5kZXgiLCJoZWFkRmlyc3QiLCJnZXRMYXN0IiwidGQiLCJjb2xzIiwidGFibGVXaXphcmRSZXNpemUiLCJmYWN0b3IiLCJzaXplIiwicm91bmQiLCJsaW1pdCIsImNodW5rcyIsInRhYmxlV2l6YXJkU2V0V2lkdGgiLCJnZXRDb21wdXRlZFNpemUiLCJvcHRpb25zV2l6YXJkIiwia2V5VmFsdWVXaXphcmQiLCJjaGVja2JveFdpemFyZCIsInNwYW4iLCJuc3BhbiIsImVuYWJsZUltYWdlU2l6ZVdpZGdldHMiLCJ3aWR0aElucHV0IiwiaGVpZ2h0SW5wdXQiLCJ1cGRhdGUiLCJkaW1lbnNpb25zIiwiZ2V0U2VsZWN0ZWQiLCJlbmFibGVUb2dnbGVTZWxlY3QiLCJzaGlmdFRvZ2dsZSIsInRoaXNJbmRleCIsImNoZWNrYm94ZXMiLCJzdGFydEluZGV4IiwidG8iLCJjbGlja0V2ZW50IiwibGltaXRUb2dnbGVyIiwic2hpZnQiLCJib3VuZEV2ZW50IiwicmV0cmlldmUiLCJlZGl0UHJldmlld1dpemFyZCIsImltYWdlRWxlbWVudCIsImlucHV0RWxlbWVudHMiLCJpc0RyYXdpbmciLCJwYXJ0RWxlbWVudCIsInN0YXJ0UG9zIiwiZ2V0U2NhbGUiLCJ1cGRhdGVJbWFnZSIsInNjYWxlIiwiaW1hZ2VTaXplIiwic2V0U3R5bGVzIiwiY29tcHV0ZWRUb3AiLCJjb21wdXRlZExlZnQiLCJ0b0Zsb2F0IiwidXBkYXRlVmFsdWVzIiwic3R5bGVzIiwiZ2V0U3R5bGVzIiwidG9GaXhlZCIsImFicyIsImNhcGl0YWxpemUiLCJhZGRFdmVudHMiLCJtb3VzZWRvd24iLCJ0b3VjaHN0YXJ0IiwibW91c2Vtb3ZlIiwidG91Y2htb3ZlIiwibW91c2V1cCIsInRvdWNoZW5kIiwidG91Y2hjYW5jZWwiLCJyZXNpemUiLCJlbmFibGVGaWxlVHJlZVVwbG9hZCIsImZhbGxiYWNrVXJsIiwiZHpFbGVtZW50IiwicHJldmlld3NDb250YWluZXIiLCJjbGlja2FibGUiLCJkeiIsIkRyb3B6b25lIiwicmVsb2FkIiwiZGF0YVRyYW5zZmVyIiwidHlwZXMiLCJjcmF3bCIsInByb2dyZXNzQmFyIiwicHJvZ3Jlc3NDb3VudCIsInJlc3VsdHMiLCJkZWJ1Z0xvZyIsInVwZGF0ZURhdGEiLCJ0b3RhbCIsImRvbmUiLCJwZW5kaW5nIiwicGVyY2VudGFnZSIsImhhc0RlYnVnTG9nIiwiZmluaXNoZWQiLCJzdW1tYXJ5Iiwid2FybmluZyIsImxvZyIsInN1YnNjcmliZXJSZXN1bHRzIiwic3Vic2NyaWJlclN1bW1hcnkiLCJoYXNMb2ciLCJ3YXNTdWNjZXNzZnVsIiwiZXhlY1JlcXVlc3QiLCJvbmx5U3RhdHVzVXBkYXRlIiwicmVzcG9uc2VUZXh0IiwiZGVjb2RlIiwic2VuZCIsImlzV2Via2l0IiwiY2hyb21lIiwic2FmYXJpIiwidXNlckFnZW50Iiwic3RvcENsaWNrUHJvcGFnYXRpb24iLCJzZXR1cFRleHRhcmVhUmVzaXppbmciLCJpZTYiLCJpZTciLCJpZTgiLCJkdW1teSIsInR3ZWVuIiwic2V0dXBNZW51VG9nZ2xlIiwiYnVyZ2VyIiwidG9nZ2xlQ2xhc3MiLCJzZXRBcmlhQ29udHJvbHMiLCJzZXR1cFByb2ZpbGVUb2dnbGUiLCJ0bWVudSIsInNldHVwU3BsaXRCdXR0b25Ub2dnbGUiLCJ0YWIiLCJGZWF0dXJlcyIsIlRvdWNoIiwiaGd0IiwiaW5pdGlhbGl6ZWRSb3dzIiwic2F2ZVNjcm9sbE9mZnNldEV2ZW50Iiwic2VsZWN0cyIsIm5zZWxlY3RzIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNvZGUiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ1cGRhdGVMaW5rIiwiYXR0cmlidXRlcyIsIkNsYXNzIiwiRXh0ZW5kcyIsImZvbGxvd1JlZGlyZWN0cyIsInN1Y2Nlc3MiLCJnZXRIZWFkZXIiLCJzZWN1cmUiLCJzdHJpcFNjcmlwdHMiLCJzY3JpcHQiLCJmYWlsdXJlIiwib25GYWlsdXJlIiwicmVmYWN0b3IiLCJhdHRhY2giLCJoYW5kbGVzIiwiYm91bmQiLCJkZXRhY2giLCJjaGVjayIsImRpc3RhbmNlIiwic3FydCIsInBvdyIsIm1vdXNlIiwic25hcCIsImRyYWciLCJyZW1vdmVFdmVudHMiLCJsaXN0cyIsImRyYWdPcHRpb25zIiwibWVyZ2UiLCJ0YWciLCJhZGRJdGVtcyIsImZsYXR0ZW4iLCJjYWxsIiwicmVtb3ZlSXRlbXMiLCJlcmFzZSIsImdldENsb25lIiwiUXVldWUiLCJhdXRvQWR2YW5jZSIsInJlc3VtZSIsInF1ZXVlIiwiaXNSdW5uaW5nIiwic3RvcE9uRmFpbHVyZSIsIm9uRXhjZXB0aW9uIiwiU2VycFByZXZpZXciLCJ0cmFpbCIsInRpdGxlRmllbGQiLCJ0aXRsZUZhbGxiYWNrRmllbGQiLCJhbGlhc0ZpZWxkIiwiZGVzY3JpcHRpb25GaWVsZCIsImRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCIsInRpdGxlVGFnIiwic2hvcnRlbiIsImh0bWwyc3RyaW5nIiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwiZ2V0VGlueW1jZSIsInRpbnlNQ0UiLCJjYWNoZSIsImV4ZW1wdFBhZ2VGcm9tQ2FjaGUiLCJzZXJwVGl0bGUiLCJzZXJwVXJsIiwic2VycERlc2NyaXB0aW9uIiwiaW5kZXhFbXB0eSIsImFjdGl2ZUVkaXRvciIsImJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwiLCJicm93c2VyU3VwcG9ydHNXZWJBdXRobiIsInN0YXJ0QXV0aGVudGljYXRpb24iLCJzdGFydFJlZ2lzdHJhdGlvbiIsImRlZmF1bHRfMSIsIl9hIiwiX2IiLCJyZXF1ZXN0UmVzdWx0VXJsIiwicmVxdWVzdFJlc3VsdFVybFZhbHVlIiwicmVxdWVzdE9wdGlvbnNVcmwiLCJyZXF1ZXN0T3B0aW9uc1VybFZhbHVlIiwicmVxdWVzdFN1Y2Nlc3NSZWRpcmVjdFVyaSIsInJlcXVlc3RTdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSIsImNyZWF0aW9uUmVzdWx0VXJsIiwiY3JlYXRpb25SZXN1bHRVcmxWYWx1ZSIsImNyZWF0aW9uT3B0aW9uc1VybCIsImNyZWF0aW9uT3B0aW9uc1VybFZhbHVlIiwiY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmkiLCJjcmVhdGlvblN1Y2Nlc3NSZWRpcmVjdFVyaVZhbHVlIiwiX2Rpc3BhdGNoRXZlbnQiLCJzdXBwb3J0QXV0b2ZpbGwiLCJ1c2VCcm93c2VyQXV0b2ZpbGxWYWx1ZSIsIm9wdGlvbnNSZXNwb25zZUpzb24iLCJfZ2V0UHVibGljS2V5Q3JlZGVudGlhbFJlcXVlc3RPcHRpb25zIiwiX3Byb2Nlc3NTaWduaW4iLCJzaWduaW4iLCJ1c2VCcm93c2VyQXV0b2ZpbGwiLCJhdXRoZW50aWNhdG9yUmVzcG9uc2UiLCJhc3NlcnRpb25SZXNwb25zZSIsIl9nZXRBc3NlcnRpb25SZXNwb25zZSIsImV4Y2VwdGlvbiIsInNpZ251cCIsIl9nZXRQdWJsaWNLZXlDcmVkZW50aWFsQ3JlYXRpb25PcHRpb25zIiwiYXR0ZXN0YXRpb25SZXNwb25zZUpTT04iLCJfZ2V0QXR0ZXN0YXRpb25SZXNwb25zZSIsIl9nZXREYXRhIiwiRm9ybURhdGEiLCJyZXBvcnRWYWxpZGl0eSIsInJlbW92ZUVtcHR5Iiwib2JqIiwidiIsImFjYyIsIl9yZWYyIiwiayIsImFzc2lnbiIsInVzZXJuYW1lIiwidXNlcm5hbWVGaWVsZFZhbHVlIiwiZGlzcGxheU5hbWUiLCJkaXNwbGF5TmFtZUZpZWxkVmFsdWUiLCJhdHRlc3RhdGlvbiIsImF0dGVzdGF0aW9uRmllbGRWYWx1ZSIsInVzZXJWZXJpZmljYXRpb24iLCJ1c2VyVmVyaWZpY2F0aW9uRmllbGRWYWx1ZSIsInJlc2lkZW50S2V5IiwicmVzaWRlbnRLZXlGaWVsZFZhbHVlIiwiYXV0aGVudGljYXRvckF0dGFjaG1lbnQiLCJhdXRoZW50aWNhdG9yQXR0YWNobWVudEZpZWxkVmFsdWUiLCJmb3JtRGF0YSIsIl9nZXRPcHRpb25zIiwib3B0aW9uc1Jlc3BvbnNlIiwicmVxdWVzdEhlYWRlcnNWYWx1ZSIsInN0cmluZ2lmeSIsIl9nZXRSZXN1bHQiLCJldmVudFByZWZpeCIsImF0dGVzdGF0aW9uUmVzcG9uc2UiLCJ1c2VybmFtZUZpZWxkIiwiZGlzcGxheU5hbWVGaWVsZCIsImF0dGVzdGF0aW9uRmllbGQiLCJ1c2VyVmVyaWZpY2F0aW9uRmllbGQiLCJyZXNpZGVudEtleUZpZWxkIiwiYXV0aGVudGljYXRvckF0dGFjaG1lbnRGaWVsZCIsInJlcXVlc3RIZWFkZXJzIiwiQXBwbGljYXRpb24iLCJkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllciIsImlkZW50aWZpZXJGb3JDb250ZXh0S2V5IiwiV2ViQXV0aG4iLCJkZWJ1ZyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImNvbnRleHQiLCJsb2FkIiwicmVnaXN0ZXIiLCJtb29Eb21yZWFkeSIsIm1vb0RvbXJlYWR5RmlyZWQiLCJFdmVudHMiLCJjb250cm9sbGVycyJdLCJzb3VyY2VSb290IjoiIn0=