/******/ (function() { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./core-bundle/assets/controllers sync recursive \\.js$":
/*!****************************************************!*\
  !*** ./core-bundle/assets/controllers/ sync \.js$ ***!
  \****************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

var map = {
	"./ace-controller.js": "./core-bundle/assets/controllers/ace-controller.js",
	"./backend-search-controller.js": "./core-bundle/assets/controllers/backend-search-controller.js",
	"./choices-controller.js": "./core-bundle/assets/controllers/choices-controller.js",
	"./clipboard-controller.js": "./core-bundle/assets/controllers/clipboard-controller.js",
	"./color-picker-controller.js": "./core-bundle/assets/controllers/color-picker-controller.js",
	"./color-scheme-controller.js": "./core-bundle/assets/controllers/color-scheme-controller.js",
	"./deeplink-controller.js": "./core-bundle/assets/controllers/deeplink-controller.js",
	"./image-size-controller.js": "./core-bundle/assets/controllers/image-size-controller.js",
	"./jump-targets-controller.js": "./core-bundle/assets/controllers/jump-targets-controller.js",
	"./limit-height-controller.js": "./core-bundle/assets/controllers/limit-height-controller.js",
	"./metawizard-controller.js": "./core-bundle/assets/controllers/metawizard-controller.js",
	"./operations-menu-controller.js": "./core-bundle/assets/controllers/operations-menu-controller.js",
	"./passkeys-controller.js": "./core-bundle/assets/controllers/passkeys-controller.js",
	"./profile-controller.js": "./core-bundle/assets/controllers/profile-controller.js",
	"./scroll-offset-controller.js": "./core-bundle/assets/controllers/scroll-offset-controller.js",
	"./tabs-controller.js": "./core-bundle/assets/controllers/tabs-controller.js",
	"./template-studio-controller.js": "./core-bundle/assets/controllers/template-studio-controller.js",
	"./tinymce-controller.js": "./core-bundle/assets/controllers/tinymce-controller.js",
	"./toggle-fieldset-controller.js": "./core-bundle/assets/controllers/toggle-fieldset-controller.js",
	"./toggle-navigation-controller.js": "./core-bundle/assets/controllers/toggle-navigation-controller.js",
	"./toggle-nodes-controller.js": "./core-bundle/assets/controllers/toggle-nodes-controller.js",
	"./tooltips-controller.js": "./core-bundle/assets/controllers/tooltips-controller.js",
	"./webauthn-error-controller.js": "./core-bundle/assets/controllers/webauthn-error-controller.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./core-bundle/assets/controllers sync recursive \\.js$";

/***/ }),

/***/ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js ***!
  \******************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   definitionForModuleAndIdentifier: function() { return /* binding */ definitionForModuleAndIdentifier; },
/* harmony export */   definitionForModuleWithContextAndKey: function() { return /* binding */ definitionForModuleWithContextAndKey; },
/* harmony export */   definitionsFromContext: function() { return /* binding */ definitionsFromContext; },
/* harmony export */   identifierForContextKey: function() { return /* binding */ identifierForContextKey; }
/* harmony export */ });
/*
Stimulus Webpack Helpers 1.0.0
Copyright © 2021 Basecamp, LLC
 */
function definitionsFromContext(context) {
    return context.keys()
        .map((key) => definitionForModuleWithContextAndKey(context, key))
        .filter((value) => value);
}
function definitionForModuleWithContextAndKey(context, key) {
    const identifier = identifierForContextKey(key);
    if (identifier) {
        return definitionForModuleAndIdentifier(context(key), identifier);
    }
}
function definitionForModuleAndIdentifier(module, identifier) {
    const controllerConstructor = module.default;
    if (typeof controllerConstructor == "function") {
        return { identifier, controllerConstructor };
    }
}
function identifierForContextKey(key) {
    const logicalName = (key.match(/^(?:\.\/)?(.+)(?:[_-]controller\..+?)$/) || [])[1];
    if (logicalName) {
        return logicalName.replace(/_/g, "-").replace(/\//g, "--");
    }
}




/***/ }),

/***/ "./node_modules/@hotwired/stimulus/dist/stimulus.js":
/*!**********************************************************!*\
  !*** ./node_modules/@hotwired/stimulus/dist/stimulus.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Application: function() { return /* binding */ Application; },
/* harmony export */   AttributeObserver: function() { return /* binding */ AttributeObserver; },
/* harmony export */   Context: function() { return /* binding */ Context; },
/* harmony export */   Controller: function() { return /* binding */ Controller; },
/* harmony export */   ElementObserver: function() { return /* binding */ ElementObserver; },
/* harmony export */   IndexedMultimap: function() { return /* binding */ IndexedMultimap; },
/* harmony export */   Multimap: function() { return /* binding */ Multimap; },
/* harmony export */   SelectorObserver: function() { return /* binding */ SelectorObserver; },
/* harmony export */   StringMapObserver: function() { return /* binding */ StringMapObserver; },
/* harmony export */   TokenListObserver: function() { return /* binding */ TokenListObserver; },
/* harmony export */   ValueListObserver: function() { return /* binding */ ValueListObserver; },
/* harmony export */   add: function() { return /* binding */ add; },
/* harmony export */   defaultSchema: function() { return /* binding */ defaultSchema; },
/* harmony export */   del: function() { return /* binding */ del; },
/* harmony export */   fetch: function() { return /* binding */ fetch; },
/* harmony export */   prune: function() { return /* binding */ prune; }
/* harmony export */ });
/*
Stimulus 3.2.1
Copyright © 2023 Basecamp, LLC
 */
class EventListener {
    constructor(eventTarget, eventName, eventOptions) {
        this.eventTarget = eventTarget;
        this.eventName = eventName;
        this.eventOptions = eventOptions;
        this.unorderedBindings = new Set();
    }
    connect() {
        this.eventTarget.addEventListener(this.eventName, this, this.eventOptions);
    }
    disconnect() {
        this.eventTarget.removeEventListener(this.eventName, this, this.eventOptions);
    }
    bindingConnected(binding) {
        this.unorderedBindings.add(binding);
    }
    bindingDisconnected(binding) {
        this.unorderedBindings.delete(binding);
    }
    handleEvent(event) {
        const extendedEvent = extendEvent(event);
        for (const binding of this.bindings) {
            if (extendedEvent.immediatePropagationStopped) {
                break;
            }
            else {
                binding.handleEvent(extendedEvent);
            }
        }
    }
    hasBindings() {
        return this.unorderedBindings.size > 0;
    }
    get bindings() {
        return Array.from(this.unorderedBindings).sort((left, right) => {
            const leftIndex = left.index, rightIndex = right.index;
            return leftIndex < rightIndex ? -1 : leftIndex > rightIndex ? 1 : 0;
        });
    }
}
function extendEvent(event) {
    if ("immediatePropagationStopped" in event) {
        return event;
    }
    else {
        const { stopImmediatePropagation } = event;
        return Object.assign(event, {
            immediatePropagationStopped: false,
            stopImmediatePropagation() {
                this.immediatePropagationStopped = true;
                stopImmediatePropagation.call(this);
            },
        });
    }
}

class Dispatcher {
    constructor(application) {
        this.application = application;
        this.eventListenerMaps = new Map();
        this.started = false;
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.eventListeners.forEach((eventListener) => eventListener.connect());
        }
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.eventListeners.forEach((eventListener) => eventListener.disconnect());
        }
    }
    get eventListeners() {
        return Array.from(this.eventListenerMaps.values()).reduce((listeners, map) => listeners.concat(Array.from(map.values())), []);
    }
    bindingConnected(binding) {
        this.fetchEventListenerForBinding(binding).bindingConnected(binding);
    }
    bindingDisconnected(binding, clearEventListeners = false) {
        this.fetchEventListenerForBinding(binding).bindingDisconnected(binding);
        if (clearEventListeners)
            this.clearEventListenersForBinding(binding);
    }
    handleError(error, message, detail = {}) {
        this.application.handleError(error, `Error ${message}`, detail);
    }
    clearEventListenersForBinding(binding) {
        const eventListener = this.fetchEventListenerForBinding(binding);
        if (!eventListener.hasBindings()) {
            eventListener.disconnect();
            this.removeMappedEventListenerFor(binding);
        }
    }
    removeMappedEventListenerFor(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        eventListenerMap.delete(cacheKey);
        if (eventListenerMap.size == 0)
            this.eventListenerMaps.delete(eventTarget);
    }
    fetchEventListenerForBinding(binding) {
        const { eventTarget, eventName, eventOptions } = binding;
        return this.fetchEventListener(eventTarget, eventName, eventOptions);
    }
    fetchEventListener(eventTarget, eventName, eventOptions) {
        const eventListenerMap = this.fetchEventListenerMapForEventTarget(eventTarget);
        const cacheKey = this.cacheKey(eventName, eventOptions);
        let eventListener = eventListenerMap.get(cacheKey);
        if (!eventListener) {
            eventListener = this.createEventListener(eventTarget, eventName, eventOptions);
            eventListenerMap.set(cacheKey, eventListener);
        }
        return eventListener;
    }
    createEventListener(eventTarget, eventName, eventOptions) {
        const eventListener = new EventListener(eventTarget, eventName, eventOptions);
        if (this.started) {
            eventListener.connect();
        }
        return eventListener;
    }
    fetchEventListenerMapForEventTarget(eventTarget) {
        let eventListenerMap = this.eventListenerMaps.get(eventTarget);
        if (!eventListenerMap) {
            eventListenerMap = new Map();
            this.eventListenerMaps.set(eventTarget, eventListenerMap);
        }
        return eventListenerMap;
    }
    cacheKey(eventName, eventOptions) {
        const parts = [eventName];
        Object.keys(eventOptions)
            .sort()
            .forEach((key) => {
            parts.push(`${eventOptions[key] ? "" : "!"}${key}`);
        });
        return parts.join(":");
    }
}

const defaultActionDescriptorFilters = {
    stop({ event, value }) {
        if (value)
            event.stopPropagation();
        return true;
    },
    prevent({ event, value }) {
        if (value)
            event.preventDefault();
        return true;
    },
    self({ event, value, element }) {
        if (value) {
            return element === event.target;
        }
        else {
            return true;
        }
    },
};
const descriptorPattern = /^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;
function parseActionDescriptorString(descriptorString) {
    const source = descriptorString.trim();
    const matches = source.match(descriptorPattern) || [];
    let eventName = matches[2];
    let keyFilter = matches[3];
    if (keyFilter && !["keydown", "keyup", "keypress"].includes(eventName)) {
        eventName += `.${keyFilter}`;
        keyFilter = "";
    }
    return {
        eventTarget: parseEventTarget(matches[4]),
        eventName,
        eventOptions: matches[7] ? parseEventOptions(matches[7]) : {},
        identifier: matches[5],
        methodName: matches[6],
        keyFilter: matches[1] || keyFilter,
    };
}
function parseEventTarget(eventTargetName) {
    if (eventTargetName == "window") {
        return window;
    }
    else if (eventTargetName == "document") {
        return document;
    }
}
function parseEventOptions(eventOptions) {
    return eventOptions
        .split(":")
        .reduce((options, token) => Object.assign(options, { [token.replace(/^!/, "")]: !/^!/.test(token) }), {});
}
function stringifyEventTarget(eventTarget) {
    if (eventTarget == window) {
        return "window";
    }
    else if (eventTarget == document) {
        return "document";
    }
}

function camelize(value) {
    return value.replace(/(?:[_-])([a-z0-9])/g, (_, char) => char.toUpperCase());
}
function namespaceCamelize(value) {
    return camelize(value.replace(/--/g, "-").replace(/__/g, "_"));
}
function capitalize(value) {
    return value.charAt(0).toUpperCase() + value.slice(1);
}
function dasherize(value) {
    return value.replace(/([A-Z])/g, (_, char) => `-${char.toLowerCase()}`);
}
function tokenize(value) {
    return value.match(/[^\s]+/g) || [];
}

function isSomething(object) {
    return object !== null && object !== undefined;
}
function hasProperty(object, property) {
    return Object.prototype.hasOwnProperty.call(object, property);
}

const allModifiers = ["meta", "ctrl", "alt", "shift"];
class Action {
    constructor(element, index, descriptor, schema) {
        this.element = element;
        this.index = index;
        this.eventTarget = descriptor.eventTarget || element;
        this.eventName = descriptor.eventName || getDefaultEventNameForElement(element) || error("missing event name");
        this.eventOptions = descriptor.eventOptions || {};
        this.identifier = descriptor.identifier || error("missing identifier");
        this.methodName = descriptor.methodName || error("missing method name");
        this.keyFilter = descriptor.keyFilter || "";
        this.schema = schema;
    }
    static forToken(token, schema) {
        return new this(token.element, token.index, parseActionDescriptorString(token.content), schema);
    }
    toString() {
        const eventFilter = this.keyFilter ? `.${this.keyFilter}` : "";
        const eventTarget = this.eventTargetName ? `@${this.eventTargetName}` : "";
        return `${this.eventName}${eventFilter}${eventTarget}->${this.identifier}#${this.methodName}`;
    }
    shouldIgnoreKeyboardEvent(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filters = this.keyFilter.split("+");
        if (this.keyFilterDissatisfied(event, filters)) {
            return true;
        }
        const standardFilter = filters.filter((key) => !allModifiers.includes(key))[0];
        if (!standardFilter) {
            return false;
        }
        if (!hasProperty(this.keyMappings, standardFilter)) {
            error(`contains unknown key filter: ${this.keyFilter}`);
        }
        return this.keyMappings[standardFilter].toLowerCase() !== event.key.toLowerCase();
    }
    shouldIgnoreMouseEvent(event) {
        if (!this.keyFilter) {
            return false;
        }
        const filters = [this.keyFilter];
        if (this.keyFilterDissatisfied(event, filters)) {
            return true;
        }
        return false;
    }
    get params() {
        const params = {};
        const pattern = new RegExp(`^data-${this.identifier}-(.+)-param$`, "i");
        for (const { name, value } of Array.from(this.element.attributes)) {
            const match = name.match(pattern);
            const key = match && match[1];
            if (key) {
                params[camelize(key)] = typecast(value);
            }
        }
        return params;
    }
    get eventTargetName() {
        return stringifyEventTarget(this.eventTarget);
    }
    get keyMappings() {
        return this.schema.keyMappings;
    }
    keyFilterDissatisfied(event, filters) {
        const [meta, ctrl, alt, shift] = allModifiers.map((modifier) => filters.includes(modifier));
        return event.metaKey !== meta || event.ctrlKey !== ctrl || event.altKey !== alt || event.shiftKey !== shift;
    }
}
const defaultEventNames = {
    a: () => "click",
    button: () => "click",
    form: () => "submit",
    details: () => "toggle",
    input: (e) => (e.getAttribute("type") == "submit" ? "click" : "input"),
    select: () => "change",
    textarea: () => "input",
};
function getDefaultEventNameForElement(element) {
    const tagName = element.tagName.toLowerCase();
    if (tagName in defaultEventNames) {
        return defaultEventNames[tagName](element);
    }
}
function error(message) {
    throw new Error(message);
}
function typecast(value) {
    try {
        return JSON.parse(value);
    }
    catch (o_O) {
        return value;
    }
}

class Binding {
    constructor(context, action) {
        this.context = context;
        this.action = action;
    }
    get index() {
        return this.action.index;
    }
    get eventTarget() {
        return this.action.eventTarget;
    }
    get eventOptions() {
        return this.action.eventOptions;
    }
    get identifier() {
        return this.context.identifier;
    }
    handleEvent(event) {
        const actionEvent = this.prepareActionEvent(event);
        if (this.willBeInvokedByEvent(event) && this.applyEventModifiers(actionEvent)) {
            this.invokeWithEvent(actionEvent);
        }
    }
    get eventName() {
        return this.action.eventName;
    }
    get method() {
        const method = this.controller[this.methodName];
        if (typeof method == "function") {
            return method;
        }
        throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`);
    }
    applyEventModifiers(event) {
        const { element } = this.action;
        const { actionDescriptorFilters } = this.context.application;
        const { controller } = this.context;
        let passes = true;
        for (const [name, value] of Object.entries(this.eventOptions)) {
            if (name in actionDescriptorFilters) {
                const filter = actionDescriptorFilters[name];
                passes = passes && filter({ name, value, event, element, controller });
            }
            else {
                continue;
            }
        }
        return passes;
    }
    prepareActionEvent(event) {
        return Object.assign(event, { params: this.action.params });
    }
    invokeWithEvent(event) {
        const { target, currentTarget } = event;
        try {
            this.method.call(this.controller, event);
            this.context.logDebugActivity(this.methodName, { event, target, currentTarget, action: this.methodName });
        }
        catch (error) {
            const { identifier, controller, element, index } = this;
            const detail = { identifier, controller, element, index, event };
            this.context.handleError(error, `invoking action "${this.action}"`, detail);
        }
    }
    willBeInvokedByEvent(event) {
        const eventTarget = event.target;
        if (event instanceof KeyboardEvent && this.action.shouldIgnoreKeyboardEvent(event)) {
            return false;
        }
        if (event instanceof MouseEvent && this.action.shouldIgnoreMouseEvent(event)) {
            return false;
        }
        if (this.element === eventTarget) {
            return true;
        }
        else if (eventTarget instanceof Element && this.element.contains(eventTarget)) {
            return this.scope.containsElement(eventTarget);
        }
        else {
            return this.scope.containsElement(this.action.element);
        }
    }
    get controller() {
        return this.context.controller;
    }
    get methodName() {
        return this.action.methodName;
    }
    get element() {
        return this.scope.element;
    }
    get scope() {
        return this.context.scope;
    }
}

class ElementObserver {
    constructor(element, delegate) {
        this.mutationObserverInit = { attributes: true, childList: true, subtree: true };
        this.element = element;
        this.started = false;
        this.delegate = delegate;
        this.elements = new Set();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.refresh();
        }
    }
    pause(callback) {
        if (this.started) {
            this.mutationObserver.disconnect();
            this.started = false;
        }
        callback();
        if (!this.started) {
            this.mutationObserver.observe(this.element, this.mutationObserverInit);
            this.started = true;
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            const matches = new Set(this.matchElementsInTree());
            for (const element of Array.from(this.elements)) {
                if (!matches.has(element)) {
                    this.removeElement(element);
                }
            }
            for (const element of Array.from(matches)) {
                this.addElement(element);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        if (mutation.type == "attributes") {
            this.processAttributeChange(mutation.target, mutation.attributeName);
        }
        else if (mutation.type == "childList") {
            this.processRemovedNodes(mutation.removedNodes);
            this.processAddedNodes(mutation.addedNodes);
        }
    }
    processAttributeChange(element, attributeName) {
        if (this.elements.has(element)) {
            if (this.delegate.elementAttributeChanged && this.matchElement(element)) {
                this.delegate.elementAttributeChanged(element, attributeName);
            }
            else {
                this.removeElement(element);
            }
        }
        else if (this.matchElement(element)) {
            this.addElement(element);
        }
    }
    processRemovedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element) {
                this.processTree(element, this.removeElement);
            }
        }
    }
    processAddedNodes(nodes) {
        for (const node of Array.from(nodes)) {
            const element = this.elementFromNode(node);
            if (element && this.elementIsActive(element)) {
                this.processTree(element, this.addElement);
            }
        }
    }
    matchElement(element) {
        return this.delegate.matchElement(element);
    }
    matchElementsInTree(tree = this.element) {
        return this.delegate.matchElementsInTree(tree);
    }
    processTree(tree, processor) {
        for (const element of this.matchElementsInTree(tree)) {
            processor.call(this, element);
        }
    }
    elementFromNode(node) {
        if (node.nodeType == Node.ELEMENT_NODE) {
            return node;
        }
    }
    elementIsActive(element) {
        if (element.isConnected != this.element.isConnected) {
            return false;
        }
        else {
            return this.element.contains(element);
        }
    }
    addElement(element) {
        if (!this.elements.has(element)) {
            if (this.elementIsActive(element)) {
                this.elements.add(element);
                if (this.delegate.elementMatched) {
                    this.delegate.elementMatched(element);
                }
            }
        }
    }
    removeElement(element) {
        if (this.elements.has(element)) {
            this.elements.delete(element);
            if (this.delegate.elementUnmatched) {
                this.delegate.elementUnmatched(element);
            }
        }
    }
}

class AttributeObserver {
    constructor(element, attributeName, delegate) {
        this.attributeName = attributeName;
        this.delegate = delegate;
        this.elementObserver = new ElementObserver(element, this);
    }
    get element() {
        return this.elementObserver.element;
    }
    get selector() {
        return `[${this.attributeName}]`;
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get started() {
        return this.elementObserver.started;
    }
    matchElement(element) {
        return element.hasAttribute(this.attributeName);
    }
    matchElementsInTree(tree) {
        const match = this.matchElement(tree) ? [tree] : [];
        const matches = Array.from(tree.querySelectorAll(this.selector));
        return match.concat(matches);
    }
    elementMatched(element) {
        if (this.delegate.elementMatchedAttribute) {
            this.delegate.elementMatchedAttribute(element, this.attributeName);
        }
    }
    elementUnmatched(element) {
        if (this.delegate.elementUnmatchedAttribute) {
            this.delegate.elementUnmatchedAttribute(element, this.attributeName);
        }
    }
    elementAttributeChanged(element, attributeName) {
        if (this.delegate.elementAttributeValueChanged && this.attributeName == attributeName) {
            this.delegate.elementAttributeValueChanged(element, attributeName);
        }
    }
}

function add(map, key, value) {
    fetch(map, key).add(value);
}
function del(map, key, value) {
    fetch(map, key).delete(value);
    prune(map, key);
}
function fetch(map, key) {
    let values = map.get(key);
    if (!values) {
        values = new Set();
        map.set(key, values);
    }
    return values;
}
function prune(map, key) {
    const values = map.get(key);
    if (values != null && values.size == 0) {
        map.delete(key);
    }
}

class Multimap {
    constructor() {
        this.valuesByKey = new Map();
    }
    get keys() {
        return Array.from(this.valuesByKey.keys());
    }
    get values() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((values, set) => values.concat(Array.from(set)), []);
    }
    get size() {
        const sets = Array.from(this.valuesByKey.values());
        return sets.reduce((size, set) => size + set.size, 0);
    }
    add(key, value) {
        add(this.valuesByKey, key, value);
    }
    delete(key, value) {
        del(this.valuesByKey, key, value);
    }
    has(key, value) {
        const values = this.valuesByKey.get(key);
        return values != null && values.has(value);
    }
    hasKey(key) {
        return this.valuesByKey.has(key);
    }
    hasValue(value) {
        const sets = Array.from(this.valuesByKey.values());
        return sets.some((set) => set.has(value));
    }
    getValuesForKey(key) {
        const values = this.valuesByKey.get(key);
        return values ? Array.from(values) : [];
    }
    getKeysForValue(value) {
        return Array.from(this.valuesByKey)
            .filter(([_key, values]) => values.has(value))
            .map(([key, _values]) => key);
    }
}

class IndexedMultimap extends Multimap {
    constructor() {
        super();
        this.keysByValue = new Map();
    }
    get values() {
        return Array.from(this.keysByValue.keys());
    }
    add(key, value) {
        super.add(key, value);
        add(this.keysByValue, value, key);
    }
    delete(key, value) {
        super.delete(key, value);
        del(this.keysByValue, value, key);
    }
    hasValue(value) {
        return this.keysByValue.has(value);
    }
    getKeysForValue(value) {
        const set = this.keysByValue.get(value);
        return set ? Array.from(set) : [];
    }
}

class SelectorObserver {
    constructor(element, selector, delegate, details) {
        this._selector = selector;
        this.details = details;
        this.elementObserver = new ElementObserver(element, this);
        this.delegate = delegate;
        this.matchesByElement = new Multimap();
    }
    get started() {
        return this.elementObserver.started;
    }
    get selector() {
        return this._selector;
    }
    set selector(selector) {
        this._selector = selector;
        this.refresh();
    }
    start() {
        this.elementObserver.start();
    }
    pause(callback) {
        this.elementObserver.pause(callback);
    }
    stop() {
        this.elementObserver.stop();
    }
    refresh() {
        this.elementObserver.refresh();
    }
    get element() {
        return this.elementObserver.element;
    }
    matchElement(element) {
        const { selector } = this;
        if (selector) {
            const matches = element.matches(selector);
            if (this.delegate.selectorMatchElement) {
                return matches && this.delegate.selectorMatchElement(element, this.details);
            }
            return matches;
        }
        else {
            return false;
        }
    }
    matchElementsInTree(tree) {
        const { selector } = this;
        if (selector) {
            const match = this.matchElement(tree) ? [tree] : [];
            const matches = Array.from(tree.querySelectorAll(selector)).filter((match) => this.matchElement(match));
            return match.concat(matches);
        }
        else {
            return [];
        }
    }
    elementMatched(element) {
        const { selector } = this;
        if (selector) {
            this.selectorMatched(element, selector);
        }
    }
    elementUnmatched(element) {
        const selectors = this.matchesByElement.getKeysForValue(element);
        for (const selector of selectors) {
            this.selectorUnmatched(element, selector);
        }
    }
    elementAttributeChanged(element, _attributeName) {
        const { selector } = this;
        if (selector) {
            const matches = this.matchElement(element);
            const matchedBefore = this.matchesByElement.has(selector, element);
            if (matches && !matchedBefore) {
                this.selectorMatched(element, selector);
            }
            else if (!matches && matchedBefore) {
                this.selectorUnmatched(element, selector);
            }
        }
    }
    selectorMatched(element, selector) {
        this.delegate.selectorMatched(element, selector, this.details);
        this.matchesByElement.add(selector, element);
    }
    selectorUnmatched(element, selector) {
        this.delegate.selectorUnmatched(element, selector, this.details);
        this.matchesByElement.delete(selector, element);
    }
}

class StringMapObserver {
    constructor(element, delegate) {
        this.element = element;
        this.delegate = delegate;
        this.started = false;
        this.stringMap = new Map();
        this.mutationObserver = new MutationObserver((mutations) => this.processMutations(mutations));
    }
    start() {
        if (!this.started) {
            this.started = true;
            this.mutationObserver.observe(this.element, { attributes: true, attributeOldValue: true });
            this.refresh();
        }
    }
    stop() {
        if (this.started) {
            this.mutationObserver.takeRecords();
            this.mutationObserver.disconnect();
            this.started = false;
        }
    }
    refresh() {
        if (this.started) {
            for (const attributeName of this.knownAttributeNames) {
                this.refreshAttribute(attributeName, null);
            }
        }
    }
    processMutations(mutations) {
        if (this.started) {
            for (const mutation of mutations) {
                this.processMutation(mutation);
            }
        }
    }
    processMutation(mutation) {
        const attributeName = mutation.attributeName;
        if (attributeName) {
            this.refreshAttribute(attributeName, mutation.oldValue);
        }
    }
    refreshAttribute(attributeName, oldValue) {
        const key = this.delegate.getStringMapKeyForAttribute(attributeName);
        if (key != null) {
            if (!this.stringMap.has(attributeName)) {
                this.stringMapKeyAdded(key, attributeName);
            }
            const value = this.element.getAttribute(attributeName);
            if (this.stringMap.get(attributeName) != value) {
                this.stringMapValueChanged(value, key, oldValue);
            }
            if (value == null) {
                const oldValue = this.stringMap.get(attributeName);
                this.stringMap.delete(attributeName);
                if (oldValue)
                    this.stringMapKeyRemoved(key, attributeName, oldValue);
            }
            else {
                this.stringMap.set(attributeName, value);
            }
        }
    }
    stringMapKeyAdded(key, attributeName) {
        if (this.delegate.stringMapKeyAdded) {
            this.delegate.stringMapKeyAdded(key, attributeName);
        }
    }
    stringMapValueChanged(value, key, oldValue) {
        if (this.delegate.stringMapValueChanged) {
            this.delegate.stringMapValueChanged(value, key, oldValue);
        }
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        if (this.delegate.stringMapKeyRemoved) {
            this.delegate.stringMapKeyRemoved(key, attributeName, oldValue);
        }
    }
    get knownAttributeNames() {
        return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)));
    }
    get currentAttributeNames() {
        return Array.from(this.element.attributes).map((attribute) => attribute.name);
    }
    get recordedAttributeNames() {
        return Array.from(this.stringMap.keys());
    }
}

class TokenListObserver {
    constructor(element, attributeName, delegate) {
        this.attributeObserver = new AttributeObserver(element, attributeName, this);
        this.delegate = delegate;
        this.tokensByElement = new Multimap();
    }
    get started() {
        return this.attributeObserver.started;
    }
    start() {
        this.attributeObserver.start();
    }
    pause(callback) {
        this.attributeObserver.pause(callback);
    }
    stop() {
        this.attributeObserver.stop();
    }
    refresh() {
        this.attributeObserver.refresh();
    }
    get element() {
        return this.attributeObserver.element;
    }
    get attributeName() {
        return this.attributeObserver.attributeName;
    }
    elementMatchedAttribute(element) {
        this.tokensMatched(this.readTokensForElement(element));
    }
    elementAttributeValueChanged(element) {
        const [unmatchedTokens, matchedTokens] = this.refreshTokensForElement(element);
        this.tokensUnmatched(unmatchedTokens);
        this.tokensMatched(matchedTokens);
    }
    elementUnmatchedAttribute(element) {
        this.tokensUnmatched(this.tokensByElement.getValuesForKey(element));
    }
    tokensMatched(tokens) {
        tokens.forEach((token) => this.tokenMatched(token));
    }
    tokensUnmatched(tokens) {
        tokens.forEach((token) => this.tokenUnmatched(token));
    }
    tokenMatched(token) {
        this.delegate.tokenMatched(token);
        this.tokensByElement.add(token.element, token);
    }
    tokenUnmatched(token) {
        this.delegate.tokenUnmatched(token);
        this.tokensByElement.delete(token.element, token);
    }
    refreshTokensForElement(element) {
        const previousTokens = this.tokensByElement.getValuesForKey(element);
        const currentTokens = this.readTokensForElement(element);
        const firstDifferingIndex = zip(previousTokens, currentTokens).findIndex(([previousToken, currentToken]) => !tokensAreEqual(previousToken, currentToken));
        if (firstDifferingIndex == -1) {
            return [[], []];
        }
        else {
            return [previousTokens.slice(firstDifferingIndex), currentTokens.slice(firstDifferingIndex)];
        }
    }
    readTokensForElement(element) {
        const attributeName = this.attributeName;
        const tokenString = element.getAttribute(attributeName) || "";
        return parseTokenString(tokenString, element, attributeName);
    }
}
function parseTokenString(tokenString, element, attributeName) {
    return tokenString
        .trim()
        .split(/\s+/)
        .filter((content) => content.length)
        .map((content, index) => ({ element, attributeName, content, index }));
}
function zip(left, right) {
    const length = Math.max(left.length, right.length);
    return Array.from({ length }, (_, index) => [left[index], right[index]]);
}
function tokensAreEqual(left, right) {
    return left && right && left.index == right.index && left.content == right.content;
}

class ValueListObserver {
    constructor(element, attributeName, delegate) {
        this.tokenListObserver = new TokenListObserver(element, attributeName, this);
        this.delegate = delegate;
        this.parseResultsByToken = new WeakMap();
        this.valuesByTokenByElement = new WeakMap();
    }
    get started() {
        return this.tokenListObserver.started;
    }
    start() {
        this.tokenListObserver.start();
    }
    stop() {
        this.tokenListObserver.stop();
    }
    refresh() {
        this.tokenListObserver.refresh();
    }
    get element() {
        return this.tokenListObserver.element;
    }
    get attributeName() {
        return this.tokenListObserver.attributeName;
    }
    tokenMatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).set(token, value);
            this.delegate.elementMatchedValue(element, value);
        }
    }
    tokenUnmatched(token) {
        const { element } = token;
        const { value } = this.fetchParseResultForToken(token);
        if (value) {
            this.fetchValuesByTokenForElement(element).delete(token);
            this.delegate.elementUnmatchedValue(element, value);
        }
    }
    fetchParseResultForToken(token) {
        let parseResult = this.parseResultsByToken.get(token);
        if (!parseResult) {
            parseResult = this.parseToken(token);
            this.parseResultsByToken.set(token, parseResult);
        }
        return parseResult;
    }
    fetchValuesByTokenForElement(element) {
        let valuesByToken = this.valuesByTokenByElement.get(element);
        if (!valuesByToken) {
            valuesByToken = new Map();
            this.valuesByTokenByElement.set(element, valuesByToken);
        }
        return valuesByToken;
    }
    parseToken(token) {
        try {
            const value = this.delegate.parseValueForToken(token);
            return { value };
        }
        catch (error) {
            return { error };
        }
    }
}

class BindingObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.bindingsByAction = new Map();
    }
    start() {
        if (!this.valueListObserver) {
            this.valueListObserver = new ValueListObserver(this.element, this.actionAttribute, this);
            this.valueListObserver.start();
        }
    }
    stop() {
        if (this.valueListObserver) {
            this.valueListObserver.stop();
            delete this.valueListObserver;
            this.disconnectAllActions();
        }
    }
    get element() {
        return this.context.element;
    }
    get identifier() {
        return this.context.identifier;
    }
    get actionAttribute() {
        return this.schema.actionAttribute;
    }
    get schema() {
        return this.context.schema;
    }
    get bindings() {
        return Array.from(this.bindingsByAction.values());
    }
    connectAction(action) {
        const binding = new Binding(this.context, action);
        this.bindingsByAction.set(action, binding);
        this.delegate.bindingConnected(binding);
    }
    disconnectAction(action) {
        const binding = this.bindingsByAction.get(action);
        if (binding) {
            this.bindingsByAction.delete(action);
            this.delegate.bindingDisconnected(binding);
        }
    }
    disconnectAllActions() {
        this.bindings.forEach((binding) => this.delegate.bindingDisconnected(binding, true));
        this.bindingsByAction.clear();
    }
    parseValueForToken(token) {
        const action = Action.forToken(token, this.schema);
        if (action.identifier == this.identifier) {
            return action;
        }
    }
    elementMatchedValue(element, action) {
        this.connectAction(action);
    }
    elementUnmatchedValue(element, action) {
        this.disconnectAction(action);
    }
}

class ValueObserver {
    constructor(context, receiver) {
        this.context = context;
        this.receiver = receiver;
        this.stringMapObserver = new StringMapObserver(this.element, this);
        this.valueDescriptorMap = this.controller.valueDescriptorMap;
    }
    start() {
        this.stringMapObserver.start();
        this.invokeChangedCallbacksForDefaultValues();
    }
    stop() {
        this.stringMapObserver.stop();
    }
    get element() {
        return this.context.element;
    }
    get controller() {
        return this.context.controller;
    }
    getStringMapKeyForAttribute(attributeName) {
        if (attributeName in this.valueDescriptorMap) {
            return this.valueDescriptorMap[attributeName].name;
        }
    }
    stringMapKeyAdded(key, attributeName) {
        const descriptor = this.valueDescriptorMap[attributeName];
        if (!this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), descriptor.writer(descriptor.defaultValue));
        }
    }
    stringMapValueChanged(value, name, oldValue) {
        const descriptor = this.valueDescriptorNameMap[name];
        if (value === null)
            return;
        if (oldValue === null) {
            oldValue = descriptor.writer(descriptor.defaultValue);
        }
        this.invokeChangedCallback(name, value, oldValue);
    }
    stringMapKeyRemoved(key, attributeName, oldValue) {
        const descriptor = this.valueDescriptorNameMap[key];
        if (this.hasValue(key)) {
            this.invokeChangedCallback(key, descriptor.writer(this.receiver[key]), oldValue);
        }
        else {
            this.invokeChangedCallback(key, descriptor.writer(descriptor.defaultValue), oldValue);
        }
    }
    invokeChangedCallbacksForDefaultValues() {
        for (const { key, name, defaultValue, writer } of this.valueDescriptors) {
            if (defaultValue != undefined && !this.controller.data.has(key)) {
                this.invokeChangedCallback(name, writer(defaultValue), undefined);
            }
        }
    }
    invokeChangedCallback(name, rawValue, rawOldValue) {
        const changedMethodName = `${name}Changed`;
        const changedMethod = this.receiver[changedMethodName];
        if (typeof changedMethod == "function") {
            const descriptor = this.valueDescriptorNameMap[name];
            try {
                const value = descriptor.reader(rawValue);
                let oldValue = rawOldValue;
                if (rawOldValue) {
                    oldValue = descriptor.reader(rawOldValue);
                }
                changedMethod.call(this.receiver, value, oldValue);
            }
            catch (error) {
                if (error instanceof TypeError) {
                    error.message = `Stimulus Value "${this.context.identifier}.${descriptor.name}" - ${error.message}`;
                }
                throw error;
            }
        }
    }
    get valueDescriptors() {
        const { valueDescriptorMap } = this;
        return Object.keys(valueDescriptorMap).map((key) => valueDescriptorMap[key]);
    }
    get valueDescriptorNameMap() {
        const descriptors = {};
        Object.keys(this.valueDescriptorMap).forEach((key) => {
            const descriptor = this.valueDescriptorMap[key];
            descriptors[descriptor.name] = descriptor;
        });
        return descriptors;
    }
    hasValue(attributeName) {
        const descriptor = this.valueDescriptorNameMap[attributeName];
        const hasMethodName = `has${capitalize(descriptor.name)}`;
        return this.receiver[hasMethodName];
    }
}

class TargetObserver {
    constructor(context, delegate) {
        this.context = context;
        this.delegate = delegate;
        this.targetsByName = new Multimap();
    }
    start() {
        if (!this.tokenListObserver) {
            this.tokenListObserver = new TokenListObserver(this.element, this.attributeName, this);
            this.tokenListObserver.start();
        }
    }
    stop() {
        if (this.tokenListObserver) {
            this.disconnectAllTargets();
            this.tokenListObserver.stop();
            delete this.tokenListObserver;
        }
    }
    tokenMatched({ element, content: name }) {
        if (this.scope.containsElement(element)) {
            this.connectTarget(element, name);
        }
    }
    tokenUnmatched({ element, content: name }) {
        this.disconnectTarget(element, name);
    }
    connectTarget(element, name) {
        var _a;
        if (!this.targetsByName.has(name, element)) {
            this.targetsByName.add(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetConnected(element, name));
        }
    }
    disconnectTarget(element, name) {
        var _a;
        if (this.targetsByName.has(name, element)) {
            this.targetsByName.delete(name, element);
            (_a = this.tokenListObserver) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.targetDisconnected(element, name));
        }
    }
    disconnectAllTargets() {
        for (const name of this.targetsByName.keys) {
            for (const element of this.targetsByName.getValuesForKey(name)) {
                this.disconnectTarget(element, name);
            }
        }
    }
    get attributeName() {
        return `data-${this.context.identifier}-target`;
    }
    get element() {
        return this.context.element;
    }
    get scope() {
        return this.context.scope;
    }
}

function readInheritableStaticArrayValues(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return Array.from(ancestors.reduce((values, constructor) => {
        getOwnStaticArrayValues(constructor, propertyName).forEach((name) => values.add(name));
        return values;
    }, new Set()));
}
function readInheritableStaticObjectPairs(constructor, propertyName) {
    const ancestors = getAncestorsForConstructor(constructor);
    return ancestors.reduce((pairs, constructor) => {
        pairs.push(...getOwnStaticObjectPairs(constructor, propertyName));
        return pairs;
    }, []);
}
function getAncestorsForConstructor(constructor) {
    const ancestors = [];
    while (constructor) {
        ancestors.push(constructor);
        constructor = Object.getPrototypeOf(constructor);
    }
    return ancestors.reverse();
}
function getOwnStaticArrayValues(constructor, propertyName) {
    const definition = constructor[propertyName];
    return Array.isArray(definition) ? definition : [];
}
function getOwnStaticObjectPairs(constructor, propertyName) {
    const definition = constructor[propertyName];
    return definition ? Object.keys(definition).map((key) => [key, definition[key]]) : [];
}

class OutletObserver {
    constructor(context, delegate) {
        this.started = false;
        this.context = context;
        this.delegate = delegate;
        this.outletsByName = new Multimap();
        this.outletElementsByName = new Multimap();
        this.selectorObserverMap = new Map();
        this.attributeObserverMap = new Map();
    }
    start() {
        if (!this.started) {
            this.outletDefinitions.forEach((outletName) => {
                this.setupSelectorObserverForOutlet(outletName);
                this.setupAttributeObserverForOutlet(outletName);
            });
            this.started = true;
            this.dependentContexts.forEach((context) => context.refresh());
        }
    }
    refresh() {
        this.selectorObserverMap.forEach((observer) => observer.refresh());
        this.attributeObserverMap.forEach((observer) => observer.refresh());
    }
    stop() {
        if (this.started) {
            this.started = false;
            this.disconnectAllOutlets();
            this.stopSelectorObservers();
            this.stopAttributeObservers();
        }
    }
    stopSelectorObservers() {
        if (this.selectorObserverMap.size > 0) {
            this.selectorObserverMap.forEach((observer) => observer.stop());
            this.selectorObserverMap.clear();
        }
    }
    stopAttributeObservers() {
        if (this.attributeObserverMap.size > 0) {
            this.attributeObserverMap.forEach((observer) => observer.stop());
            this.attributeObserverMap.clear();
        }
    }
    selectorMatched(element, _selector, { outletName }) {
        const outlet = this.getOutlet(element, outletName);
        if (outlet) {
            this.connectOutlet(outlet, element, outletName);
        }
    }
    selectorUnmatched(element, _selector, { outletName }) {
        const outlet = this.getOutletFromMap(element, outletName);
        if (outlet) {
            this.disconnectOutlet(outlet, element, outletName);
        }
    }
    selectorMatchElement(element, { outletName }) {
        const selector = this.selector(outletName);
        const hasOutlet = this.hasOutlet(element, outletName);
        const hasOutletController = element.matches(`[${this.schema.controllerAttribute}~=${outletName}]`);
        if (selector) {
            return hasOutlet && hasOutletController && element.matches(selector);
        }
        else {
            return false;
        }
    }
    elementMatchedAttribute(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    elementAttributeValueChanged(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    elementUnmatchedAttribute(_element, attributeName) {
        const outletName = this.getOutletNameFromOutletAttributeName(attributeName);
        if (outletName) {
            this.updateSelectorObserverForOutlet(outletName);
        }
    }
    connectOutlet(outlet, element, outletName) {
        var _a;
        if (!this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.add(outletName, outlet);
            this.outletElementsByName.add(outletName, element);
            (_a = this.selectorObserverMap.get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletConnected(outlet, element, outletName));
        }
    }
    disconnectOutlet(outlet, element, outletName) {
        var _a;
        if (this.outletElementsByName.has(outletName, element)) {
            this.outletsByName.delete(outletName, outlet);
            this.outletElementsByName.delete(outletName, element);
            (_a = this.selectorObserverMap
                .get(outletName)) === null || _a === void 0 ? void 0 : _a.pause(() => this.delegate.outletDisconnected(outlet, element, outletName));
        }
    }
    disconnectAllOutlets() {
        for (const outletName of this.outletElementsByName.keys) {
            for (const element of this.outletElementsByName.getValuesForKey(outletName)) {
                for (const outlet of this.outletsByName.getValuesForKey(outletName)) {
                    this.disconnectOutlet(outlet, element, outletName);
                }
            }
        }
    }
    updateSelectorObserverForOutlet(outletName) {
        const observer = this.selectorObserverMap.get(outletName);
        if (observer) {
            observer.selector = this.selector(outletName);
        }
    }
    setupSelectorObserverForOutlet(outletName) {
        const selector = this.selector(outletName);
        const selectorObserver = new SelectorObserver(document.body, selector, this, { outletName });
        this.selectorObserverMap.set(outletName, selectorObserver);
        selectorObserver.start();
    }
    setupAttributeObserverForOutlet(outletName) {
        const attributeName = this.attributeNameForOutletName(outletName);
        const attributeObserver = new AttributeObserver(this.scope.element, attributeName, this);
        this.attributeObserverMap.set(outletName, attributeObserver);
        attributeObserver.start();
    }
    selector(outletName) {
        return this.scope.outlets.getSelectorForOutletName(outletName);
    }
    attributeNameForOutletName(outletName) {
        return this.scope.schema.outletAttributeForScope(this.identifier, outletName);
    }
    getOutletNameFromOutletAttributeName(attributeName) {
        return this.outletDefinitions.find((outletName) => this.attributeNameForOutletName(outletName) === attributeName);
    }
    get outletDependencies() {
        const dependencies = new Multimap();
        this.router.modules.forEach((module) => {
            const constructor = module.definition.controllerConstructor;
            const outlets = readInheritableStaticArrayValues(constructor, "outlets");
            outlets.forEach((outlet) => dependencies.add(outlet, module.identifier));
        });
        return dependencies;
    }
    get outletDefinitions() {
        return this.outletDependencies.getKeysForValue(this.identifier);
    }
    get dependentControllerIdentifiers() {
        return this.outletDependencies.getValuesForKey(this.identifier);
    }
    get dependentContexts() {
        const identifiers = this.dependentControllerIdentifiers;
        return this.router.contexts.filter((context) => identifiers.includes(context.identifier));
    }
    hasOutlet(element, outletName) {
        return !!this.getOutlet(element, outletName) || !!this.getOutletFromMap(element, outletName);
    }
    getOutlet(element, outletName) {
        return this.application.getControllerForElementAndIdentifier(element, outletName);
    }
    getOutletFromMap(element, outletName) {
        return this.outletsByName.getValuesForKey(outletName).find((outlet) => outlet.element === element);
    }
    get scope() {
        return this.context.scope;
    }
    get schema() {
        return this.context.schema;
    }
    get identifier() {
        return this.context.identifier;
    }
    get application() {
        return this.context.application;
    }
    get router() {
        return this.application.router;
    }
}

class Context {
    constructor(module, scope) {
        this.logDebugActivity = (functionName, detail = {}) => {
            const { identifier, controller, element } = this;
            detail = Object.assign({ identifier, controller, element }, detail);
            this.application.logDebugActivity(this.identifier, functionName, detail);
        };
        this.module = module;
        this.scope = scope;
        this.controller = new module.controllerConstructor(this);
        this.bindingObserver = new BindingObserver(this, this.dispatcher);
        this.valueObserver = new ValueObserver(this, this.controller);
        this.targetObserver = new TargetObserver(this, this);
        this.outletObserver = new OutletObserver(this, this);
        try {
            this.controller.initialize();
            this.logDebugActivity("initialize");
        }
        catch (error) {
            this.handleError(error, "initializing controller");
        }
    }
    connect() {
        this.bindingObserver.start();
        this.valueObserver.start();
        this.targetObserver.start();
        this.outletObserver.start();
        try {
            this.controller.connect();
            this.logDebugActivity("connect");
        }
        catch (error) {
            this.handleError(error, "connecting controller");
        }
    }
    refresh() {
        this.outletObserver.refresh();
    }
    disconnect() {
        try {
            this.controller.disconnect();
            this.logDebugActivity("disconnect");
        }
        catch (error) {
            this.handleError(error, "disconnecting controller");
        }
        this.outletObserver.stop();
        this.targetObserver.stop();
        this.valueObserver.stop();
        this.bindingObserver.stop();
    }
    get application() {
        return this.module.application;
    }
    get identifier() {
        return this.module.identifier;
    }
    get schema() {
        return this.application.schema;
    }
    get dispatcher() {
        return this.application.dispatcher;
    }
    get element() {
        return this.scope.element;
    }
    get parentElement() {
        return this.element.parentElement;
    }
    handleError(error, message, detail = {}) {
        const { identifier, controller, element } = this;
        detail = Object.assign({ identifier, controller, element }, detail);
        this.application.handleError(error, `Error ${message}`, detail);
    }
    targetConnected(element, name) {
        this.invokeControllerMethod(`${name}TargetConnected`, element);
    }
    targetDisconnected(element, name) {
        this.invokeControllerMethod(`${name}TargetDisconnected`, element);
    }
    outletConnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletConnected`, outlet, element);
    }
    outletDisconnected(outlet, element, name) {
        this.invokeControllerMethod(`${namespaceCamelize(name)}OutletDisconnected`, outlet, element);
    }
    invokeControllerMethod(methodName, ...args) {
        const controller = this.controller;
        if (typeof controller[methodName] == "function") {
            controller[methodName](...args);
        }
    }
}

function bless(constructor) {
    return shadow(constructor, getBlessedProperties(constructor));
}
function shadow(constructor, properties) {
    const shadowConstructor = extend(constructor);
    const shadowProperties = getShadowProperties(constructor.prototype, properties);
    Object.defineProperties(shadowConstructor.prototype, shadowProperties);
    return shadowConstructor;
}
function getBlessedProperties(constructor) {
    const blessings = readInheritableStaticArrayValues(constructor, "blessings");
    return blessings.reduce((blessedProperties, blessing) => {
        const properties = blessing(constructor);
        for (const key in properties) {
            const descriptor = blessedProperties[key] || {};
            blessedProperties[key] = Object.assign(descriptor, properties[key]);
        }
        return blessedProperties;
    }, {});
}
function getShadowProperties(prototype, properties) {
    return getOwnKeys(properties).reduce((shadowProperties, key) => {
        const descriptor = getShadowedDescriptor(prototype, properties, key);
        if (descriptor) {
            Object.assign(shadowProperties, { [key]: descriptor });
        }
        return shadowProperties;
    }, {});
}
function getShadowedDescriptor(prototype, properties, key) {
    const shadowingDescriptor = Object.getOwnPropertyDescriptor(prototype, key);
    const shadowedByValue = shadowingDescriptor && "value" in shadowingDescriptor;
    if (!shadowedByValue) {
        const descriptor = Object.getOwnPropertyDescriptor(properties, key).value;
        if (shadowingDescriptor) {
            descriptor.get = shadowingDescriptor.get || descriptor.get;
            descriptor.set = shadowingDescriptor.set || descriptor.set;
        }
        return descriptor;
    }
}
const getOwnKeys = (() => {
    if (typeof Object.getOwnPropertySymbols == "function") {
        return (object) => [...Object.getOwnPropertyNames(object), ...Object.getOwnPropertySymbols(object)];
    }
    else {
        return Object.getOwnPropertyNames;
    }
})();
const extend = (() => {
    function extendWithReflect(constructor) {
        function extended() {
            return Reflect.construct(constructor, arguments, new.target);
        }
        extended.prototype = Object.create(constructor.prototype, {
            constructor: { value: extended },
        });
        Reflect.setPrototypeOf(extended, constructor);
        return extended;
    }
    function testReflectExtension() {
        const a = function () {
            this.a.call(this);
        };
        const b = extendWithReflect(a);
        b.prototype.a = function () { };
        return new b();
    }
    try {
        testReflectExtension();
        return extendWithReflect;
    }
    catch (error) {
        return (constructor) => class extended extends constructor {
        };
    }
})();

function blessDefinition(definition) {
    return {
        identifier: definition.identifier,
        controllerConstructor: bless(definition.controllerConstructor),
    };
}

class Module {
    constructor(application, definition) {
        this.application = application;
        this.definition = blessDefinition(definition);
        this.contextsByScope = new WeakMap();
        this.connectedContexts = new Set();
    }
    get identifier() {
        return this.definition.identifier;
    }
    get controllerConstructor() {
        return this.definition.controllerConstructor;
    }
    get contexts() {
        return Array.from(this.connectedContexts);
    }
    connectContextForScope(scope) {
        const context = this.fetchContextForScope(scope);
        this.connectedContexts.add(context);
        context.connect();
    }
    disconnectContextForScope(scope) {
        const context = this.contextsByScope.get(scope);
        if (context) {
            this.connectedContexts.delete(context);
            context.disconnect();
        }
    }
    fetchContextForScope(scope) {
        let context = this.contextsByScope.get(scope);
        if (!context) {
            context = new Context(this, scope);
            this.contextsByScope.set(scope, context);
        }
        return context;
    }
}

class ClassMap {
    constructor(scope) {
        this.scope = scope;
    }
    has(name) {
        return this.data.has(this.getDataKey(name));
    }
    get(name) {
        return this.getAll(name)[0];
    }
    getAll(name) {
        const tokenString = this.data.get(this.getDataKey(name)) || "";
        return tokenize(tokenString);
    }
    getAttributeName(name) {
        return this.data.getAttributeNameForKey(this.getDataKey(name));
    }
    getDataKey(name) {
        return `${name}-class`;
    }
    get data() {
        return this.scope.data;
    }
}

class DataMap {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.getAttribute(name);
    }
    set(key, value) {
        const name = this.getAttributeNameForKey(key);
        this.element.setAttribute(name, value);
        return this.get(key);
    }
    has(key) {
        const name = this.getAttributeNameForKey(key);
        return this.element.hasAttribute(name);
    }
    delete(key) {
        if (this.has(key)) {
            const name = this.getAttributeNameForKey(key);
            this.element.removeAttribute(name);
            return true;
        }
        else {
            return false;
        }
    }
    getAttributeNameForKey(key) {
        return `data-${this.identifier}-${dasherize(key)}`;
    }
}

class Guide {
    constructor(logger) {
        this.warnedKeysByObject = new WeakMap();
        this.logger = logger;
    }
    warn(object, key, message) {
        let warnedKeys = this.warnedKeysByObject.get(object);
        if (!warnedKeys) {
            warnedKeys = new Set();
            this.warnedKeysByObject.set(object, warnedKeys);
        }
        if (!warnedKeys.has(key)) {
            warnedKeys.add(key);
            this.logger.warn(message, object);
        }
    }
}

function attributeValueContainsToken(attributeName, token) {
    return `[${attributeName}~="${token}"]`;
}

class TargetSet {
    constructor(scope) {
        this.scope = scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(targetName) {
        return this.find(targetName) != null;
    }
    find(...targetNames) {
        return targetNames.reduce((target, targetName) => target || this.findTarget(targetName) || this.findLegacyTarget(targetName), undefined);
    }
    findAll(...targetNames) {
        return targetNames.reduce((targets, targetName) => [
            ...targets,
            ...this.findAllTargets(targetName),
            ...this.findAllLegacyTargets(targetName),
        ], []);
    }
    findTarget(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findElement(selector);
    }
    findAllTargets(targetName) {
        const selector = this.getSelectorForTargetName(targetName);
        return this.scope.findAllElements(selector);
    }
    getSelectorForTargetName(targetName) {
        const attributeName = this.schema.targetAttributeForScope(this.identifier);
        return attributeValueContainsToken(attributeName, targetName);
    }
    findLegacyTarget(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.deprecate(this.scope.findElement(selector), targetName);
    }
    findAllLegacyTargets(targetName) {
        const selector = this.getLegacySelectorForTargetName(targetName);
        return this.scope.findAllElements(selector).map((element) => this.deprecate(element, targetName));
    }
    getLegacySelectorForTargetName(targetName) {
        const targetDescriptor = `${this.identifier}.${targetName}`;
        return attributeValueContainsToken(this.schema.targetAttribute, targetDescriptor);
    }
    deprecate(element, targetName) {
        if (element) {
            const { identifier } = this;
            const attributeName = this.schema.targetAttribute;
            const revisedAttributeName = this.schema.targetAttributeForScope(identifier);
            this.guide.warn(element, `target:${targetName}`, `Please replace ${attributeName}="${identifier}.${targetName}" with ${revisedAttributeName}="${targetName}". ` +
                `The ${attributeName} attribute is deprecated and will be removed in a future version of Stimulus.`);
        }
        return element;
    }
    get guide() {
        return this.scope.guide;
    }
}

class OutletSet {
    constructor(scope, controllerElement) {
        this.scope = scope;
        this.controllerElement = controllerElement;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get schema() {
        return this.scope.schema;
    }
    has(outletName) {
        return this.find(outletName) != null;
    }
    find(...outletNames) {
        return outletNames.reduce((outlet, outletName) => outlet || this.findOutlet(outletName), undefined);
    }
    findAll(...outletNames) {
        return outletNames.reduce((outlets, outletName) => [...outlets, ...this.findAllOutlets(outletName)], []);
    }
    getSelectorForOutletName(outletName) {
        const attributeName = this.schema.outletAttributeForScope(this.identifier, outletName);
        return this.controllerElement.getAttribute(attributeName);
    }
    findOutlet(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        if (selector)
            return this.findElement(selector, outletName);
    }
    findAllOutlets(outletName) {
        const selector = this.getSelectorForOutletName(outletName);
        return selector ? this.findAllElements(selector, outletName) : [];
    }
    findElement(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName))[0];
    }
    findAllElements(selector, outletName) {
        const elements = this.scope.queryElements(selector);
        return elements.filter((element) => this.matchesElement(element, selector, outletName));
    }
    matchesElement(element, selector, outletName) {
        const controllerAttribute = element.getAttribute(this.scope.schema.controllerAttribute) || "";
        return element.matches(selector) && controllerAttribute.split(" ").includes(outletName);
    }
}

class Scope {
    constructor(schema, element, identifier, logger) {
        this.targets = new TargetSet(this);
        this.classes = new ClassMap(this);
        this.data = new DataMap(this);
        this.containsElement = (element) => {
            return element.closest(this.controllerSelector) === this.element;
        };
        this.schema = schema;
        this.element = element;
        this.identifier = identifier;
        this.guide = new Guide(logger);
        this.outlets = new OutletSet(this.documentScope, element);
    }
    findElement(selector) {
        return this.element.matches(selector) ? this.element : this.queryElements(selector).find(this.containsElement);
    }
    findAllElements(selector) {
        return [
            ...(this.element.matches(selector) ? [this.element] : []),
            ...this.queryElements(selector).filter(this.containsElement),
        ];
    }
    queryElements(selector) {
        return Array.from(this.element.querySelectorAll(selector));
    }
    get controllerSelector() {
        return attributeValueContainsToken(this.schema.controllerAttribute, this.identifier);
    }
    get isDocumentScope() {
        return this.element === document.documentElement;
    }
    get documentScope() {
        return this.isDocumentScope
            ? this
            : new Scope(this.schema, document.documentElement, this.identifier, this.guide.logger);
    }
}

class ScopeObserver {
    constructor(element, schema, delegate) {
        this.element = element;
        this.schema = schema;
        this.delegate = delegate;
        this.valueListObserver = new ValueListObserver(this.element, this.controllerAttribute, this);
        this.scopesByIdentifierByElement = new WeakMap();
        this.scopeReferenceCounts = new WeakMap();
    }
    start() {
        this.valueListObserver.start();
    }
    stop() {
        this.valueListObserver.stop();
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    parseValueForToken(token) {
        const { element, content: identifier } = token;
        return this.parseValueForElementAndIdentifier(element, identifier);
    }
    parseValueForElementAndIdentifier(element, identifier) {
        const scopesByIdentifier = this.fetchScopesByIdentifierForElement(element);
        let scope = scopesByIdentifier.get(identifier);
        if (!scope) {
            scope = this.delegate.createScopeForElementAndIdentifier(element, identifier);
            scopesByIdentifier.set(identifier, scope);
        }
        return scope;
    }
    elementMatchedValue(element, value) {
        const referenceCount = (this.scopeReferenceCounts.get(value) || 0) + 1;
        this.scopeReferenceCounts.set(value, referenceCount);
        if (referenceCount == 1) {
            this.delegate.scopeConnected(value);
        }
    }
    elementUnmatchedValue(element, value) {
        const referenceCount = this.scopeReferenceCounts.get(value);
        if (referenceCount) {
            this.scopeReferenceCounts.set(value, referenceCount - 1);
            if (referenceCount == 1) {
                this.delegate.scopeDisconnected(value);
            }
        }
    }
    fetchScopesByIdentifierForElement(element) {
        let scopesByIdentifier = this.scopesByIdentifierByElement.get(element);
        if (!scopesByIdentifier) {
            scopesByIdentifier = new Map();
            this.scopesByIdentifierByElement.set(element, scopesByIdentifier);
        }
        return scopesByIdentifier;
    }
}

class Router {
    constructor(application) {
        this.application = application;
        this.scopeObserver = new ScopeObserver(this.element, this.schema, this);
        this.scopesByIdentifier = new Multimap();
        this.modulesByIdentifier = new Map();
    }
    get element() {
        return this.application.element;
    }
    get schema() {
        return this.application.schema;
    }
    get logger() {
        return this.application.logger;
    }
    get controllerAttribute() {
        return this.schema.controllerAttribute;
    }
    get modules() {
        return Array.from(this.modulesByIdentifier.values());
    }
    get contexts() {
        return this.modules.reduce((contexts, module) => contexts.concat(module.contexts), []);
    }
    start() {
        this.scopeObserver.start();
    }
    stop() {
        this.scopeObserver.stop();
    }
    loadDefinition(definition) {
        this.unloadIdentifier(definition.identifier);
        const module = new Module(this.application, definition);
        this.connectModule(module);
        const afterLoad = definition.controllerConstructor.afterLoad;
        if (afterLoad) {
            afterLoad.call(definition.controllerConstructor, definition.identifier, this.application);
        }
    }
    unloadIdentifier(identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            this.disconnectModule(module);
        }
    }
    getContextForElementAndIdentifier(element, identifier) {
        const module = this.modulesByIdentifier.get(identifier);
        if (module) {
            return module.contexts.find((context) => context.element == element);
        }
    }
    proposeToConnectScopeForElementAndIdentifier(element, identifier) {
        const scope = this.scopeObserver.parseValueForElementAndIdentifier(element, identifier);
        if (scope) {
            this.scopeObserver.elementMatchedValue(scope.element, scope);
        }
        else {
            console.error(`Couldn't find or create scope for identifier: "${identifier}" and element:`, element);
        }
    }
    handleError(error, message, detail) {
        this.application.handleError(error, message, detail);
    }
    createScopeForElementAndIdentifier(element, identifier) {
        return new Scope(this.schema, element, identifier, this.logger);
    }
    scopeConnected(scope) {
        this.scopesByIdentifier.add(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.connectContextForScope(scope);
        }
    }
    scopeDisconnected(scope) {
        this.scopesByIdentifier.delete(scope.identifier, scope);
        const module = this.modulesByIdentifier.get(scope.identifier);
        if (module) {
            module.disconnectContextForScope(scope);
        }
    }
    connectModule(module) {
        this.modulesByIdentifier.set(module.identifier, module);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.connectContextForScope(scope));
    }
    disconnectModule(module) {
        this.modulesByIdentifier.delete(module.identifier);
        const scopes = this.scopesByIdentifier.getValuesForKey(module.identifier);
        scopes.forEach((scope) => module.disconnectContextForScope(scope));
    }
}

const defaultSchema = {
    controllerAttribute: "data-controller",
    actionAttribute: "data-action",
    targetAttribute: "data-target",
    targetAttributeForScope: (identifier) => `data-${identifier}-target`,
    outletAttributeForScope: (identifier, outlet) => `data-${identifier}-${outlet}-outlet`,
    keyMappings: Object.assign(Object.assign({ enter: "Enter", tab: "Tab", esc: "Escape", space: " ", up: "ArrowUp", down: "ArrowDown", left: "ArrowLeft", right: "ArrowRight", home: "Home", end: "End", page_up: "PageUp", page_down: "PageDown" }, objectFromEntries("abcdefghijklmnopqrstuvwxyz".split("").map((c) => [c, c]))), objectFromEntries("0123456789".split("").map((n) => [n, n]))),
};
function objectFromEntries(array) {
    return array.reduce((memo, [k, v]) => (Object.assign(Object.assign({}, memo), { [k]: v })), {});
}

class Application {
    constructor(element = document.documentElement, schema = defaultSchema) {
        this.logger = console;
        this.debug = false;
        this.logDebugActivity = (identifier, functionName, detail = {}) => {
            if (this.debug) {
                this.logFormattedMessage(identifier, functionName, detail);
            }
        };
        this.element = element;
        this.schema = schema;
        this.dispatcher = new Dispatcher(this);
        this.router = new Router(this);
        this.actionDescriptorFilters = Object.assign({}, defaultActionDescriptorFilters);
    }
    static start(element, schema) {
        const application = new this(element, schema);
        application.start();
        return application;
    }
    async start() {
        await domReady();
        this.logDebugActivity("application", "starting");
        this.dispatcher.start();
        this.router.start();
        this.logDebugActivity("application", "start");
    }
    stop() {
        this.logDebugActivity("application", "stopping");
        this.dispatcher.stop();
        this.router.stop();
        this.logDebugActivity("application", "stop");
    }
    register(identifier, controllerConstructor) {
        this.load({ identifier, controllerConstructor });
    }
    registerActionOption(name, filter) {
        this.actionDescriptorFilters[name] = filter;
    }
    load(head, ...rest) {
        const definitions = Array.isArray(head) ? head : [head, ...rest];
        definitions.forEach((definition) => {
            if (definition.controllerConstructor.shouldLoad) {
                this.router.loadDefinition(definition);
            }
        });
    }
    unload(head, ...rest) {
        const identifiers = Array.isArray(head) ? head : [head, ...rest];
        identifiers.forEach((identifier) => this.router.unloadIdentifier(identifier));
    }
    get controllers() {
        return this.router.contexts.map((context) => context.controller);
    }
    getControllerForElementAndIdentifier(element, identifier) {
        const context = this.router.getContextForElementAndIdentifier(element, identifier);
        return context ? context.controller : null;
    }
    handleError(error, message, detail) {
        var _a;
        this.logger.error(`%s\n\n%o\n\n%o`, message, error, detail);
        (_a = window.onerror) === null || _a === void 0 ? void 0 : _a.call(window, message, "", 0, 0, error);
    }
    logFormattedMessage(identifier, functionName, detail = {}) {
        detail = Object.assign({ application: this }, detail);
        this.logger.groupCollapsed(`${identifier} #${functionName}`);
        this.logger.log("details:", Object.assign({}, detail));
        this.logger.groupEnd();
    }
}
function domReady() {
    return new Promise((resolve) => {
        if (document.readyState == "loading") {
            document.addEventListener("DOMContentLoaded", () => resolve());
        }
        else {
            resolve();
        }
    });
}

function ClassPropertiesBlessing(constructor) {
    const classes = readInheritableStaticArrayValues(constructor, "classes");
    return classes.reduce((properties, classDefinition) => {
        return Object.assign(properties, propertiesForClassDefinition(classDefinition));
    }, {});
}
function propertiesForClassDefinition(key) {
    return {
        [`${key}Class`]: {
            get() {
                const { classes } = this;
                if (classes.has(key)) {
                    return classes.get(key);
                }
                else {
                    const attribute = classes.getAttributeName(key);
                    throw new Error(`Missing attribute "${attribute}"`);
                }
            },
        },
        [`${key}Classes`]: {
            get() {
                return this.classes.getAll(key);
            },
        },
        [`has${capitalize(key)}Class`]: {
            get() {
                return this.classes.has(key);
            },
        },
    };
}

function OutletPropertiesBlessing(constructor) {
    const outlets = readInheritableStaticArrayValues(constructor, "outlets");
    return outlets.reduce((properties, outletDefinition) => {
        return Object.assign(properties, propertiesForOutletDefinition(outletDefinition));
    }, {});
}
function getOutletController(controller, element, identifier) {
    return controller.application.getControllerForElementAndIdentifier(element, identifier);
}
function getControllerAndEnsureConnectedScope(controller, element, outletName) {
    let outletController = getOutletController(controller, element, outletName);
    if (outletController)
        return outletController;
    controller.application.router.proposeToConnectScopeForElementAndIdentifier(element, outletName);
    outletController = getOutletController(controller, element, outletName);
    if (outletController)
        return outletController;
}
function propertiesForOutletDefinition(name) {
    const camelizedName = namespaceCamelize(name);
    return {
        [`${camelizedName}Outlet`]: {
            get() {
                const outletElement = this.outlets.find(name);
                const selector = this.outlets.getSelectorForOutletName(name);
                if (outletElement) {
                    const outletController = getControllerAndEnsureConnectedScope(this, outletElement, name);
                    if (outletController)
                        return outletController;
                    throw new Error(`The provided outlet element is missing an outlet controller "${name}" instance for host controller "${this.identifier}"`);
                }
                throw new Error(`Missing outlet element "${name}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${selector}".`);
            },
        },
        [`${camelizedName}Outlets`]: {
            get() {
                const outlets = this.outlets.findAll(name);
                if (outlets.length > 0) {
                    return outlets
                        .map((outletElement) => {
                        const outletController = getControllerAndEnsureConnectedScope(this, outletElement, name);
                        if (outletController)
                            return outletController;
                        console.warn(`The provided outlet element is missing an outlet controller "${name}" instance for host controller "${this.identifier}"`, outletElement);
                    })
                        .filter((controller) => controller);
                }
                return [];
            },
        },
        [`${camelizedName}OutletElement`]: {
            get() {
                const outletElement = this.outlets.find(name);
                const selector = this.outlets.getSelectorForOutletName(name);
                if (outletElement) {
                    return outletElement;
                }
                else {
                    throw new Error(`Missing outlet element "${name}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${selector}".`);
                }
            },
        },
        [`${camelizedName}OutletElements`]: {
            get() {
                return this.outlets.findAll(name);
            },
        },
        [`has${capitalize(camelizedName)}Outlet`]: {
            get() {
                return this.outlets.has(name);
            },
        },
    };
}

function TargetPropertiesBlessing(constructor) {
    const targets = readInheritableStaticArrayValues(constructor, "targets");
    return targets.reduce((properties, targetDefinition) => {
        return Object.assign(properties, propertiesForTargetDefinition(targetDefinition));
    }, {});
}
function propertiesForTargetDefinition(name) {
    return {
        [`${name}Target`]: {
            get() {
                const target = this.targets.find(name);
                if (target) {
                    return target;
                }
                else {
                    throw new Error(`Missing target element "${name}" for "${this.identifier}" controller`);
                }
            },
        },
        [`${name}Targets`]: {
            get() {
                return this.targets.findAll(name);
            },
        },
        [`has${capitalize(name)}Target`]: {
            get() {
                return this.targets.has(name);
            },
        },
    };
}

function ValuePropertiesBlessing(constructor) {
    const valueDefinitionPairs = readInheritableStaticObjectPairs(constructor, "values");
    const propertyDescriptorMap = {
        valueDescriptorMap: {
            get() {
                return valueDefinitionPairs.reduce((result, valueDefinitionPair) => {
                    const valueDescriptor = parseValueDefinitionPair(valueDefinitionPair, this.identifier);
                    const attributeName = this.data.getAttributeNameForKey(valueDescriptor.key);
                    return Object.assign(result, { [attributeName]: valueDescriptor });
                }, {});
            },
        },
    };
    return valueDefinitionPairs.reduce((properties, valueDefinitionPair) => {
        return Object.assign(properties, propertiesForValueDefinitionPair(valueDefinitionPair));
    }, propertyDescriptorMap);
}
function propertiesForValueDefinitionPair(valueDefinitionPair, controller) {
    const definition = parseValueDefinitionPair(valueDefinitionPair, controller);
    const { key, name, reader: read, writer: write } = definition;
    return {
        [name]: {
            get() {
                const value = this.data.get(key);
                if (value !== null) {
                    return read(value);
                }
                else {
                    return definition.defaultValue;
                }
            },
            set(value) {
                if (value === undefined) {
                    this.data.delete(key);
                }
                else {
                    this.data.set(key, write(value));
                }
            },
        },
        [`has${capitalize(name)}`]: {
            get() {
                return this.data.has(key) || definition.hasCustomDefaultValue;
            },
        },
    };
}
function parseValueDefinitionPair([token, typeDefinition], controller) {
    return valueDescriptorForTokenAndTypeDefinition({
        controller,
        token,
        typeDefinition,
    });
}
function parseValueTypeConstant(constant) {
    switch (constant) {
        case Array:
            return "array";
        case Boolean:
            return "boolean";
        case Number:
            return "number";
        case Object:
            return "object";
        case String:
            return "string";
    }
}
function parseValueTypeDefault(defaultValue) {
    switch (typeof defaultValue) {
        case "boolean":
            return "boolean";
        case "number":
            return "number";
        case "string":
            return "string";
    }
    if (Array.isArray(defaultValue))
        return "array";
    if (Object.prototype.toString.call(defaultValue) === "[object Object]")
        return "object";
}
function parseValueTypeObject(payload) {
    const { controller, token, typeObject } = payload;
    const hasType = isSomething(typeObject.type);
    const hasDefault = isSomething(typeObject.default);
    const fullObject = hasType && hasDefault;
    const onlyType = hasType && !hasDefault;
    const onlyDefault = !hasType && hasDefault;
    const typeFromObject = parseValueTypeConstant(typeObject.type);
    const typeFromDefaultValue = parseValueTypeDefault(payload.typeObject.default);
    if (onlyType)
        return typeFromObject;
    if (onlyDefault)
        return typeFromDefaultValue;
    if (typeFromObject !== typeFromDefaultValue) {
        const propertyPath = controller ? `${controller}.${token}` : token;
        throw new Error(`The specified default value for the Stimulus Value "${propertyPath}" must match the defined type "${typeFromObject}". The provided default value of "${typeObject.default}" is of type "${typeFromDefaultValue}".`);
    }
    if (fullObject)
        return typeFromObject;
}
function parseValueTypeDefinition(payload) {
    const { controller, token, typeDefinition } = payload;
    const typeObject = { controller, token, typeObject: typeDefinition };
    const typeFromObject = parseValueTypeObject(typeObject);
    const typeFromDefaultValue = parseValueTypeDefault(typeDefinition);
    const typeFromConstant = parseValueTypeConstant(typeDefinition);
    const type = typeFromObject || typeFromDefaultValue || typeFromConstant;
    if (type)
        return type;
    const propertyPath = controller ? `${controller}.${typeDefinition}` : token;
    throw new Error(`Unknown value type "${propertyPath}" for "${token}" value`);
}
function defaultValueForDefinition(typeDefinition) {
    const constant = parseValueTypeConstant(typeDefinition);
    if (constant)
        return defaultValuesByType[constant];
    const hasDefault = hasProperty(typeDefinition, "default");
    const hasType = hasProperty(typeDefinition, "type");
    const typeObject = typeDefinition;
    if (hasDefault)
        return typeObject.default;
    if (hasType) {
        const { type } = typeObject;
        const constantFromType = parseValueTypeConstant(type);
        if (constantFromType)
            return defaultValuesByType[constantFromType];
    }
    return typeDefinition;
}
function valueDescriptorForTokenAndTypeDefinition(payload) {
    const { token, typeDefinition } = payload;
    const key = `${dasherize(token)}-value`;
    const type = parseValueTypeDefinition(payload);
    return {
        type,
        key,
        name: camelize(key),
        get defaultValue() {
            return defaultValueForDefinition(typeDefinition);
        },
        get hasCustomDefaultValue() {
            return parseValueTypeDefault(typeDefinition) !== undefined;
        },
        reader: readers[type],
        writer: writers[type] || writers.default,
    };
}
const defaultValuesByType = {
    get array() {
        return [];
    },
    boolean: false,
    number: 0,
    get object() {
        return {};
    },
    string: "",
};
const readers = {
    array(value) {
        const array = JSON.parse(value);
        if (!Array.isArray(array)) {
            throw new TypeError(`expected value of type "array" but instead got value "${value}" of type "${parseValueTypeDefault(array)}"`);
        }
        return array;
    },
    boolean(value) {
        return !(value == "0" || String(value).toLowerCase() == "false");
    },
    number(value) {
        return Number(value.replace(/_/g, ""));
    },
    object(value) {
        const object = JSON.parse(value);
        if (object === null || typeof object != "object" || Array.isArray(object)) {
            throw new TypeError(`expected value of type "object" but instead got value "${value}" of type "${parseValueTypeDefault(object)}"`);
        }
        return object;
    },
    string(value) {
        return value;
    },
};
const writers = {
    default: writeString,
    array: writeJSON,
    object: writeJSON,
};
function writeJSON(value) {
    return JSON.stringify(value);
}
function writeString(value) {
    return `${value}`;
}

class Controller {
    constructor(context) {
        this.context = context;
    }
    static get shouldLoad() {
        return true;
    }
    static afterLoad(_identifier, _application) {
        return;
    }
    get application() {
        return this.context.application;
    }
    get scope() {
        return this.context.scope;
    }
    get element() {
        return this.scope.element;
    }
    get identifier() {
        return this.scope.identifier;
    }
    get targets() {
        return this.scope.targets;
    }
    get outlets() {
        return this.scope.outlets;
    }
    get classes() {
        return this.scope.classes;
    }
    get data() {
        return this.scope.data;
    }
    initialize() {
    }
    connect() {
    }
    disconnect() {
    }
    dispatch(eventName, { target = this.element, detail = {}, prefix = this.identifier, bubbles = true, cancelable = true, } = {}) {
        const type = prefix ? `${prefix}:${eventName}` : eventName;
        const event = new CustomEvent(type, { detail, bubbles, cancelable });
        target.dispatchEvent(event);
        return event;
    }
}
Controller.blessings = [
    ClassPropertiesBlessing,
    TargetPropertiesBlessing,
    ValuePropertiesBlessing,
    OutletPropertiesBlessing,
];
Controller.targets = [];
Controller.outlets = [];
Controller.values = {};




/***/ }),

/***/ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js":
/*!***************************************************************!*\
  !*** ./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FetchEnctype: function() { return /* binding */ FetchEnctype; },
/* harmony export */   FetchMethod: function() { return /* binding */ FetchMethod; },
/* harmony export */   FetchRequest: function() { return /* binding */ FetchRequest; },
/* harmony export */   FetchResponse: function() { return /* binding */ FetchResponse; },
/* harmony export */   FrameElement: function() { return /* binding */ FrameElement; },
/* harmony export */   FrameLoadingStyle: function() { return /* binding */ FrameLoadingStyle; },
/* harmony export */   FrameRenderer: function() { return /* binding */ FrameRenderer; },
/* harmony export */   PageRenderer: function() { return /* binding */ PageRenderer; },
/* harmony export */   PageSnapshot: function() { return /* binding */ PageSnapshot; },
/* harmony export */   StreamActions: function() { return /* binding */ StreamActions; },
/* harmony export */   StreamElement: function() { return /* binding */ StreamElement; },
/* harmony export */   StreamSourceElement: function() { return /* binding */ StreamSourceElement; },
/* harmony export */   cache: function() { return /* binding */ cache; },
/* harmony export */   clearCache: function() { return /* binding */ clearCache; },
/* harmony export */   config: function() { return /* binding */ config; },
/* harmony export */   connectStreamSource: function() { return /* binding */ connectStreamSource; },
/* harmony export */   disconnectStreamSource: function() { return /* binding */ disconnectStreamSource; },
/* harmony export */   fetch: function() { return /* binding */ fetchWithTurboHeaders; },
/* harmony export */   fetchEnctypeFromString: function() { return /* binding */ fetchEnctypeFromString; },
/* harmony export */   fetchMethodFromString: function() { return /* binding */ fetchMethodFromString; },
/* harmony export */   isSafe: function() { return /* binding */ isSafe; },
/* harmony export */   navigator: function() { return /* binding */ navigator$1; },
/* harmony export */   registerAdapter: function() { return /* binding */ registerAdapter; },
/* harmony export */   renderStreamMessage: function() { return /* binding */ renderStreamMessage; },
/* harmony export */   session: function() { return /* binding */ session; },
/* harmony export */   setConfirmMethod: function() { return /* binding */ setConfirmMethod; },
/* harmony export */   setFormMode: function() { return /* binding */ setFormMode; },
/* harmony export */   setProgressBarDelay: function() { return /* binding */ setProgressBarDelay; },
/* harmony export */   start: function() { return /* binding */ start; },
/* harmony export */   visit: function() { return /* binding */ visit; }
/* harmony export */ });
/*!
Turbo 8.0.12
Copyright © 2024 37signals LLC
 */
/**
 * The MIT License (MIT)
 *
 * Copyright (c) 2019 Javan Makhmali
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

(function (prototype) {
  if (typeof prototype.requestSubmit == "function") return

  prototype.requestSubmit = function (submitter) {
    if (submitter) {
      validateSubmitter(submitter, this);
      submitter.click();
    } else {
      submitter = document.createElement("input");
      submitter.type = "submit";
      submitter.hidden = true;
      this.appendChild(submitter);
      submitter.click();
      this.removeChild(submitter);
    }
  };

  function validateSubmitter(submitter, form) {
    submitter instanceof HTMLElement || raise(TypeError, "parameter 1 is not of type 'HTMLElement'");
    submitter.type == "submit" || raise(TypeError, "The specified element is not a submit button");
    submitter.form == form ||
      raise(DOMException, "The specified element is not owned by this form element", "NotFoundError");
  }

  function raise(errorConstructor, message, name) {
    throw new errorConstructor("Failed to execute 'requestSubmit' on 'HTMLFormElement': " + message + ".", name)
  }
})(HTMLFormElement.prototype);

const submittersByForm = new WeakMap();

function findSubmitterFromClickTarget(target) {
  const element = target instanceof Element ? target : target instanceof Node ? target.parentElement : null;
  const candidate = element ? element.closest("input, button") : null;
  return candidate?.type == "submit" ? candidate : null
}

function clickCaptured(event) {
  const submitter = findSubmitterFromClickTarget(event.target);

  if (submitter && submitter.form) {
    submittersByForm.set(submitter.form, submitter);
  }
}

(function () {
  if ("submitter" in Event.prototype) return

  let prototype = window.Event.prototype;
  // Certain versions of Safari 15 have a bug where they won't
  // populate the submitter. This hurts TurboDrive's enable/disable detection.
  // See https://bugs.webkit.org/show_bug.cgi?id=229660
  if ("SubmitEvent" in window) {
    const prototypeOfSubmitEvent = window.SubmitEvent.prototype;

    if (/Apple Computer/.test(navigator.vendor) && !("submitter" in prototypeOfSubmitEvent)) {
      prototype = prototypeOfSubmitEvent;
    } else {
      return // polyfill not needed
    }
  }

  addEventListener("click", clickCaptured, true);

  Object.defineProperty(prototype, "submitter", {
    get() {
      if (this.type == "submit" && this.target instanceof HTMLFormElement) {
        return submittersByForm.get(this.target)
      }
    }
  });
})();

const FrameLoadingStyle = {
  eager: "eager",
  lazy: "lazy"
};

/**
 * Contains a fragment of HTML which is updated based on navigation within
 * it (e.g. via links or form submissions).
 *
 * @customElement turbo-frame
 * @example
 *   <turbo-frame id="messages">
 *     <a href="/messages/expanded">
 *       Show all expanded messages in this frame.
 *     </a>
 *
 *     <form action="/messages">
 *       Show response from this form within this frame.
 *     </form>
 *   </turbo-frame>
 */
class FrameElement extends HTMLElement {
  static delegateConstructor = undefined

  loaded = Promise.resolve()

  static get observedAttributes() {
    return ["disabled", "loading", "src"]
  }

  constructor() {
    super();
    this.delegate = new FrameElement.delegateConstructor(this);
  }

  connectedCallback() {
    this.delegate.connect();
  }

  disconnectedCallback() {
    this.delegate.disconnect();
  }

  reload() {
    return this.delegate.sourceURLReloaded()
  }

  attributeChangedCallback(name) {
    if (name == "loading") {
      this.delegate.loadingStyleChanged();
    } else if (name == "src") {
      this.delegate.sourceURLChanged();
    } else if (name == "disabled") {
      this.delegate.disabledChanged();
    }
  }

  /**
   * Gets the URL to lazily load source HTML from
   */
  get src() {
    return this.getAttribute("src")
  }

  /**
   * Sets the URL to lazily load source HTML from
   */
  set src(value) {
    if (value) {
      this.setAttribute("src", value);
    } else {
      this.removeAttribute("src");
    }
  }

  /**
   * Gets the refresh mode for the frame.
   */
  get refresh() {
    return this.getAttribute("refresh")
  }

  /**
   * Sets the refresh mode for the frame.
   */
  set refresh(value) {
    if (value) {
      this.setAttribute("refresh", value);
    } else {
      this.removeAttribute("refresh");
    }
  }

  get shouldReloadWithMorph() {
    return this.src && this.refresh === "morph"
  }

  /**
   * Determines if the element is loading
   */
  get loading() {
    return frameLoadingStyleFromString(this.getAttribute("loading") || "")
  }

  /**
   * Sets the value of if the element is loading
   */
  set loading(value) {
    if (value) {
      this.setAttribute("loading", value);
    } else {
      this.removeAttribute("loading");
    }
  }

  /**
   * Gets the disabled state of the frame.
   *
   * If disabled, no requests will be intercepted by the frame.
   */
  get disabled() {
    return this.hasAttribute("disabled")
  }

  /**
   * Sets the disabled state of the frame.
   *
   * If disabled, no requests will be intercepted by the frame.
   */
  set disabled(value) {
    if (value) {
      this.setAttribute("disabled", "");
    } else {
      this.removeAttribute("disabled");
    }
  }

  /**
   * Gets the autoscroll state of the frame.
   *
   * If true, the frame will be scrolled into view automatically on update.
   */
  get autoscroll() {
    return this.hasAttribute("autoscroll")
  }

  /**
   * Sets the autoscroll state of the frame.
   *
   * If true, the frame will be scrolled into view automatically on update.
   */
  set autoscroll(value) {
    if (value) {
      this.setAttribute("autoscroll", "");
    } else {
      this.removeAttribute("autoscroll");
    }
  }

  /**
   * Determines if the element has finished loading
   */
  get complete() {
    return !this.delegate.isLoading
  }

  /**
   * Gets the active state of the frame.
   *
   * If inactive, source changes will not be observed.
   */
  get isActive() {
    return this.ownerDocument === document && !this.isPreview
  }

  /**
   * Sets the active state of the frame.
   *
   * If inactive, source changes will not be observed.
   */
  get isPreview() {
    return this.ownerDocument?.documentElement?.hasAttribute("data-turbo-preview")
  }
}

function frameLoadingStyleFromString(style) {
  switch (style.toLowerCase()) {
    case "lazy":
      return FrameLoadingStyle.lazy
    default:
      return FrameLoadingStyle.eager
  }
}

const drive = {
  enabled: true,
  progressBarDelay: 500,
  unvisitableExtensions: new Set(
    [
      ".7z", ".aac", ".apk", ".avi", ".bmp", ".bz2", ".css", ".csv", ".deb", ".dmg", ".doc",
      ".docx", ".exe", ".gif", ".gz", ".heic", ".heif", ".ico", ".iso", ".jpeg", ".jpg",
      ".js", ".json", ".m4a", ".mkv", ".mov", ".mp3", ".mp4", ".mpeg", ".mpg", ".msi",
      ".ogg", ".ogv", ".pdf", ".pkg", ".png", ".ppt", ".pptx", ".rar", ".rtf",
      ".svg", ".tar", ".tif", ".tiff", ".txt", ".wav", ".webm", ".webp", ".wma", ".wmv",
      ".xls", ".xlsx", ".xml", ".zip"
    ]
  )
};

function activateScriptElement(element) {
  if (element.getAttribute("data-turbo-eval") == "false") {
    return element
  } else {
    const createdScriptElement = document.createElement("script");
    const cspNonce = getCspNonce();
    if (cspNonce) {
      createdScriptElement.nonce = cspNonce;
    }
    createdScriptElement.textContent = element.textContent;
    createdScriptElement.async = false;
    copyElementAttributes(createdScriptElement, element);
    return createdScriptElement
  }
}

function copyElementAttributes(destinationElement, sourceElement) {
  for (const { name, value } of sourceElement.attributes) {
    destinationElement.setAttribute(name, value);
  }
}

function createDocumentFragment(html) {
  const template = document.createElement("template");
  template.innerHTML = html;
  return template.content
}

function dispatch(eventName, { target, cancelable, detail } = {}) {
  const event = new CustomEvent(eventName, {
    cancelable,
    bubbles: true,
    composed: true,
    detail
  });

  if (target && target.isConnected) {
    target.dispatchEvent(event);
  } else {
    document.documentElement.dispatchEvent(event);
  }

  return event
}

function cancelEvent(event) {
  event.preventDefault();
  event.stopImmediatePropagation();
}

function nextRepaint() {
  if (document.visibilityState === "hidden") {
    return nextEventLoopTick()
  } else {
    return nextAnimationFrame()
  }
}

function nextAnimationFrame() {
  return new Promise((resolve) => requestAnimationFrame(() => resolve()))
}

function nextEventLoopTick() {
  return new Promise((resolve) => setTimeout(() => resolve(), 0))
}

function nextMicrotask() {
  return Promise.resolve()
}

function parseHTMLDocument(html = "") {
  return new DOMParser().parseFromString(html, "text/html")
}

function unindent(strings, ...values) {
  const lines = interpolate(strings, values).replace(/^\n/, "").split("\n");
  const match = lines[0].match(/^\s+/);
  const indent = match ? match[0].length : 0;
  return lines.map((line) => line.slice(indent)).join("\n")
}

function interpolate(strings, values) {
  return strings.reduce((result, string, i) => {
    const value = values[i] == undefined ? "" : values[i];
    return result + string + value
  }, "")
}

function uuid() {
  return Array.from({ length: 36 })
    .map((_, i) => {
      if (i == 8 || i == 13 || i == 18 || i == 23) {
        return "-"
      } else if (i == 14) {
        return "4"
      } else if (i == 19) {
        return (Math.floor(Math.random() * 4) + 8).toString(16)
      } else {
        return Math.floor(Math.random() * 15).toString(16)
      }
    })
    .join("")
}

function getAttribute(attributeName, ...elements) {
  for (const value of elements.map((element) => element?.getAttribute(attributeName))) {
    if (typeof value == "string") return value
  }

  return null
}

function hasAttribute(attributeName, ...elements) {
  return elements.some((element) => element && element.hasAttribute(attributeName))
}

function markAsBusy(...elements) {
  for (const element of elements) {
    if (element.localName == "turbo-frame") {
      element.setAttribute("busy", "");
    }
    element.setAttribute("aria-busy", "true");
  }
}

function clearBusyState(...elements) {
  for (const element of elements) {
    if (element.localName == "turbo-frame") {
      element.removeAttribute("busy");
    }

    element.removeAttribute("aria-busy");
  }
}

function waitForLoad(element, timeoutInMilliseconds = 2000) {
  return new Promise((resolve) => {
    const onComplete = () => {
      element.removeEventListener("error", onComplete);
      element.removeEventListener("load", onComplete);
      resolve();
    };

    element.addEventListener("load", onComplete, { once: true });
    element.addEventListener("error", onComplete, { once: true });
    setTimeout(resolve, timeoutInMilliseconds);
  })
}

function getHistoryMethodForAction(action) {
  switch (action) {
    case "replace":
      return history.replaceState
    case "advance":
    case "restore":
      return history.pushState
  }
}

function isAction(action) {
  return action == "advance" || action == "replace" || action == "restore"
}

function getVisitAction(...elements) {
  const action = getAttribute("data-turbo-action", ...elements);

  return isAction(action) ? action : null
}

function getMetaElement(name) {
  return document.querySelector(`meta[name="${name}"]`)
}

function getMetaContent(name) {
  const element = getMetaElement(name);
  return element && element.content
}

function getCspNonce() {
  const element = getMetaElement("csp-nonce");

  if (element) {
    const { nonce, content } = element;
    return nonce == "" ? content : nonce
  }
}

function setMetaContent(name, content) {
  let element = getMetaElement(name);

  if (!element) {
    element = document.createElement("meta");
    element.setAttribute("name", name);

    document.head.appendChild(element);
  }

  element.setAttribute("content", content);

  return element
}

function findClosestRecursively(element, selector) {
  if (element instanceof Element) {
    return (
      element.closest(selector) || findClosestRecursively(element.assignedSlot || element.getRootNode()?.host, selector)
    )
  }
}

function elementIsFocusable(element) {
  const inertDisabledOrHidden = "[inert], :disabled, [hidden], details:not([open]), dialog:not([open])";

  return !!element && element.closest(inertDisabledOrHidden) == null && typeof element.focus == "function"
}

function queryAutofocusableElement(elementOrDocumentFragment) {
  return Array.from(elementOrDocumentFragment.querySelectorAll("[autofocus]")).find(elementIsFocusable)
}

async function around(callback, reader) {
  const before = reader();

  callback();

  await nextAnimationFrame();

  const after = reader();

  return [before, after]
}

function doesNotTargetIFrame(name) {
  if (name === "_blank") {
    return false
  } else if (name) {
    for (const element of document.getElementsByName(name)) {
      if (element instanceof HTMLIFrameElement) return false
    }

    return true
  } else {
    return true
  }
}

function findLinkFromClickTarget(target) {
  return findClosestRecursively(target, "a[href]:not([target^=_]):not([download])")
}

function getLocationForLink(link) {
  return expandURL(link.getAttribute("href") || "")
}

function debounce(fn, delay) {
  let timeoutId = null;

  return (...args) => {
    const callback = () => fn.apply(this, args);
    clearTimeout(timeoutId);
    timeoutId = setTimeout(callback, delay);
  }
}

const submitter = {
  "aria-disabled": {
    beforeSubmit: submitter => {
      submitter.setAttribute("aria-disabled", "true");
      submitter.addEventListener("click", cancelEvent);
    },

    afterSubmit: submitter => {
      submitter.removeAttribute("aria-disabled");
      submitter.removeEventListener("click", cancelEvent);
    }
  },

  "disabled": {
    beforeSubmit: submitter => submitter.disabled = true,
    afterSubmit: submitter => submitter.disabled = false
  }
};

class Config {
  #submitter = null

  constructor(config) {
    Object.assign(this, config);
  }

  get submitter() {
    return this.#submitter
  }

  set submitter(value) {
    this.#submitter = submitter[value] || value;
  }
}

const forms = new Config({
  mode: "on",
  submitter: "disabled"
});

const config = {
  drive,
  forms
};

function expandURL(locatable) {
  return new URL(locatable.toString(), document.baseURI)
}

function getAnchor(url) {
  let anchorMatch;
  if (url.hash) {
    return url.hash.slice(1)
    // eslint-disable-next-line no-cond-assign
  } else if ((anchorMatch = url.href.match(/#(.*)$/))) {
    return anchorMatch[1]
  }
}

function getAction$1(form, submitter) {
  const action = submitter?.getAttribute("formaction") || form.getAttribute("action") || form.action;

  return expandURL(action)
}

function getExtension(url) {
  return (getLastPathComponent(url).match(/\.[^.]*$/) || [])[0] || ""
}

function isPrefixedBy(baseURL, url) {
  const prefix = getPrefix(url);
  return baseURL.href === expandURL(prefix).href || baseURL.href.startsWith(prefix)
}

function locationIsVisitable(location, rootLocation) {
  return isPrefixedBy(location, rootLocation) && !config.drive.unvisitableExtensions.has(getExtension(location))
}

function getRequestURL(url) {
  const anchor = getAnchor(url);
  return anchor != null ? url.href.slice(0, -(anchor.length + 1)) : url.href
}

function toCacheKey(url) {
  return getRequestURL(url)
}

function urlsAreEqual(left, right) {
  return expandURL(left).href == expandURL(right).href
}

function getPathComponents(url) {
  return url.pathname.split("/").slice(1)
}

function getLastPathComponent(url) {
  return getPathComponents(url).slice(-1)[0]
}

function getPrefix(url) {
  return addTrailingSlash(url.origin + url.pathname)
}

function addTrailingSlash(value) {
  return value.endsWith("/") ? value : value + "/"
}

class FetchResponse {
  constructor(response) {
    this.response = response;
  }

  get succeeded() {
    return this.response.ok
  }

  get failed() {
    return !this.succeeded
  }

  get clientError() {
    return this.statusCode >= 400 && this.statusCode <= 499
  }

  get serverError() {
    return this.statusCode >= 500 && this.statusCode <= 599
  }

  get redirected() {
    return this.response.redirected
  }

  get location() {
    return expandURL(this.response.url)
  }

  get isHTML() {
    return this.contentType && this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)
  }

  get statusCode() {
    return this.response.status
  }

  get contentType() {
    return this.header("Content-Type")
  }

  get responseText() {
    return this.response.clone().text()
  }

  get responseHTML() {
    if (this.isHTML) {
      return this.response.clone().text()
    } else {
      return Promise.resolve(undefined)
    }
  }

  header(name) {
    return this.response.headers.get(name)
  }
}

class LimitedSet extends Set {
  constructor(maxSize) {
    super();
    this.maxSize = maxSize;
  }

  add(value) {
    if (this.size >= this.maxSize) {
      const iterator = this.values();
      const oldestValue = iterator.next().value;
      this.delete(oldestValue);
    }
    super.add(value);
  }
}

const recentRequests = new LimitedSet(20);

const nativeFetch = window.fetch;

function fetchWithTurboHeaders(url, options = {}) {
  const modifiedHeaders = new Headers(options.headers || {});
  const requestUID = uuid();
  recentRequests.add(requestUID);
  modifiedHeaders.append("X-Turbo-Request-Id", requestUID);

  return nativeFetch(url, {
    ...options,
    headers: modifiedHeaders
  })
}

function fetchMethodFromString(method) {
  switch (method.toLowerCase()) {
    case "get":
      return FetchMethod.get
    case "post":
      return FetchMethod.post
    case "put":
      return FetchMethod.put
    case "patch":
      return FetchMethod.patch
    case "delete":
      return FetchMethod.delete
  }
}

const FetchMethod = {
  get: "get",
  post: "post",
  put: "put",
  patch: "patch",
  delete: "delete"
};

function fetchEnctypeFromString(encoding) {
  switch (encoding.toLowerCase()) {
    case FetchEnctype.multipart:
      return FetchEnctype.multipart
    case FetchEnctype.plain:
      return FetchEnctype.plain
    default:
      return FetchEnctype.urlEncoded
  }
}

const FetchEnctype = {
  urlEncoded: "application/x-www-form-urlencoded",
  multipart: "multipart/form-data",
  plain: "text/plain"
};

class FetchRequest {
  abortController = new AbortController()
  #resolveRequestPromise = (_value) => {}

  constructor(delegate, method, location, requestBody = new URLSearchParams(), target = null, enctype = FetchEnctype.urlEncoded) {
    const [url, body] = buildResourceAndBody(expandURL(location), method, requestBody, enctype);

    this.delegate = delegate;
    this.url = url;
    this.target = target;
    this.fetchOptions = {
      credentials: "same-origin",
      redirect: "follow",
      method: method.toUpperCase(),
      headers: { ...this.defaultHeaders },
      body: body,
      signal: this.abortSignal,
      referrer: this.delegate.referrer?.href
    };
    this.enctype = enctype;
  }

  get method() {
    return this.fetchOptions.method
  }

  set method(value) {
    const fetchBody = this.isSafe ? this.url.searchParams : this.fetchOptions.body || new FormData();
    const fetchMethod = fetchMethodFromString(value) || FetchMethod.get;

    this.url.search = "";

    const [url, body] = buildResourceAndBody(this.url, fetchMethod, fetchBody, this.enctype);

    this.url = url;
    this.fetchOptions.body = body;
    this.fetchOptions.method = fetchMethod.toUpperCase();
  }

  get headers() {
    return this.fetchOptions.headers
  }

  set headers(value) {
    this.fetchOptions.headers = value;
  }

  get body() {
    if (this.isSafe) {
      return this.url.searchParams
    } else {
      return this.fetchOptions.body
    }
  }

  set body(value) {
    this.fetchOptions.body = value;
  }

  get location() {
    return this.url
  }

  get params() {
    return this.url.searchParams
  }

  get entries() {
    return this.body ? Array.from(this.body.entries()) : []
  }

  cancel() {
    this.abortController.abort();
  }

  async perform() {
    const { fetchOptions } = this;
    this.delegate.prepareRequest(this);
    const event = await this.#allowRequestToBeIntercepted(fetchOptions);
    try {
      this.delegate.requestStarted(this);

      if (event.detail.fetchRequest) {
        this.response = event.detail.fetchRequest.response;
      } else {
        this.response = fetchWithTurboHeaders(this.url.href, fetchOptions);
      }

      const response = await this.response;
      return await this.receive(response)
    } catch (error) {
      if (error.name !== "AbortError") {
        if (this.#willDelegateErrorHandling(error)) {
          this.delegate.requestErrored(this, error);
        }
        throw error
      }
    } finally {
      this.delegate.requestFinished(this);
    }
  }

  async receive(response) {
    const fetchResponse = new FetchResponse(response);
    const event = dispatch("turbo:before-fetch-response", {
      cancelable: true,
      detail: { fetchResponse },
      target: this.target
    });
    if (event.defaultPrevented) {
      this.delegate.requestPreventedHandlingResponse(this, fetchResponse);
    } else if (fetchResponse.succeeded) {
      this.delegate.requestSucceededWithResponse(this, fetchResponse);
    } else {
      this.delegate.requestFailedWithResponse(this, fetchResponse);
    }
    return fetchResponse
  }

  get defaultHeaders() {
    return {
      Accept: "text/html, application/xhtml+xml"
    }
  }

  get isSafe() {
    return isSafe(this.method)
  }

  get abortSignal() {
    return this.abortController.signal
  }

  acceptResponseType(mimeType) {
    this.headers["Accept"] = [mimeType, this.headers["Accept"]].join(", ");
  }

  async #allowRequestToBeIntercepted(fetchOptions) {
    const requestInterception = new Promise((resolve) => (this.#resolveRequestPromise = resolve));
    const event = dispatch("turbo:before-fetch-request", {
      cancelable: true,
      detail: {
        fetchOptions,
        url: this.url,
        resume: this.#resolveRequestPromise
      },
      target: this.target
    });
    this.url = event.detail.url;
    if (event.defaultPrevented) await requestInterception;

    return event
  }

  #willDelegateErrorHandling(error) {
    const event = dispatch("turbo:fetch-request-error", {
      target: this.target,
      cancelable: true,
      detail: { request: this, error: error }
    });

    return !event.defaultPrevented
  }
}

function isSafe(fetchMethod) {
  return fetchMethodFromString(fetchMethod) == FetchMethod.get
}

function buildResourceAndBody(resource, method, requestBody, enctype) {
  const searchParams =
    Array.from(requestBody).length > 0 ? new URLSearchParams(entriesExcludingFiles(requestBody)) : resource.searchParams;

  if (isSafe(method)) {
    return [mergeIntoURLSearchParams(resource, searchParams), null]
  } else if (enctype == FetchEnctype.urlEncoded) {
    return [resource, searchParams]
  } else {
    return [resource, requestBody]
  }
}

function entriesExcludingFiles(requestBody) {
  const entries = [];

  for (const [name, value] of requestBody) {
    if (value instanceof File) continue
    else entries.push([name, value]);
  }

  return entries
}

function mergeIntoURLSearchParams(url, requestBody) {
  const searchParams = new URLSearchParams(entriesExcludingFiles(requestBody));

  url.search = searchParams.toString();

  return url
}

class AppearanceObserver {
  started = false

  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
    this.intersectionObserver = new IntersectionObserver(this.intersect);
  }

  start() {
    if (!this.started) {
      this.started = true;
      this.intersectionObserver.observe(this.element);
    }
  }

  stop() {
    if (this.started) {
      this.started = false;
      this.intersectionObserver.unobserve(this.element);
    }
  }

  intersect = (entries) => {
    const lastEntry = entries.slice(-1)[0];
    if (lastEntry?.isIntersecting) {
      this.delegate.elementAppearedInViewport(this.element);
    }
  }
}

class StreamMessage {
  static contentType = "text/vnd.turbo-stream.html"

  static wrap(message) {
    if (typeof message == "string") {
      return new this(createDocumentFragment(message))
    } else {
      return message
    }
  }

  constructor(fragment) {
    this.fragment = importStreamElements(fragment);
  }
}

function importStreamElements(fragment) {
  for (const element of fragment.querySelectorAll("turbo-stream")) {
    const streamElement = document.importNode(element, true);

    for (const inertScriptElement of streamElement.templateElement.content.querySelectorAll("script")) {
      inertScriptElement.replaceWith(activateScriptElement(inertScriptElement));
    }

    element.replaceWith(streamElement);
  }

  return fragment
}

const PREFETCH_DELAY = 100;

class PrefetchCache {
  #prefetchTimeout = null
  #prefetched = null

  get(url) {
    if (this.#prefetched && this.#prefetched.url === url && this.#prefetched.expire > Date.now()) {
      return this.#prefetched.request
    }
  }

  setLater(url, request, ttl) {
    this.clear();

    this.#prefetchTimeout = setTimeout(() => {
      request.perform();
      this.set(url, request, ttl);
      this.#prefetchTimeout = null;
    }, PREFETCH_DELAY);
  }

  set(url, request, ttl) {
    this.#prefetched = { url, request, expire: new Date(new Date().getTime() + ttl) };
  }

  clear() {
    if (this.#prefetchTimeout) clearTimeout(this.#prefetchTimeout);
    this.#prefetched = null;
  }
}

const cacheTtl = 10 * 1000;
const prefetchCache = new PrefetchCache();

const FormSubmissionState = {
  initialized: "initialized",
  requesting: "requesting",
  waiting: "waiting",
  receiving: "receiving",
  stopping: "stopping",
  stopped: "stopped"
};

class FormSubmission {
  state = FormSubmissionState.initialized

  static confirmMethod(message) {
    return Promise.resolve(confirm(message))
  }

  constructor(delegate, formElement, submitter, mustRedirect = false) {
    const method = getMethod(formElement, submitter);
    const action = getAction(getFormAction(formElement, submitter), method);
    const body = buildFormData(formElement, submitter);
    const enctype = getEnctype(formElement, submitter);

    this.delegate = delegate;
    this.formElement = formElement;
    this.submitter = submitter;
    this.fetchRequest = new FetchRequest(this, method, action, body, formElement, enctype);
    this.mustRedirect = mustRedirect;
  }

  get method() {
    return this.fetchRequest.method
  }

  set method(value) {
    this.fetchRequest.method = value;
  }

  get action() {
    return this.fetchRequest.url.toString()
  }

  set action(value) {
    this.fetchRequest.url = expandURL(value);
  }

  get body() {
    return this.fetchRequest.body
  }

  get enctype() {
    return this.fetchRequest.enctype
  }

  get isSafe() {
    return this.fetchRequest.isSafe
  }

  get location() {
    return this.fetchRequest.url
  }

  // The submission process

  async start() {
    const { initialized, requesting } = FormSubmissionState;
    const confirmationMessage = getAttribute("data-turbo-confirm", this.submitter, this.formElement);

    if (typeof confirmationMessage === "string") {
      const confirmMethod = typeof config.forms.confirm === "function" ?
        config.forms.confirm :
        FormSubmission.confirmMethod;

      const answer = await confirmMethod(confirmationMessage, this.formElement, this.submitter);
      if (!answer) {
        return
      }
    }

    if (this.state == initialized) {
      this.state = requesting;
      return this.fetchRequest.perform()
    }
  }

  stop() {
    const { stopping, stopped } = FormSubmissionState;
    if (this.state != stopping && this.state != stopped) {
      this.state = stopping;
      this.fetchRequest.cancel();
      return true
    }
  }

  // Fetch request delegate

  prepareRequest(request) {
    if (!request.isSafe) {
      const token = getCookieValue(getMetaContent("csrf-param")) || getMetaContent("csrf-token");
      if (token) {
        request.headers["X-CSRF-Token"] = token;
      }
    }

    if (this.requestAcceptsTurboStreamResponse(request)) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted(_request) {
    this.state = FormSubmissionState.waiting;
    if (this.submitter) config.forms.submitter.beforeSubmit(this.submitter);
    this.setSubmitsWith();
    markAsBusy(this.formElement);
    dispatch("turbo:submit-start", {
      target: this.formElement,
      detail: { formSubmission: this }
    });
    this.delegate.formSubmissionStarted(this);
  }

  requestPreventedHandlingResponse(request, response) {
    prefetchCache.clear();

    this.result = { success: response.succeeded, fetchResponse: response };
  }

  requestSucceededWithResponse(request, response) {
    if (response.clientError || response.serverError) {
      this.delegate.formSubmissionFailedWithResponse(this, response);
      return
    }

    prefetchCache.clear();

    if (this.requestMustRedirect(request) && responseSucceededWithoutRedirect(response)) {
      const error = new Error("Form responses must redirect to another location");
      this.delegate.formSubmissionErrored(this, error);
    } else {
      this.state = FormSubmissionState.receiving;
      this.result = { success: true, fetchResponse: response };
      this.delegate.formSubmissionSucceededWithResponse(this, response);
    }
  }

  requestFailedWithResponse(request, response) {
    this.result = { success: false, fetchResponse: response };
    this.delegate.formSubmissionFailedWithResponse(this, response);
  }

  requestErrored(request, error) {
    this.result = { success: false, error };
    this.delegate.formSubmissionErrored(this, error);
  }

  requestFinished(_request) {
    this.state = FormSubmissionState.stopped;
    if (this.submitter) config.forms.submitter.afterSubmit(this.submitter);
    this.resetSubmitterText();
    clearBusyState(this.formElement);
    dispatch("turbo:submit-end", {
      target: this.formElement,
      detail: { formSubmission: this, ...this.result }
    });
    this.delegate.formSubmissionFinished(this);
  }

  // Private

  setSubmitsWith() {
    if (!this.submitter || !this.submitsWith) return

    if (this.submitter.matches("button")) {
      this.originalSubmitText = this.submitter.innerHTML;
      this.submitter.innerHTML = this.submitsWith;
    } else if (this.submitter.matches("input")) {
      const input = this.submitter;
      this.originalSubmitText = input.value;
      input.value = this.submitsWith;
    }
  }

  resetSubmitterText() {
    if (!this.submitter || !this.originalSubmitText) return

    if (this.submitter.matches("button")) {
      this.submitter.innerHTML = this.originalSubmitText;
    } else if (this.submitter.matches("input")) {
      const input = this.submitter;
      input.value = this.originalSubmitText;
    }
  }

  requestMustRedirect(request) {
    return !request.isSafe && this.mustRedirect
  }

  requestAcceptsTurboStreamResponse(request) {
    return !request.isSafe || hasAttribute("data-turbo-stream", this.submitter, this.formElement)
  }

  get submitsWith() {
    return this.submitter?.getAttribute("data-turbo-submits-with")
  }
}

function buildFormData(formElement, submitter) {
  const formData = new FormData(formElement);
  const name = submitter?.getAttribute("name");
  const value = submitter?.getAttribute("value");

  if (name) {
    formData.append(name, value || "");
  }

  return formData
}

function getCookieValue(cookieName) {
  if (cookieName != null) {
    const cookies = document.cookie ? document.cookie.split("; ") : [];
    const cookie = cookies.find((cookie) => cookie.startsWith(cookieName));
    if (cookie) {
      const value = cookie.split("=").slice(1).join("=");
      return value ? decodeURIComponent(value) : undefined
    }
  }
}

function responseSucceededWithoutRedirect(response) {
  return response.statusCode == 200 && !response.redirected
}

function getFormAction(formElement, submitter) {
  const formElementAction = typeof formElement.action === "string" ? formElement.action : null;

  if (submitter?.hasAttribute("formaction")) {
    return submitter.getAttribute("formaction") || ""
  } else {
    return formElement.getAttribute("action") || formElementAction || ""
  }
}

function getAction(formAction, fetchMethod) {
  const action = expandURL(formAction);

  if (isSafe(fetchMethod)) {
    action.search = "";
  }

  return action
}

function getMethod(formElement, submitter) {
  const method = submitter?.getAttribute("formmethod") || formElement.getAttribute("method") || "";
  return fetchMethodFromString(method.toLowerCase()) || FetchMethod.get
}

function getEnctype(formElement, submitter) {
  return fetchEnctypeFromString(submitter?.getAttribute("formenctype") || formElement.enctype)
}

class Snapshot {
  constructor(element) {
    this.element = element;
  }

  get activeElement() {
    return this.element.ownerDocument.activeElement
  }

  get children() {
    return [...this.element.children]
  }

  hasAnchor(anchor) {
    return this.getElementForAnchor(anchor) != null
  }

  getElementForAnchor(anchor) {
    return anchor ? this.element.querySelector(`[id='${anchor}'], a[name='${anchor}']`) : null
  }

  get isConnected() {
    return this.element.isConnected
  }

  get firstAutofocusableElement() {
    return queryAutofocusableElement(this.element)
  }

  get permanentElements() {
    return queryPermanentElementsAll(this.element)
  }

  getPermanentElementById(id) {
    return getPermanentElementById(this.element, id)
  }

  getPermanentElementMapForSnapshot(snapshot) {
    const permanentElementMap = {};

    for (const currentPermanentElement of this.permanentElements) {
      const { id } = currentPermanentElement;
      const newPermanentElement = snapshot.getPermanentElementById(id);
      if (newPermanentElement) {
        permanentElementMap[id] = [currentPermanentElement, newPermanentElement];
      }
    }

    return permanentElementMap
  }
}

function getPermanentElementById(node, id) {
  return node.querySelector(`#${id}[data-turbo-permanent]`)
}

function queryPermanentElementsAll(node) {
  return node.querySelectorAll("[id][data-turbo-permanent]")
}

class FormSubmitObserver {
  started = false

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (!this.started) {
      this.eventTarget.addEventListener("submit", this.submitCaptured, true);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      this.eventTarget.removeEventListener("submit", this.submitCaptured, true);
      this.started = false;
    }
  }

  submitCaptured = () => {
    this.eventTarget.removeEventListener("submit", this.submitBubbled, false);
    this.eventTarget.addEventListener("submit", this.submitBubbled, false);
  }

  submitBubbled = (event) => {
    if (!event.defaultPrevented) {
      const form = event.target instanceof HTMLFormElement ? event.target : undefined;
      const submitter = event.submitter || undefined;

      if (
        form &&
        submissionDoesNotDismissDialog(form, submitter) &&
        submissionDoesNotTargetIFrame(form, submitter) &&
        this.delegate.willSubmitForm(form, submitter)
      ) {
        event.preventDefault();
        event.stopImmediatePropagation();
        this.delegate.formSubmitted(form, submitter);
      }
    }
  }
}

function submissionDoesNotDismissDialog(form, submitter) {
  const method = submitter?.getAttribute("formmethod") || form.getAttribute("method");

  return method != "dialog"
}

function submissionDoesNotTargetIFrame(form, submitter) {
  const target = submitter?.getAttribute("formtarget") || form.getAttribute("target");

  return doesNotTargetIFrame(target)
}

class View {
  #resolveRenderPromise = (_value) => {}
  #resolveInterceptionPromise = (_value) => {}

  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
  }

  // Scrolling

  scrollToAnchor(anchor) {
    const element = this.snapshot.getElementForAnchor(anchor);
    if (element) {
      this.scrollToElement(element);
      this.focusElement(element);
    } else {
      this.scrollToPosition({ x: 0, y: 0 });
    }
  }

  scrollToAnchorFromLocation(location) {
    this.scrollToAnchor(getAnchor(location));
  }

  scrollToElement(element) {
    element.scrollIntoView();
  }

  focusElement(element) {
    if (element instanceof HTMLElement) {
      if (element.hasAttribute("tabindex")) {
        element.focus();
      } else {
        element.setAttribute("tabindex", "-1");
        element.focus();
        element.removeAttribute("tabindex");
      }
    }
  }

  scrollToPosition({ x, y }) {
    this.scrollRoot.scrollTo(x, y);
  }

  scrollToTop() {
    this.scrollToPosition({ x: 0, y: 0 });
  }

  get scrollRoot() {
    return window
  }

  // Rendering

  async render(renderer) {
    const { isPreview, shouldRender, willRender, newSnapshot: snapshot } = renderer;

    // A workaround to ignore tracked element mismatch reloads when performing
    // a promoted Visit from a frame navigation
    const shouldInvalidate = willRender;

    if (shouldRender) {
      try {
        this.renderPromise = new Promise((resolve) => (this.#resolveRenderPromise = resolve));
        this.renderer = renderer;
        await this.prepareToRenderSnapshot(renderer);

        const renderInterception = new Promise((resolve) => (this.#resolveInterceptionPromise = resolve));
        const options = { resume: this.#resolveInterceptionPromise, render: this.renderer.renderElement, renderMethod: this.renderer.renderMethod };
        const immediateRender = this.delegate.allowsImmediateRender(snapshot, options);
        if (!immediateRender) await renderInterception;

        await this.renderSnapshot(renderer);
        this.delegate.viewRenderedSnapshot(snapshot, isPreview, this.renderer.renderMethod);
        this.delegate.preloadOnLoadLinksForView(this.element);
        this.finishRenderingSnapshot(renderer);
      } finally {
        delete this.renderer;
        this.#resolveRenderPromise(undefined);
        delete this.renderPromise;
      }
    } else if (shouldInvalidate) {
      this.invalidate(renderer.reloadReason);
    }
  }

  invalidate(reason) {
    this.delegate.viewInvalidated(reason);
  }

  async prepareToRenderSnapshot(renderer) {
    this.markAsPreview(renderer.isPreview);
    await renderer.prepareToRender();
  }

  markAsPreview(isPreview) {
    if (isPreview) {
      this.element.setAttribute("data-turbo-preview", "");
    } else {
      this.element.removeAttribute("data-turbo-preview");
    }
  }

  markVisitDirection(direction) {
    this.element.setAttribute("data-turbo-visit-direction", direction);
  }

  unmarkVisitDirection() {
    this.element.removeAttribute("data-turbo-visit-direction");
  }

  async renderSnapshot(renderer) {
    await renderer.render();
  }

  finishRenderingSnapshot(renderer) {
    renderer.finishRendering();
  }
}

class FrameView extends View {
  missing() {
    this.element.innerHTML = `<strong class="turbo-frame-error">Content missing</strong>`;
  }

  get snapshot() {
    return new Snapshot(this.element)
  }
}

class LinkInterceptor {
  constructor(delegate, element) {
    this.delegate = delegate;
    this.element = element;
  }

  start() {
    this.element.addEventListener("click", this.clickBubbled);
    document.addEventListener("turbo:click", this.linkClicked);
    document.addEventListener("turbo:before-visit", this.willVisit);
  }

  stop() {
    this.element.removeEventListener("click", this.clickBubbled);
    document.removeEventListener("turbo:click", this.linkClicked);
    document.removeEventListener("turbo:before-visit", this.willVisit);
  }

  clickBubbled = (event) => {
    if (this.clickEventIsSignificant(event)) {
      this.clickEvent = event;
    } else {
      delete this.clickEvent;
    }
  }

  linkClicked = (event) => {
    if (this.clickEvent && this.clickEventIsSignificant(event)) {
      if (this.delegate.shouldInterceptLinkClick(event.target, event.detail.url, event.detail.originalEvent)) {
        this.clickEvent.preventDefault();
        event.preventDefault();
        this.delegate.linkClickIntercepted(event.target, event.detail.url, event.detail.originalEvent);
      }
    }
    delete this.clickEvent;
  }

  willVisit = (_event) => {
    delete this.clickEvent;
  }

  clickEventIsSignificant(event) {
    const target = event.composed ? event.target?.parentElement : event.target;
    const element = findLinkFromClickTarget(target) || target;

    return element instanceof Element && element.closest("turbo-frame, html") == this.element
  }
}

class LinkClickObserver {
  started = false

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (!this.started) {
      this.eventTarget.addEventListener("click", this.clickCaptured, true);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      this.eventTarget.removeEventListener("click", this.clickCaptured, true);
      this.started = false;
    }
  }

  clickCaptured = () => {
    this.eventTarget.removeEventListener("click", this.clickBubbled, false);
    this.eventTarget.addEventListener("click", this.clickBubbled, false);
  }

  clickBubbled = (event) => {
    if (event instanceof MouseEvent && this.clickEventIsSignificant(event)) {
      const target = (event.composedPath && event.composedPath()[0]) || event.target;
      const link = findLinkFromClickTarget(target);
      if (link && doesNotTargetIFrame(link.target)) {
        const location = getLocationForLink(link);
        if (this.delegate.willFollowLinkToLocation(link, location, event)) {
          event.preventDefault();
          this.delegate.followedLinkToLocation(link, location);
        }
      }
    }
  }

  clickEventIsSignificant(event) {
    return !(
      (event.target && event.target.isContentEditable) ||
      event.defaultPrevented ||
      event.which > 1 ||
      event.altKey ||
      event.ctrlKey ||
      event.metaKey ||
      event.shiftKey
    )
  }
}

class FormLinkClickObserver {
  constructor(delegate, element) {
    this.delegate = delegate;
    this.linkInterceptor = new LinkClickObserver(this, element);
  }

  start() {
    this.linkInterceptor.start();
  }

  stop() {
    this.linkInterceptor.stop();
  }

  // Link hover observer delegate

  canPrefetchRequestToLocation(link, location) {
    return false
  }

  prefetchAndCacheRequestToLocation(link, location) {
    return
  }

  // Link click observer delegate

  willFollowLinkToLocation(link, location, originalEvent) {
    return (
      this.delegate.willSubmitFormLinkToLocation(link, location, originalEvent) &&
      (link.hasAttribute("data-turbo-method") || link.hasAttribute("data-turbo-stream"))
    )
  }

  followedLinkToLocation(link, location) {
    const form = document.createElement("form");

    const type = "hidden";
    for (const [name, value] of location.searchParams) {
      form.append(Object.assign(document.createElement("input"), { type, name, value }));
    }

    const action = Object.assign(location, { search: "" });
    form.setAttribute("data-turbo", "true");
    form.setAttribute("action", action.href);
    form.setAttribute("hidden", "");

    const method = link.getAttribute("data-turbo-method");
    if (method) form.setAttribute("method", method);

    const turboFrame = link.getAttribute("data-turbo-frame");
    if (turboFrame) form.setAttribute("data-turbo-frame", turboFrame);

    const turboAction = getVisitAction(link);
    if (turboAction) form.setAttribute("data-turbo-action", turboAction);

    const turboConfirm = link.getAttribute("data-turbo-confirm");
    if (turboConfirm) form.setAttribute("data-turbo-confirm", turboConfirm);

    const turboStream = link.hasAttribute("data-turbo-stream");
    if (turboStream) form.setAttribute("data-turbo-stream", "");

    this.delegate.submittedFormLinkToLocation(link, location, form);

    document.body.appendChild(form);
    form.addEventListener("turbo:submit-end", () => form.remove(), { once: true });
    requestAnimationFrame(() => form.requestSubmit());
  }
}

class Bardo {
  static async preservingPermanentElements(delegate, permanentElementMap, callback) {
    const bardo = new this(delegate, permanentElementMap);
    bardo.enter();
    await callback();
    bardo.leave();
  }

  constructor(delegate, permanentElementMap) {
    this.delegate = delegate;
    this.permanentElementMap = permanentElementMap;
  }

  enter() {
    for (const id in this.permanentElementMap) {
      const [currentPermanentElement, newPermanentElement] = this.permanentElementMap[id];
      this.delegate.enteringBardo(currentPermanentElement, newPermanentElement);
      this.replaceNewPermanentElementWithPlaceholder(newPermanentElement);
    }
  }

  leave() {
    for (const id in this.permanentElementMap) {
      const [currentPermanentElement] = this.permanentElementMap[id];
      this.replaceCurrentPermanentElementWithClone(currentPermanentElement);
      this.replacePlaceholderWithPermanentElement(currentPermanentElement);
      this.delegate.leavingBardo(currentPermanentElement);
    }
  }

  replaceNewPermanentElementWithPlaceholder(permanentElement) {
    const placeholder = createPlaceholderForPermanentElement(permanentElement);
    permanentElement.replaceWith(placeholder);
  }

  replaceCurrentPermanentElementWithClone(permanentElement) {
    const clone = permanentElement.cloneNode(true);
    permanentElement.replaceWith(clone);
  }

  replacePlaceholderWithPermanentElement(permanentElement) {
    const placeholder = this.getPlaceholderById(permanentElement.id);
    placeholder?.replaceWith(permanentElement);
  }

  getPlaceholderById(id) {
    return this.placeholders.find((element) => element.content == id)
  }

  get placeholders() {
    return [...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]
  }
}

function createPlaceholderForPermanentElement(permanentElement) {
  const element = document.createElement("meta");
  element.setAttribute("name", "turbo-permanent-placeholder");
  element.setAttribute("content", permanentElement.id);
  return element
}

class Renderer {
  #activeElement = null

  static renderElement(currentElement, newElement) {
    // Abstract method
  }

  constructor(currentSnapshot, newSnapshot, isPreview, willRender = true) {
    this.currentSnapshot = currentSnapshot;
    this.newSnapshot = newSnapshot;
    this.isPreview = isPreview;
    this.willRender = willRender;
    this.renderElement = this.constructor.renderElement;
    this.promise = new Promise((resolve, reject) => (this.resolvingFunctions = { resolve, reject }));
  }

  get shouldRender() {
    return true
  }

  get shouldAutofocus() {
    return true
  }

  get reloadReason() {
    return
  }

  prepareToRender() {
    return
  }

  render() {
    // Abstract method
  }

  finishRendering() {
    if (this.resolvingFunctions) {
      this.resolvingFunctions.resolve();
      delete this.resolvingFunctions;
    }
  }

  async preservingPermanentElements(callback) {
    await Bardo.preservingPermanentElements(this, this.permanentElementMap, callback);
  }

  focusFirstAutofocusableElement() {
    if (this.shouldAutofocus) {
      const element = this.connectedSnapshot.firstAutofocusableElement;
      if (element) {
        element.focus();
      }
    }
  }

  // Bardo delegate

  enteringBardo(currentPermanentElement) {
    if (this.#activeElement) return

    if (currentPermanentElement.contains(this.currentSnapshot.activeElement)) {
      this.#activeElement = this.currentSnapshot.activeElement;
    }
  }

  leavingBardo(currentPermanentElement) {
    if (currentPermanentElement.contains(this.#activeElement) && this.#activeElement instanceof HTMLElement) {
      this.#activeElement.focus();

      this.#activeElement = null;
    }
  }

  get connectedSnapshot() {
    return this.newSnapshot.isConnected ? this.newSnapshot : this.currentSnapshot
  }

  get currentElement() {
    return this.currentSnapshot.element
  }

  get newElement() {
    return this.newSnapshot.element
  }

  get permanentElementMap() {
    return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)
  }

  get renderMethod() {
    return "replace"
  }
}

class FrameRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    const destinationRange = document.createRange();
    destinationRange.selectNodeContents(currentElement);
    destinationRange.deleteContents();

    const frameElement = newElement;
    const sourceRange = frameElement.ownerDocument?.createRange();
    if (sourceRange) {
      sourceRange.selectNodeContents(frameElement);
      currentElement.appendChild(sourceRange.extractContents());
    }
  }

  constructor(delegate, currentSnapshot, newSnapshot, renderElement, isPreview, willRender = true) {
    super(currentSnapshot, newSnapshot, renderElement, isPreview, willRender);
    this.delegate = delegate;
  }

  get shouldRender() {
    return true
  }

  async render() {
    await nextRepaint();
    this.preservingPermanentElements(() => {
      this.loadFrameElement();
    });
    this.scrollFrameIntoView();
    await nextRepaint();
    this.focusFirstAutofocusableElement();
    await nextRepaint();
    this.activateScriptElements();
  }

  loadFrameElement() {
    this.delegate.willRenderFrame(this.currentElement, this.newElement);
    this.renderElement(this.currentElement, this.newElement);
  }

  scrollFrameIntoView() {
    if (this.currentElement.autoscroll || this.newElement.autoscroll) {
      const element = this.currentElement.firstElementChild;
      const block = readScrollLogicalPosition(this.currentElement.getAttribute("data-autoscroll-block"), "end");
      const behavior = readScrollBehavior(this.currentElement.getAttribute("data-autoscroll-behavior"), "auto");

      if (element) {
        element.scrollIntoView({ block, behavior });
        return true
      }
    }
    return false
  }

  activateScriptElements() {
    for (const inertScriptElement of this.newScriptElements) {
      const activatedScriptElement = activateScriptElement(inertScriptElement);
      inertScriptElement.replaceWith(activatedScriptElement);
    }
  }

  get newScriptElements() {
    return this.currentElement.querySelectorAll("script")
  }
}

function readScrollLogicalPosition(value, defaultValue) {
  if (value == "end" || value == "start" || value == "center" || value == "nearest") {
    return value
  } else {
    return defaultValue
  }
}

function readScrollBehavior(value, defaultValue) {
  if (value == "auto" || value == "smooth") {
    return value
  } else {
    return defaultValue
  }
}

// base IIFE to define idiomorph
var Idiomorph = (function () {

        //=============================================================================
        // AND NOW IT BEGINS...
        //=============================================================================
        let EMPTY_SET = new Set();

        // default configuration values, updatable by users now
        let defaults = {
            morphStyle: "outerHTML",
            callbacks : {
                beforeNodeAdded: noOp,
                afterNodeAdded: noOp,
                beforeNodeMorphed: noOp,
                afterNodeMorphed: noOp,
                beforeNodeRemoved: noOp,
                afterNodeRemoved: noOp,
                beforeAttributeUpdated: noOp,

            },
            head: {
                style: 'merge',
                shouldPreserve: function (elt) {
                    return elt.getAttribute("im-preserve") === "true";
                },
                shouldReAppend: function (elt) {
                    return elt.getAttribute("im-re-append") === "true";
                },
                shouldRemove: noOp,
                afterHeadMorphed: noOp,
            }
        };

        //=============================================================================
        // Core Morphing Algorithm - morph, morphNormalizedContent, morphOldNodeTo, morphChildren
        //=============================================================================
        function morph(oldNode, newContent, config = {}) {

            if (oldNode instanceof Document) {
                oldNode = oldNode.documentElement;
            }

            if (typeof newContent === 'string') {
                newContent = parseContent(newContent);
            }

            let normalizedContent = normalizeContent(newContent);

            let ctx = createMorphContext(oldNode, normalizedContent, config);

            return morphNormalizedContent(oldNode, normalizedContent, ctx);
        }

        function morphNormalizedContent(oldNode, normalizedNewContent, ctx) {
            if (ctx.head.block) {
                let oldHead = oldNode.querySelector('head');
                let newHead = normalizedNewContent.querySelector('head');
                if (oldHead && newHead) {
                    let promises = handleHeadElement(newHead, oldHead, ctx);
                    // when head promises resolve, call morph again, ignoring the head tag
                    Promise.all(promises).then(function () {
                        morphNormalizedContent(oldNode, normalizedNewContent, Object.assign(ctx, {
                            head: {
                                block: false,
                                ignore: true
                            }
                        }));
                    });
                    return;
                }
            }

            if (ctx.morphStyle === "innerHTML") {

                // innerHTML, so we are only updating the children
                morphChildren(normalizedNewContent, oldNode, ctx);
                return oldNode.children;

            } else if (ctx.morphStyle === "outerHTML" || ctx.morphStyle == null) {
                // otherwise find the best element match in the new content, morph that, and merge its siblings
                // into either side of the best match
                let bestMatch = findBestNodeMatch(normalizedNewContent, oldNode, ctx);

                // stash the siblings that will need to be inserted on either side of the best match
                let previousSibling = bestMatch?.previousSibling;
                let nextSibling = bestMatch?.nextSibling;

                // morph it
                let morphedNode = morphOldNodeTo(oldNode, bestMatch, ctx);

                if (bestMatch) {
                    // if there was a best match, merge the siblings in too and return the
                    // whole bunch
                    return insertSiblings(previousSibling, morphedNode, nextSibling);
                } else {
                    // otherwise nothing was added to the DOM
                    return []
                }
            } else {
                throw "Do not understand how to morph style " + ctx.morphStyle;
            }
        }


        /**
         * @param possibleActiveElement
         * @param ctx
         * @returns {boolean}
         */
        function ignoreValueOfActiveElement(possibleActiveElement, ctx) {
            return ctx.ignoreActiveValue && possibleActiveElement === document.activeElement && possibleActiveElement !== document.body;
        }

        /**
         * @param oldNode root node to merge content into
         * @param newContent new content to merge
         * @param ctx the merge context
         * @returns {Element} the element that ended up in the DOM
         */
        function morphOldNodeTo(oldNode, newContent, ctx) {
            if (ctx.ignoreActive && oldNode === document.activeElement) ; else if (newContent == null) {
                if (ctx.callbacks.beforeNodeRemoved(oldNode) === false) return oldNode;

                oldNode.remove();
                ctx.callbacks.afterNodeRemoved(oldNode);
                return null;
            } else if (!isSoftMatch(oldNode, newContent)) {
                if (ctx.callbacks.beforeNodeRemoved(oldNode) === false) return oldNode;
                if (ctx.callbacks.beforeNodeAdded(newContent) === false) return oldNode;

                oldNode.parentElement.replaceChild(newContent, oldNode);
                ctx.callbacks.afterNodeAdded(newContent);
                ctx.callbacks.afterNodeRemoved(oldNode);
                return newContent;
            } else {
                if (ctx.callbacks.beforeNodeMorphed(oldNode, newContent) === false) return oldNode;

                if (oldNode instanceof HTMLHeadElement && ctx.head.ignore) ; else if (oldNode instanceof HTMLHeadElement && ctx.head.style !== "morph") {
                    handleHeadElement(newContent, oldNode, ctx);
                } else {
                    syncNodeFrom(newContent, oldNode, ctx);
                    if (!ignoreValueOfActiveElement(oldNode, ctx)) {
                        morphChildren(newContent, oldNode, ctx);
                    }
                }
                ctx.callbacks.afterNodeMorphed(oldNode, newContent);
                return oldNode;
            }
        }

        /**
         * This is the core algorithm for matching up children.  The idea is to use id sets to try to match up
         * nodes as faithfully as possible.  We greedily match, which allows us to keep the algorithm fast, but
         * by using id sets, we are able to better match up with content deeper in the DOM.
         *
         * Basic algorithm is, for each node in the new content:
         *
         * - if we have reached the end of the old parent, append the new content
         * - if the new content has an id set match with the current insertion point, morph
         * - search for an id set match
         * - if id set match found, morph
         * - otherwise search for a "soft" match
         * - if a soft match is found, morph
         * - otherwise, prepend the new node before the current insertion point
         *
         * The two search algorithms terminate if competing node matches appear to outweigh what can be achieved
         * with the current node.  See findIdSetMatch() and findSoftMatch() for details.
         *
         * @param {Element} newParent the parent element of the new content
         * @param {Element } oldParent the old content that we are merging the new content into
         * @param ctx the merge context
         */
        function morphChildren(newParent, oldParent, ctx) {

            let nextNewChild = newParent.firstChild;
            let insertionPoint = oldParent.firstChild;
            let newChild;

            // run through all the new content
            while (nextNewChild) {

                newChild = nextNewChild;
                nextNewChild = newChild.nextSibling;

                // if we are at the end of the exiting parent's children, just append
                if (insertionPoint == null) {
                    if (ctx.callbacks.beforeNodeAdded(newChild) === false) return;

                    oldParent.appendChild(newChild);
                    ctx.callbacks.afterNodeAdded(newChild);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // if the current node has an id set match then morph
                if (isIdSetMatch(newChild, insertionPoint, ctx)) {
                    morphOldNodeTo(insertionPoint, newChild, ctx);
                    insertionPoint = insertionPoint.nextSibling;
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // otherwise search forward in the existing old children for an id set match
                let idSetMatch = findIdSetMatch(newParent, oldParent, newChild, insertionPoint, ctx);

                // if we found a potential match, remove the nodes until that point and morph
                if (idSetMatch) {
                    insertionPoint = removeNodesBetween(insertionPoint, idSetMatch, ctx);
                    morphOldNodeTo(idSetMatch, newChild, ctx);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // no id set match found, so scan forward for a soft match for the current node
                let softMatch = findSoftMatch(newParent, oldParent, newChild, insertionPoint, ctx);

                // if we found a soft match for the current node, morph
                if (softMatch) {
                    insertionPoint = removeNodesBetween(insertionPoint, softMatch, ctx);
                    morphOldNodeTo(softMatch, newChild, ctx);
                    removeIdsFromConsideration(ctx, newChild);
                    continue;
                }

                // abandon all hope of morphing, just insert the new child before the insertion point
                // and move on
                if (ctx.callbacks.beforeNodeAdded(newChild) === false) return;

                oldParent.insertBefore(newChild, insertionPoint);
                ctx.callbacks.afterNodeAdded(newChild);
                removeIdsFromConsideration(ctx, newChild);
            }

            // remove any remaining old nodes that didn't match up with new content
            while (insertionPoint !== null) {

                let tempNode = insertionPoint;
                insertionPoint = insertionPoint.nextSibling;
                removeNode(tempNode, ctx);
            }
        }

        //=============================================================================
        // Attribute Syncing Code
        //=============================================================================

        /**
         * @param attr {String} the attribute to be mutated
         * @param to {Element} the element that is going to be updated
         * @param updateType {("update"|"remove")}
         * @param ctx the merge context
         * @returns {boolean} true if the attribute should be ignored, false otherwise
         */
        function ignoreAttribute(attr, to, updateType, ctx) {
            if(attr === 'value' && ctx.ignoreActiveValue && to === document.activeElement){
                return true;
            }
            return ctx.callbacks.beforeAttributeUpdated(attr, to, updateType) === false;
        }

        /**
         * syncs a given node with another node, copying over all attributes and
         * inner element state from the 'from' node to the 'to' node
         *
         * @param {Element} from the element to copy attributes & state from
         * @param {Element} to the element to copy attributes & state to
         * @param ctx the merge context
         */
        function syncNodeFrom(from, to, ctx) {
            let type = from.nodeType;

            // if is an element type, sync the attributes from the
            // new node into the new node
            if (type === 1 /* element type */) {
                const fromAttributes = from.attributes;
                const toAttributes = to.attributes;
                for (const fromAttribute of fromAttributes) {
                    if (ignoreAttribute(fromAttribute.name, to, 'update', ctx)) {
                        continue;
                    }
                    if (to.getAttribute(fromAttribute.name) !== fromAttribute.value) {
                        to.setAttribute(fromAttribute.name, fromAttribute.value);
                    }
                }
                // iterate backwards to avoid skipping over items when a delete occurs
                for (let i = toAttributes.length - 1; 0 <= i; i--) {
                    const toAttribute = toAttributes[i];
                    if (ignoreAttribute(toAttribute.name, to, 'remove', ctx)) {
                        continue;
                    }
                    if (!from.hasAttribute(toAttribute.name)) {
                        to.removeAttribute(toAttribute.name);
                    }
                }
            }

            // sync text nodes
            if (type === 8 /* comment */ || type === 3 /* text */) {
                if (to.nodeValue !== from.nodeValue) {
                    to.nodeValue = from.nodeValue;
                }
            }

            if (!ignoreValueOfActiveElement(to, ctx)) {
                // sync input values
                syncInputValue(from, to, ctx);
            }
        }

        /**
         * @param from {Element} element to sync the value from
         * @param to {Element} element to sync the value to
         * @param attributeName {String} the attribute name
         * @param ctx the merge context
         */
        function syncBooleanAttribute(from, to, attributeName, ctx) {
            if (from[attributeName] !== to[attributeName]) {
                let ignoreUpdate = ignoreAttribute(attributeName, to, 'update', ctx);
                if (!ignoreUpdate) {
                    to[attributeName] = from[attributeName];
                }
                if (from[attributeName]) {
                    if (!ignoreUpdate) {
                        to.setAttribute(attributeName, from[attributeName]);
                    }
                } else {
                    if (!ignoreAttribute(attributeName, to, 'remove', ctx)) {
                        to.removeAttribute(attributeName);
                    }
                }
            }
        }

        /**
         * NB: many bothans died to bring us information:
         *
         *  https://github.com/patrick-steele-idem/morphdom/blob/master/src/specialElHandlers.js
         *  https://github.com/choojs/nanomorph/blob/master/lib/morph.jsL113
         *
         * @param from {Element} the element to sync the input value from
         * @param to {Element} the element to sync the input value to
         * @param ctx the merge context
         */
        function syncInputValue(from, to, ctx) {
            if (from instanceof HTMLInputElement &&
                to instanceof HTMLInputElement &&
                from.type !== 'file') {

                let fromValue = from.value;
                let toValue = to.value;

                // sync boolean attributes
                syncBooleanAttribute(from, to, 'checked', ctx);
                syncBooleanAttribute(from, to, 'disabled', ctx);

                if (!from.hasAttribute('value')) {
                    if (!ignoreAttribute('value', to, 'remove', ctx)) {
                        to.value = '';
                        to.removeAttribute('value');
                    }
                } else if (fromValue !== toValue) {
                    if (!ignoreAttribute('value', to, 'update', ctx)) {
                        to.setAttribute('value', fromValue);
                        to.value = fromValue;
                    }
                }
            } else if (from instanceof HTMLOptionElement) {
                syncBooleanAttribute(from, to, 'selected', ctx);
            } else if (from instanceof HTMLTextAreaElement && to instanceof HTMLTextAreaElement) {
                let fromValue = from.value;
                let toValue = to.value;
                if (ignoreAttribute('value', to, 'update', ctx)) {
                    return;
                }
                if (fromValue !== toValue) {
                    to.value = fromValue;
                }
                if (to.firstChild && to.firstChild.nodeValue !== fromValue) {
                    to.firstChild.nodeValue = fromValue;
                }
            }
        }

        //=============================================================================
        // the HEAD tag can be handled specially, either w/ a 'merge' or 'append' style
        //=============================================================================
        function handleHeadElement(newHeadTag, currentHead, ctx) {

            let added = [];
            let removed = [];
            let preserved = [];
            let nodesToAppend = [];

            let headMergeStyle = ctx.head.style;

            // put all new head elements into a Map, by their outerHTML
            let srcToNewHeadNodes = new Map();
            for (const newHeadChild of newHeadTag.children) {
                srcToNewHeadNodes.set(newHeadChild.outerHTML, newHeadChild);
            }

            // for each elt in the current head
            for (const currentHeadElt of currentHead.children) {

                // If the current head element is in the map
                let inNewContent = srcToNewHeadNodes.has(currentHeadElt.outerHTML);
                let isReAppended = ctx.head.shouldReAppend(currentHeadElt);
                let isPreserved = ctx.head.shouldPreserve(currentHeadElt);
                if (inNewContent || isPreserved) {
                    if (isReAppended) {
                        // remove the current version and let the new version replace it and re-execute
                        removed.push(currentHeadElt);
                    } else {
                        // this element already exists and should not be re-appended, so remove it from
                        // the new content map, preserving it in the DOM
                        srcToNewHeadNodes.delete(currentHeadElt.outerHTML);
                        preserved.push(currentHeadElt);
                    }
                } else {
                    if (headMergeStyle === "append") {
                        // we are appending and this existing element is not new content
                        // so if and only if it is marked for re-append do we do anything
                        if (isReAppended) {
                            removed.push(currentHeadElt);
                            nodesToAppend.push(currentHeadElt);
                        }
                    } else {
                        // if this is a merge, we remove this content since it is not in the new head
                        if (ctx.head.shouldRemove(currentHeadElt) !== false) {
                            removed.push(currentHeadElt);
                        }
                    }
                }
            }

            // Push the remaining new head elements in the Map into the
            // nodes to append to the head tag
            nodesToAppend.push(...srcToNewHeadNodes.values());

            let promises = [];
            for (const newNode of nodesToAppend) {
                let newElt = document.createRange().createContextualFragment(newNode.outerHTML).firstChild;
                if (ctx.callbacks.beforeNodeAdded(newElt) !== false) {
                    if (newElt.href || newElt.src) {
                        let resolve = null;
                        let promise = new Promise(function (_resolve) {
                            resolve = _resolve;
                        });
                        newElt.addEventListener('load', function () {
                            resolve();
                        });
                        promises.push(promise);
                    }
                    currentHead.appendChild(newElt);
                    ctx.callbacks.afterNodeAdded(newElt);
                    added.push(newElt);
                }
            }

            // remove all removed elements, after we have appended the new elements to avoid
            // additional network requests for things like style sheets
            for (const removedElement of removed) {
                if (ctx.callbacks.beforeNodeRemoved(removedElement) !== false) {
                    currentHead.removeChild(removedElement);
                    ctx.callbacks.afterNodeRemoved(removedElement);
                }
            }

            ctx.head.afterHeadMorphed(currentHead, {added: added, kept: preserved, removed: removed});
            return promises;
        }

        function noOp() {
        }

        /*
          Deep merges the config object and the Idiomoroph.defaults object to
          produce a final configuration object
         */
        function mergeDefaults(config) {
            let finalConfig = {};
            // copy top level stuff into final config
            Object.assign(finalConfig, defaults);
            Object.assign(finalConfig, config);

            // copy callbacks into final config (do this to deep merge the callbacks)
            finalConfig.callbacks = {};
            Object.assign(finalConfig.callbacks, defaults.callbacks);
            Object.assign(finalConfig.callbacks, config.callbacks);

            // copy head config into final config  (do this to deep merge the head)
            finalConfig.head = {};
            Object.assign(finalConfig.head, defaults.head);
            Object.assign(finalConfig.head, config.head);
            return finalConfig;
        }

        function createMorphContext(oldNode, newContent, config) {
            config = mergeDefaults(config);
            return {
                target: oldNode,
                newContent: newContent,
                config: config,
                morphStyle: config.morphStyle,
                ignoreActive: config.ignoreActive,
                ignoreActiveValue: config.ignoreActiveValue,
                idMap: createIdMap(oldNode, newContent),
                deadIds: new Set(),
                callbacks: config.callbacks,
                head: config.head
            }
        }

        function isIdSetMatch(node1, node2, ctx) {
            if (node1 == null || node2 == null) {
                return false;
            }
            if (node1.nodeType === node2.nodeType && node1.tagName === node2.tagName) {
                if (node1.id !== "" && node1.id === node2.id) {
                    return true;
                } else {
                    return getIdIntersectionCount(ctx, node1, node2) > 0;
                }
            }
            return false;
        }

        function isSoftMatch(node1, node2) {
            if (node1 == null || node2 == null) {
                return false;
            }
            return node1.nodeType === node2.nodeType && node1.tagName === node2.tagName
        }

        function removeNodesBetween(startInclusive, endExclusive, ctx) {
            while (startInclusive !== endExclusive) {
                let tempNode = startInclusive;
                startInclusive = startInclusive.nextSibling;
                removeNode(tempNode, ctx);
            }
            removeIdsFromConsideration(ctx, endExclusive);
            return endExclusive.nextSibling;
        }

        //=============================================================================
        // Scans forward from the insertionPoint in the old parent looking for a potential id match
        // for the newChild.  We stop if we find a potential id match for the new child OR
        // if the number of potential id matches we are discarding is greater than the
        // potential id matches for the new child
        //=============================================================================
        function findIdSetMatch(newContent, oldParent, newChild, insertionPoint, ctx) {

            // max id matches we are willing to discard in our search
            let newChildPotentialIdCount = getIdIntersectionCount(ctx, newChild, oldParent);

            let potentialMatch = null;

            // only search forward if there is a possibility of an id match
            if (newChildPotentialIdCount > 0) {
                let potentialMatch = insertionPoint;
                // if there is a possibility of an id match, scan forward
                // keep track of the potential id match count we are discarding (the
                // newChildPotentialIdCount must be greater than this to make it likely
                // worth it)
                let otherMatchCount = 0;
                while (potentialMatch != null) {

                    // If we have an id match, return the current potential match
                    if (isIdSetMatch(newChild, potentialMatch, ctx)) {
                        return potentialMatch;
                    }

                    // computer the other potential matches of this new content
                    otherMatchCount += getIdIntersectionCount(ctx, potentialMatch, newContent);
                    if (otherMatchCount > newChildPotentialIdCount) {
                        // if we have more potential id matches in _other_ content, we
                        // do not have a good candidate for an id match, so return null
                        return null;
                    }

                    // advanced to the next old content child
                    potentialMatch = potentialMatch.nextSibling;
                }
            }
            return potentialMatch;
        }

        //=============================================================================
        // Scans forward from the insertionPoint in the old parent looking for a potential soft match
        // for the newChild.  We stop if we find a potential soft match for the new child OR
        // if we find a potential id match in the old parents children OR if we find two
        // potential soft matches for the next two pieces of new content
        //=============================================================================
        function findSoftMatch(newContent, oldParent, newChild, insertionPoint, ctx) {

            let potentialSoftMatch = insertionPoint;
            let nextSibling = newChild.nextSibling;
            let siblingSoftMatchCount = 0;

            while (potentialSoftMatch != null) {

                if (getIdIntersectionCount(ctx, potentialSoftMatch, newContent) > 0) {
                    // the current potential soft match has a potential id set match with the remaining new
                    // content so bail out of looking
                    return null;
                }

                // if we have a soft match with the current node, return it
                if (isSoftMatch(newChild, potentialSoftMatch)) {
                    return potentialSoftMatch;
                }

                if (isSoftMatch(nextSibling, potentialSoftMatch)) {
                    // the next new node has a soft match with this node, so
                    // increment the count of future soft matches
                    siblingSoftMatchCount++;
                    nextSibling = nextSibling.nextSibling;

                    // If there are two future soft matches, bail to allow the siblings to soft match
                    // so that we don't consume future soft matches for the sake of the current node
                    if (siblingSoftMatchCount >= 2) {
                        return null;
                    }
                }

                // advanced to the next old content child
                potentialSoftMatch = potentialSoftMatch.nextSibling;
            }

            return potentialSoftMatch;
        }

        function parseContent(newContent) {
            let parser = new DOMParser();

            // remove svgs to avoid false-positive matches on head, etc.
            let contentWithSvgsRemoved = newContent.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim, '');

            // if the newContent contains a html, head or body tag, we can simply parse it w/o wrapping
            if (contentWithSvgsRemoved.match(/<\/html>/) || contentWithSvgsRemoved.match(/<\/head>/) || contentWithSvgsRemoved.match(/<\/body>/)) {
                let content = parser.parseFromString(newContent, "text/html");
                // if it is a full HTML document, return the document itself as the parent container
                if (contentWithSvgsRemoved.match(/<\/html>/)) {
                    content.generatedByIdiomorph = true;
                    return content;
                } else {
                    // otherwise return the html element as the parent container
                    let htmlElement = content.firstChild;
                    if (htmlElement) {
                        htmlElement.generatedByIdiomorph = true;
                        return htmlElement;
                    } else {
                        return null;
                    }
                }
            } else {
                // if it is partial HTML, wrap it in a template tag to provide a parent element and also to help
                // deal with touchy tags like tr, tbody, etc.
                let responseDoc = parser.parseFromString("<body><template>" + newContent + "</template></body>", "text/html");
                let content = responseDoc.body.querySelector('template').content;
                content.generatedByIdiomorph = true;
                return content
            }
        }

        function normalizeContent(newContent) {
            if (newContent == null) {
                // noinspection UnnecessaryLocalVariableJS
                const dummyParent = document.createElement('div');
                return dummyParent;
            } else if (newContent.generatedByIdiomorph) {
                // the template tag created by idiomorph parsing can serve as a dummy parent
                return newContent;
            } else if (newContent instanceof Node) {
                // a single node is added as a child to a dummy parent
                const dummyParent = document.createElement('div');
                dummyParent.append(newContent);
                return dummyParent;
            } else {
                // all nodes in the array or HTMLElement collection are consolidated under
                // a single dummy parent element
                const dummyParent = document.createElement('div');
                for (const elt of [...newContent]) {
                    dummyParent.append(elt);
                }
                return dummyParent;
            }
        }

        function insertSiblings(previousSibling, morphedNode, nextSibling) {
            let stack = [];
            let added = [];
            while (previousSibling != null) {
                stack.push(previousSibling);
                previousSibling = previousSibling.previousSibling;
            }
            while (stack.length > 0) {
                let node = stack.pop();
                added.push(node); // push added preceding siblings on in order and insert
                morphedNode.parentElement.insertBefore(node, morphedNode);
            }
            added.push(morphedNode);
            while (nextSibling != null) {
                stack.push(nextSibling);
                added.push(nextSibling); // here we are going in order, so push on as we scan, rather than add
                nextSibling = nextSibling.nextSibling;
            }
            while (stack.length > 0) {
                morphedNode.parentElement.insertBefore(stack.pop(), morphedNode.nextSibling);
            }
            return added;
        }

        function findBestNodeMatch(newContent, oldNode, ctx) {
            let currentElement;
            currentElement = newContent.firstChild;
            let bestElement = currentElement;
            let score = 0;
            while (currentElement) {
                let newScore = scoreElement(currentElement, oldNode, ctx);
                if (newScore > score) {
                    bestElement = currentElement;
                    score = newScore;
                }
                currentElement = currentElement.nextSibling;
            }
            return bestElement;
        }

        function scoreElement(node1, node2, ctx) {
            if (isSoftMatch(node1, node2)) {
                return .5 + getIdIntersectionCount(ctx, node1, node2);
            }
            return 0;
        }

        function removeNode(tempNode, ctx) {
            removeIdsFromConsideration(ctx, tempNode);
            if (ctx.callbacks.beforeNodeRemoved(tempNode) === false) return;

            tempNode.remove();
            ctx.callbacks.afterNodeRemoved(tempNode);
        }

        //=============================================================================
        // ID Set Functions
        //=============================================================================

        function isIdInConsideration(ctx, id) {
            return !ctx.deadIds.has(id);
        }

        function idIsWithinNode(ctx, id, targetNode) {
            let idSet = ctx.idMap.get(targetNode) || EMPTY_SET;
            return idSet.has(id);
        }

        function removeIdsFromConsideration(ctx, node) {
            let idSet = ctx.idMap.get(node) || EMPTY_SET;
            for (const id of idSet) {
                ctx.deadIds.add(id);
            }
        }

        function getIdIntersectionCount(ctx, node1, node2) {
            let sourceSet = ctx.idMap.get(node1) || EMPTY_SET;
            let matchCount = 0;
            for (const id of sourceSet) {
                // a potential match is an id in the source and potentialIdsSet, but
                // that has not already been merged into the DOM
                if (isIdInConsideration(ctx, id) && idIsWithinNode(ctx, id, node2)) {
                    ++matchCount;
                }
            }
            return matchCount;
        }

        /**
         * A bottom up algorithm that finds all elements with ids inside of the node
         * argument and populates id sets for those nodes and all their parents, generating
         * a set of ids contained within all nodes for the entire hierarchy in the DOM
         *
         * @param node {Element}
         * @param {Map<Node, Set<String>>} idMap
         */
        function populateIdMapForNode(node, idMap) {
            let nodeParent = node.parentElement;
            // find all elements with an id property
            let idElements = node.querySelectorAll('[id]');
            for (const elt of idElements) {
                let current = elt;
                // walk up the parent hierarchy of that element, adding the id
                // of element to the parent's id set
                while (current !== nodeParent && current != null) {
                    let idSet = idMap.get(current);
                    // if the id set doesn't exist, create it and insert it in the  map
                    if (idSet == null) {
                        idSet = new Set();
                        idMap.set(current, idSet);
                    }
                    idSet.add(elt.id);
                    current = current.parentElement;
                }
            }
        }

        /**
         * This function computes a map of nodes to all ids contained within that node (inclusive of the
         * node).  This map can be used to ask if two nodes have intersecting sets of ids, which allows
         * for a looser definition of "matching" than tradition id matching, and allows child nodes
         * to contribute to a parent nodes matching.
         *
         * @param {Element} oldContent  the old content that will be morphed
         * @param {Element} newContent  the new content to morph to
         * @returns {Map<Node, Set<String>>} a map of nodes to id sets for the
         */
        function createIdMap(oldContent, newContent) {
            let idMap = new Map();
            populateIdMapForNode(oldContent, idMap);
            populateIdMapForNode(newContent, idMap);
            return idMap;
        }

        //=============================================================================
        // This is what ends up becoming the Idiomorph global object
        //=============================================================================
        return {
            morph,
            defaults
        }
    })();

function morphElements(currentElement, newElement, { callbacks, ...options } = {}) {
  Idiomorph.morph(currentElement, newElement, {
    ...options,
    callbacks: new DefaultIdiomorphCallbacks(callbacks)
  });
}

function morphChildren(currentElement, newElement) {
  morphElements(currentElement, newElement.children, {
    morphStyle: "innerHTML"
  });
}

class DefaultIdiomorphCallbacks {
  #beforeNodeMorphed

  constructor({ beforeNodeMorphed } = {}) {
    this.#beforeNodeMorphed = beforeNodeMorphed || (() => true);
  }

  beforeNodeAdded = (node) => {
    return !(node.id && node.hasAttribute("data-turbo-permanent") && document.getElementById(node.id))
  }

  beforeNodeMorphed = (currentElement, newElement) => {
    if (currentElement instanceof Element) {
      if (!currentElement.hasAttribute("data-turbo-permanent") && this.#beforeNodeMorphed(currentElement, newElement)) {
        const event = dispatch("turbo:before-morph-element", {
          cancelable: true,
          target: currentElement,
          detail: { currentElement, newElement }
        });

        return !event.defaultPrevented
      } else {
        return false
      }
    }
  }

  beforeAttributeUpdated = (attributeName, target, mutationType) => {
    const event = dispatch("turbo:before-morph-attribute", {
      cancelable: true,
      target,
      detail: { attributeName, mutationType }
    });

    return !event.defaultPrevented
  }

  beforeNodeRemoved = (node) => {
    return this.beforeNodeMorphed(node)
  }

  afterNodeMorphed = (currentElement, newElement) => {
    if (currentElement instanceof Element) {
      dispatch("turbo:morph-element", {
        target: currentElement,
        detail: { currentElement, newElement }
      });
    }
  }
}

class MorphingFrameRenderer extends FrameRenderer {
  static renderElement(currentElement, newElement) {
    dispatch("turbo:before-frame-morph", {
      target: currentElement,
      detail: { currentElement, newElement }
    });

    morphChildren(currentElement, newElement);
  }

  async preservingPermanentElements(callback) {
    return await callback()
  }
}

class ProgressBar {
  static animationDuration = 300 /*ms*/

  static get defaultCSS() {
    return unindent`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${ProgressBar.animationDuration}ms ease-out,
          opacity ${ProgressBar.animationDuration / 2}ms ${ProgressBar.animationDuration / 2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `
  }

  hiding = false
  value = 0
  visible = false

  constructor() {
    this.stylesheetElement = this.createStylesheetElement();
    this.progressElement = this.createProgressElement();
    this.installStylesheetElement();
    this.setValue(0);
  }

  show() {
    if (!this.visible) {
      this.visible = true;
      this.installProgressElement();
      this.startTrickling();
    }
  }

  hide() {
    if (this.visible && !this.hiding) {
      this.hiding = true;
      this.fadeProgressElement(() => {
        this.uninstallProgressElement();
        this.stopTrickling();
        this.visible = false;
        this.hiding = false;
      });
    }
  }

  setValue(value) {
    this.value = value;
    this.refresh();
  }

  // Private

  installStylesheetElement() {
    document.head.insertBefore(this.stylesheetElement, document.head.firstChild);
  }

  installProgressElement() {
    this.progressElement.style.width = "0";
    this.progressElement.style.opacity = "1";
    document.documentElement.insertBefore(this.progressElement, document.body);
    this.refresh();
  }

  fadeProgressElement(callback) {
    this.progressElement.style.opacity = "0";
    setTimeout(callback, ProgressBar.animationDuration * 1.5);
  }

  uninstallProgressElement() {
    if (this.progressElement.parentNode) {
      document.documentElement.removeChild(this.progressElement);
    }
  }

  startTrickling() {
    if (!this.trickleInterval) {
      this.trickleInterval = window.setInterval(this.trickle, ProgressBar.animationDuration);
    }
  }

  stopTrickling() {
    window.clearInterval(this.trickleInterval);
    delete this.trickleInterval;
  }

  trickle = () => {
    this.setValue(this.value + Math.random() / 100);
  }

  refresh() {
    requestAnimationFrame(() => {
      this.progressElement.style.width = `${10 + this.value * 90}%`;
    });
  }

  createStylesheetElement() {
    const element = document.createElement("style");
    element.type = "text/css";
    element.textContent = ProgressBar.defaultCSS;
    const cspNonce = getCspNonce();
    if (cspNonce) {
      element.nonce = cspNonce;
    }
    return element
  }

  createProgressElement() {
    const element = document.createElement("div");
    element.className = "turbo-progress-bar";
    return element
  }
}

class HeadSnapshot extends Snapshot {
  detailsByOuterHTML = this.children
    .filter((element) => !elementIsNoscript(element))
    .map((element) => elementWithoutNonce(element))
    .reduce((result, element) => {
      const { outerHTML } = element;
      const details =
        outerHTML in result
          ? result[outerHTML]
          : {
              type: elementType(element),
              tracked: elementIsTracked(element),
              elements: []
            };
      return {
        ...result,
        [outerHTML]: {
          ...details,
          elements: [...details.elements, element]
        }
      }
    }, {})

  get trackedElementSignature() {
    return Object.keys(this.detailsByOuterHTML)
      .filter((outerHTML) => this.detailsByOuterHTML[outerHTML].tracked)
      .join("")
  }

  getScriptElementsNotInSnapshot(snapshot) {
    return this.getElementsMatchingTypeNotInSnapshot("script", snapshot)
  }

  getStylesheetElementsNotInSnapshot(snapshot) {
    return this.getElementsMatchingTypeNotInSnapshot("stylesheet", snapshot)
  }

  getElementsMatchingTypeNotInSnapshot(matchedType, snapshot) {
    return Object.keys(this.detailsByOuterHTML)
      .filter((outerHTML) => !(outerHTML in snapshot.detailsByOuterHTML))
      .map((outerHTML) => this.detailsByOuterHTML[outerHTML])
      .filter(({ type }) => type == matchedType)
      .map(({ elements: [element] }) => element)
  }

  get provisionalElements() {
    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {
      const { type, tracked, elements } = this.detailsByOuterHTML[outerHTML];
      if (type == null && !tracked) {
        return [...result, ...elements]
      } else if (elements.length > 1) {
        return [...result, ...elements.slice(1)]
      } else {
        return result
      }
    }, [])
  }

  getMetaValue(name) {
    const element = this.findMetaElementByName(name);
    return element ? element.getAttribute("content") : null
  }

  findMetaElementByName(name) {
    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {
      const {
        elements: [element]
      } = this.detailsByOuterHTML[outerHTML];
      return elementIsMetaElementWithName(element, name) ? element : result
    }, undefined | undefined)
  }
}

function elementType(element) {
  if (elementIsScript(element)) {
    return "script"
  } else if (elementIsStylesheet(element)) {
    return "stylesheet"
  }
}

function elementIsTracked(element) {
  return element.getAttribute("data-turbo-track") == "reload"
}

function elementIsScript(element) {
  const tagName = element.localName;
  return tagName == "script"
}

function elementIsNoscript(element) {
  const tagName = element.localName;
  return tagName == "noscript"
}

function elementIsStylesheet(element) {
  const tagName = element.localName;
  return tagName == "style" || (tagName == "link" && element.getAttribute("rel") == "stylesheet")
}

function elementIsMetaElementWithName(element, name) {
  const tagName = element.localName;
  return tagName == "meta" && element.getAttribute("name") == name
}

function elementWithoutNonce(element) {
  if (element.hasAttribute("nonce")) {
    element.setAttribute("nonce", "");
  }

  return element
}

class PageSnapshot extends Snapshot {
  static fromHTMLString(html = "") {
    return this.fromDocument(parseHTMLDocument(html))
  }

  static fromElement(element) {
    return this.fromDocument(element.ownerDocument)
  }

  static fromDocument({ documentElement, body, head }) {
    return new this(documentElement, body, new HeadSnapshot(head))
  }

  constructor(documentElement, body, headSnapshot) {
    super(body);
    this.documentElement = documentElement;
    this.headSnapshot = headSnapshot;
  }

  clone() {
    const clonedElement = this.element.cloneNode(true);

    const selectElements = this.element.querySelectorAll("select");
    const clonedSelectElements = clonedElement.querySelectorAll("select");

    for (const [index, source] of selectElements.entries()) {
      const clone = clonedSelectElements[index];
      for (const option of clone.selectedOptions) option.selected = false;
      for (const option of source.selectedOptions) clone.options[option.index].selected = true;
    }

    for (const clonedPasswordInput of clonedElement.querySelectorAll('input[type="password"]')) {
      clonedPasswordInput.value = "";
    }

    return new PageSnapshot(this.documentElement, clonedElement, this.headSnapshot)
  }

  get lang() {
    return this.documentElement.getAttribute("lang")
  }

  get headElement() {
    return this.headSnapshot.element
  }

  get rootLocation() {
    const root = this.getSetting("root") ?? "/";
    return expandURL(root)
  }

  get cacheControlValue() {
    return this.getSetting("cache-control")
  }

  get isPreviewable() {
    return this.cacheControlValue != "no-preview"
  }

  get isCacheable() {
    return this.cacheControlValue != "no-cache"
  }

  get isVisitable() {
    return this.getSetting("visit-control") != "reload"
  }

  get prefersViewTransitions() {
    return this.headSnapshot.getMetaValue("view-transition") === "same-origin"
  }

  get shouldMorphPage() {
    return this.getSetting("refresh-method") === "morph"
  }

  get shouldPreserveScrollPosition() {
    return this.getSetting("refresh-scroll") === "preserve"
  }

  // Private

  getSetting(name) {
    return this.headSnapshot.getMetaValue(`turbo-${name}`)
  }
}

class ViewTransitioner {
  #viewTransitionStarted = false
  #lastOperation = Promise.resolve()

  renderChange(useViewTransition, render) {
    if (useViewTransition && this.viewTransitionsAvailable && !this.#viewTransitionStarted) {
      this.#viewTransitionStarted = true;
      this.#lastOperation = this.#lastOperation.then(async () => {
        await document.startViewTransition(render).finished;
      });
    } else {
      this.#lastOperation = this.#lastOperation.then(render);
    }

    return this.#lastOperation
  }

  get viewTransitionsAvailable() {
    return document.startViewTransition
  }
}

const defaultOptions = {
  action: "advance",
  historyChanged: false,
  visitCachedSnapshot: () => {},
  willRender: true,
  updateHistory: true,
  shouldCacheSnapshot: true,
  acceptsStreamResponse: false
};

const TimingMetric = {
  visitStart: "visitStart",
  requestStart: "requestStart",
  requestEnd: "requestEnd",
  visitEnd: "visitEnd"
};

const VisitState = {
  initialized: "initialized",
  started: "started",
  canceled: "canceled",
  failed: "failed",
  completed: "completed"
};

const SystemStatusCode = {
  networkFailure: 0,
  timeoutFailure: -1,
  contentTypeMismatch: -2
};

const Direction = {
  advance: "forward",
  restore: "back",
  replace: "none"
};

class Visit {
  identifier = uuid() // Required by turbo-ios
  timingMetrics = {}

  followedRedirect = false
  historyChanged = false
  scrolled = false
  shouldCacheSnapshot = true
  acceptsStreamResponse = false
  snapshotCached = false
  state = VisitState.initialized
  viewTransitioner = new ViewTransitioner()

  constructor(delegate, location, restorationIdentifier, options = {}) {
    this.delegate = delegate;
    this.location = location;
    this.restorationIdentifier = restorationIdentifier || uuid();

    const {
      action,
      historyChanged,
      referrer,
      snapshot,
      snapshotHTML,
      response,
      visitCachedSnapshot,
      willRender,
      updateHistory,
      shouldCacheSnapshot,
      acceptsStreamResponse,
      direction
    } = {
      ...defaultOptions,
      ...options
    };
    this.action = action;
    this.historyChanged = historyChanged;
    this.referrer = referrer;
    this.snapshot = snapshot;
    this.snapshotHTML = snapshotHTML;
    this.response = response;
    this.isSamePage = this.delegate.locationWithActionIsSamePage(this.location, this.action);
    this.isPageRefresh = this.view.isPageRefresh(this);
    this.visitCachedSnapshot = visitCachedSnapshot;
    this.willRender = willRender;
    this.updateHistory = updateHistory;
    this.scrolled = !willRender;
    this.shouldCacheSnapshot = shouldCacheSnapshot;
    this.acceptsStreamResponse = acceptsStreamResponse;
    this.direction = direction || Direction[action];
  }

  get adapter() {
    return this.delegate.adapter
  }

  get view() {
    return this.delegate.view
  }

  get history() {
    return this.delegate.history
  }

  get restorationData() {
    return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)
  }

  get silent() {
    return this.isSamePage
  }

  start() {
    if (this.state == VisitState.initialized) {
      this.recordTimingMetric(TimingMetric.visitStart);
      this.state = VisitState.started;
      this.adapter.visitStarted(this);
      this.delegate.visitStarted(this);
    }
  }

  cancel() {
    if (this.state == VisitState.started) {
      if (this.request) {
        this.request.cancel();
      }
      this.cancelRender();
      this.state = VisitState.canceled;
    }
  }

  complete() {
    if (this.state == VisitState.started) {
      this.recordTimingMetric(TimingMetric.visitEnd);
      this.adapter.visitCompleted(this);
      this.state = VisitState.completed;
      this.followRedirect();

      if (!this.followedRedirect) {
        this.delegate.visitCompleted(this);
      }
    }
  }

  fail() {
    if (this.state == VisitState.started) {
      this.state = VisitState.failed;
      this.adapter.visitFailed(this);
      this.delegate.visitCompleted(this);
    }
  }

  changeHistory() {
    if (!this.historyChanged && this.updateHistory) {
      const actionForHistory = this.location.href === this.referrer?.href ? "replace" : this.action;
      const method = getHistoryMethodForAction(actionForHistory);
      this.history.update(method, this.location, this.restorationIdentifier);
      this.historyChanged = true;
    }
  }

  issueRequest() {
    if (this.hasPreloadedResponse()) {
      this.simulateRequest();
    } else if (this.shouldIssueRequest() && !this.request) {
      this.request = new FetchRequest(this, FetchMethod.get, this.location);
      this.request.perform();
    }
  }

  simulateRequest() {
    if (this.response) {
      this.startRequest();
      this.recordResponse();
      this.finishRequest();
    }
  }

  startRequest() {
    this.recordTimingMetric(TimingMetric.requestStart);
    this.adapter.visitRequestStarted(this);
  }

  recordResponse(response = this.response) {
    this.response = response;
    if (response) {
      const { statusCode } = response;
      if (isSuccessful(statusCode)) {
        this.adapter.visitRequestCompleted(this);
      } else {
        this.adapter.visitRequestFailedWithStatusCode(this, statusCode);
      }
    }
  }

  finishRequest() {
    this.recordTimingMetric(TimingMetric.requestEnd);
    this.adapter.visitRequestFinished(this);
  }

  loadResponse() {
    if (this.response) {
      const { statusCode, responseHTML } = this.response;
      this.render(async () => {
        if (this.shouldCacheSnapshot) this.cacheSnapshot();
        if (this.view.renderPromise) await this.view.renderPromise;

        if (isSuccessful(statusCode) && responseHTML != null) {
          const snapshot = PageSnapshot.fromHTMLString(responseHTML);
          await this.renderPageSnapshot(snapshot, false);

          this.adapter.visitRendered(this);
          this.complete();
        } else {
          await this.view.renderError(PageSnapshot.fromHTMLString(responseHTML), this);
          this.adapter.visitRendered(this);
          this.fail();
        }
      });
    }
  }

  getCachedSnapshot() {
    const snapshot = this.view.getCachedSnapshotForLocation(this.location) || this.getPreloadedSnapshot();

    if (snapshot && (!getAnchor(this.location) || snapshot.hasAnchor(getAnchor(this.location)))) {
      if (this.action == "restore" || snapshot.isPreviewable) {
        return snapshot
      }
    }
  }

  getPreloadedSnapshot() {
    if (this.snapshotHTML) {
      return PageSnapshot.fromHTMLString(this.snapshotHTML)
    }
  }

  hasCachedSnapshot() {
    return this.getCachedSnapshot() != null
  }

  loadCachedSnapshot() {
    const snapshot = this.getCachedSnapshot();
    if (snapshot) {
      const isPreview = this.shouldIssueRequest();
      this.render(async () => {
        this.cacheSnapshot();
        if (this.isSamePage || this.isPageRefresh) {
          this.adapter.visitRendered(this);
        } else {
          if (this.view.renderPromise) await this.view.renderPromise;

          await this.renderPageSnapshot(snapshot, isPreview);

          this.adapter.visitRendered(this);
          if (!isPreview) {
            this.complete();
          }
        }
      });
    }
  }

  followRedirect() {
    if (this.redirectedToLocation && !this.followedRedirect && this.response?.redirected) {
      this.adapter.visitProposedToLocation(this.redirectedToLocation, {
        action: "replace",
        response: this.response,
        shouldCacheSnapshot: false,
        willRender: false
      });
      this.followedRedirect = true;
    }
  }

  goToSamePageAnchor() {
    if (this.isSamePage) {
      this.render(async () => {
        this.cacheSnapshot();
        this.performScroll();
        this.changeHistory();
        this.adapter.visitRendered(this);
      });
    }
  }

  // Fetch request delegate

  prepareRequest(request) {
    if (this.acceptsStreamResponse) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted() {
    this.startRequest();
  }

  requestPreventedHandlingResponse(_request, _response) {}

  async requestSucceededWithResponse(request, response) {
    const responseHTML = await response.responseHTML;
    const { redirected, statusCode } = response;
    if (responseHTML == undefined) {
      this.recordResponse({
        statusCode: SystemStatusCode.contentTypeMismatch,
        redirected
      });
    } else {
      this.redirectedToLocation = response.redirected ? response.location : undefined;
      this.recordResponse({ statusCode: statusCode, responseHTML, redirected });
    }
  }

  async requestFailedWithResponse(request, response) {
    const responseHTML = await response.responseHTML;
    const { redirected, statusCode } = response;
    if (responseHTML == undefined) {
      this.recordResponse({
        statusCode: SystemStatusCode.contentTypeMismatch,
        redirected
      });
    } else {
      this.recordResponse({ statusCode: statusCode, responseHTML, redirected });
    }
  }

  requestErrored(_request, _error) {
    this.recordResponse({
      statusCode: SystemStatusCode.networkFailure,
      redirected: false
    });
  }

  requestFinished() {
    this.finishRequest();
  }

  // Scrolling

  performScroll() {
    if (!this.scrolled && !this.view.forceReloaded && !this.view.shouldPreserveScrollPosition(this)) {
      if (this.action == "restore") {
        this.scrollToRestoredPosition() || this.scrollToAnchor() || this.view.scrollToTop();
      } else {
        this.scrollToAnchor() || this.view.scrollToTop();
      }
      if (this.isSamePage) {
        this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation, this.location);
      }

      this.scrolled = true;
    }
  }

  scrollToRestoredPosition() {
    const { scrollPosition } = this.restorationData;
    if (scrollPosition) {
      this.view.scrollToPosition(scrollPosition);
      return true
    }
  }

  scrollToAnchor() {
    const anchor = getAnchor(this.location);
    if (anchor != null) {
      this.view.scrollToAnchor(anchor);
      return true
    }
  }

  // Instrumentation

  recordTimingMetric(metric) {
    this.timingMetrics[metric] = new Date().getTime();
  }

  getTimingMetrics() {
    return { ...this.timingMetrics }
  }

  // Private

  getHistoryMethodForAction(action) {
    switch (action) {
      case "replace":
        return history.replaceState
      case "advance":
      case "restore":
        return history.pushState
    }
  }

  hasPreloadedResponse() {
    return typeof this.response == "object"
  }

  shouldIssueRequest() {
    if (this.isSamePage) {
      return false
    } else if (this.action == "restore") {
      return !this.hasCachedSnapshot()
    } else {
      return this.willRender
    }
  }

  cacheSnapshot() {
    if (!this.snapshotCached) {
      this.view.cacheSnapshot(this.snapshot).then((snapshot) => snapshot && this.visitCachedSnapshot(snapshot));
      this.snapshotCached = true;
    }
  }

  async render(callback) {
    this.cancelRender();
    await new Promise((resolve) => {
      this.frame =
        document.visibilityState === "hidden" ? setTimeout(() => resolve(), 0) : requestAnimationFrame(() => resolve());
    });
    await callback();
    delete this.frame;
  }

  async renderPageSnapshot(snapshot, isPreview) {
    await this.viewTransitioner.renderChange(this.view.shouldTransitionTo(snapshot), async () => {
      await this.view.renderPage(snapshot, isPreview, this.willRender, this);
      this.performScroll();
    });
  }

  cancelRender() {
    if (this.frame) {
      cancelAnimationFrame(this.frame);
      delete this.frame;
    }
  }
}

function isSuccessful(statusCode) {
  return statusCode >= 200 && statusCode < 300
}

class BrowserAdapter {
  progressBar = new ProgressBar()

  constructor(session) {
    this.session = session;
  }

  visitProposedToLocation(location, options) {
    if (locationIsVisitable(location, this.navigator.rootLocation)) {
      this.navigator.startVisit(location, options?.restorationIdentifier || uuid(), options);
    } else {
      window.location.href = location.toString();
    }
  }

  visitStarted(visit) {
    this.location = visit.location;
    visit.loadCachedSnapshot();
    visit.issueRequest();
    visit.goToSamePageAnchor();
  }

  visitRequestStarted(visit) {
    this.progressBar.setValue(0);
    if (visit.hasCachedSnapshot() || visit.action != "restore") {
      this.showVisitProgressBarAfterDelay();
    } else {
      this.showProgressBar();
    }
  }

  visitRequestCompleted(visit) {
    visit.loadResponse();
  }

  visitRequestFailedWithStatusCode(visit, statusCode) {
    switch (statusCode) {
      case SystemStatusCode.networkFailure:
      case SystemStatusCode.timeoutFailure:
      case SystemStatusCode.contentTypeMismatch:
        return this.reload({
          reason: "request_failed",
          context: {
            statusCode
          }
        })
      default:
        return visit.loadResponse()
    }
  }

  visitRequestFinished(_visit) {}

  visitCompleted(_visit) {
    this.progressBar.setValue(1);
    this.hideVisitProgressBar();
  }

  pageInvalidated(reason) {
    this.reload(reason);
  }

  visitFailed(_visit) {
    this.progressBar.setValue(1);
    this.hideVisitProgressBar();
  }

  visitRendered(_visit) {}

  // Form Submission Delegate

  formSubmissionStarted(_formSubmission) {
    this.progressBar.setValue(0);
    this.showFormProgressBarAfterDelay();
  }

  formSubmissionFinished(_formSubmission) {
    this.progressBar.setValue(1);
    this.hideFormProgressBar();
  }

  // Private

  showVisitProgressBarAfterDelay() {
    this.visitProgressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay);
  }

  hideVisitProgressBar() {
    this.progressBar.hide();
    if (this.visitProgressBarTimeout != null) {
      window.clearTimeout(this.visitProgressBarTimeout);
      delete this.visitProgressBarTimeout;
    }
  }

  showFormProgressBarAfterDelay() {
    if (this.formProgressBarTimeout == null) {
      this.formProgressBarTimeout = window.setTimeout(this.showProgressBar, this.session.progressBarDelay);
    }
  }

  hideFormProgressBar() {
    this.progressBar.hide();
    if (this.formProgressBarTimeout != null) {
      window.clearTimeout(this.formProgressBarTimeout);
      delete this.formProgressBarTimeout;
    }
  }

  showProgressBar = () => {
    this.progressBar.show();
  }

  reload(reason) {
    dispatch("turbo:reload", { detail: reason });

    window.location.href = this.location?.toString() || window.location.href;
  }

  get navigator() {
    return this.session.navigator
  }
}

class CacheObserver {
  selector = "[data-turbo-temporary]"
  deprecatedSelector = "[data-turbo-cache=false]"

  started = false

  start() {
    if (!this.started) {
      this.started = true;
      addEventListener("turbo:before-cache", this.removeTemporaryElements, false);
    }
  }

  stop() {
    if (this.started) {
      this.started = false;
      removeEventListener("turbo:before-cache", this.removeTemporaryElements, false);
    }
  }

  removeTemporaryElements = (_event) => {
    for (const element of this.temporaryElements) {
      element.remove();
    }
  }

  get temporaryElements() {
    return [...document.querySelectorAll(this.selector), ...this.temporaryElementsWithDeprecation]
  }

  get temporaryElementsWithDeprecation() {
    const elements = document.querySelectorAll(this.deprecatedSelector);

    if (elements.length) {
      console.warn(
        `The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`
      );
    }

    return [...elements]
  }
}

class FrameRedirector {
  constructor(session, element) {
    this.session = session;
    this.element = element;
    this.linkInterceptor = new LinkInterceptor(this, element);
    this.formSubmitObserver = new FormSubmitObserver(this, element);
  }

  start() {
    this.linkInterceptor.start();
    this.formSubmitObserver.start();
  }

  stop() {
    this.linkInterceptor.stop();
    this.formSubmitObserver.stop();
  }

  // Link interceptor delegate

  shouldInterceptLinkClick(element, _location, _event) {
    return this.#shouldRedirect(element)
  }

  linkClickIntercepted(element, url, event) {
    const frame = this.#findFrameElement(element);
    if (frame) {
      frame.delegate.linkClickIntercepted(element, url, event);
    }
  }

  // Form submit observer delegate

  willSubmitForm(element, submitter) {
    return (
      element.closest("turbo-frame") == null &&
      this.#shouldSubmit(element, submitter) &&
      this.#shouldRedirect(element, submitter)
    )
  }

  formSubmitted(element, submitter) {
    const frame = this.#findFrameElement(element, submitter);
    if (frame) {
      frame.delegate.formSubmitted(element, submitter);
    }
  }

  #shouldSubmit(form, submitter) {
    const action = getAction$1(form, submitter);
    const meta = this.element.ownerDocument.querySelector(`meta[name="turbo-root"]`);
    const rootLocation = expandURL(meta?.content ?? "/");

    return this.#shouldRedirect(form, submitter) && locationIsVisitable(action, rootLocation)
  }

  #shouldRedirect(element, submitter) {
    const isNavigatable =
      element instanceof HTMLFormElement
        ? this.session.submissionIsNavigatable(element, submitter)
        : this.session.elementIsNavigatable(element);

    if (isNavigatable) {
      const frame = this.#findFrameElement(element, submitter);
      return frame ? frame != element.closest("turbo-frame") : false
    } else {
      return false
    }
  }

  #findFrameElement(element, submitter) {
    const id = submitter?.getAttribute("data-turbo-frame") || element.getAttribute("data-turbo-frame");
    if (id && id != "_top") {
      const frame = this.element.querySelector(`#${id}:not([disabled])`);
      if (frame instanceof FrameElement) {
        return frame
      }
    }
  }
}

class History {
  location
  restorationIdentifier = uuid()
  restorationData = {}
  started = false
  pageLoaded = false
  currentIndex = 0

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      addEventListener("popstate", this.onPopState, false);
      addEventListener("load", this.onPageLoad, false);
      this.currentIndex = history.state?.turbo?.restorationIndex || 0;
      this.started = true;
      this.replace(new URL(window.location.href));
    }
  }

  stop() {
    if (this.started) {
      removeEventListener("popstate", this.onPopState, false);
      removeEventListener("load", this.onPageLoad, false);
      this.started = false;
    }
  }

  push(location, restorationIdentifier) {
    this.update(history.pushState, location, restorationIdentifier);
  }

  replace(location, restorationIdentifier) {
    this.update(history.replaceState, location, restorationIdentifier);
  }

  update(method, location, restorationIdentifier = uuid()) {
    if (method === history.pushState) ++this.currentIndex;

    const state = { turbo: { restorationIdentifier, restorationIndex: this.currentIndex } };
    method.call(history, state, "", location.href);
    this.location = location;
    this.restorationIdentifier = restorationIdentifier;
  }

  // Restoration data

  getRestorationDataForIdentifier(restorationIdentifier) {
    return this.restorationData[restorationIdentifier] || {}
  }

  updateRestorationData(additionalData) {
    const { restorationIdentifier } = this;
    const restorationData = this.restorationData[restorationIdentifier];
    this.restorationData[restorationIdentifier] = {
      ...restorationData,
      ...additionalData
    };
  }

  // Scroll restoration

  assumeControlOfScrollRestoration() {
    if (!this.previousScrollRestoration) {
      this.previousScrollRestoration = history.scrollRestoration ?? "auto";
      history.scrollRestoration = "manual";
    }
  }

  relinquishControlOfScrollRestoration() {
    if (this.previousScrollRestoration) {
      history.scrollRestoration = this.previousScrollRestoration;
      delete this.previousScrollRestoration;
    }
  }

  // Event handlers

  onPopState = (event) => {
    if (this.shouldHandlePopState()) {
      const { turbo } = event.state || {};
      if (turbo) {
        this.location = new URL(window.location.href);
        const { restorationIdentifier, restorationIndex } = turbo;
        this.restorationIdentifier = restorationIdentifier;
        const direction = restorationIndex > this.currentIndex ? "forward" : "back";
        this.delegate.historyPoppedToLocationWithRestorationIdentifierAndDirection(this.location, restorationIdentifier, direction);
        this.currentIndex = restorationIndex;
      }
    }
  }

  onPageLoad = async (_event) => {
    await nextMicrotask();
    this.pageLoaded = true;
  }

  // Private

  shouldHandlePopState() {
    // Safari dispatches a popstate event after window's load event, ignore it
    return this.pageIsLoaded()
  }

  pageIsLoaded() {
    return this.pageLoaded || document.readyState == "complete"
  }
}

class LinkPrefetchObserver {
  started = false
  #prefetchedLink = null

  constructor(delegate, eventTarget) {
    this.delegate = delegate;
    this.eventTarget = eventTarget;
  }

  start() {
    if (this.started) return

    if (this.eventTarget.readyState === "loading") {
      this.eventTarget.addEventListener("DOMContentLoaded", this.#enable, { once: true });
    } else {
      this.#enable();
    }
  }

  stop() {
    if (!this.started) return

    this.eventTarget.removeEventListener("mouseenter", this.#tryToPrefetchRequest, {
      capture: true,
      passive: true
    });
    this.eventTarget.removeEventListener("mouseleave", this.#cancelRequestIfObsolete, {
      capture: true,
      passive: true
    });

    this.eventTarget.removeEventListener("turbo:before-fetch-request", this.#tryToUsePrefetchedRequest, true);
    this.started = false;
  }

  #enable = () => {
    this.eventTarget.addEventListener("mouseenter", this.#tryToPrefetchRequest, {
      capture: true,
      passive: true
    });
    this.eventTarget.addEventListener("mouseleave", this.#cancelRequestIfObsolete, {
      capture: true,
      passive: true
    });

    this.eventTarget.addEventListener("turbo:before-fetch-request", this.#tryToUsePrefetchedRequest, true);
    this.started = true;
  }

  #tryToPrefetchRequest = (event) => {
    if (getMetaContent("turbo-prefetch") === "false") return

    const target = event.target;
    const isLink = target.matches && target.matches("a[href]:not([target^=_]):not([download])");

    if (isLink && this.#isPrefetchable(target)) {
      const link = target;
      const location = getLocationForLink(link);

      if (this.delegate.canPrefetchRequestToLocation(link, location)) {
        this.#prefetchedLink = link;

        const fetchRequest = new FetchRequest(
          this,
          FetchMethod.get,
          location,
          new URLSearchParams(),
          target
        );

        prefetchCache.setLater(location.toString(), fetchRequest, this.#cacheTtl);
      }
    }
  }

  #cancelRequestIfObsolete = (event) => {
    if (event.target === this.#prefetchedLink) this.#cancelPrefetchRequest();
  }

  #cancelPrefetchRequest = () => {
    prefetchCache.clear();
    this.#prefetchedLink = null;
  }

  #tryToUsePrefetchedRequest = (event) => {
    if (event.target.tagName !== "FORM" && event.detail.fetchOptions.method === "GET") {
      const cached = prefetchCache.get(event.detail.url.toString());

      if (cached) {
        // User clicked link, use cache response
        event.detail.fetchRequest = cached;
      }

      prefetchCache.clear();
    }
  }

  prepareRequest(request) {
    const link = request.target;

    request.headers["X-Sec-Purpose"] = "prefetch";

    const turboFrame = link.closest("turbo-frame");
    const turboFrameTarget = link.getAttribute("data-turbo-frame") || turboFrame?.getAttribute("target") || turboFrame?.id;

    if (turboFrameTarget && turboFrameTarget !== "_top") {
      request.headers["Turbo-Frame"] = turboFrameTarget;
    }
  }

  // Fetch request interface

  requestSucceededWithResponse() {}

  requestStarted(fetchRequest) {}

  requestErrored(fetchRequest) {}

  requestFinished(fetchRequest) {}

  requestPreventedHandlingResponse(fetchRequest, fetchResponse) {}

  requestFailedWithResponse(fetchRequest, fetchResponse) {}

  get #cacheTtl() {
    return Number(getMetaContent("turbo-prefetch-cache-time")) || cacheTtl
  }

  #isPrefetchable(link) {
    const href = link.getAttribute("href");

    if (!href) return false

    if (unfetchableLink(link)) return false
    if (linkToTheSamePage(link)) return false
    if (linkOptsOut(link)) return false
    if (nonSafeLink(link)) return false
    if (eventPrevented(link)) return false

    return true
  }
}

const unfetchableLink = (link) => {
  return link.origin !== document.location.origin || !["http:", "https:"].includes(link.protocol) || link.hasAttribute("target")
};

const linkToTheSamePage = (link) => {
  return (link.pathname + link.search === document.location.pathname + document.location.search) || link.href.startsWith("#")
};

const linkOptsOut = (link) => {
  if (link.getAttribute("data-turbo-prefetch") === "false") return true
  if (link.getAttribute("data-turbo") === "false") return true

  const turboPrefetchParent = findClosestRecursively(link, "[data-turbo-prefetch]");
  if (turboPrefetchParent && turboPrefetchParent.getAttribute("data-turbo-prefetch") === "false") return true

  return false
};

const nonSafeLink = (link) => {
  const turboMethod = link.getAttribute("data-turbo-method");
  if (turboMethod && turboMethod.toLowerCase() !== "get") return true

  if (isUJS(link)) return true
  if (link.hasAttribute("data-turbo-confirm")) return true
  if (link.hasAttribute("data-turbo-stream")) return true

  return false
};

const isUJS = (link) => {
  return link.hasAttribute("data-remote") || link.hasAttribute("data-behavior") || link.hasAttribute("data-confirm") || link.hasAttribute("data-method")
};

const eventPrevented = (link) => {
  const event = dispatch("turbo:before-prefetch", { target: link, cancelable: true });
  return event.defaultPrevented
};

class Navigator {
  constructor(delegate) {
    this.delegate = delegate;
  }

  proposeVisit(location, options = {}) {
    if (this.delegate.allowsVisitingLocationWithAction(location, options.action)) {
      this.delegate.visitProposedToLocation(location, options);
    }
  }

  startVisit(locatable, restorationIdentifier, options = {}) {
    this.stop();
    this.currentVisit = new Visit(this, expandURL(locatable), restorationIdentifier, {
      referrer: this.location,
      ...options
    });
    this.currentVisit.start();
  }

  submitForm(form, submitter) {
    this.stop();
    this.formSubmission = new FormSubmission(this, form, submitter, true);

    this.formSubmission.start();
  }

  stop() {
    if (this.formSubmission) {
      this.formSubmission.stop();
      delete this.formSubmission;
    }

    if (this.currentVisit) {
      this.currentVisit.cancel();
      delete this.currentVisit;
    }
  }

  get adapter() {
    return this.delegate.adapter
  }

  get view() {
    return this.delegate.view
  }

  get rootLocation() {
    return this.view.snapshot.rootLocation
  }

  get history() {
    return this.delegate.history
  }

  // Form submission delegate

  formSubmissionStarted(formSubmission) {
    // Not all adapters implement formSubmissionStarted
    if (typeof this.adapter.formSubmissionStarted === "function") {
      this.adapter.formSubmissionStarted(formSubmission);
    }
  }

  async formSubmissionSucceededWithResponse(formSubmission, fetchResponse) {
    if (formSubmission == this.formSubmission) {
      const responseHTML = await fetchResponse.responseHTML;
      if (responseHTML) {
        const shouldCacheSnapshot = formSubmission.isSafe;
        if (!shouldCacheSnapshot) {
          this.view.clearSnapshotCache();
        }

        const { statusCode, redirected } = fetchResponse;
        const action = this.#getActionForFormSubmission(formSubmission, fetchResponse);
        const visitOptions = {
          action,
          shouldCacheSnapshot,
          response: { statusCode, responseHTML, redirected }
        };
        this.proposeVisit(fetchResponse.location, visitOptions);
      }
    }
  }

  async formSubmissionFailedWithResponse(formSubmission, fetchResponse) {
    const responseHTML = await fetchResponse.responseHTML;

    if (responseHTML) {
      const snapshot = PageSnapshot.fromHTMLString(responseHTML);
      if (fetchResponse.serverError) {
        await this.view.renderError(snapshot, this.currentVisit);
      } else {
        await this.view.renderPage(snapshot, false, true, this.currentVisit);
      }
      if(!snapshot.shouldPreserveScrollPosition) {
        this.view.scrollToTop();
      }
      this.view.clearSnapshotCache();
    }
  }

  formSubmissionErrored(formSubmission, error) {
    console.error(error);
  }

  formSubmissionFinished(formSubmission) {
    // Not all adapters implement formSubmissionFinished
    if (typeof this.adapter.formSubmissionFinished === "function") {
      this.adapter.formSubmissionFinished(formSubmission);
    }
  }

  // Visit delegate

  visitStarted(visit) {
    this.delegate.visitStarted(visit);
  }

  visitCompleted(visit) {
    this.delegate.visitCompleted(visit);
    delete this.currentVisit;
  }

  locationWithActionIsSamePage(location, action) {
    const anchor = getAnchor(location);
    const currentAnchor = getAnchor(this.view.lastRenderedLocation);
    const isRestorationToTop = action === "restore" && typeof anchor === "undefined";

    return (
      action !== "replace" &&
      getRequestURL(location) === getRequestURL(this.view.lastRenderedLocation) &&
      (isRestorationToTop || (anchor != null && anchor !== currentAnchor))
    )
  }

  visitScrolledToSamePageLocation(oldURL, newURL) {
    this.delegate.visitScrolledToSamePageLocation(oldURL, newURL);
  }

  // Visits

  get location() {
    return this.history.location
  }

  get restorationIdentifier() {
    return this.history.restorationIdentifier
  }

  #getActionForFormSubmission(formSubmission, fetchResponse) {
    const { submitter, formElement } = formSubmission;
    return getVisitAction(submitter, formElement) || this.#getDefaultAction(fetchResponse)
  }

  #getDefaultAction(fetchResponse) {
    const sameLocationRedirect = fetchResponse.redirected && fetchResponse.location.href === this.location?.href;
    return sameLocationRedirect ? "replace" : "advance"
  }
}

const PageStage = {
  initial: 0,
  loading: 1,
  interactive: 2,
  complete: 3
};

class PageObserver {
  stage = PageStage.initial
  started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      if (this.stage == PageStage.initial) {
        this.stage = PageStage.loading;
      }
      document.addEventListener("readystatechange", this.interpretReadyState, false);
      addEventListener("pagehide", this.pageWillUnload, false);
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      document.removeEventListener("readystatechange", this.interpretReadyState, false);
      removeEventListener("pagehide", this.pageWillUnload, false);
      this.started = false;
    }
  }

  interpretReadyState = () => {
    const { readyState } = this;
    if (readyState == "interactive") {
      this.pageIsInteractive();
    } else if (readyState == "complete") {
      this.pageIsComplete();
    }
  }

  pageIsInteractive() {
    if (this.stage == PageStage.loading) {
      this.stage = PageStage.interactive;
      this.delegate.pageBecameInteractive();
    }
  }

  pageIsComplete() {
    this.pageIsInteractive();
    if (this.stage == PageStage.interactive) {
      this.stage = PageStage.complete;
      this.delegate.pageLoaded();
    }
  }

  pageWillUnload = () => {
    this.delegate.pageWillUnload();
  }

  get readyState() {
    return document.readyState
  }
}

class ScrollObserver {
  started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.started) {
      addEventListener("scroll", this.onScroll, false);
      this.onScroll();
      this.started = true;
    }
  }

  stop() {
    if (this.started) {
      removeEventListener("scroll", this.onScroll, false);
      this.started = false;
    }
  }

  onScroll = () => {
    this.updatePosition({ x: window.pageXOffset, y: window.pageYOffset });
  }

  // Private

  updatePosition(position) {
    this.delegate.scrollPositionChanged(position);
  }
}

class StreamMessageRenderer {
  render({ fragment }) {
    Bardo.preservingPermanentElements(this, getPermanentElementMapForFragment(fragment), () => {
      withAutofocusFromFragment(fragment, () => {
        withPreservedFocus(() => {
          document.documentElement.appendChild(fragment);
        });
      });
    });
  }

  // Bardo delegate

  enteringBardo(currentPermanentElement, newPermanentElement) {
    newPermanentElement.replaceWith(currentPermanentElement.cloneNode(true));
  }

  leavingBardo() {}
}

function getPermanentElementMapForFragment(fragment) {
  const permanentElementsInDocument = queryPermanentElementsAll(document.documentElement);
  const permanentElementMap = {};
  for (const permanentElementInDocument of permanentElementsInDocument) {
    const { id } = permanentElementInDocument;

    for (const streamElement of fragment.querySelectorAll("turbo-stream")) {
      const elementInStream = getPermanentElementById(streamElement.templateElement.content, id);

      if (elementInStream) {
        permanentElementMap[id] = [permanentElementInDocument, elementInStream];
      }
    }
  }

  return permanentElementMap
}

async function withAutofocusFromFragment(fragment, callback) {
  const generatedID = `turbo-stream-autofocus-${uuid()}`;
  const turboStreams = fragment.querySelectorAll("turbo-stream");
  const elementWithAutofocus = firstAutofocusableElementInStreams(turboStreams);
  let willAutofocusId = null;

  if (elementWithAutofocus) {
    if (elementWithAutofocus.id) {
      willAutofocusId = elementWithAutofocus.id;
    } else {
      willAutofocusId = generatedID;
    }

    elementWithAutofocus.id = willAutofocusId;
  }

  callback();
  await nextRepaint();

  const hasNoActiveElement = document.activeElement == null || document.activeElement == document.body;

  if (hasNoActiveElement && willAutofocusId) {
    const elementToAutofocus = document.getElementById(willAutofocusId);

    if (elementIsFocusable(elementToAutofocus)) {
      elementToAutofocus.focus();
    }
    if (elementToAutofocus && elementToAutofocus.id == generatedID) {
      elementToAutofocus.removeAttribute("id");
    }
  }
}

async function withPreservedFocus(callback) {
  const [activeElementBeforeRender, activeElementAfterRender] = await around(callback, () => document.activeElement);

  const restoreFocusTo = activeElementBeforeRender && activeElementBeforeRender.id;

  if (restoreFocusTo) {
    const elementToFocus = document.getElementById(restoreFocusTo);

    if (elementIsFocusable(elementToFocus) && elementToFocus != activeElementAfterRender) {
      elementToFocus.focus();
    }
  }
}

function firstAutofocusableElementInStreams(nodeListOfStreamElements) {
  for (const streamElement of nodeListOfStreamElements) {
    const elementWithAutofocus = queryAutofocusableElement(streamElement.templateElement.content);

    if (elementWithAutofocus) return elementWithAutofocus
  }

  return null
}

class StreamObserver {
  sources = new Set()
  #started = false

  constructor(delegate) {
    this.delegate = delegate;
  }

  start() {
    if (!this.#started) {
      this.#started = true;
      addEventListener("turbo:before-fetch-response", this.inspectFetchResponse, false);
    }
  }

  stop() {
    if (this.#started) {
      this.#started = false;
      removeEventListener("turbo:before-fetch-response", this.inspectFetchResponse, false);
    }
  }

  connectStreamSource(source) {
    if (!this.streamSourceIsConnected(source)) {
      this.sources.add(source);
      source.addEventListener("message", this.receiveMessageEvent, false);
    }
  }

  disconnectStreamSource(source) {
    if (this.streamSourceIsConnected(source)) {
      this.sources.delete(source);
      source.removeEventListener("message", this.receiveMessageEvent, false);
    }
  }

  streamSourceIsConnected(source) {
    return this.sources.has(source)
  }

  inspectFetchResponse = (event) => {
    const response = fetchResponseFromEvent(event);
    if (response && fetchResponseIsStream(response)) {
      event.preventDefault();
      this.receiveMessageResponse(response);
    }
  }

  receiveMessageEvent = (event) => {
    if (this.#started && typeof event.data == "string") {
      this.receiveMessageHTML(event.data);
    }
  }

  async receiveMessageResponse(response) {
    const html = await response.responseHTML;
    if (html) {
      this.receiveMessageHTML(html);
    }
  }

  receiveMessageHTML(html) {
    this.delegate.receivedMessageFromStream(StreamMessage.wrap(html));
  }
}

function fetchResponseFromEvent(event) {
  const fetchResponse = event.detail?.fetchResponse;
  if (fetchResponse instanceof FetchResponse) {
    return fetchResponse
  }
}

function fetchResponseIsStream(response) {
  const contentType = response.contentType ?? "";
  return contentType.startsWith(StreamMessage.contentType)
}

class ErrorRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    const { documentElement, body } = document;

    documentElement.replaceChild(newElement, body);
  }

  async render() {
    this.replaceHeadAndBody();
    this.activateScriptElements();
  }

  replaceHeadAndBody() {
    const { documentElement, head } = document;
    documentElement.replaceChild(this.newHead, head);
    this.renderElement(this.currentElement, this.newElement);
  }

  activateScriptElements() {
    for (const replaceableElement of this.scriptElements) {
      const parentNode = replaceableElement.parentNode;
      if (parentNode) {
        const element = activateScriptElement(replaceableElement);
        parentNode.replaceChild(element, replaceableElement);
      }
    }
  }

  get newHead() {
    return this.newSnapshot.headSnapshot.element
  }

  get scriptElements() {
    return document.documentElement.querySelectorAll("script")
  }
}

class PageRenderer extends Renderer {
  static renderElement(currentElement, newElement) {
    if (document.body && newElement instanceof HTMLBodyElement) {
      document.body.replaceWith(newElement);
    } else {
      document.documentElement.appendChild(newElement);
    }
  }

  get shouldRender() {
    return this.newSnapshot.isVisitable && this.trackedElementsAreIdentical
  }

  get reloadReason() {
    if (!this.newSnapshot.isVisitable) {
      return {
        reason: "turbo_visit_control_is_reload"
      }
    }

    if (!this.trackedElementsAreIdentical) {
      return {
        reason: "tracked_element_mismatch"
      }
    }
  }

  async prepareToRender() {
    this.#setLanguage();
    await this.mergeHead();
  }

  async render() {
    if (this.willRender) {
      await this.replaceBody();
    }
  }

  finishRendering() {
    super.finishRendering();
    if (!this.isPreview) {
      this.focusFirstAutofocusableElement();
    }
  }

  get currentHeadSnapshot() {
    return this.currentSnapshot.headSnapshot
  }

  get newHeadSnapshot() {
    return this.newSnapshot.headSnapshot
  }

  get newElement() {
    return this.newSnapshot.element
  }

  #setLanguage() {
    const { documentElement } = this.currentSnapshot;
    const { lang } = this.newSnapshot;

    if (lang) {
      documentElement.setAttribute("lang", lang);
    } else {
      documentElement.removeAttribute("lang");
    }
  }

  async mergeHead() {
    const mergedHeadElements = this.mergeProvisionalElements();
    const newStylesheetElements = this.copyNewHeadStylesheetElements();
    this.copyNewHeadScriptElements();

    await mergedHeadElements;
    await newStylesheetElements;

    if (this.willRender) {
      this.removeUnusedDynamicStylesheetElements();
    }
  }

  async replaceBody() {
    await this.preservingPermanentElements(async () => {
      this.activateNewBody();
      await this.assignNewBody();
    });
  }

  get trackedElementsAreIdentical() {
    return this.currentHeadSnapshot.trackedElementSignature == this.newHeadSnapshot.trackedElementSignature
  }

  async copyNewHeadStylesheetElements() {
    const loadingElements = [];

    for (const element of this.newHeadStylesheetElements) {
      loadingElements.push(waitForLoad(element));

      document.head.appendChild(element);
    }

    await Promise.all(loadingElements);
  }

  copyNewHeadScriptElements() {
    for (const element of this.newHeadScriptElements) {
      document.head.appendChild(activateScriptElement(element));
    }
  }

  removeUnusedDynamicStylesheetElements() {
    for (const element of this.unusedDynamicStylesheetElements) {
      document.head.removeChild(element);
    }
  }

  async mergeProvisionalElements() {
    const newHeadElements = [...this.newHeadProvisionalElements];

    for (const element of this.currentHeadProvisionalElements) {
      if (!this.isCurrentElementInElementList(element, newHeadElements)) {
        document.head.removeChild(element);
      }
    }

    for (const element of newHeadElements) {
      document.head.appendChild(element);
    }
  }

  isCurrentElementInElementList(element, elementList) {
    for (const [index, newElement] of elementList.entries()) {
      // if title element...
      if (element.tagName == "TITLE") {
        if (newElement.tagName != "TITLE") {
          continue
        }
        if (element.innerHTML == newElement.innerHTML) {
          elementList.splice(index, 1);
          return true
        }
      }

      // if any other element...
      if (newElement.isEqualNode(element)) {
        elementList.splice(index, 1);
        return true
      }
    }

    return false
  }

  removeCurrentHeadProvisionalElements() {
    for (const element of this.currentHeadProvisionalElements) {
      document.head.removeChild(element);
    }
  }

  copyNewHeadProvisionalElements() {
    for (const element of this.newHeadProvisionalElements) {
      document.head.appendChild(element);
    }
  }

  activateNewBody() {
    document.adoptNode(this.newElement);
    this.activateNewBodyScriptElements();
  }

  activateNewBodyScriptElements() {
    for (const inertScriptElement of this.newBodyScriptElements) {
      const activatedScriptElement = activateScriptElement(inertScriptElement);
      inertScriptElement.replaceWith(activatedScriptElement);
    }
  }

  async assignNewBody() {
    await this.renderElement(this.currentElement, this.newElement);
  }

  get unusedDynamicStylesheetElements() {
    return this.oldHeadStylesheetElements.filter((element) => {
      return element.getAttribute("data-turbo-track") === "dynamic"
    })
  }

  get oldHeadStylesheetElements() {
    return this.currentHeadSnapshot.getStylesheetElementsNotInSnapshot(this.newHeadSnapshot)
  }

  get newHeadStylesheetElements() {
    return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)
  }

  get newHeadScriptElements() {
    return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)
  }

  get currentHeadProvisionalElements() {
    return this.currentHeadSnapshot.provisionalElements
  }

  get newHeadProvisionalElements() {
    return this.newHeadSnapshot.provisionalElements
  }

  get newBodyScriptElements() {
    return this.newElement.querySelectorAll("script")
  }
}

class MorphingPageRenderer extends PageRenderer {
  static renderElement(currentElement, newElement) {
    morphElements(currentElement, newElement, {
      callbacks: {
        beforeNodeMorphed: element => !canRefreshFrame(element)
      }
    });

    for (const frame of currentElement.querySelectorAll("turbo-frame")) {
      if (canRefreshFrame(frame)) frame.reload();
    }

    dispatch("turbo:morph", { detail: { currentElement, newElement } });
  }

  async preservingPermanentElements(callback) {
    return await callback()
  }

  get renderMethod() {
    return "morph"
  }

  get shouldAutofocus() {
    return false
  }
}

function canRefreshFrame(frame) {
  return frame instanceof FrameElement &&
    frame.src &&
    frame.refresh === "morph" &&
    !frame.closest("[data-turbo-permanent]")
}

class SnapshotCache {
  keys = []
  snapshots = {}

  constructor(size) {
    this.size = size;
  }

  has(location) {
    return toCacheKey(location) in this.snapshots
  }

  get(location) {
    if (this.has(location)) {
      const snapshot = this.read(location);
      this.touch(location);
      return snapshot
    }
  }

  put(location, snapshot) {
    this.write(location, snapshot);
    this.touch(location);
    return snapshot
  }

  clear() {
    this.snapshots = {};
  }

  // Private

  read(location) {
    return this.snapshots[toCacheKey(location)]
  }

  write(location, snapshot) {
    this.snapshots[toCacheKey(location)] = snapshot;
  }

  touch(location) {
    const key = toCacheKey(location);
    const index = this.keys.indexOf(key);
    if (index > -1) this.keys.splice(index, 1);
    this.keys.unshift(key);
    this.trim();
  }

  trim() {
    for (const key of this.keys.splice(this.size)) {
      delete this.snapshots[key];
    }
  }
}

class PageView extends View {
  snapshotCache = new SnapshotCache(10)
  lastRenderedLocation = new URL(location.href)
  forceReloaded = false

  shouldTransitionTo(newSnapshot) {
    return this.snapshot.prefersViewTransitions && newSnapshot.prefersViewTransitions
  }

  renderPage(snapshot, isPreview = false, willRender = true, visit) {
    const shouldMorphPage = this.isPageRefresh(visit) && this.snapshot.shouldMorphPage;
    const rendererClass = shouldMorphPage ? MorphingPageRenderer : PageRenderer;

    const renderer = new rendererClass(this.snapshot, snapshot, isPreview, willRender);

    if (!renderer.shouldRender) {
      this.forceReloaded = true;
    } else {
      visit?.changeHistory();
    }

    return this.render(renderer)
  }

  renderError(snapshot, visit) {
    visit?.changeHistory();
    const renderer = new ErrorRenderer(this.snapshot, snapshot, false);
    return this.render(renderer)
  }

  clearSnapshotCache() {
    this.snapshotCache.clear();
  }

  async cacheSnapshot(snapshot = this.snapshot) {
    if (snapshot.isCacheable) {
      this.delegate.viewWillCacheSnapshot();
      const { lastRenderedLocation: location } = this;
      await nextEventLoopTick();
      const cachedSnapshot = snapshot.clone();
      this.snapshotCache.put(location, cachedSnapshot);
      return cachedSnapshot
    }
  }

  getCachedSnapshotForLocation(location) {
    return this.snapshotCache.get(location)
  }

  isPageRefresh(visit) {
    return !visit || (this.lastRenderedLocation.pathname === visit.location.pathname && visit.action === "replace")
  }

  shouldPreserveScrollPosition(visit) {
    return this.isPageRefresh(visit) && this.snapshot.shouldPreserveScrollPosition
  }

  get snapshot() {
    return PageSnapshot.fromElement(this.element)
  }
}

class Preloader {
  selector = "a[data-turbo-preload]"

  constructor(delegate, snapshotCache) {
    this.delegate = delegate;
    this.snapshotCache = snapshotCache;
  }

  start() {
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", this.#preloadAll);
    } else {
      this.preloadOnLoadLinksForView(document.body);
    }
  }

  stop() {
    document.removeEventListener("DOMContentLoaded", this.#preloadAll);
  }

  preloadOnLoadLinksForView(element) {
    for (const link of element.querySelectorAll(this.selector)) {
      if (this.delegate.shouldPreloadLink(link)) {
        this.preloadURL(link);
      }
    }
  }

  async preloadURL(link) {
    const location = new URL(link.href);

    if (this.snapshotCache.has(location)) {
      return
    }

    const fetchRequest = new FetchRequest(this, FetchMethod.get, location, new URLSearchParams(), link);
    await fetchRequest.perform();
  }

  // Fetch request delegate

  prepareRequest(fetchRequest) {
    fetchRequest.headers["X-Sec-Purpose"] = "prefetch";
  }

  async requestSucceededWithResponse(fetchRequest, fetchResponse) {
    try {
      const responseHTML = await fetchResponse.responseHTML;
      const snapshot = PageSnapshot.fromHTMLString(responseHTML);

      this.snapshotCache.put(fetchRequest.url, snapshot);
    } catch (_) {
      // If we cannot preload that is ok!
    }
  }

  requestStarted(fetchRequest) {}

  requestErrored(fetchRequest) {}

  requestFinished(fetchRequest) {}

  requestPreventedHandlingResponse(fetchRequest, fetchResponse) {}

  requestFailedWithResponse(fetchRequest, fetchResponse) {}

  #preloadAll = () => {
    this.preloadOnLoadLinksForView(document.body);
  }
}

class Cache {
  constructor(session) {
    this.session = session;
  }

  clear() {
    this.session.clearCache();
  }

  resetCacheControl() {
    this.#setCacheControl("");
  }

  exemptPageFromCache() {
    this.#setCacheControl("no-cache");
  }

  exemptPageFromPreview() {
    this.#setCacheControl("no-preview");
  }

  #setCacheControl(value) {
    setMetaContent("turbo-cache-control", value);
  }
}

class Session {
  navigator = new Navigator(this)
  history = new History(this)
  view = new PageView(this, document.documentElement)
  adapter = new BrowserAdapter(this)

  pageObserver = new PageObserver(this)
  cacheObserver = new CacheObserver()
  linkPrefetchObserver = new LinkPrefetchObserver(this, document)
  linkClickObserver = new LinkClickObserver(this, window)
  formSubmitObserver = new FormSubmitObserver(this, document)
  scrollObserver = new ScrollObserver(this)
  streamObserver = new StreamObserver(this)
  formLinkClickObserver = new FormLinkClickObserver(this, document.documentElement)
  frameRedirector = new FrameRedirector(this, document.documentElement)
  streamMessageRenderer = new StreamMessageRenderer()
  cache = new Cache(this)

  enabled = true
  started = false
  #pageRefreshDebouncePeriod = 150

  constructor(recentRequests) {
    this.recentRequests = recentRequests;
    this.preloader = new Preloader(this, this.view.snapshotCache);
    this.debouncedRefresh = this.refresh;
    this.pageRefreshDebouncePeriod = this.pageRefreshDebouncePeriod;
  }

  start() {
    if (!this.started) {
      this.pageObserver.start();
      this.cacheObserver.start();
      this.linkPrefetchObserver.start();
      this.formLinkClickObserver.start();
      this.linkClickObserver.start();
      this.formSubmitObserver.start();
      this.scrollObserver.start();
      this.streamObserver.start();
      this.frameRedirector.start();
      this.history.start();
      this.preloader.start();
      this.started = true;
      this.enabled = true;
    }
  }

  disable() {
    this.enabled = false;
  }

  stop() {
    if (this.started) {
      this.pageObserver.stop();
      this.cacheObserver.stop();
      this.linkPrefetchObserver.stop();
      this.formLinkClickObserver.stop();
      this.linkClickObserver.stop();
      this.formSubmitObserver.stop();
      this.scrollObserver.stop();
      this.streamObserver.stop();
      this.frameRedirector.stop();
      this.history.stop();
      this.preloader.stop();
      this.started = false;
    }
  }

  registerAdapter(adapter) {
    this.adapter = adapter;
  }

  visit(location, options = {}) {
    const frameElement = options.frame ? document.getElementById(options.frame) : null;

    if (frameElement instanceof FrameElement) {
      const action = options.action || getVisitAction(frameElement);

      frameElement.delegate.proposeVisitIfNavigatedWithAction(frameElement, action);
      frameElement.src = location.toString();
    } else {
      this.navigator.proposeVisit(expandURL(location), options);
    }
  }

  refresh(url, requestId) {
    const isRecentRequest = requestId && this.recentRequests.has(requestId);
    if (!isRecentRequest && !this.navigator.currentVisit) {
      this.visit(url, { action: "replace", shouldCacheSnapshot: false });
    }
  }

  connectStreamSource(source) {
    this.streamObserver.connectStreamSource(source);
  }

  disconnectStreamSource(source) {
    this.streamObserver.disconnectStreamSource(source);
  }

  renderStreamMessage(message) {
    this.streamMessageRenderer.render(StreamMessage.wrap(message));
  }

  clearCache() {
    this.view.clearSnapshotCache();
  }

  setProgressBarDelay(delay) {
    console.warn(
      "Please replace `session.setProgressBarDelay(delay)` with `session.progressBarDelay = delay`. The function is deprecated and will be removed in a future version of Turbo.`"
    );

    this.progressBarDelay = delay;
  }

  set progressBarDelay(delay) {
    config.drive.progressBarDelay = delay;
  }

  get progressBarDelay() {
    return config.drive.progressBarDelay
  }

  set drive(value) {
    config.drive.enabled = value;
  }

  get drive() {
    return config.drive.enabled
  }

  set formMode(value) {
    config.forms.mode = value;
  }

  get formMode() {
    return config.forms.mode
  }

  get location() {
    return this.history.location
  }

  get restorationIdentifier() {
    return this.history.restorationIdentifier
  }

  get pageRefreshDebouncePeriod() {
    return this.#pageRefreshDebouncePeriod
  }

  set pageRefreshDebouncePeriod(value) {
    this.refresh = debounce(this.debouncedRefresh.bind(this), value);
    this.#pageRefreshDebouncePeriod = value;
  }

  // Preloader delegate

  shouldPreloadLink(element) {
    const isUnsafe = element.hasAttribute("data-turbo-method");
    const isStream = element.hasAttribute("data-turbo-stream");
    const frameTarget = element.getAttribute("data-turbo-frame");
    const frame = frameTarget == "_top" ?
      null :
      document.getElementById(frameTarget) || findClosestRecursively(element, "turbo-frame:not([disabled])");

    if (isUnsafe || isStream || frame instanceof FrameElement) {
      return false
    } else {
      const location = new URL(element.href);

      return this.elementIsNavigatable(element) && locationIsVisitable(location, this.snapshot.rootLocation)
    }
  }

  // History delegate

  historyPoppedToLocationWithRestorationIdentifierAndDirection(location, restorationIdentifier, direction) {
    if (this.enabled) {
      this.navigator.startVisit(location, restorationIdentifier, {
        action: "restore",
        historyChanged: true,
        direction
      });
    } else {
      this.adapter.pageInvalidated({
        reason: "turbo_disabled"
      });
    }
  }

  // Scroll observer delegate

  scrollPositionChanged(position) {
    this.history.updateRestorationData({ scrollPosition: position });
  }

  // Form click observer delegate

  willSubmitFormLinkToLocation(link, location) {
    return this.elementIsNavigatable(link) && locationIsVisitable(location, this.snapshot.rootLocation)
  }

  submittedFormLinkToLocation() {}

  // Link hover observer delegate

  canPrefetchRequestToLocation(link, location) {
    return (
      this.elementIsNavigatable(link) &&
        locationIsVisitable(location, this.snapshot.rootLocation)
    )
  }

  // Link click observer delegate

  willFollowLinkToLocation(link, location, event) {
    return (
      this.elementIsNavigatable(link) &&
      locationIsVisitable(location, this.snapshot.rootLocation) &&
      this.applicationAllowsFollowingLinkToLocation(link, location, event)
    )
  }

  followedLinkToLocation(link, location) {
    const action = this.getActionForLink(link);
    const acceptsStreamResponse = link.hasAttribute("data-turbo-stream");

    this.visit(location.href, { action, acceptsStreamResponse });
  }

  // Navigator delegate

  allowsVisitingLocationWithAction(location, action) {
    return this.locationWithActionIsSamePage(location, action) || this.applicationAllowsVisitingLocation(location)
  }

  visitProposedToLocation(location, options) {
    extendURLWithDeprecatedProperties(location);
    this.adapter.visitProposedToLocation(location, options);
  }

  // Visit delegate

  visitStarted(visit) {
    if (!visit.acceptsStreamResponse) {
      markAsBusy(document.documentElement);
      this.view.markVisitDirection(visit.direction);
    }
    extendURLWithDeprecatedProperties(visit.location);
    if (!visit.silent) {
      this.notifyApplicationAfterVisitingLocation(visit.location, visit.action);
    }
  }

  visitCompleted(visit) {
    this.view.unmarkVisitDirection();
    clearBusyState(document.documentElement);
    this.notifyApplicationAfterPageLoad(visit.getTimingMetrics());
  }

  locationWithActionIsSamePage(location, action) {
    return this.navigator.locationWithActionIsSamePage(location, action)
  }

  visitScrolledToSamePageLocation(oldURL, newURL) {
    this.notifyApplicationAfterVisitingSamePageLocation(oldURL, newURL);
  }

  // Form submit observer delegate

  willSubmitForm(form, submitter) {
    const action = getAction$1(form, submitter);

    return (
      this.submissionIsNavigatable(form, submitter) &&
      locationIsVisitable(expandURL(action), this.snapshot.rootLocation)
    )
  }

  formSubmitted(form, submitter) {
    this.navigator.submitForm(form, submitter);
  }

  // Page observer delegate

  pageBecameInteractive() {
    this.view.lastRenderedLocation = this.location;
    this.notifyApplicationAfterPageLoad();
  }

  pageLoaded() {
    this.history.assumeControlOfScrollRestoration();
  }

  pageWillUnload() {
    this.history.relinquishControlOfScrollRestoration();
  }

  // Stream observer delegate

  receivedMessageFromStream(message) {
    this.renderStreamMessage(message);
  }

  // Page view delegate

  viewWillCacheSnapshot() {
    if (!this.navigator.currentVisit?.silent) {
      this.notifyApplicationBeforeCachingSnapshot();
    }
  }

  allowsImmediateRender({ element }, options) {
    const event = this.notifyApplicationBeforeRender(element, options);
    const {
      defaultPrevented,
      detail: { render }
    } = event;

    if (this.view.renderer && render) {
      this.view.renderer.renderElement = render;
    }

    return !defaultPrevented
  }

  viewRenderedSnapshot(_snapshot, _isPreview, renderMethod) {
    this.view.lastRenderedLocation = this.history.location;
    this.notifyApplicationAfterRender(renderMethod);
  }

  preloadOnLoadLinksForView(element) {
    this.preloader.preloadOnLoadLinksForView(element);
  }

  viewInvalidated(reason) {
    this.adapter.pageInvalidated(reason);
  }

  // Frame element

  frameLoaded(frame) {
    this.notifyApplicationAfterFrameLoad(frame);
  }

  frameRendered(fetchResponse, frame) {
    this.notifyApplicationAfterFrameRender(fetchResponse, frame);
  }

  // Application events

  applicationAllowsFollowingLinkToLocation(link, location, ev) {
    const event = this.notifyApplicationAfterClickingLinkToLocation(link, location, ev);
    return !event.defaultPrevented
  }

  applicationAllowsVisitingLocation(location) {
    const event = this.notifyApplicationBeforeVisitingLocation(location);
    return !event.defaultPrevented
  }

  notifyApplicationAfterClickingLinkToLocation(link, location, event) {
    return dispatch("turbo:click", {
      target: link,
      detail: { url: location.href, originalEvent: event },
      cancelable: true
    })
  }

  notifyApplicationBeforeVisitingLocation(location) {
    return dispatch("turbo:before-visit", {
      detail: { url: location.href },
      cancelable: true
    })
  }

  notifyApplicationAfterVisitingLocation(location, action) {
    return dispatch("turbo:visit", { detail: { url: location.href, action } })
  }

  notifyApplicationBeforeCachingSnapshot() {
    return dispatch("turbo:before-cache")
  }

  notifyApplicationBeforeRender(newBody, options) {
    return dispatch("turbo:before-render", {
      detail: { newBody, ...options },
      cancelable: true
    })
  }

  notifyApplicationAfterRender(renderMethod) {
    return dispatch("turbo:render", { detail: { renderMethod } })
  }

  notifyApplicationAfterPageLoad(timing = {}) {
    return dispatch("turbo:load", {
      detail: { url: this.location.href, timing }
    })
  }

  notifyApplicationAfterVisitingSamePageLocation(oldURL, newURL) {
    dispatchEvent(
      new HashChangeEvent("hashchange", {
        oldURL: oldURL.toString(),
        newURL: newURL.toString()
      })
    );
  }

  notifyApplicationAfterFrameLoad(frame) {
    return dispatch("turbo:frame-load", { target: frame })
  }

  notifyApplicationAfterFrameRender(fetchResponse, frame) {
    return dispatch("turbo:frame-render", {
      detail: { fetchResponse },
      target: frame,
      cancelable: true
    })
  }

  // Helpers

  submissionIsNavigatable(form, submitter) {
    if (config.forms.mode == "off") {
      return false
    } else {
      const submitterIsNavigatable = submitter ? this.elementIsNavigatable(submitter) : true;

      if (config.forms.mode == "optin") {
        return submitterIsNavigatable && form.closest('[data-turbo="true"]') != null
      } else {
        return submitterIsNavigatable && this.elementIsNavigatable(form)
      }
    }
  }

  elementIsNavigatable(element) {
    const container = findClosestRecursively(element, "[data-turbo]");
    const withinFrame = findClosestRecursively(element, "turbo-frame");

    // Check if Drive is enabled on the session or we're within a Frame.
    if (config.drive.enabled || withinFrame) {
      // Element is navigatable by default, unless `data-turbo="false"`.
      if (container) {
        return container.getAttribute("data-turbo") != "false"
      } else {
        return true
      }
    } else {
      // Element isn't navigatable by default, unless `data-turbo="true"`.
      if (container) {
        return container.getAttribute("data-turbo") == "true"
      } else {
        return false
      }
    }
  }

  // Private

  getActionForLink(link) {
    return getVisitAction(link) || "advance"
  }

  get snapshot() {
    return this.view.snapshot
  }
}

// Older versions of the Turbo Native adapters referenced the
// `Location#absoluteURL` property in their implementations of
// the `Adapter#visitProposedToLocation()` and `#visitStarted()`
// methods. The Location class has since been removed in favor
// of the DOM URL API, and accordingly all Adapter methods now
// receive URL objects.
//
// We alias #absoluteURL to #toString() here to avoid crashing
// older adapters which do not expect URL objects. We should
// consider removing this support at some point in the future.

function extendURLWithDeprecatedProperties(url) {
  Object.defineProperties(url, deprecatedLocationPropertyDescriptors);
}

const deprecatedLocationPropertyDescriptors = {
  absoluteURL: {
    get() {
      return this.toString()
    }
  }
};

const session = new Session(recentRequests);
const { cache, navigator: navigator$1 } = session;

/**
 * Starts the main session.
 * This initialises any necessary observers such as those to monitor
 * link interactions.
 */
function start() {
  session.start();
}

/**
 * Registers an adapter for the main session.
 *
 * @param adapter Adapter to register
 */
function registerAdapter(adapter) {
  session.registerAdapter(adapter);
}

/**
 * Performs an application visit to the given location.
 *
 * @param location Location to visit (a URL or path)
 * @param options Options to apply
 * @param options.action Type of history navigation to apply ("restore",
 * "replace" or "advance")
 * @param options.historyChanged Specifies whether the browser history has
 * already been changed for this visit or not
 * @param options.referrer Specifies the referrer of this visit such that
 * navigations to the same page will not result in a new history entry.
 * @param options.snapshotHTML Cached snapshot to render
 * @param options.response Response of the specified location
 */
function visit(location, options) {
  session.visit(location, options);
}

/**
 * Connects a stream source to the main session.
 *
 * @param source Stream source to connect
 */
function connectStreamSource(source) {
  session.connectStreamSource(source);
}

/**
 * Disconnects a stream source from the main session.
 *
 * @param source Stream source to disconnect
 */
function disconnectStreamSource(source) {
  session.disconnectStreamSource(source);
}

/**
 * Renders a stream message to the main session by appending it to the
 * current document.
 *
 * @param message Message to render
 */
function renderStreamMessage(message) {
  session.renderStreamMessage(message);
}

/**
 * Removes all entries from the Turbo Drive page cache.
 * Call this when state has changed on the server that may affect cached pages.
 *
 * @deprecated since version 7.2.0 in favor of `Turbo.cache.clear()`
 */
function clearCache() {
  console.warn(
    "Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  session.clearCache();
}

/**
 * Sets the delay after which the progress bar will appear during navigation.
 *
 * The progress bar appears after 500ms by default.
 *
 * Note that this method has no effect when used with the iOS or Android
 * adapters.
 *
 * @param delay Time to delay in milliseconds
 */
function setProgressBarDelay(delay) {
  console.warn(
    "Please replace `Turbo.setProgressBarDelay(delay)` with `Turbo.config.drive.progressBarDelay = delay`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  config.drive.progressBarDelay = delay;
}

function setConfirmMethod(confirmMethod) {
  console.warn(
    "Please replace `Turbo.setConfirmMethod(confirmMethod)` with `Turbo.config.forms.confirm = confirmMethod`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  config.forms.confirm = confirmMethod;
}

function setFormMode(mode) {
  console.warn(
    "Please replace `Turbo.setFormMode(mode)` with `Turbo.config.forms.mode = mode`. The top-level function is deprecated and will be removed in a future version of Turbo.`"
  );
  config.forms.mode = mode;
}

var Turbo = /*#__PURE__*/Object.freeze({
  __proto__: null,
  navigator: navigator$1,
  session: session,
  cache: cache,
  PageRenderer: PageRenderer,
  PageSnapshot: PageSnapshot,
  FrameRenderer: FrameRenderer,
  fetch: fetchWithTurboHeaders,
  config: config,
  start: start,
  registerAdapter: registerAdapter,
  visit: visit,
  connectStreamSource: connectStreamSource,
  disconnectStreamSource: disconnectStreamSource,
  renderStreamMessage: renderStreamMessage,
  clearCache: clearCache,
  setProgressBarDelay: setProgressBarDelay,
  setConfirmMethod: setConfirmMethod,
  setFormMode: setFormMode
});

class TurboFrameMissingError extends Error {}

class FrameController {
  fetchResponseLoaded = (_fetchResponse) => Promise.resolve()
  #currentFetchRequest = null
  #resolveVisitPromise = () => {}
  #connected = false
  #hasBeenLoaded = false
  #ignoredAttributes = new Set()
  #shouldMorphFrame = false
  action = null

  constructor(element) {
    this.element = element;
    this.view = new FrameView(this, this.element);
    this.appearanceObserver = new AppearanceObserver(this, this.element);
    this.formLinkClickObserver = new FormLinkClickObserver(this, this.element);
    this.linkInterceptor = new LinkInterceptor(this, this.element);
    this.restorationIdentifier = uuid();
    this.formSubmitObserver = new FormSubmitObserver(this, this.element);
  }

  // Frame delegate

  connect() {
    if (!this.#connected) {
      this.#connected = true;
      if (this.loadingStyle == FrameLoadingStyle.lazy) {
        this.appearanceObserver.start();
      } else {
        this.#loadSourceURL();
      }
      this.formLinkClickObserver.start();
      this.linkInterceptor.start();
      this.formSubmitObserver.start();
    }
  }

  disconnect() {
    if (this.#connected) {
      this.#connected = false;
      this.appearanceObserver.stop();
      this.formLinkClickObserver.stop();
      this.linkInterceptor.stop();
      this.formSubmitObserver.stop();
    }
  }

  disabledChanged() {
    if (this.loadingStyle == FrameLoadingStyle.eager) {
      this.#loadSourceURL();
    }
  }

  sourceURLChanged() {
    if (this.#isIgnoringChangesTo("src")) return

    if (this.element.isConnected) {
      this.complete = false;
    }

    if (this.loadingStyle == FrameLoadingStyle.eager || this.#hasBeenLoaded) {
      this.#loadSourceURL();
    }
  }

  sourceURLReloaded() {
    const { refresh, src } = this.element;

    this.#shouldMorphFrame = src && refresh === "morph";

    this.element.removeAttribute("complete");
    this.element.src = null;
    this.element.src = src;
    return this.element.loaded
  }

  loadingStyleChanged() {
    if (this.loadingStyle == FrameLoadingStyle.lazy) {
      this.appearanceObserver.start();
    } else {
      this.appearanceObserver.stop();
      this.#loadSourceURL();
    }
  }

  async #loadSourceURL() {
    if (this.enabled && this.isActive && !this.complete && this.sourceURL) {
      this.element.loaded = this.#visit(expandURL(this.sourceURL));
      this.appearanceObserver.stop();
      await this.element.loaded;
      this.#hasBeenLoaded = true;
    }
  }

  async loadResponse(fetchResponse) {
    if (fetchResponse.redirected || (fetchResponse.succeeded && fetchResponse.isHTML)) {
      this.sourceURL = fetchResponse.response.url;
    }

    try {
      const html = await fetchResponse.responseHTML;
      if (html) {
        const document = parseHTMLDocument(html);
        const pageSnapshot = PageSnapshot.fromDocument(document);

        if (pageSnapshot.isVisitable) {
          await this.#loadFrameResponse(fetchResponse, document);
        } else {
          await this.#handleUnvisitableFrameResponse(fetchResponse);
        }
      }
    } finally {
      this.#shouldMorphFrame = false;
      this.fetchResponseLoaded = () => Promise.resolve();
    }
  }

  // Appearance observer delegate

  elementAppearedInViewport(element) {
    this.proposeVisitIfNavigatedWithAction(element, getVisitAction(element));
    this.#loadSourceURL();
  }

  // Form link click observer delegate

  willSubmitFormLinkToLocation(link) {
    return this.#shouldInterceptNavigation(link)
  }

  submittedFormLinkToLocation(link, _location, form) {
    const frame = this.#findFrameElement(link);
    if (frame) form.setAttribute("data-turbo-frame", frame.id);
  }

  // Link interceptor delegate

  shouldInterceptLinkClick(element, _location, _event) {
    return this.#shouldInterceptNavigation(element)
  }

  linkClickIntercepted(element, location) {
    this.#navigateFrame(element, location);
  }

  // Form submit observer delegate

  willSubmitForm(element, submitter) {
    return element.closest("turbo-frame") == this.element && this.#shouldInterceptNavigation(element, submitter)
  }

  formSubmitted(element, submitter) {
    if (this.formSubmission) {
      this.formSubmission.stop();
    }

    this.formSubmission = new FormSubmission(this, element, submitter);
    const { fetchRequest } = this.formSubmission;
    this.prepareRequest(fetchRequest);
    this.formSubmission.start();
  }

  // Fetch request delegate

  prepareRequest(request) {
    request.headers["Turbo-Frame"] = this.id;

    if (this.currentNavigationElement?.hasAttribute("data-turbo-stream")) {
      request.acceptResponseType(StreamMessage.contentType);
    }
  }

  requestStarted(_request) {
    markAsBusy(this.element);
  }

  requestPreventedHandlingResponse(_request, _response) {
    this.#resolveVisitPromise();
  }

  async requestSucceededWithResponse(request, response) {
    await this.loadResponse(response);
    this.#resolveVisitPromise();
  }

  async requestFailedWithResponse(request, response) {
    await this.loadResponse(response);
    this.#resolveVisitPromise();
  }

  requestErrored(request, error) {
    console.error(error);
    this.#resolveVisitPromise();
  }

  requestFinished(_request) {
    clearBusyState(this.element);
  }

  // Form submission delegate

  formSubmissionStarted({ formElement }) {
    markAsBusy(formElement, this.#findFrameElement(formElement));
  }

  formSubmissionSucceededWithResponse(formSubmission, response) {
    const frame = this.#findFrameElement(formSubmission.formElement, formSubmission.submitter);

    frame.delegate.proposeVisitIfNavigatedWithAction(frame, getVisitAction(formSubmission.submitter, formSubmission.formElement, frame));
    frame.delegate.loadResponse(response);

    if (!formSubmission.isSafe) {
      session.clearCache();
    }
  }

  formSubmissionFailedWithResponse(formSubmission, fetchResponse) {
    this.element.delegate.loadResponse(fetchResponse);
    session.clearCache();
  }

  formSubmissionErrored(formSubmission, error) {
    console.error(error);
  }

  formSubmissionFinished({ formElement }) {
    clearBusyState(formElement, this.#findFrameElement(formElement));
  }

  // View delegate

  allowsImmediateRender({ element: newFrame }, options) {
    const event = dispatch("turbo:before-frame-render", {
      target: this.element,
      detail: { newFrame, ...options },
      cancelable: true
    });

    const {
      defaultPrevented,
      detail: { render }
    } = event;

    if (this.view.renderer && render) {
      this.view.renderer.renderElement = render;
    }

    return !defaultPrevented
  }

  viewRenderedSnapshot(_snapshot, _isPreview, _renderMethod) {}

  preloadOnLoadLinksForView(element) {
    session.preloadOnLoadLinksForView(element);
  }

  viewInvalidated() {}

  // Frame renderer delegate

  willRenderFrame(currentElement, _newElement) {
    this.previousFrameElement = currentElement.cloneNode(true);
  }

  visitCachedSnapshot = ({ element }) => {
    const frame = element.querySelector("#" + this.element.id);

    if (frame && this.previousFrameElement) {
      frame.replaceChildren(...this.previousFrameElement.children);
    }

    delete this.previousFrameElement;
  }

  // Private

  async #loadFrameResponse(fetchResponse, document) {
    const newFrameElement = await this.extractForeignFrameElement(document.body);
    const rendererClass = this.#shouldMorphFrame ? MorphingFrameRenderer : FrameRenderer;

    if (newFrameElement) {
      const snapshot = new Snapshot(newFrameElement);
      const renderer = new rendererClass(this, this.view.snapshot, snapshot, false, false);
      if (this.view.renderPromise) await this.view.renderPromise;
      this.changeHistory();

      await this.view.render(renderer);
      this.complete = true;
      session.frameRendered(fetchResponse, this.element);
      session.frameLoaded(this.element);
      await this.fetchResponseLoaded(fetchResponse);
    } else if (this.#willHandleFrameMissingFromResponse(fetchResponse)) {
      this.#handleFrameMissingFromResponse(fetchResponse);
    }
  }

  async #visit(url) {
    const request = new FetchRequest(this, FetchMethod.get, url, new URLSearchParams(), this.element);

    this.#currentFetchRequest?.cancel();
    this.#currentFetchRequest = request;

    return new Promise((resolve) => {
      this.#resolveVisitPromise = () => {
        this.#resolveVisitPromise = () => {};
        this.#currentFetchRequest = null;
        resolve();
      };
      request.perform();
    })
  }

  #navigateFrame(element, url, submitter) {
    const frame = this.#findFrameElement(element, submitter);

    frame.delegate.proposeVisitIfNavigatedWithAction(frame, getVisitAction(submitter, element, frame));

    this.#withCurrentNavigationElement(element, () => {
      frame.src = url;
    });
  }

  proposeVisitIfNavigatedWithAction(frame, action = null) {
    this.action = action;

    if (this.action) {
      const pageSnapshot = PageSnapshot.fromElement(frame).clone();
      const { visitCachedSnapshot } = frame.delegate;

      frame.delegate.fetchResponseLoaded = async (fetchResponse) => {
        if (frame.src) {
          const { statusCode, redirected } = fetchResponse;
          const responseHTML = await fetchResponse.responseHTML;
          const response = { statusCode, redirected, responseHTML };
          const options = {
            response,
            visitCachedSnapshot,
            willRender: false,
            updateHistory: false,
            restorationIdentifier: this.restorationIdentifier,
            snapshot: pageSnapshot
          };

          if (this.action) options.action = this.action;

          session.visit(frame.src, options);
        }
      };
    }
  }

  changeHistory() {
    if (this.action) {
      const method = getHistoryMethodForAction(this.action);
      session.history.update(method, expandURL(this.element.src || ""), this.restorationIdentifier);
    }
  }

  async #handleUnvisitableFrameResponse(fetchResponse) {
    console.warn(
      `The response (${fetchResponse.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`
    );

    await this.#visitResponse(fetchResponse.response);
  }

  #willHandleFrameMissingFromResponse(fetchResponse) {
    this.element.setAttribute("complete", "");

    const response = fetchResponse.response;
    const visit = async (url, options) => {
      if (url instanceof Response) {
        this.#visitResponse(url);
      } else {
        session.visit(url, options);
      }
    };

    const event = dispatch("turbo:frame-missing", {
      target: this.element,
      detail: { response, visit },
      cancelable: true
    });

    return !event.defaultPrevented
  }

  #handleFrameMissingFromResponse(fetchResponse) {
    this.view.missing();
    this.#throwFrameMissingError(fetchResponse);
  }

  #throwFrameMissingError(fetchResponse) {
    const message = `The response (${fetchResponse.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;
    throw new TurboFrameMissingError(message)
  }

  async #visitResponse(response) {
    const wrapped = new FetchResponse(response);
    const responseHTML = await wrapped.responseHTML;
    const { location, redirected, statusCode } = wrapped;

    return session.visit(location, { response: { redirected, statusCode, responseHTML } })
  }

  #findFrameElement(element, submitter) {
    const id = getAttribute("data-turbo-frame", submitter, element) || this.element.getAttribute("target");
    return getFrameElementById(id) ?? this.element
  }

  async extractForeignFrameElement(container) {
    let element;
    const id = CSS.escape(this.id);

    try {
      element = activateElement(container.querySelector(`turbo-frame#${id}`), this.sourceURL);
      if (element) {
        return element
      }

      element = activateElement(container.querySelector(`turbo-frame[src][recurse~=${id}]`), this.sourceURL);
      if (element) {
        await element.loaded;
        return await this.extractForeignFrameElement(element)
      }
    } catch (error) {
      console.error(error);
      return new FrameElement()
    }

    return null
  }

  #formActionIsVisitable(form, submitter) {
    const action = getAction$1(form, submitter);

    return locationIsVisitable(expandURL(action), this.rootLocation)
  }

  #shouldInterceptNavigation(element, submitter) {
    const id = getAttribute("data-turbo-frame", submitter, element) || this.element.getAttribute("target");

    if (element instanceof HTMLFormElement && !this.#formActionIsVisitable(element, submitter)) {
      return false
    }

    if (!this.enabled || id == "_top") {
      return false
    }

    if (id) {
      const frameElement = getFrameElementById(id);
      if (frameElement) {
        return !frameElement.disabled
      }
    }

    if (!session.elementIsNavigatable(element)) {
      return false
    }

    if (submitter && !session.elementIsNavigatable(submitter)) {
      return false
    }

    return true
  }

  // Computed properties

  get id() {
    return this.element.id
  }

  get enabled() {
    return !this.element.disabled
  }

  get sourceURL() {
    if (this.element.src) {
      return this.element.src
    }
  }

  set sourceURL(sourceURL) {
    this.#ignoringChangesToAttribute("src", () => {
      this.element.src = sourceURL ?? null;
    });
  }

  get loadingStyle() {
    return this.element.loading
  }

  get isLoading() {
    return this.formSubmission !== undefined || this.#resolveVisitPromise() !== undefined
  }

  get complete() {
    return this.element.hasAttribute("complete")
  }

  set complete(value) {
    if (value) {
      this.element.setAttribute("complete", "");
    } else {
      this.element.removeAttribute("complete");
    }
  }

  get isActive() {
    return this.element.isActive && this.#connected
  }

  get rootLocation() {
    const meta = this.element.ownerDocument.querySelector(`meta[name="turbo-root"]`);
    const root = meta?.content ?? "/";
    return expandURL(root)
  }

  #isIgnoringChangesTo(attributeName) {
    return this.#ignoredAttributes.has(attributeName)
  }

  #ignoringChangesToAttribute(attributeName, callback) {
    this.#ignoredAttributes.add(attributeName);
    callback();
    this.#ignoredAttributes.delete(attributeName);
  }

  #withCurrentNavigationElement(element, callback) {
    this.currentNavigationElement = element;
    callback();
    delete this.currentNavigationElement;
  }
}

function getFrameElementById(id) {
  if (id != null) {
    const element = document.getElementById(id);
    if (element instanceof FrameElement) {
      return element
    }
  }
}

function activateElement(element, currentURL) {
  if (element) {
    const src = element.getAttribute("src");
    if (src != null && currentURL != null && urlsAreEqual(src, currentURL)) {
      throw new Error(`Matching <turbo-frame id="${element.id}"> element has a source URL which references itself`)
    }
    if (element.ownerDocument !== document) {
      element = document.importNode(element, true);
    }

    if (element instanceof FrameElement) {
      element.connectedCallback();
      element.disconnectedCallback();
      return element
    }
  }
}

const StreamActions = {
  after() {
    this.targetElements.forEach((e) => e.parentElement?.insertBefore(this.templateContent, e.nextSibling));
  },

  append() {
    this.removeDuplicateTargetChildren();
    this.targetElements.forEach((e) => e.append(this.templateContent));
  },

  before() {
    this.targetElements.forEach((e) => e.parentElement?.insertBefore(this.templateContent, e));
  },

  prepend() {
    this.removeDuplicateTargetChildren();
    this.targetElements.forEach((e) => e.prepend(this.templateContent));
  },

  remove() {
    this.targetElements.forEach((e) => e.remove());
  },

  replace() {
    const method = this.getAttribute("method");

    this.targetElements.forEach((targetElement) => {
      if (method === "morph") {
        morphElements(targetElement, this.templateContent);
      } else {
        targetElement.replaceWith(this.templateContent);
      }
    });
  },

  update() {
    const method = this.getAttribute("method");

    this.targetElements.forEach((targetElement) => {
      if (method === "morph") {
        morphChildren(targetElement, this.templateContent);
      } else {
        targetElement.innerHTML = "";
        targetElement.append(this.templateContent);
      }
    });
  },

  refresh() {
    session.refresh(this.baseURI, this.requestId);
  }
};

// <turbo-stream action=replace target=id><template>...

/**
 * Renders updates to the page from a stream of messages.
 *
 * Using the `action` attribute, this can be configured one of eight ways:
 *
 * - `after` - inserts the result after the target
 * - `append` - appends the result to the target
 * - `before` - inserts the result before the target
 * - `prepend` - prepends the result to the target
 * - `refresh` - initiates a page refresh
 * - `remove` - removes the target
 * - `replace` - replaces the outer HTML of the target
 * - `update` - replaces the inner HTML of the target
 *
 * @customElement turbo-stream
 * @example
 *   <turbo-stream action="append" target="dom_id">
 *     <template>
 *       Content to append to target designated with the dom_id.
 *     </template>
 *   </turbo-stream>
 */
class StreamElement extends HTMLElement {
  static async renderElement(newElement) {
    await newElement.performAction();
  }

  async connectedCallback() {
    try {
      await this.render();
    } catch (error) {
      console.error(error);
    } finally {
      this.disconnect();
    }
  }

  async render() {
    return (this.renderPromise ??= (async () => {
      const event = this.beforeRenderEvent;

      if (this.dispatchEvent(event)) {
        await nextRepaint();
        await event.detail.render(this);
      }
    })())
  }

  disconnect() {
    try {
      this.remove();
      // eslint-disable-next-line no-empty
    } catch {}
  }

  /**
   * Removes duplicate children (by ID)
   */
  removeDuplicateTargetChildren() {
    this.duplicateChildren.forEach((c) => c.remove());
  }

  /**
   * Gets the list of duplicate children (i.e. those with the same ID)
   */
  get duplicateChildren() {
    const existingChildren = this.targetElements.flatMap((e) => [...e.children]).filter((c) => !!c.id);
    const newChildrenIds = [...(this.templateContent?.children || [])].filter((c) => !!c.id).map((c) => c.id);

    return existingChildren.filter((c) => newChildrenIds.includes(c.id))
  }

  /**
   * Gets the action function to be performed.
   */
  get performAction() {
    if (this.action) {
      const actionFunction = StreamActions[this.action];
      if (actionFunction) {
        return actionFunction
      }
      this.#raise("unknown action");
    }
    this.#raise("action attribute is missing");
  }

  /**
   * Gets the target elements which the template will be rendered to.
   */
  get targetElements() {
    if (this.target) {
      return this.targetElementsById
    } else if (this.targets) {
      return this.targetElementsByQuery
    } else {
      this.#raise("target or targets attribute is missing");
    }
  }

  /**
   * Gets the contents of the main `<template>`.
   */
  get templateContent() {
    return this.templateElement.content.cloneNode(true)
  }

  /**
   * Gets the main `<template>` used for rendering
   */
  get templateElement() {
    if (this.firstElementChild === null) {
      const template = this.ownerDocument.createElement("template");
      this.appendChild(template);
      return template
    } else if (this.firstElementChild instanceof HTMLTemplateElement) {
      return this.firstElementChild
    }
    this.#raise("first child element must be a <template> element");
  }

  /**
   * Gets the current action.
   */
  get action() {
    return this.getAttribute("action")
  }

  /**
   * Gets the current target (an element ID) to which the result will
   * be rendered.
   */
  get target() {
    return this.getAttribute("target")
  }

  /**
   * Gets the current "targets" selector (a CSS selector)
   */
  get targets() {
    return this.getAttribute("targets")
  }

  /**
   * Reads the request-id attribute
   */
  get requestId() {
    return this.getAttribute("request-id")
  }

  #raise(message) {
    throw new Error(`${this.description}: ${message}`)
  }

  get description() {
    return (this.outerHTML.match(/<[^>]+>/) ?? [])[0] ?? "<turbo-stream>"
  }

  get beforeRenderEvent() {
    return new CustomEvent("turbo:before-stream-render", {
      bubbles: true,
      cancelable: true,
      detail: { newStream: this, render: StreamElement.renderElement }
    })
  }

  get targetElementsById() {
    const element = this.ownerDocument?.getElementById(this.target);

    if (element !== null) {
      return [element]
    } else {
      return []
    }
  }

  get targetElementsByQuery() {
    const elements = this.ownerDocument?.querySelectorAll(this.targets);

    if (elements.length !== 0) {
      return Array.prototype.slice.call(elements)
    } else {
      return []
    }
  }
}

class StreamSourceElement extends HTMLElement {
  streamSource = null

  connectedCallback() {
    this.streamSource = this.src.match(/^ws{1,2}:/) ? new WebSocket(this.src) : new EventSource(this.src);

    connectStreamSource(this.streamSource);
  }

  disconnectedCallback() {
    if (this.streamSource) {
      this.streamSource.close();

      disconnectStreamSource(this.streamSource);
    }
  }

  get src() {
    return this.getAttribute("src") || ""
  }
}

FrameElement.delegateConstructor = FrameController;

if (customElements.get("turbo-frame") === undefined) {
  customElements.define("turbo-frame", FrameElement);
}

if (customElements.get("turbo-stream") === undefined) {
  customElements.define("turbo-stream", StreamElement);
}

if (customElements.get("turbo-stream-source") === undefined) {
  customElements.define("turbo-stream-source", StreamSourceElement);
}

(() => {
  let element = document.currentScript;
  if (!element) return
  if (element.hasAttribute("data-turbo-suppress-warning")) return

  element = element.parentElement;
  while (element) {
    if (element == document.body) {
      return console.warn(
        unindent`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,
        element.outerHTML
      )
    }

    element = element.parentElement;
  }
})();

window.Turbo = { ...Turbo, StreamActions };
start();




/***/ }),

/***/ "./node_modules/@simonwep/pickr/dist/pickr.min.js":
/*!********************************************************!*\
  !*** ./node_modules/@simonwep/pickr/dist/pickr.min.js ***!
  \********************************************************/
/***/ (function(module) {

/*! Pickr 1.9.0 MIT | https://github.com/Simonwep/pickr */
!function(t,e){ true?module.exports=e():0}(self,(()=>(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.d(e,{default:()=>E});var o={};function n(t,e,o,n,i={}){e instanceof HTMLCollection||e instanceof NodeList?e=Array.from(e):Array.isArray(e)||(e=[e]),Array.isArray(o)||(o=[o]);for(const s of e)for(const e of o)s[t](e,n,{capture:!1,...i});return Array.prototype.slice.call(arguments,1)}t.r(o),t.d(o,{adjustableInputNumbers:()=>p,createElementFromString:()=>r,createFromTemplate:()=>a,eventPath:()=>l,off:()=>s,on:()=>i,resolveElement:()=>c});const i=n.bind(null,"addEventListener"),s=n.bind(null,"removeEventListener");function r(t){const e=document.createElement("div");return e.innerHTML=t.trim(),e.firstElementChild}function a(t){const e=(t,e)=>{const o=t.getAttribute(e);return t.removeAttribute(e),o},o=(t,n={})=>{const i=e(t,":obj"),s=e(t,":ref"),r=i?n[i]={}:n;s&&(n[s]=t);for(const n of Array.from(t.children)){const t=e(n,":arr"),i=o(n,t?{}:r);t&&(r[t]||(r[t]=[])).push(Object.keys(i).length?i:n)}return n};return o(r(t))}function l(t){let e=t.path||t.composedPath&&t.composedPath();if(e)return e;let o=t.target.parentElement;for(e=[t.target,o];o=o.parentElement;)e.push(o);return e.push(document,window),e}function c(t){return t instanceof Element?t:"string"==typeof t?t.split(/>>/g).reduce(((t,e,o,n)=>(t=t.querySelector(e),o<n.length-1?t.shadowRoot:t)),document):null}function p(t,e=(t=>t)){function o(o){const n=[.001,.01,.1][Number(o.shiftKey||2*o.ctrlKey)]*(o.deltaY<0?1:-1);let i=0,s=t.selectionStart;t.value=t.value.replace(/[\d.]+/g,((t,o)=>o<=s&&o+t.length>=s?(s=o,e(Number(t),n,i)):(i++,t))),t.focus(),t.setSelectionRange(s,s),o.preventDefault(),t.dispatchEvent(new Event("input"))}i(t,"focus",(()=>i(window,"wheel",o,{passive:!1}))),i(t,"blur",(()=>s(window,"wheel",o)))}const{min:u,max:h,floor:d,round:m}=Math;function f(t,e,o){e/=100,o/=100;const n=d(t=t/360*6),i=t-n,s=o*(1-e),r=o*(1-i*e),a=o*(1-(1-i)*e),l=n%6;return[255*[o,r,s,s,a,o][l],255*[a,o,o,r,s,s][l],255*[s,s,a,o,o,r][l]]}function v(t,e,o){const n=(2-(e/=100))*(o/=100)/2;return 0!==n&&(e=1===n?0:n<.5?e*o/(2*n):e*o/(2-2*n)),[t,100*e,100*n]}function b(t,e,o){const n=u(t/=255,e/=255,o/=255),i=h(t,e,o),s=i-n;let r,a;if(0===s)r=a=0;else{a=s/i;const n=((i-t)/6+s/2)/s,l=((i-e)/6+s/2)/s,c=((i-o)/6+s/2)/s;t===i?r=c-l:e===i?r=1/3+n-c:o===i&&(r=2/3+l-n),r<0?r+=1:r>1&&(r-=1)}return[360*r,100*a,100*i]}function y(t,e,o,n){e/=100,o/=100;return[...b(255*(1-u(1,(t/=100)*(1-(n/=100))+n)),255*(1-u(1,e*(1-n)+n)),255*(1-u(1,o*(1-n)+n)))]}function g(t,e,o){e/=100;const n=2*(e*=(o/=100)<.5?o:1-o)/(o+e)*100,i=100*(o+e);return[t,isNaN(n)?0:n,i]}function _(t){return b(...t.match(/.{2}/g).map((t=>parseInt(t,16))))}function w(t){t=t.match(/^[a-zA-Z]+$/)?function(t){if("black"===t.toLowerCase())return"#000";const e=document.createElement("canvas").getContext("2d");return e.fillStyle=t,"#000"===e.fillStyle?null:e.fillStyle}(t):t;const e={cmyk:/^cmyk\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)/i,rgba:/^rgba?\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D*?(([\d.]+)(%?)|$)/i,hsla:/^hsla?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hsva:/^hsva?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},o=t=>t.map((t=>/^(|\d+)\.\d+|\d+$/.test(t)?Number(t):void 0));let n;t:for(const i in e)if(n=e[i].exec(t))switch(i){case"cmyk":{const[,t,e,s,r]=o(n);if(t>100||e>100||s>100||r>100)break t;return{values:y(t,e,s,r),type:i}}case"rgba":{let[,t,,e,,s,,,r]=o(n);if(t="%"===n[2]?t/100*255:t,e="%"===n[4]?e/100*255:e,s="%"===n[6]?s/100*255:s,r="%"===n[9]?r/100:r,t>255||e>255||s>255||r<0||r>1)break t;return{values:[...b(t,e,s),r],a:r,type:i}}case"hexa":{let[,t]=n;4!==t.length&&3!==t.length||(t=t.split("").map((t=>t+t)).join(""));const e=t.substring(0,6);let o=t.substring(6);return o=o?parseInt(o,16)/255:void 0,{values:[..._(e),o],a:o,type:i}}case"hsla":{let[,t,e,s,,r]=o(n);if(r="%"===n[6]?r/100:r,t>360||e>100||s>100||r<0||r>1)break t;return{values:[...g(t,e,s),r],a:r,type:i}}case"hsva":{let[,t,e,s,,r]=o(n);if(r="%"===n[6]?r/100:r,t>360||e>100||s>100||r<0||r>1)break t;return{values:[t,e,s,r],a:r,type:i}}}return{values:null,type:null}}function A(t=0,e=0,o=0,n=1){const i=(t,e)=>(o=-1)=>e(~o?t.map((t=>Number(t.toFixed(o)))):t),s={h:t,s:e,v:o,a:n,toHSVA(){const t=[s.h,s.s,s.v,s.a];return t.toString=i(t,(t=>`hsva(${t[0]}, ${t[1]}%, ${t[2]}%, ${s.a})`)),t},toHSLA(){const t=[...v(s.h,s.s,s.v),s.a];return t.toString=i(t,(t=>`hsla(${t[0]}, ${t[1]}%, ${t[2]}%, ${s.a})`)),t},toRGBA(){const t=[...f(s.h,s.s,s.v),s.a];return t.toString=i(t,(t=>`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${s.a})`)),t},toCMYK(){const t=function(t,e,o){const n=f(t,e,o),i=n[0]/255,s=n[1]/255,r=n[2]/255,a=u(1-i,1-s,1-r);return[100*(1===a?0:(1-i-a)/(1-a)),100*(1===a?0:(1-s-a)/(1-a)),100*(1===a?0:(1-r-a)/(1-a)),100*a]}(s.h,s.s,s.v);return t.toString=i(t,(t=>`cmyk(${t[0]}%, ${t[1]}%, ${t[2]}%, ${t[3]}%)`)),t},toHEXA(){const t=function(t,e,o){return f(t,e,o).map((t=>m(t).toString(16).padStart(2,"0")))}(s.h,s.s,s.v),e=s.a>=1?"":Number((255*s.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return e&&t.push(e),t.toString=()=>`#${t.join("").toUpperCase()}`,t},clone:()=>A(s.h,s.s,s.v,s.a)};return s}const $=t=>Math.max(Math.min(t,1),0);function C(t){const e={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},t),_keyboard(t){const{options:o}=e,{type:n,key:i}=t;if(document.activeElement===o.wrapper){const{lock:o}=e.options,s="ArrowUp"===i,r="ArrowRight"===i,a="ArrowDown"===i,l="ArrowLeft"===i;if("keydown"===n&&(s||r||a||l)){let n=0,i=0;"v"===o?n=s||r?1:-1:"h"===o?n=s||r?-1:1:(i=s?-1:a?1:0,n=l?-1:r?1:0),e.update($(e.cache.x+.01*n),$(e.cache.y+.01*i)),t.preventDefault()}else i.startsWith("Arrow")&&(e.options.onstop(),t.preventDefault())}},_tapstart(t){i(document,["mouseup","touchend","touchcancel"],e._tapstop),i(document,["mousemove","touchmove"],e._tapmove),t.cancelable&&t.preventDefault(),e._tapmove(t)},_tapmove(t){const{options:o,cache:n}=e,{lock:i,element:s,wrapper:r}=o,a=r.getBoundingClientRect();let l=0,c=0;if(t){const e=t&&t.touches&&t.touches[0];l=t?(e||t).clientX:0,c=t?(e||t).clientY:0,l<a.left?l=a.left:l>a.left+a.width&&(l=a.left+a.width),c<a.top?c=a.top:c>a.top+a.height&&(c=a.top+a.height),l-=a.left,c-=a.top}else n&&(l=n.x*a.width,c=n.y*a.height);"h"!==i&&(s.style.left=`calc(${l/a.width*100}% - ${s.offsetWidth/2}px)`),"v"!==i&&(s.style.top=`calc(${c/a.height*100}% - ${s.offsetHeight/2}px)`),e.cache={x:l/a.width,y:c/a.height};const p=$(l/a.width),u=$(c/a.height);switch(i){case"v":return o.onchange(p);case"h":return o.onchange(u);default:return o.onchange(p,u)}},_tapstop(){e.options.onstop(),s(document,["mouseup","touchend","touchcancel"],e._tapstop),s(document,["mousemove","touchmove"],e._tapmove)},trigger(){e._tapmove()},update(t=0,o=0){const{left:n,top:i,width:s,height:r}=e.options.wrapper.getBoundingClientRect();"h"===e.options.lock&&(o=t),e._tapmove({clientX:n+s*t,clientY:i+r*o})},destroy(){const{options:t,_tapstart:o,_keyboard:n}=e;s(document,["keydown","keyup"],n),s([t.wrapper,t.element],"mousedown",o),s([t.wrapper,t.element],"touchstart",o,{passive:!1})}},{options:o,_tapstart:n,_keyboard:r}=e;return i([o.wrapper,o.element],"mousedown",n),i([o.wrapper,o.element],"touchstart",n,{passive:!1}),i(document,["keydown","keyup"],r),e}function k(t={}){t=Object.assign({onchange:()=>0,className:"",elements:[]},t);const e=i(t.elements,"click",(e=>{t.elements.forEach((o=>o.classList[e.target===o?"add":"remove"](t.className))),t.onchange(e),e.stopPropagation()}));return{destroy:()=>s(...e)}}const S={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},O=(t,e,o)=>{const n="object"!=typeof t||t instanceof HTMLElement?{reference:t,popper:e,...o}:t;return{update(t=n){const{reference:e,popper:o}=Object.assign(n,t);if(!o||!e)throw new Error("Popper- or reference-element missing.");return((t,e,o)=>{const{container:n,arrow:i,margin:s,padding:r,position:a,variantFlipOrder:l,positionFlipOrder:c}={container:document.documentElement.getBoundingClientRect(),...S,...o},{left:p,top:u}=e.style;e.style.left="0",e.style.top="0";const h=t.getBoundingClientRect(),d=e.getBoundingClientRect(),m={t:h.top-d.height-s,b:h.bottom+s,r:h.right+s,l:h.left-d.width-s},f={vs:h.left,vm:h.left+h.width/2-d.width/2,ve:h.left+h.width-d.width,hs:h.top,hm:h.bottom-h.height/2-d.height/2,he:h.bottom-d.height},[v,b="middle"]=a.split("-"),y=c[v],g=l[b],{top:_,left:w,bottom:A,right:$}=n;for(const t of y){const o="t"===t||"b"===t;let n=m[t];const[s,a]=o?["top","left"]:["left","top"],[l,c]=o?[d.height,d.width]:[d.width,d.height],[p,u]=o?[A,$]:[$,A],[v,b]=o?[_,w]:[w,_];if(!(n<v||n+l+r>p))for(const p of g){let m=f[(o?"v":"h")+p];if(!(m<b||m+c+r>u)){if(m-=d[a],n-=d[s],e.style[a]=`${m}px`,e.style[s]=`${n}px`,i){const t=o?h.width/2:h.height/2,e=2*t<c?h[a]+t:m+c/2;n<h[s]&&(n+=l),i.style[a]=`${e}px`,i.style[s]=`${n}px`}return t+p}}}return e.style.left=p,e.style.top=u,null})(e,o,n)}}};class E{static utils=o;static version="1.9.0";static I18N_DEFAULTS={"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"};static DEFAULT_OPTIONS={appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"};_initializingActive=!0;_recalc=!0;_nanopop=null;_root=null;_color=A();_lastColor=A();_swatchColors=[];_setupAnimationFrame=null;_eventListener={init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]};constructor(t){this.options=t=Object.assign({...E.DEFAULT_OPTIONS},t);const{swatches:e,components:o,theme:n,sliders:i,lockOpacity:s,padding:r}=t;["nano","monolith"].includes(n)&&!i&&(t.sliders="h"),o.interaction||(o.interaction={});const{preview:a,opacity:l,hue:c,palette:p}=o;o.opacity=!s&&l,o.palette=p||a||l||c,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),e&&e.length&&e.forEach((t=>this.addSwatch(t)));const{button:u,app:h}=this._root;this._nanopop=O(u,h,{margin:r}),u.setAttribute("role","button"),u.setAttribute("aria-label",this._t("btn:toggle"));const d=this;this._setupAnimationFrame=requestAnimationFrame((function e(){if(!h.offsetWidth)return requestAnimationFrame(e);d.setColor(t.default),d._rePositioningPicker(),t.defaultRepresentation&&(d._representation=t.defaultRepresentation,d.setColorRepresentation(d._representation)),t.showAlways&&d.show(),d._initializingActive=!1,d._emit("init")}))}static create=t=>new E(t);_preBuild(){const{options:t}=this;for(const e of["el","container"])t[e]=c(t[e]);this._root=(t=>{const{components:e,useAsButton:o,inline:n,appClass:i,theme:s,lockOpacity:r}=t.options,l=t=>t?"":'style="display:none" hidden',c=e=>t._t(e),p=a(`\n      <div :ref="root" class="pickr">\n\n        ${o?"":'<button type="button" :ref="button" class="pcr-button"></button>'}\n\n        <div :ref="app" class="pcr-app ${i||""}" data-theme="${s}" ${n?'style="position: unset"':""} aria-label="${c("ui:dialog")}" role="window">\n          <div class="pcr-selection" ${l(e.palette)}>\n            <div :obj="preview" class="pcr-color-preview" ${l(e.preview)}>\n              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${c("btn:last-color")}"></button>\n              <div :ref="currentColor" class="pcr-current-color"></div>\n            </div>\n\n            <div :obj="palette" class="pcr-color-palette">\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${c("aria:palette")}" role="listbox"></div>\n            </div>\n\n            <div :obj="hue" class="pcr-color-chooser" ${l(e.hue)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${c("aria:hue")}" role="slider"></div>\n            </div>\n\n            <div :obj="opacity" class="pcr-color-opacity" ${l(e.opacity)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${c("aria:opacity")}" role="slider"></div>\n            </div>\n          </div>\n\n          <div class="pcr-swatches ${e.palette?"":"pcr-last"}" :ref="swatches"></div>\n\n          <div :obj="interaction" class="pcr-interaction" ${l(Object.keys(e.interaction).length)}>\n            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${l(e.interaction.input)} aria-label="${c("aria:input")}">\n\n            <input :arr="options" class="pcr-type" data-type="HEXA" value="${r?"HEX":"HEXA"}" type="button" ${l(e.interaction.hex)}>\n            <input :arr="options" class="pcr-type" data-type="RGBA" value="${r?"RGB":"RGBA"}" type="button" ${l(e.interaction.rgba)}>\n            <input :arr="options" class="pcr-type" data-type="HSLA" value="${r?"HSL":"HSLA"}" type="button" ${l(e.interaction.hsla)}>\n            <input :arr="options" class="pcr-type" data-type="HSVA" value="${r?"HSV":"HSVA"}" type="button" ${l(e.interaction.hsva)}>\n            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${l(e.interaction.cmyk)}>\n\n            <input :ref="save" class="pcr-save" value="${c("btn:save")}" type="button" ${l(e.interaction.save)} aria-label="${c("aria:btn:save")}">\n            <input :ref="cancel" class="pcr-cancel" value="${c("btn:cancel")}" type="button" ${l(e.interaction.cancel)} aria-label="${c("aria:btn:cancel")}">\n            <input :ref="clear" class="pcr-clear" value="${c("btn:clear")}" type="button" ${l(e.interaction.clear)} aria-label="${c("aria:btn:clear")}">\n          </div>\n        </div>\n      </div>\n    `),u=p.interaction;return u.options.find((t=>!t.hidden&&!t.classList.add("active"))),u.type=()=>u.options.find((t=>t.classList.contains("active"))),p})(this),t.useAsButton&&(this._root.button=t.el),t.container.appendChild(this._root.root)}_finalBuild(){const t=this.options,e=this._root;if(t.container.removeChild(e.root),t.inline){const o=t.el.parentElement;t.el.nextSibling?o.insertBefore(e.app,t.el.nextSibling):o.appendChild(e.app)}else t.container.appendChild(e.app);t.useAsButton?t.inline&&t.el.remove():t.el.parentNode.replaceChild(e.root,t.el),t.disabled&&this.disable(),t.comparison||(e.button.style.transition="none",t.useAsButton||(e.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const t=this,e=this.options.components,o=(t.options.sliders||"v").repeat(2),[n,i]=o.match(/^[vh]+$/g)?o:[],s=()=>this._color||(this._color=this._lastColor.clone()),r={palette:C({element:t._root.palette.picker,wrapper:t._root.palette.palette,onstop:()=>t._emit("changestop","slider",t),onchange(o,n){if(!e.palette)return;const i=s(),{_root:r,options:a}=t,{lastColor:l,currentColor:c}=r.preview;t._recalc&&(i.s=100*o,i.v=100-100*n,i.v<0&&(i.v=0),t._updateOutput("slider"));const p=i.toRGBA().toString(0);this.element.style.background=p,this.wrapper.style.background=`\n                        linear-gradient(to top, rgba(0, 0, 0, ${i.a}), transparent),\n                        linear-gradient(to left, hsla(${i.h}, 100%, 50%, ${i.a}), rgba(255, 255, 255, ${i.a}))\n                    `,a.comparison?a.useAsButton||t._lastColor||l.style.setProperty("--pcr-color",p):(r.button.style.setProperty("--pcr-color",p),r.button.classList.remove("clear"));const u=i.toHEXA().toString();for(const{el:e,color:o}of t._swatchColors)e.classList[u===o.toHEXA().toString()?"add":"remove"]("pcr-active");c.style.setProperty("--pcr-color",p)}}),hue:C({lock:"v"===i?"h":"v",element:t._root.hue.picker,wrapper:t._root.hue.slider,onstop:()=>t._emit("changestop","slider",t),onchange(o){if(!e.hue||!e.palette)return;const n=s();t._recalc&&(n.h=360*o),this.element.style.backgroundColor=`hsl(${n.h}, 100%, 50%)`,r.palette.trigger()}}),opacity:C({lock:"v"===n?"h":"v",element:t._root.opacity.picker,wrapper:t._root.opacity.slider,onstop:()=>t._emit("changestop","slider",t),onchange(o){if(!e.opacity||!e.palette)return;const n=s();t._recalc&&(n.a=Math.round(100*o)/100),this.element.style.background=`rgba(0, 0, 0, ${n.a})`,r.palette.trigger()}}),selectable:k({elements:t._root.interaction.options,className:"active",onchange(e){t._representation=e.target.getAttribute("data-type").toUpperCase(),t._recalc&&t._updateOutput("swatch")}})};this._components=r}_bindEvents(){const{_root:t,options:e}=this,o=[i(t.interaction.clear,"click",(()=>this._clearColor())),i([t.interaction.cancel,t.preview.lastColor],"click",(()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")})),i(t.interaction.save,"click",(()=>{!this.applyColor()&&!e.showAlways&&this.hide()})),i(t.interaction.result,["keyup","input"],(t=>{this.setColor(t.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),t.stopImmediatePropagation()})),i(t.interaction.result,["focus","blur"],(t=>{this._recalc="blur"===t.type,this._recalc&&this._updateOutput(null)})),i([t.palette.palette,t.palette.picker,t.hue.slider,t.hue.picker,t.opacity.slider,t.opacity.picker],["mousedown","touchstart"],(()=>this._recalc=!0),{passive:!0})];if(!e.showAlways){const n=e.closeWithKey;o.push(i(t.button,"click",(()=>this.isOpen()?this.hide():this.show())),i(document,"keyup",(t=>this.isOpen()&&(t.key===n||t.code===n)&&this.hide())),i(document,["touchstart","mousedown"],(e=>{this.isOpen()&&!l(e).some((e=>e===t.app||e===t.button))&&this.hide()}),{capture:!0}))}if(e.adjustableNumbers){const e={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};p(t.interaction.result,((t,o,n)=>{const i=e[this.getColorRepresentation().toLowerCase()];if(i){const e=i[n],s=t+(e>=100?1e3*o:o);return s<=0?0:Number((s<e?s:e).toPrecision(3))}return t}))}if(e.autoReposition&&!e.inline){let t=null;const n=this;o.push(i(window,["scroll","resize"],(()=>{n.isOpen()&&(e.closeOnScroll&&n.hide(),null===t?(t=setTimeout((()=>t=null),100),requestAnimationFrame((function e(){n._rePositioningPicker(),null!==t&&requestAnimationFrame(e)}))):(clearTimeout(t),t=setTimeout((()=>t=null),100)))}),{capture:!0}))}this._eventBindings=o}_rePositioningPicker(){const{options:t}=this;if(!t.inline){if(!this._nanopop.update({container:document.body.getBoundingClientRect(),position:t.position})){const t=this._root.app,e=t.getBoundingClientRect();t.style.top=(window.innerHeight-e.height)/2+"px",t.style.left=(window.innerWidth-e.width)/2+"px"}}}_updateOutput(t){const{_root:e,_color:o,options:n}=this;if(e.interaction.type()){const t=`to${e.interaction.type().getAttribute("data-type")}`;e.interaction.result.value="function"==typeof o[t]?o[t]().toString(n.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",o,t,this)}_clearColor(t=!1){const{_root:e,options:o}=this;o.useAsButton||e.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),e.button.classList.add("clear"),o.showAlways||this.hide(),this._lastColor=null,this._initializingActive||t||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(t){const{values:e,type:o,a:n}=w(t),{lockOpacity:i}=this.options,s=void 0!==n&&1!==n;return e&&3===e.length&&(e[3]=void 0),{values:!e||i&&s?null:e,type:o}}_t(t){return this.options.i18n[t]||E.I18N_DEFAULTS[t]}_emit(t,...e){this._eventListener[t].forEach((t=>t(...e,this)))}on(t,e){return this._eventListener[t].push(e),this}off(t,e){const o=this._eventListener[t]||[],n=o.indexOf(e);return~n&&o.splice(n,1),this}addSwatch(t){const{values:e}=this._parseLocalColor(t);if(e){const{_swatchColors:t,_root:o}=this,n=A(...e),s=r(`<button type="button" style="--pcr-color: ${n.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return o.swatches.appendChild(s),t.push({el:s,color:n}),this._eventBindings.push(i(s,"click",(()=>{this.setHSVA(...n.toHSVA(),!0),this._emit("swatchselect",n),this._emit("change",n,"swatch",this)}))),!0}return!1}removeSwatch(t){const e=this._swatchColors[t];if(e){const{el:o}=e;return this._root.swatches.removeChild(o),this._swatchColors.splice(t,1),!0}return!1}applyColor(t=!1){const{preview:e,button:o}=this._root,n=this._color.toRGBA().toString(0);return e.lastColor.style.setProperty("--pcr-color",n),this.options.useAsButton||o.style.setProperty("--pcr-color",n),o.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||t||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach((t=>s(...t))),Object.keys(this._components).forEach((t=>this._components[t].destroy()))}destroyAndRemove(){this.destroy();const{root:t,app:e}=this._root;t.parentElement&&t.parentElement.removeChild(t),e.parentElement.removeChild(e),Object.keys(this).forEach((t=>this[t]=null))}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(t=360,e=0,o=0,n=1,i=!1){const s=this._recalc;if(this._recalc=!1,t<0||t>360||e<0||e>100||o<0||o>100||n<0||n>1)return!1;this._color=A(t,e,o,n);const{hue:r,opacity:a,palette:l}=this._components;return r.update(t/360),a.update(n),l.update(e/100,1-o/100),i||this.applyColor(),s&&this._updateOutput(),this._recalc=s,!0}setColor(t,e=!1){if(null===t)return this._clearColor(e),!0;const{values:o,type:n}=this._parseLocalColor(t);if(o){const t=n.toUpperCase(),{options:i}=this._root.interaction,s=i.find((e=>e.getAttribute("data-type")===t));if(s&&!s.hidden)for(const t of i)t.classList[t===s?"add":"remove"]("active");return!!this.setHSVA(...o,e)&&this.setColorRepresentation(t)}return!1}setColorRepresentation(t){return t=t.toUpperCase(),!!this._root.interaction.options.find((e=>e.getAttribute("data-type").startsWith(t)&&!e.click()))}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}}return e=e.default})()));
//# sourceMappingURL=pickr.min.js.map

/***/ }),

/***/ "./core-bundle/assets/controllers/ace-controller.js":
/*!**********************************************************!*\
  !*** ./core-bundle/assets/controllers/ace-controller.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    type: String,
    readOnly: Boolean
  }))();
  connect() {
    // Create a div to apply the editor to
    this.container = document.createElement('div');
    this.container.id = this.element.id + '_div';
    this.container.className = this.element.className;
    this.element.parentNode.insertBefore(this.container, this.element.nextSibling);

    // Hide the textarea
    this.element.style['display'] = 'none';

    // Instantiate the editor
    this.editor = ace.edit(this.container);
    this.editor.getSession().setValue(this.element.value);
    this.editor.on('focus', () => {
      window.dispatchEvent(new Event('store-scroll-offset'));
    });
    this.editor.getSession().on('change', () => {
      this.element.value = this.editor.getValue();
    });

    // Disable command conflicts with AltGr (see #5792)
    this.editor.commands.bindKey('Ctrl-alt-a|Ctrl-alt-e|Ctrl-alt-h|Ctrl-alt-l|Ctrl-alt-s', null);

    // Execute the config callback
    this.element?.configCallback(this.editor);
    this.setMaxLines();
    window.addEventListener('resize', this.setMaxLines.bind(this));
  }
  disconnect() {
    this.editor.destroy();
    this.container.remove();
  }
  setMaxLines() {
    this.editor.setOption('maxLines', Math.floor((window.innerHeight - 320) / Math.floor(12 * this.editor.container.style.lineHeight)));
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/backend-search-controller.js":
/*!*********************************************************************!*\
  !*** ./core-bundle/assets/controllers/backend-search-controller.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ BackendSearchController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class BackendSearchController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ["input", "results"];
  static values = (() => ({
    route: String,
    minCharacters: {
      type: Number,
      default: 3
    },
    delay: {
      type: Number,
      default: 150
    }
  }))();
  static classes = ["hidden", "initial", "loading", "invalid", "results", "error"];
  connect() {
    this.active = false;
    this.timeout = null;
    this.setState("hidden");
  }
  performSearch() {
    if (this.inputTarget.value.length < this.minCharactersValue) {
      return this.setState("invalid");
    }
    clearTimeout(this.timeout);
    this.timeout = setTimeout(() => {
      this.loadResults();
    }, this.delayValue);
  }
  loadResults() {
    this.setState("loading");
    fetch(this.searchRoute).then(res => {
      if (!res.ok) {
        throw new Error(res.statusText);
      }
      return res.text();
    }).then(html => {
      this.resultsTarget.innerHTML = html;
      this.setState("results");
    }).catch(e => {
      this.setState("error");
    });
  }
  open() {
    if (!this.active) {
      this.setState("initial");
      this.active = true;
    }
  }
  close() {
    this.inputTarget.blur();
    this.inputTarget.value = "";
    this.active = false;
    this.timeout = null;
    this.setState("hidden");
  }
  documentClick(event) {
    if (this.element.contains(event.target)) {
      return;
    }
    this.close();
  }
  setState(state) {
    BackendSearchController.classes.forEach(className => {
      this.element.classList.toggle(this[`${className}Class`], className === state);
    });
  }
  get searchRoute() {
    return this.routeValue + this.inputTarget.value;
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/choices-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/choices-controller.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ ChoicesController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class ChoicesController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  connect() {
    if (this.initGuard) {
      return;
    }

    // Choices wraps the element multiple times during initialization, leading to
    // multiple disconnecs/reconnects of the controller, that we need to ignore.
    this.initGuard = true;
    const select = this.element;
    this.choices = new Choices(select, {
      shouldSort: false,
      duplicateItemsAllowed: false,
      allowHTML: false,
      removeItemButton: true,
      searchEnabled: select.options.length > 7,
      classNames: {
        containerOuter: ['choices', ...Array.from(select.classList)],
        flippedState: ''
      },
      fuseOptions: {
        includeScore: true,
        threshold: 0.4
      },
      callbackOnInit: () => {
        const choices = select.closest('.choices')?.querySelector('.choices__list--dropdown > .choices__list');
        if (choices && select.dataset.placeholder) {
          choices.dataset.placeholder = select.dataset.placeholder;
        }

        // Reset guard as soon as the call stack has cleared
        setTimeout(() => {
          this.initGuard = false;
        }, 0);
      },
      loadingText: Contao.lang.loading,
      noResultsText: Contao.lang.noResults,
      noChoicesText: Contao.lang.noOptions,
      removeItemLabelText: function (value) {
        return Contao.lang.removeItem.concat(' ').concat(value);
      }
    });
  }
  disconnect() {
    if (this.initGuard) {
      return;
    }
    this.choices.destroy();
    this.choices = null;
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/clipboard-controller.js":
/*!****************************************************************!*\
  !*** ./core-bundle/assets/controllers/clipboard-controller.js ***!
  \****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    content: String
  }))();
  write() {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(this.contentValue).catch(this.clipboardFallback.bind(this));
    } else {
      this.clipboardFallback();
    }
  }
  clipboardFallback() {
    const input = document.createElement('input');
    input.value = this.contentValue;
    document.body.appendChild(input);
    input.select();
    input.setSelectionRange(0, 99999);
    document.execCommand('copy');
    document.body.removeChild(input);
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/color-picker-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/color-picker-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _stimulus_components_color_picker__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @stimulus-components/color-picker */ "./node_modules/@stimulus-components/color-picker/dist/stimulus-color-picker.mjs");

/* harmony default export */ __webpack_exports__["default"] = (class extends _stimulus_components_color_picker__WEBPACK_IMPORTED_MODULE_0__["default"] {
  // Override the onSave function to strip the leading `#`
  onSave(color) {
    this.inputTarget.value = null;
    if (color) {
      let value = color.toHEXA().toString();
      if ('#' === value.charAt(0)) {
        value = value.substring(1);
      }
      this.inputTarget.value = value.toLowerCase();
    }
    this.picker.hide();
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/color-scheme-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/color-scheme-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

const prefersDark = () => {
  const prefersDark = localStorage.getItem('contao--prefers-dark');
  if (null === prefersDark) {
    return !!window.matchMedia('(prefers-color-scheme: dark)').matches;
  }
  return prefersDark === 'true';
};
const setColorScheme = () => {
  document.documentElement.dataset.colorScheme = prefersDark() ? 'dark' : 'light';
};
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setColorScheme);
setColorScheme();
/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['label'];
  static values = (() => ({
    i18n: {
      type: Object,
      default: {
        light: 'Disable dark mode',
        dark: 'Enable dark mode'
      }
    }
  }))();
  initialize() {
    this.toggle = this.toggle.bind(this);
    this.setLabel = this.setLabel.bind(this);
  }
  connect() {
    this.element.addEventListener('click', this.toggle);
    this.matchMedia = window.matchMedia('(prefers-color-scheme: dark)');
    this.matchMedia.addEventListener('change', this.setLabel);
    this.setLabel();
  }
  disconnect() {
    this.element.removeEventListener('click', this.toggle);
    this.matchMedia.removeEventListener('change', this.setLabel);
  }
  toggle(e) {
    e.preventDefault();
    const isDark = !prefersDark();
    if (isDark === this.matchMedia.matches) {
      localStorage.removeItem('contao--prefers-dark');
    } else {
      localStorage.setItem('contao--prefers-dark', String(isDark));
    }
    setColorScheme();
    this.dispatch('change', {
      detail: {
        mode: isDark ? 'dark' : 'light'
      }
    });

    // Change the label after the dropdown is hidden
    setTimeout(this.setLabel, 300);
  }
  setLabel() {
    if (!this.hasLabelTarget) {
      return;
    }
    const label = this.i18nValue[prefersDark() ? 'light' : 'dark'];
    this.labelTarget.title = label;
    this.labelTarget.innerText = label;
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/deeplink-controller.js":
/*!***************************************************************!*\
  !*** ./core-bundle/assets/controllers/deeplink-controller.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hotwired/turbo */ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js");


/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['primary', 'secondary'];
  static afterLoad(identifier) {
    const setupController = () => {
      document.querySelectorAll('.click2edit').forEach(el => {
        el.classList.remove('click2edit');
        const primary = el.querySelector('a.edit');
        const secondary = el.querySelector('a.children');
        if (primary) {
          primary.setAttribute(`data-${identifier}-target`, "primary");
        }
        if (secondary) {
          secondary.setAttribute(`data-${identifier}-target`, "secondary");
        }
        el.dataset.controller = `${el.dataset.controller || ''} ${identifier}`;
      });
    };
    document.addEventListener('DOMContentLoaded', setupController);
    document.addEventListener('ajax_change', setupController);
    document.addEventListener('turbo:render', setupController);
    document.addEventListener('turbo:frame-render', setupController);
    setupController();
    Theme.setupCtrlClick = () => {
      console.warn('Using Theme.setupCtrlClick() is deprecated and will be removed in Contao 6. Apply the Stimulus actions instead.');
      setupController();
    };
  }
  initialize() {
    this.handle = this.handle.bind(this);
  }
  connect() {
    this.element.addEventListener('click', this.handle);
  }
  disconnect() {
    this.element.removeEventListener('click', this.handle);
  }
  handle(event) {
    // Ignore clicks on anchor elements
    if (!this.isValid(event.target)) {
      return;
    }
    const primaryKey = window.navigator.platform?.startsWith('Mac') ? 'metaKey' : 'ctrlKey';
    if (event[primaryKey] && !event.shiftKey && this.hasPrimaryTarget && this.primaryTarget.href) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.primaryTarget.href);
      return;
    }
    if (event[primaryKey] && event.shiftKey && this.hasSecondaryTarget && this.secondaryTarget.href) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.secondaryTarget.href);
      return;
    }
    if (event.pointerType === 'mouse' || !this.hasPrimaryTarget || !this.primaryTarget.href) {
      return;
    }
    clearTimeout(this.$timer);
    if (!this.element.getAttribute('data-visited')) {
      this.element.setAttribute('data-visited', '1');
      this.$timer = setTimeout(() => {
        this.element.removeAttribute('data-visited');
      }, 2000);
    } else {
      this.element.removeAttribute('data-visited');
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.primaryTarget.href);
    }
  }
  visitPrimary(event) {
    if (this.hasPrimaryTarget && this.primaryTarget.href && this.isValid(event.target)) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.primaryTarget.href);
    }
  }
  visitSecondary(event) {
    if (this.hasSecondaryTarget && this.secondaryTarget.href && this.isValid(event.target)) {
      _hotwired_turbo__WEBPACK_IMPORTED_MODULE_1__.visit(this.secondaryTarget.href);
    }
  }
  isValid(element) {
    return 'a' !== element.tagName && !element.closest('a, button');
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/image-size-controller.js":
/*!*****************************************************************!*\
  !*** ./core-bundle/assets/controllers/image-size-controller.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    config: Object
  }))();
  initialize() {
    this.updateWizard = this.updateWizard.bind(this);
    this.openModal = this.openModal.bind(this);
  }
  connect() {
    this.select = this.element.querySelector('select');
    this.button = document.createElement('button');
    this.button.type = 'button';
    this.button.title = '';
    this.buttonImage = document.createElement('img');
    this.button.append(this.buttonImage);
    this.element.parentNode.classList.add('wizard');
    this.element.after(this.button);
    this.select.addEventListener('change', this.updateWizard);
    this.button.addEventListener('click', this.openModal);
    this.updateWizard();
  }
  disconnect() {
    this.element.parentNode.classList.remove('wizard');
    this.select.removeEventListener('change', this.updateWizard);
    this.buttonImage.remove();
    this.button.remove();
  }
  updateWizard() {
    if (this.canEdit()) {
      this.button.title = this.configValue.title;
      this.button.disabled = false;
      this.buttonImage.src = this.configValue.icon;
    } else {
      this.button.title = '';
      this.button.disabled = true;
      this.buttonImage.src = this.configValue.iconDisabled;
    }
  }
  openModal() {
    Backend.openModalIframe({
      title: this.configValue.title,
      url: `${this.configValue.href}&id=${this.select.value}`
    });
  }
  canEdit() {
    return this.configValue.ids.includes(Number(this.select.value));
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/jump-targets-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/jump-targets-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['navigation', 'section'];
  connect() {
    this.rebuildNavigation();
    this.connected = true;
  }
  sectionTargetConnected() {
    if (!this.connected) {
      return;
    }
    this.rebuildNavigation();
  }
  rebuildNavigation() {
    if (!this.hasNavigationTarget) {
      return;
    }
    const links = document.createElement('ul');
    this.sectionTargets.forEach(el => {
      const action = document.createElement('button');
      action.innerText = el.getAttribute(`data-${this.identifier}-label-value`);
      action.addEventListener('click', event => {
        event.preventDefault();
        this.dispatch('scrollto', {
          target: el
        });
        el.scrollIntoView();
      });
      const li = document.createElement('li');
      li.append(action);
      links.append(li);
    });
    this.navigationTarget.replaceChildren(links);
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/limit-height-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/limit-height-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    max: Number,
    expand: String,
    collapse: String,
    expandAll: String,
    expandAllTitle: String,
    collapseAll: String,
    collapseAllTitle: String
  }))();
  static targets = ['operation', 'node'];
  initialize() {
    super.initialize();
    this.togglerMap = new WeakMap();
    this.nextId = 1;
  }
  operationTargetConnected() {
    this.updateOperation();
  }
  nodeTargetConnected(node) {
    const style = window.getComputedStyle(node, null);
    const padding = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);
    const height = node.clientHeight - padding;

    // Resize the element if it is higher than the maximum height
    if (this.maxValue > height) {
      return;
    }
    if (!node.id) {
      node.id = `limit-height-${this.nextId++}`;
    }
    node.style.overflow = 'hidden';
    node.style.maxHeight = `${this.maxValue}px`;
    const button = document.createElement('button');
    button.setAttribute('type', 'button');
    button.title = this.expandValue;
    button.innerHTML = '<span>...</span>';
    button.classList.add('unselectable');
    button.setAttribute('aria-expanded', 'false');
    button.setAttribute('aria-controls', node.id);
    button.addEventListener('click', event => {
      event.preventDefault();
      this.toggle(node);
      this.updateOperation(event);
    });
    const toggler = document.createElement('div');
    toggler.classList.add('limit_toggler');
    toggler.append(button);
    this.togglerMap.set(node, toggler);
    node.append(toggler);
    this.updateOperation();
  }
  nodeTargetDisconnected(node) {
    if (!this.togglerMap.has(node)) {
      return;
    }
    this.togglerMap.get(node).remove();
    this.togglerMap.delete(node);
    node.style.overflow = '';
    node.style.maxHeight = '';
  }
  toggle(node) {
    if (node.style.maxHeight === '') {
      this.collapse(node);
    } else {
      this.expand(node);
    }
  }
  expand(node) {
    if (!this.togglerMap.has(node)) {
      return;
    }
    node.style.maxHeight = '';
    const button = this.togglerMap.get(node).querySelector('button');
    button.title = this.collapseValue;
    button.setAttribute('aria-expanded', 'true');
  }
  collapse(node) {
    if (!this.togglerMap.has(node)) {
      return;
    }
    node.style.maxHeight = `${this.maxValue}px`;
    const button = this.togglerMap.get(node).querySelector('button');
    button.title = this.expandValue;
    button.setAttribute('aria-expanded', 'false');
  }
  toggleAll(event) {
    event.preventDefault();
    const isExpanded = this.hasExpanded() ^ event.altKey;
    this.nodeTargets.forEach(node => {
      if (isExpanded) {
        this.collapse(node);
      } else {
        this.expand(node);
      }
    });
    this.updateOperation(event);
  }
  keypress(event) {
    this.updateOperation(event);
  }
  updateOperation(event) {
    if (!this.hasOperationTarget) {
      return;
    }
    const hasTogglers = !!this.nodeTargets.find(el => this.togglerMap.has(el));
    const expanded = this.hasExpanded();
    this.operationTarget.style.display = hasTogglers ? '' : 'none';
    this.operationTarget.setAttribute('aria-controls', this.nodeTargets.map(el => el.id).join(' '));
    this.operationTarget.setAttribute('aria-expanded', expanded ? 'true' : 'false');
    if (expanded ^ (event ? event.altKey : false)) {
      this.operationTarget.innerText = this.collapseAllValue;
      this.operationTarget.title = this.collapseAllTitleValue;
    } else {
      this.operationTarget.innerText = this.expandAllValue;
      this.operationTarget.title = this.expandAllTitleValue;
    }
  }
  hasExpanded() {
    return !!this.nodeTargets.find(el => this.togglerMap.has(el) && el.style.maxHeight === '');
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/metawizard-controller.js":
/*!*****************************************************************!*\
  !*** ./core-bundle/assets/controllers/metawizard-controller.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['input'];
  delete() {
    this.inputTargets.forEach(input => {
      input.value = '';
    });
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/operations-menu-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/operations-menu-controller.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var accessible_menu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! accessible-menu */ "./node_modules/accessible-menu/dist/accessible-menu.es.js");


/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['menu', 'controller'];
  initialize() {
    this.close = this.close.bind(this);
  }
  connect() {
    if (!this.hasMenuTarget) {
      return;
    }
    document.addEventListener('pointerdown', this.close);
    this.controllerTarget?.addEventListener('pointerdown', () => {
      this.setFixedPosition();
    });
    this.$menu = new accessible_menu__WEBPACK_IMPORTED_MODULE_1__["default"].DisclosureMenu({
      menuElement: this.menuTarget,
      containerElement: this.element,
      controllerElement: this.controllerTarget
    });
    this.$menu.dom.controller.addEventListener('accessibleMenuExpand', () => {
      this.element.classList.add('hover');
    });
    this.$menu.dom.controller.addEventListener('accessibleMenuCollapse', () => {
      this.element.classList.remove('hover');
    });
  }
  disconnect() {
    document.removeEventListener('pointerdown', this.close);
  }
  open(event) {
    if (!this.hasMenuTarget || this.isInteractive(event.target)) {
      return;
    }
    event.preventDefault();
    event.stopPropagation();
    this.$menu.elements.controller.preview();
    this.setFixedPosition(event);
  }
  close(event) {
    if (this.$menu && !this.menuTarget.contains(event.target) && !this.controllerTarget?.contains(event.target)) {
      this.$menu.elements.controller.close();
    }
  }
  setFixedPosition(event) {
    const rect = this.menuTarget.getBoundingClientRect();
    let x,
      y,
      offset = 0;
    if (event) {
      x = event.clientX;
      y = event.clientY;
    } else {
      const r = this.controllerTarget.getBoundingClientRect();
      x = r.x;
      y = r.y;
      offset = 20;
    }
    this.menuTarget.style.position = 'fixed';
    this.menuTarget.style.right = 'auto';
    if (window.innerHeight < y + rect.height) {
      this.menuTarget.style.top = `${y - rect.height}px`;
    } else {
      this.menuTarget.style.top = `${y + offset}px`;
    }
    if (window.innerWidth < x + rect.width) {
      this.menuTarget.style.left = `${x - rect.width + offset}px`;
    } else {
      this.menuTarget.style.left = `${x + offset}px`;
    }
  }
  isInteractive(el) {
    let node = el.nodeName.toLowerCase();
    if ('a' === node || 'button' === node) {
      return true;
    }

    // Also check the parent element if el is not interactive
    node = el.parentElement.nodeName.toLowerCase();
    return 'a' === node || 'button' === node;
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/passkeys-controller.js":
/*!***************************************************************!*\
  !*** ./core-bundle/assets/controllers/passkeys-controller.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['form', 'nameInput'];
  nameInputTargetConnected(el) {
    el.focus();
    el.select();
  }
  cancelEdit(e) {
    this.nameInputTarget.value = this.nameInputTarget.getAttribute('value');
    this.formTarget.requestSubmit();
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/profile-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/profile-controller.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['button', 'menu'];
  static values = (() => ({
    name: {
      type: String,
      default: 'tmenu__profile'
    }
  }))();
  buttonTargetConnected(button) {
    button.setAttribute('aria-controls', this.nameValue);
    button.setAttribute('aria-expanded', 'false');
  }
  menuTargetConnected(menu) {
    menu.setAttribute('id', this.nameValue);
  }
  toggle(event) {
    event.stopPropagation();
    this.menuTarget.classList.toggle('active');
    if (this.menuTarget.classList.contains('active')) {
      this.buttonTarget.setAttribute('aria-expanded', 'true');
    } else {
      this.buttonTarget.setAttribute('aria-expanded', 'false');
    }
  }
  close() {
    this.menuTarget.classList.remove('active');
    this.buttonTarget.setAttribute('aria-expanded', 'false');
  }
  documentClick(event) {
    if (this.buttonTarget.contains(event.target)) {
      return;
    }
    this.close();
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/scroll-offset-controller.js":
/*!********************************************************************!*\
  !*** ./core-bundle/assets/controllers/scroll-offset-controller.js ***!
  \********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['scrollTo', 'autoFocus', 'widgetError'];
  static values = (() => ({
    sessionKey: {
      type: String,
      default: 'contao_backend_offset'
    },
    behavior: {
      type: String,
      default: 'instant'
    },
    block: {
      type: String,
      default: 'center'
    }
  }))();

  // Backwards compatibility: automatically register the Stimulus controller if the legacy methods are used
  static afterLoad(identifier, application) {
    const loadFallback = () => {
      return new Promise((resolve, reject) => {
        const controller = application.getControllerForElementAndIdentifier(document.documentElement, identifier);
        if (controller) {
          resolve(controller);
          return;
        }
        const {
          controllerAttribute
        } = application.schema;
        document.documentElement.setAttribute(controllerAttribute, `${document.documentElement.getAttribute(controllerAttribute) || ''} ${identifier}`);
        setTimeout(() => {
          const controller = application.getControllerForElementAndIdentifier(document.documentElement, identifier);
          controller && resolve(controller) || reject(controller);
        }, 100);
      });
    };
    if (window.Backend && !window.Backend.initScrollOffset) {
      window.Backend.initScrollOffset = () => {
        console.warn('Backend.initScrollOffset() is deprecated. Please use the Stimulus controller instead.');
        loadFallback();
      };
    }
    if (window.Backend && !window.Backend.getScrollOffset) {
      window.Backend.getScrollOffset = () => {
        console.warn('Backend.getScrollOffset() is deprecated. Please use the Stimulus controller instead.');
        loadFallback().then(controller => controller.discard());
      };
    }
  }
  initialize() {
    this.store = this.store.bind(this);
  }
  connect() {
    if (!this.offset) return;
    window.scrollTo({
      top: this.offset,
      behavior: this.behaviorValue,
      block: this.blockValue
    });
    this.offset = null;
  }
  scrollToTargetConnected() {
    this.scrollToTarget.scrollIntoView({
      behavior: this.behaviorValue,
      block: this.blockValue
    });
  }
  autoFocusTargetConnected() {
    if (this.offset || this.autoFocus) return;
    const input = this.autoFocusTarget;
    if (input.disabled || input.readonly || !input.offsetWidth || !input.offsetHeight || input.closest('.chzn-search') || input.autocomplete && input.autocomplete !== 'off') {
      return;
    }
    this.autoFocus = true;
    input.focus();
  }
  widgetErrorTargetConnected() {
    this.widgetErrorTarget.scrollIntoView({
      behavior: 'smooth',
      block: 'start'
    });
  }
  store() {
    this.offset = this.element.scrollTop;
  }
  discard() {
    this.offset = null;
  }
  scrollToWidgetError() {
    if (this.hasWidgetErrorTarget) {
      this.widgetErrorTargetConnected();
    }
  }
  get offset() {
    const value = window.sessionStorage.getItem(this.sessionKeyValue);
    return value ? parseInt(value) : null;
  }
  set offset(value) {
    if (value === null || value === undefined) {
      window.sessionStorage.removeItem(this.sessionKeyValue);
    } else {
      window.sessionStorage.setItem(this.sessionKeyValue, String(value));
    }
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/tabs-controller.js":
/*!***********************************************************!*\
  !*** ./core-bundle/assets/controllers/tabs-controller.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ TabsController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class TabsController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    closeLabel: String
  }))();
  static targets = ['navigation', 'panel'];
  static instanceCount = 0;
  instanceId = (() => undefined)();
  lastTabId = 0;
  activeTab = null;
  initialize() {
    TabsController.instanceCount++;
    this.instanceId = TabsController.instanceCount;
  }
  panelTargetConnected(panel) {
    this.lastTabId++;
    const control_reference = `tab-control_${this.instanceId}_${this.lastTabId}`;
    const panel_reference = panel.id || `tab-panel_${this.instanceId}_${this.lastTabId}`;

    // Create navigation elements
    const selectButton = document.createElement('button');
    selectButton.id = control_reference;
    selectButton.className = 'select';
    selectButton.innerText = panel.dataset.label;
    selectButton.setAttribute('type', 'button');
    selectButton.setAttribute('role', 'tab');
    selectButton.setAttribute('aria-controls', panel_reference);
    selectButton.addEventListener('click', () => {
      this.selectTab(panel);
    });
    const closeButton = document.createElement('button');
    closeButton.className = 'close';
    closeButton.innerText = 'x';
    closeButton.setAttribute('type', 'button');
    closeButton.setAttribute('aria-controls', panel_reference);
    closeButton.setAttribute('aria-label', this.closeLabelValue);
    closeButton.addEventListener('click', () => {
      // Remove the panel and let the disconnect handler do the rest
      panel.remove();
    });
    const li = document.createElement('li');
    li.setAttribute('role', 'presentation');
    li.append(selectButton);
    li.append(closeButton);

    // Enhance panel container
    panel.id = panel_reference;
    panel.setAttribute('role', 'tabpanel');
    panel.setAttribute('aria-labelledby', control_reference);

    // Add navigation element and activate the newly added tab
    this.navigationTarget.append(li);
    this.selectTab(panel);
  }
  panelTargetDisconnected(panel) {
    // Remove controls
    const li = document.getElementById(panel.getAttribute('aria-labelledby')).parentElement;
    li.remove();

    // Select the first tab/no tab if the current tab was active before closing.
    if (panel === this.activeTab) {
      if (this.hasPanelTarget) {
        this.selectTab(this.panelTarget);
      } else {
        this.activeTab = null;
      }
    }
  }
  selectTab(panel) {
    this.panelTargets.forEach(el => {
      const isTarget = el === panel;
      el.toggleAttribute('aria-selected', isTarget);
      el.toggleAttribute('data-active', isTarget);
      el.style.display = isTarget ? 'revert' : 'none';

      // Re-enable/disable the button access keys
      if (isTarget) {
        el.querySelectorAll('button[data-disabled-accesskey]').forEach(button => {
          button.setAttribute('accesskey', button.getAttribute('data-disabled-accesskey'));
          button.removeAttribute('data-disabled-accesskey');
        });
      } else {
        el.querySelectorAll('button[accesskey]').forEach(button => {
          button.setAttribute('data-disabled-accesskey', button.getAttribute('accesskey'));
          button.removeAttribute('accesskey');
        });
      }
      const selectButton = document.getElementById(el.getAttribute('aria-labelledby'));
      selectButton?.toggleAttribute('aria-selected', isTarget);
      selectButton?.parentElement.toggleAttribute('data-active', isTarget);
    });
    this.activeTab = panel;
  }
  getActiveTab() {
    return this.activeTab;
  }
  getTabs() {
    return this.panelTargets.reduce((result, panel) => {
      result[panel.id] = panel;
      return result;
    }, {});
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/template-studio-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/template-studio-controller.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _modules_twig_editor__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/twig-editor */ "./core-bundle/assets/modules/twig-editor.js");


/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  editors = (() => new Map())();
  static values = (() => ({
    followUrl: String,
    blockInfoUrl: String
  }))();
  static targets = ['themeSelector', 'tabs', 'editor', 'editorAnnotations', 'dialog'];
  connect() {
    // Subscribe to events dispatched by the editors
    this.element.addEventListener('twig-editor:lens:follow', event => {
      this._visit(this.followUrlValue, {
        name: event.detail.name
      });
    });
    this.element.addEventListener('twig-editor:lens:block-info', event => {
      this._visit(this.blockInfoUrlValue, event.detail);
    });
    this.element.addEventListener('turbo:submit-start', event => {
      // Add the currently open editor tabs to the request when selecting a theme
      if (event.target === this.themeSelectorTarget) {
        this._addOpenEditorTabsToRequest(event);
      }

      // Include the active editor's content when the save operation was triggered
      if (event.detail.formSubmission.submitter?.dataset?.operation === 'save') {
        this._addEditorContentToRequest(event);
        this._getActiveMutableEditor()?.focus();
      }
    });
  }
  close(event) {
    document.getElementById(event.target.getAttribute('aria-controls')).innerText = '';
  }
  editorTargetConnected(el) {
    this.editors.set(el, new _modules_twig_editor__WEBPACK_IMPORTED_MODULE_1__.TwigEditor(el.querySelector('textarea')));
  }
  editorTargetDisconnected(el) {
    this.editors.get(el).destroy();
    this.editors.delete(el);
  }
  editorAnnotationsTargetConnected(el) {
    this.editors.get(el.closest('*[data-contao--template-studio-target="editor"]'))?.setAnnotationsData(JSON.parse(el.innerText));
  }
  dialogTargetConnected(el) {
    el.showModal();
    el.querySelector('input')?.focus();
    el.querySelector('input[type="text"]')?.select();
    el.querySelector('form')?.addEventListener('submit', () => {
      el.remove();
    });
  }
  colorChange(event) {
    this.editors.forEach(editor => {
      editor.setColorScheme(event.detail.mode);
    });
  }
  _addOpenEditorTabsToRequest(event) {
    const searchParams = event.detail.formSubmission.location.searchParams;
    const tabs = this.application.getControllerForElementAndIdentifier(this.tabsTarget, 'contao--tabs').getTabs();
    Object.keys(tabs).forEach(tabId => {
      // Extract identifier from tabId "template-studio--tab_<identifier>"
      searchParams.append('open_tab[]', tabId.substring(21));
    });
  }
  _addEditorContentToRequest(event) {
    event.detail.formSubmission.fetchRequest.body.append('code', this._getActiveMutableEditor()?.getContent() ?? '');
  }
  _getActiveMutableEditor() {
    const editorElementsOnActiveTab = this.application.getControllerForElementAndIdentifier(this.tabsTarget, 'contao--tabs').getActiveTab()?.querySelectorAll('*[data-contao--template-studio-target="editor"]');
    for (const el of editorElementsOnActiveTab ?? []) {
      const editor = this.editors.get(el);
      if (editor && editor.isEditable()) {
        return editor;
      }
    }
    return null;
  }
  async _visit(url, params) {
    if (params !== null) {
      url += '?' + new URLSearchParams(params).toString();
    }
    const response = await fetch(url, {
      method: 'get',
      headers: {
        'Accept': 'text/vnd.turbo-stream.html'
      }
    });
    if (response.redirected) {
      document.location = response.url;
      return;
    }
    if (!response.headers.get('content-type').startsWith('text/vnd.turbo-stream.html') || response.status >= 300) {
      console.error(`There was an error processing the Turbo stream response from "${url}"`);
      return;
    }
    const html = await response.text();
    Turbo.renderStreamMessage(html);
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/tinymce-controller.js":
/*!**************************************************************!*\
  !*** ./core-bundle/assets/controllers/tinymce-controller.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  initialize() {
    Turbo.cache.exemptPageFromCache();
  }
  connect() {
    if (!this.element.tinymceConfig) {
      console.error('No TinyMCE config was attached to the DOM element, expected an expando property called "tinymceConfig".', this.element);
      return;
    }
    const config = this.element.tinymceConfig;
    config.target = this.element;

    // TinyMCE creates the editor ID based on the target element's ID (if set).
    // This leads to a problem if an editor with the same ID is still around,
    // which would be the case if the disconnect event cleaning up the resource
    // has not run yet. We therefore remove the ID and re-add it after
    // initializing the editor.
    const elementId = this.element.id;
    this.element.removeAttribute('id');
    tinymce?.init(config).then(editors => {
      this.editorId = editors[0]?.id;

      // Fire a custom event when the editor finished initializing.
      this.dispatch('editor-loaded', {
        detail: {
          content: editors[0] ?? null
        }
      });
    });
    this.element.setAttribute('id', elementId);
  }
  disconnect() {
    tinymce?.get(this.editorId)?.remove();
  }
  leave(event) {
    const editor = tinymce?.get(this.editorId);
    if (!editor || !editor.plugins.hasOwnProperty('autosave') || editor.isNotDirty) {
      return;
    }

    // Trigger a beforeunload event like when navigating away to capture the TinyMCE autosave message
    const delegate = document.createEvent('BeforeUnloadEvent');
    delegate.initEvent('beforeunload', false, true);
    if (!window.dispatchEvent(delegate) && !confirm(delegate.returnValue)) {
      event.preventDefault();
    }
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-fieldset-controller.js":
/*!**********************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-fieldset-controller.js ***!
  \**********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    id: String,
    table: String
  }))();
  static classes = ['collapsed'];
  static afterLoad(identifier, application) {
    const addController = (el, id, table) => {
      const fs = el.parentNode;
      fs.dataset.controller = `${fs.dataset.controller || ''} ${identifier}`;
      fs.setAttribute(`data-${identifier}-id-value`, id);
      fs.setAttribute(`data-${identifier}-table-value`, table);
      fs.setAttribute(`data-${identifier}-collapsed-class`, 'collapsed');
      el.setAttribute('tabindex', 0);
      el.setAttribute('data-action', `click->${identifier}#toggle keydown.enter->${identifier}#toggle keydown.space->${identifier}#prevent:prevent keyup.space->${identifier}#toggle:prevent`);
    };
    const migrateLegacy = () => {
      document.querySelectorAll('legend[data-toggle-fieldset]').forEach(function (el) {
        if (window.console) {
          console.warn(`Using the "data-toggle-fieldset" attribute on fieldset legends is deprecated and will be removed in Contao 6. Apply the "${identifier}" Stimulus controller instead.`);
        }
        const {
          id,
          table
        } = JSON.parse(el.getAttribute('data-toggle-fieldset'));
        addController(el, id, table);
      });
      AjaxRequest.toggleFieldset = (el, id, table) => {
        const fs = el.parentNode;

        // Already clicked, Stimulus controller was added dynamically
        if (application.getControllerForElementAndIdentifier(fs, identifier)) {
          return;
        }
        if (window.console) {
          console.warn('Using AjaxRequest.toggleFieldset() is deprecated and will be removed in Contao 6. Apply the Stimulus actions instead.');
        }
        addController(el, id, table);

        // Optimistically wait until Stimulus has registered the new controller
        setTimeout(() => {
          application.getControllerForElementAndIdentifier(fs, identifier).toggle();
        }, 100);
      };
    };

    // Called as soon as registered, so DOM may not have been loaded yet
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", migrateLegacy);
    } else {
      migrateLegacy();
    }
  }
  connect() {
    if (this.element.querySelectorAll('label.error, label.mandatory').length) {
      this.element.classList.remove(this.collapsedClass);
    } else if (this.element.classList.contains('hide')) {
      if (window.console) {
        console.warn(`Using class "hide" on a fieldset is deprecated and will be removed in Contao 6. Use class "${this.collapsedClass}" instead.`);
      }
      this.element.classList.add(this.collapsedClass);
    }
    if (this.element.classList.contains(this.collapsedClass)) {
      this.setAriaExpanded(false);
    } else {
      this.setAriaExpanded(true);
    }
  }
  toggle() {
    if (this.element.classList.contains(this.collapsedClass)) {
      this.open();
      this.setAriaExpanded(true);
    } else {
      this.close();
      this.setAriaExpanded(false);
    }
  }
  open() {
    if (!this.element.classList.contains(this.collapsedClass)) {
      return;
    }
    this.element.classList.remove(this.collapsedClass);
    this.storeState(1);
  }
  close() {
    if (this.element.classList.contains(this.collapsedClass)) {
      return;
    }
    const form = this.element.closest('form');
    const input = this.element.querySelectorAll('[required]');
    let collapse = true;
    for (let i = 0; i < input.length; i++) {
      if (!input[i].value) {
        collapse = false;
        break;
      }
    }
    if (!collapse) {
      if (typeof form.checkValidity == 'function') {
        form.querySelector('button[type="submit"]').click();
      }
    } else {
      this.element.classList.add(this.collapsedClass);
      this.storeState(0);
    }
  }
  storeState(state) {
    if (!this.hasIdValue || !this.hasTableValue) {
      return;
    }
    fetch(window.location.href, {
      method: 'POST',
      headers: {
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        action: 'toggleFieldset',
        id: this.idValue,
        table: this.tableValue,
        state: state
      })
    });
  }
  setAriaExpanded(state) {
    const button = this.element.querySelector('button');
    if (button) {
      button.ariaExpanded = state;
    }
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-navigation-controller.js":
/*!************************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-navigation-controller.js ***!
  \************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static classes = ['collapsed'];
  static values = (() => ({
    url: String,
    requestToken: String,
    expandTitle: String,
    collapseTitle: String
  }))();
  toggle(_ref) {
    let {
      currentTarget,
      params: {
        category
      }
    } = _ref;
    const el = currentTarget.parentNode;
    const collapsed = el.classList.toggle(this.collapsedClass);
    currentTarget.setAttribute('aria-expanded', collapsed ? 'false' : 'true');
    currentTarget.setAttribute('title', collapsed ? this.expandTitleValue : this.collapseTitleValue);
    this.sendRequest(category, collapsed);
  }
  sendRequest(category, collapsed) {
    fetch(this.urlValue, {
      method: 'POST',
      headers: {
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        action: 'toggleNavigation',
        id: category,
        state: collapsed ? 0 : 1,
        REQUEST_TOKEN: this.requestTokenValue
      })
    });
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/toggle-nodes-controller.js":
/*!*******************************************************************!*\
  !*** ./core-bundle/assets/controllers/toggle-nodes-controller.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static values = (() => ({
    mode: {
      type: Number,
      default: 5
    },
    toggleAction: String,
    loadAction: String,
    requestToken: String,
    refererId: String,
    expand: String,
    collapse: String,
    expandAll: String,
    expandAllTitle: String,
    collapseAll: String,
    collapseAllTitle: String
  }))();
  static targets = ['operation', 'node', 'toggle', 'child', 'rootChild'];
  operationTargetConnected() {
    this.updateOperation();
  }
  childTargetConnected() {
    this.updateOperation();
  }
  toggle(event) {
    event.preventDefault();
    const el = event.currentTarget;
    el.blur();
    this.toggleToggler(el, event.params.id, event.params.level, event.params.folder);
  }
  toggleToggler(el, id, level, folder) {
    const item = document.id(id);
    if (item && item.style.display === 'none') {
      this.showChild(item);
      this.expandToggler(el);
      this.updateState(el, id, 1);
    } else if (item) {
      this.hideChild(item);
      this.collapseToggler(el);
      this.updateState(el, id, 0);
    } else {
      this.fetchChild(el, id, level, folder);
    }
    this.updateOperation();
  }
  expandToggler(el) {
    el.classList.add('foldable--open');
    if (el.hasAttribute('title')) {
      el.title = this.collapseValue;
    }
    el.getElements('img')?.forEach(image => {
      image.alt = this.collapseValue;
    });
  }
  collapseToggler(el) {
    el.classList.remove('foldable--open');
    if (el.hasAttribute('title')) {
      el.title = this.expandValue;
    }
    el.getElements('img')?.forEach(image => {
      image.alt = this.expandValue;
    });
  }
  loadToggler(el, enabled) {
    el.classList[enabled ? 'add' : 'remove']('foldable--loading');
  }
  showChild(item) {
    item.style.display = '';
  }
  hideChild(item) {
    item.style.display = 'none';
  }
  async fetchChild(el, id, level, folder) {
    this.loadToggler(el, true);
    const url = new URL(location.href);
    const search = url.searchParams;
    search.set('ref', this.refererIdValue);
    url.search = search.toString();
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        'action': this.loadActionValue,
        'id': id,
        'level': level,
        'folder': folder,
        'state': 1,
        'REQUEST_TOKEN': this.requestTokenValue
      })
    });
    if (response.ok) {
      const txt = await response.text();
      const li = document.createElement('li');
      li.id = id;
      li.classList.add('parent');
      li.style.display = 'inline';
      li.setAttribute(`data-${this.identifier}-target`, level === 0 ? 'child rootChild' : 'child');
      const ul = document.createElement('ul');
      ul.classList.add('level_' + level);
      ul.innerHTML = txt;
      li.append(ul);
      if (this.modeValue === 5) {
        el.closest('li').after(li);
      } else {
        let isFolder = false,
          parent = el.closest('li'),
          next;
        while (typeOf(parent) === 'element' && parent.tagName === 'LI' && (next = parent.nextElementSibling)) {
          parent = next;
          if (parent.classList.contains('tl_folder')) {
            isFolder = true;
            break;
          }
        }
        if (isFolder) {
          parent.before(li);
        } else {
          parent.after(li);
        }
      }
      window.dispatchEvent(new CustomEvent('structure'));
      this.expandToggler(el);

      // HOOK (see #6752)
      window.fireEvent('ajax_change');
    }
    this.loadToggler(el, false);
  }
  async toggleAll(event) {
    event.preventDefault();
    const href = event.currentTarget.href;
    if (this.hasExpandedRoot() ^ (event ? event.altKey : false)) {
      this.updateAllState(href, 0);
      this.toggleTargets.forEach(el => this.collapseToggler(el));
      this.childTargets.forEach(item => item.style.display = 'none');
    } else {
      this.childTargets.forEach(el => el.remove());
      this.toggleTargets.forEach(el => this.loadToggler(el, true));
      await this.updateAllState(href, 1);
      const promises = [];
      this.toggleTargets.forEach(el => {
        promises.push(this.fetchChild(el, el.getAttribute(`data-${this.identifier}-id-param`), 0, el.getAttribute(`data-${this.identifier}-folder-param`)));
      });
      await Promise.all(promises);
    }
    this.updateOperation();
  }
  keypress(event) {
    this.updateOperation(event);
  }
  async updateState(el, id, state) {
    await fetch(location.href, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'X-Requested-With': 'XMLHttpRequest'
      },
      body: new URLSearchParams({
        'action': this.toggleActionValue,
        'id': id,
        'state': state,
        'REQUEST_TOKEN': this.requestTokenValue
      })
    });
  }
  async updateAllState(href, state) {
    await fetch(`${href}&state=${state}`);
  }
  updateOperation(event) {
    if (!this.hasOperationTarget) {
      return;
    }
    if (this.hasExpandedRoot() ^ (event ? event.altKey : false)) {
      this.operationTarget.innerText = this.collapseAllValue;
      this.operationTarget.title = this.collapseAllTitleValue;
    } else {
      this.operationTarget.innerText = this.expandAllValue;
      this.operationTarget.title = this.expandAllTitleValue;
    }
  }
  hasExpandedRoot() {
    return !!this.rootChildTargets.find(el => el.style.display !== 'none');
  }
});

/***/ }),

/***/ "./core-bundle/assets/controllers/tooltips-controller.js":
/*!***************************************************************!*\
  !*** ./core-bundle/assets/controllers/tooltips-controller.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ TooltipsController; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

class TooltipsController extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static defaultOptionsMap = (() => ({
    'a img[alt]': {
      x: -9,
      y: 30
    },
    '.sgallery img[alt]': {
      x: 0,
      y: 75
    },
    'p.tl_tip': {
      x: 0,
      y: 23,
      useContent: true
    },
    '#home[title]': {
      x: 6,
      y: 42
    },
    '#tmenu a[title]': {
      x: 0,
      y: 42
    },
    'a[title][class^="group-"]': {
      x: -6,
      y: 27
    },
    'a[title].navigation': {
      x: 25,
      y: 32
    },
    'img[title].gimage': {
      x: -9,
      y: 60
    },
    'img[title]:not(.gimage)': {
      x: -9,
      y: 30
    },
    'a[title].picker-wizard': {
      x: -4,
      y: 30
    },
    'button img[alt]': {
      x: -9,
      y: 30
    },
    'button[title].unselectable': {
      x: -4,
      y: 20
    },
    'button[title]:not(.unselectable)': {
      x: -9,
      y: 30
    },
    'a[title]:not(.picker-wizard)': {
      x: -9,
      y: 30
    },
    'input[title]': {
      x: -9,
      y: 30
    },
    'time[title]': {
      x: -9,
      y: 26
    },
    'span[title]': {
      x: -9,
      y: 26
    }
  }))();
  activeTargets = (() => new Set())();
  removeClickTargetHandlerDelegates = (() => new Map())();

  /**
   * There is one controller handling multiple tooltip targets. The tooltip
   * DOM element is shared across targets.
   */
  connect() {
    document.body.appendChild(this.tooltip = this._createTipContainer());
    document.addEventListener('touchstart', this._touchStartDelegate);
  }
  disconnect() {
    this.tooltip.remove();
    document.removeEventListener('touchstart', this._touchStartDelegate);
  }
  tooltipTargetConnected(el) {
    el.addEventListener('mouseenter', e => this._showTooltip(e.target, 1000));
    el.addEventListener('touchend', e => this._showTooltip(e.target));
    el.addEventListener('mouseleave', e => this._hideTooltip(e.target));

    // In case the tooltip target is inside a link or button, also close it
    // when a click happened
    const clickTarget = el.closest('button, a');
    if (clickTarget) {
      const handler = () => this._hideTooltip(el);
      clickTarget.addEventListener('click', handler);
      this.removeClickTargetHandlerDelegates.set(el, () => el.removeEventListener('click', handler));
    }
  }
  tooltipTargetDisconnected(el) {
    if (this.activeTargets.has(el)) {
      this._hideTooltip(el);
    }
    if (this.removeClickTargetHandlerDelegates.has(el)) {
      this.removeClickTargetHandlerDelegates.get(el)();
      this.removeClickTargetHandlerDelegates.delete(el);
    }
  }
  _createTipContainer() {
    const tooltip = document.createElement('div');
    tooltip.setAttribute('role', 'tooltip');
    tooltip.classList.add('tip');
    tooltip.style.position = 'absolute';
    tooltip.style.display = 'none';
    return tooltip;
  }
  _touchStartDelegate = e => {
    [...this.activeTargets].filter(el => !el.contains(e.target)).forEach(this._hideTooltip.bind(this));
  };
  _showTooltip(el) {
    let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    const options = this._getOptionsForElement(el);
    let text;
    if (options.useContent) {
      text = el.innerHTML;
    } else if ('img' === el.nodeName.toLowerCase()) {
      text = el.getAttribute('alt');
      text = text?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;');
    } else {
      text = el.getAttribute('title');
      el.setAttribute('data-original-title', text);
      el.removeAttribute('title');
      text = text?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;');
    }
    if (!text) {
      return;
    }
    clearTimeout(this.timer);
    this.tooltip.style.willChange = 'display,contents';
    this.timer = setTimeout(() => {
      this.activeTargets.add(el);
      const position = el.getBoundingClientRect();
      const rtl = getComputedStyle(el).direction === 'rtl';
      const clientWidth = document.documentElement.clientWidth;
      if (rtl && position.x < 200 || !rtl && position.x < clientWidth - 200) {
        this.tooltip.style.left = `${window.scrollX + position.left + options.x}px`;
        this.tooltip.style.right = 'auto';
        this.tooltip.classList.remove('tip--rtl');
      } else {
        this.tooltip.style.left = 'auto';
        this.tooltip.style.right = `${clientWidth - window.scrollX - position.right + options.x}px`;
        this.tooltip.classList.add('tip--rtl');
      }
      this.tooltip.innerHTML = `<div>${text}</div>`;
      this.tooltip.style.top = `${window.scrollY + position.top + options.y}px`;
      this.tooltip.style.display = 'block';
      this.tooltip.style.willChange = 'auto';
    }, delay);
  }
  _hideTooltip(el) {
    let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    if (el.hasAttribute('data-original-title')) {
      if (!el.hasAttribute('title')) {
        el.setAttribute('title', el.getAttribute('data-original-title'));
      }
      el.removeAttribute('data-original-title');
    }
    clearTimeout(this.timer);
    this.tooltip.style.willChange = 'auto';
    if (this.tooltip.style.display === 'block') {
      this.activeTargets.delete(el);
      this.tooltip.style.willChange = 'display';
      this.timer = setTimeout(() => {
        this.tooltip.style.display = 'none';
        this.tooltip.style.willChange = 'auto';
      }, delay);
    }
  }
  _getOptionsForElement(el) {
    for (const [criteria, defaultOptions] of Object.entries(TooltipsController.defaultOptionsMap)) {
      if (el.match(criteria)) {
        return defaultOptions;
      }
    }
    return {
      x: -9,
      y: 30
    };
  }

  /**
   * Migrate legacy targets to proper controller targets.
   */
  static afterLoad(identifier, application) {
    const targetSelectors = Object.keys(TooltipsController.defaultOptionsMap);
    const migrateTarget = el => {
      targetSelectors.forEach(target => {
        if (!el.hasAttribute(`data-${identifier}-target`) && el.match(target)) {
          el.setAttribute(`data-${identifier}-target`, 'tooltip');
        }
      });
    };
    new MutationObserver(function (mutationsList) {
      for (const mutation of mutationsList) {
        if (mutation.type !== 'childList') {
          continue;
        }
        for (let node of mutation.addedNodes) {
          if (!(node instanceof HTMLElement)) {
            continue;
          }
          migrateTarget(node);
        }
      }
    }).observe(document, {
      childList: true,
      subtree: true
    });

    // Initially migrate all targets that are already in the DOM
    document.querySelectorAll(targetSelectors.join(',')).forEach(el => migrateTarget(el));
  }
}

/***/ }),

/***/ "./core-bundle/assets/controllers/webauthn-error-controller.js":
/*!*********************************************************************!*\
  !*** ./core-bundle/assets/controllers/webauthn-error-controller.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");

/* harmony default export */ __webpack_exports__["default"] = (class extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  static targets = ['message'];
  static values = (() => ({
    unsupportedMessage: String,
    assertionFailureMessage: String,
    attestationFailureMessage: String
  }))();
  handleUnsupported() {
    this.messageTarget.innerHTML = this.renderMessage(this.unsupportedMessageValue);
  }
  handleAssertionFailure(e) {
    this.messageTarget.innerHTML = this.renderMessage(this.assertionFailureMessageValue);
  }
  handleAttestationFailure() {
    this.messageTarget.innerHTML = this.renderMessage(this.attestationFailureMessageValue);
  }
  renderMessage(message, type) {
    type = type ?? 'error';
    return `<p class="tl_${type}">${message}</p>`;
  }
});

/***/ }),

/***/ "./core-bundle/assets/modules/twig-editor.js":
/*!***************************************************!*\
  !*** ./core-bundle/assets/modules/twig-editor.js ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TwigEditor: function() { return /* binding */ TwigEditor; }
/* harmony export */ });
class TwigEditor {
  constructor(element) {
    this.name = element.dataset.name;
    this.resourceUrl = element.dataset.resourceUrl;
    this.editor = ace.edit(element, {
      mode: 'ace/mode/twig',
      maxLines: 100,
      wrap: true,
      useSoftTabs: false,
      autoScrollEditorIntoView: true,
      readOnly: element.hasAttribute('readonly'),
      enableLiveAutocompletion: true
    });
    this.setColorScheme(document.documentElement.dataset.colorScheme);
    this.editor.container.style.lineHeight = '1.45';
    const whitespace = ace.require('ace/ext/whitespace');
    whitespace.detectIndentation(this.editor.getSession());

    // Register commands
    this.editor.commands.addCommand({
      name: 'lens:block-info',
      readOnly: true,
      exec: (editor, args) => {
        editor.container.dispatchEvent(new CustomEvent('twig-editor:lens:block-info', {
          bubbles: true,
          detail: {
            name: this.name,
            block: args[0]
          }
        }));
      }
    });
    this.editor.commands.addCommand({
      name: 'lens:follow',
      readOnly: true,
      exec: (editor, args) => {
        editor.container.dispatchEvent(new CustomEvent('twig-editor:lens:follow', {
          bubbles: true,
          detail: {
            name: args[0]
          }
        }));
      }
    });

    // Setup code lenses
    this.editor.getSession().once('tokenizerUpdate', () => {
      this.registerCodeLensProvider();
    });
  }
  registerCodeLensProvider() {
    const codeLens = ace.require('ace/ext/code_lens');
    codeLens.registerCodeLensProvider(this.editor, {
      provideCodeLenses: (session, callback) => {
        let payload = [];
        this.analyzeReferences().forEach(reference => {
          payload.push({
            start: {
              row: reference.row,
              column: reference.column
            },
            command: {
              id: 'lens:follow',
              title: reference.name,
              arguments: [reference.name]
            }
          });
        });
        this.analyzeBlocks().forEach(block => {
          payload.push({
            start: {
              row: block.row,
              column: block.column
            },
            command: {
              id: 'lens:block-info',
              title: `Block "${block.name}"`,
              arguments: [block.name]
            }
          });
        });
        callback(null, payload);
      }
    });
  }
  analyzeReferences() {
    let references = [];
    for (let row = 0; row < this.editor.getSession().getLength(); row++) {
      const tokens = this.editor.getSession().getTokens(row);
      for (let i = 0; i < tokens.length; i++) {
        if (tokens[i].type === 'meta.tag.twig' && /^{%-?$/.test(tokens[i].value) && tokens[i + 2]?.type === 'keyword.control.twig' && ['extends', 'use'].includes(tokens[i + 2].value) && tokens[i + 4]?.type === 'string') {
          const name = tokens[i + 4].value.replace(/["']/g, '');
          if (/^@Contao(_.+)?\//.test(name)) {
            references.push({
              name,
              row,
              column: tokens[i].start
            });
          }
        }
      }
    }
    return references;
  }
  analyzeBlocks() {
    let blocks = [];
    for (let row = 0; row < this.editor.getSession().getLength(); row++) {
      const tokens = this.editor.getSession().getTokens(row);
      for (let i = 0; i < tokens.length; i++) {
        if (tokens[i].type === 'meta.tag.twig' && /^{%-?$/.test(tokens[i].value) && tokens[i + 2]?.type === 'keyword.control.twig' && tokens[i + 2].value === 'block' && tokens[i + 4]?.type === 'identifier') {
          blocks.push({
            name: tokens[i + 4].value,
            row,
            column: tokens[i].start
          });
        }
      }
    }
    return blocks;
  }
  setAnnotationsData(data) {
    this.editor.completers = [{
      getCompletions: function (editor, session, pos, prefix, callback) {
        callback(null, data.autocomplete);
      }
    }];
    if ('error' in data) {
      this.editor.getSession().setAnnotations([{
        row: data.error.line - 1,
        type: data.error.type || 'error',
        text: ` ${data.error.message}`
      }]);
    }
  }
  setColorScheme(mode) {
    this.editor.setTheme(mode === 'dark' ? 'ace/theme/twilight' : 'ace/theme/clouds');
  }
  isEditable() {
    return !this.editor.getReadOnly();
  }
  getContent() {
    return this.editor.getValue();
  }
  focus() {
    this.editor.focus();
  }
  destroy() {
    this.editor.destroy();
  }
}

/***/ }),

/***/ "./core-bundle/assets/scripts/core.js":
/*!********************************************!*\
  !*** ./core-bundle/assets/scripts/core.js ***!
  \********************************************/
/***/ (function() {

/**
 * Provide methods to handle Ajax requests.
 *
 * @author Leo Feyer <https://github.com/leofeyer>
 */
window.AjaxRequest = {
  /**
   * Toggle the navigation menu
   *
   * @param {object} el  The DOM element
   * @param {string} id  The ID of the menu item
   * @param {string} url The Ajax URL
   *
   * @returns {boolean}
   */
  toggleNavigation: function (el, id, url) {
    if (window.console) {
      console.warn('AjaxRequest.toggleNavigation() is deprecated. Please use the stimulus controller instead.');
    }
    var item = $(id),
      parent = $(el).getParent('li');
    if (item) {
      if (parent.hasClass('collapsed')) {
        parent.removeClass('collapsed');
        $(el).setAttribute('aria-expanded', 'true');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          url: url
        }).post({
          'action': 'toggleNavigation',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        parent.addClass('collapsed');
        $(el).setAttribute('aria-expanded', 'false');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          url: url
        }).post({
          'action': 'toggleNavigation',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    return false;
  },
  /**
   * Toggle the page tree
   *
   * @param {object} el    The DOM element
   * @param {string} id    The ID of the target element
   * @param {int}    level The indentation level
   * @param {int}    mode  The insert mode
   *
   * @returns {boolean}
   */
  toggleStructure: function (el, id, level, mode) {
    if (window.console) {
      console.warn('AjaxRequest.toggleStructure() is deprecated. Please use the stimulus controller instead.');
    }
    el.blur();
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleStructure',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleStructure',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    new Request.Contao({
      field: el,
      evalScripts: true,
      onRequest: function () {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function (txt) {
        var li = new Element('li', {
          'id': id,
          'class': 'parent',
          'styles': {
            'display': 'inline'
          }
        });
        new Element('ul', {
          'class': 'level_' + level,
          'html': txt
        }).inject(li, 'bottom');
        if (mode == 5) {
          li.inject($(el).getParent('li'), 'after');
        } else {
          var folder = false,
            parent = $(el).getParent('li'),
            next;
          while (typeOf(parent) == 'element' && (next = parent.getNext('li'))) {
            parent = next;
            if (parent.hasClass('tl_folder')) {
              folder = true;
              break;
            }
          }
          if (folder) {
            li.inject(parent, 'before');
          } else {
            li.inject(parent, 'after');
          }
        }

        // Update the referer ID
        li.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        window.fireEvent('structure');
        AjaxRequest.hideBox();

        // HOOK
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'loadStructure',
      'id': id,
      'level': level,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    return false;
  },
  /**
   * Toggle the file tree
   *
   * @param {object} el     The DOM element
   * @param {string} id     The ID of the target element
   * @param {string} folder The folder's path
   * @param {int}    level  The indentation level
   *
   * @returns {boolean}
   */
  toggleFileManager: function (el, id, folder, level) {
    if (window.console) {
      console.warn('AjaxRequest.toggleFileManager() is deprecated. Please use the stimulus controller instead.');
    }
    el.blur();
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleFileManager',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.expand);
        new Request.Contao({
          field: el
        }).post({
          'action': 'toggleFileManager',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return false;
    }
    new Request.Contao({
      field: el,
      evalScripts: true,
      onRequest: function () {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function (txt) {
        var li = new Element('li', {
          'id': id,
          'class': 'parent',
          'styles': {
            'display': 'inline'
          }
        });
        new Element('ul', {
          'class': 'level_' + level,
          'html': txt
        }).inject(li, 'bottom');
        li.inject($(el).getParent('li'), 'after');

        // Update the referer ID
        li.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        $(el).addClass('foldable--open');
        $(el).setAttribute('title', Contao.lang.collapse);
        AjaxRequest.hideBox();

        // HOOK
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'loadFileManager',
      'id': id,
      'level': level,
      'folder': folder,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    return false;
  },
  /**
   * Toggle sub-palettes in edit mode
   *
   * @param {object} el    The DOM element
   * @param {string} id    The ID of the target element
   * @param {string} field The field name
   */
  toggleSubpalette: function (el, id, field) {
    el.blur();
    var item = $(id);
    if (item) {
      if (!el.value) {
        el.value = 1;
        el.checked = 'checked';
        item.setStyle('display', null);
        item.getElements('[data-required]').each(function (el) {
          el.set('required', '').set('data-required', null);
        });
        new Request.Contao({
          field: el,
          onSuccess: updateVersionNumber
        }).post({
          'action': 'toggleSubpalette',
          'id': id,
          'field': field,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        el.value = '';
        el.checked = '';
        item.setStyle('display', 'none');
        item.getElements('[required]').each(function (el) {
          el.set('required', null).set('data-required', '');
        });
        new Request.Contao({
          field: el,
          onSuccess: updateVersionNumber
        }).post({
          'action': 'toggleSubpalette',
          'id': id,
          'field': field,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return;
    }
    new Request.Contao({
      field: el,
      evalScripts: false,
      onRequest: function () {
        AjaxRequest.displayBox(Contao.lang.loading + ' …');
      },
      onSuccess: function (txt, json) {
        var div = new Element('div', {
          'id': id,
          'class': 'subpal widget-group',
          'html': txt
        }).inject($(el).getParent('div').getParent('div'), 'after');

        // Execute scripts after the DOM has been updated
        if (json.javascript) {
          // Use Asset.javascript() instead of document.write() to load a
          // JavaScript file and re-execute the code after it has been loaded
          document.write = function (str) {
            var src = '';
            str.replace(/<script src="([^"]+)"/i, function (all, match) {
              src = match;
            });
            src && Asset.javascript(src, {
              onLoad: function () {
                Browser.exec(json.javascript);
              }
            });
          };
          Browser.exec(json.javascript);
        }
        el.value = 1;
        el.checked = 'checked';

        // Update the referer ID
        div.getElements('a').each(function (el) {
          el.href = el.href.replace(/&ref=[a-f0-9]+/, '&ref=' + Contao.referer_id);
        });
        updateVersionNumber(txt);
        AjaxRequest.hideBox();
        window.fireEvent('ajax_change');
      }
    }).post({
      'action': 'toggleSubpalette',
      'id': id,
      'field': field,
      'load': 1,
      'state': 1,
      'REQUEST_TOKEN': Contao.request_token
    });
    function updateVersionNumber(html) {
      var fields = el.form.elements.VERSION_NUMBER || [];
      if (!fields.forEach) {
        fields = [fields];
      }
      fields.forEach(function (field) {
        field.value = /<input\s+[^>]*?name="VERSION_NUMBER"\s+[^>]*?value="([^"]*)"/i.exec(html)[1];
      });
    }
  },
  /**
   * Toggle the state of a checkbox field
   *
   * @param {object}  el      The DOM element
   * @param {boolean} rowIcon Whether the row icon should be toggled as well
   *
   * @returns {boolean}
   */
  toggleField: function (el, rowIcon) {
    el.blur();
    var img = null,
      images = $(el).getElements('img'),
      published = images[0].get('data-state') == 1,
      div = el.getParent('div'),
      next,
      pa;
    if (rowIcon) {
      // Find the icon depending on the view (tree view, list view, parent view)
      if (div.hasClass('tl_right')) {
        img = div.getPrevious('div').getElements('img');
      } else if (div.hasClass('tl_listing_container')) {
        img = el.getParent('td').getPrevious('td').getFirst('div.list_icon');
        if (img === null) {
          // comments
          img = el.getParent('td').getPrevious('td').getElement('div.cte_type');
        }
        if (img === null) {
          // showColumns
          img = el.getParent('tr').getFirst('td').getElement('div.list_icon_new');
        }
      } else if (next = div.getNext('div')) {
        if (next.hasClass('cte_type')) {
          img = next;
        }
        if (img === null) {
          // newsletter recipients
          img = next.getFirst('div.list_icon');
        }
      }

      // Change the row icon
      if (img !== null) {
        // Tree view
        if (!(img instanceof HTMLElement) && img.forEach) {
          img.forEach(img => {
            if (img.nodeName.toLowerCase() == 'img') {
              if (!img.getParent('ul.tl_listing').hasClass('tl_tree_xtnd')) {
                pa = img.getParent('a');
                if (pa && pa.href.indexOf('contao/preview') == -1) {
                  if (next = pa.getNext('a')) {
                    img = next.getElement('img');
                  } else {
                    img = new Element('img'); // no icons used (see #2286)
                  }
                }
              }
              const newSrc = !published ? img.get('data-icon') : img.get('data-icon-disabled');
              img.src = img.src.includes('/') && !newSrc.includes('/') ? img.src.slice(0, img.src.lastIndexOf('/') + 1) + newSrc : newSrc;
            }
          });
        }
        // Parent view
        else if (img.hasClass('cte_type')) {
          if (!published) {
            img.addClass('published');
            img.removeClass('unpublished');
          } else {
            img.addClass('unpublished');
            img.removeClass('published');
          }
        }
        // List view
        else {
          img.setStyle('background-image', 'url(' + (!published ? img.get('data-icon') : img.get('data-icon-disabled')) + ')');
        }
      }
    }

    // Send request
    images.forEach(function (image) {
      const newSrc = !published ? image.get('data-icon') : image.get('data-icon-disabled');
      image.src = image.src.includes('/') && !newSrc.includes('/') ? image.src.slice(0, image.src.lastIndexOf('/') + 1) + newSrc : newSrc;
      image.alt = !published ? image.get('data-alt') : image.get('data-alt-disabled');
      image.set('data-state', !published ? 1 : 0);
    });
    if (!published && $(el).get('data-title')) {
      el.title = $(el).get('data-title');
    } else if (published && $(el).get('data-title-disabled')) {
      el.title = $(el).get('data-title-disabled');
    }
    new Request.Contao({
      'url': el.href,
      'followRedirects': false
    }).get();

    // Return false to stop the click event on link
    return false;
  },
  /**
   * Toggle a group of a multi-checkbox field
   *
   * @param {object} el The DOM element
   * @param {string} id The ID of the target element
   *
   * @returns {boolean}
   */
  toggleCheckboxGroup: function (el, id) {
    el.blur();
    var item = $(id);
    if (item) {
      if (item.getStyle('display') == 'none') {
        item.setStyle('display', null);
        $(el).addClass('foldable--open');
        new Request.Contao().post({
          'action': 'toggleCheckboxGroup',
          'id': id,
          'state': 1,
          'REQUEST_TOKEN': Contao.request_token
        });
      } else {
        item.setStyle('display', 'none');
        $(el).removeClass('foldable--open');
        new Request.Contao().post({
          'action': 'toggleCheckboxGroup',
          'id': id,
          'state': 0,
          'REQUEST_TOKEN': Contao.request_token
        });
      }
      return true;
    }
    return false;
  },
  /**
   * Display the "loading data" message
   *
   * @param {string} message The message text
   */
  displayBox: function (message) {
    var box = $('tl_ajaxBox'),
      overlay = $('tl_ajaxOverlay'),
      scroll = window.getScroll();
    if (overlay === null) {
      overlay = new Element('div', {
        'id': 'tl_ajaxOverlay'
      }).inject($(document.body), 'bottom');
    }
    overlay.set({
      'styles': {
        'display': 'block',
        'top': scroll.y + 'px'
      }
    });
    if (box === null) {
      box = new Element('div', {
        'id': 'tl_ajaxBox'
      }).inject($(document.body), 'bottom');
    }
    box.set({
      'html': message,
      'styles': {
        'display': 'block',
        'top': scroll.y + 100 + 'px'
      }
    });
  },
  /**
   * Hide the "loading data" message
   */
  hideBox: function () {
    var box = $('tl_ajaxBox'),
      overlay = $('tl_ajaxOverlay');
    if (overlay) {
      overlay.setStyle('display', 'none');
    }
    if (box) {
      box.setStyle('display', 'none');
    }
  }
};

/**
 * Provide methods to handle back end tasks.
 *
 * @author Leo Feyer <https://github.com/leofeyer>
 */
window.Backend = {
  /**
   * The current ID
   * @member {(string|null)}
   */
  currentId: null,
  /**
   * The popup window
   * @member {object}
   */
  popupWindow: null,
  /**
   * The theme path
   * @member {string}
   */
  themePath: Contao.script_url + 'system/themes/' + Contao.theme + '/',
  /**
   * Open a modal window
   *
   * @param {int}    width   The width in pixels
   * @param {string} title   The window's title
   * @param {string} content The window's content
   */
  openModalWindow: function (width, title, content) {
    new SimpleModal({
      'width': width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'overlayClick': false,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    }).show({
      'title': title,
      'contents': content
    });
  },
  /**
   * Open an image in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalImage: function (options) {
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt();
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    var M = new SimpleModal({
      'width': opt.width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.show({
      'title': opt.title?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<img src="' + opt.url + '" alt="">'
    });
  },
  /**
   * Open an iframe in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalIframe: function (options) {
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt(),
      maxHeight = (window.getSize().y - 137).toInt();
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    if (!opt.height || opt.height > maxHeight) opt.height = maxHeight;
    var M = new SimpleModal({
      'width': opt.width,
      'hideFooter': true,
      'draggable': false,
      'overlayOpacity': .7,
      'overlayClick': false,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.show({
      'title': opt.title?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<iframe src="' + opt.url + '" width="100%" height="' + opt.height + '" frameborder="0"></iframe>',
      'model': 'modal'
    });
  },
  /**
   * Open a selector page in a modal window
   *
   * @param {object} options An optional options object
   */
  openModalSelector: function (options) {
    var opt = options || {},
      maxWidth = (window.getSize().x - 20).toInt(),
      maxHeight = (window.getSize().y - 192).toInt();
    if (!opt.id) opt.id = 'tl_select';
    if (!opt.width || opt.width > maxWidth) opt.width = Math.min(maxWidth, 900);
    if (!opt.height || opt.height > maxHeight) opt.height = maxHeight;
    var M = new SimpleModal({
      'width': opt.width,
      'draggable': false,
      'overlayOpacity': .7,
      'overlayClick': false,
      'onShow': function () {
        document.body.setStyle('overflow', 'hidden');
      },
      'onHide': function () {
        document.body.setStyle('overflow', 'auto');
      }
    });
    M.addButton(Contao.lang.cancel, 'btn', function () {
      if (this.buttons[0].hasClass('btn-disabled')) {
        return;
      }
      this.hide();
    });
    M.addButton(Contao.lang.apply, 'btn primary', function () {
      if (this.buttons[1].hasClass('btn-disabled')) {
        return;
      }
      var frm = window.frames['simple-modal-iframe'],
        val = [],
        ul,
        inp,
        i,
        pickerValue,
        sIndex;
      if (frm === undefined) {
        alert('Could not find the SimpleModal frame');
        return;
      }
      ul = frm.document.getElementById(opt.id);
      // Load the previous values (#1816)
      if (pickerValue = ul.get('data-picker-value')) {
        val = JSON.parse(pickerValue);
      }
      inp = ul.getElementsByTagName('input');
      for (i = 0; i < inp.length; i++) {
        if (inp[i].id.match(/^(check_all_|reset_)/)) {
          continue;
        }
        // Add currently selected value, otherwise remove (#1816)
        sIndex = val.indexOf(inp[i].get('value'));
        if (inp[i].checked) {
          if (sIndex == -1) {
            val.push(inp[i].get('value'));
          }
        } else if (sIndex != -1) {
          val.splice(sIndex, 1);
        }
      }
      opt.callback(ul.get('data-table'), val);
      this.hide();
    });
    M.show({
      'title': opt.title?.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/'/g, '&apos;'),
      'contents': '<iframe src="' + opt.url + '" name="simple-modal-iframe" width="100%" height="' + opt.height + '" frameborder="0"></iframe>',
      'model': 'modal'
    });
  },
  /**
   * Open a TinyMCE file browser in a modal window
   *
   * @param {string} field_name The field name
   * @param {string} url        The URL
   * @param {string} type       The picker type
   * @param {object} win        The window object
   * @param {string} source     The source record
   */
  openModalBrowser: function (field_name, url, type, win, source) {
    Backend.openModalSelector({
      'id': 'tl_listing',
      'title': win.document.getElement('div.mce-title').get('text'),
      'url': Contao.routes.backend_picker + '?context=' + (type == 'file' ? 'link' : 'file') + '&amp;extras[fieldType]=radio&amp;extras[filesOnly]=true&amp;extras[source]=' + source + '&amp;value=' + url + '&amp;popup=1',
      'callback': function (table, value) {
        win.document.getElementById(field_name).value = value.join(',');
      }
    });
  },
  /**
   * Automatically submit a form
   *
   * @param {object} el The DOM element
   */
  autoSubmit: function (el) {
    window.dispatchEvent(new Event('store-scroll-offset'));
    var hidden = new Element('input', {
      'type': 'hidden',
      'name': 'SUBMIT_TYPE',
      'value': 'auto'
    });
    var form = $(el) || el;
    hidden.inject(form, 'bottom');
    form.submit();
  },
  /**
   * Scroll the window to a certain vertical position
   *
   * @param {int} offset The offset to scroll to
   */
  vScrollTo: function (offset) {
    if (window.console) {
      console.warn('Backend.vScrollTo() is deprecated. Please use the Stimulus controller instead.');
    }
    window.addEvent('load', function () {
      window.scrollTo(null, parseInt(offset));
    });
  },
  /**
   * Toggle checkboxes
   *
   * @param {object} el   The DOM element
   * @param {string} [id] The ID of the target element
   */
  toggleCheckboxes: function (el, id) {
    var items = $$('input'),
      status = $(el).checked ? 'checked' : '';
    for (var i = 0; i < items.length; i++) {
      if (items[i].type.toLowerCase() != 'checkbox') {
        continue;
      }
      if (id !== undefined && id != items[i].id.substr(0, id.length)) {
        continue;
      }
      items[i].checked = status;
    }
  },
  /**
   * Toggle a checkbox group
   *
   * @param {object} el The DOM element
   * @param {string} id The ID of the target element
   */
  toggleCheckboxGroup: function (el, id) {
    var cls = $(el).className,
      status = $(el).checked ? 'checked' : '';
    if (cls == 'tl_checkbox') {
      var cbx = $(id) ? $$('#' + id + ' .tl_checkbox') : $(el).getParent('fieldset').getElements('.tl_checkbox');
      cbx.each(function (checkbox) {
        checkbox.checked = status;
      });
    } else if (cls == 'tl_tree_checkbox') {
      $$('#' + id + ' .parent .tl_tree_checkbox').each(function (checkbox) {
        checkbox.checked = status;
      });
    }
    window.dispatchEvent(new Event('store-scroll-offset'));
  },
  /**
   * Toggle checkbox elements
   *
   * @param {string} el  The DOM element
   * @param {string} cls The CSS class name
   */
  toggleCheckboxElements: function (el, cls) {
    var status = $(el).checked ? 'checked' : '';
    $$('.' + cls).each(function (checkbox) {
      if (checkbox.hasClass('tl_checkbox')) {
        checkbox.checked = status;
      }
    });
    window.dispatchEvent(new Event('store-scroll-offset'));
  },
  /**
   * Make parent view items sortable
   *
   * @param {object} ul The DOM element
   *
   * @author Joe Ray Gregory
   * @author Martin Auswöger
   */
  makeParentViewSortable: function (ul) {
    var ds = new Scroller(document.getElement('body'), {
      onChange: function (x, y) {
        this.element.scrollTo(this.element.getScroll().x, y);
      }
    });
    var list = new Sortables(ul, {
      constrain: true,
      opacity: 0.6,
      onStart: function () {
        ds.start();
      },
      onComplete: function () {
        ds.stop();
      },
      onSort: function (el) {
        var ul = el.getParent('ul'),
          wrapLevel = 0,
          divs,
          i;
        if (!ul) return;
        divs = ul.getChildren('li > div:first-child');
        if (!divs) return;
        for (i = 0; i < divs.length; i++) {
          if (divs[i].hasClass('wrapper_stop') && wrapLevel > 0) {
            wrapLevel--;
          }
          divs[i].className = divs[i].className.replace(/(^|\s)indent[^\s]*/g, '');
          if (wrapLevel > 0) {
            divs[i].addClass('indent').addClass('indent_' + wrapLevel);
          }
          if (divs[i].hasClass('wrapper_start')) {
            wrapLevel++;
          }
          divs[i].removeClass('indent_first');
          divs[i].removeClass('indent_last');
          if (divs[i - 1] && divs[i - 1].hasClass('wrapper_start')) {
            divs[i].addClass('indent_first');
          }
          if (divs[i + 1] && divs[i + 1].hasClass('wrapper_stop')) {
            divs[i].addClass('indent_last');
          }
        }
      },
      handle: '.drag-handle'
    });
    list.active = false;
    list.addEvent('start', function () {
      list.active = true;
    });
    list.addEvent('complete', function (el) {
      if (!list.active) return;
      var id, pid, req, href;
      if (el.getPrevious('li')) {
        id = el.get('id').replace(/li_/, '');
        pid = el.getPrevious('li').get('id').replace(/li_/, '');
        req = window.location.search.replace(/id=[0-9]*/, 'id=' + id) + '&act=cut&mode=1&pid=' + pid;
        href = window.location.href.replace(/\?.*$/, '');
        new Request.Contao({
          'url': href + req,
          'followRedirects': false
        }).get();
      } else if (el.getParent('ul')) {
        id = el.get('id').replace(/li_/, '');
        pid = el.getParent('ul').get('id').replace(/ul_/, '');
        req = window.location.search.replace(/id=[0-9]*/, 'id=' + id) + '&act=cut&mode=2&pid=' + pid;
        href = window.location.href.replace(/\?.*$/, '');
        new Request.Contao({
          'url': href + req,
          'followRedirects': false
        }).get();
      }
    });
  },
  /**
   * Make multiSRC items sortable
   *
   * @param {string} id  The ID of the target element
   * @param {string} oid The order field
   * @param {string} val The value field
   */
  makeMultiSrcSortable: function (id, oid, val) {
    var list = new Sortables($(id), {
      constrain: true,
      opacity: 0.6
    }).addEvent('complete', function () {
      var els = [],
        lis = $(id).getChildren('[data-id]'),
        i;
      for (i = 0; i < lis.length; i++) {
        els.push(lis[i].get('data-id'));
      }
      if (oid === val) {
        $(val).value.split(',').forEach(function (j) {
          if (els.indexOf(j) === -1) {
            els.push(j);
          }
        });
      }
      $(oid).value = els.join(',');
    });
    $(id).getElements('.gimage').each(function (el) {
      if (el.hasClass('removable')) {
        new Element('button', {
          type: 'button',
          html: '&times;',
          'class': 'tl_red'
        }).addEvent('click', function () {
          var li = el.getParent('li'),
            did = li.get('data-id');
          $(val).value = $(val).value.split(',').filter(function (j) {
            return j != did;
          }).join(',');
          $(oid).value = $(oid).value.split(',').filter(function (j) {
            return j != did;
          }).join(',');
          li.dispose();
        }).inject(el, 'after');
      } else {
        new Element('button', {
          type: 'button',
          html: '&times',
          disabled: true
        }).inject(el, 'after');
      }
    });
    list.fireEvent("complete"); // Initial sorting
  },
  /**
   * Enable drag and drop for the file tree
   *
   * @param {object} ul      The DOM element
   * @param {object} options An optional options object
   */
  enableFileTreeDragAndDrop: function (ul, options) {
    var ds = new Scroller(document.getElement('body'), {
      onChange: function (x, y) {
        this.element.scrollTo(this.element.getScroll().x, y);
      }
    });
    ul.addEvent('mousedown', function (event) {
      var dragHandle = event.target.hasClass('drag-handle') ? event.target : event.target.getParent('.drag-handle');
      var dragElement = event.target.getParent('.tl_file,.tl_folder');
      if (!dragHandle || !dragElement || event.rightClick) {
        return;
      }
      ds.start();
      ul.addClass('tl_listing_dragging');
      var cloneBase = dragElement.getElements('.tl_left')[0] || dragElement,
        clone = cloneBase.clone(true).inject(ul).addClass('tl_left_dragging'),
        currentHover,
        currentHoverTime,
        expandLink;
      clone.setPosition({
        x: event.page.x - cloneBase.getOffsetParent().getPosition().x - clone.getSize().x,
        y: cloneBase.getPosition(cloneBase.getOffsetParent()).y
      }).setStyle('display', 'none');
      var move = new Drag.Move(clone, {
        droppables: $$([ul]).append(ul.getElements('.tl_folder,li.parent,.tl_folder_top')),
        unDraggableTags: [],
        modifiers: {
          x: 'left',
          y: 'top'
        },
        onStart: function () {
          clone.setStyle('display', '');
        },
        onEnter: function (element, droppable) {
          droppable = fixDroppable(droppable);
          droppable.addClass('tl_folder_dropping');
          if (droppable.hasClass('tl_folder') && currentHover !== droppable) {
            currentHover = droppable;
            currentHoverTime = new Date().getTime();
            expandLink = droppable.getElement('a.foldable');
            if (expandLink && !expandLink.hasClass('foldable--open')) {
              // Expand the folder after one second hover time
              setTimeout(function () {
                if (currentHover === droppable && currentHoverTime + 900 < new Date().getTime()) {
                  var event = document.createEvent('HTMLEvents');
                  event.initEvent('click', true, true);
                  expandLink.dispatchEvent(event);
                  currentHover = undefined;
                  currentHoverTime = undefined;
                  window.addEvent('ajax_change', function onAjax() {
                    if (move && move.droppables && ul && ul.getElements) {
                      move.droppables = $$([ul]).append(ul.getElements('.tl_folder,li.parent'));
                    }
                    window.removeEvent('ajax_change', onAjax);
                  });
                }
              }, 1000);
            }
          }
        },
        onCancel: function () {
          currentHover = undefined;
          currentHoverTime = undefined;
          ds.stop();
          clone.destroy();
          window.removeEvent('keyup', onKeyup);
          ul.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
          ul.removeClass('tl_listing_dragging');
        },
        onDrop: function (element, droppable) {
          currentHover = undefined;
          currentHoverTime = undefined;
          ds.stop();
          clone.destroy();
          window.removeEvent('keyup', onKeyup);
          ul.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
          ul.removeClass('tl_listing_dragging');
          droppable = fixDroppable(droppable);
          if (!droppable) {
            return;
          }
          var id = dragElement.get('data-id'),
            pid = droppable.get('data-id') || decodeURIComponent(options.url.split(/[?&]pid=/)[1].split('&')[0]);

          // Ignore invalid move operations
          if (id && pid && ((pid + '/').indexOf(id + '/') === 0 || pid + '/' === id.replace(/[^/]+$/, ''))) {
            return;
          }
          window.dispatchEvent(new Event('store-scroll-offset'));
          document.location.href = options.url + '&id=' + encodeURIComponent(id) + '&pid=' + encodeURIComponent(pid);
        },
        onLeave: function (element, droppable) {
          droppable = fixDroppable(droppable);
          droppable.removeClass('tl_folder_dropping');
          currentHover = undefined;
          currentHoverTime = undefined;
        }
      });
      move.start(event);
      window.addEvent('keyup', onKeyup);
      function onKeyup(event) {
        if (event.key === 'esc' && move && move.stop) {
          move.droppables = $$([]);
          move.stop();
        }
      }
    });
    function fixDroppable(droppable) {
      if (droppable && droppable.hasClass('parent') && droppable.getPrevious('.tl_folder')) {
        return droppable.getPrevious('.tl_folder');
      }
      return droppable;
    }
  },
  /**
   * List wizard
   *
   * @param {string} id The ID of the target element
   */
  listWizard: function (id) {
    var ul = $(id),
      makeSortable = function (ul) {
        new Sortables(ul, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle'
        });
      },
      addEventsTo = function (li) {
        var command, clone, input, previous, next;
        li.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                clone = li.clone(true).inject(li, 'before');
                if (input = li.getFirst('input')) {
                  clone.getFirst('input').value = input.value;
                }
                addEventsTo(clone);
                input.select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (ul.getChildren().length > 1) {
                  li.destroy();
                }
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (previous = li.getPrevious('li')) {
                    li.inject(previous, 'before');
                  } else {
                    li.inject(ul, 'bottom');
                  }
                  bt.focus();
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (next = li.getNext('li')) {
                    li.inject(next, 'after');
                  } else {
                    li.inject(ul.getFirst('li'), 'before');
                  }
                  bt.focus();
                }
              });
              break;
          }
        });
      };
    makeSortable(ul);
    ul.getChildren().each(function (li) {
      addEventsTo(li);
    });
  },
  /**
   * Table wizard
   *
   * @param {string} id The ID of the target element
   */
  tableWizard: function (id) {
    var table = $(id),
      thead = table.getElement('thead'),
      tbody = table.getElement('tbody'),
      makeSortable = function (tbody) {
        var rows = tbody.getChildren(),
          textarea,
          children,
          i,
          j;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (textarea = children[j].getFirst('textarea')) {
              textarea.name = textarea.name.replace(/\[[0-9]+][[0-9]+]/g, '[' + i + '][' + j + ']');
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function () {
            makeSortable(tbody);
          }
        });
      },
      addEventsTo = function (tr) {
        var head = thead.getFirst('tr'),
          command,
          textarea,
          current,
          next,
          ntr,
          children,
          index,
          i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'rcopy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (textarea = children[i].getFirst('textarea')) {
                    next.getFirst('textarea').value = textarea.value;
                  }
                }
                ntr.inject(tr, 'after');
                addEventsTo(ntr);
                makeSortable(tbody);
                ntr.getFirst('td').getFirst('textarea').select();
              });
              break;
            case 'rdelete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                makeSortable(tbody);
              });
              break;
            case 'ccopy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                for (i = 0; i < children.length; i++) {
                  current = children[i].getChildren()[index];
                  next = current.clone(true).inject(current, 'after');
                  if (textarea = current.getFirst('textarea')) {
                    next.getFirst('textarea').value = textarea.value;
                  }
                  addEventsTo(next);
                }
                var headFirst = head.getFirst('td');
                next = headFirst.clone(true).inject(head.getLast('td'), 'before');
                addEventsTo(next);
                makeSortable(tbody);
                children[0].getChildren()[index + 1].getFirst('textarea').select();
              });
              break;
            case 'cmovel':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (index > 0) {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(current.getPrevious(), 'before');
                  }
                } else {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(children[i].getLast(), 'before');
                  }
                }
                makeSortable(tbody);
              });
              break;
            case 'cmover':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (index < tr.getChildren().length - 2) {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(current.getNext(), 'after');
                  }
                } else {
                  for (i = 0; i < children.length; i++) {
                    current = children[i].getChildren()[index];
                    current.inject(children[i].getFirst(), 'before');
                  }
                }
                makeSortable(tbody);
              });
              break;
            case 'cdelete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                index = getIndex(bt);
                children = tbody.getChildren();
                if (tr.getChildren().length > 2) {
                  for (i = 0; i < children.length; i++) {
                    children[i].getChildren()[index].destroy();
                  }
                  head.getFirst('td').destroy();
                }
                makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
              break;
          }
        });
      },
      getIndex = function (bt) {
        var td = $(bt).getParent('td'),
          tr = td.getParent('tr'),
          cols = tr.getChildren(),
          index = 0,
          i;
        for (i = 0; i < cols.length; i++) {
          if (cols[i] == td) {
            break;
          }
          index++;
        }
        return index;
      };
    makeSortable(tbody);
    thead.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
    tbody.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
    Backend.tableWizardResize();
  },
  /**
   * Resize the table wizard fields on focus
   *
   * @param {float} [factor] The resize factor
   */
  tableWizardResize: function (factor) {
    var size = window.localStorage.getItem('contao_table_wizard_cell_size');
    if (factor !== undefined) {
      size = '';
      $$('.tl_tablewizard textarea').each(function (el) {
        el.setStyle('width', (el.getStyle('width').toInt() * factor).round().limit(142, 284));
        el.setStyle('height', (el.getStyle('height').toInt() * factor).round().limit(66, 132));
        if (size == '') {
          size = el.getStyle('width') + '|' + el.getStyle('height');
        }
      });
      window.localStorage.setItem('contao_table_wizard_cell_size', size);
    } else if (size !== null) {
      var chunks = size.split('|');
      $$('.tl_tablewizard textarea').each(function (el) {
        el.setStyle('width', chunks[0]);
        el.setStyle('height', chunks[1]);
      });
    }
  },
  /**
   * Set the width of the table wizard
   */
  tableWizardSetWidth: function () {
    var wrap = $('tl_tablewizard');
    if (!wrap) return;
    wrap.setStyle('width', Math.round(wrap.getParent('.tl_formbody_edit').getComputedSize().width * 0.96));
  },
  /**
   * Options wizard
   *
   * @param {string} id The ID of the target element
   */
  optionsWizard: function (id) {
    var table = $(id),
      tbody = table.getElement('tbody'),
      makeSortable = function (tbody) {
        var rows = tbody.getChildren(),
          children,
          i,
          j,
          input;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (input = children[j].getFirst('input')) {
              input.name = input.name.replace(/\[[0-9]+]/g, '[' + i + ']');
              if (input.type == 'checkbox') {
                input.id = input.name.replace(/\[[0-9]+]/g, '').replace(/\[/g, '_').replace(/]/g, '') + '_' + i;
                input.getNext('label').set('for', input.id);
              }
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function () {
            makeSortable(tbody);
          }
        });
      },
      addEventsTo = function (tr) {
        var command, input, next, ntr, children, i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (input = children[i].getFirst('input')) {
                    next.getFirst('input').value = input.value;
                    if (input.type == 'checkbox') {
                      next.getFirst('input').checked = input.checked ? 'checked' : '';
                    }
                  }
                }
                ntr.inject(tr, 'after');
                addEventsTo(ntr);
                makeSortable(tbody);
                ntr.getFirst('td').getFirst('input').select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
              break;
          }
        });
      };
    makeSortable(tbody);
    tbody.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
  },
  /**
   * Key/value wizard
   *
   * @param {string} id The ID of the target element
   */
  keyValueWizard: function (id) {
    var table = $(id),
      tbody = table.getElement('tbody'),
      makeSortable = function (tbody) {
        var rows = tbody.getChildren(),
          children,
          i,
          j,
          input;
        for (i = 0; i < rows.length; i++) {
          children = rows[i].getChildren();
          for (j = 0; j < children.length; j++) {
            if (input = children[j].getFirst('input')) {
              input.name = input.name.replace(/\[[0-9]+]/g, '[' + i + ']');
            }
          }
        }
        new Sortables(tbody, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle',
          onComplete: function () {
            makeSortable(tbody);
          }
        });
      },
      addEventsTo = function (tr) {
        var command, input, next, ntr, children, i;
        tr.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          command = bt.getProperty('data-command');
          switch (command) {
            case 'copy':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                ntr = new Element('tr');
                children = tr.getChildren();
                for (i = 0; i < children.length; i++) {
                  next = children[i].clone(true).inject(ntr, 'bottom');
                  if (input = children[i].getFirst('input')) {
                    next.getFirst().value = input.value;
                  }
                }
                ntr.inject(tr, 'after');
                addEventsTo(ntr);
                makeSortable(tbody);
                ntr.getFirst('td').getFirst('input').select();
              });
              break;
            case 'delete':
              bt.addEvent('click', function () {
                window.dispatchEvent(new Event('store-scroll-offset'));
                if (tbody.getChildren().length > 1) {
                  tr.destroy();
                }
                makeSortable(tbody);
              });
              break;
            case null:
              bt.addEvent('keydown', function (e) {
                if (e.event.keyCode == 38) {
                  e.preventDefault();
                  if (ntr = tr.getPrevious('tr')) {
                    tr.inject(ntr, 'before');
                  } else {
                    tr.inject(tbody, 'bottom');
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (e.event.keyCode == 40) {
                  e.preventDefault();
                  if (ntr = tr.getNext('tr')) {
                    tr.inject(ntr, 'after');
                  } else {
                    tr.inject(tbody, 'top');
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
              break;
          }
        });
      };
    makeSortable(tbody);
    tbody.getChildren().each(function (tr) {
      addEventsTo(tr);
    });
  },
  /**
   * Checkbox wizard
   *
   * @param {string} id The ID of the target element
   */
  checkboxWizard: function (id) {
    var container = $(id).getElement('.sortable'),
      makeSortable = function (container) {
        new Sortables(container, {
          constrain: true,
          opacity: 0.6,
          handle: '.drag-handle'
        });
      },
      addEventsTo = function (span) {
        var nspan;
        span.getElements('button').each(function (bt) {
          if (bt.hasEvent('click')) return;
          bt.addEvent('keydown', function (e) {
            if (e.event.keyCode == 38) {
              e.preventDefault();
              if (nspan = span.getPrevious('span')) {
                span.inject(nspan, 'before');
              } else {
                span.inject(container, 'bottom');
              }
              bt.focus();
            } else if (e.event.keyCode == 40) {
              e.preventDefault();
              if (nspan = span.getNext('span')) {
                span.inject(nspan, 'after');
              } else {
                span.inject(container, 'top');
              }
              bt.focus();
            }
          });
        });
      };
    makeSortable(container);
    container.getChildren().each(function (span) {
      addEventsTo(span);
    });
  },
  /**
   * Update the fields of the imageSize widget upon change
   */
  enableImageSizeWidgets: function () {
    $$('.tl_image_size').each(function (el) {
      var select = el.getElement('select'),
        widthInput = el.getChildren('input')[0],
        heightInput = el.getChildren('input')[1],
        update = function () {
          if (select.get('value') === '' || select.get('value').indexOf('_') === 0 || select.get('value').toInt().toString() === select.get('value')) {
            widthInput.readOnly = true;
            heightInput.readOnly = true;
            var dimensions = $(select.getSelected()[0]).get('text');
            dimensions = dimensions.split('(').length > 1 ? dimensions.split('(').getLast().split(')')[0].split('x') : ['', ''];
            widthInput.set('value', '').set('placeholder', dimensions[0] * 1 || '');
            heightInput.set('value', '').set('placeholder', dimensions[1] * 1 || '');
          } else {
            widthInput.set('placeholder', '');
            heightInput.set('placeholder', '');
            widthInput.readOnly = false;
            heightInput.readOnly = false;
          }
        };
      update();
      select.addEvent('change', update);
      select.addEvent('keyup', update);
    });
  },
  /**
   * Allow toggling checkboxes or radio buttons by clicking a row
   *
   * @author Kamil Kuzminski
   */
  enableToggleSelect: function () {
    var container = $('tl_listing'),
      shiftToggle = function (el) {
        thisIndex = checkboxes.indexOf(el);
        startIndex = checkboxes.indexOf(start);
        from = Math.min(thisIndex, startIndex);
        to = Math.max(thisIndex, startIndex);
        status = !!checkboxes[startIndex].checked;
        for (from; from <= to; from++) {
          checkboxes[from].checked = status;
        }
      },
      clickEvent = function (e) {
        var input = this.getElement('input[type="checkbox"],input[type="radio"]'),
          limitToggler = $(e.target).getParent('.limit_toggler');
        if (!input || input.get('disabled') || limitToggler !== null) {
          return;
        }

        // Radio buttons
        if (input.type == 'radio') {
          if (!input.checked) {
            input.checked = 'checked';
          }
          return;
        }

        // Checkboxes
        if (e.shift && start) {
          shiftToggle(input);
        } else {
          input.checked = input.checked ? '' : 'checked';
          if (input.get('onclick') == 'Backend.toggleCheckboxes(this)') {
            Backend.toggleCheckboxes(input); // see #6399
          }
        }
        start = input;
      },
      checkboxes = [],
      start,
      thisIndex,
      startIndex,
      status,
      from,
      to;
    if (container) {
      checkboxes = container.getElements('input[type="checkbox"]');
    }

    // Row click
    $$('.toggle_select').each(function (el) {
      var boundEvent = el.retrieve('boundEvent');
      if (boundEvent) {
        el.removeEvent('click', boundEvent);
      }

      // Do not propagate the form field click events
      el.getElements('label,input[type="checkbox"],input[type="radio"]').each(function (i) {
        i.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
      boundEvent = clickEvent.bind(el);
      el.addEvent('click', boundEvent);
      el.store('boundEvent', boundEvent);
    });

    // Checkbox click
    checkboxes.each(function (el) {
      el.addEvent('click', function (e) {
        if (e.shift && start) {
          shiftToggle(this);
        }
        start = this;
      });
    });
  },
  /**
   * Allow to mark the important part of an image
   *
   * @param {object} el The DOM element
   */
  editPreviewWizard: function (el) {
    el = $(el);
    var imageElement = el.getElement('img'),
      inputElements = {},
      isDrawing = false,
      partElement,
      startPos,
      getScale = function () {
        return {
          x: imageElement.getComputedSize().width,
          y: imageElement.getComputedSize().height
        };
      },
      updateImage = function () {
        var scale = getScale(),
          imageSize = imageElement.getComputedSize();
        partElement.setStyles({
          top: imageSize.computedTop + (inputElements.y.get('value') * scale.y).round() + 'px',
          left: imageSize.computedLeft + (inputElements.x.get('value') * scale.x).round() + 'px',
          width: (inputElements.width.get('value') * scale.x).round() + 'px',
          height: (inputElements.height.get('value') * scale.y).round() + 'px'
        });
        if (!inputElements.width.get('value').toFloat() || !inputElements.height.get('value').toFloat()) {
          partElement.setStyle('display', 'none');
        } else {
          partElement.setStyle('display', null);
        }
      },
      updateValues = function () {
        var scale = getScale(),
          styles = partElement.getStyles('top', 'left', 'width', 'height'),
          imageSize = imageElement.getComputedSize(),
          values = {
            x: Math.max(0, Math.min(1, (styles.left.toFloat() - imageSize.computedLeft) / scale.x)),
            y: Math.max(0, Math.min(1, (styles.top.toFloat() - imageSize.computedTop) / scale.y))
          };
        values.width = Math.min(1 - values.x, styles.width.toFloat() / scale.x);
        values.height = Math.min(1 - values.y, styles.height.toFloat() / scale.y);
        if (!values.width || !values.height) {
          values.x = values.y = values.width = values.height = '';
          partElement.setStyle('display', 'none');
        } else {
          partElement.setStyle('display', null);
        }
        Object.each(values, function (value, key) {
          inputElements[key].set('value', value === '' ? '' : Number(value).toFixed(15));
        });
      },
      start = function (event) {
        event.preventDefault();
        if (isDrawing) {
          return;
        }
        isDrawing = true;
        startPos = {
          x: event.page.x - el.getPosition().x - imageElement.getComputedSize().computedLeft,
          y: event.page.y - el.getPosition().y - imageElement.getComputedSize().computedTop
        };
        move(event);
      },
      move = function (event) {
        if (!isDrawing) {
          return;
        }
        event.preventDefault();
        var imageSize = imageElement.getComputedSize();
        var rect = {
          x: [Math.max(0, Math.min(imageSize.width, startPos.x)), Math.max(0, Math.min(imageSize.width, event.page.x - el.getPosition().x - imageSize.computedLeft))],
          y: [Math.max(0, Math.min(imageSize.height, startPos.y)), Math.max(0, Math.min(imageSize.height, event.page.y - el.getPosition().y - imageSize.computedTop))]
        };
        partElement.setStyles({
          top: Math.min(rect.y[0], rect.y[1]) + imageSize.computedTop + 'px',
          left: Math.min(rect.x[0], rect.x[1]) + imageSize.computedLeft + 'px',
          width: Math.abs(rect.x[0] - rect.x[1]) + 'px',
          height: Math.abs(rect.y[0] - rect.y[1]) + 'px'
        });
        updateValues();
      },
      stop = function (event) {
        move(event);
        isDrawing = false;
      },
      init = function () {
        el.getParent('.tl_tbox,.tl_box').getElements('input[name^="importantPart"]').each(function (input) {
          ['x', 'y', 'width', 'height'].each(function (key) {
            if (input.get('name').substr(13, key.length) === key.capitalize()) {
              inputElements[key] = input = $(input);
            }
          });
        });
        if (Object.getLength(inputElements) !== 4) {
          return;
        }
        Object.each(inputElements, function (input) {
          input.getParent().setStyle('display', 'none');
        });
        el.addClass('tl_edit_preview_enabled');
        partElement = new Element('div', {
          'class': 'tl_edit_preview_important_part'
        }).inject(el);
        updateImage();
        imageElement.addEvent('load', updateImage);
        el.addEvents({
          mousedown: start,
          touchstart: start
        });
        $(document.documentElement).addEvents({
          mousemove: move,
          touchmove: move,
          mouseup: stop,
          touchend: stop,
          touchcancel: stop,
          resize: updateImage
        });
      };
    window.addEvent('domready', init);
  },
  /**
   * Enable drag and drop file upload for the file tree
   *
   * @param {object} wrap    The DOM element
   * @param {object} options An optional options object
   */
  enableFileTreeUpload: function (wrap, options) {
    wrap = $(wrap);
    var fallbackUrl = options.url,
      dzElement = new Element('div', {
        'class': 'dropzone dropzone-filetree',
        html: '<span class="dropzone-previews"></span>'
      }).inject(wrap, 'top'),
      currentHover,
      currentHoverTime,
      expandLink;
    options.previewsContainer = dzElement.getElement('.dropzone-previews');
    options.clickable = false;
    var dz = new Dropzone(wrap, options);
    dz.on('queuecomplete', function () {
      window.location.reload();
    });
    dz.on('dragover', function (event) {
      if (!event.dataTransfer || !event.dataTransfer.types || event.dataTransfer.types.indexOf('Files') === -1) {
        return;
      }
      wrap.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
      var target = event.target && $(event.target);
      if (target) {
        var folder = target.match('.tl_folder') ? target : target.getParent('.tl_folder');
        if (!folder) {
          folder = target.getParent('.parent');
          folder = folder && folder.getPrevious('.tl_folder');
        }
        if (folder) {
          var link = folder.getElement('img[src$="/icons/new.svg"]');
          link = link && link.getParent('a');
        }
      }
      if (link && link.href) {
        dz.options.url = '' + link.href;
        folder.addClass('tl_folder_dropping');
        if (currentHover !== folder) {
          currentHover = folder;
          currentHoverTime = new Date().getTime();
          expandLink = folder.getElement('a.foldable');
          if (expandLink && !expandLink.hasClass('foldable--open')) {
            // Expand the folder after one second hover time
            setTimeout(function () {
              if (currentHover === folder && currentHoverTime + 900 < new Date().getTime()) {
                var event = document.createEvent('HTMLEvents');
                event.initEvent('click', true, true);
                expandLink.dispatchEvent(event);
                currentHover = undefined;
                currentHoverTime = undefined;
              }
            }, 1000);
          }
        }
      } else {
        dz.options.url = fallbackUrl;
        currentHover = undefined;
        currentHoverTime = undefined;
      }
    });
    dz.on('drop', function (event) {
      if (!event.dataTransfer || !event.dataTransfer.types || event.dataTransfer.types.indexOf('Files') === -1) {
        return;
      }
      dzElement.addClass('dropzone-filetree-enabled');
      window.dispatchEvent(new Event('store-scroll-offset'));
    });
    dz.on('dragleave', function () {
      wrap.getElements('.tl_folder_dropping').removeClass('tl_folder_dropping');
      currentHover = undefined;
      currentHoverTime = undefined;
    });
  },
  /**
   * Crawl the website
   */
  crawl: function () {
    var timeout = 2000,
      crawl = $('tl_crawl'),
      progressBar = crawl.getElement('div.progress-bar'),
      progressCount = crawl.getElement('p.progress-count'),
      results = crawl.getElement('div.results'),
      debugLog = crawl.getElement('p.debug-log');
    function updateData(response) {
      var total = response.total,
        done = total - response.pending,
        percentage = total > 0 ? parseInt(done / total * 100, 10) : 100,
        result;

      // Initialize the status bar at 10%
      if (done < 1 && percentage < 1) {
        done = 1;
        percentage = 10;
        total = 10;
      }
      progressBar.setStyle('width', percentage + '%');
      progressBar.set('html', percentage + '%');
      progressBar.setAttribute('aria-valuenow', percentage);
      progressCount.set('html', done + ' / ' + total);
      if (response.hasDebugLog) {
        debugLog.setStyle('display', 'block');
      }
      if (response.hasDebugLog) {
        debugLog.setStyle('display', 'block');
      }
      if (!response.finished) {
        return;
      }
      progressBar.removeClass('running').addClass('finished');
      results.removeClass('running').addClass('finished');
      for (result in response.results) {
        if (response.results.hasOwnProperty(result)) {
          var summary = results.getElement('.result[data-subscriber="' + result + '"] p.summary'),
            warning = results.getElement('.result[data-subscriber="' + result + '"] p.warning'),
            log = results.getElement('.result[data-subscriber="' + result + '"] p.subscriber-log'),
            subscriberResults = response.results[result],
            subscriberSummary = subscriberResults.summary;
          if (subscriberResults.warning) {
            warning.set('html', subscriberResults.warning);
          }
          if (subscriberResults.hasLog) {
            log.setStyle('display', 'block');
          }
          summary.addClass(subscriberResults.wasSuccessful ? 'success' : 'failure');
          summary.set('html', subscriberSummary);
        }
      }
    }
    function execRequest() {
      let onlyStatusUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      new Request({
        url: window.location.href,
        headers: {
          'Only-Status-Update': onlyStatusUpdate
        },
        onSuccess: function (responseText) {
          var response = JSON.decode(responseText);
          updateData(response);
          if (!response.finished) {
            setTimeout(execRequest, timeout);
          }
        }
      }).send();
    }
    execRequest(true);
  }
};
window.Theme = {
  /**
   * Check for WebKit
   * @member {boolean}
  	 */
  isWebkit: Browser.chrome || Browser.safari || navigator.userAgent.match(/(?:webkit|khtml)/i),
  /**
   * Stop the propagation of click events of certain elements
   */
  stopClickPropagation: function () {
    // Do not propagate the click events of the icons
    $$('.picker_selector').each(function (ul) {
      ul.getElements('a').each(function (el) {
        el.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
    });

    // Do not propagate the click events of the checkboxes
    $$('.picker_selector,.click2edit').each(function (ul) {
      ul.getElements('input[type="checkbox"]').each(function (el) {
        el.addEvent('click', function (e) {
          e.stopPropagation();
        });
      });
    });
  },
  /**
   * Set up the textarea resizing
   */
  setupTextareaResizing: function () {
    $$('.tl_textarea').each(function (el) {
      if (Browser.ie6 || Browser.ie7 || Browser.ie8) return;
      if (el.hasClass('noresize') || el.retrieve('autogrow')) return;

      // Set up the dummy element
      var dummy = new Element('div', {
        html: 'X',
        styles: {
          'position': 'absolute',
          'top': 0,
          'left': '-999em',
          'overflow-x': 'hidden'
        }
      }).setStyles(el.getStyles('font-size', 'font-family', 'width', 'line-height')).inject(document.body);

      // Also consider the box-sizing
      if (el.getStyle('-moz-box-sizing') == 'border-box' || el.getStyle('-webkit-box-sizing') == 'border-box' || el.getStyle('box-sizing') == 'border-box') {
        dummy.setStyles({
          'padding': el.getStyle('padding'),
          'border': el.getStyle('border-left')
        });
      }

      // Single line height
      var line = Math.max(dummy.clientHeight, 30);

      // Respond to the "input" event
      el.addEvent('input', function () {
        dummy.set('html', this.get('value').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n|\r\n/g, '<br>X'));
        var height = Math.max(line, dummy.getSize().y);
        if (this.clientHeight != height) this.tween('height', height);
      }).set('tween', {
        'duration': 100
      }).setStyle('height', line + 'px');

      // Fire the event
      el.fireEvent('input');
      el.store('autogrow', true);
    });
  },
  /**
   * Set up the menu toggle
   */
  setupMenuToggle: function () {
    var burger = $('burger');
    if (!burger) return;
    burger.addEvent('click', function () {
      document.body.toggleClass('show-navigation');
      burger.setAttribute('aria-expanded', document.body.hasClass('show-navigation') ? 'true' : 'false');
    }).addEvent('keydown', function (e) {
      if (e.event.keyCode == 27) {
        document.body.removeClass('show-navigation');
      }
    });
    if (window.matchMedia) {
      var matchMedia = window.matchMedia('(max-width:991px)');
      var setAriaControls = function () {
        if (matchMedia.matches) {
          burger.setAttribute('aria-controls', 'left');
          burger.setAttribute('aria-expanded', document.body.hasClass('show-navigation') ? 'true' : 'false');
        } else {
          burger.removeAttribute('aria-controls');
          burger.removeAttribute('aria-expanded');
        }
      };
      matchMedia.addEventListener('change', setAriaControls);
      setAriaControls();
    }
  },
  /**
   * Set up the profile toggle
   */
  setupProfileToggle: function () {
    if (window.console) {
      console.warn('Theme.setupProfileToggle() is deprecated. Please use the stimulus controller instead.');
    }
    var tmenu = $('tmenu');
    if (!tmenu) return;
    var li = tmenu.getElement('.submenu'),
      button = li.getFirst('span').getFirst('button'),
      menu = li.getFirst('ul');
    if (!li || !button || !menu) return;
    button.setAttribute('aria-controls', 'tmenu__profile');
    button.setAttribute('aria-expanded', 'false');
    menu.id = 'tmenu__profile';
    button.addEvent('click', function (e) {
      if (li.hasClass('active')) {
        li.removeClass('active');
        button.setAttribute('aria-expanded', 'false');
      } else {
        li.addClass('active');
        button.setAttribute('aria-expanded', 'true');
      }
      e.stopPropagation();
    });
    $(document.body).addEvent('click', function () {
      if (li.hasClass('active')) {
        li.removeClass('active');
      }
    });
  },
  /**
   * Set up the split button toggle
   */
  setupSplitButtonToggle: function () {
    var toggle = $('sbtog');
    if (!toggle) return;
    var ul = toggle.getParent('.split-button').getElement('ul'),
      tab,
      timer;
    toggle.addEvent('click', function (e) {
      tab = false;
      ul.toggleClass('invisible');
      toggle.toggleClass('active');
      e.stopPropagation();
    });
    $(document.body).addEvent('click', function () {
      tab = false;
      ul.addClass('invisible');
      toggle.removeClass('active');
    });
    $(document.body).addEvent('keydown', function (e) {
      tab = e.event.keyCode == 9;
    });
    [toggle].append(ul.getElements('button')).each(function (el) {
      el.addEvent('focus', function () {
        if (!tab) return;
        ul.removeClass('invisible');
        toggle.addClass('active');
        clearTimeout(timer);
      });
      el.addEvent('blur', function () {
        if (!tab) return;
        timer = setTimeout(function () {
          ul.addClass('invisible');
          toggle.removeClass('active');
        }, 100);
      });
    });
    toggle.set('tabindex', '-1');
  }
};

// Initialize the back end script
window.addEvent('domready', function () {
  $(document.body).addClass('js');

  // Mark touch devices (see #5563)
  if (Browser.Features.Touch) {
    $(document.body).addClass('touch');
  }
  Backend.tableWizardSetWidth();
  Backend.enableImageSizeWidgets();
  Backend.enableToggleSelect();
  Theme.stopClickPropagation();
  Theme.setupTextareaResizing();
  Theme.setupMenuToggle();
  Theme.setupSplitButtonToggle();
});

// Resize the table wizard
window.addEvent('resize', function () {
  Backend.tableWizardSetWidth();
});

// Re-apply certain changes upon ajax_change
window.addEvent('ajax_change', function () {
  Backend.enableImageSizeWidgets();
  Backend.enableToggleSelect();
  Theme.stopClickPropagation();
  Theme.setupTextareaResizing();
});

/***/ }),

/***/ "./core-bundle/assets/scripts/limit-height.js":
/*!****************************************************!*\
  !*** ./core-bundle/assets/scripts/limit-height.js ***!
  \****************************************************/
/***/ (function() {

window.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('div.limit_height').forEach(function (div) {
    if (window.console) {
      console.warn('Using "limit_height" class on child_record_callback is deprecated. Set a list.sorting.limitHeight in your DCA instead.');
    }
    const parent = div.parentNode.closest('.tl_content');

    // Return if the element is a wrapper
    if (parent && (parent.classList.contains('wrapper_start') || parent.classList.contains('wrapper_stop'))) return;
    const hgt = Number(div.className.replace(/[^0-9]*/, ''));

    // Return if there is no height value
    if (!hgt) return;
    const style = window.getComputedStyle(div, null);
    const padding = parseFloat(style.paddingTop) + parseFloat(style.paddingBottom);
    const height = div.clientHeight - padding;

    // Do not add the toggle if the preview height is below the max-height
    if (height <= hgt) return;

    // Resize the element if it is higher than the maximum height
    div.style.height = hgt + 'px';
    const button = document.createElement('button');
    button.setAttribute('type', 'button');
    button.title = Contao.lang.expand;
    button.innerHTML = '<span>...</span>';
    button.classList.add('unselectable');
    button.addEventListener('click', function () {
      if (div.style.height == 'auto') {
        div.style.height = hgt + 'px';
        button.title = Contao.lang.expand;
      } else {
        div.style.height = 'auto';
        button.title = Contao.lang.collapse;
      }
    });
    const toggler = document.createElement('div');
    toggler.classList.add('limit_toggler');
    toggler.append(button);
    div.append(toggler);
  });
});

/***/ }),

/***/ "./core-bundle/assets/scripts/modulewizard.js":
/*!****************************************************!*\
  !*** ./core-bundle/assets/scripts/modulewizard.js ***!
  \****************************************************/
/***/ (function() {

(function () {
  'use strict';

  const initializedRows = new WeakMap();
  const saveScrollOffsetEvent = new Event('store-scroll-offset');
  const init = row => {
    // Check if this row has already been initialized
    if (initializedRows.has(row)) {
      return;
    }

    // Check if the row has all necessary elements to prevent the mutation observer
    // from initializing the incomplete widget.
    if (!row.querySelector('button.drag-handle')) {
      return;
    }
    initializedRows.set(row, true);
    const tbody = row.closest('tbody');
    const makeSortable = tbody => {
      Array.from(tbody.children).forEach((tr, i) => {
        tr.querySelectorAll('input, select').forEach(el => {
          el.name = el.name.replace(/\[[0-9]+]/g, '[' + i + ']');
        });
      });

      // TODO: replace this with a vanilla JS solution
      new Sortables(tbody, {
        constrain: true,
        opacity: 0.6,
        handle: '.drag-handle',
        onComplete: function () {
          makeSortable(tbody);
        }
      });
    };
    const addEventsTo = tr => {
      tr.querySelectorAll('button').forEach(bt => {
        const command = bt.dataset.command;
        switch (command) {
          case 'copy':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              const ntr = tr.cloneNode(true);
              const selects = tr.querySelectorAll('select');
              const nselects = ntr.querySelectorAll('select');
              for (let j = 0; j < selects.length; j++) {
                nselects[j].value = selects[j].value;
              }
              ntr.querySelectorAll('[data-original-title]').forEach(el => {
                el.setAttribute('title', el.getAttribute('data-original-title'));
                el.removeAttribute('data-original-title');
              });
              initializedRows.set(ntr, true);
              tr.parentNode.insertBefore(ntr, tr.nextSibling);
              addEventsTo(ntr);
              makeSortable(tbody);
            });
            break;
          case 'delete':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              if (tbody.children.length > 1) {
                tr.remove();
              } else {
                // Reset values for last element (#689)
                tr.querySelectorAll('select').forEach(select => {
                  select.value = select.children[0].value;
                });
              }
              makeSortable(tbody);
            });
            break;
          case 'enable':
            bt.addEventListener('click', function () {
              window.dispatchEvent(saveScrollOffsetEvent);
              const cbx = bt.previousElementSibling;
              if (cbx.checked) {
                cbx.checked = '';
              } else {
                cbx.checked = 'checked';
              }
            });
            break;
          default:
            if (bt.classList.contains('drag-handle')) {
              bt.addEventListener('keydown', event => {
                if (event.code === 'ArrowUp' || event.keyCode === 38) {
                  event.preventDefault();
                  if (tr.previousElementSibling) {
                    tr.previousElementSibling.insertAdjacentElement('beforebegin', tr);
                  } else {
                    tbody.insertAdjacentElement('beforeend', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (event.code === 'ArrowDown' || event.keyCode === 40) {
                  event.preventDefault();
                  if (tr.nextElementSibling) {
                    tr.nextElementSibling.insertAdjacentElement('afterend', tr);
                  } else {
                    tbody.insertAdjacentElement('afterbegin', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
            }
            break;
        }
      });
      const select = tr.querySelector('td:first-child select');
      if (!select) {
        return;
      }
      const link = tr.querySelector('a.module_link');
      const images = tr.querySelectorAll('img.module_image');
      const updateLink = () => {
        link.href = link.href.replace(/id=[0-9]+/, 'id=' + select.value);
        if (select.value > 0) {
          link.classList.remove('hidden');
          images.forEach(image => {
            image.classList.add('hidden');
          });
        } else {
          link.classList.add('hidden');
          images.forEach(image => {
            image.classList.remove('hidden');
          });
        }
      };
      select.addEventListener('change', updateLink);
    };
    makeSortable(tbody);
    addEventsTo(row);
  };
  document.querySelectorAll('.tl_modulewizard tr').forEach(init);
  new MutationObserver(function (mutationsList) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'childList') {
        mutation.addedNodes.forEach(function (element) {
          if (element.matches && element.matches('.tl_modulewizard tr, .tl_modulewizard tr *')) {
            init(element.closest('tr'));
          }
        });
      }
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ }),

/***/ "./core-bundle/assets/scripts/mootao.js":
/*!**********************************************!*\
  !*** ./core-bundle/assets/scripts/mootao.js ***!
  \**********************************************/
/***/ (function() {

/*
---

name: Request.Contao

description: Extends the MooTools Request.JSON class with Contao-specific routines.

license: LGPLv3

authors:
 - Leo Feyer

requires: [Request, JSON]

provides: Request.Contao

...
*/

Request.Contao = new Class({
  Extends: Request.JSON,
  options: {
    followRedirects: true,
    url: window.location.href
  },
  initialize: function (options) {
    if (options && !options.url && options.field && options.field.form && options.field.form.action) {
      this.options.url = options.field.form.action;
    }
    this.parent(options);
  },
  success: function (text) {
    var url = this.getHeader('X-Ajax-Location'),
      json;
    if (url && this.options.followRedirects) {
      location.replace(url);
      return;
    }

    // Support both plain text and JSON responses
    try {
      json = this.response.json = JSON.decode(text, this.options.secure);
    } catch (e) {
      json = {
        'content': text
      };
    }

    // Empty response
    if (json === null) {
      json = {
        'content': ''
      };
    } else if (typeof json != 'object') {
      json = {
        'content': text
      };
    }

    // Isolate scripts and execute them
    if (json.content != '') {
      json.content = json.content.stripScripts(function (script) {
        json.javascript = script.replace(/<!--|\/\/-->|<!\[CDATA\[\/\/>|<!]]>/g, '');
      });
      if (json.javascript && this.options.evalScripts) {
        Browser.exec(json.javascript);
      }
    }
    this.onSuccess(json.content, json);
  },
  failure: function () {
    var url = this.getHeader('X-Ajax-Location');
    if (url && 401 === this.status) {
      location.replace(url);
      return;
    }
    if (url && this.options.followRedirects && this.status >= 300 && this.status < 400) {
      location.replace(url);
      return;
    }
    this.onFailure();
  }
});

/*
---

name: Drag

description: Extends the base Drag class with touch support.

license: LGPLv3

authors:
 - Andreas Schempp

requires: [Drag]

provides: Drag

...
*/

Class.refactor(Drag, {
  attach: function () {
    this.handles.addEvent('touchstart', this.bound.start);
    return this.previous.apply(this, arguments);
  },
  detach: function () {
    this.handles.removeEvent('touchstart', this.bound.start);
    return this.previous.apply(this, arguments);
  },
  start: function () {
    document.addEvents({
      touchmove: this.bound.check,
      touchend: this.bound.cancel
    });
    this.previous.apply(this, arguments);
  },
  check: function (event) {
    if (this.options.preventDefault) event.preventDefault();
    var distance = Math.round(Math.sqrt(Math.pow(event.page.x - this.mouse.start.x, 2) + Math.pow(event.page.y - this.mouse.start.y, 2)));
    if (distance > this.options.snap) {
      this.cancel();
      this.document.addEvents({
        mousemove: this.bound.drag,
        mouseup: this.bound.stop
      });
      document.addEvents({
        touchmove: this.bound.drag,
        touchend: this.bound.stop
      });
      this.fireEvent('start', [this.element, event]).fireEvent('snap', this.element);
    }
  },
  cancel: function () {
    document.removeEvents({
      touchmove: this.bound.check,
      touchend: this.bound.cancel
    });
    return this.previous.apply(this, arguments);
  },
  stop: function () {
    document.removeEvents({
      touchmove: this.bound.drag,
      touchend: this.bound.stop
    });
    return this.previous.apply(this, arguments);
  }
});

/*
---

name: Sortables

description: Extends the base Sortables class with touch support.

license: LGPLv3

authors:
 - Andreas Schempp

requires: [Sortables]

provides: Sortables

...
*/

Class.refactor(Sortables, {
  initialize: function (lists, options) {
    options.dragOptions = Object.merge(options.dragOptions || {}, {
      preventDefault: options.dragOptions && options.dragOptions.preventDefault || Browser.Features.Touch
    });
    if (options.dragOptions.unDraggableTags === undefined) {
      options.dragOptions.unDraggableTags = this.options.unDraggableTags.filter(function (tag) {
        return tag != 'button';
      });
    }
    return this.previous.apply(this, arguments);
  },
  addItems: function () {
    Array.flatten(arguments).each(function (element) {
      this.elements.push(element);
      var start = element.retrieve('sortables:start', function (event) {
        this.start.call(this, event, element);
      }.bind(this));
      (this.options.handle ? element.getElement(this.options.handle) || element : element).addEvents({
        mousedown: start,
        touchstart: start
      });
    }, this);
    return this;
  },
  removeItems: function () {
    return $$(Array.flatten(arguments).map(function (element) {
      this.elements.erase(element);
      var start = element.retrieve('sortables:start');
      (this.options.handle ? element.getElement(this.options.handle) || element : element).removeEvents({
        mousedown: start,
        touchend: start
      });
      return element;
    }, this));
  },
  getClone: function (event, element) {
    if (!this.options.clone) return new Element(element.tagName).inject(document.body);
    if (typeOf(this.options.clone) == 'function') return this.options.clone.call(this, event, element, this.list);
    var clone = this.previous.apply(this, arguments);
    clone.addEvent('touchstart', function (event) {
      element.fireEvent('touchstart', event);
    });
    return clone;
  }
});

/*
---

script: Request.Queue.js

name: Request.Queue

description: Extends the base Request.Queue class and attempts to fix some issues.

license: MIT-style license

authors:
 - Leo Feyer

requires:
	- Core/Element
	- Core/Request
	- Class.Binds

provides: [Request.Queue]

...
*/

Class.refactor(Request.Queue, {
  // Do not fire the "end" event here
  onComplete: function () {
    this.fireEvent('complete', arguments);
  },
  // Call resume() instead of runNext()
  onCancel: function () {
    if (this.options.autoAdvance && !this.error) this.resume();
    this.fireEvent('cancel', arguments);
  },
  // Call resume() instead of runNext() and fire the "end" event
  onSuccess: function () {
    if (this.options.autoAdvance && !this.error) this.resume();
    this.fireEvent('success', arguments);
    if (!this.queue.length && !this.isRunning()) this.fireEvent('end');
  },
  // Call resume() instead of runNext() and fire the "end" event
  onFailure: function () {
    this.error = true;
    if (!this.options.stopOnFailure && this.options.autoAdvance) this.resume();
    this.fireEvent('failure', arguments);
    if (!this.queue.length && !this.isRunning()) this.fireEvent('end');
  },
  // Call resume() instead of runNext()
  onException: function () {
    this.error = true;
    if (!this.options.stopOnFailure && this.options.autoAdvance) this.resume();
    this.fireEvent('exception', arguments);
  }
});

/*
---

name: Contao.SerpPreview

description: Generates a SERP preview

license: LGPLv3

authors:
 - Leo Feyer

requires: [Request, JSON]

provides: Contao.SerpPreview

...
*/

Contao.SerpPreview = new Class({
  options: {
    id: 0,
    trail: null,
    titleField: null,
    titleFallbackField: null,
    aliasField: null,
    descriptionField: null,
    descriptionFallbackField: null,
    titleTag: null
  },
  shorten: function (str, max) {
    if (str.length <= max) {
      return str;
    }
    return str.substr(0, str.lastIndexOf(' ', max)) + ' …';
  },
  html2string: function (html) {
    return new DOMParser().parseFromString(html, 'text/html').body.textContent.replace(/\[-]/g, '\xAD').replace(/\[nbsp]/g, '\xA0');
  },
  getTinymce: function () {
    if (window.tinyMCE && this.options.descriptionFallbackField) {
      return window.tinyMCE.get(this.options.descriptionFallbackField);
    }
  },
  initialize: function () {
    Turbo.cache.exemptPageFromCache();
    this.options = Object.merge.apply(null, [{}, this.options].append(arguments));
    var serpTitle = $('serp_title_' + this.options.id),
      serpUrl = $('serp_url_' + this.options.id),
      serpDescription = $('serp_description_' + this.options.id),
      titleField = $(this.options.titleField),
      titleFallbackField = $(this.options.titleFallbackField),
      aliasField = $(this.options.aliasField),
      descriptionField = $(this.options.descriptionField),
      descriptionFallbackField = $(this.options.descriptionFallbackField),
      indexEmpty = this.options.trail.indexOf('›') === -1,
      titleTag = this.options.titleTag || '%s';
    titleField && titleField.addEvent('input', function () {
      if (titleField.value) {
        serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleField.value)).replace(/%%/g, '%'), 64));
      } else if (titleFallbackField && titleFallbackField.value) {
        serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleFallbackField.value)).replace(/%%/g, '%'), 64));
      } else {
        serpTitle.set('text', '');
      }
    }.bind(this));
    titleFallbackField && titleFallbackField.addEvent('input', function () {
      if (titleField && titleField.value) return;
      serpTitle.set('text', this.shorten(this.html2string(titleTag.replace(/%s/, titleFallbackField.value)).replace(/%%/g, '%'), 64));
    }.bind(this));
    aliasField && aliasField.addEvent('input', function () {
      if (aliasField.value == 'index' && indexEmpty) {
        serpUrl.set('text', this.options.trail);
      } else {
        serpUrl.set('text', this.options.trail + ' › ' + (aliasField.value || this.options.id).replace(/\//g, ' › '));
      }
    }.bind(this));
    descriptionField && descriptionField.addEvent('input', function () {
      if (descriptionField.value) {
        serpDescription.set('text', this.shorten(descriptionField.value, 160));
        return;
      }
      var editor = this.getTinymce();
      if (editor) {
        serpDescription.set('text', this.shorten(this.html2string(editor.getContent()), 160));
      } else if (descriptionFallbackField && descriptionFallbackField.value) {
        serpDescription.set('text', this.shorten(this.html2string(descriptionFallbackField.value), 160));
      } else {
        serpDescription.set('text', '');
      }
    }.bind(this));
    descriptionFallbackField && descriptionFallbackField.addEvent('input', function () {
      if (descriptionField && descriptionField.value) return;
      serpDescription.set('text', this.shorten(this.html2string(descriptionFallbackField.value), 160));
    }.bind(this));
    setTimeout(function () {
      var editor = this.getTinymce();
      editor && editor.on('keyup', function () {
        if (descriptionField && descriptionField.value) return;
        serpDescription.set('text', this.shorten(this.html2string(window.tinyMCE.activeEditor.getContent()), 160));
      }.bind(this));
    }.bind(this), 4);
  }
});

/***/ }),

/***/ "./core-bundle/assets/scripts/sectionwizard.js":
/*!*****************************************************!*\
  !*** ./core-bundle/assets/scripts/sectionwizard.js ***!
  \*****************************************************/
/***/ (function() {

(function () {
  'use strict';

  const initializedRows = new WeakMap();
  const saveScrollOffsetEvent = new Event('store-scroll-offset');
  const init = row => {
    // Check if this row has already been initialized
    if (initializedRows.has(row)) {
      return;
    }

    // Check if the row has all necessary elements to prevent the mutation observer
    // from initializing the incomplete widget.
    if (!row.querySelector('button.drag-handle')) {
      return;
    }
    initializedRows.set(row, true);
    const tbody = row.closest('tbody');
    const makeSortable = tbody => {
      Array.from(tbody.children).forEach((tr, i) => {
        tr.querySelectorAll('input, select').forEach(el => {
          el.name = el.name.replace(/\[[0-9]+]/g, '[' + i + ']');
        });
      });

      // TODO: replace this with a vanilla JS solution
      new Sortables(tbody, {
        constrain: true,
        opacity: 0.6,
        handle: '.drag-handle',
        onComplete: function () {
          makeSortable(tbody);
        }
      });
    };
    const addEventsTo = tr => {
      tr.querySelectorAll('button').forEach(bt => {
        const command = bt.dataset.command;
        switch (command) {
          case 'copy':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              const ntr = tr.cloneNode(true);
              const selects = tr.querySelectorAll('select');
              const nselects = ntr.querySelectorAll('select');
              for (let j = 0; j < selects.length; j++) {
                nselects[j].value = selects[j].value;
              }
              tr.parentNode.insertBefore(ntr, tr.nextSibling);
              addEventsTo(ntr);
              makeSortable(tbody);
            });
            break;
          case 'delete':
            bt.addEventListener('click', () => {
              window.dispatchEvent(saveScrollOffsetEvent);
              if (tbody.children.length > 1) {
                tr.remove();
              } else {
                // Reset values for last element (#689)
                tr.querySelectorAll('input').forEach(input => {
                  input.value = '';
                });
                tr.querySelectorAll('select').forEach(select => {
                  select.value = select.children[0].value;
                });
              }
              makeSortable(tbody);
            });
            break;
          default:
            if (bt.classList.contains('drag-handle')) {
              bt.addEventListener('keydown', event => {
                if (event.code === 'ArrowUp' || event.keyCode === 38) {
                  event.preventDefault();
                  if (tr.previousElementSibling) {
                    tr.previousElementSibling.insertAdjacentElement('beforebegin', tr);
                  } else {
                    tbody.insertAdjacentElement('beforeend', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                } else if (event.code === 'ArrowDown' || event.keyCode === 40) {
                  event.preventDefault();
                  if (tr.nextElementSibling) {
                    tr.nextElementSibling.insertAdjacentElement('afterend', tr);
                  } else {
                    tbody.insertAdjacentElement('afterbegin', tr);
                  }
                  bt.focus();
                  makeSortable(tbody);
                }
              });
            }
            break;
        }
      });
    };
    makeSortable(tbody);
    addEventsTo(row);
  };
  document.querySelectorAll('.tl_sectionwizard tr').forEach(init);
  new MutationObserver(function (mutationsList) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'childList') {
        mutation.addedNodes.forEach(function (element) {
          if (element.matches && element.matches('.tl_sectionwizard tr, .tl_sectionwizard tr *')) {
            init(element.closest('tr'));
          }
        });
      }
    }
  }).observe(document, {
    attributes: false,
    childList: true,
    subtree: true
  });
})();

/***/ }),

/***/ "./vendor/web-auth/webauthn-stimulus/assets/dist/controller.js":
/*!*********************************************************************!*\
  !*** ./vendor/web-auth/webauthn-stimulus/assets/dist/controller.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ default_1; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @simplewebauthn/browser */ "./node_modules/@simplewebauthn/browser/dist/bundle/index.js");


class default_1 extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  constructor() {
    super(...arguments);
    this.connect = async () => {
      var _a, _b;
      const options = {
        requestResultUrl: this.requestResultUrlValue,
        requestOptionsUrl: this.requestOptionsUrlValue,
        requestSuccessRedirectUri: (_a = this.requestSuccessRedirectUriValue) !== null && _a !== void 0 ? _a : null,
        creationResultUrl: this.creationResultUrlValue,
        creationOptionsUrl: this.creationOptionsUrlValue,
        creationSuccessRedirectUri: (_b = this.creationSuccessRedirectUriValue) !== null && _b !== void 0 ? _b : null
      };
      this._dispatchEvent('webauthn:connect', {
        options
      });
      const supportAutofill = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.browserSupportsWebAuthnAutofill)();
      if (supportAutofill && this.useBrowserAutofillValue) {
        const optionsResponseJson = await this._getPublicKeyCredentialRequestOptions({});
        if (!optionsResponseJson) {
          return;
        }
        this._processSignin(optionsResponseJson, true);
      }
    };
  }
  async signin(event) {
    console.debug(event);
    if (!(0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.browserSupportsWebAuthn)()) {
      console.debug('unsupported');
      this._dispatchEvent('webauthn:unsupported', {});
      return;
    }
    event.preventDefault();
    const optionsResponseJson = await this._getPublicKeyCredentialRequestOptions(null);
    if (!optionsResponseJson) {
      console.debug('no options');
      return;
    }
    console.debug('process');
    this._processSignin(optionsResponseJson, false);
  }
  async _processSignin(optionsResponseJson, useBrowserAutofill) {
    try {
      const authenticatorResponse = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.startAuthentication)(optionsResponseJson, useBrowserAutofill);
      this._dispatchEvent('webauthn:authenticator:response', {
        response: authenticatorResponse
      });
      const assertionResponse = await this._getAssertionResponse(authenticatorResponse);
      if (assertionResponse !== false && this.requestSuccessRedirectUriValue) {
        window.location.replace(this.requestSuccessRedirectUriValue);
      }
      console.debug('processed');
    } catch (e) {
      console.debug('failure');
      console.debug(e);
      this._dispatchEvent('webauthn:assertion:failure', {});
      return;
    }
  }
  async signup(event) {
    try {
      if (!(0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.browserSupportsWebAuthn)()) {
        this._dispatchEvent('webauthn:unsupported', {});
        return;
      }
      event.preventDefault();
      const optionsResponseJson = await this._getPublicKeyCredentialCreationOptions(null);
      if (!optionsResponseJson) {
        return;
      }
      const authenticatorResponse = await (0,_simplewebauthn_browser__WEBPACK_IMPORTED_MODULE_1__.startRegistration)(optionsResponseJson);
      this._dispatchEvent('webauthn:authenticator:response', {
        response: authenticatorResponse
      });
      const attestationResponseJSON = await this._getAttestationResponse(authenticatorResponse);
      if (attestationResponseJSON !== false && this.creationSuccessRedirectUriValue) {
        window.location.replace(this.creationSuccessRedirectUriValue);
      }
    } catch (e) {
      this._dispatchEvent('webauthn:attestation:failure', {});
      return;
    }
  }
  _dispatchEvent(name, payload) {
    this.element.dispatchEvent(new CustomEvent(name, {
      detail: payload,
      bubbles: true
    }));
  }
  _getData() {
    let data = new FormData();
    try {
      this.element.reportValidity();
      if (!this.element.checkValidity()) {
        return;
      }
      data = new FormData(this.element);
    } catch (e) {}
    function removeEmpty(obj) {
      return Object.entries(obj).filter(_ref => {
        let [, v] = _ref;
        return v !== null && v !== '';
      }).reduce((acc, _ref2) => {
        let [k, v] = _ref2;
        return Object.assign(Object.assign({}, acc), {
          [k]: v === Object(v) ? removeEmpty(v) : v
        });
      }, {});
    }
    return removeEmpty({
      username: data.get(this.usernameFieldValue),
      displayName: data.get(this.displayNameFieldValue),
      attestation: data.get(this.attestationFieldValue),
      userVerification: data.get(this.userVerificationFieldValue),
      residentKey: data.get(this.residentKeyFieldValue),
      authenticatorAttachment: data.get(this.authenticatorAttachmentFieldValue)
    });
  }
  async _getPublicKeyCredentialRequestOptions(formData) {
    return this._getOptions(this.requestOptionsUrlValue, formData);
  }
  async _getPublicKeyCredentialCreationOptions(formData) {
    return this._getOptions(this.creationOptionsUrlValue, formData);
  }
  async _getOptions(url, formData) {
    const data = formData || this._getData();
    if (!data) {
      return false;
    }
    this._dispatchEvent('webauthn:options:request', {
      data
    });
    const optionsResponse = await fetch(url, {
      headers: Object.assign({}, this.requestHeadersValue),
      method: 'POST',
      body: JSON.stringify(data)
    });
    if (!optionsResponse.ok) {
      this._dispatchEvent('webauthn:options:failure', {});
      return false;
    }
    const options = await optionsResponse.json();
    this._dispatchEvent('webauthn:options:success', {
      data: options
    });
    return options;
  }
  async _getAttestationResponse(authenticatorResponse) {
    return this._getResult(this.creationResultUrlValue, 'webauthn:attestation:', authenticatorResponse);
  }
  async _getAssertionResponse(authenticatorResponse) {
    return this._getResult(this.requestResultUrlValue, 'webauthn:assertion:', authenticatorResponse);
  }
  async _getResult(url, eventPrefix, authenticatorResponse) {
    const attestationResponse = await fetch(url, {
      headers: Object.assign({}, this.requestHeadersValue),
      method: 'POST',
      body: JSON.stringify(authenticatorResponse)
    });
    if (!attestationResponse.ok) {
      this._dispatchEvent(eventPrefix + 'failure', {});
      return false;
    }
    const attestationResponseJSON = await attestationResponse.json();
    this._dispatchEvent(eventPrefix + 'success', {
      data: attestationResponseJSON
    });
    return attestationResponseJSON;
  }
}
default_1.values = {
  requestResultUrl: {
    type: String,
    default: '/request'
  },
  requestOptionsUrl: {
    type: String,
    default: '/request/options'
  },
  requestSuccessRedirectUri: String,
  creationResultUrl: {
    type: String,
    default: '/creation'
  },
  creationOptionsUrl: {
    type: String,
    default: '/creation/options'
  },
  creationSuccessRedirectUri: String,
  usernameField: {
    type: String,
    default: 'username'
  },
  displayNameField: {
    type: String,
    default: 'displayName'
  },
  attestationField: {
    type: String,
    default: 'attestation'
  },
  userVerificationField: {
    type: String,
    default: 'userVerification'
  },
  residentKeyField: {
    type: String,
    default: 'residentKey'
  },
  authenticatorAttachmentField: {
    type: String,
    default: 'authenticatorAttachment'
  },
  useBrowserAutofill: {
    type: Boolean,
    default: false
  },
  requestHeaders: {
    type: Object,
    default: {
      'Content-Type': 'application/json',
      'Accept': 'application/json',
      'mode': 'no-cors',
      'credentials': 'include'
    }
  }
};


/***/ }),

/***/ "./core-bundle/assets/styles/backend.pcss":
/*!************************************************!*\
  !*** ./core-bundle/assets/styles/backend.pcss ***!
  \************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./node_modules/@simplewebauthn/browser/dist/bundle/index.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/dist/bundle/index.js ***!
  \*******************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WebAuthnAbortService: function() { return /* binding */ WebAuthnAbortService; },
/* harmony export */   WebAuthnError: function() { return /* binding */ WebAuthnError; },
/* harmony export */   base64URLStringToBuffer: function() { return /* binding */ base64URLStringToBuffer; },
/* harmony export */   browserSupportsWebAuthn: function() { return /* binding */ browserSupportsWebAuthn; },
/* harmony export */   browserSupportsWebAuthnAutofill: function() { return /* binding */ browserSupportsWebAuthnAutofill; },
/* harmony export */   bufferToBase64URLString: function() { return /* binding */ bufferToBase64URLString; },
/* harmony export */   platformAuthenticatorIsAvailable: function() { return /* binding */ platformAuthenticatorIsAvailable; },
/* harmony export */   startAuthentication: function() { return /* binding */ startAuthentication; },
/* harmony export */   startRegistration: function() { return /* binding */ startRegistration; }
/* harmony export */ });
/* [@simplewebauthn/browser@10.0.0] */
function bufferToBase64URLString(buffer) {
    const bytes = new Uint8Array(buffer);
    let str = '';
    for (const charCode of bytes) {
        str += String.fromCharCode(charCode);
    }
    const base64String = btoa(str);
    return base64String.replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
}

function base64URLStringToBuffer(base64URLString) {
    const base64 = base64URLString.replace(/-/g, '+').replace(/_/g, '/');
    const padLength = (4 - (base64.length % 4)) % 4;
    const padded = base64.padEnd(base64.length + padLength, '=');
    const binary = atob(padded);
    const buffer = new ArrayBuffer(binary.length);
    const bytes = new Uint8Array(buffer);
    for (let i = 0; i < binary.length; i++) {
        bytes[i] = binary.charCodeAt(i);
    }
    return buffer;
}

function browserSupportsWebAuthn() {
    return (window?.PublicKeyCredential !== undefined &&
        typeof window.PublicKeyCredential === 'function');
}

function toPublicKeyCredentialDescriptor(descriptor) {
    const { id } = descriptor;
    return {
        ...descriptor,
        id: base64URLStringToBuffer(id),
        transports: descriptor.transports,
    };
}

function isValidDomain(hostname) {
    return (hostname === 'localhost' ||
        /^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(hostname));
}

class WebAuthnError extends Error {
    constructor({ message, code, cause, name, }) {
        super(message, { cause });
        this.name = name ?? cause.name;
        this.code = code;
    }
}

function identifyRegistrationError({ error, options, }) {
    const { publicKey } = options;
    if (!publicKey) {
        throw Error('options was missing required publicKey property');
    }
    if (error.name === 'AbortError') {
        if (options.signal instanceof AbortSignal) {
            return new WebAuthnError({
                message: 'Registration ceremony was sent an abort signal',
                code: 'ERROR_CEREMONY_ABORTED',
                cause: error,
            });
        }
    }
    else if (error.name === 'ConstraintError') {
        if (publicKey.authenticatorSelection?.requireResidentKey === true) {
            return new WebAuthnError({
                message: 'Discoverable credentials were required but no available authenticator supported it',
                code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',
                cause: error,
            });
        }
        else if (publicKey.authenticatorSelection?.userVerification === 'required') {
            return new WebAuthnError({
                message: 'User verification was required but no available authenticator supported it',
                code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',
                cause: error,
            });
        }
    }
    else if (error.name === 'InvalidStateError') {
        return new WebAuthnError({
            message: 'The authenticator was previously registered',
            code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',
            cause: error,
        });
    }
    else if (error.name === 'NotAllowedError') {
        return new WebAuthnError({
            message: error.message,
            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',
            cause: error,
        });
    }
    else if (error.name === 'NotSupportedError') {
        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter((param) => param.type === 'public-key');
        if (validPubKeyCredParams.length === 0) {
            return new WebAuthnError({
                message: 'No entry in pubKeyCredParams was of type "public-key"',
                code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',
                cause: error,
            });
        }
        return new WebAuthnError({
            message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',
            code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',
            cause: error,
        });
    }
    else if (error.name === 'SecurityError') {
        const effectiveDomain = window.location.hostname;
        if (!isValidDomain(effectiveDomain)) {
            return new WebAuthnError({
                message: `${window.location.hostname} is an invalid domain`,
                code: 'ERROR_INVALID_DOMAIN',
                cause: error,
            });
        }
        else if (publicKey.rp.id !== effectiveDomain) {
            return new WebAuthnError({
                message: `The RP ID "${publicKey.rp.id}" is invalid for this domain`,
                code: 'ERROR_INVALID_RP_ID',
                cause: error,
            });
        }
    }
    else if (error.name === 'TypeError') {
        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {
            return new WebAuthnError({
                message: 'User ID was not between 1 and 64 characters',
                code: 'ERROR_INVALID_USER_ID_LENGTH',
                cause: error,
            });
        }
    }
    else if (error.name === 'UnknownError') {
        return new WebAuthnError({
            message: 'The authenticator was unable to process the specified options, or could not create a new credential',
            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',
            cause: error,
        });
    }
    return error;
}

class BaseWebAuthnAbortService {
    createNewAbortSignal() {
        if (this.controller) {
            const abortError = new Error('Cancelling existing WebAuthn API call for new one');
            abortError.name = 'AbortError';
            this.controller.abort(abortError);
        }
        const newController = new AbortController();
        this.controller = newController;
        return newController.signal;
    }
    cancelCeremony() {
        if (this.controller) {
            const abortError = new Error('Manually cancelling existing WebAuthn API call');
            abortError.name = 'AbortError';
            this.controller.abort(abortError);
            this.controller = undefined;
        }
    }
}
const WebAuthnAbortService = new BaseWebAuthnAbortService();

const attachments = ['cross-platform', 'platform'];
function toAuthenticatorAttachment(attachment) {
    if (!attachment) {
        return;
    }
    if (attachments.indexOf(attachment) < 0) {
        return;
    }
    return attachment;
}

async function startRegistration(optionsJSON) {
    if (!browserSupportsWebAuthn()) {
        throw new Error('WebAuthn is not supported in this browser');
    }
    const publicKey = {
        ...optionsJSON,
        challenge: base64URLStringToBuffer(optionsJSON.challenge),
        user: {
            ...optionsJSON.user,
            id: base64URLStringToBuffer(optionsJSON.user.id),
        },
        excludeCredentials: optionsJSON.excludeCredentials?.map(toPublicKeyCredentialDescriptor),
    };
    const options = { publicKey };
    options.signal = WebAuthnAbortService.createNewAbortSignal();
    let credential;
    try {
        credential = (await navigator.credentials.create(options));
    }
    catch (err) {
        throw identifyRegistrationError({ error: err, options });
    }
    if (!credential) {
        throw new Error('Registration was not completed');
    }
    const { id, rawId, response, type } = credential;
    let transports = undefined;
    if (typeof response.getTransports === 'function') {
        transports = response.getTransports();
    }
    let responsePublicKeyAlgorithm = undefined;
    if (typeof response.getPublicKeyAlgorithm === 'function') {
        try {
            responsePublicKeyAlgorithm = response.getPublicKeyAlgorithm();
        }
        catch (error) {
            warnOnBrokenImplementation('getPublicKeyAlgorithm()', error);
        }
    }
    let responsePublicKey = undefined;
    if (typeof response.getPublicKey === 'function') {
        try {
            const _publicKey = response.getPublicKey();
            if (_publicKey !== null) {
                responsePublicKey = bufferToBase64URLString(_publicKey);
            }
        }
        catch (error) {
            warnOnBrokenImplementation('getPublicKey()', error);
        }
    }
    let responseAuthenticatorData;
    if (typeof response.getAuthenticatorData === 'function') {
        try {
            responseAuthenticatorData = bufferToBase64URLString(response.getAuthenticatorData());
        }
        catch (error) {
            warnOnBrokenImplementation('getAuthenticatorData()', error);
        }
    }
    return {
        id,
        rawId: bufferToBase64URLString(rawId),
        response: {
            attestationObject: bufferToBase64URLString(response.attestationObject),
            clientDataJSON: bufferToBase64URLString(response.clientDataJSON),
            transports,
            publicKeyAlgorithm: responsePublicKeyAlgorithm,
            publicKey: responsePublicKey,
            authenticatorData: responseAuthenticatorData,
        },
        type,
        clientExtensionResults: credential.getClientExtensionResults(),
        authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment),
    };
}
function warnOnBrokenImplementation(methodName, cause) {
    console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${methodName}. You should report this error to them.\n`, cause);
}

function browserSupportsWebAuthnAutofill() {
    if (!browserSupportsWebAuthn()) {
        return new Promise((resolve) => resolve(false));
    }
    const globalPublicKeyCredential = window
        .PublicKeyCredential;
    if (globalPublicKeyCredential.isConditionalMediationAvailable === undefined) {
        return new Promise((resolve) => resolve(false));
    }
    return globalPublicKeyCredential.isConditionalMediationAvailable();
}

function identifyAuthenticationError({ error, options, }) {
    const { publicKey } = options;
    if (!publicKey) {
        throw Error('options was missing required publicKey property');
    }
    if (error.name === 'AbortError') {
        if (options.signal instanceof AbortSignal) {
            return new WebAuthnError({
                message: 'Authentication ceremony was sent an abort signal',
                code: 'ERROR_CEREMONY_ABORTED',
                cause: error,
            });
        }
    }
    else if (error.name === 'NotAllowedError') {
        return new WebAuthnError({
            message: error.message,
            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',
            cause: error,
        });
    }
    else if (error.name === 'SecurityError') {
        const effectiveDomain = window.location.hostname;
        if (!isValidDomain(effectiveDomain)) {
            return new WebAuthnError({
                message: `${window.location.hostname} is an invalid domain`,
                code: 'ERROR_INVALID_DOMAIN',
                cause: error,
            });
        }
        else if (publicKey.rpId !== effectiveDomain) {
            return new WebAuthnError({
                message: `The RP ID "${publicKey.rpId}" is invalid for this domain`,
                code: 'ERROR_INVALID_RP_ID',
                cause: error,
            });
        }
    }
    else if (error.name === 'UnknownError') {
        return new WebAuthnError({
            message: 'The authenticator was unable to process the specified options, or could not create a new assertion signature',
            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',
            cause: error,
        });
    }
    return error;
}

async function startAuthentication(optionsJSON, useBrowserAutofill = false) {
    if (!browserSupportsWebAuthn()) {
        throw new Error('WebAuthn is not supported in this browser');
    }
    let allowCredentials;
    if (optionsJSON.allowCredentials?.length !== 0) {
        allowCredentials = optionsJSON.allowCredentials?.map(toPublicKeyCredentialDescriptor);
    }
    const publicKey = {
        ...optionsJSON,
        challenge: base64URLStringToBuffer(optionsJSON.challenge),
        allowCredentials,
    };
    const options = {};
    if (useBrowserAutofill) {
        if (!(await browserSupportsWebAuthnAutofill())) {
            throw Error('Browser does not support WebAuthn autofill');
        }
        const eligibleInputs = document.querySelectorAll("input[autocomplete$='webauthn']");
        if (eligibleInputs.length < 1) {
            throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');
        }
        options.mediation = 'conditional';
        publicKey.allowCredentials = [];
    }
    options.publicKey = publicKey;
    options.signal = WebAuthnAbortService.createNewAbortSignal();
    let credential;
    try {
        credential = (await navigator.credentials.get(options));
    }
    catch (err) {
        throw identifyAuthenticationError({ error: err, options });
    }
    if (!credential) {
        throw new Error('Authentication was not completed');
    }
    const { id, rawId, response, type } = credential;
    let userHandle = undefined;
    if (response.userHandle) {
        userHandle = bufferToBase64URLString(response.userHandle);
    }
    return {
        id,
        rawId: bufferToBase64URLString(rawId),
        response: {
            authenticatorData: bufferToBase64URLString(response.authenticatorData),
            clientDataJSON: bufferToBase64URLString(response.clientDataJSON),
            signature: bufferToBase64URLString(response.signature),
            userHandle,
        },
        type,
        clientExtensionResults: credential.getClientExtensionResults(),
        authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment),
    };
}

function platformAuthenticatorIsAvailable() {
    if (!browserSupportsWebAuthn()) {
        return new Promise((resolve) => resolve(false));
    }
    return PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();
}




/***/ }),

/***/ "./node_modules/@stimulus-components/color-picker/dist/stimulus-color-picker.mjs":
/*!***************************************************************************************!*\
  !*** ./node_modules/@stimulus-components/color-picker/dist/stimulus-color-picker.mjs ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ ColorPicker; }
/* harmony export */ });
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _simonwep_pickr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @simonwep/pickr */ "./node_modules/@simonwep/pickr/dist/pickr.min.js");


const _ColorPicker = class _ColorPicker extends _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Controller {
  initialize() {
    this.onSave = this.onSave.bind(this);
  }
  connect() {
    this.picker = _simonwep_pickr__WEBPACK_IMPORTED_MODULE_1__.create({
      el: this.buttonTarget,
      theme: this.themeValue,
      default: this.inputTarget.value,
      swatches: this.swatches,
      components: this.componentOptions
    }), this.picker.on("save", this.onSave);
  }
  disconnect() {
    this.picker.destroy();
  }
  onSave(color) {
    this.inputTarget.value = null, color && (this.inputTarget.value = color.toHEXA().toString()), this.picker.hide();
  }
  get componentOptions() {
    return {
      preview: !0,
      hue: !0,
      interaction: {
        input: !0,
        clear: !0,
        save: !0
      }
    };
  }
  get swatches() {
    return [
      "#A0AEC0",
      "#F56565",
      "#ED8936",
      "#ECC94B",
      "#48BB78",
      "#38B2AC",
      "#4299E1",
      "#667EEA",
      "#9F7AEA",
      "#ED64A6"
    ];
  }
};
_ColorPicker.targets = ["button", "input"], _ColorPicker.values = {
  theme: {
    type: String,
    default: "classic"
  }
};
let ColorPicker = _ColorPicker;



/***/ }),

/***/ "./node_modules/accessible-menu/dist/accessible-menu.es.js":
/*!*****************************************************************!*\
  !*** ./node_modules/accessible-menu/dist/accessible-menu.es.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": function() { return /* binding */ Y; }
/* harmony export */ });
var N = Object.defineProperty;
var j = (r, t, e) => t in r ? N(r, t, { enumerable: !0, configurable: !0, writable: !0, value: e }) : r[t] = e;
var u = (r, t, e) => j(r, typeof t != "symbol" ? t + "" : t, e);
function v(r, t) {
  typeof r == "string" ? t.classList.add(r) : t.classList.add(...r);
}
function w(r, t) {
  typeof r == "string" ? t.classList.remove(r) : t.classList.remove(...r);
}
function k(r, t) {
  try {
    if (typeof t != "object") {
      const e = typeof t;
      throw new TypeError(
        `Elements given to isValidInstance() must be inside of an object. "${e}" given.`
      );
    }
    for (const e in t)
      if (!(t[e] instanceof r)) {
        const s = typeof t[e];
        throw new TypeError(
          `${e} must be an instance of ${r.name}. "${s}" given.`
        );
      }
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function p(r, t) {
  try {
    if (typeof t != "object") {
      const e = typeof t;
      throw new TypeError(
        `Values given to isValidType() must be inside of an object. "${e}" given.`
      );
    }
    for (const e in t) {
      const s = typeof t[e];
      if (s !== r)
        throw new TypeError(`${e} must be a ${r}. "${s}" given.`);
    }
    return {
      status: !0,
      error: null
    };
  } catch (e) {
    return {
      status: !1,
      error: e
    };
  }
}
function D(r) {
  try {
    if (typeof r != "object") {
      const t = typeof r;
      throw new TypeError(
        `Values given to isQuerySelector() must be inside of an object. "${t}" given.`
      );
    }
    for (const t in r)
      try {
        if (r[t] === null)
          throw new Error();
        document.querySelector(r[t]);
      } catch {
        throw new TypeError(
          `${t} must be a valid query selector. "${r[t]}" given.`
        );
      }
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function S(r) {
  try {
    if (typeof r != "object" || Array.isArray(r)) {
      const t = typeof r;
      throw new TypeError(
        `Values given to isValidClassList() must be inside of an object. "${t}" given.`
      );
    }
    for (const t in r) {
      const e = typeof r[t];
      if (e !== "string")
        if (Array.isArray(r[t]))
          r[t].forEach((s) => {
            if (typeof s != "string")
              throw new TypeError(
                `${t} must be a string or an array of strings. An array containing non-strings given.`
              );
          });
        else
          throw new TypeError(
            `${t} must be a string or an array of strings. "${e}" given.`
          );
      else {
        const s = {};
        s[t] = r[t], D(s);
      }
    }
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function V(r) {
  try {
    if (typeof r != "object") {
      const e = typeof r;
      throw new TypeError(
        `Values given to isValidState() must be inside of an object. "${e}" given.`
      );
    }
    const t = ["none", "self", "child"];
    for (const e in r)
      if (!t.includes(r[e]))
        throw new TypeError(
          `${e} must be one of the following values: ${t.join(
            ", "
          )}. "${r[e]}" given.`
        );
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function R(r) {
  try {
    if (typeof r != "object") {
      const e = typeof r;
      throw new TypeError(
        `Values given to isValidEvent() must be inside of an object. "${e}" given.`
      );
    }
    const t = ["none", "mouse", "keyboard", "character"];
    for (const e in r)
      if (!t.includes(r[e]))
        throw new TypeError(
          `${e} must be one of the following values: ${t.join(
            ", "
          )}. "${r[e]}" given.`
        );
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function H(r) {
  try {
    if (typeof r != "object") {
      const e = typeof r;
      throw new TypeError(
        `Values given to isValidHoverType() must be inside of an object. "${e}" given.`
      );
    }
    const t = ["off", "on", "dynamic"];
    for (const e in r)
      if (!t.includes(r[e]))
        throw new TypeError(
          `${e} must be one of the following values: ${t.join(
            ", "
          )}. "${r[e]}" given.`
        );
    return {
      status: !0,
      error: null
    };
  } catch (t) {
    return {
      status: !1,
      error: t
    };
  }
}
function x(r, t) {
  if (p("string", { tagName: r }).status && k(HTMLElement, t).status) {
    const e = r.toLowerCase();
    let s = !0;
    for (const n in t)
      t[n].tagName.toLowerCase() !== e && (s = !1);
    return s;
  } else
    return !1;
}
class A {
  /**
   * Constructs a new `BaseMenuToggle`.
   *
   * @param {object}      options                     - The options for generating the menu toggle.
   * @param {HTMLElement} options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement} options.parentElement       - The element containing the controlled menu.
   * @param {BaseMenu}    options.controlledMenu      - The menu controlled by this toggle.
   * @param {?BaseMenu}   [options.parentMenu = null] - The menu containing this toggle.
   */
  constructor({
    menuToggleElement: t,
    parentElement: e,
    controlledMenu: s,
    parentMenu: n = null
  }) {
    /**
     * The DOM elements within the menu toggle.
     *
     * @protected
     *
     * @type {Object<HTMLElement>}
     *
     * @property {HTMLElement} toggle - The menu toggle.
     * @property {HTMLElement} parent - The menu containing this toggle.
     */
    u(this, "_dom", {
      toggle: null,
      parent: null
    });
    /**
     * The declared accessible-menu elements within the menu toggle.
     *
     * @protected
     *
     * @type {Object<BaseMenu>}
     *
     * @property {BaseMenu} controlledMenu - The menu controlled by this toggle.
     * @property {BaseMenu} parentMenu     - The menu containing this toggle.
     */
    u(this, "_elements", {
      controlledMenu: null,
      parentMenu: null
    });
    /**
     * The open state of the menu toggle.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_open", !1);
    /**
     * The event that is triggered when the menu toggle expands.
     *
     * @protected
     *
     * @event accessibleMenuExpand
     *
     * @type {CustomEvent}
     *
     * @property {boolean}                bubbles - A flag to bubble the event.
     * @property {Object<BaseMenuToggle>} details - The details object containing the BaseMenuToggle itself.
     */
    u(this, "_expandEvent", new CustomEvent("accessibleMenuExpand", {
      bubbles: !0,
      detail: { toggle: this }
    }));
    /**
     * The event that is triggered when the menu toggle collapses.
     *
     * @protected
     *
     * @event accessibleMenuCollapse
     *
     * @type {CustomEvent}
     *
     * @property {boolean}                bubbles - A flag to bubble the event.
     * @property {Object<BaseMenuToggle>} details - The details object containing the BaseMenuToggle itself.
     */
    u(this, "_collapseEvent", new CustomEvent("accessibleMenuCollapse", {
      bubbles: !0,
      detail: { toggle: this }
    }));
    this._dom.toggle = t, this._dom.parent = e, this._elements.controlledMenu = s, this._elements.parentMenu = n;
  }
  /**
   * Initializes the menu toggle.
   *
   * The first steps are to ensure that the toggle and controlled menu have IDs
   * using the setIds method, and to set the ARIA attributes on the toggle
   * and controlled menu using the setAriaAttributes method.
   *
   * Then the collapse method is called to make sure the submenu is closed.
   */
  initialize() {
    this._setIds(), this._setAriaAttributes(), this._collapse(!1);
  }
  /**
   * The DOM elements within the toggle.
   *
   * @readonly
   *
   * @type {Object<HTMLElement>}
   *
   * @see _dom
   */
  get dom() {
    return this._dom;
  }
  /**
   * The declared accessible-menu elements within the toggle.
   *
   * @readonly
   *
   * @type {Object<BaseMenu>}
   *
   * @see _elements
   */
  get elements() {
    return this._elements;
  }
  /**
   * The open state on the toggle.
   *
   * @type {boolean}
   *
   * @see _open
   */
  get isOpen() {
    return this._open;
  }
  set isOpen(t) {
    p("boolean", { value: t }), this._open = t;
  }
  /**
   * Sets unique IDs for the toggle and controlled menu.
   *
   * If the toggle and controlled menu do not have IDs, the following steps take place:
   * - Generate a random string 1-10 characters long,
   * - Get the innerText of the toggle,
   * - Set the toggle's ID to: `menu-button-${toggle-inner-text}-${the-random-string}`
   * - Set the menu's ID to: `menu-${toggle-inner-text}-${the-random-string}`
   *
   * @protected
   */
  _setIds() {
    var t;
    if (this.dom.toggle.id === "" || this.elements.controlledMenu.dom.menu.id === "") {
      const e = Math.random().toString(36).replace(/[^a-z]+/g, "").substring(0, 10);
      let s = ((t = this.dom.toggle.innerText) == null ? void 0 : t.replace(/[^a-zA-Z0-9\s]/g, "")) || "", n = e;
      !s.replace(/\s/g, "").length && this.dom.toggle.getAttribute("aria-label") && (s = this.dom.toggle.getAttribute("aria-label").replace(/[^a-zA-Z0-9\s]/g, "")), s.replace(/\s/g, "").length > 0 && (s = s.toLowerCase().replace(/\s+/g, "-"), s.startsWith("-") && (s = s.substring(1)), s.endsWith("-") && (s = s.slice(0, -1)), n = `${s}-${n}`), this.dom.toggle.id = this.dom.toggle.id || `menu-button-${n}`, this.elements.controlledMenu.dom.menu.id = this.elements.controlledMenu.dom.menu.id || `menu-${n}`;
    }
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * The first steps are to ensure that the toggle has `aria-expanded`
   * is initially set to "false".
   *
   * Then using the toggle and menu's IDs, the menu's `aria-labelledby` is set to
   * the toggle's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    this.dom.toggle.setAttribute("aria-expanded", "false"), this.elements.controlledMenu.dom.menu.setAttribute(
      "aria-labelledby",
      this.dom.toggle.id
    );
  }
  /**
   * Expands the controlled menu.
   *
   * Sets the toggle's `aria-expanded` to "true", adds the
   * open class to the toggle's parent menu item
   * and controlled menu, and removes the closed class
   * from the toggle's parent menu item and controlled menu.
   *
   * If `emit` is set to `true`, this will also emit a custom event
   * called accessibleMenuExpand
   *
   * @protected
   *
   * @fires accessibleMenuExpand
   *
   * @param {boolean} [emit = true] - A toggle to emit the expand event once expanded.
   */
  _expand(t = !0) {
    const { closeClass: e, openClass: s, transitionClass: n } = this.elements.controlledMenu;
    this.dom.toggle.setAttribute("aria-expanded", "true"), this.elements.controlledMenu.elements.rootMenu.hasOpened = !0, n !== "" ? (v(n, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
      e !== "" && w(e, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
        s !== "" && v(s, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
          w(n, this.elements.controlledMenu.dom.menu);
        });
      });
    })) : (s !== "" && v(s, this.elements.controlledMenu.dom.menu), e !== "" && w(e, this.elements.controlledMenu.dom.menu)), t && this.dom.toggle.dispatchEvent(this._expandEvent);
  }
  /**
   * Collapses the controlled menu.
   *
   * Sets the toggle's `aria-expanded` to "false", adds the
   * closed class to the toggle's parent menu item
   * and controlled menu, and removes the open class
   * from the toggle's parent menu item and controlled menu.
   *
   * If `emit` is set to `true`, this will also emit a custom event
   * called accessibleMenuCollapse
   *
   * @protected
   *
   * @fires accessibleMenuCollapse
   *
   * @param {boolean} [emit = true] - A toggle to emit the collapse event once collapsed.
   */
  _collapse(t = !0) {
    const { closeClass: e, openClass: s, transitionClass: n } = this.elements.controlledMenu;
    this.dom.toggle.setAttribute("aria-expanded", "false"), n !== "" ? (v(n, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
      s !== "" && w(s, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
        e !== "" && v(e, this.elements.controlledMenu.dom.menu), requestAnimationFrame(() => {
          w(n, this.elements.controlledMenu.dom.menu);
        });
      });
    })) : (e !== "" && v(e, this.elements.controlledMenu.dom.menu), s !== "" && w(s, this.elements.controlledMenu.dom.menu)), t && this.dom.toggle.dispatchEvent(this._collapseEvent);
  }
  /**
   * Opens the controlled menu.
   *
   * Sets the controlled menu's focus state to "self"
   * and the parent menu's focus state to "child", calls expand,
   * and sets the isOpen value to `true`.
   *
   * @public
   */
  open() {
    this.elements.controlledMenu.focusState = "self", this.isOpen || (this._expand(), this.isOpen = !0);
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Sets the controlled menu's focus state to "self"
   * and the parent menu's focus state to "child",
   * and calls expand.
   *
   * @public
   */
  preview() {
    this.elements.parentMenu && (this.elements.parentMenu.focusState = "self"), this.isOpen || (this._expand(), this.isOpen = !0);
  }
  /**
   * Closes the controlled menu.
   *
   * Sets the controlled menu's focus state to "none"
   * and the parent menu's focus state to "self", blurs the controlled menu
   * and sets it's current child index to 0,
   * calls collapse, and sets
   * the isOpen value to `false`.
   *
   * @public
   */
  close() {
    this.isOpen && (this.elements.controlledMenu.blur(), this.elements.parentMenu && (this.elements.parentMenu.focusState = "self"), this._collapse(), this.isOpen = !1);
  }
  /**
   * Toggles the open state of the controlled menu between `true` and `false`.
   *
   * @public
   */
  toggle() {
    this.isOpen ? this.close() : this.open();
  }
  /**
   * Closes all sibling menus.
   *
   * @public
   */
  closeSiblings() {
    this.elements.parentMenu && this.elements.parentMenu.elements.submenuToggles.forEach((t) => {
      t !== this && t.close();
    });
  }
  /**
   * Closes all child menus.
   *
   * @public
   */
  closeChildren() {
    this.elements.controlledMenu.elements.submenuToggles.forEach(
      (t) => t.close()
    );
  }
}
class L {
  /**
   * Constructs a new `BaseMenuItem`.
   *
   * @param {object}          options                         - The options for generating the menu item.
   * @param {HTMLElement}     options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}     options.menuLinkElement         - The menu item's link in the DOM.
   * @param {BaseMenu}        options.parentMenu              - The parent menu.
   * @param {boolean}         [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?BaseMenu}       [options.childMenu = null]      - The child menu.
   * @param {?BaseMenuToggle} [options.toggle = null]         - The controller for the child menu.
   */
  constructor({
    menuItemElement: t,
    menuLinkElement: e,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: o = null
  }) {
    /**
     * The DOM elements within the menu item.
     *
     * @protected
     *
     * @type {Object<HTMLElement>}
     *
     * @property {HTMLElement} item - The menu item.
     * @property {HTMLElement} link - The menu item's link.
     */
    u(this, "_dom", {
      item: null,
      link: null
    });
    /**
     * The declared accessible-menu elements within the menu item.
     *
     * @protected
     *
     * @type {Object<BaseMenu, BaseMenuToggle>}
     *
     * @property {BaseMenu}        parentMenu - The menu containing this menu item.
     * @property {?BaseMenu}       childMenu  - The menu contained within this menu item.
     * @property {?BaseMenuToggle} toggle     - The menu toggle within this menu item that controls the `childMenu`.
     */
    u(this, "_elements", {
      parentMenu: null,
      childMenu: null,
      toggle: null
    });
    /**
     * A flag marking a submenu item.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_submenu", !1);
    this._dom.item = t, this._dom.link = e, this._elements.parentMenu = s, this._elements.childMenu = i, this._elements.toggle = o, this._submenu = n;
  }
  /**
   * Initialize the menu item.
   */
  initialize() {
  }
  /**
   * The DOM elements within the menu item.
   *
   * @readonly
   *
   * @type {Object<HTMLElement>}
   *
   * @see _dom
   */
  get dom() {
    return this._dom;
  }
  /**
   * The declared accessible-menu elements within the menu item.
   *
   * @readonly
   *
   * @type {Object<BaseMenu, BaseMenuToggle>}
   *
   * @see _elements
   */
  get elements() {
    return this._elements;
  }
  /**
   * A flag marking a submenu item.
   *
   * @readonly
   *
   * @type {boolean}
   *
   * @see _submenu
   */
  get isSubmenuItem() {
    return this._submenu;
  }
  /**
   * Focuses the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * @public
   */
  focus() {
    this.elements.parentMenu.shouldFocus && requestAnimationFrame(() => {
      this.dom.link.focus();
    });
  }
  /**
   * Blurs the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * @public
   */
  blur() {
    this.elements.parentMenu.shouldFocus && requestAnimationFrame(() => {
      this.dom.link.blur();
    });
  }
}
function g(r) {
  try {
    const t = r.key || r.keyCode, e = {
      Enter: t === "Enter" || t === 13,
      Space: t === " " || t === "Spacebar" || t === 32,
      Escape: t === "Escape" || t === "Esc" || t === 27,
      ArrowUp: t === "ArrowUp" || t === "Up" || t === 38,
      ArrowRight: t === "ArrowRight" || t === "Right" || t === 39,
      ArrowDown: t === "ArrowDown" || t === "Down" || t === 40,
      ArrowLeft: t === "ArrowLeft" || t === "Left" || t === 37,
      Home: t === "Home" || t === 36,
      End: t === "End" || t === 35,
      Character: isNaN(t) && !!t.match(/^[a-zA-Z]{1}$/),
      Tab: t === "Tab" || t === 9,
      Asterisk: t === "*" || t === 56
    };
    return Object.keys(e).find((s) => e[s] === !0) || "";
  } catch {
    return "";
  }
}
function l(r) {
  r.preventDefault(), r.stopPropagation();
}
class I {
  /**
   * Constructs a new `BaseMenu`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = a]        - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {boolean}            [options.isTopLevel = false]               - A flag to mark the root menu.
   * @param {?BaseMenu}          [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in miliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening menus if the menu is hoverable (in miliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing menus if the menu is hoverable (in miliseconds).
   */
  constructor({
    menuElement: t,
    menuItemSelector: e = "li",
    menuLinkSelector: s = "a",
    submenuItemSelector: n = "li:has(ul)",
    submenuToggleSelector: i = "a",
    submenuSelector: o = "ul",
    controllerElement: h = null,
    containerElement: m = null,
    openClass: c = "show",
    closeClass: a = "hide",
    transitionClass: d = "transitioning",
    isTopLevel: f = !0,
    parentMenu: y = null,
    hoverType: M = "off",
    hoverDelay: b = 250,
    enterDelay: _ = -1,
    leaveDelay: C = -1
  }) {
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof BaseMenu}
     */
    u(this, "_MenuType", I);
    // eslint-disable-line no-use-before-define
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof BaseMenuItem}
     */
    u(this, "_MenuItemType", L);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof BaseMenuToggle}
     */
    u(this, "_MenuToggleType", A);
    /**
     * The DOM elements within the menu.
     *
     * @protected
     *
     * @type {Object<HTMLElement, HTMLElement[]>}
     *
     * @property {HTMLElement}   menu           - The menu element.
     * @property {HTMLElement[]} menuItems      - An array of menu items.
     * @property {HTMLElement[]} submenuItems   - An array of menu items that also contain submenu elements.
     * @property {HTMLElement[]} submenuToggles - An array of menu links that function as submenu toggles.
     * @property {HTMLElement[]} submenus       - An array of submenu elements.
     * @property {HTMLElement}   controller     - The toggle for this menu.
     * @property {HTMLElement}   container      - The container for this menu.
     */
    u(this, "_dom", {
      menu: null,
      menuItems: [],
      submenuItems: [],
      submenuToggles: [],
      submenus: [],
      controller: null,
      container: null
    });
    /**
     * The query selectors used by the menu to populate the dom.
     *
     * @protected
     *
     * @type {Object<string>}
     *
     * @property {string} menuItems      - The query selector for menu items.
     * @property {string} menuLinks      - The query selector for menu links.
     * @property {string} submenuItems   - The query selector for menu items containing submenus.
     * @property {string} submenuToggles - The query selector for menu links that function as submenu toggles.
     * @property {string} submenus       - The query selector for for submenus.
     */
    u(this, "_selectors", {
      menuItems: "",
      menuLinks: "",
      submenuItems: "",
      submenuToggles: "",
      submenus: ""
    });
    /**
     * The declared accessible-menu elements within the menu.
     *
     * @protected
     *
     * @type {Object<BaseMenu, BaseMenuToggle, BaseMenuItem[], BaseMenuToggle[]>}
     *
     * @property {BaseMenuItem[]}   menuItems      - An array of menu items.
     * @property {BaseMenuToggle[]} submenuToggles - An array of menu toggles.
     * @property {?BaseMenuToggle}  controller     - A menu toggle that controls this menu.
     * @property {?BaseMenu}        parentMenu     - The parent menu.
     * @property {?BaseMenu}        rootMenu       - The root menu of the menu tree.
     */
    u(this, "_elements", {
      menuItems: [],
      submenuToggles: [],
      controller: null,
      parentMenu: null,
      rootMenu: null
    });
    /**
     * The class(es) to apply when the menu is open.
     *
     * @protected
     *
     * @type {string|string[]}
     */
    u(this, "_openClass", "show");
    /**
     * The class(es) to apply when the menu is closed.
     *
     * @protected
     *
     * @type {string|string[]}
     */
    u(this, "_closeClass", "hide");
    /**
     * The class(es) to apply when the menu is transitioning between states.
     *
     * @protected
     *
     * @type {string|string[]}
     */
    u(this, "_transitionClass", "transitioning");
    /**
     * A flag marking the root menu.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_root", !0);
    /**
     * The index of the currently selected menu item in the menu.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_currentChild", 0);
    /**
     * The current state of the menu's focus.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_focusState", "none");
    /**
     * This last event triggered on the menu.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_currentEvent", "none");
    /**
     * The type of hoverability for the menu.
     *
     * @protected
     *
     * @type {string}
     */
    u(this, "_hoverType", "off");
    /**
     * The delay time (in miliseconds) used for pointerenter/pointerleave events to take place.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_hoverDelay", 250);
    /**
     * The delay time (in miliseconds) used for pointerenter events to take place.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_enterDelay", -1);
    /**
     * The delay time (in miliseconds) used for pointerleave events to take place.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_leaveDelay", -1);
    /**
     * A variable to hold the hover timeout function.
     *
     * @protected
     *
     * @type {?Function}
     */
    u(this, "_hoverTimeout", null);
    /**
     * A flag to check if the menu can dynamically hover based on if a menu has been opened already.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_hasOpened", !1);
    /**
     * An array of error messages generated by the menu.
     *
     * @protected
     *
     * @type {string[]}
     */
    u(this, "_errors", []);
    this._dom.menu = t, this._dom.controller = h, this._dom.container = m, this._selectors.menuItems = e, this._selectors.menuLinks = s, this._selectors.submenuItems = n, this._selectors.submenuToggles = i, this._selectors.submenus = o, this._elements.menuItems = [], this._elements.submenuToggles = [], this._elements.controller = null, this._elements.parentMenu = y, this._elements.rootMenu = f ? this : null, this._openClass = c || "", this._closeClass = a || "", this._transitionClass = d || "", this._root = f, this._hoverType = M, this._hoverDelay = b, this._enterDelay = _, this._leaveDelay = C;
  }
  /**
   * Initializes the menu.
   *
   * The following steps will be taken to initialize the menu:
   * - Validate that the menu can initialize.
   * - Find the root menu of the menu tree if it isn't already set.
   * - Populate all DOM elements within the dom.
   * - If the current menu is the root menu _and_ has a controller, initialize
   *   the controller.
   * - Populate the menu elements within the elements.
   *
   * @public
   *
   * @throws {Error} Will throw an Error if validate returns `false`.
   */
  initialize() {
    if (!this._validate())
      throw new Error(
        `AccesibleMenu: cannot initialize menu. The following errors have been found:
 - ${this.errors.join(
          `
 - `
        )}`
      );
    if (this.elements.rootMenu === null && this._findRootMenu(this), this._setDOMElements(), this.isTopLevel && this.dom.controller && this.dom.container) {
      const t = new this._MenuToggleType({
        menuToggleElement: this.dom.controller,
        parentElement: this.dom.container,
        controlledMenu: this
      });
      x("button", { toggle: t.dom.toggle }) || t.dom.toggle.setAttribute("role", "button"), t.dom.toggle.setAttribute("aria-controls", this.dom.menu.id), this._elements.controller = t;
    }
    this._createChildElements();
  }
  /**
   * The DOM elements within the menu.
   *
   * @readonly
   *
   * @type {Object<HTMLElement, HTMLElement[]>}
   *
   * @see _dom
   */
  get dom() {
    return this._dom;
  }
  /**
   * The query selectors used by the menu to populate the dom.
   *
   * @readonly
   *
   * @type {Object<string>}
   *
   * @see _selectors
   */
  get selectors() {
    return this._selectors;
  }
  /**
   * The declared accessible-menu elements within the menu.
   *
   * @readonly
   *
   * @type {Object<BaseMenu, BaseMenuToggle, BaseMenuItem[], BaseMenuToggle[]>}
   *
   * @see _elements
   */
  get elements() {
    return this._elements;
  }
  /**
   * The flag marking the root menu.
   *
   * @readonly
   *
   * @type {boolean}
   *
   * @see _root
   */
  get isTopLevel() {
    return this._root;
  }
  /**
   * The class(es) to apply when the menu is open.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's open class(es).
   *
   * @type {string|string[]}
   *
   * @see _openClass
   */
  get openClass() {
    return this.isTopLevel ? this._openClass : this.elements.rootMenu.openClass;
  }
  /**
   * The class(es) to apply when the menu is closed.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's close class(es).
   *
   * @type {string|string[]}
   *
   * @see _closeClass
   */
  get closeClass() {
    return this.isTopLevel ? this._closeClass : this.elements.rootMenu.closeClass;
  }
  /**
   * The class(es) to apply when the menu is transitioning between open and closed.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's transition class(es).
   *
   * @type {string|string[]}
   *
   * @see _transitionClass
   */
  get transitionClass() {
    return this.isTopLevel ? this._transitionClass : this.elements.rootMenu.transitionClass;
  }
  /**
   * The index of the currently selected menu item in the menu.
   *
   * - Attempting to set a value less than -1 will set the current child to -1.
   * - Attempting to set a value greater than or equal to the number of menu items
   *   will set the current child to the index of the last menu item in the menu.
   *
   * If the current menu has a parent menu _and_ the menu's
   * current event is "mouse", The parent menu
   * will have it's current child updated as well to help with transitioning
   * between mouse and keyboard naviation.
   *
   * @type {number}
   *
   * @see _currentChild
   */
  get currentChild() {
    return this._currentChild;
  }
  /**
   * The current state of the menu's focus.
   *
   * - If the menu has submenus, setting the focus state to "none" or "self" will
   *   update all child menus to have the focus state of "none".
   * - If the menu has a parent menu, setting the focus state to "self" or "child"
   *   will update all parent menus to have the focus state of "child".
   *
   * @type {string}
   *
   * @see _focusState
   */
  get focusState() {
    return this._focusState;
  }
  /**
   * The last event triggered on the menu.
   *
   * @type {string}
   *
   * @see _currentEvent
   */
  get currentEvent() {
    return this._currentEvent;
  }
  /**
   * The currently selected menu item.
   *
   * @readonly
   *
   * @type {BaseMenuItem}
   */
  get currentMenuItem() {
    return this.elements.menuItems[this.currentChild];
  }
  /**
   * The type of hoverability for the menu.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's hoverability.
   *
   * @type {string}
   *
   * @see _hoverType
   */
  get hoverType() {
    return this._root ? this._hoverType : this.elements.rootMenu.hoverType;
  }
  /**
   * The delay time (in miliseconds) used for pointerenter/pointerleave events to take place.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's hover delay.
   *
   * @type {number}
   *
   * @see _hoverDelay
   */
  get hoverDelay() {
    return this._root ? this._hoverDelay : this.elements.rootMenu.hoverDelay;
  }
  /**
   * The delay time (in miliseconds) used for pointerenter events to take place.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's enter delay.
   *
   * If enterDelay is set to -1, the hoverDelay value will be used instead.
   *
   * @type {number}
   *
   * @see _enterDelay
   */
  get enterDelay() {
    return this._enterDelay === -1 ? this.hoverDelay : this._root ? this._enterDelay : this.elements.rootMenu.enterDelay;
  }
  /**
   * The delay time (in miliseconds) used for pointerleave events to take place.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's leave delay.
   *
   * If leaveDelay is set to -1, the hoverDelay value will be used instead.
   *
   * @type {number}
   *
   * @see _leaveDelay
   */
  get leaveDelay() {
    return this._leaveDelay === -1 ? this.hoverDelay : this._root ? this._leaveDelay : this.elements.rootMenu.leaveDelay;
  }
  /**
   * A flag to check if the menu's focus methods should _actually_ move the focus in the DOM.
   *
   * This will be `false` unless any of the following criteria are met:
   * - The menu's current event is "keyboard".
   * - The menu's current event is "character".
   * - The menu's current event is "mouse" _and_ the menu's
   *   hover type is "dynamic".
   *
   * @readonly
   *
   * @type {boolean}
   */
  get shouldFocus() {
    let t = !1;
    return (this.currentEvent === "keyboard" || this.currentEvent === "character") && (t = !0), this.currentEvent === "mouse" && this.hoverType === "dynamic" && (t = !0), t;
  }
  /**
   * A flag to check if the menu can dynamically hover.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's hasOpened.
   *
   * @type {boolean}
   *
   * @see _hasOpened
   */
  get hasOpened() {
    return this._root ? this._hasOpened : this.elements.rootMenu.hasOpened;
  }
  /**
   * An array of error messages generated by the menu.
   *
   * @readonly
   *
   * @type {string[]}
   *
   * @see _errors
   */
  get errors() {
    return this._errors;
  }
  set openClass(t) {
    S({ openClass: t }), this._openClass !== t && (this._openClass = t);
  }
  set closeClass(t) {
    S({ closeClass: t }), this._closeClass !== t && (this._closeClass = t);
  }
  set transitionClass(t) {
    S({ transitionClass: t }), this._transitionClass !== t && (this._transitionClass = t);
  }
  set currentChild(t) {
    p("number", { value: t });
    function e(s) {
      if (["mouse", "character"].includes(s.currentEvent) && s.elements.parentMenu) {
        let i = 0, o = !1;
        for (; !o && i < s.elements.parentMenu.elements.menuItems.length; ) {
          const h = s.elements.parentMenu.elements.menuItems[i];
          h.isSubmenuItem && h.elements.toggle.elements.controlledMenu === s && (o = !0, s.elements.parentMenu.currentEvent = s.currentEvent, s.elements.parentMenu.currentChild = i), i++;
        }
      }
    }
    t < -1 ? (this._currentChild = -1, e(this)) : t >= this.elements.menuItems.length ? (this._currentChild = this.elements.menuItems.length - 1, e(this)) : this.focusChild !== t && (this._currentChild = t, e(this));
  }
  set focusState(t) {
    V({ value: t }), this._focusState !== t && (this._focusState = t), this.elements.submenuToggles.length > 0 && (t === "self" || t === "none") && this.elements.submenuToggles.forEach((e) => {
      e.elements.controlledMenu.focusState = "none";
    }), this.elements.parentMenu && (t === "self" || t === "child") && (this.elements.parentMenu.focusState = "child");
  }
  set currentEvent(t) {
    R({ value: t }), this._currentEvent !== t && (this._currentEvent = t, this.elements.submenuToggles.length > 0 && this.elements.submenuToggles.forEach((e) => {
      e.elements.controlledMenu.currentEvent = t;
    }));
  }
  set hoverType(t) {
    H({ value: t }), this._hoverType !== t && (this._hoverType = t);
  }
  set hoverDelay(t) {
    p("number", { value: t }), this._hoverDelay !== t && (this._hoverDelay = t);
  }
  set enterDelay(t) {
    p("number", { value: t }), this._enterDelay !== t && (this._enterDelay = t);
  }
  set leaveDelay(t) {
    p("number", { value: t }), this._leaveDelay !== t && (this._leaveDelay = t);
  }
  set hasOpened(t) {
    p("boolean", { value: t }), this._hasOpened !== t && (this._hasOpened = t);
  }
  /**
   * Validates all aspects of the menu to ensure proper functionality.
   *
   * @protected
   *
   * @return {boolean} - The result of the validation.
   */
  _validate() {
    let t = !0, e;
    this._dom.container !== null || this._dom.controller !== null ? e = k(HTMLElement, {
      menuElement: this._dom.menu,
      controllerElement: this._dom.controller,
      containerElement: this._dom.container
    }) : e = k(HTMLElement, {
      menuElement: this._dom.menu
    }), e.status || (this._errors.push(e.error.message), t = !1);
    let s;
    if (this._selectors.submenuItems !== "" ? s = D({
      menuItemSelector: this._selectors.menuItems,
      menuLinkSelector: this._selectors.menuLinks,
      submenuItemSelector: this._selectors.submenuItems,
      submenuToggleSelector: this._selectors.submenuToggles,
      submenuSelector: this._selectors.submenus
    }) : s = D({
      menuItemSelector: this._selectors.menuItems,
      menuLinkSelector: this._selectors.menuLinks
    }), s.status || (this._errors.push(s.error.message), t = !1), this._openClass !== "") {
      const c = S({ openClass: this._openClass });
      c.status || (this._errors.push(c.error.message), t = !1);
    }
    if (this._closeClass !== "") {
      const c = S({
        closeClass: this._closeClass
      });
      c.status || (this._errors.push(c.error.message), t = !1);
    }
    if (this._transitionClass !== "") {
      const c = S({
        transitionClass: this._transitionClass
      });
      c.status || (this._errors.push(c.error.message), t = !1);
    }
    const n = p("boolean", { isTopLevel: this._root });
    if (n.status || (this._errors.push(n.error.message), t = !1), this._elements.parentMenu !== null) {
      const c = k(I, {
        parentMenu: this._elements.parentMenu
      });
      c.status || (this._errors.push(c.error.message), t = !1);
    }
    const i = H({ hoverType: this._hoverType });
    i.status || (this._errors.push(i.error.message), t = !1);
    const o = p("number", {
      hoverDelay: this._hoverDelay
    });
    o.status || (this._errors.push(o.error.message), t = !1);
    const h = p("number", {
      enterDelay: this._enterDelay
    });
    h.status || (this._errors.push(h.error.message), t = !1);
    const m = p("number", {
      leaveDelay: this._leaveDelay
    });
    return m.status || (this._errors.push(m.error.message), t = !1), t;
  }
  /**
   * Sets DOM elements within the menu.
   *
   * Elements that are not stored inside an array cannot be set through this method.
   *
   * @protected
   *
   * @param {string}      elementType            - The type of element to populate.
   * @param {HTMLElement} [base = this.dom.menu] - The element used as the base for the querySelect.
   * @param {boolean}     [overwrite = true]     - A flag to set if the existing elements will be overwritten.
   */
  _setDOMElementType(t, e = this.dom.menu, s = !0) {
    if (typeof this.selectors[t] == "string") {
      if (!Array.isArray(this.dom[t]))
        throw new Error(
          `AccessibleMenu: The "${t}" element cannot be set through _setDOMElementType.`
        );
      e !== this.dom.menu && k(HTMLElement, { base: e });
      const i = Array.from(
        e.querySelectorAll(this.selectors[t])
      ).filter(
        (o) => o.parentElement === e
      );
      s ? this._dom[t] = i : this._dom[t] = [
        ...this._dom[t],
        ...i
      ];
    } else
      throw new Error(
        `AccessibleMenu: "${t}" is not a valid element type within the menu.`
      );
  }
  /**
   * Resets DOM elements within the menu.
   *
   * Elements that are not stored inside an array cannot be reset through this method.
   *
   * @protected
   *
   * @param {string} elementType - The type of element to clear.
   */
  _resetDOMElementType(t) {
    if (typeof this.dom[t] < "u") {
      if (!Array.isArray(this.dom[t]))
        throw new Error(
          `AccessibleMenu: The "${t}" element cannot be reset through _resetDOMElementType.`
        );
      this._dom[t] = [];
    } else
      throw new Error(
        `AccessibleMenu: "${t}" is not a valid element type within the menu.`
      );
  }
  /**
   * Sets all DOM elements within the menu.
   *
   * Utiliizes _setDOMElementType and
   * _resetDOMElementType.
   *
   * @protected
   */
  _setDOMElements() {
    this._setDOMElementType("menuItems"), this.selectors.submenuItems !== "" && (this._setDOMElementType("submenuItems"), this._resetDOMElementType("submenuToggles"), this._resetDOMElementType("submenus"), this.dom.submenuItems.forEach((t) => {
      this._setDOMElementType("submenuToggles", t, !1), this._setDOMElementType("submenus", t, !1);
    }));
  }
  /**
   * Finds the root menu element.
   *
   * @protected
   *
   * @param {BaseMenu} menu - The menu to check.
   */
  _findRootMenu(t) {
    if (t.isTopLevel)
      this._elements.rootMenu = t;
    else if (t.elements.parentMenu !== null)
      this._findRootMenu(t.elements.parentMenu);
    else
      throw new Error("Cannot find root menu.");
  }
  /**
   * Creates and initializes all menu items and submenus.
   *
   * @protected
   */
  _createChildElements() {
    this.dom.menuItems.forEach((t) => {
      let e;
      if (this.dom.submenuItems.includes(t)) {
        const s = t.querySelector(this.selectors.submenuToggles), n = t.querySelector(this.selectors.submenus), i = new this._MenuType({
          menuElement: n,
          menuItemSelector: this.selectors.menuItems,
          menuLinkSelector: this.selectors.menuLinks,
          submenuItemSelector: this.selectors.submenuItems,
          submenuToggleSelector: this.selectors.submenuToggles,
          submenuSelector: this.selectors.submenus,
          openClass: this.openClass,
          closeClass: this.closeClass,
          transitionClass: this.transitionClass,
          isTopLevel: !1,
          parentMenu: this,
          hoverType: this.hoverType,
          hoverDelay: this.hoverDelay,
          enterDelay: this.enterDelay,
          leaveDelay: this.leaveDelay
        }), o = new this._MenuToggleType({
          menuToggleElement: s,
          parentElement: t,
          controlledMenu: i,
          parentMenu: this
        });
        this._elements.submenuToggles.push(o), e = new this._MenuItemType({
          menuItemElement: t,
          menuLinkElement: s,
          parentMenu: this,
          isSubmenuItem: !0,
          childMenu: i,
          toggle: o
        });
      } else {
        const s = t.querySelector(this.selectors.menuLinks);
        e = new this._MenuItemType({
          menuItemElement: t,
          menuLinkElement: s,
          parentMenu: this
        });
      }
      this._elements.menuItems.push(e);
    });
  }
  /**
   * Clears the hover timeout.
   *
   * @protected
   */
  _clearTimeout() {
    clearTimeout(this._hoverTimeout);
  }
  /**
   * Sets the hover timeout.
   *
   * @protected
   *
   * @param {Function} callback - The callback function to execute.
   * @param {number}   delay    - The delay time in milliseconds.
   */
  _setTimeout(t, e) {
    p("function", { callback: t }), p("number", { delay: e }), this._hoverTimeout = setTimeout(t, e);
  }
  /**
   * Handles focus events throughout the menu for proper menu use.
   *
   * - Adds a `focus` listener to every menu item so when it gains focus,
   *   it will set the item's containing menu's focus state
   *   to "self".
   *
   * @protected
   */
  _handleFocus() {
    this.elements.menuItems.forEach((t, e) => {
      t.dom.link.addEventListener("focus", () => {
        this.focusState = "self", this.currentChild = e;
      });
    });
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds a `pointerdown` listener to every menu item that will blur
   *   all menu items in the entire menu structure (starting at the root menu) and
   *   then properly focus the clicked item.
   * - Adds a `pointerup` listener to every submenu item that will properly
   *   toggle the submenu open/closed.
   * - Adds a `pointerup` listener to the menu's controller
   *   (if the menu is the root menu) so when it is clicked it will properly
   *   toggle open/closed.
   *
   * @protected
   */
  _handleClick() {
    function t(e, s, n) {
      l(n), s.toggle(), s.isOpen && (e.focusState = "self", s.elements.controlledMenu.focusState = "none");
    }
    this.elements.menuItems.forEach((e, s) => {
      e.dom.link.addEventListener(
        "pointerdown",
        () => {
          this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this._clearTimeout(), this.focusChild(s);
        },
        { passive: !0 }
      ), e.isSubmenuItem && e.elements.toggle.dom.toggle.addEventListener(
        "pointerup",
        (n) => {
          this.currentEvent = "mouse", t(this, e.elements.toggle, n);
        }
      );
    }), this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.addEventListener(
      "pointerup",
      (e) => {
        this.currentEvent = "mouse", t(this, this.elements.controller, e);
      }
    ), document.addEventListener("pointerup", (e) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(e.target) && !this.dom.menu !== e.target && (this.elements.rootMenu.hasOpened = this.elements.submenuToggles.some(
        (s) => s.isOpen
      )));
    });
  }
  /**
   * Handles hover events throughout the menu for proper use.
   *
   * Adds `pointerenter` listeners to all menu items and `pointerleave` listeners
   * to all submenu items which function differently depending on
   * the menu's hover type.
   *
   * Before executing anything, the event is checked to make sure the event wasn't
   * triggered by a pen or touch.
   *
   * <strong>Hover Type "on"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *    current child value will change to that
   *   menu item.
   * - When a `pointerenter` event triggers on a submenu item the
   *   preview method for the submenu item's
   *   toggle will be called.
   * - When a `pointerleave` event triggers on an open submenu item the
   *   close method for the submenu item's toggle
   *   will be called after a delay set by the menu's hover delay.
   *
   * <strong>Hover Type "dynamic"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *   current child value will change to that menu item.
   * - When a `pointerenter` event triggers on any menu item, and the menu's
   *   focus state is not "none", the menu item
   *   will be focused.
   * - When a `pointerenter` event triggers on a submenu item, and a submenu is
   *   already open, the preview method for the submenu item's toggle will be called.
   * - When a `pointerenter` event triggers on a non-submenu item, and a submenu
   *   is already open, the closeChildren method for the menu will be called.
   * - When a `pointerenter` event triggers on a submenu item, and no submenu is
   *   open, no submenu-specific methods will be called.
   * - When a `pointerleave` event triggers on an open submenu item that is not a
   *   root-level submenu item the close method for the submenu item's toggle
   *   will be called and the submenu item will be focused after a delay set by
   *   the menu's hover delay.
   * - When a `pointerleave` event triggers on an open submenu item that is a
   *   root-level submenu item no submenu-specific methods will be called.
   *
   * <strong>Hover Type "off"</strong>
   * All `pointerenter` and `pointerleave` events are ignored.
   *
   * @protected
   */
  _handleHover() {
    this.elements.menuItems.forEach((t, e) => {
      t.dom.link.addEventListener("pointerenter", (s) => {
        s.pointerType === "pen" || s.pointerType === "touch" || (this.hoverType === "on" ? (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusChild(e), t.isSubmenuItem && (this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          t.elements.toggle.preview();
        }, this.enterDelay)) : t.elements.toggle.preview())) : this.hoverType === "dynamic" && (this.currentChild = e, (!this.isTopLevel || this.focusState !== "none") && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild()), (!this.isTopLevel || this.hasOpened) && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild(), t.isSubmenuItem ? this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          t.elements.toggle.preview();
        }, this.enterDelay)) : t.elements.toggle.preview() : this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.closeChildren();
        }, this.enterDelay)) : this.closeChildren())));
      }), t.isSubmenuItem && (t.dom.item.addEventListener("pointerleave", (s) => {
        s.pointerType === "pen" || s.pointerType === "touch" || (this.hoverType === "on" ? this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse", t.elements.toggle.close();
        }, this.leaveDelay)) : (this.currentEvent = "mouse", t.elements.toggle.close()) : this.hoverType === "dynamic" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse";
        }, this.leaveDelay)) : this.currentEvent = "mouse"));
      }), t.dom.item.addEventListener("pointerenter", (s) => {
        s.pointerType === "pen" || s.pointerType === "touch" || t.isSubmenuItem && (this.hoverType === "on" || this.hoverType === "dynamic") && this.leaveDelay > 0 && this._clearTimeout();
      }));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assit the _handleKeyup method.
   *
   * - Adds a `keydown` listener to the menu's controller (if the menu is the root menu).
   *   - Blocks propagation on "Space", "Enter", and "Escape" keys.
   *
   * @protected
   */
  _handleKeydown() {
    this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.addEventListener(
      "keydown",
      (t) => {
        this.currentEvent = "keyboard";
        const e = g(t);
        (e === "Space" || e === "Enter") && l(t);
      }
    );
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * - Adds a `keyup` listener to the menu's controller (if the menu is the root menu).
   *   - Toggles the menu when the user hits "Space" or "Enter".
   *
   * @protected
   */
  _handleKeyup() {
    this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.addEventListener("keyup", (t) => {
      this.currentEvent = "keyboard";
      const e = g(t);
      (e === "Space" || e === "Enter") && (l(t), this.elements.controller.toggle(), this.elements.controller.isOpen && this.focusFirstChild());
    });
  }
  /**
   * Focus the menu.
   *
   * Sets the menu's focus state to "self" and
   * focusses the menu if the menu's shouldFocus
   * value is `true`.
   *
   * @public
   */
  focus() {
    this.focusState = "self", this.shouldFocus && this.dom.menu.focus();
  }
  /**
   * Unfocus the menu.
   *
   * Sets the menu's focus state to "none"
   * and blurs the menu if the menu's shouldFocus
   * vallue is `true`.
   *
   * @public
   */
  blur() {
    this.focusState = "none", this.shouldFocus && this.dom.menu.blur();
  }
  /**
   * Focus the menu's current child.
   *
   * @public
   */
  focusCurrentChild() {
    this.focusState = "self", this.currentChild !== -1 && this.currentMenuItem.focus();
  }
  /**
   * Focuses the menu's child at a given index.
   *
   * @public
   *
   * @param {number} index - The index of the child to focus.
   */
  focusChild(t) {
    this.blurCurrentChild(), this.currentChild = t, this.focusCurrentChild();
  }
  /**
   * Focues the menu's first child.
   *
   * @public
   */
  focusFirstChild() {
    this.focusChild(0);
  }
  /**
   * Focus the menu's last child.
   *
   * @public
   */
  focusLastChild() {
    this.focusChild(this.elements.menuItems.length - 1);
  }
  /**
   * Focus the menu's next child.
   *
   * @public
   */
  focusNextChild() {
    this.currentChild < this.elements.menuItems.length - 1 ? this.focusChild(this.currentChild + 1) : this.focusCurrentChild();
  }
  /**
   * Focus the menu's previous child.
   *
   * @public
   */
  focusPreviousChild() {
    this.currentChild > 0 ? this.focusChild(this.currentChild - 1) : this.focusCurrentChild();
  }
  /**
   * Blurs the menu's current child.
   *
   * @public
   */
  blurCurrentChild() {
    this.focusState = "none", this.currentChild !== -1 && this.currentMenuItem.blur();
  }
  /**
   * Focus the menu's controller.
   *
   * @public
   */
  focusController() {
    this.dom.controller && (this.shouldFocus && this.dom.controller.focus(), this.focusState = "none");
  }
  /**
   * Focus the menu's container.
   *
   * @public
   */
  focusContainer() {
    this.dom.container && (this.shouldFocus && this.dom.container.focus(), this.focusState = "none");
  }
  /**
   * Close all submenu children.
   *
   * @public
   */
  closeChildren() {
    this.elements.submenuToggles.forEach((t) => t.close());
  }
  /**
   * Blurs all children and submenu's children.
   *
   * @public
   */
  blurChildren() {
    this.elements.menuItems.forEach((t) => {
      t.blur(), t.isSubmenuItem && t.elements.childMenu.blurChildren();
    });
  }
}
class P extends L {
  /**
   * Constructs a new `DisclosureMenuItem`.
   *
   * @param {object}                options                         - The options for generating the menu item.
   * @param {HTMLElement}           options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}           options.menuLinkElement         - The menu item's link in the DOM.
   * @param {DisclosureMenu}        options.parentMenu              - The parent menu.
   * @param {boolean}               [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?DisclosureMenu}       [options.childMenu = null]      - The child menu.
   * @param {?DisclosureMenuToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}               [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   */
  constructor({
    menuItemElement: t,
    menuLinkElement: e,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: o = null,
    initialize: h = !0
  }) {
    super({
      menuItemElement: t,
      menuLinkElement: e,
      parentMenu: s,
      isSubmenuItem: n,
      childMenu: i,
      toggle: o
    }), h && this.initialize();
  }
}
class U extends A {
  /**
   * Constructs a new `DisclosureMenuToggle`.
   *
   * @param {object}          options                     - The options for generating the menu toggle.
   * @param {HTMLElement}     options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement}     options.parentElement       - The element containing the controlled menu.
   * @param {DisclosureMenu}  options.controlledMenu      - The menu controlled by this toggle.
   * @param {?DisclosureMenu} [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}         [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: t,
    parentElement: e,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: t,
      parentElement: e,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * Calls the BaseMenuToggle's _setAriaAttributes method.
   *
   * Ensures the toggle element has a `role` of "button" if it is not
   * already a button.
   *
   * Then using the toggle and menu's IDs, the toggle's `aria-controls`
   * is set to the menu's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    super._setAriaAttributes(), x("button", { toggle: this.dom.toggle }) || this.dom.toggle.setAttribute("role", "button"), this.dom.toggle.setAttribute(
      "aria-controls",
      this.elements.controlledMenu.dom.menu.id
    );
  }
  /**
   * Opens the controlled menu.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's open method.
   *
   * @public
   */
  open() {
    this.closeSiblings(), super.open();
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's preview method.
   *
   * @public
   */
  preview() {
    this.closeSiblings(), super.preview();
  }
  /**
   * Closes the controlled menu.
   *
   * Calls the  closeChildren method
   * and _then_ BaseMenuToggle's close method.
   *
   * @public
   */
  close() {
    this.isOpen && this.closeChildren(), super.close();
  }
}
class K extends I {
  /**
   * Constructs a new `DisclosureMenu`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = button]   - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {boolean}            [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?DisclosureMenu}    [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in miliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in miliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in miliseconds).
   * @param {boolean}            [options.optionalKeySupport = false]       - A flag to add optional keyboard support (Arrow keys, Home, and End) to the menu.
   * @param {boolean}            [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: e,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: o = "button",
    submenuSelector: h = "ul",
    controllerElement: m = null,
    containerElement: c = null,
    openClass: a = "show",
    closeClass: d = "hide",
    transitionClass: f = "transitioning",
    isTopLevel: y = !0,
    parentMenu: M = null,
    hoverType: b = "off",
    hoverDelay: _ = 250,
    enterDelay: C = -1,
    leaveDelay: E = -1,
    optionalKeySupport: T = !1,
    initialize: O = !0
  }) {
    super({
      menuElement: e,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuToggleSelector: o,
      submenuSelector: h,
      controllerElement: m,
      containerElement: c,
      openClass: a,
      closeClass: d,
      transitionClass: f,
      isTopLevel: y,
      parentMenu: M,
      hoverType: b,
      hoverDelay: _,
      enterDelay: C,
      leaveDelay: E
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof DisclosureMenu}
     */
    u(this, "_MenuType", K);
    // eslint-disable-line no-use-before-define
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof DisclosureMenuItem}
     */
    u(this, "_MenuItemType", P);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof DisclosureMenuToggle}
     */
    u(this, "_MenuToggleType", U);
    /**
     * The index of the currently selected menu item in the menu.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_currentChild", -1);
    /**
     * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_optionalSupport", !1);
    this._optionalSupport = T, O && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup();
    } catch (e) {
      console.error(e);
    }
  }
  /**
   * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's optionalKeySupport.
   *
   * @type {boolean}
   *
   * @see _optionalSupport
   */
  get optionalKeySupport() {
    return this.isTopLevel ? this._optionalSupport : this.elements.rootMenu.optionalKeySupport;
  }
  set optionalKeySupport(e) {
    p("boolean", { optionalKeySupport: e }), this._optionalSupport = e;
  }
  /**
   * Validates all aspects of the menu to ensure proper functionality.
   *
   * @protected
   *
   * @return {boolean} - The result of the validation.
   */
  _validate() {
    let e = super._validate();
    const s = p("boolean", {
      optionalKeySupport: this._optionalSupport
    });
    return s.status || (this._errors.push(s.error.message), e = !1), e;
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds all event listeners listed in
   *   BaseMenu's _handleClick method.
   * - Adds a `pointerup` listener to the `document` so if the user
   *   clicks outside of the menu it will close if it is open.
   *
   * @protected
   */
  _handleClick() {
    super._handleClick(), document.addEventListener("pointerup", (e) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(e.target) && !this.dom.menu !== e.target && (this.closeChildren(), this.blur(), this.elements.controller && this.elements.controller.close(), this.elements.rootMenu.hasOpened = !1));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "Space", "Enter", and "Escape".
   *   - _If_ optional keyboard support
   *     is enabled, blocks propagation on the following keys:
   *     "ArrowUp", "ArrowRight", "ArrowDown", "ArrowLeft", "Home", and "End".
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e);
      if (this.focusState === "self") {
        const n = ["Space", "Enter"], i = ["Escape"], o = ["Escape"];
        this.optionalKeySupport ? [
          "ArrowUp",
          "ArrowRight",
          "ArrowDown",
          "ArrowLeft",
          "Home",
          "End"
        ].includes(s) && l(e) : (this.currentMenuItem.isSubmenuItem && n.includes(s) || this.elements.controller && i.includes(s) || this.elements.parentMenu && o.includes(s)) && l(e);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * WAI ARIA Pracitices Example Disclosure for Navigation Menus):
   *
   * | Key | Function |
   * | --- | --- |
   * | _Tab_ or _Shift + Tab_ | Move keyboard focus among top-level buttons, and if a dropdown is open, into and through links in the dropdown. |
   * | _Space_ or _Enter_ | <ul><li>If focus is on a disclosure button, activates the button, which toggles the visibility of the dropdown.</li><li>If focus is on a link:<ul><li>If any link has aria-current set, removes it.</li><li>Sets aria-current="page" on the focused link.</li><li>Activates the focused link.</li></ul></li></ul> |
   * | _Escape_ | If a dropdown is open, closes it and sets focus on the button that controls that dropdown. |
   * | _Down Arrow_ or _Right Arrow_ (Optional}) | <ul><li>If focus is on a button and its dropdown is collapsed, and it is not the last button, moves focus to the next button.</li><li>if focus is on a button and its dropdown is expanded, moves focus to the first link in the dropdown.</li><li>If focus is on a link, and it is not the last link, moves focus to the next link.</li></ul> |
   * | _Up Arrow_ or _Left Arrow_ (Optional}) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the previous button.</li><li>If focus is on a link, and it is not the first link, moves focus to the previous link.</li></ul> |
   * | _Home_ (Optional) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the first button.</li><li>If focus is on a link, and it is not the first link, moves focus to the first link.</li></ul> |
   * | _End_ (Optional) | <ul><li>If focus is on a button, and it is not the last button, moves focus to the last button.</li><li>If focus is on a link, and it is not the last link, moves focus to the last link.</li></ul> |
   *
   * The optional keybindings are controlled by the menu's optionalKeySupport value.
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e);
      this.focusState === "self" && (s === "Space" || s === "Enter" ? this.currentMenuItem.isSubmenuItem ? (l(e), this.currentMenuItem.elements.toggle.isOpen ? this.currentMenuItem.elements.toggle.close() : this.currentMenuItem.elements.toggle.preview()) : this.currentMenuItem.dom.link.click() : s === "Escape" ? this.elements.submenuToggles.some(
        (i) => i.isOpen
      ) ? (l(e), this.closeChildren()) : this.elements.parentMenu ? (l(e), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.closeChildren(), this.elements.parentMenu.focusCurrentChild()) : this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (this.elements.controller.close(), this.focusController()) : this.optionalKeySupport && (s === "ArrowDown" || s === "ArrowRight" ? (l(e), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.childMenu.focusFirstChild()) : this.focusNextChild()) : s === "ArrowUp" || s === "ArrowLeft" ? (l(e), this.focusPreviousChild()) : s === "Home" ? (l(e), this.focusFirstChild()) : s === "End" && (l(e), this.focusLastChild())));
    });
  }
}
class W extends L {
  /**
   * Constructs a new `MenubarItem`.
   *
   * @param {object}         options                         - The options for generating the menu item.
   * @param {HTMLElement}    options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}    options.menuLinkElement         - The menu item's link in the DOM.
   * @param {Menubar}        options.parentMenu              - The parent menu.
   * @param {boolean}        [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?Menubar}       [options.childMenu = null]      - The child menu.
   * @param {?MenubarToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}        [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   */
  constructor({
    menuItemElement: t,
    menuLinkElement: e,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: o = null,
    initialize: h = !0
  }) {
    super({
      menuItemElement: t,
      menuLinkElement: e,
      parentMenu: s,
      isSubmenuItem: n,
      childMenu: i,
      toggle: o
    }), h && this.initialize();
  }
  /**
   * Initialize the menu item.
   *
   * Initialize will call the BaseMenuItem's initialize method
   * as well as set the menu item's `role` to "none",
   * the menu link's `role` to "menuitem", and
   * the menu link's `tabIndex` to -1 in the DOM.
   */
  initialize() {
    super.initialize(), this.dom.item.setAttribute("role", "none"), this.dom.link.setAttribute("role", "menuitem"), this.dom.link.tabIndex = -1;
  }
  /**
   * Focuses the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's focus method
   * as well as set the menu link's `tabIndex` to 0 if the parent menu
   * is the root menu.
   *
   * @public
   */
  focus() {
    super.focus(), this.elements.parentMenu.isTopLevel && (this.dom.link.tabIndex = 0);
  }
  /**
   * Blurs the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's blur method
   * as well as set the menu link's `tabIndex` to -1 if the parent menu
   * is the root menu.
   *
   * @public
   */
  blur() {
    super.blur(), this.elements.parentMenu.isTopLevel && (this.dom.link.tabIndex = -1);
  }
}
class Z extends A {
  /**
   * Constructs a new `MenubarToggle`.
   *
   * @param {object}      options                     - The options for generating the menu toggle.
   * @param {HTMLElement} options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement} options.parentElement       - The element containing the controlled menu.
   * @param {Menubar}     options.controlledMenu      - The menu controlled by this toggle.
   * @param {?Menubar}    [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}     [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: t,
    parentElement: e,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: t,
      parentElement: e,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * Calls the BaseMenuToggle's _setAriaAttributes method.
   *
   * Then sets the toggle's `aria-haspopup` attribute to "true".
   *
   * @protected
   */
  _setAriaAttributes() {
    super._setAriaAttributes(), this.dom.toggle.setAttribute("aria-haspopup", "true");
  }
  /**
   * Opens the controlled menu.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's open method.
   *
   * @public
   */
  open() {
    this.closeSiblings(), super.open();
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's preview method.
   *
   * @public
   */
  preview() {
    this.closeSiblings(), super.preview();
  }
  /**
   * Closes the controlled menu.
   *
   * Calls the  closeChildren method
   * and _then_ BaseMenuToggle's close method.
   *
   * @public
   */
  close() {
    this.isOpen && (this.closeChildren(), this.elements.parentMenu && this.elements.parentMenu.focusCurrentChild()), super.close();
  }
}
class F extends I {
  /**
   * Constructs a new `Menubar`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = a]        - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {boolean}            [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?Menubar}           [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in miliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in miliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in miliseconds).
   * @param {boolean}            [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: e,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: o = "a",
    submenuSelector: h = "ul",
    controllerElement: m = null,
    containerElement: c = null,
    openClass: a = "show",
    closeClass: d = "hide",
    transitionClass: f = "transitioning",
    isTopLevel: y = !0,
    parentMenu: M = null,
    hoverType: b = "off",
    hoverDelay: _ = 250,
    enterDelay: C = -1,
    leaveDelay: E = -1,
    initialize: T = !0
  }) {
    super({
      menuElement: e,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuToggleSelector: o,
      submenuSelector: h,
      controllerElement: m,
      containerElement: c,
      openClass: a,
      closeClass: d,
      transitionClass: f,
      isTopLevel: y,
      parentMenu: M,
      hoverType: b,
      hoverDelay: _,
      enterDelay: C,
      leaveDelay: E
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof Menubar}
     */
    u(this, "_MenuType", F);
    // eslint-disable-line no-use-before-define
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof MenubarItem}
     */
    u(this, "_MenuItemType", W);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof MenubarToggle}
     */
    u(this, "_MenuToggleType", Z);
    T && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call the BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * This will also set the menu's `role` to "menubar" in the DOM.
   *
   * If the menu is a root menu the first menu item's `tabIndex` will be set to
   * 0 in the DOM.
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this.isTopLevel ? this.dom.menu.setAttribute("role", "menubar") : this.dom.menu.setAttribute("role", "menu"), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup(), this.isTopLevel && (this.elements.menuItems[0].dom.link.tabIndex = 0, this.elements.controller && this.elements.controller.dom.toggle.removeAttribute("aria-haspopup"));
    } catch (e) {
      console.error(e);
    }
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds all event listeners listed in
   *   BaseMenu's _handleClick method.
   * - Adds a `pointerup` listener to the `document` so if the user
   *   clicks outside of the menu it will close if it is open.
   *
   * @protected
   */
  _handleClick() {
    super._handleClick(), document.addEventListener("pointerup", (e) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(e.target) && !this.dom.menu !== e.target && (this.closeChildren(), this.blur(), this.elements.controller && this.elements.controller.close(), this.elements.rootMenu.hasOpened = !1));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "ArrowUp", "ArrowRight",
   *     "ArrowDown", "ArrowLeft", "Home", "End", "Space", "Enter", "Escape",
   *     and "A" through "Z".
   *   - Completely closes the menu and moves focus out if the "Tab" key is pressed.
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e);
      if (s === "Tab" && (this.elements.rootMenu.focusState !== "none" ? (this.elements.rootMenu.blur(), this.elements.rootMenu.closeChildren()) : this.elements.rootMenu.focus()), s === "Character")
        l(e);
      else if (this.isTopLevel) {
        if (this.focusState === "self") {
          const n = ["ArrowRight", "ArrowLeft", "Home", "End"], i = ["Space", "Enter", "ArrowDown", "ArrowUp"], o = ["Escape"];
          (n.includes(s) || this.currentMenuItem.isSubmenuItem && i.includes(s) || this.elements.controller && o.includes(s)) && l(e);
        }
      } else {
        const n = [
          "Escape",
          "ArrowRight",
          "ArrowLeft",
          "ArrowDown",
          "ArrowUp",
          "Home",
          "End"
        ], i = ["Space", "Enter"];
        (n.includes(s) || this.currentMenuItem.isSubmenuItem && i.includes(s)) && l(e);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * Navigation Menubar Example):
   *
   * <strong>Menubar</strong>
   *
   * | Key | Function |
   * | --- | --- |
   * | _Space_ or _Enter_ | Opens submenu and moves focus to first item in the submenu. |
   * | _Right Arrow_ | <ul><li>Moves focus to the next item in the menubar.</li><li>If focus is on the last item, moves focus to the first item.</li></ul> |
   * | _Left Arrow_ | <ul><li>Moves focus to the previous item in the menubar.</li><li>If focus is on the first item, moves focus to the last item.</li></ul> |
   * | _Down Arrow_ | Opens submenu and moves focus to first item in the submenu. |
   * | _Up Arrow_ | Opens submenu and moves focus to last item in the submenu. |
   * | _Home_ | Moves focus to first item in the menubar. |
   * | _End_ | Moves focus to last item in the menubar. |
   * | _Character_ | <ul><li>Moves focus to next item in the menubar having a name that starts with the typed character.</li><li>If none of the items have a name starting with the typed character, focus does not move.</li></ul> |
   *
   * <strong>Submenu</strong>
   *
   * | Key | Function |
   * | --- | --- |
   * | _Space_ or _Enter_ | <ul><li>Activates menu item, causing the link to be activated.</li><li>NOTE: the links go to dummy pages; use the browser go-back function to return to this menubar example page.</li></ul> |
   * | _Escape_ | <ul><li>Closes submenu.</li><li>Moves focus to parent menubar item.</li></ul> |
   * | _Right Arrow_ | <ul><li>If focus is on an item with a submenu, opens the submenu and places focus on the first item.</li><li>If focus is on an item that does not have a submenu:<ul><li>Closes submenu.</li><li>Moves focus to next item in the menubar.</li><li>Opens submenu of newly focused menubar item, keeping focus on that parent menubar item.</li></ul></li></ul> |
   * | _Left Arrow_ | <ul><li>Closes submenu and moves focus to parent menu item.</li><li>If parent menu item is in the menubar, also:<ul><li>moves focus to previous item in the menubar.</li><li>Opens submenu of newly focused menubar item, keeping focus on that parent menubar item.</li></ul></li></ul> |
   * | _Down Arrow_ | <ul><li>Moves focus to the next item in the submenu.</li><li>If focus is on the last item, moves focus to the first item.</li></ul> |
   * | _Up Arrow_ | <ul><li>Moves focus to previous item in the submenu.</li><li>If focus is on the first item, moves focus to the last item.</li></ul> |
   * | Home | Moves focus to the first item in the submenu. |
   * | End | Moves focus to the last item in the submenu. |
   * | _Character_ | <ul><li>Moves focus to the next item having a name that starts with the typed character.</li><li>If none of the items have a name starting with the typed character, focus does not move.</li></ul> |
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e), { altKey: n, crtlKey: i, metaKey: o } = e;
      if (s === "Character" && !(n || i || o))
        l(e), this.elements.rootMenu.currentEvent = "character", this.focusNextChildWithCharacter(e.key);
      else if (this.isTopLevel) {
        if (this.focusState === "self")
          if (s === "Space" || s === "Enter")
            this.currentMenuItem.isSubmenuItem ? (l(e), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
              this.currentMenuItem.elements.childMenu.focusFirstChild();
            })) : this.currentMenuItem.dom.link.click();
          else if (s === "ArrowRight") {
            l(e);
            const m = this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen;
            this.focusNextChild(), m && (this.currentMenuItem.isSubmenuItem ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.preview()) : this.closeChildren());
          } else if (s === "ArrowLeft") {
            l(e);
            const m = this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen;
            this.focusPreviousChild(), m && (this.currentMenuItem.isSubmenuItem ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.preview()) : this.closeChildren());
          } else s === "ArrowDown" ? this.currentMenuItem.isSubmenuItem && (l(e), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
            this.currentMenuItem.elements.childMenu.focusFirstChild();
          })) : s === "ArrowUp" ? this.currentMenuItem.isSubmenuItem && (l(e), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
            this.currentMenuItem.elements.childMenu.focusLastChild();
          })) : s === "Home" ? (l(e), this.focusFirstChild()) : s === "End" ? (l(e), this.focusLastChild()) : s === "Escape" && (this.elements.submenuToggles.some(
            (c) => c.isOpen
          ) ? (l(e), this.closeChildren()) : this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (l(e), this.elements.controller.close(), this.focusController()));
      } else
        s === "Space" || s === "Enter" ? this.currentMenuItem.isSubmenuItem ? (l(e), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
          this.currentMenuItem.elements.childMenu.focusFirstChild();
        })) : this.currentMenuItem.dom.link.click() : s === "Escape" ? (l(e), this.elements.rootMenu.closeChildren(), this.elements.rootMenu.focusCurrentChild()) : s === "ArrowRight" ? this.currentMenuItem.isSubmenuItem ? (l(e), this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.toggle.open(), requestAnimationFrame(() => {
          this.currentMenuItem.elements.childMenu.focusFirstChild();
        })) : (l(e), this.elements.rootMenu.closeChildren(), this.elements.rootMenu.focusNextChild(), this.elements.rootMenu.currentMenuItem.isSubmenuItem && this.elements.rootMenu.currentMenuItem.elements.toggle.preview()) : s === "ArrowLeft" ? this.elements.parentMenu.currentMenuItem.isSubmenuItem && (l(e), this.elements.parentMenu.currentMenuItem.elements.toggle.close(), this.elements.parentMenu.focusCurrentChild(), this.elements.parentMenu === this.elements.rootMenu && (this.elements.rootMenu.closeChildren(), this.elements.rootMenu.focusPreviousChild(), this.elements.rootMenu.currentMenuItem.isSubmenuItem && (this.elements.rootMenu.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.elements.rootMenu.currentMenuItem.elements.toggle.preview()))) : s === "ArrowDown" ? (l(e), this.focusNextChild()) : s === "ArrowUp" ? (l(e), this.focusPreviousChild()) : s === "Home" ? (l(e), this.focusFirstChild()) : s === "End" && (l(e), this.focusLastChild());
    });
  }
  /**
   * Focus the menu's next child.
   *
   * If the currently focussed child in the menu is the last child then this will
   * focus the first child in the menu.
   *
   * @public
   */
  focusNextChild() {
    this.currentChild === this.elements.menuItems.length - 1 ? this.focusFirstChild() : this.focusChild(this.currentChild + 1);
  }
  /**
   * Focus the menu's previous child.
   *
   * If the currently focussed child in the menu is the first child then this will
   * focus the last child in the menu.
   *
   * @public
   */
  focusPreviousChild() {
    this.currentChild === 0 ? this.focusLastChild() : this.focusChild(this.currentChild - 1);
  }
  /**
   * Focus the menu's next child starting with a specific letter.
   *
   * @public
   *
   * @param {string} char - The character to look for.
   */
  focusNextChildWithCharacter(e) {
    const s = e.toLowerCase();
    let n = this.currentChild + 1, i = !1;
    for (; !i && n < this.elements.menuItems.length; ) {
      let o = "";
      this.elements.menuItems[n].dom.item.innerText ? o = this.elements.menuItems[n].dom.item.innerText : o = this.elements.menuItems[n].dom.item.textContent, o = o.replace(/[\s]/g, "").toLowerCase().charAt(0), o === s && (i = !0, this.focusChild(n)), n++;
    }
  }
}
class Q extends L {
  /**
   * Constructs a new `TopLinkDisclosureMenuItem`.
   *
   * @param {object}                       options                         - The options for generating the menu item.
   * @param {HTMLElement}                  options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}                  options.menuLinkElement         - The menu item's link in the DOM.
   * @param {TopLinkDisclosureMenu}        options.parentMenu              - The parent menu.
   * @param {boolean}                      [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?TopLinkDisclosureMenu}       [options.childMenu = null]      - The child menu.
   * @param {?TopLinkDisclosureMenuToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}                      [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   * @param {?TopLinkDisclosureMenuItem}   [options.submenuSibling = null] - The sibling menu item that controls a submenu.
   */
  constructor({
    menuItemElement: e,
    menuLinkElement: s,
    parentMenu: n,
    isSubmenuItem: i = !1,
    childMenu: o = null,
    toggle: h = null,
    initialize: m = !0,
    submenuSibling: c = null
  }) {
    super({
      menuItemElement: e,
      menuLinkElement: s,
      parentMenu: n,
      isSubmenuItem: i,
      childMenu: o,
      toggle: h
    });
    /**
     * The declared accessible-menu elements within the menu item.
     *
     * @type {Object<TopLinkDisclosureMenu, TopLinkDisclosureMenuToggle>}
     *
     * @protected
     *
     * @property {TopLinkDisclosureMenu}                   parentMenu - The menu containing this menu item.
     * @property {?TopLinkDisclosureMenu}                  childMenu  - The menu contained within this menu item.
     * @property {?TopLinkDisclosureMenuToggle}            toggle     - The menu toggle within this menu item that controls the `childMenu`.
     * @property {?TopLinkDisclosureMenuItem}              sibling    - The sibling menu item that is a submenu item.
     */
    u(this, "_elements", {
      parentMenu: null,
      childMenu: null,
      toggle: null,
      sibling: null
    });
    this._elements.parentMenu = n, this._elements.childMenu = o, this._elements.toggle = h, this._elements.sibling = c, m && this.initialize();
  }
}
class B extends A {
  /**
   * Constructs a new `TopLinkDisclosureMenuToggle`.
   *
   * @param {object}                 options                     - The options for generating the menu toggle.
   * @param {HTMLElement}            options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement}            options.parentElement       - The element containing the controlled menu.
   * @param {TopLinkDisclosureMenu}  options.controlledMenu      - The menu controlled by this toggle.
   * @param {?TopLinkDisclosureMenu} [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}                [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: t,
    parentElement: e,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: t,
      parentElement: e,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * Calls the BaseMenuToggle's _setAriaAttributes method.
   *
   * Ensures the toggle element has a `role` of "button" if it is not
   * already a button.
   *
   * Then using the toggle and menu's IDs, the toggle's `aria-controls`
   * is set to the menu's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    super._setAriaAttributes(), x("button", { toggle: this.dom.toggle }) || this.dom.toggle.setAttribute("role", "button"), this.dom.toggle.setAttribute(
      "aria-controls",
      this.elements.controlledMenu.dom.menu.id
    );
  }
  /**
   * Opens the controlled menu.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's open method.
   */
  open() {
    this.closeSiblings(), super.open();
  }
  /**
   * Opens the controlled menu without the current focus entering it.
   *
   * Calls the  closeSiblings method
   * and _then_ BaseMenuToggle's preview method.
   */
  preview() {
    this.closeSiblings(), super.preview();
  }
  /**
   * Closes the controlled menu.
   *
   * Calls the  closeChildren method
   * and _then_ BaseMenuToggle's close method.
   */
  close() {
    this.isOpen && this.closeChildren(), super.close();
  }
}
class $ extends I {
  /**
   * Constructs a new `TopLinkDisclosureMenu`.
   *
   * @param {object}                 options                                    - The options for generating the menu.
   * @param {HTMLElement}            options.menuElement                        - The menu element in the DOM.
   * @param {string}                 [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}                 [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}                 [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}                 [options.submenuToggleSelector = button]   - The query selector string for submenu toggle buttons/links.
   * @param {string}                 [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {string}                 [options.submenuSubtoggleSelector = a]     - The query selector string for submenu toggle buttons/links below the top level.
   * @param {?HTMLElement}           [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}           [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])}     [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])}     [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])}     [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {boolean}                [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?TopLinkDisclosureMenu} [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}                 [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}                 [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in miliseconds).
   * @param {number}                 [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in miliseconds).
   * @param {number}                 [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in miliseconds).
   * @param {boolean}                [options.optionalKeySupport = false]       - A flag to add optional keyboard support (Arrow keys, Home, and End) to the menu.
   * @param {boolean}                [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: e,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: o = "button",
    submenuSelector: h = "ul",
    submenuSubtoggleSelector: m = "a",
    controllerElement: c = null,
    containerElement: a = null,
    openClass: d = "show",
    closeClass: f = "hide",
    transitionClass: y = "transitioning",
    isTopLevel: M = !0,
    parentMenu: b = null,
    hoverType: _ = "off",
    hoverDelay: C = 250,
    enterDelay: E = -1,
    leaveDelay: T = -1,
    optionalKeySupport: O = !1,
    initialize: q = !0
  }) {
    super({
      menuElement: e,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuSelector: h,
      submenuToggleSelector: o,
      controllerElement: c,
      containerElement: a,
      openClass: d,
      closeClass: f,
      transitionClass: y,
      isTopLevel: M,
      parentMenu: b,
      hoverType: _,
      hoverDelay: C,
      enterDelay: E,
      leaveDelay: T
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof TopLinkDisclosureMenu}
     */
    u(this, "_MenuType", $);
    // eslint-disable-line no-use-before-define
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof TopLinkDisclosureMenuItem}
     */
    u(this, "_MenuItemType", Q);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof TopLinkDisclosureMenuToggle}
     */
    u(this, "_MenuToggleType", B);
    /**
     * The index of the currently selected menu item in the menu.
     *
     * @protected
     *
     * @type {number}
     */
    u(this, "_currentChild", -1);
    /**
     * The query selectors used by the menu to populate the dom.
     *
     * @protected
     *
     * @type {Object<string>}
     *
     * @property {string} menuItems         - The query selector for menu items.
     * @property {string} menuLinks         - The query selector for menu links.
     * @property {string} submenuItems      - The query selector for menu items containing submenus.
     * @property {string} submenuToggles    - The query selector for menu links that function as submenu toggles.
     * @property {string} submenus          - The query selector for for submenus.
     * @property {string} submenuSubtoggles - The query selector for menu links that function as submenu toggles below the top level.
     */
    u(this, "_selectors", {
      menuItems: "",
      menuLinks: "",
      submenuItems: "",
      submenuToggles: "",
      submenus: "",
      submenuSubtoggles: ""
    });
    /**
     * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
     *
     * @protected
     *
     * @type {boolean}
     */
    u(this, "_optionalSupport", !1);
    this._optionalSupport = O, this._selectors.menuItems = s, this._selectors.submenuItems = i, this._selectors.submenuToggles = o, this._selectors.submenus = h, this._selectors.submenuSubtoggles = m, this._selectors.menuLinks = [
      .../* @__PURE__ */ new Set([n, o])
    ].join(","), q && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call the BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup();
    } catch (e) {
      console.error(e);
    }
  }
  /**
   * A flag to add optional keyboard support (Arrow keys, "Home", and "End") to the menu.
   *
   * This functions differently for root vs. submenus.
   * Submenus will always inherit their root menu's optionalKeySupport.
   *
   * @type {boolean}
   *
   * @see _optionalSupport
   */
  get optionalKeySupport() {
    return this.isTopLevel ? this._optionalSupport : this.elements.rootMenu.optionalKeySupport;
  }
  set optionalKeySupport(e) {
    p("boolean", { optionalKeySupport: e }), this._optionalSupport = e;
  }
  /**
   * Creates and initializes all menu items and submenus.
   *
   * @protected
   */
  _createChildElements() {
    this.dom.menuItems.forEach((e) => {
      let s, n;
      const i = e.querySelector(this.selectors.menuLinks);
      if (this.dom.submenuItems.includes(e)) {
        const o = e.querySelector(this.selectors.submenuToggles), h = e.querySelector(this.selectors.submenus), m = new this._MenuType({
          menuElement: h,
          menuItemSelector: this.selectors.menuItems,
          menuLinkSelector: this.selectors.menuLinks,
          submenuItemSelector: this.selectors.submenuItems,
          submenuToggleSelector: this.selectors.submenuSubtoggles,
          submenuSelector: this.selectors.submenus,
          submenuSubtoggleSelector: this.selectors.submenuSubtoggles,
          openClass: this.openClass,
          closeClass: this.closeClass,
          transitionClass: this.transitionClass,
          isTopLevel: !1,
          parentMenu: this,
          hoverType: this.hoverType,
          hoverDelay: this.hoverDelay,
          enterDelay: this.enterDelay,
          leaveDelay: this.leaveDelay
        }), c = new this._MenuToggleType({
          menuToggleElement: o,
          parentElement: e,
          controlledMenu: m,
          parentMenu: this
        });
        this._elements.submenuToggles.push(c), o !== i ? (n = new this._MenuItemType({
          menuItemElement: e,
          menuLinkElement: o,
          parentMenu: this,
          isSubmenuItem: !0,
          childMenu: m,
          toggle: c
        }), s = new this._MenuItemType({
          menuItemElement: e,
          menuLinkElement: i,
          parentMenu: this,
          submenuSibling: n
        })) : s = new this._MenuItemType({
          menuItemElement: e,
          menuLinkElement: i,
          parentMenu: this,
          isSubmenuItem: !0,
          childMenu: m,
          toggle: c
        });
      } else
        s = new this._MenuItemType({
          menuItemElement: e,
          menuLinkElement: i,
          parentMenu: this
        });
      this._elements.menuItems.push(s), typeof n < "u" && this._elements.menuItems.push(n);
    });
  }
  /**
   * Validates all aspects of the menu to ensure proper functionality.
   *
   * @protected
   *
   * @return {boolean} - The result of the validation.
   */
  _validate() {
    let e = super._validate();
    const s = D({
      submenuSubtoggleSelector: this._selectors.submenuSubtoggles
    });
    s.status || (this._errors.push(s.error.message), e = !1);
    const n = p("boolean", {
      optionalKeySupport: this._optionalSupport
    });
    return n.status || (this._errors.push(n.error.message), e = !1), e;
  }
  /**
   * Handles click events throughout the menu for proper use.
   *
   * - Adds all event listeners listed in
   *   BaseMenu's _handleClick method, and
   * - adds a `pointerup` listener to the `document` so if the user
   *   clicks outside of the menu it will close if it is open.
   *
   * @protected
   */
  _handleClick() {
    super._handleClick(), document.addEventListener("pointerup", (e) => {
      this.focusState !== "none" && (this.currentEvent = "mouse", !this.dom.menu.contains(e.target) && !this.dom.menu !== e.target && (this.closeChildren(), this.blur(), this.elements.controller && this.elements.controller.close(), this.elements.rootMenu.hasOpened = !1));
    });
  }
  /**
   * Handles hover events throughout the menu for proper use.
   *
   * Adds `pointerenter` listeners to all menu items and `pointerleave` listeners
   * to all submenu items which function differently depending on
   * the menu's hover type.
   *
   * Before executing anything, the event is checked to make sure the event wasn't
   * triggered by a pen or touch.
   *
   * <strong>Hover Type "on"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *    current child value will change to that
   *   menu item.
   * - When a `pointerenter` event triggers on a submenu item the
   *   preview method for the submenu item's
   *   toggle will be called.
   * - When a `pointerleave` event triggers on an open submenu item the
   *   close method for the submenu item's toggle
   *   will be called after a delay set by the menu's hover delay.
   *
   * <strong>Hover Type "dynamic"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *   current child value will change to that menu item.
   * - When a `pointerenter` event triggers on any menu item, and the menu's
   *   focus state is not "none", the menu item
   *   will be focused.
   * - When a `pointerenter` event triggers on a submenu item, and a submenu is
   *   already open, the preview method for the submenu item's toggle will be called.
   * - When a `pointerenter` event triggers on a non-submenu item, and a submenu
   *   is already open, the closeChildren method for the menu will be called.
   * - When a `pointerenter` event triggers on a submenu item, and no submenu is
   *   open, no submenu-specific methods will be called.
   * - When a `pointerleave` event triggers on an open submenu item that is not a
   *   root-level submenu item the close method for the submenu item's toggle
   *   will be called and the submenu item will be focused after a delay set by
   *   the menu's hover delay.
   * - When a `pointerleave` event triggers on an open submenu item that is a
   *   root-level submenu item no submenu-specific methods will be called.
   *
   * <strong>Hover Type "off"</strong>
   * All `pointerenter` and `pointerleave` events are ignored.
   *
   * @protected
   */
  _handleHover() {
    this.elements.menuItems.forEach((e, s) => {
      e.dom.link.addEventListener("pointerenter", (n) => {
        if (!(n.pointerType === "pen" || n.pointerType === "touch")) {
          if (this.hoverType === "on") {
            this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusChild(s);
            let i = e.isSubmenuItem ? e.elements.toggle : null;
            if (e.elements.sibling !== null && (i = e.elements.sibling.elements.toggle), i === null) return;
            this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
              i.preview();
            }, this.enterDelay)) : i.preview();
          } else if (this.hoverType === "dynamic" && (this.currentChild = s, (!this.isTopLevel || this.focusState !== "none") && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild()), !this.isTopLevel || this.hasOpened)) {
            this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild();
            let i = e.isSubmenuItem ? e.elements.toggle : null;
            e.elements.sibling !== null && (i = e.elements.sibling.elements.toggle), i !== null ? this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
              i.preview();
            }, this.enterDelay)) : i.preview() : this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
              this.closeChildren();
            }, this.enterDelay)) : this.closeChildren();
          }
        }
      }), e.isSubmenuItem && (e.dom.item.addEventListener("pointerleave", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || (this.hoverType === "on" ? this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse", e.elements.toggle.close();
        }, this.leaveDelay)) : (this.currentEvent = "mouse", e.elements.toggle.close()) : this.hoverType === "dynamic" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse";
        }, this.leaveDelay)) : this.currentEvent = "mouse"));
      }), e.dom.item.addEventListener("pointerenter", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || e.isSubmenuItem && (this.hoverType === "on" || this.hoverType === "dynamic") && this.leaveDelay > 0 && this._clearTimeout();
      }));
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "Space", "Enter", and "Escape".
   *   - _If_ optional keyboard support
   *     is enabled, blocks propagation on the following keys:
   *     "ArrowUp", "ArrowRight", "ArrowDown", "ArrowLeft", "Home", and "End".
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e);
      if (this.focusState === "self") {
        const n = ["Space", "Enter"], i = ["Escape"], o = ["Escape"];
        this.optionalKeySupport ? [
          "ArrowUp",
          "ArrowRight",
          "ArrowDown",
          "ArrowLeft",
          "Home",
          "End"
        ].includes(s) && l(e) : (this.currentMenuItem.isSubmenuItem && n.includes(s) || this.elements.controller && i.includes(s) || this.elements.parentMenu && o.includes(s)) && l(e);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * WAI ARIA Pracitices Example Disclosure for Navigation Menus):
   *
   * | Key | Function |
   * | --- | --- |
   * | _Tab_ or _Shift + Tab_ | Move keyboard focus among top-level buttons, and if a dropdown is open, into and through links in the dropdown. |
   * | _Space_ or _Enter_ | <ul><li>If focus is on a disclosure button, activates the button, which toggles the visibility of the dropdown.</li><li>If focus is on a link:<ul><li>If any link has aria-current set, removes it.</li><li>Sets aria-current="page" on the focused link.</li><li>Activates the focused link.</li></ul></li></ul> |
   * | _Escape_ | If a dropdown is open, closes it and sets focus on the button that controls that dropdown. |
   * | _Down Arrow_ or _Right Arrow_ (Optional}) | <ul><li>If focus is on a button and its dropdown is collapsed, and it is not the last button, moves focus to the next button.</li><li>if focus is on a button and its dropdown is expanded, moves focus to the first link in the dropdown.</li><li>If focus is on a link, and it is not the last link, moves focus to the next link.</li></ul> |
   * | _Up Arrow_ or _Left Arrow_ (Optional}) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the previous button.</li><li>If focus is on a link, and it is not the first link, moves focus to the previous link.</li></ul> |
   * | _Home_ (Optional}) | <ul><li>If focus is on a button, and it is not the first button, moves focus to the first button.</li><li>If focus is on a link, and it is not the first link, moves focus to the first link.</li></ul> |
   * | _End_ (Optional}) | <ul><li>If focus is on a button, and it is not the last button, moves focus to the last button.</li><li>If focus is on a link, and it is not the last link, moves focus to the last link.</li></ul> |
   *
   * The optional keybindings are controlled by the menu's optionalKeySupport value.
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e);
      this.focusState === "self" && (s === "Space" || s === "Enter" ? this.currentMenuItem.isSubmenuItem ? (l(e), this.currentMenuItem.elements.toggle.isOpen ? this.currentMenuItem.elements.toggle.close() : this.currentMenuItem.elements.toggle.preview()) : this.currentMenuItem.dom.link.click() : s === "Escape" ? this.elements.submenuToggles.some(
        (i) => i.isOpen
      ) ? (l(e), this.closeChildren()) : this.elements.parentMenu ? (l(e), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.closeChildren(), this.elements.parentMenu.focusCurrentChild()) : this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (this.elements.controller.close(), this.focusController()) : this.optionalKeySupport && (s === "ArrowDown" || s === "ArrowRight" ? (l(e), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.currentMenuItem.elements.childMenu.currentEvent = "keyboard", this.currentMenuItem.elements.childMenu.focusFirstChild()) : this.focusNextChild()) : s === "ArrowUp" || s === "ArrowLeft" ? (l(e), this.focusPreviousChild()) : s === "Home" ? (l(e), this.focusFirstChild()) : s === "End" && (l(e), this.focusLastChild())));
    });
  }
}
class G extends L {
  /**
   * Constructs a new `TreeviewItem`.
   *
   * @param {object}          options                         - The options for generating the menu item.
   * @param {HTMLElement}     options.menuItemElement         - The menu item in the DOM.
   * @param {HTMLElement}     options.menuLinkElement         - The menu item's link in the DOM.
   * @param {Treeview}        options.parentMenu              - The parent menu.
   * @param {boolean}         [options.isSubmenuItem = false] - A flag to mark if the menu item is controlling a submenu.
   * @param {?Treeview}       [options.childMenu = null]      - The child menu.
   * @param {?TreeviewToggle} [options.toggle = null]         - The controller for the child menu.
   * @param {boolean}         [options.initialize = true]     - A flag to initialize the menu item immediately upon creation.
   */
  constructor({
    menuItemElement: t,
    menuLinkElement: e,
    parentMenu: s,
    isSubmenuItem: n = !1,
    childMenu: i = null,
    toggle: o = null,
    initialize: h = !0
  }) {
    super({
      menuItemElement: t,
      menuLinkElement: e,
      parentMenu: s,
      isSubmenuItem: n,
      childMenu: i,
      toggle: o
    }), h && this.initialize();
  }
  /**
   * Initialize the menu item.
   *
   * Initialize will call the BaseMenuItem's initialize method
   * as well as set the menu item's `role` to "none",
   * the menu link's `role` to "treeitem", and
   * the menu link's `tabIndex` to -1 in the DOM.
   */
  initialize() {
    super.initialize(), this.dom.item.setAttribute("role", "none"), this.dom.link.setAttribute("role", "treeitem"), this.dom.link.tabIndex = -1;
  }
  /**
   * Focuses the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's focus method
   * as well as set the menu link's `tabIndex` to 0.
   */
  focus() {
    super.focus(), this.dom.link.tabIndex = 0;
  }
  /**
   * Blurs the menu item's link if the parent menu's
   * shouldFocus value is `true`.
   *
   * This will call the BaseMenuItem's blur method
   * as well as set the menu link's `tabIndex` to -1.
   */
  blur() {
    super.blur(), this.dom.link.tabIndex = -1;
  }
}
class J extends A {
  /**
   * Constructs a new `TreeviewToggle`.
   *
   * @param {object}      options                     - The options for generating the menu toggle.
   * @param {HTMLElement} options.menuToggleElement   - The toggle element in the DOM.
   * @param {HTMLElement} options.parentElement       - The element containing the controlled menu.
   * @param {Treeview}    options.controlledMenu      - The menu controlled by this toggle.
   * @param {?Treeview}   [options.parentMenu = null] - The menu containing this toggle.
   * @param {boolean}     [options.initialize = true] - A flag to initialize the menu toggle immediately upon creation.
   */
  constructor({
    menuToggleElement: t,
    parentElement: e,
    controlledMenu: s,
    parentMenu: n = null,
    initialize: i = !0
  }) {
    super({
      menuToggleElement: t,
      parentElement: e,
      controlledMenu: s,
      parentMenu: n
    }), i && this.initialize();
  }
  /**
   * Initializes the menu toggle.
   *
   * The first steps are to ensure that the toggle and controlled menu have IDs
   * using the setIds method, and to set the ARIA attributes on the toggle
   * and controlled menu using the setAriaAttributes method.
   *
   * Then the open or collapse method is called based on the state of the
   * toggle's aria-expanded attribute.
   */
  initialize() {
    this._setIds(), this._setAriaAttributes(), this.dom.toggle.getAttribute("aria-expanded") === "true" ? this.open() : this._collapse(!1);
  }
  /**
   * Sets the ARIA attributes on the toggle and controlled menu.
   *
   * The first steps are to ensure that the toggle has `aria-expanded`
   * set to "false" if it's not already set explicitly to "true".
   *
   * Then using the toggle and menu's IDs, the menu's `aria-labelledby` is set to
   * the toggle's ID, and the toggle's `aria-owns` is set to the menu's ID.
   *
   * @protected
   */
  _setAriaAttributes() {
    this.dom.toggle.getAttribute("aria-expanded") !== "true" && this.dom.toggle.setAttribute("aria-expanded", "false"), this.elements.controlledMenu.dom.menu.setAttribute(
      "aria-labelledby",
      this.dom.toggle.id
    ), this.dom.toggle.setAttribute(
      "aria-owns",
      this.elements.controlledMenu.dom.menu.id
    );
  }
}
class z extends I {
  /**
   * Constructs a new `Treeview`.
   *
   * @param {object}             options                                    - The options for generating the menu.
   * @param {HTMLElement}        options.menuElement                        - The menu element in the DOM.
   * @param {string}             [options.menuItemSelector = li]            - The query selector string for menu items.
   * @param {string}             [options.menuLinkSelector = a]             - The query selector string for menu links.
   * @param {string}             [options.submenuItemSelector = li:has(ul)] - The query selector string for menu items containing submenus.
   * @param {string}             [options.submenuToggleSelector = a]        - The query selector string for submenu toggle buttons/links.
   * @param {string}             [options.submenuSelector = ul]             - The query selector string for submenus.
   * @param {?HTMLElement}       [options.controllerElement = null]         - The element controlling the menu in the DOM.
   * @param {?HTMLElement}       [options.containerElement = null]          - The element containing the menu in the DOM.
   * @param {?(string|string[])} [options.openClass = show]                 - The class to apply when a menu is "open".
   * @param {?(string|string[])} [options.closeClass = hide]                - The class to apply when a menu is "closed".
   * @param {?(string|string[])} [options.transitionClass = transitioning]  - The class to apply when a menu is transitioning between "open" and "closed" states.
   * @param {boolean}            [options.isTopLevel = true]                - A flag to mark the root menu.
   * @param {?Treeview}          [options.parentMenu = null]                - The parent menu to this menu.
   * @param {string}             [options.hoverType = off]                  - The type of hoverability a menu has.
   * @param {number}             [options.hoverDelay = 250]                 - The delay for opening and closing menus if the menu is hoverable (in miliseconds).
   * @param {number}             [options.enterDelay = -1]                  - The delay for opening a menu if the menu is focusable (in miliseconds).
   * @param {number}             [options.leaveDelay = -1]                  - The delay for closing a menu if the menu is focusable (in miliseconds).
   * @param {boolean}            [options.initialize = true]                - A flag to initialize the menu immediately upon creation.
   */
  constructor({
    menuElement: e,
    menuItemSelector: s = "li",
    menuLinkSelector: n = "a",
    submenuItemSelector: i = "li:has(ul)",
    submenuToggleSelector: o = "a",
    submenuSelector: h = "ul",
    controllerElement: m = null,
    containerElement: c = null,
    openClass: a = "show",
    closeClass: d = "hide",
    transitionClass: f = "transitioning",
    isTopLevel: y = !0,
    parentMenu: M = null,
    hoverType: b = "off",
    hoverDelay: _ = 250,
    enterDelay: C = -1,
    leaveDelay: E = -1,
    initialize: T = !0
  }) {
    super({
      menuElement: e,
      menuItemSelector: s,
      menuLinkSelector: n,
      submenuItemSelector: i,
      submenuToggleSelector: o,
      submenuSelector: h,
      controllerElement: m,
      containerElement: c,
      openClass: a,
      closeClass: d,
      transitionClass: f,
      isTopLevel: y,
      parentMenu: M,
      hoverType: b,
      hoverDelay: _,
      enterDelay: C,
      leaveDelay: E
    });
    /**
     * The class to use when generating submenus.
     *
     * @protected
     *
     * @type {typeof Treeview}
     */
    u(this, "_MenuType", z);
    // eslint-disable-line no-use-before-define
    /**
     * The class to use when generating menu items.
     *
     * @protected
     *
     * @type {typeof TreeviewItem}
     */
    u(this, "_MenuItemType", G);
    /**
     * The class to use when generating submenu toggles.
     *
     * @protected
     *
     * @type {typeof TreeviewToggle}
     */
    u(this, "_MenuToggleType", J);
    T && this.initialize();
  }
  /**
   * Initializes the menu.
   *
   * Initialize will call the BaseMenu's initialize method
   * as well as set up focus,
   * click,
   * hover,
   * keydown, and
   * keyup events for the menu.
   *
   * If the menu is a root menu it's `role` will be set to "tree" and the first
   * menu item's `tabIndex` will be set to 0 in the DOM.
   *
   * If the menu is _not_ a root menu it's `role` will be set to "group".
   *
   * If the BaseMenu's initialize method throws an error,
   * this will catch it and log it to the console.
   */
  initialize() {
    try {
      super.initialize(), this.isTopLevel ? (this.dom.menu.setAttribute("role", "tree"), this.elements.menuItems[0].dom.link.tabIndex = 0) : this.dom.menu.setAttribute("role", "group"), this._handleFocus(), this._handleClick(), this._handleHover(), this._handleKeydown(), this._handleKeyup(), this.isTopLevel && this.elements.controller && this.elements.controller.dom.toggle.removeAttribute("aria-owns");
    } catch (e) {
      console.error(e);
    }
  }
  /**
   * Handles hover events throughout the menu for proper use.
   *
   * Adds `pointerenter` listeners to all menu items and `pointerleave` listeners
   * to all submenu items which function differently depending on
   * the menu's hover type.
   *
   * Before executing anything, the event is checked to make sure the event wasn't
   * triggered by a pen or touch.
   *
   * <strong>Hover Type "on"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *    current child value will change to that
   *   menu item.
   * - When a `pointerenter` event triggers on a submenu item the
   *   preview method for the submenu item's
   *   toggle will be called.
   * - When a `pointerleave` event triggers on the menu itself the
   *   closeChildren method will be called after a delay
   *   set by the menu's hover delay.
   *
   * <strong>Hover Type "dynamic"</strong>
   * - When a `pointerenter` event triggers on any menu item the menu's
   *   current child value will change to that menu item.
   * - When a `pointerenter` event triggers on any menu item, and the menu's
   *   focus state is not "none", the menu item
   *   will be focused.
   * - When a `pointerenter` event triggers on a submenu item, and a submenu is
   *   already open, the preview method for the submenu item's toggle will be called.
   * - When a `pointerenter` event triggers on a non-submenu item, and a submenu
   *   is already open, the closeChildren method for the menu will be called.
   * - When a `pointerenter` event triggers on a submenu item, and no submenu is
   *   open, no submenu-specific methods will be called.
   *
   * <strong>Hover Type "off"</strong>
   * All `pointerenter` and `pointerleave` events are ignored.
   *
   * @protected
   */
  _handleHover() {
    this.elements.menuItems.forEach((e, s) => {
      e.dom.link.addEventListener("pointerenter", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || (this.hoverType === "on" ? (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusChild(s), e.isSubmenuItem && (this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          e.elements.toggle.preview();
        }, this.enterDelay)) : e.elements.toggle.preview())) : this.hoverType === "dynamic" && (this.currentChild = s, (!this.isTopLevel || this.focusState !== "none") && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild()), (!this.isTopLevel || this.hasOpened) && (this.currentEvent = "mouse", this.elements.rootMenu.blurChildren(), this.focusCurrentChild(), e.isSubmenuItem ? this.enterDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          e.elements.toggle.preview();
        }, this.enterDelay)) : e.elements.toggle.preview() : this.enterDelay > 0 && this._clearTimeout())));
      }), e.isSubmenuItem && (e.dom.item.addEventListener("pointerleave", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || (this.hoverType === "on" ? this.leaveDelay > 0 && this._clearTimeout() : this.hoverType === "dynamic" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.currentEvent = "mouse";
        }, this.leaveDelay)) : this.currentEvent = "mouse"));
      }), e.dom.item.addEventListener("pointerenter", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || e.isSubmenuItem && (this.hoverType === "on" || this.hoverType === "dynamic") && this.leaveDelay > 0 && this._clearTimeout();
      })), this.isTopLevel && this.dom.menu.addEventListener("pointerleave", (n) => {
        n.pointerType === "pen" || n.pointerType === "touch" || this.hoverType === "on" && (this.leaveDelay > 0 ? (this._clearTimeout(), this._setTimeout(() => {
          this.closeChildren(), this.blur();
        }, this.leaveDelay)) : (this.closeChildren(), this.blur()));
      });
    });
  }
  /**
   * Handles keydown events throughout the menu for proper menu use.
   *
   * This method exists to assist the _handleKeyup method.
   * - Adds all `keydown` listeners from BaseMenu's _handleKeydown method
   * - Adds a `keydown` listener to the menu/all submenus.
   *   - Blocks propagation on the following keys: "ArrowUp", "ArrowRight",
   *     "ArrowDown", "ArrowLeft", "Home", "End", "Space", "Enter", "Escape",
   *     "*" (asterisk), and "A" through "Z".
   *   - Moves focus out if the "Tab" key is pressed.
   *
   * @protected
   */
  _handleKeydown() {
    super._handleKeydown(), this.dom.menu.addEventListener("keydown", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e);
      if (s === "Tab" && (this.elements.rootMenu.focusState !== "none" ? this.elements.rootMenu.blur() : this.elements.rootMenu.focus()), this.focusState === "self") {
        const n = [
          "Space",
          "ArrowUp",
          "ArrowDown",
          "ArrowLeft",
          "Asterisk",
          "Home",
          "End"
        ], i = ["Enter", "ArrowRight"], o = ["Escape"];
        (n.includes(s) || this.currentMenuItem.isSubmenuItem && i.includes(s) || this.elements.controller && o.includes(s)) && l(e);
      }
    });
  }
  /**
   * Handles keyup events throughout the menu for proper menu use.
   *
   * Adds all `keyup` listeners from BaseMenu's _handleKeyup method.
   *
   * Adds the following keybindings (explanations are taken from the
   * Navigation Treeview Example Using Computed Properties):
   *
   * | Key | Function |
   * | --- | --- |
   * | _Enter_ or _Space_ | Performs the default action (e.g. onclick event) for the focused node. |
   * | _Down arrow_ | <ul><li>Moves focus to the next node that is focusable without opening or closing a node.</li><li>If focus is on the last node, does nothing.</li></ul> |
   * | _Up arrow_ | <ul><li>Moves focus to the previous node that is focusable without opening or closing a node.</li><li>If focus is on the first node, does nothing.</li></ul> |
   * | _Right arrow_ | <ul><li>When focus is on a closed node, opens the node; focus does not move.</li><li>When focus is on a open node, moves focus to the first child node.</li><li>When focus is on an end node, does nothing.</li></ul> |
   * | _Left arrow_ | <ul><li>When focus is on an open node, closes the node.</li><li>When focus is on a child node that is also either an end node or a closed node, moves focus to its parent node.</li><li>When focus is on a root node that is also either an end node or a closed node, does nothing.</li></ul> |
   * | _Home_ | Moves focus to first node without opening or closing a node. |
   * | _End_ | Moves focus to the last node that can be focused without expanding any nodes that are closed. |
   * | _a-z_, _A-Z_ | <ul><li>Focus moves to the next node with a name that starts with the typed character.</li><li>Search wraps to first node if a matching name is not found among the nodes that follow the focused node.</li><li>Search ignores nodes that are descendants of closed nodes.</li></ul> |
   * | _* (asterisk)_ | <ul><li>Expands all closed sibling nodes that are at the same level as the focused node.</li><li>Focus does not move.</li></ul> |
   * | _Escape_ | If the root menu is collapsible, collapses the menu and focuses the menu's controlling element. |
   *
   * @protected
   */
  _handleKeyup() {
    super._handleKeyup(), this.dom.menu.addEventListener("keyup", (e) => {
      this.currentEvent = "keyboard";
      const s = g(e), { altKey: n, crtlKey: i, metaKey: o } = e;
      if (s === "Character" && !(n || i || o))
        l(e), this.elements.rootMenu.currentEvent = "character", this.focusNextNodeWithCharacter(e.key);
      else if (this.focusState === "self")
        if (s === "Enter" || s === "Space")
          l(e), this.currentMenuItem.isSubmenuItem ? this.currentMenuItem.elements.toggle.isOpen ? this.currentMenuItem.elements.toggle.close() : this.currentMenuItem.elements.toggle.preview() : this.currentMenuItem.dom.link.click();
        else if (s === "Escape")
          this.isTopLevel && this.elements.controller && this.elements.controller.isOpen && (this.elements.controller.close(), this.focusController());
        else if (s === "ArrowDown")
          l(e), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.blurCurrentChild(), this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.currentMenuItem.elements.childMenu.focusFirstChild()) : !this.isTopLevel && this.currentChild === this.elements.menuItems.length - 1 ? this.focusParentsNextChild() : this.focusNextChild();
        else if (s === "ArrowUp") {
          l(e);
          const m = this.elements.menuItems[this.currentChild - 1];
          m && m.isSubmenuItem && m.elements.toggle.isOpen ? (this.blurCurrentChild(), this.currentChild = this.currentChild - 1, this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.focusChildsLastNode()) : !this.isTopLevel && this.currentChild === 0 ? (this.blurCurrentChild(), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.focusCurrentChild()) : this.focusPreviousChild();
        } else s === "ArrowRight" ? this.currentMenuItem.isSubmenuItem && (l(e), this.currentMenuItem.elements.toggle.isOpen ? (this.blurCurrentChild(), this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.currentMenuItem.elements.childMenu.focusFirstChild()) : this.currentMenuItem.elements.toggle.preview()) : s === "ArrowLeft" ? (l(e), this.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.toggle.isOpen ? (this.currentMenuItem.elements.childMenu.blurCurrentChild(), this.currentMenuItem.elements.toggle.close()) : this.isTopLevel || (this.blurCurrentChild(), this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.focusCurrentChild())) : s === "Home" ? (l(e), this.blurCurrentChild(), this.elements.rootMenu.focusFirstChild()) : s === "End" ? (l(e), this.blurCurrentChild(), this.elements.rootMenu.focusLastNode()) : s === "Asterisk" && (l(e), this.openChildren());
    });
  }
  /**
   * Focus the menu's last node of the entire expanded menu.
   *
   * This includes all _open_ child menu items.
   *
   * @public
   */
  focusLastNode() {
    const e = this.elements.menuItems.length - 1, s = this.elements.menuItems[e];
    s.isSubmenuItem && s.elements.toggle.isOpen ? (this.currentChild = e, s.elements.childMenu.currentEvent = this.currentEvent, s.elements.childMenu.focusLastNode()) : this.focusLastChild();
  }
  /**
   * Open all submenu children.
   *
   * @public
   */
  openChildren() {
    this.elements.submenuToggles.forEach((e) => e.preview());
  }
  /**
   * Focus the menu's next node starting with a specific letter.
   *
   * This includes all _open_ child menu items.
   *
   * Wraps to the first node if no match is found after the current node.
   *
   * @public
   *
   * @param {string} char - The character to look for.
   */
  focusNextNodeWithCharacter(e) {
    function s(a) {
      let d = [];
      return a.elements.menuItems.forEach((f) => {
        d.push(f), f.isSubmenuItem && f.elements.toggle.isOpen && (d = [
          ...d,
          ...s(
            f.elements.toggle.elements.controlledMenu
          )
        ]);
      }), d;
    }
    const n = e.toLowerCase(), i = s(this.elements.rootMenu), o = i.indexOf(this.currentMenuItem) + 1, h = [
      ...i.slice(o),
      ...i.slice(0, o)
    ];
    let m = 0, c = !1;
    for (; !c && m < h.length; ) {
      let a = "";
      if (h[m].dom.item.innerText ? a = h[m].dom.item.innerText : a = h[m].dom.item.textContent, a = a.replace(/[\s]/g, "").toLowerCase().charAt(0), a === n) {
        c = !0;
        const d = h[m].elements.parentMenu, f = d.elements.menuItems.indexOf(h[m]);
        this.elements.rootMenu.blurChildren(), d.focusChild(f);
      }
      m++;
    }
  }
  /**
   * Focus the parent menu's next child.
   *
   * This will cascade up through to the root menu.
   *
   * @public
   */
  focusParentsNextChild() {
    this.elements.parentMenu && (this.elements.parentMenu.currentEvent = this.currentEvent, this.elements.parentMenu.currentChild === this.elements.parentMenu.elements.menuItems.length - 1 ? (this.elements.parentMenu.blurCurrentChild(), this.elements.parentMenu.focusParentsNextChild()) : (this.blurChildren(), this.elements.parentMenu.focusNextChild()));
  }
  /**
   * Focus the last child of the current child's submenu.
   *
   * This will cascade down through to the last open menu.
   *
   * @public
   */
  focusChildsLastNode() {
    this.currentMenuItem.elements.childMenu.currentEvent = this.currentEvent, this.currentMenuItem.elements.childMenu.focusLastChild(), this.currentMenuItem.elements.childMenu.currentMenuItem.isSubmenuItem && this.currentMenuItem.elements.childMenu.currentMenuItem.elements.toggle.isOpen && (this.currentMenuItem.elements.childMenu.blurCurrentChild(), this.currentMenuItem.elements.childMenu.focusChildsLastNode());
  }
}
const Y = {
  DisclosureMenu: K,
  Menubar: F,
  TopLinkDisclosureMenu: $,
  Treeview: z
};



/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	!function() {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = function(module) {
/******/ 			var getter = module && module.__esModule ?
/******/ 				function() { return module['default']; } :
/******/ 				function() { return module; };
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
!function() {
"use strict";
/*!***************************************!*\
  !*** ./core-bundle/assets/backend.js ***!
  \***************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hotwired/stimulus */ "./node_modules/@hotwired/stimulus/dist/stimulus.js");
/* harmony import */ var _hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hotwired/stimulus-webpack-helpers */ "./node_modules/@hotwired/stimulus-webpack-helpers/dist/stimulus-webpack-helpers.js");
/* harmony import */ var _hotwired_turbo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @hotwired/turbo */ "./node_modules/@hotwired/turbo/dist/turbo.es2017-esm.js");
/* harmony import */ var _web_auth_webauthn_stimulus__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @web-auth/webauthn-stimulus */ "./vendor/web-auth/webauthn-stimulus/assets/dist/controller.js");
/* harmony import */ var _scripts_mootao_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./scripts/mootao.js */ "./core-bundle/assets/scripts/mootao.js");
/* harmony import */ var _scripts_mootao_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_scripts_mootao_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _scripts_core_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./scripts/core.js */ "./core-bundle/assets/scripts/core.js");
/* harmony import */ var _scripts_core_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_scripts_core_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./scripts/limit-height.js */ "./core-bundle/assets/scripts/limit-height.js");
/* harmony import */ var _scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_scripts_limit_height_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scripts/modulewizard.js */ "./core-bundle/assets/scripts/modulewizard.js");
/* harmony import */ var _scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_scripts_modulewizard_js__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./scripts/sectionwizard.js */ "./core-bundle/assets/scripts/sectionwizard.js");
/* harmony import */ var _scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_scripts_sectionwizard_js__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _styles_backend_pcss__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./styles/backend.pcss */ "./core-bundle/assets/styles/backend.pcss");











// Start the Stimulus application
const application = _hotwired_stimulus__WEBPACK_IMPORTED_MODULE_0__.Application.start();
application.debug = "development" === 'development';

// Register all controllers with `contao--` prefix
const context = __webpack_require__("./core-bundle/assets/controllers sync recursive \\.js$");
application.load(context.keys().map(key => {
  const identifier = (0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.identifierForContextKey)(key);
  if (identifier) {
    return (0,_hotwired_stimulus_webpack_helpers__WEBPACK_IMPORTED_MODULE_1__.definitionForModuleAndIdentifier)(context(key), `contao--${identifier}`);
  }
}).filter(value => value));
application.register('contao--webauthn', _web_auth_webauthn_stimulus__WEBPACK_IMPORTED_MODULE_3__["default"]);

// Cancel all prefetch requests that contain a request token
document.documentElement.addEventListener('turbo:before-prefetch', e => {
  if (new URLSearchParams(e.target.href).has('rt') || e.target.classList.contains('header_back') || e.target.closest('.sf-toolbar') !== null) {
    e.preventDefault();
  }
});

// Make the MooTools scripts reinitialize themselves
const mooDomready = () => {
  if (!document.body.mooDomreadyFired) {
    document.body.mooDomreadyFired = true;
    window.fireEvent('domready');
  }
};
document.documentElement.addEventListener('turbo:render', mooDomready);
document.documentElement.addEventListener('turbo:frame-render', mooDomready);

// Always break out of a missing frame (#7501)
document.documentElement.addEventListener('turbo:frame-missing', e => {
  if (window.console) {
    console.warn('Turbo frame #' + e.target.id + ' is missing.');
  }

  // Do not break out of frames that load their content via src
  if (e.target.hasAttribute('src')) {
    return;
  }
  e.preventDefault();
  e.detail.visit(e.detail.response);
});
}();
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW1JOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNUJuSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDJCQUEyQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkM7QUFDM0MscURBQXFELFFBQVE7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHVDQUF1QztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix1Q0FBdUM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw2QkFBNkIsRUFBRSxJQUFJO0FBQzdELFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLGNBQWM7QUFDekI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGNBQWMsY0FBYztBQUM1QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsV0FBVyx1QkFBdUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsVUFBVTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELDhDQUE4QyxLQUFLO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxtQkFBbUI7QUFDekU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsZUFBZTtBQUNoRSx1REFBdUQscUJBQXFCO0FBQzVFLGtCQUFrQixlQUFlLEVBQUUsWUFBWSxFQUFFLFlBQVksSUFBSSxnQkFBZ0IsR0FBRyxnQkFBZ0I7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxlQUFlO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxnQkFBZ0I7QUFDNUQscUJBQXFCLGNBQWM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFlBQVksaUNBQWlDLGdCQUFnQjtBQUNoRztBQUNBO0FBQ0EsZ0JBQWdCLFVBQVU7QUFDMUIsZ0JBQWdCLDBCQUEwQjtBQUMxQyxnQkFBZ0IsYUFBYTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyx5Q0FBeUM7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyw0QkFBNEI7QUFDbEU7QUFDQTtBQUNBLGdCQUFnQix3QkFBd0I7QUFDeEM7QUFDQTtBQUNBLDZEQUE2RCx1REFBdUQ7QUFDcEg7QUFDQTtBQUNBLG9CQUFvQix5Q0FBeUM7QUFDN0QsNkJBQTZCO0FBQzdCLGdFQUFnRSxZQUFZO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtQkFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixXQUFXO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsMkNBQTJDO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msd0NBQXdDO0FBQzVFO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVGQUF1RixZQUFZO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMERBQTBEO0FBQzFELG9CQUFvQixrQ0FBa0M7QUFDdEQscUNBQXFDLGlDQUFpQztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q3ZLLHVCQUF1QixlQUFlO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsK0JBQStCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtDQUFrQyxpRUFBaUUsSUFBSTtBQUNqSSxpQ0FBaUMsT0FBTyxHQUFHLFVBQVU7QUFDckQsOENBQThDLDZCQUE2QjtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNk47Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2xnRjdOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLGNBQWM7QUFDN0I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsK0JBQStCLDZCQUE2QixJQUFJO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBLHNCQUFzQixZQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtREFBbUQsWUFBWTtBQUMvRCxvREFBb0QsWUFBWTtBQUNoRTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QyxLQUFLO0FBQ25EOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGlCQUFpQjtBQUM3QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUVBQXVFO0FBQ3ZFOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsZ0RBQWdEO0FBQ2hELDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix3QkFBd0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGVBQWU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSx5QkFBeUI7QUFDekI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLFlBQVksMEJBQTBCO0FBQ3RDOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksb0JBQW9CO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVEQUF1RCxPQUFPLGNBQWMsT0FBTztBQUNuRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGNBQWMsS0FBSztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdDQUFnQyxHQUFHO0FBQ25DOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTiw4QkFBOEIsWUFBWTtBQUMxQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFCQUFxQixNQUFNO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEIsWUFBWTtBQUN4Qzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxZQUFZLDZEQUE2RDs7QUFFekU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtRUFBbUUsbUJBQW1CO0FBQ3RGOztBQUVBLDZDQUE2QyxZQUFZO0FBQ3pEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxxRUFBcUUsWUFBWTtBQUNqRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRixpQkFBaUI7QUFDbEc7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlDQUFpQyxpQkFBaUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx1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RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFF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QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0JBQXdCLDZCQUE2QjtBQUNyRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxtREFBbUQsS0FBSztBQUN4RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYyxhQUFhO0FBQzNCO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGNBQWMsMkJBQTJCO0FBQ3pDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxZQUFZLHlCQUF5QjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQSw0QkFBNEIsa0RBQWtEO0FBQzlFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVkseUJBQXlCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTiw0QkFBNEIsa0RBQWtEO0FBQzlFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSxpQkFBaUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLGdCQUFnQjs7QUFFL0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLHlCQUF5QixzRUFBc0UsZUFBZTtBQUM3SDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsR0FBRztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLGNBQWMsUUFBUTtBQUN0QjtBQUNBO0FBQ0EsZ0JBQWdCLDBDQUEwQztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDRFQUE0RSxZQUFZO0FBQ3hGLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9EQUFvRCxnQ0FBZ0M7QUFDcEY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0IseUJBQXlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVkseUJBQXlCO0FBQ3JDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksYUFBYTtBQUN6QjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDBCQUEwQiw4Q0FBOEM7QUFDeEU7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLFVBQVU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksS0FBSzs7QUFFakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxnREFBZ0QsT0FBTztBQUN2RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVksd0JBQXdCOztBQUVwQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSxrQkFBa0I7QUFDOUIsWUFBWSxPQUFPOztBQUVuQjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBLDhCQUE4QixVQUFVLDhCQUE4QjtBQUN0RTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaUNBQWlDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCO0FBQzlCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLCtDQUErQztBQUN2RTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBOztBQUVBO0FBQ0EseUNBQXlDLDBCQUEwQjtBQUNuRTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxnQ0FBZ0MsK0JBQStCO0FBQy9EOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDBCQUEwQixTQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQixNQUFNOztBQUVOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMENBQTBDO0FBQzFEO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0Isb0JBQW9CO0FBQ3BDO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0EscUNBQXFDLFVBQVUsOEJBQThCO0FBQzdFOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCLHFCQUFxQjtBQUNyQztBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBLHNDQUFzQyxVQUFVLGdCQUFnQjtBQUNoRTs7QUFFQSw0Q0FBNEM7QUFDNUM7QUFDQSxnQkFBZ0I7QUFDaEIsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBLDBDQUEwQyxlQUFlO0FBQ3pEOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0IsZUFBZTtBQUMvQjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjs7QUFFQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxRQUFRLGdDQUFnQzs7QUFFeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGVBQWU7O0FBRTNCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLGVBQWU7QUFDM0I7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsMEJBQTBCLGFBQWE7QUFDdkM7QUFDQTs7QUFF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Q0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxFQUFFO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0Esa0JBQWtCLGVBQWU7QUFDakMsa0JBQWtCLGVBQWU7QUFDakMsa0JBQWtCLGVBQWU7QUFDakMsa0JBQWtCLGVBQWU7QUFDakMsa0JBQWtCLGVBQWU7QUFDakMsa0JBQWtCLGVBQWU7QUFDakMsa0JBQWtCLGVBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQSxrQkFBa0IsUUFBUTtBQUMxQixrQkFBa0IsUUFBUTtBQUMxQixrQkFBa0IsUUFBUTtBQUMxQixrQkFBa0IsUUFBUTtBQUMxQixrQkFBa0IsUUFBUTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0Esa0JBQWtCLGtCQUFrQjtBQUNwQyxrQkFBa0Isa0JBQWtCO0FBQ3BDLGtCQUFrQixrQkFBa0I7QUFDcEMsa0JBQWtCLGtCQUFrQjtBQUNwQyxrQkFBa0Isa0JBQWtCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsT0FBTztBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxjQUFjO0FBQ3RCO0FBQ0E7QUFDQSxRQUFRLGVBQWU7QUFDdkI7QUFDQTtBQUNBLFFBQVEsb0JBQW9CO0FBQzVCO0FBQ0E7QUFDQSxrQkFBa0IsVUFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQSxlQUFlLDJEQUEyRDtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSx1QkFBdUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHlCQUF5QjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLG9CQUFvQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxTQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQyw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QixhQUFhLGdCQUFnQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsb0JBQW9CO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckMsYUFBYSx3QkFBd0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBLGtCQUFrQixRQUFRO0FBQzFCLGtCQUFrQixRQUFRO0FBQzFCLGtCQUFrQixRQUFRO0FBQzFCLGtCQUFrQixRQUFRO0FBQzFCLGtCQUFrQixRQUFRO0FBQzFCLGtCQUFrQixRQUFRO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsdUJBQXVCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxTQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0MsNENBQTRDO0FBQzVDLHdCQUF3QjtBQUN4Qix1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCLGFBQWEsaUJBQWlCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCLGFBQWEsYUFBYTtBQUMxQixhQUFhLGFBQWE7QUFDMUIsYUFBYSxhQUFhO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxvQkFBb0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtFQUErRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isb0NBQW9DO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxvQkFBb0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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LEdBQUMvRyxDQUFDLENBQUNPLE1BQU0sQ0FBQ3RFLEVBQUUsR0FBQyxjQUFjLENBQUM7RUFDNUQ7O0VBRUE7RUFDQSxJQUFJK0QsQ0FBQyxDQUFDTyxNQUFNLENBQUM4WixZQUFZLENBQUMsS0FBSyxDQUFDLEVBQUU7SUFDOUI7RUFDSjtFQUVBcmEsQ0FBQyxDQUFDc0YsY0FBYyxDQUFDLENBQUM7RUFDbEJ0RixDQUFDLENBQUMwRixNQUFNLENBQUMrQixLQUFLLENBQUN6SCxDQUFDLENBQUMwRixNQUFNLENBQUNzUSxRQUFRLENBQUM7QUFDckMsQ0FBQyxDQUFDLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvIHN5bmMgXFwuanMkIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AaG90d2lyZWQvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzL2Rpc3Qvc3RpbXVsdXMtd2VicGFjay1oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AaG90d2lyZWQvc3RpbXVsdXMvZGlzdC9zdGltdWx1cy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGhvdHdpcmVkL3R1cmJvL2Rpc3QvdHVyYm8uZXMyMDE3LWVzbS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbW9ud2VwL3BpY2tyL2Rpc3QvcGlja3IubWluLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9hY2UtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvYmFja2VuZC1zZWFyY2gtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY2hvaWNlcy1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9jbGlwYm9hcmQtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY29sb3ItcGlja2VyLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2NvbG9yLXNjaGVtZS1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9kZWVwbGluay1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL2p1bXAtdGFyZ2V0cy1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9saW1pdC1oZWlnaHQtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvbWV0YXdpemFyZC1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9vcGVyYXRpb25zLW1lbnUtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvcGFzc2tleXMtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvcHJvZmlsZS1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9zY3JvbGwtb2Zmc2V0LWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RhYnMtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdGVtcGxhdGUtc3R1ZGlvLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RpbnltY2UtY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9nZ2xlLWZpZWxkc2V0LWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RvZ2dsZS1uYXZpZ2F0aW9uLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RvZ2dsZS1ub2Rlcy1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b29sdGlwcy1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy93ZWJhdXRobi1lcnJvci1jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9tb2R1bGVzL3R3aWctZWRpdG9yLmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9zY3JpcHRzL2NvcmUuanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL3NjcmlwdHMvbGltaXQtaGVpZ2h0LmpzIiwid2VicGFjazovLy8uL2NvcmUtYnVuZGxlL2Fzc2V0cy9zY3JpcHRzL21vZHVsZXdpemFyZC5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvc2NyaXB0cy9tb290YW8uanMiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL3NjcmlwdHMvc2VjdGlvbndpemFyZC5qcyIsIndlYnBhY2s6Ly8vLi92ZW5kb3Ivd2ViLWF1dGgvd2ViYXV0aG4tc3RpbXVsdXMvYXNzZXRzL2Rpc3QvY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9jb3JlLWJ1bmRsZS9hc3NldHMvc3R5bGVzL2JhY2tlbmQucGNzcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZGlzdC9idW5kbGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BzdGltdWx1cy1jb21wb25lbnRzL2NvbG9yLXBpY2tlci9kaXN0L3N0aW11bHVzLWNvbG9yLXBpY2tlci5tanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2FjY2Vzc2libGUtbWVudS9kaXN0L2FjY2Vzc2libGUtbWVudS5lcy5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovLy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vLy4vY29yZS1idW5kbGUvYXNzZXRzL2JhY2tlbmQuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIG1hcCA9IHtcblx0XCIuL2FjZS1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvYWNlLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2JhY2tlbmQtc2VhcmNoLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9iYWNrZW5kLXNlYXJjaC1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9jaG9pY2VzLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9jaG9pY2VzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2NsaXBib2FyZC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY2xpcGJvYXJkLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2NvbG9yLXBpY2tlci1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY29sb3ItcGlja2VyLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2NvbG9yLXNjaGVtZS1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvY29sb3Itc2NoZW1lLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2RlZXBsaW5rLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9kZWVwbGluay1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9pbWFnZS1zaXplLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2p1bXAtdGFyZ2V0cy1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvanVtcC10YXJnZXRzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL2xpbWl0LWhlaWdodC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvbGltaXQtaGVpZ2h0LWNvbnRyb2xsZXIuanNcIixcblx0XCIuL21ldGF3aXphcmQtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL21ldGF3aXphcmQtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vb3BlcmF0aW9ucy1tZW51LWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy9vcGVyYXRpb25zLW1lbnUtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vcGFzc2tleXMtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Bhc3NrZXlzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3Byb2ZpbGUtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3Byb2ZpbGUtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvc2Nyb2xsLW9mZnNldC1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi90YWJzLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90YWJzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RlbXBsYXRlLXN0dWRpby1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdGVtcGxhdGUtc3R1ZGlvLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RpbnltY2UtY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RpbnltY2UtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vdG9nZ2xlLWZpZWxkc2V0LWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b2dnbGUtZmllbGRzZXQtY29udHJvbGxlci5qc1wiLFxuXHRcIi4vdG9nZ2xlLW5hdmlnYXRpb24tY29udHJvbGxlci5qc1wiOiBcIi4vY29yZS1idW5kbGUvYXNzZXRzL2NvbnRyb2xsZXJzL3RvZ2dsZS1uYXZpZ2F0aW9uLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3RvZ2dsZS1ub2Rlcy1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvdG9nZ2xlLW5vZGVzLWNvbnRyb2xsZXIuanNcIixcblx0XCIuL3Rvb2x0aXBzLWNvbnRyb2xsZXIuanNcIjogXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycy90b29sdGlwcy1jb250cm9sbGVyLmpzXCIsXG5cdFwiLi93ZWJhdXRobi1lcnJvci1jb250cm9sbGVyLmpzXCI6IFwiLi9jb3JlLWJ1bmRsZS9hc3NldHMvY29udHJvbGxlcnMvd2ViYXV0aG4tZXJyb3ItY29udHJvbGxlci5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1hcCwgcmVxKSkge1xuXHRcdHZhciBlID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIHJlcSArIFwiJ1wiKTtcblx0XHRlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG5cdFx0dGhyb3cgZTtcblx0fVxuXHRyZXR1cm4gbWFwW3JlcV07XG59XG53ZWJwYWNrQ29udGV4dC5rZXlzID0gZnVuY3Rpb24gd2VicGFja0NvbnRleHRLZXlzKCkge1xuXHRyZXR1cm4gT2JqZWN0LmtleXMobWFwKTtcbn07XG53ZWJwYWNrQ29udGV4dC5yZXNvbHZlID0gd2VicGFja0NvbnRleHRSZXNvbHZlO1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrQ29udGV4dDtcbndlYnBhY2tDb250ZXh0LmlkID0gXCIuL2NvcmUtYnVuZGxlL2Fzc2V0cy9jb250cm9sbGVycyBzeW5jIHJlY3Vyc2l2ZSBcXFxcLmpzJFwiOyIsIi8qXG5TdGltdWx1cyBXZWJwYWNrIEhlbHBlcnMgMS4wLjBcbkNvcHlyaWdodCDCqSAyMDIxIEJhc2VjYW1wLCBMTENcbiAqL1xuZnVuY3Rpb24gZGVmaW5pdGlvbnNGcm9tQ29udGV4dChjb250ZXh0KSB7XG4gICAgcmV0dXJuIGNvbnRleHQua2V5cygpXG4gICAgICAgIC5tYXAoKGtleSkgPT4gZGVmaW5pdGlvbkZvck1vZHVsZVdpdGhDb250ZXh0QW5kS2V5KGNvbnRleHQsIGtleSkpXG4gICAgICAgIC5maWx0ZXIoKHZhbHVlKSA9PiB2YWx1ZSk7XG59XG5mdW5jdGlvbiBkZWZpbml0aW9uRm9yTW9kdWxlV2l0aENvbnRleHRBbmRLZXkoY29udGV4dCwga2V5KSB7XG4gICAgY29uc3QgaWRlbnRpZmllciA9IGlkZW50aWZpZXJGb3JDb250ZXh0S2V5KGtleSk7XG4gICAgaWYgKGlkZW50aWZpZXIpIHtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyKGNvbnRleHQoa2V5KSwgaWRlbnRpZmllcik7XG4gICAgfVxufVxuZnVuY3Rpb24gZGVmaW5pdGlvbkZvck1vZHVsZUFuZElkZW50aWZpZXIobW9kdWxlLCBpZGVudGlmaWVyKSB7XG4gICAgY29uc3QgY29udHJvbGxlckNvbnN0cnVjdG9yID0gbW9kdWxlLmRlZmF1bHQ7XG4gICAgaWYgKHR5cGVvZiBjb250cm9sbGVyQ29uc3RydWN0b3IgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXJDb25zdHJ1Y3RvciB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlkZW50aWZpZXJGb3JDb250ZXh0S2V5KGtleSkge1xuICAgIGNvbnN0IGxvZ2ljYWxOYW1lID0gKGtleS5tYXRjaCgvXig/OlxcLlxcLyk/KC4rKSg/OltfLV1jb250cm9sbGVyXFwuLis/KSQvKSB8fCBbXSlbMV07XG4gICAgaWYgKGxvZ2ljYWxOYW1lKSB7XG4gICAgICAgIHJldHVybiBsb2dpY2FsTmFtZS5yZXBsYWNlKC9fL2csIFwiLVwiKS5yZXBsYWNlKC9cXC8vZywgXCItLVwiKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IGRlZmluaXRpb25Gb3JNb2R1bGVBbmRJZGVudGlmaWVyLCBkZWZpbml0aW9uRm9yTW9kdWxlV2l0aENvbnRleHRBbmRLZXksIGRlZmluaXRpb25zRnJvbUNvbnRleHQsIGlkZW50aWZpZXJGb3JDb250ZXh0S2V5IH07XG4iLCIvKlxuU3RpbXVsdXMgMy4yLjFcbkNvcHlyaWdodCDCqSAyMDIzIEJhc2VjYW1wLCBMTENcbiAqL1xuY2xhc3MgRXZlbnRMaXN0ZW5lciB7XG4gICAgY29uc3RydWN0b3IoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBldmVudE5hbWU7XG4gICAgICAgIHRoaXMuZXZlbnRPcHRpb25zID0gZXZlbnRPcHRpb25zO1xuICAgICAgICB0aGlzLnVub3JkZXJlZEJpbmRpbmdzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMsIHRoaXMuZXZlbnRPcHRpb25zKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuZXZlbnROYW1lLCB0aGlzLCB0aGlzLmV2ZW50T3B0aW9ucyk7XG4gICAgfVxuICAgIGJpbmRpbmdDb25uZWN0ZWQoYmluZGluZykge1xuICAgICAgICB0aGlzLnVub3JkZXJlZEJpbmRpbmdzLmFkZChiaW5kaW5nKTtcbiAgICB9XG4gICAgYmluZGluZ0Rpc2Nvbm5lY3RlZChiaW5kaW5nKSB7XG4gICAgICAgIHRoaXMudW5vcmRlcmVkQmluZGluZ3MuZGVsZXRlKGJpbmRpbmcpO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBleHRlbmRlZEV2ZW50ID0gZXh0ZW5kRXZlbnQoZXZlbnQpO1xuICAgICAgICBmb3IgKGNvbnN0IGJpbmRpbmcgb2YgdGhpcy5iaW5kaW5ncykge1xuICAgICAgICAgICAgaWYgKGV4dGVuZGVkRXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nLmhhbmRsZUV2ZW50KGV4dGVuZGVkRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGhhc0JpbmRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy51bm9yZGVyZWRCaW5kaW5ncy5zaXplID4gMDtcbiAgICB9XG4gICAgZ2V0IGJpbmRpbmdzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnVub3JkZXJlZEJpbmRpbmdzKS5zb3J0KChsZWZ0LCByaWdodCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGVmdEluZGV4ID0gbGVmdC5pbmRleCwgcmlnaHRJbmRleCA9IHJpZ2h0LmluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIGxlZnRJbmRleCA8IHJpZ2h0SW5kZXggPyAtMSA6IGxlZnRJbmRleCA+IHJpZ2h0SW5kZXggPyAxIDogMDtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXh0ZW5kRXZlbnQoZXZlbnQpIHtcbiAgICBpZiAoXCJpbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWRcIiBpbiBldmVudCkge1xuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB7IHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiB9ID0gZXZlbnQ7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGV2ZW50LCB7XG4gICAgICAgICAgICBpbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IGZhbHNlLFxuICAgICAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24uY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY2xhc3MgRGlzcGF0Y2hlciB7XG4gICAgY29uc3RydWN0b3IoYXBwbGljYXRpb24pIHtcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvbiA9IGFwcGxpY2F0aW9uO1xuICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJNYXBzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKChldmVudExpc3RlbmVyKSA9PiBldmVudExpc3RlbmVyLmNvbm5lY3QoKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLmZvckVhY2goKGV2ZW50TGlzdGVuZXIpID0+IGV2ZW50TGlzdGVuZXIuZGlzY29ubmVjdCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMudmFsdWVzKCkpLnJlZHVjZSgobGlzdGVuZXJzLCBtYXApID0+IGxpc3RlbmVycy5jb25jYXQoQXJyYXkuZnJvbShtYXAudmFsdWVzKCkpKSwgW10pO1xuICAgIH1cbiAgICBiaW5kaW5nQ29ubmVjdGVkKGJpbmRpbmcpIHtcbiAgICAgICAgdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJGb3JCaW5kaW5nKGJpbmRpbmcpLmJpbmRpbmdDb25uZWN0ZWQoYmluZGluZyk7XG4gICAgfVxuICAgIGJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZywgY2xlYXJFdmVudExpc3RlbmVycyA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKS5iaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcpO1xuICAgICAgICBpZiAoY2xlYXJFdmVudExpc3RlbmVycylcbiAgICAgICAgICAgIHRoaXMuY2xlYXJFdmVudExpc3RlbmVyc0ZvckJpbmRpbmcoYmluZGluZyk7XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwgPSB7fSkge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmhhbmRsZUVycm9yKGVycm9yLCBgRXJyb3IgJHttZXNzYWdlfWAsIGRldGFpbCk7XG4gICAgfVxuICAgIGNsZWFyRXZlbnRMaXN0ZW5lcnNGb3JCaW5kaW5nKGJpbmRpbmcpIHtcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lciA9IHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKTtcbiAgICAgICAgaWYgKCFldmVudExpc3RlbmVyLmhhc0JpbmRpbmdzKCkpIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVNYXBwZWRFdmVudExpc3RlbmVyRm9yKGJpbmRpbmcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZU1hcHBlZEV2ZW50TGlzdGVuZXJGb3IoYmluZGluZykge1xuICAgICAgICBjb25zdCB7IGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyB9ID0gYmluZGluZztcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lck1hcCA9IHRoaXMuZmV0Y2hFdmVudExpc3RlbmVyTWFwRm9yRXZlbnRUYXJnZXQoZXZlbnRUYXJnZXQpO1xuICAgICAgICBjb25zdCBjYWNoZUtleSA9IHRoaXMuY2FjaGVLZXkoZXZlbnROYW1lLCBldmVudE9wdGlvbnMpO1xuICAgICAgICBldmVudExpc3RlbmVyTWFwLmRlbGV0ZShjYWNoZUtleSk7XG4gICAgICAgIGlmIChldmVudExpc3RlbmVyTWFwLnNpemUgPT0gMClcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMuZGVsZXRlKGV2ZW50VGFyZ2V0KTtcbiAgICB9XG4gICAgZmV0Y2hFdmVudExpc3RlbmVyRm9yQmluZGluZyhiaW5kaW5nKSB7XG4gICAgICAgIGNvbnN0IHsgZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zIH0gPSBiaW5kaW5nO1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICB9XG4gICAgZmV0Y2hFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgICAgICBjb25zdCBldmVudExpc3RlbmVyTWFwID0gdGhpcy5mZXRjaEV2ZW50TGlzdGVuZXJNYXBGb3JFdmVudFRhcmdldChldmVudFRhcmdldCk7XG4gICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5jYWNoZUtleShldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIGxldCBldmVudExpc3RlbmVyID0gZXZlbnRMaXN0ZW5lck1hcC5nZXQoY2FjaGVLZXkpO1xuICAgICAgICBpZiAoIWV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXIgPSB0aGlzLmNyZWF0ZUV2ZW50TGlzdGVuZXIoZXZlbnRUYXJnZXQsIGV2ZW50TmFtZSwgZXZlbnRPcHRpb25zKTtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXJNYXAuc2V0KGNhY2hlS2V5LCBldmVudExpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXZlbnRMaXN0ZW5lcjtcbiAgICB9XG4gICAgY3JlYXRlRXZlbnRMaXN0ZW5lcihldmVudFRhcmdldCwgZXZlbnROYW1lLCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgZXZlbnRMaXN0ZW5lciA9IG5ldyBFdmVudExpc3RlbmVyKGV2ZW50VGFyZ2V0LCBldmVudE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGV2ZW50TGlzdGVuZXIuY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudExpc3RlbmVyO1xuICAgIH1cbiAgICBmZXRjaEV2ZW50TGlzdGVuZXJNYXBGb3JFdmVudFRhcmdldChldmVudFRhcmdldCkge1xuICAgICAgICBsZXQgZXZlbnRMaXN0ZW5lck1hcCA9IHRoaXMuZXZlbnRMaXN0ZW5lck1hcHMuZ2V0KGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgaWYgKCFldmVudExpc3RlbmVyTWFwKSB7XG4gICAgICAgICAgICBldmVudExpc3RlbmVyTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVyTWFwcy5zZXQoZXZlbnRUYXJnZXQsIGV2ZW50TGlzdGVuZXJNYXApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudExpc3RlbmVyTWFwO1xuICAgIH1cbiAgICBjYWNoZUtleShldmVudE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IFtldmVudE5hbWVdO1xuICAgICAgICBPYmplY3Qua2V5cyhldmVudE9wdGlvbnMpXG4gICAgICAgICAgICAuc29ydCgpXG4gICAgICAgICAgICAuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBwYXJ0cy5wdXNoKGAke2V2ZW50T3B0aW9uc1trZXldID8gXCJcIiA6IFwiIVwifSR7a2V5fWApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oXCI6XCIpO1xuICAgIH1cbn1cblxuY29uc3QgZGVmYXVsdEFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzID0ge1xuICAgIHN0b3AoeyBldmVudCwgdmFsdWUgfSkge1xuICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBwcmV2ZW50KHsgZXZlbnQsIHZhbHVlIH0pIHtcbiAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBzZWxmKHsgZXZlbnQsIHZhbHVlLCBlbGVtZW50IH0pIHtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudCA9PT0gZXZlbnQudGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxufTtcbmNvbnN0IGRlc2NyaXB0b3JQYXR0ZXJuID0gL14oPzooPzooW14uXSs/KVxcKyk/KC4rPykoPzpcXC4oLis/KSk/KD86QCh3aW5kb3d8ZG9jdW1lbnQpKT8tPik/KC4rPykoPzojKFteOl0rPykpKD86OiguKykpPyQvO1xuZnVuY3Rpb24gcGFyc2VBY3Rpb25EZXNjcmlwdG9yU3RyaW5nKGRlc2NyaXB0b3JTdHJpbmcpIHtcbiAgICBjb25zdCBzb3VyY2UgPSBkZXNjcmlwdG9yU3RyaW5nLnRyaW0oKTtcbiAgICBjb25zdCBtYXRjaGVzID0gc291cmNlLm1hdGNoKGRlc2NyaXB0b3JQYXR0ZXJuKSB8fCBbXTtcbiAgICBsZXQgZXZlbnROYW1lID0gbWF0Y2hlc1syXTtcbiAgICBsZXQga2V5RmlsdGVyID0gbWF0Y2hlc1szXTtcbiAgICBpZiAoa2V5RmlsdGVyICYmICFbXCJrZXlkb3duXCIsIFwia2V5dXBcIiwgXCJrZXlwcmVzc1wiXS5pbmNsdWRlcyhldmVudE5hbWUpKSB7XG4gICAgICAgIGV2ZW50TmFtZSArPSBgLiR7a2V5RmlsdGVyfWA7XG4gICAgICAgIGtleUZpbHRlciA9IFwiXCI7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGV2ZW50VGFyZ2V0OiBwYXJzZUV2ZW50VGFyZ2V0KG1hdGNoZXNbNF0pLFxuICAgICAgICBldmVudE5hbWUsXG4gICAgICAgIGV2ZW50T3B0aW9uczogbWF0Y2hlc1s3XSA/IHBhcnNlRXZlbnRPcHRpb25zKG1hdGNoZXNbN10pIDoge30sXG4gICAgICAgIGlkZW50aWZpZXI6IG1hdGNoZXNbNV0sXG4gICAgICAgIG1ldGhvZE5hbWU6IG1hdGNoZXNbNl0sXG4gICAgICAgIGtleUZpbHRlcjogbWF0Y2hlc1sxXSB8fCBrZXlGaWx0ZXIsXG4gICAgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlRXZlbnRUYXJnZXQoZXZlbnRUYXJnZXROYW1lKSB7XG4gICAgaWYgKGV2ZW50VGFyZ2V0TmFtZSA9PSBcIndpbmRvd1wiKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50VGFyZ2V0TmFtZSA9PSBcImRvY3VtZW50XCIpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlRXZlbnRPcHRpb25zKGV2ZW50T3B0aW9ucykge1xuICAgIHJldHVybiBldmVudE9wdGlvbnNcbiAgICAgICAgLnNwbGl0KFwiOlwiKVxuICAgICAgICAucmVkdWNlKChvcHRpb25zLCB0b2tlbikgPT4gT2JqZWN0LmFzc2lnbihvcHRpb25zLCB7IFt0b2tlbi5yZXBsYWNlKC9eIS8sIFwiXCIpXTogIS9eIS8udGVzdCh0b2tlbikgfSksIHt9KTtcbn1cbmZ1bmN0aW9uIHN0cmluZ2lmeUV2ZW50VGFyZ2V0KGV2ZW50VGFyZ2V0KSB7XG4gICAgaWYgKGV2ZW50VGFyZ2V0ID09IHdpbmRvdykge1xuICAgICAgICByZXR1cm4gXCJ3aW5kb3dcIjtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgPT0gZG9jdW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIFwiZG9jdW1lbnRcIjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNhbWVsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoLyg/OltfLV0pKFthLXowLTldKS9nLCAoXywgY2hhcikgPT4gY2hhci50b1VwcGVyQ2FzZSgpKTtcbn1cbmZ1bmN0aW9uIG5hbWVzcGFjZUNhbWVsaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIGNhbWVsaXplKHZhbHVlLnJlcGxhY2UoLy0tL2csIFwiLVwiKS5yZXBsYWNlKC9fXy9nLCBcIl9cIikpO1xufVxuZnVuY3Rpb24gY2FwaXRhbGl6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHZhbHVlLnNsaWNlKDEpO1xufVxuZnVuY3Rpb24gZGFzaGVyaXplKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoLyhbQS1aXSkvZywgKF8sIGNoYXIpID0+IGAtJHtjaGFyLnRvTG93ZXJDYXNlKCl9YCk7XG59XG5mdW5jdGlvbiB0b2tlbml6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5tYXRjaCgvW15cXHNdKy9nKSB8fCBbXTtcbn1cblxuZnVuY3Rpb24gaXNTb21ldGhpbmcob2JqZWN0KSB7XG4gICAgcmV0dXJuIG9iamVjdCAhPT0gbnVsbCAmJiBvYmplY3QgIT09IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGhhc1Byb3BlcnR5KG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpO1xufVxuXG5jb25zdCBhbGxNb2RpZmllcnMgPSBbXCJtZXRhXCIsIFwiY3RybFwiLCBcImFsdFwiLCBcInNoaWZ0XCJdO1xuY2xhc3MgQWN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBpbmRleCwgZGVzY3JpcHRvciwgc2NoZW1hKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgdGhpcy5ldmVudFRhcmdldCA9IGRlc2NyaXB0b3IuZXZlbnRUYXJnZXQgfHwgZWxlbWVudDtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBkZXNjcmlwdG9yLmV2ZW50TmFtZSB8fCBnZXREZWZhdWx0RXZlbnROYW1lRm9yRWxlbWVudChlbGVtZW50KSB8fCBlcnJvcihcIm1pc3NpbmcgZXZlbnQgbmFtZVwiKTtcbiAgICAgICAgdGhpcy5ldmVudE9wdGlvbnMgPSBkZXNjcmlwdG9yLmV2ZW50T3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdGhpcy5pZGVudGlmaWVyID0gZGVzY3JpcHRvci5pZGVudGlmaWVyIHx8IGVycm9yKFwibWlzc2luZyBpZGVudGlmaWVyXCIpO1xuICAgICAgICB0aGlzLm1ldGhvZE5hbWUgPSBkZXNjcmlwdG9yLm1ldGhvZE5hbWUgfHwgZXJyb3IoXCJtaXNzaW5nIG1ldGhvZCBuYW1lXCIpO1xuICAgICAgICB0aGlzLmtleUZpbHRlciA9IGRlc2NyaXB0b3Iua2V5RmlsdGVyIHx8IFwiXCI7XG4gICAgICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgIH1cbiAgICBzdGF0aWMgZm9yVG9rZW4odG9rZW4sIHNjaGVtYSkge1xuICAgICAgICByZXR1cm4gbmV3IHRoaXModG9rZW4uZWxlbWVudCwgdG9rZW4uaW5kZXgsIHBhcnNlQWN0aW9uRGVzY3JpcHRvclN0cmluZyh0b2tlbi5jb250ZW50KSwgc2NoZW1hKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50RmlsdGVyID0gdGhpcy5rZXlGaWx0ZXIgPyBgLiR7dGhpcy5rZXlGaWx0ZXJ9YCA6IFwiXCI7XG4gICAgICAgIGNvbnN0IGV2ZW50VGFyZ2V0ID0gdGhpcy5ldmVudFRhcmdldE5hbWUgPyBgQCR7dGhpcy5ldmVudFRhcmdldE5hbWV9YCA6IFwiXCI7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmV2ZW50TmFtZX0ke2V2ZW50RmlsdGVyfSR7ZXZlbnRUYXJnZXR9LT4ke3RoaXMuaWRlbnRpZmllcn0jJHt0aGlzLm1ldGhvZE5hbWV9YDtcbiAgICB9XG4gICAgc2hvdWxkSWdub3JlS2V5Ym9hcmRFdmVudChldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMua2V5RmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsdGVycyA9IHRoaXMua2V5RmlsdGVyLnNwbGl0KFwiK1wiKTtcbiAgICAgICAgaWYgKHRoaXMua2V5RmlsdGVyRGlzc2F0aXNmaWVkKGV2ZW50LCBmaWx0ZXJzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhbmRhcmRGaWx0ZXIgPSBmaWx0ZXJzLmZpbHRlcigoa2V5KSA9PiAhYWxsTW9kaWZpZXJzLmluY2x1ZGVzKGtleSkpWzBdO1xuICAgICAgICBpZiAoIXN0YW5kYXJkRmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFoYXNQcm9wZXJ0eSh0aGlzLmtleU1hcHBpbmdzLCBzdGFuZGFyZEZpbHRlcikpIHtcbiAgICAgICAgICAgIGVycm9yKGBjb250YWlucyB1bmtub3duIGtleSBmaWx0ZXI6ICR7dGhpcy5rZXlGaWx0ZXJ9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMua2V5TWFwcGluZ3Nbc3RhbmRhcmRGaWx0ZXJdLnRvTG93ZXJDYXNlKCkgIT09IGV2ZW50LmtleS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbiAgICBzaG91bGRJZ25vcmVNb3VzZUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5rZXlGaWx0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWx0ZXJzID0gW3RoaXMua2V5RmlsdGVyXTtcbiAgICAgICAgaWYgKHRoaXMua2V5RmlsdGVyRGlzc2F0aXNmaWVkKGV2ZW50LCBmaWx0ZXJzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBnZXQgcGFyYW1zKCkge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7fTtcbiAgICAgICAgY29uc3QgcGF0dGVybiA9IG5ldyBSZWdFeHAoYF5kYXRhLSR7dGhpcy5pZGVudGlmaWVyfS0oLispLXBhcmFtJGAsIFwiaVwiKTtcbiAgICAgICAgZm9yIChjb25zdCB7IG5hbWUsIHZhbHVlIH0gb2YgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQuYXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gbmFtZS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IG1hdGNoICYmIG1hdGNoWzFdO1xuICAgICAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgICAgICAgIHBhcmFtc1tjYW1lbGl6ZShrZXkpXSA9IHR5cGVjYXN0KHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBnZXQgZXZlbnRUYXJnZXROYW1lKCkge1xuICAgICAgICByZXR1cm4gc3RyaW5naWZ5RXZlbnRUYXJnZXQodGhpcy5ldmVudFRhcmdldCk7XG4gICAgfVxuICAgIGdldCBrZXlNYXBwaW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmtleU1hcHBpbmdzO1xuICAgIH1cbiAgICBrZXlGaWx0ZXJEaXNzYXRpc2ZpZWQoZXZlbnQsIGZpbHRlcnMpIHtcbiAgICAgICAgY29uc3QgW21ldGEsIGN0cmwsIGFsdCwgc2hpZnRdID0gYWxsTW9kaWZpZXJzLm1hcCgobW9kaWZpZXIpID0+IGZpbHRlcnMuaW5jbHVkZXMobW9kaWZpZXIpKTtcbiAgICAgICAgcmV0dXJuIGV2ZW50Lm1ldGFLZXkgIT09IG1ldGEgfHwgZXZlbnQuY3RybEtleSAhPT0gY3RybCB8fCBldmVudC5hbHRLZXkgIT09IGFsdCB8fCBldmVudC5zaGlmdEtleSAhPT0gc2hpZnQ7XG4gICAgfVxufVxuY29uc3QgZGVmYXVsdEV2ZW50TmFtZXMgPSB7XG4gICAgYTogKCkgPT4gXCJjbGlja1wiLFxuICAgIGJ1dHRvbjogKCkgPT4gXCJjbGlja1wiLFxuICAgIGZvcm06ICgpID0+IFwic3VibWl0XCIsXG4gICAgZGV0YWlsczogKCkgPT4gXCJ0b2dnbGVcIixcbiAgICBpbnB1dDogKGUpID0+IChlLmdldEF0dHJpYnV0ZShcInR5cGVcIikgPT0gXCJzdWJtaXRcIiA/IFwiY2xpY2tcIiA6IFwiaW5wdXRcIiksXG4gICAgc2VsZWN0OiAoKSA9PiBcImNoYW5nZVwiLFxuICAgIHRleHRhcmVhOiAoKSA9PiBcImlucHV0XCIsXG59O1xuZnVuY3Rpb24gZ2V0RGVmYXVsdEV2ZW50TmFtZUZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgIGNvbnN0IHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAodGFnTmFtZSBpbiBkZWZhdWx0RXZlbnROYW1lcykge1xuICAgICAgICByZXR1cm4gZGVmYXVsdEV2ZW50TmFtZXNbdGFnTmFtZV0oZWxlbWVudCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbn1cbmZ1bmN0aW9uIHR5cGVjYXN0KHZhbHVlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAob19PKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG5cbmNsYXNzIEJpbmRpbmcge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB9XG4gICAgZ2V0IGluZGV4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uaW5kZXg7XG4gICAgfVxuICAgIGdldCBldmVudFRhcmdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uLmV2ZW50VGFyZ2V0O1xuICAgIH1cbiAgICBnZXQgZXZlbnRPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uZXZlbnRPcHRpb25zO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBoYW5kbGVFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBhY3Rpb25FdmVudCA9IHRoaXMucHJlcGFyZUFjdGlvbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgaWYgKHRoaXMud2lsbEJlSW52b2tlZEJ5RXZlbnQoZXZlbnQpICYmIHRoaXMuYXBwbHlFdmVudE1vZGlmaWVycyhhY3Rpb25FdmVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuaW52b2tlV2l0aEV2ZW50KGFjdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgZXZlbnROYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24uZXZlbnROYW1lO1xuICAgIH1cbiAgICBnZXQgbWV0aG9kKCkge1xuICAgICAgICBjb25zdCBtZXRob2QgPSB0aGlzLmNvbnRyb2xsZXJbdGhpcy5tZXRob2ROYW1lXTtcbiAgICAgICAgaWYgKHR5cGVvZiBtZXRob2QgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbWV0aG9kO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQWN0aW9uIFwiJHt0aGlzLmFjdGlvbn1cIiByZWZlcmVuY2VzIHVuZGVmaW5lZCBtZXRob2QgXCIke3RoaXMubWV0aG9kTmFtZX1cImApO1xuICAgIH1cbiAgICBhcHBseUV2ZW50TW9kaWZpZXJzKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdGhpcy5hY3Rpb247XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uRGVzY3JpcHRvckZpbHRlcnMgfSA9IHRoaXMuY29udGV4dC5hcHBsaWNhdGlvbjtcbiAgICAgICAgY29uc3QgeyBjb250cm9sbGVyIH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgICAgIGxldCBwYXNzZXMgPSB0cnVlO1xuICAgICAgICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5ldmVudE9wdGlvbnMpKSB7XG4gICAgICAgICAgICBpZiAobmFtZSBpbiBhY3Rpb25EZXNjcmlwdG9yRmlsdGVycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IGFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzW25hbWVdO1xuICAgICAgICAgICAgICAgIHBhc3NlcyA9IHBhc3NlcyAmJiBmaWx0ZXIoeyBuYW1lLCB2YWx1ZSwgZXZlbnQsIGVsZW1lbnQsIGNvbnRyb2xsZXIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFzc2VzO1xuICAgIH1cbiAgICBwcmVwYXJlQWN0aW9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZXZlbnQsIHsgcGFyYW1zOiB0aGlzLmFjdGlvbi5wYXJhbXMgfSk7XG4gICAgfVxuICAgIGludm9rZVdpdGhFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCB7IHRhcmdldCwgY3VycmVudFRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLm1ldGhvZC5jYWxsKHRoaXMuY29udHJvbGxlciwgZXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmxvZ0RlYnVnQWN0aXZpdHkodGhpcy5tZXRob2ROYW1lLCB7IGV2ZW50LCB0YXJnZXQsIGN1cnJlbnRUYXJnZXQsIGFjdGlvbjogdGhpcy5tZXRob2ROYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50LCBpbmRleCB9ID0gdGhpcztcbiAgICAgICAgICAgIGNvbnN0IGRldGFpbCA9IHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCwgaW5kZXgsIGV2ZW50IH07XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuaGFuZGxlRXJyb3IoZXJyb3IsIGBpbnZva2luZyBhY3Rpb24gXCIke3RoaXMuYWN0aW9ufVwiYCwgZGV0YWlsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aWxsQmVJbnZva2VkQnlFdmVudChldmVudCkge1xuICAgICAgICBjb25zdCBldmVudFRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiB0aGlzLmFjdGlvbi5zaG91bGRJZ25vcmVLZXlib2FyZEV2ZW50KGV2ZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgdGhpcy5hY3Rpb24uc2hvdWxkSWdub3JlTW91c2VFdmVudChldmVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09PSBldmVudFRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50ICYmIHRoaXMuZWxlbWVudC5jb250YWlucyhldmVudFRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmNvbnRhaW5zRWxlbWVudChldmVudFRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5jb250YWluc0VsZW1lbnQodGhpcy5hY3Rpb24uZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuY29udHJvbGxlcjtcbiAgICB9XG4gICAgZ2V0IG1ldGhvZE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGlvbi5tZXRob2ROYW1lO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbn1cblxuY2xhc3MgRWxlbWVudE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXJJbml0ID0geyBhdHRyaWJ1dGVzOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfTtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4gdGhpcy5wcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGF1c2UoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsZW1lbnQsIHRoaXMubXV0YXRpb25PYnNlcnZlckluaXQpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gbmV3IFNldCh0aGlzLm1hdGNoRWxlbWVudHNJblRyZWUoKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzKSkge1xuICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlcy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBBcnJheS5mcm9tKG1hdGNoZXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzTXV0YXRpb24obXV0YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NNdXRhdGlvbihtdXRhdGlvbikge1xuICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PSBcImF0dHJpYnV0ZXNcIikge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQXR0cmlidXRlQ2hhbmdlKG11dGF0aW9uLnRhcmdldCwgbXV0YXRpb24uYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobXV0YXRpb24udHlwZSA9PSBcImNoaWxkTGlzdFwiKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NSZW1vdmVkTm9kZXMobXV0YXRpb24ucmVtb3ZlZE5vZGVzKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0FkZGVkTm9kZXMobXV0YXRpb24uYWRkZWROb2Rlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc0F0dHJpYnV0ZUNoYW5nZShlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmhhcyhlbGVtZW50KSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudEF0dHJpYnV0ZUNoYW5nZWQgJiYgdGhpcy5tYXRjaEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMubWF0Y2hFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc1JlbW92ZWROb2Rlcyhub2Rlcykge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShub2RlcykpIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnRGcm9tTm9kZShub2RlKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzVHJlZShlbGVtZW50LCB0aGlzLnJlbW92ZUVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NBZGRlZE5vZGVzKG5vZGVzKSB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBBcnJheS5mcm9tKG5vZGVzKSkge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudEZyb21Ob2RlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQgJiYgdGhpcy5lbGVtZW50SXNBY3RpdmUoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NUcmVlKGVsZW1lbnQsIHRoaXMuYWRkRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUubWF0Y2hFbGVtZW50KGVsZW1lbnQpO1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUgPSB0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUubWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlKTtcbiAgICB9XG4gICAgcHJvY2Vzc1RyZWUodHJlZSwgcHJvY2Vzc29yKSB7XG4gICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm1hdGNoRWxlbWVudHNJblRyZWUodHJlZSkpIHtcbiAgICAgICAgICAgIHByb2Nlc3Nvci5jYWxsKHRoaXMsIGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRGcm9tTm9kZShub2RlKSB7XG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50SXNBY3RpdmUoZWxlbWVudCkge1xuICAgICAgICBpZiAoZWxlbWVudC5pc0Nvbm5lY3RlZCAhPSB0aGlzLmVsZW1lbnQuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuY29udGFpbnMoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50cy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnRJc0FjdGl2ZShlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuYWRkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudE1hdGNoZWQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50cy5oYXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMuZGVsZXRlKGVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgQXR0cmlidXRlT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IGF0dHJpYnV0ZU5hbWU7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIgPSBuZXcgRWxlbWVudE9ic2VydmVyKGVsZW1lbnQsIHRoaXMpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudE9ic2VydmVyLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIGBbJHt0aGlzLmF0dHJpYnV0ZU5hbWV9XWA7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBwYXVzZShjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5wYXVzZShjYWxsYmFjayk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0YXJ0ZWQ7XG4gICAgfVxuICAgIG1hdGNoRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50Lmhhc0F0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUpO1xuICAgIH1cbiAgICBtYXRjaEVsZW1lbnRzSW5UcmVlKHRyZWUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLm1hdGNoRWxlbWVudCh0cmVlKSA/IFt0cmVlXSA6IFtdO1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gQXJyYXkuZnJvbSh0cmVlLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZWxlY3RvcikpO1xuICAgICAgICByZXR1cm4gbWF0Y2guY29uY2F0KG1hdGNoZXMpO1xuICAgIH1cbiAgICBlbGVtZW50TWF0Y2hlZChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKGVsZW1lbnQsIHRoaXMuYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudFVubWF0Y2hlZChlbGVtZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLmVsZW1lbnRVbm1hdGNoZWRBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZEF0dHJpYnV0ZShlbGVtZW50LCB0aGlzLmF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuZWxlbWVudEF0dHJpYnV0ZVZhbHVlQ2hhbmdlZCAmJiB0aGlzLmF0dHJpYnV0ZU5hbWUgPT0gYXR0cmlidXRlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5lbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBhZGQobWFwLCBrZXksIHZhbHVlKSB7XG4gICAgZmV0Y2gobWFwLCBrZXkpLmFkZCh2YWx1ZSk7XG59XG5mdW5jdGlvbiBkZWwobWFwLCBrZXksIHZhbHVlKSB7XG4gICAgZmV0Y2gobWFwLCBrZXkpLmRlbGV0ZSh2YWx1ZSk7XG4gICAgcHJ1bmUobWFwLCBrZXkpO1xufVxuZnVuY3Rpb24gZmV0Y2gobWFwLCBrZXkpIHtcbiAgICBsZXQgdmFsdWVzID0gbWFwLmdldChrZXkpO1xuICAgIGlmICghdmFsdWVzKSB7XG4gICAgICAgIHZhbHVlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgbWFwLnNldChrZXksIHZhbHVlcyk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZXM7XG59XG5mdW5jdGlvbiBwcnVuZShtYXAsIGtleSkge1xuICAgIGNvbnN0IHZhbHVlcyA9IG1hcC5nZXQoa2V5KTtcbiAgICBpZiAodmFsdWVzICE9IG51bGwgJiYgdmFsdWVzLnNpemUgPT0gMCkge1xuICAgICAgICBtYXAuZGVsZXRlKGtleSk7XG4gICAgfVxufVxuXG5jbGFzcyBNdWx0aW1hcCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudmFsdWVzQnlLZXkgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIGdldCBrZXlzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnZhbHVlc0J5S2V5LmtleXMoKSk7XG4gICAgfVxuICAgIGdldCB2YWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IHNldHMgPSBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkudmFsdWVzKCkpO1xuICAgICAgICByZXR1cm4gc2V0cy5yZWR1Y2UoKHZhbHVlcywgc2V0KSA9PiB2YWx1ZXMuY29uY2F0KEFycmF5LmZyb20oc2V0KSksIFtdKTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIGNvbnN0IHNldHMgPSBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkudmFsdWVzKCkpO1xuICAgICAgICByZXR1cm4gc2V0cy5yZWR1Y2UoKHNpemUsIHNldCkgPT4gc2l6ZSArIHNldC5zaXplLCAwKTtcbiAgICB9XG4gICAgYWRkKGtleSwgdmFsdWUpIHtcbiAgICAgICAgYWRkKHRoaXMudmFsdWVzQnlLZXksIGtleSwgdmFsdWUpO1xuICAgIH1cbiAgICBkZWxldGUoa2V5LCB2YWx1ZSkge1xuICAgICAgICBkZWwodGhpcy52YWx1ZXNCeUtleSwga2V5LCB2YWx1ZSk7XG4gICAgfVxuICAgIGhhcyhrZXksIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMudmFsdWVzQnlLZXkuZ2V0KGtleSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXMgIT0gbnVsbCAmJiB2YWx1ZXMuaGFzKHZhbHVlKTtcbiAgICB9XG4gICAgaGFzS2V5KGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNCeUtleS5oYXMoa2V5KTtcbiAgICB9XG4gICAgaGFzVmFsdWUodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgc2V0cyA9IEFycmF5LmZyb20odGhpcy52YWx1ZXNCeUtleS52YWx1ZXMoKSk7XG4gICAgICAgIHJldHVybiBzZXRzLnNvbWUoKHNldCkgPT4gc2V0Lmhhcyh2YWx1ZSkpO1xuICAgIH1cbiAgICBnZXRWYWx1ZXNGb3JLZXkoa2V5KSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMudmFsdWVzQnlLZXkuZ2V0KGtleSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXMgPyBBcnJheS5mcm9tKHZhbHVlcykgOiBbXTtcbiAgICB9XG4gICAgZ2V0S2V5c0ZvclZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMudmFsdWVzQnlLZXkpXG4gICAgICAgICAgICAuZmlsdGVyKChbX2tleSwgdmFsdWVzXSkgPT4gdmFsdWVzLmhhcyh2YWx1ZSkpXG4gICAgICAgICAgICAubWFwKChba2V5LCBfdmFsdWVzXSkgPT4ga2V5KTtcbiAgICB9XG59XG5cbmNsYXNzIEluZGV4ZWRNdWx0aW1hcCBleHRlbmRzIE11bHRpbWFwIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5rZXlzQnlWYWx1ZSA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5rZXlzQnlWYWx1ZS5rZXlzKCkpO1xuICAgIH1cbiAgICBhZGQoa2V5LCB2YWx1ZSkge1xuICAgICAgICBzdXBlci5hZGQoa2V5LCB2YWx1ZSk7XG4gICAgICAgIGFkZCh0aGlzLmtleXNCeVZhbHVlLCB2YWx1ZSwga2V5KTtcbiAgICB9XG4gICAgZGVsZXRlKGtleSwgdmFsdWUpIHtcbiAgICAgICAgc3VwZXIuZGVsZXRlKGtleSwgdmFsdWUpO1xuICAgICAgICBkZWwodGhpcy5rZXlzQnlWYWx1ZSwgdmFsdWUsIGtleSk7XG4gICAgfVxuICAgIGhhc1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXNCeVZhbHVlLmhhcyh2YWx1ZSk7XG4gICAgfVxuICAgIGdldEtleXNGb3JWYWx1ZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBzZXQgPSB0aGlzLmtleXNCeVZhbHVlLmdldCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBzZXQgPyBBcnJheS5mcm9tKHNldCkgOiBbXTtcbiAgICB9XG59XG5cbmNsYXNzIFNlbGVjdG9yT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHNlbGVjdG9yLCBkZWxlZ2F0ZSwgZGV0YWlscykge1xuICAgICAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgICB0aGlzLmRldGFpbHMgPSBkZXRhaWxzO1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlciA9IG5ldyBFbGVtZW50T2JzZXJ2ZXIoZWxlbWVudCwgdGhpcyk7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5tYXRjaGVzQnlFbGVtZW50ID0gbmV3IE11bHRpbWFwKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RhcnRlZDtcbiAgICB9XG4gICAgZ2V0IHNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3I7XG4gICAgfVxuICAgIHNldCBzZWxlY3RvcihzZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHBhdXNlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudE9ic2VydmVyLnBhdXNlKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRPYnNlcnZlci5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50T2JzZXJ2ZXIuZWxlbWVudDtcbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgeyBzZWxlY3RvciB9ID0gdGhpcztcbiAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gZWxlbWVudC5tYXRjaGVzKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRlbGVnYXRlLnNlbGVjdG9yTWF0Y2hFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMgJiYgdGhpcy5kZWxlZ2F0ZS5zZWxlY3Rvck1hdGNoRWxlbWVudChlbGVtZW50LCB0aGlzLmRldGFpbHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbWF0Y2hFbGVtZW50c0luVHJlZSh0cmVlKSB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0b3IgfSA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLm1hdGNoRWxlbWVudCh0cmVlKSA/IFt0cmVlXSA6IFtdO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IEFycmF5LmZyb20odHJlZS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSkuZmlsdGVyKChtYXRjaCkgPT4gdGhpcy5tYXRjaEVsZW1lbnQobWF0Y2gpKTtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaC5jb25jYXQobWF0Y2hlcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxlbWVudE1hdGNoZWQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCB7IHNlbGVjdG9yIH0gPSB0aGlzO1xuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkKGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3JzID0gdGhpcy5tYXRjaGVzQnlFbGVtZW50LmdldEtleXNGb3JWYWx1ZShlbGVtZW50KTtcbiAgICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBzZWxlY3RvcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JVbm1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRBdHRyaWJ1dGVDaGFuZ2VkKGVsZW1lbnQsIF9hdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0b3IgfSA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMubWF0Y2hFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlZEJlZm9yZSA9IHRoaXMubWF0Y2hlc0J5RWxlbWVudC5oYXMoc2VsZWN0b3IsIGVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoZXMgJiYgIW1hdGNoZWRCZWZvcmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdG9yTWF0Y2hlZChlbGVtZW50LCBzZWxlY3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghbWF0Y2hlcyAmJiBtYXRjaGVkQmVmb3JlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBzZWxlY3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUuc2VsZWN0b3JNYXRjaGVkKGVsZW1lbnQsIHNlbGVjdG9yLCB0aGlzLmRldGFpbHMpO1xuICAgICAgICB0aGlzLm1hdGNoZXNCeUVsZW1lbnQuYWRkKHNlbGVjdG9yLCBlbGVtZW50KTtcbiAgICB9XG4gICAgc2VsZWN0b3JVbm1hdGNoZWQoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zZWxlY3RvclVubWF0Y2hlZChlbGVtZW50LCBzZWxlY3RvciwgdGhpcy5kZXRhaWxzKTtcbiAgICAgICAgdGhpcy5tYXRjaGVzQnlFbGVtZW50LmRlbGV0ZShzZWxlY3RvciwgZWxlbWVudCk7XG4gICAgfVxufVxuXG5jbGFzcyBTdHJpbmdNYXBPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHRoaXMucHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbnMpKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50LCB7IGF0dHJpYnV0ZXM6IHRydWUsIGF0dHJpYnV0ZU9sZFZhbHVlOiB0cnVlIH0pO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLnRha2VSZWNvcmRzKCk7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGVOYW1lIG9mIHRoaXMua25vd25BdHRyaWJ1dGVOYW1lcykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykge1xuICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc011dGF0aW9uKG11dGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9jZXNzTXV0YXRpb24obXV0YXRpb24pIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IG11dGF0aW9uLmF0dHJpYnV0ZU5hbWU7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgbXV0YXRpb24ub2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2hBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5kZWxlZ2F0ZS5nZXRTdHJpbmdNYXBLZXlGb3JBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgIGlmIChrZXkgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0cmluZ01hcC5oYXMoYXR0cmlidXRlTmFtZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcEtleUFkZGVkKGtleSwgYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5zdHJpbmdNYXAuZ2V0KGF0dHJpYnV0ZU5hbWUpICE9IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHJpbmdNYXBWYWx1ZUNoYW5nZWQodmFsdWUsIGtleSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHRoaXMuc3RyaW5nTWFwLmdldChhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcC5kZWxldGUoYXR0cmlidXRlTmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG9sZFZhbHVlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcEtleVJlbW92ZWQoa2V5LCBhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0cmluZ01hcC5zZXQoYXR0cmlidXRlTmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcEtleUFkZGVkKGtleSwgYXR0cmlidXRlTmFtZSkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlBZGRlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlBZGRlZChrZXksIGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcFZhbHVlQ2hhbmdlZCh2YWx1ZSwga2V5LCBvbGRWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBWYWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwVmFsdWVDaGFuZ2VkKHZhbHVlLCBrZXksIG9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBLZXlSZW1vdmVkKGtleSwgYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc3RyaW5nTWFwS2V5UmVtb3ZlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zdHJpbmdNYXBLZXlSZW1vdmVkKGtleSwgYXR0cmlidXRlTmFtZSwgb2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBrbm93bkF0dHJpYnV0ZU5hbWVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KHRoaXMuY3VycmVudEF0dHJpYnV0ZU5hbWVzLmNvbmNhdCh0aGlzLnJlY29yZGVkQXR0cmlidXRlTmFtZXMpKSk7XG4gICAgfVxuICAgIGdldCBjdXJyZW50QXR0cmlidXRlTmFtZXMoKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5hdHRyaWJ1dGVzKS5tYXAoKGF0dHJpYnV0ZSkgPT4gYXR0cmlidXRlLm5hbWUpO1xuICAgIH1cbiAgICBnZXQgcmVjb3JkZWRBdHRyaWJ1dGVOYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5zdHJpbmdNYXAua2V5cygpKTtcbiAgICB9XG59XG5cbmNsYXNzIFRva2VuTGlzdE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyID0gbmV3IEF0dHJpYnV0ZU9ic2VydmVyKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIHRoaXMpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMudG9rZW5zQnlFbGVtZW50ID0gbmV3IE11bHRpbWFwKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBwYXVzZShjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLnBhdXNlKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIucmVmcmVzaCgpO1xuICAgIH1cbiAgICBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXIuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGF0dHJpYnV0ZU5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyLmF0dHJpYnV0ZU5hbWU7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy50b2tlbnNNYXRjaGVkKHRoaXMucmVhZFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCkpO1xuICAgIH1cbiAgICBlbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkKGVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgW3VubWF0Y2hlZFRva2VucywgbWF0Y2hlZFRva2Vuc10gPSB0aGlzLnJlZnJlc2hUb2tlbnNGb3JFbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICB0aGlzLnRva2Vuc1VubWF0Y2hlZCh1bm1hdGNoZWRUb2tlbnMpO1xuICAgICAgICB0aGlzLnRva2Vuc01hdGNoZWQobWF0Y2hlZFRva2Vucyk7XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRBdHRyaWJ1dGUoZWxlbWVudCkge1xuICAgICAgICB0aGlzLnRva2Vuc1VubWF0Y2hlZCh0aGlzLnRva2Vuc0J5RWxlbWVudC5nZXRWYWx1ZXNGb3JLZXkoZWxlbWVudCkpO1xuICAgIH1cbiAgICB0b2tlbnNNYXRjaGVkKHRva2Vucykge1xuICAgICAgICB0b2tlbnMuZm9yRWFjaCgodG9rZW4pID0+IHRoaXMudG9rZW5NYXRjaGVkKHRva2VuKSk7XG4gICAgfVxuICAgIHRva2Vuc1VubWF0Y2hlZCh0b2tlbnMpIHtcbiAgICAgICAgdG9rZW5zLmZvckVhY2goKHRva2VuKSA9PiB0aGlzLnRva2VuVW5tYXRjaGVkKHRva2VuKSk7XG4gICAgfVxuICAgIHRva2VuTWF0Y2hlZCh0b2tlbikge1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnRva2VuTWF0Y2hlZCh0b2tlbik7XG4gICAgICAgIHRoaXMudG9rZW5zQnlFbGVtZW50LmFkZCh0b2tlbi5lbGVtZW50LCB0b2tlbik7XG4gICAgfVxuICAgIHRva2VuVW5tYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudG9rZW5Vbm1hdGNoZWQodG9rZW4pO1xuICAgICAgICB0aGlzLnRva2Vuc0J5RWxlbWVudC5kZWxldGUodG9rZW4uZWxlbWVudCwgdG9rZW4pO1xuICAgIH1cbiAgICByZWZyZXNoVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzVG9rZW5zID0gdGhpcy50b2tlbnNCeUVsZW1lbnQuZ2V0VmFsdWVzRm9yS2V5KGVsZW1lbnQpO1xuICAgICAgICBjb25zdCBjdXJyZW50VG9rZW5zID0gdGhpcy5yZWFkVG9rZW5zRm9yRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgY29uc3QgZmlyc3REaWZmZXJpbmdJbmRleCA9IHppcChwcmV2aW91c1Rva2VucywgY3VycmVudFRva2VucykuZmluZEluZGV4KChbcHJldmlvdXNUb2tlbiwgY3VycmVudFRva2VuXSkgPT4gIXRva2Vuc0FyZUVxdWFsKHByZXZpb3VzVG9rZW4sIGN1cnJlbnRUb2tlbikpO1xuICAgICAgICBpZiAoZmlyc3REaWZmZXJpbmdJbmRleCA9PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIFtbXSwgW11dO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtwcmV2aW91c1Rva2Vucy5zbGljZShmaXJzdERpZmZlcmluZ0luZGV4KSwgY3VycmVudFRva2Vucy5zbGljZShmaXJzdERpZmZlcmluZ0luZGV4KV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVhZFRva2Vuc0ZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5hdHRyaWJ1dGVOYW1lO1xuICAgICAgICBjb25zdCB0b2tlblN0cmluZyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpIHx8IFwiXCI7XG4gICAgICAgIHJldHVybiBwYXJzZVRva2VuU3RyaW5nKHRva2VuU3RyaW5nLCBlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKTtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZVRva2VuU3RyaW5nKHRva2VuU3RyaW5nLCBlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgcmV0dXJuIHRva2VuU3RyaW5nXG4gICAgICAgIC50cmltKClcbiAgICAgICAgLnNwbGl0KC9cXHMrLylcbiAgICAgICAgLmZpbHRlcigoY29udGVudCkgPT4gY29udGVudC5sZW5ndGgpXG4gICAgICAgIC5tYXAoKGNvbnRlbnQsIGluZGV4KSA9PiAoeyBlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBjb250ZW50LCBpbmRleCB9KSk7XG59XG5mdW5jdGlvbiB6aXAobGVmdCwgcmlnaHQpIHtcbiAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1heChsZWZ0Lmxlbmd0aCwgcmlnaHQubGVuZ3RoKTtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aCB9LCAoXywgaW5kZXgpID0+IFtsZWZ0W2luZGV4XSwgcmlnaHRbaW5kZXhdXSk7XG59XG5mdW5jdGlvbiB0b2tlbnNBcmVFcXVhbChsZWZ0LCByaWdodCkge1xuICAgIHJldHVybiBsZWZ0ICYmIHJpZ2h0ICYmIGxlZnQuaW5kZXggPT0gcmlnaHQuaW5kZXggJiYgbGVmdC5jb250ZW50ID09IHJpZ2h0LmNvbnRlbnQ7XG59XG5cbmNsYXNzIFZhbHVlTGlzdE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBhdHRyaWJ1dGVOYW1lLCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyID0gbmV3IFRva2VuTGlzdE9ic2VydmVyKGVsZW1lbnQsIGF0dHJpYnV0ZU5hbWUsIHRoaXMpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMucGFyc2VSZXN1bHRzQnlUb2tlbiA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMudmFsdWVzQnlUb2tlbkJ5RWxlbWVudCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdGFydGVkO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2tlbkxpc3RPYnNlcnZlci5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgYXR0cmlidXRlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuYXR0cmlidXRlTmFtZTtcbiAgICB9XG4gICAgdG9rZW5NYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdG9rZW47XG4gICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXMuZmV0Y2hQYXJzZVJlc3VsdEZvclRva2VuKHRva2VuKTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmZldGNoVmFsdWVzQnlUb2tlbkZvckVsZW1lbnQoZWxlbWVudCkuc2V0KHRva2VuLCB2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRNYXRjaGVkVmFsdWUoZWxlbWVudCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRva2VuVW5tYXRjaGVkKHRva2VuKSB7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gdG9rZW47XG4gICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXMuZmV0Y2hQYXJzZVJlc3VsdEZvclRva2VuKHRva2VuKTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmZldGNoVmFsdWVzQnlUb2tlbkZvckVsZW1lbnQoZWxlbWVudCkuZGVsZXRlKHRva2VuKTtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuZWxlbWVudFVubWF0Y2hlZFZhbHVlKGVsZW1lbnQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmZXRjaFBhcnNlUmVzdWx0Rm9yVG9rZW4odG9rZW4pIHtcbiAgICAgICAgbGV0IHBhcnNlUmVzdWx0ID0gdGhpcy5wYXJzZVJlc3VsdHNCeVRva2VuLmdldCh0b2tlbik7XG4gICAgICAgIGlmICghcGFyc2VSZXN1bHQpIHtcbiAgICAgICAgICAgIHBhcnNlUmVzdWx0ID0gdGhpcy5wYXJzZVRva2VuKHRva2VuKTtcbiAgICAgICAgICAgIHRoaXMucGFyc2VSZXN1bHRzQnlUb2tlbi5zZXQodG9rZW4sIHBhcnNlUmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyc2VSZXN1bHQ7XG4gICAgfVxuICAgIGZldGNoVmFsdWVzQnlUb2tlbkZvckVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICBsZXQgdmFsdWVzQnlUb2tlbiA9IHRoaXMudmFsdWVzQnlUb2tlbkJ5RWxlbWVudC5nZXQoZWxlbWVudCk7XG4gICAgICAgIGlmICghdmFsdWVzQnlUb2tlbikge1xuICAgICAgICAgICAgdmFsdWVzQnlUb2tlbiA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzQnlUb2tlbkJ5RWxlbWVudC5zZXQoZWxlbWVudCwgdmFsdWVzQnlUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlc0J5VG9rZW47XG4gICAgfVxuICAgIHBhcnNlVG9rZW4odG9rZW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5kZWxlZ2F0ZS5wYXJzZVZhbHVlRm9yVG9rZW4odG9rZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWUgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGVycm9yIH07XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIEJpbmRpbmdPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgICAgICB0aGlzLmJpbmRpbmdzQnlBY3Rpb24gPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIgPSBuZXcgVmFsdWVMaXN0T2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLmFjdGlvbkF0dHJpYnV0ZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXI7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBbGxBY3Rpb25zKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuZWxlbWVudDtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IGFjdGlvbkF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmFjdGlvbkF0dHJpYnV0ZTtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zY2hlbWE7XG4gICAgfVxuICAgIGdldCBiaW5kaW5ncygpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5iaW5kaW5nc0J5QWN0aW9uLnZhbHVlcygpKTtcbiAgICB9XG4gICAgY29ubmVjdEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgY29uc3QgYmluZGluZyA9IG5ldyBCaW5kaW5nKHRoaXMuY29udGV4dCwgYWN0aW9uKTtcbiAgICAgICAgdGhpcy5iaW5kaW5nc0J5QWN0aW9uLnNldChhY3Rpb24sIGJpbmRpbmcpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLmJpbmRpbmdDb25uZWN0ZWQoYmluZGluZyk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RBY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgIGNvbnN0IGJpbmRpbmcgPSB0aGlzLmJpbmRpbmdzQnlBY3Rpb24uZ2V0KGFjdGlvbik7XG4gICAgICAgIGlmIChiaW5kaW5nKSB7XG4gICAgICAgICAgICB0aGlzLmJpbmRpbmdzQnlBY3Rpb24uZGVsZXRlKGFjdGlvbik7XG4gICAgICAgICAgICB0aGlzLmRlbGVnYXRlLmJpbmRpbmdEaXNjb25uZWN0ZWQoYmluZGluZyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdEFsbEFjdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuYmluZGluZ3MuZm9yRWFjaCgoYmluZGluZykgPT4gdGhpcy5kZWxlZ2F0ZS5iaW5kaW5nRGlzY29ubmVjdGVkKGJpbmRpbmcsIHRydWUpKTtcbiAgICAgICAgdGhpcy5iaW5kaW5nc0J5QWN0aW9uLmNsZWFyKCk7XG4gICAgfVxuICAgIHBhcnNlVmFsdWVGb3JUb2tlbih0b2tlbikge1xuICAgICAgICBjb25zdCBhY3Rpb24gPSBBY3Rpb24uZm9yVG9rZW4odG9rZW4sIHRoaXMuc2NoZW1hKTtcbiAgICAgICAgaWYgKGFjdGlvbi5pZGVudGlmaWVyID09IHRoaXMuaWRlbnRpZmllcikge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50TWF0Y2hlZFZhbHVlKGVsZW1lbnQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmNvbm5lY3RBY3Rpb24oYWN0aW9uKTtcbiAgICB9XG4gICAgZWxlbWVudFVubWF0Y2hlZFZhbHVlKGVsZW1lbnQsIGFjdGlvbikge1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBY3Rpb24oYWN0aW9uKTtcbiAgICB9XG59XG5cbmNsYXNzIFZhbHVlT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQsIHJlY2VpdmVyKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMucmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXBPYnNlcnZlciA9IG5ldyBTdHJpbmdNYXBPYnNlcnZlcih0aGlzLmVsZW1lbnQsIHRoaXMpO1xuICAgICAgICB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcCA9IHRoaXMuY29udHJvbGxlci52YWx1ZURlc2NyaXB0b3JNYXA7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnN0cmluZ01hcE9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrc0ZvckRlZmF1bHRWYWx1ZXMoKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5zdHJpbmdNYXBPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmNvbnRyb2xsZXI7XG4gICAgfVxuICAgIGdldFN0cmluZ01hcEtleUZvckF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lIGluIHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZURlc2NyaXB0b3JNYXBbYXR0cmlidXRlTmFtZV0ubmFtZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdHJpbmdNYXBLZXlBZGRlZChrZXksIGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwW2F0dHJpYnV0ZU5hbWVdO1xuICAgICAgICBpZiAoIXRoaXMuaGFzVmFsdWUoa2V5KSkge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2soa2V5LCBkZXNjcmlwdG9yLndyaXRlcih0aGlzLnJlY2VpdmVyW2tleV0pLCBkZXNjcmlwdG9yLndyaXRlcihkZXNjcmlwdG9yLmRlZmF1bHRWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0cmluZ01hcFZhbHVlQ2hhbmdlZCh2YWx1ZSwgbmFtZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTmFtZU1hcFtuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAob2xkVmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIG9sZFZhbHVlID0gZGVzY3JpcHRvci53cml0ZXIoZGVzY3JpcHRvci5kZWZhdWx0VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKG5hbWUsIHZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfVxuICAgIHN0cmluZ01hcEtleVJlbW92ZWQoa2V5LCBhdHRyaWJ1dGVOYW1lLCBvbGRWYWx1ZSkge1xuICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gdGhpcy52YWx1ZURlc2NyaXB0b3JOYW1lTWFwW2tleV07XG4gICAgICAgIGlmICh0aGlzLmhhc1ZhbHVlKGtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKGtleSwgZGVzY3JpcHRvci53cml0ZXIodGhpcy5yZWNlaXZlcltrZXldKSwgb2xkVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pbnZva2VDaGFuZ2VkQ2FsbGJhY2soa2V5LCBkZXNjcmlwdG9yLndyaXRlcihkZXNjcmlwdG9yLmRlZmF1bHRWYWx1ZSksIG9sZFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbnZva2VDaGFuZ2VkQ2FsbGJhY2tzRm9yRGVmYXVsdFZhbHVlcygpIHtcbiAgICAgICAgZm9yIChjb25zdCB7IGtleSwgbmFtZSwgZGVmYXVsdFZhbHVlLCB3cml0ZXIgfSBvZiB0aGlzLnZhbHVlRGVzY3JpcHRvcnMpIHtcbiAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWUgIT0gdW5kZWZpbmVkICYmICF0aGlzLmNvbnRyb2xsZXIuZGF0YS5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW52b2tlQ2hhbmdlZENhbGxiYWNrKG5hbWUsIHdyaXRlcihkZWZhdWx0VmFsdWUpLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGludm9rZUNoYW5nZWRDYWxsYmFjayhuYW1lLCByYXdWYWx1ZSwgcmF3T2xkVmFsdWUpIHtcbiAgICAgICAgY29uc3QgY2hhbmdlZE1ldGhvZE5hbWUgPSBgJHtuYW1lfUNoYW5nZWRgO1xuICAgICAgICBjb25zdCBjaGFuZ2VkTWV0aG9kID0gdGhpcy5yZWNlaXZlcltjaGFuZ2VkTWV0aG9kTmFtZV07XG4gICAgICAgIGlmICh0eXBlb2YgY2hhbmdlZE1ldGhvZCA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck5hbWVNYXBbbmFtZV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZGVzY3JpcHRvci5yZWFkZXIocmF3VmFsdWUpO1xuICAgICAgICAgICAgICAgIGxldCBvbGRWYWx1ZSA9IHJhd09sZFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChyYXdPbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZSA9IGRlc2NyaXB0b3IucmVhZGVyKHJhd09sZFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hhbmdlZE1ldGhvZC5jYWxsKHRoaXMucmVjZWl2ZXIsIHZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSA9IGBTdGltdWx1cyBWYWx1ZSBcIiR7dGhpcy5jb250ZXh0LmlkZW50aWZpZXJ9LiR7ZGVzY3JpcHRvci5uYW1lfVwiIC0gJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB2YWx1ZURlc2NyaXB0b3JzKCkge1xuICAgICAgICBjb25zdCB7IHZhbHVlRGVzY3JpcHRvck1hcCB9ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHZhbHVlRGVzY3JpcHRvck1hcCkubWFwKChrZXkpID0+IHZhbHVlRGVzY3JpcHRvck1hcFtrZXldKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlRGVzY3JpcHRvck5hbWVNYXAoKSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3JzID0ge307XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMudmFsdWVEZXNjcmlwdG9yTWFwKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0b3IgPSB0aGlzLnZhbHVlRGVzY3JpcHRvck1hcFtrZXldO1xuICAgICAgICAgICAgZGVzY3JpcHRvcnNbZGVzY3JpcHRvci5uYW1lXSA9IGRlc2NyaXB0b3I7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcnM7XG4gICAgfVxuICAgIGhhc1ZhbHVlKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IHRoaXMudmFsdWVEZXNjcmlwdG9yTmFtZU1hcFthdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgY29uc3QgaGFzTWV0aG9kTmFtZSA9IGBoYXMke2NhcGl0YWxpemUoZGVzY3JpcHRvci5uYW1lKX1gO1xuICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlcltoYXNNZXRob2ROYW1lXTtcbiAgICB9XG59XG5cbmNsYXNzIFRhcmdldE9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0LCBkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMudGFyZ2V0c0J5TmFtZSA9IG5ldyBNdWx0aW1hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRva2VuTGlzdE9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLnRva2VuTGlzdE9ic2VydmVyID0gbmV3IFRva2VuTGlzdE9ic2VydmVyKHRoaXMuZWxlbWVudCwgdGhpcy5hdHRyaWJ1dGVOYW1lLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudG9rZW5MaXN0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICBpZiAodGhpcy50b2tlbkxpc3RPYnNlcnZlcikge1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0QWxsVGFyZ2V0cygpO1xuICAgICAgICAgICAgdGhpcy50b2tlbkxpc3RPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy50b2tlbkxpc3RPYnNlcnZlcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b2tlbk1hdGNoZWQoeyBlbGVtZW50LCBjb250ZW50OiBuYW1lIH0pIHtcbiAgICAgICAgaWYgKHRoaXMuc2NvcGUuY29udGFpbnNFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9rZW5Vbm1hdGNoZWQoeyBlbGVtZW50LCBjb250ZW50OiBuYW1lIH0pIHtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpO1xuICAgIH1cbiAgICBjb25uZWN0VGFyZ2V0KGVsZW1lbnQsIG5hbWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAoIXRoaXMudGFyZ2V0c0J5TmFtZS5oYXMobmFtZSwgZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0c0J5TmFtZS5hZGQobmFtZSwgZWxlbWVudCk7XG4gICAgICAgICAgICAoX2EgPSB0aGlzLnRva2VuTGlzdE9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGF1c2UoKCkgPT4gdGhpcy5kZWxlZ2F0ZS50YXJnZXRDb25uZWN0ZWQoZWxlbWVudCwgbmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RUYXJnZXQoZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldHNCeU5hbWUuaGFzKG5hbWUsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldHNCeU5hbWUuZGVsZXRlKG5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgKF9hID0gdGhpcy50b2tlbkxpc3RPYnNlcnZlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhdXNlKCgpID0+IHRoaXMuZGVsZWdhdGUudGFyZ2V0RGlzY29ubmVjdGVkKGVsZW1lbnQsIG5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0QWxsVGFyZ2V0cygpIHtcbiAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIHRoaXMudGFyZ2V0c0J5TmFtZS5rZXlzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy50YXJnZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShuYW1lKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdFRhcmdldChlbGVtZW50LCBuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgYXR0cmlidXRlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIGBkYXRhLSR7dGhpcy5jb250ZXh0LmlkZW50aWZpZXJ9LXRhcmdldGA7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzY29wZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zY29wZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBhbmNlc3RvcnMgPSBnZXRBbmNlc3RvcnNGb3JDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcik7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oYW5jZXN0b3JzLnJlZHVjZSgodmFsdWVzLCBjb25zdHJ1Y3RvcikgPT4ge1xuICAgICAgICBnZXRPd25TdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgcHJvcGVydHlOYW1lKS5mb3JFYWNoKChuYW1lKSA9PiB2YWx1ZXMuYWRkKG5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9LCBuZXcgU2V0KCkpKTtcbn1cbmZ1bmN0aW9uIHJlYWRJbmhlcml0YWJsZVN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBhbmNlc3RvcnMgPSBnZXRBbmNlc3RvcnNGb3JDb25zdHJ1Y3Rvcihjb25zdHJ1Y3Rvcik7XG4gICAgcmV0dXJuIGFuY2VzdG9ycy5yZWR1Y2UoKHBhaXJzLCBjb25zdHJ1Y3RvcikgPT4ge1xuICAgICAgICBwYWlycy5wdXNoKC4uLmdldE93blN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHBhaXJzO1xuICAgIH0sIFtdKTtcbn1cbmZ1bmN0aW9uIGdldEFuY2VzdG9yc0ZvckNvbnN0cnVjdG9yKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgYW5jZXN0b3JzID0gW107XG4gICAgd2hpbGUgKGNvbnN0cnVjdG9yKSB7XG4gICAgICAgIGFuY2VzdG9ycy5wdXNoKGNvbnN0cnVjdG9yKTtcbiAgICAgICAgY29uc3RydWN0b3IgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoY29uc3RydWN0b3IpO1xuICAgIH1cbiAgICByZXR1cm4gYW5jZXN0b3JzLnJldmVyc2UoKTtcbn1cbmZ1bmN0aW9uIGdldE93blN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gY29uc3RydWN0b3JbcHJvcGVydHlOYW1lXTtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShkZWZpbml0aW9uKSA/IGRlZmluaXRpb24gOiBbXTtcbn1cbmZ1bmN0aW9uIGdldE93blN0YXRpY09iamVjdFBhaXJzKGNvbnN0cnVjdG9yLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBjb25zdCBkZWZpbml0aW9uID0gY29uc3RydWN0b3JbcHJvcGVydHlOYW1lXTtcbiAgICByZXR1cm4gZGVmaW5pdGlvbiA/IE9iamVjdC5rZXlzKGRlZmluaXRpb24pLm1hcCgoa2V5KSA9PiBba2V5LCBkZWZpbml0aW9uW2tleV1dKSA6IFtdO1xufVxuXG5jbGFzcyBPdXRsZXRPYnNlcnZlciB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICAgICAgdGhpcy5vdXRsZXRzQnlOYW1lID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUgPSBuZXcgTXVsdGltYXAoKTtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZU9ic2VydmVyTWFwID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0RGVmaW5pdGlvbnMuZm9yRWFjaCgob3V0bGV0TmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dXBBdHRyaWJ1dGVPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW50Q29udGV4dHMuZm9yRWFjaCgoY29udGV4dCkgPT4gY29udGV4dC5yZWZyZXNoKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIucmVmcmVzaCgpKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIucmVmcmVzaCgpKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RBbGxPdXRsZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BTZWxlY3Rvck9ic2VydmVycygpO1xuICAgICAgICAgICAgdGhpcy5zdG9wQXR0cmlidXRlT2JzZXJ2ZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RvcFNlbGVjdG9yT2JzZXJ2ZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuZm9yRWFjaCgob2JzZXJ2ZXIpID0+IG9ic2VydmVyLnN0b3AoKSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9yT2JzZXJ2ZXJNYXAuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdG9wQXR0cmlidXRlT2JzZXJ2ZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVPYnNlcnZlck1hcC5mb3JFYWNoKChvYnNlcnZlcikgPT4gb2JzZXJ2ZXIuc3RvcCgpKTtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXJNYXAuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3Rvck1hdGNoZWQoZWxlbWVudCwgX3NlbGVjdG9yLCB7IG91dGxldE5hbWUgfSkge1xuICAgICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLmdldE91dGxldChlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKG91dGxldCkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0b3JVbm1hdGNoZWQoZWxlbWVudCwgX3NlbGVjdG9yLCB7IG91dGxldE5hbWUgfSkge1xuICAgICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLmdldE91dGxldEZyb21NYXAoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIGlmIChvdXRsZXQpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdE91dGxldChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdG9yTWF0Y2hFbGVtZW50KGVsZW1lbnQsIHsgb3V0bGV0TmFtZSB9KSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5zZWxlY3RvcihvdXRsZXROYW1lKTtcbiAgICAgICAgY29uc3QgaGFzT3V0bGV0ID0gdGhpcy5oYXNPdXRsZXQoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgICAgIGNvbnN0IGhhc091dGxldENvbnRyb2xsZXIgPSBlbGVtZW50Lm1hdGNoZXMoYFske3RoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGV9fj0ke291dGxldE5hbWV9XWApO1xuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBoYXNPdXRsZXQgJiYgaGFzT3V0bGV0Q29udHJvbGxlciAmJiBlbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkQXR0cmlidXRlKF9lbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IG91dGxldE5hbWUgPSB0aGlzLmdldE91dGxldE5hbWVGcm9tT3V0bGV0QXR0cmlidXRlTmFtZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKG91dGxldE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50QXR0cmlidXRlVmFsdWVDaGFuZ2VkKF9lbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IG91dGxldE5hbWUgPSB0aGlzLmdldE91dGxldE5hbWVGcm9tT3V0bGV0QXR0cmlidXRlTmFtZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKG91dGxldE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbGVtZW50VW5tYXRjaGVkQXR0cmlidXRlKF9lbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IG91dGxldE5hbWUgPSB0aGlzLmdldE91dGxldE5hbWVGcm9tT3V0bGV0QXR0cmlidXRlTmFtZShhdHRyaWJ1dGVOYW1lKTtcbiAgICAgICAgaWYgKG91dGxldE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25uZWN0T3V0bGV0KG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICghdGhpcy5vdXRsZXRFbGVtZW50c0J5TmFtZS5oYXMob3V0bGV0TmFtZSwgZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0c0J5TmFtZS5hZGQob3V0bGV0TmFtZSwgb3V0bGV0KTtcbiAgICAgICAgICAgIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuYWRkKG91dGxldE5hbWUsIGVsZW1lbnQpO1xuICAgICAgICAgICAgKF9hID0gdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLmdldChvdXRsZXROYW1lKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhdXNlKCgpID0+IHRoaXMuZGVsZWdhdGUub3V0bGV0Q29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgb3V0bGV0TmFtZSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuaGFzKG91dGxldE5hbWUsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLm91dGxldHNCeU5hbWUuZGVsZXRlKG91dGxldE5hbWUsIG91dGxldCk7XG4gICAgICAgICAgICB0aGlzLm91dGxldEVsZW1lbnRzQnlOYW1lLmRlbGV0ZShvdXRsZXROYW1lLCBlbGVtZW50KTtcbiAgICAgICAgICAgIChfYSA9IHRoaXMuc2VsZWN0b3JPYnNlcnZlck1hcFxuICAgICAgICAgICAgICAgIC5nZXQob3V0bGV0TmFtZSkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXVzZSgoKSA9PiB0aGlzLmRlbGVnYXRlLm91dGxldERpc2Nvbm5lY3RlZChvdXRsZXQsIGVsZW1lbnQsIG91dGxldE5hbWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNjb25uZWN0QWxsT3V0bGV0cygpIHtcbiAgICAgICAgZm9yIChjb25zdCBvdXRsZXROYW1lIG9mIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUua2V5cykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMub3V0bGV0RWxlbWVudHNCeU5hbWUuZ2V0VmFsdWVzRm9yS2V5KG91dGxldE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBvdXRsZXQgb2YgdGhpcy5vdXRsZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShvdXRsZXROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPdXRsZXQob3V0bGV0LCBlbGVtZW50LCBvdXRsZXROYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlU2VsZWN0b3JPYnNlcnZlckZvck91dGxldChvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLmdldChvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKG9ic2VydmVyKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5zZWxlY3RvciA9IHRoaXMuc2VsZWN0b3Iob3V0bGV0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0dXBTZWxlY3Rvck9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yKG91dGxldE5hbWUpO1xuICAgICAgICBjb25zdCBzZWxlY3Rvck9ic2VydmVyID0gbmV3IFNlbGVjdG9yT2JzZXJ2ZXIoZG9jdW1lbnQuYm9keSwgc2VsZWN0b3IsIHRoaXMsIHsgb3V0bGV0TmFtZSB9KTtcbiAgICAgICAgdGhpcy5zZWxlY3Rvck9ic2VydmVyTWFwLnNldChvdXRsZXROYW1lLCBzZWxlY3Rvck9ic2VydmVyKTtcbiAgICAgICAgc2VsZWN0b3JPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzZXR1cEF0dHJpYnV0ZU9ic2VydmVyRm9yT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuYXR0cmlidXRlTmFtZUZvck91dGxldE5hbWUob3V0bGV0TmFtZSk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU9ic2VydmVyID0gbmV3IEF0dHJpYnV0ZU9ic2VydmVyKHRoaXMuc2NvcGUuZWxlbWVudCwgYXR0cmlidXRlTmFtZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlT2JzZXJ2ZXJNYXAuc2V0KG91dGxldE5hbWUsIGF0dHJpYnV0ZU9ic2VydmVyKTtcbiAgICAgICAgYXR0cmlidXRlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgc2VsZWN0b3Iob3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5vdXRsZXRzLmdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICB9XG4gICAgYXR0cmlidXRlTmFtZUZvck91dGxldE5hbWUob3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5zY2hlbWEub3V0bGV0QXR0cmlidXRlRm9yU2NvcGUodGhpcy5pZGVudGlmaWVyLCBvdXRsZXROYW1lKTtcbiAgICB9XG4gICAgZ2V0T3V0bGV0TmFtZUZyb21PdXRsZXRBdHRyaWJ1dGVOYW1lKGF0dHJpYnV0ZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0RGVmaW5pdGlvbnMuZmluZCgob3V0bGV0TmFtZSkgPT4gdGhpcy5hdHRyaWJ1dGVOYW1lRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKSA9PT0gYXR0cmlidXRlTmFtZSk7XG4gICAgfVxuICAgIGdldCBvdXRsZXREZXBlbmRlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBNdWx0aW1hcCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5tb2R1bGVzLmZvckVhY2goKG1vZHVsZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29uc3RydWN0b3IgPSBtb2R1bGUuZGVmaW5pdGlvbi5jb250cm9sbGVyQ29uc3RydWN0b3I7XG4gICAgICAgICAgICBjb25zdCBvdXRsZXRzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwib3V0bGV0c1wiKTtcbiAgICAgICAgICAgIG91dGxldHMuZm9yRWFjaCgob3V0bGV0KSA9PiBkZXBlbmRlbmNpZXMuYWRkKG91dGxldCwgbW9kdWxlLmlkZW50aWZpZXIpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkZXBlbmRlbmNpZXM7XG4gICAgfVxuICAgIGdldCBvdXRsZXREZWZpbml0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0RGVwZW5kZW5jaWVzLmdldEtleXNGb3JWYWx1ZSh0aGlzLmlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBnZXQgZGVwZW5kZW50Q29udHJvbGxlcklkZW50aWZpZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXREZXBlbmRlbmNpZXMuZ2V0VmFsdWVzRm9yS2V5KHRoaXMuaWRlbnRpZmllcik7XG4gICAgfVxuICAgIGdldCBkZXBlbmRlbnRDb250ZXh0cygpIHtcbiAgICAgICAgY29uc3QgaWRlbnRpZmllcnMgPSB0aGlzLmRlcGVuZGVudENvbnRyb2xsZXJJZGVudGlmaWVycztcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbnRleHRzLmZpbHRlcigoY29udGV4dCkgPT4gaWRlbnRpZmllcnMuaW5jbHVkZXMoY29udGV4dC5pZGVudGlmaWVyKSk7XG4gICAgfVxuICAgIGhhc091dGxldChlbGVtZW50LCBvdXRsZXROYW1lKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuZ2V0T3V0bGV0KGVsZW1lbnQsIG91dGxldE5hbWUpIHx8ICEhdGhpcy5nZXRPdXRsZXRGcm9tTWFwKGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBnZXRPdXRsZXQoZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgfVxuICAgIGdldE91dGxldEZyb21NYXAoZWxlbWVudCwgb3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzQnlOYW1lLmdldFZhbHVlc0ZvcktleShvdXRsZXROYW1lKS5maW5kKChvdXRsZXQpID0+IG91dGxldC5lbGVtZW50ID09PSBlbGVtZW50KTtcbiAgICB9XG4gICAgZ2V0IHNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjb3BlO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGlkZW50aWZpZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IGFwcGxpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBnZXQgcm91dGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWNhdGlvbi5yb3V0ZXI7XG4gICAgfVxufVxuXG5jbGFzcyBDb250ZXh0IHtcbiAgICBjb25zdHJ1Y3Rvcihtb2R1bGUsIHNjb3BlKSB7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eSA9IChmdW5jdGlvbk5hbWUsIGRldGFpbCA9IHt9KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXIsIGVsZW1lbnQgfSA9IHRoaXM7XG4gICAgICAgICAgICBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCB9LCBkZXRhaWwpO1xuICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbi5sb2dEZWJ1Z0FjdGl2aXR5KHRoaXMuaWRlbnRpZmllciwgZnVuY3Rpb25OYW1lLCBkZXRhaWwpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm1vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgbW9kdWxlLmNvbnRyb2xsZXJDb25zdHJ1Y3Rvcih0aGlzKTtcbiAgICAgICAgdGhpcy5iaW5kaW5nT2JzZXJ2ZXIgPSBuZXcgQmluZGluZ09ic2VydmVyKHRoaXMsIHRoaXMuZGlzcGF0Y2hlcik7XG4gICAgICAgIHRoaXMudmFsdWVPYnNlcnZlciA9IG5ldyBWYWx1ZU9ic2VydmVyKHRoaXMsIHRoaXMuY29udHJvbGxlcik7XG4gICAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIgPSBuZXcgVGFyZ2V0T2JzZXJ2ZXIodGhpcywgdGhpcyk7XG4gICAgICAgIHRoaXMub3V0bGV0T2JzZXJ2ZXIgPSBuZXcgT3V0bGV0T2JzZXJ2ZXIodGhpcywgdGhpcyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgdGhpcy5sb2dEZWJ1Z0FjdGl2aXR5KFwiaW5pdGlhbGl6ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIFwiaW5pdGlhbGl6aW5nIGNvbnRyb2xsZXJcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5iaW5kaW5nT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy52YWx1ZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5vdXRsZXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmNvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImNvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBcImNvbm5lY3RpbmcgY29udHJvbGxlclwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLm91dGxldE9ic2VydmVyLnJlZnJlc2goKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJkaXNjb25uZWN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgXCJkaXNjb25uZWN0aW5nIGNvbnRyb2xsZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vdXRsZXRPYnNlcnZlci5zdG9wKCk7XG4gICAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLnZhbHVlT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLmJpbmRpbmdPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGdldCBhcHBsaWNhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kdWxlLmFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kdWxlLmlkZW50aWZpZXI7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGRpc3BhdGNoZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLmRpc3BhdGNoZXI7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgcGFyZW50RWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsID0ge30pIHtcbiAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyLCBjb250cm9sbGVyLCBlbGVtZW50IH0gPSB0aGlzO1xuICAgICAgICBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHsgaWRlbnRpZmllciwgY29udHJvbGxlciwgZWxlbWVudCB9LCBkZXRhaWwpO1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmhhbmRsZUVycm9yKGVycm9yLCBgRXJyb3IgJHttZXNzYWdlfWAsIGRldGFpbCk7XG4gICAgfVxuICAgIHRhcmdldENvbm5lY3RlZChlbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHRoaXMuaW52b2tlQ29udHJvbGxlck1ldGhvZChgJHtuYW1lfVRhcmdldENvbm5lY3RlZGAsIGVsZW1lbnQpO1xuICAgIH1cbiAgICB0YXJnZXREaXNjb25uZWN0ZWQoZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB0aGlzLmludm9rZUNvbnRyb2xsZXJNZXRob2QoYCR7bmFtZX1UYXJnZXREaXNjb25uZWN0ZWRgLCBlbGVtZW50KTtcbiAgICB9XG4gICAgb3V0bGV0Q29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB0aGlzLmludm9rZUNvbnRyb2xsZXJNZXRob2QoYCR7bmFtZXNwYWNlQ2FtZWxpemUobmFtZSl9T3V0bGV0Q29ubmVjdGVkYCwgb3V0bGV0LCBlbGVtZW50KTtcbiAgICB9XG4gICAgb3V0bGV0RGlzY29ubmVjdGVkKG91dGxldCwgZWxlbWVudCwgbmFtZSkge1xuICAgICAgICB0aGlzLmludm9rZUNvbnRyb2xsZXJNZXRob2QoYCR7bmFtZXNwYWNlQ2FtZWxpemUobmFtZSl9T3V0bGV0RGlzY29ubmVjdGVkYCwgb3V0bGV0LCBlbGVtZW50KTtcbiAgICB9XG4gICAgaW52b2tlQ29udHJvbGxlck1ldGhvZChtZXRob2ROYW1lLCAuLi5hcmdzKSB7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSB0aGlzLmNvbnRyb2xsZXI7XG4gICAgICAgIGlmICh0eXBlb2YgY29udHJvbGxlclttZXRob2ROYW1lXSA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXJbbWV0aG9kTmFtZV0oLi4uYXJncyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGJsZXNzKGNvbnN0cnVjdG9yKSB7XG4gICAgcmV0dXJuIHNoYWRvdyhjb25zdHJ1Y3RvciwgZ2V0Qmxlc3NlZFByb3BlcnRpZXMoY29uc3RydWN0b3IpKTtcbn1cbmZ1bmN0aW9uIHNoYWRvdyhjb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIGNvbnN0IHNoYWRvd0NvbnN0cnVjdG9yID0gZXh0ZW5kKGNvbnN0cnVjdG9yKTtcbiAgICBjb25zdCBzaGFkb3dQcm9wZXJ0aWVzID0gZ2V0U2hhZG93UHJvcGVydGllcyhjb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3BlcnRpZXMpO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHNoYWRvd0NvbnN0cnVjdG9yLnByb3RvdHlwZSwgc2hhZG93UHJvcGVydGllcyk7XG4gICAgcmV0dXJuIHNoYWRvd0NvbnN0cnVjdG9yO1xufVxuZnVuY3Rpb24gZ2V0Qmxlc3NlZFByb3BlcnRpZXMoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCBibGVzc2luZ3MgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgXCJibGVzc2luZ3NcIik7XG4gICAgcmV0dXJuIGJsZXNzaW5ncy5yZWR1Y2UoKGJsZXNzZWRQcm9wZXJ0aWVzLCBibGVzc2luZykgPT4ge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gYmxlc3NpbmcoY29uc3RydWN0b3IpO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdG9yID0gYmxlc3NlZFByb3BlcnRpZXNba2V5XSB8fCB7fTtcbiAgICAgICAgICAgIGJsZXNzZWRQcm9wZXJ0aWVzW2tleV0gPSBPYmplY3QuYXNzaWduKGRlc2NyaXB0b3IsIHByb3BlcnRpZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJsZXNzZWRQcm9wZXJ0aWVzO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIGdldFNoYWRvd1Byb3BlcnRpZXMocHJvdG90eXBlLCBwcm9wZXJ0aWVzKSB7XG4gICAgcmV0dXJuIGdldE93bktleXMocHJvcGVydGllcykucmVkdWNlKChzaGFkb3dQcm9wZXJ0aWVzLCBrZXkpID0+IHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IGdldFNoYWRvd2VkRGVzY3JpcHRvcihwcm90b3R5cGUsIHByb3BlcnRpZXMsIGtleSk7XG4gICAgICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHNoYWRvd1Byb3BlcnRpZXMsIHsgW2tleV06IGRlc2NyaXB0b3IgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoYWRvd1Byb3BlcnRpZXM7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gZ2V0U2hhZG93ZWREZXNjcmlwdG9yKHByb3RvdHlwZSwgcHJvcGVydGllcywga2V5KSB7XG4gICAgY29uc3Qgc2hhZG93aW5nRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG90eXBlLCBrZXkpO1xuICAgIGNvbnN0IHNoYWRvd2VkQnlWYWx1ZSA9IHNoYWRvd2luZ0Rlc2NyaXB0b3IgJiYgXCJ2YWx1ZVwiIGluIHNoYWRvd2luZ0Rlc2NyaXB0b3I7XG4gICAgaWYgKCFzaGFkb3dlZEJ5VmFsdWUpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvcGVydGllcywga2V5KS52YWx1ZTtcbiAgICAgICAgaWYgKHNoYWRvd2luZ0Rlc2NyaXB0b3IpIHtcbiAgICAgICAgICAgIGRlc2NyaXB0b3IuZ2V0ID0gc2hhZG93aW5nRGVzY3JpcHRvci5nZXQgfHwgZGVzY3JpcHRvci5nZXQ7XG4gICAgICAgICAgICBkZXNjcmlwdG9yLnNldCA9IHNoYWRvd2luZ0Rlc2NyaXB0b3Iuc2V0IHx8IGRlc2NyaXB0b3Iuc2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH1cbn1cbmNvbnN0IGdldE93bktleXMgPSAoKCkgPT4ge1xuICAgIGlmICh0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIChvYmplY3QpID0+IFsuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmplY3QpLCAuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCldO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICAgIH1cbn0pKCk7XG5jb25zdCBleHRlbmQgPSAoKCkgPT4ge1xuICAgIGZ1bmN0aW9uIGV4dGVuZFdpdGhSZWZsZWN0KGNvbnN0cnVjdG9yKSB7XG4gICAgICAgIGZ1bmN0aW9uIGV4dGVuZGVkKCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuY29uc3RydWN0KGNvbnN0cnVjdG9yLCBhcmd1bWVudHMsIG5ldy50YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGV4dGVuZGVkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoY29uc3RydWN0b3IucHJvdG90eXBlLCB7XG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogZXh0ZW5kZWQgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIFJlZmxlY3Quc2V0UHJvdG90eXBlT2YoZXh0ZW5kZWQsIGNvbnN0cnVjdG9yKTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZGVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0ZXN0UmVmbGVjdEV4dGVuc2lvbigpIHtcbiAgICAgICAgY29uc3QgYSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuYS5jYWxsKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBiID0gZXh0ZW5kV2l0aFJlZmxlY3QoYSk7XG4gICAgICAgIGIucHJvdG90eXBlLmEgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIHJldHVybiBuZXcgYigpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICB0ZXN0UmVmbGVjdEV4dGVuc2lvbigpO1xuICAgICAgICByZXR1cm4gZXh0ZW5kV2l0aFJlZmxlY3Q7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gKGNvbnN0cnVjdG9yKSA9PiBjbGFzcyBleHRlbmRlZCBleHRlbmRzIGNvbnN0cnVjdG9yIHtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuXG5mdW5jdGlvbiBibGVzc0RlZmluaXRpb24oZGVmaW5pdGlvbikge1xuICAgIHJldHVybiB7XG4gICAgICAgIGlkZW50aWZpZXI6IGRlZmluaXRpb24uaWRlbnRpZmllcixcbiAgICAgICAgY29udHJvbGxlckNvbnN0cnVjdG9yOiBibGVzcyhkZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3RvciksXG4gICAgfTtcbn1cblxuY2xhc3MgTW9kdWxlIHtcbiAgICBjb25zdHJ1Y3RvcihhcHBsaWNhdGlvbiwgZGVmaW5pdGlvbikge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uID0gYXBwbGljYXRpb247XG4gICAgICAgIHRoaXMuZGVmaW5pdGlvbiA9IGJsZXNzRGVmaW5pdGlvbihkZWZpbml0aW9uKTtcbiAgICAgICAgdGhpcy5jb250ZXh0c0J5U2NvcGUgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLmNvbm5lY3RlZENvbnRleHRzID0gbmV3IFNldCgpO1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmaW5pdGlvbi5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckNvbnN0cnVjdG9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3RvcjtcbiAgICB9XG4gICAgZ2V0IGNvbnRleHRzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmNvbm5lY3RlZENvbnRleHRzKTtcbiAgICB9XG4gICAgY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5mZXRjaENvbnRleHRGb3JTY29wZShzY29wZSk7XG4gICAgICAgIHRoaXMuY29ubmVjdGVkQ29udGV4dHMuYWRkKGNvbnRleHQpO1xuICAgICAgICBjb250ZXh0LmNvbm5lY3QoKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSkge1xuICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb250ZXh0c0J5U2NvcGUuZ2V0KHNjb3BlKTtcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkQ29udGV4dHMuZGVsZXRlKGNvbnRleHQpO1xuICAgICAgICAgICAgY29udGV4dC5kaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hDb250ZXh0Rm9yU2NvcGUoc2NvcGUpIHtcbiAgICAgICAgbGV0IGNvbnRleHQgPSB0aGlzLmNvbnRleHRzQnlTY29wZS5nZXQoc2NvcGUpO1xuICAgICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgICAgIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0aGlzLCBzY29wZSk7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHRzQnlTY29wZS5zZXQoc2NvcGUsIGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cbn1cblxuY2xhc3MgQ2xhc3NNYXAge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB9XG4gICAgaGFzKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5oYXModGhpcy5nZXREYXRhS2V5KG5hbWUpKTtcbiAgICB9XG4gICAgZ2V0KG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsKG5hbWUpWzBdO1xuICAgIH1cbiAgICBnZXRBbGwobmFtZSkge1xuICAgICAgICBjb25zdCB0b2tlblN0cmluZyA9IHRoaXMuZGF0YS5nZXQodGhpcy5nZXREYXRhS2V5KG5hbWUpKSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gdG9rZW5pemUodG9rZW5TdHJpbmcpO1xuICAgIH1cbiAgICBnZXRBdHRyaWJ1dGVOYW1lKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5nZXRBdHRyaWJ1dGVOYW1lRm9yS2V5KHRoaXMuZ2V0RGF0YUtleShuYW1lKSk7XG4gICAgfVxuICAgIGdldERhdGFLZXkobmFtZSkge1xuICAgICAgICByZXR1cm4gYCR7bmFtZX0tY2xhc3NgO1xuICAgIH1cbiAgICBnZXQgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZGF0YTtcbiAgICB9XG59XG5cbmNsYXNzIERhdGFNYXAge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQoa2V5KSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7XG4gICAgfVxuICAgIHNldChrZXksIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmdldChrZXkpO1xuICAgIH1cbiAgICBoYXMoa2V5KSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUobmFtZSk7XG4gICAgfVxuICAgIGRlbGV0ZShrZXkpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZU5hbWVGb3JLZXkoa2V5KTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRBdHRyaWJ1dGVOYW1lRm9yS2V5KGtleSkge1xuICAgICAgICByZXR1cm4gYGRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LSR7ZGFzaGVyaXplKGtleSl9YDtcbiAgICB9XG59XG5cbmNsYXNzIEd1aWRlIHtcbiAgICBjb25zdHJ1Y3Rvcihsb2dnZXIpIHtcbiAgICAgICAgdGhpcy53YXJuZWRLZXlzQnlPYmplY3QgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlcjtcbiAgICB9XG4gICAgd2FybihvYmplY3QsIGtleSwgbWVzc2FnZSkge1xuICAgICAgICBsZXQgd2FybmVkS2V5cyA9IHRoaXMud2FybmVkS2V5c0J5T2JqZWN0LmdldChvYmplY3QpO1xuICAgICAgICBpZiAoIXdhcm5lZEtleXMpIHtcbiAgICAgICAgICAgIHdhcm5lZEtleXMgPSBuZXcgU2V0KCk7XG4gICAgICAgICAgICB0aGlzLndhcm5lZEtleXNCeU9iamVjdC5zZXQob2JqZWN0LCB3YXJuZWRLZXlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXdhcm5lZEtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHdhcm5lZEtleXMuYWRkKGtleSk7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKG1lc3NhZ2UsIG9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGF0dHJpYnV0ZVZhbHVlQ29udGFpbnNUb2tlbihhdHRyaWJ1dGVOYW1lLCB0b2tlbikge1xuICAgIHJldHVybiBgWyR7YXR0cmlidXRlTmFtZX1+PVwiJHt0b2tlbn1cIl1gO1xufVxuXG5jbGFzcyBUYXJnZXRTZXQge1xuICAgIGNvbnN0cnVjdG9yKHNjb3BlKSB7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBpZGVudGlmaWVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5pZGVudGlmaWVyO1xuICAgIH1cbiAgICBnZXQgc2NoZW1hKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5zY2hlbWE7XG4gICAgfVxuICAgIGhhcyh0YXJnZXROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQodGFyZ2V0TmFtZSkgIT0gbnVsbDtcbiAgICB9XG4gICAgZmluZCguLi50YXJnZXROYW1lcykge1xuICAgICAgICByZXR1cm4gdGFyZ2V0TmFtZXMucmVkdWNlKCh0YXJnZXQsIHRhcmdldE5hbWUpID0+IHRhcmdldCB8fCB0aGlzLmZpbmRUYXJnZXQodGFyZ2V0TmFtZSkgfHwgdGhpcy5maW5kTGVnYWN5VGFyZ2V0KHRhcmdldE5hbWUpLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBmaW5kQWxsKC4uLnRhcmdldE5hbWVzKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXROYW1lcy5yZWR1Y2UoKHRhcmdldHMsIHRhcmdldE5hbWUpID0+IFtcbiAgICAgICAgICAgIC4uLnRhcmdldHMsXG4gICAgICAgICAgICAuLi50aGlzLmZpbmRBbGxUYXJnZXRzKHRhcmdldE5hbWUpLFxuICAgICAgICAgICAgLi4udGhpcy5maW5kQWxsTGVnYWN5VGFyZ2V0cyh0YXJnZXROYW1lKSxcbiAgICAgICAgXSwgW10pO1xuICAgIH1cbiAgICBmaW5kVGFyZ2V0KHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuZmluZEVsZW1lbnQoc2VsZWN0b3IpO1xuICAgIH1cbiAgICBmaW5kQWxsVGFyZ2V0cyh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5nZXRTZWxlY3RvckZvclRhcmdldE5hbWUodGFyZ2V0TmFtZSk7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmZpbmRBbGxFbGVtZW50cyhzZWxlY3Rvcik7XG4gICAgfVxuICAgIGdldFNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLnNjaGVtYS50YXJnZXRBdHRyaWJ1dGVGb3JTY29wZSh0aGlzLmlkZW50aWZpZXIpO1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlVmFsdWVDb250YWluc1Rva2VuKGF0dHJpYnV0ZU5hbWUsIHRhcmdldE5hbWUpO1xuICAgIH1cbiAgICBmaW5kTGVnYWN5VGFyZ2V0KHRhcmdldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldExlZ2FjeVNlbGVjdG9yRm9yVGFyZ2V0TmFtZSh0YXJnZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVwcmVjYXRlKHRoaXMuc2NvcGUuZmluZEVsZW1lbnQoc2VsZWN0b3IpLCB0YXJnZXROYW1lKTtcbiAgICB9XG4gICAgZmluZEFsbExlZ2FjeVRhcmdldHModGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IHRoaXMuZ2V0TGVnYWN5U2VsZWN0b3JGb3JUYXJnZXROYW1lKHRhcmdldE5hbWUpO1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5maW5kQWxsRWxlbWVudHMoc2VsZWN0b3IpLm1hcCgoZWxlbWVudCkgPT4gdGhpcy5kZXByZWNhdGUoZWxlbWVudCwgdGFyZ2V0TmFtZSkpO1xuICAgIH1cbiAgICBnZXRMZWdhY3lTZWxlY3RvckZvclRhcmdldE5hbWUodGFyZ2V0TmFtZSkge1xuICAgICAgICBjb25zdCB0YXJnZXREZXNjcmlwdG9yID0gYCR7dGhpcy5pZGVudGlmaWVyfS4ke3RhcmdldE5hbWV9YDtcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZVZhbHVlQ29udGFpbnNUb2tlbih0aGlzLnNjaGVtYS50YXJnZXRBdHRyaWJ1dGUsIHRhcmdldERlc2NyaXB0b3IpO1xuICAgIH1cbiAgICBkZXByZWNhdGUoZWxlbWVudCwgdGFyZ2V0TmFtZSkge1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgeyBpZGVudGlmaWVyIH0gPSB0aGlzO1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IHRoaXMuc2NoZW1hLnRhcmdldEF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGNvbnN0IHJldmlzZWRBdHRyaWJ1dGVOYW1lID0gdGhpcy5zY2hlbWEudGFyZ2V0QXR0cmlidXRlRm9yU2NvcGUoaWRlbnRpZmllcik7XG4gICAgICAgICAgICB0aGlzLmd1aWRlLndhcm4oZWxlbWVudCwgYHRhcmdldDoke3RhcmdldE5hbWV9YCwgYFBsZWFzZSByZXBsYWNlICR7YXR0cmlidXRlTmFtZX09XCIke2lkZW50aWZpZXJ9LiR7dGFyZ2V0TmFtZX1cIiB3aXRoICR7cmV2aXNlZEF0dHJpYnV0ZU5hbWV9PVwiJHt0YXJnZXROYW1lfVwiLiBgICtcbiAgICAgICAgICAgICAgICBgVGhlICR7YXR0cmlidXRlTmFtZX0gYXR0cmlidXRlIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uIG9mIFN0aW11bHVzLmApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgIH1cbiAgICBnZXQgZ3VpZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmd1aWRlO1xuICAgIH1cbn1cblxuY2xhc3MgT3V0bGV0U2V0IHtcbiAgICBjb25zdHJ1Y3RvcihzY29wZSwgY29udHJvbGxlckVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXJFbGVtZW50ID0gY29udHJvbGxlckVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IHNjaGVtYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuc2NoZW1hO1xuICAgIH1cbiAgICBoYXMob3V0bGV0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kKG91dGxldE5hbWUpICE9IG51bGw7XG4gICAgfVxuICAgIGZpbmQoLi4ub3V0bGV0TmFtZXMpIHtcbiAgICAgICAgcmV0dXJuIG91dGxldE5hbWVzLnJlZHVjZSgob3V0bGV0LCBvdXRsZXROYW1lKSA9PiBvdXRsZXQgfHwgdGhpcy5maW5kT3V0bGV0KG91dGxldE5hbWUpLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBmaW5kQWxsKC4uLm91dGxldE5hbWVzKSB7XG4gICAgICAgIHJldHVybiBvdXRsZXROYW1lcy5yZWR1Y2UoKG91dGxldHMsIG91dGxldE5hbWUpID0+IFsuLi5vdXRsZXRzLCAuLi50aGlzLmZpbmRBbGxPdXRsZXRzKG91dGxldE5hbWUpXSwgW10pO1xuICAgIH1cbiAgICBnZXRTZWxlY3RvckZvck91dGxldE5hbWUob3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gdGhpcy5zY2hlbWEub3V0bGV0QXR0cmlidXRlRm9yU2NvcGUodGhpcy5pZGVudGlmaWVyLCBvdXRsZXROYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udHJvbGxlckVsZW1lbnQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgIH1cbiAgICBmaW5kT3V0bGV0KG91dGxldE5hbWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yRm9yT3V0bGV0TmFtZShvdXRsZXROYW1lKTtcbiAgICAgICAgaWYgKHNlbGVjdG9yKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZEVsZW1lbnQoc2VsZWN0b3IsIG91dGxldE5hbWUpO1xuICAgIH1cbiAgICBmaW5kQWxsT3V0bGV0cyhvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gdGhpcy5nZXRTZWxlY3RvckZvck91dGxldE5hbWUob3V0bGV0TmFtZSk7XG4gICAgICAgIHJldHVybiBzZWxlY3RvciA/IHRoaXMuZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yLCBvdXRsZXROYW1lKSA6IFtdO1xuICAgIH1cbiAgICBmaW5kRWxlbWVudChzZWxlY3Rvciwgb3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMuc2NvcGUucXVlcnlFbGVtZW50cyhzZWxlY3Rvcik7XG4gICAgICAgIHJldHVybiBlbGVtZW50cy5maWx0ZXIoKGVsZW1lbnQpID0+IHRoaXMubWF0Y2hlc0VsZW1lbnQoZWxlbWVudCwgc2VsZWN0b3IsIG91dGxldE5hbWUpKVswXTtcbiAgICB9XG4gICAgZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yLCBvdXRsZXROYW1lKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5zY29wZS5xdWVyeUVsZW1lbnRzKHNlbGVjdG9yKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbHRlcigoZWxlbWVudCkgPT4gdGhpcy5tYXRjaGVzRWxlbWVudChlbGVtZW50LCBzZWxlY3Rvciwgb3V0bGV0TmFtZSkpO1xuICAgIH1cbiAgICBtYXRjaGVzRWxlbWVudChlbGVtZW50LCBzZWxlY3Rvciwgb3V0bGV0TmFtZSkge1xuICAgICAgICBjb25zdCBjb250cm9sbGVyQXR0cmlidXRlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUodGhpcy5zY29wZS5zY2hlbWEuY29udHJvbGxlckF0dHJpYnV0ZSkgfHwgXCJcIjtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikgJiYgY29udHJvbGxlckF0dHJpYnV0ZS5zcGxpdChcIiBcIikuaW5jbHVkZXMob3V0bGV0TmFtZSk7XG4gICAgfVxufVxuXG5jbGFzcyBTY29wZSB7XG4gICAgY29uc3RydWN0b3Ioc2NoZW1hLCBlbGVtZW50LCBpZGVudGlmaWVyLCBsb2dnZXIpIHtcbiAgICAgICAgdGhpcy50YXJnZXRzID0gbmV3IFRhcmdldFNldCh0aGlzKTtcbiAgICAgICAgdGhpcy5jbGFzc2VzID0gbmV3IENsYXNzTWFwKHRoaXMpO1xuICAgICAgICB0aGlzLmRhdGEgPSBuZXcgRGF0YU1hcCh0aGlzKTtcbiAgICAgICAgdGhpcy5jb250YWluc0VsZW1lbnQgPSAoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuY2xvc2VzdCh0aGlzLmNvbnRyb2xsZXJTZWxlY3RvcikgPT09IHRoaXMuZWxlbWVudDtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zY2hlbWEgPSBzY2hlbWE7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaWRlbnRpZmllciA9IGlkZW50aWZpZXI7XG4gICAgICAgIHRoaXMuZ3VpZGUgPSBuZXcgR3VpZGUobG9nZ2VyKTtcbiAgICAgICAgdGhpcy5vdXRsZXRzID0gbmV3IE91dGxldFNldCh0aGlzLmRvY3VtZW50U2NvcGUsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBmaW5kRWxlbWVudChzZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpID8gdGhpcy5lbGVtZW50IDogdGhpcy5xdWVyeUVsZW1lbnRzKHNlbGVjdG9yKS5maW5kKHRoaXMuY29udGFpbnNFbGVtZW50KTtcbiAgICB9XG4gICAgZmluZEFsbEVsZW1lbnRzKHNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAuLi4odGhpcy5lbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpID8gW3RoaXMuZWxlbWVudF0gOiBbXSksXG4gICAgICAgICAgICAuLi50aGlzLnF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpLmZpbHRlcih0aGlzLmNvbnRhaW5zRWxlbWVudCksXG4gICAgICAgIF07XG4gICAgfVxuICAgIHF1ZXJ5RWxlbWVudHMoc2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXJTZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZVZhbHVlQ29udGFpbnNUb2tlbih0aGlzLnNjaGVtYS5jb250cm9sbGVyQXR0cmlidXRlLCB0aGlzLmlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBnZXQgaXNEb2N1bWVudFNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50ID09PSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBkb2N1bWVudFNjb3BlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0RvY3VtZW50U2NvcGVcbiAgICAgICAgICAgID8gdGhpc1xuICAgICAgICAgICAgOiBuZXcgU2NvcGUodGhpcy5zY2hlbWEsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgdGhpcy5pZGVudGlmaWVyLCB0aGlzLmd1aWRlLmxvZ2dlcik7XG4gICAgfVxufVxuXG5jbGFzcyBTY29wZU9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCBzY2hlbWEsIGRlbGVnYXRlKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgICAgIHRoaXMudmFsdWVMaXN0T2JzZXJ2ZXIgPSBuZXcgVmFsdWVMaXN0T2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLmNvbnRyb2xsZXJBdHRyaWJ1dGUsIHRoaXMpO1xuICAgICAgICB0aGlzLnNjb3Blc0J5SWRlbnRpZmllckJ5RWxlbWVudCA9IG5ldyBXZWFrTWFwKCk7XG4gICAgICAgIHRoaXMuc2NvcGVSZWZlcmVuY2VDb3VudHMgPSBuZXcgV2Vha01hcCgpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy52YWx1ZUxpc3RPYnNlcnZlci5zdGFydCgpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnZhbHVlTGlzdE9ic2VydmVyLnN0b3AoKTtcbiAgICB9XG4gICAgZ2V0IGNvbnRyb2xsZXJBdHRyaWJ1dGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjaGVtYS5jb250cm9sbGVyQXR0cmlidXRlO1xuICAgIH1cbiAgICBwYXJzZVZhbHVlRm9yVG9rZW4odG9rZW4pIHtcbiAgICAgICAgY29uc3QgeyBlbGVtZW50LCBjb250ZW50OiBpZGVudGlmaWVyIH0gPSB0b2tlbjtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VWYWx1ZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpO1xuICAgIH1cbiAgICBwYXJzZVZhbHVlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBzY29wZXNCeUlkZW50aWZpZXIgPSB0aGlzLmZldGNoU2NvcGVzQnlJZGVudGlmaWVyRm9yRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgbGV0IHNjb3BlID0gc2NvcGVzQnlJZGVudGlmaWVyLmdldChpZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKCFzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUgPSB0aGlzLmRlbGVnYXRlLmNyZWF0ZVNjb3BlRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcik7XG4gICAgICAgICAgICBzY29wZXNCeUlkZW50aWZpZXIuc2V0KGlkZW50aWZpZXIsIHNjb3BlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgfVxuICAgIGVsZW1lbnRNYXRjaGVkVmFsdWUoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlQ291bnQgPSAodGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5nZXQodmFsdWUpIHx8IDApICsgMTtcbiAgICAgICAgdGhpcy5zY29wZVJlZmVyZW5jZUNvdW50cy5zZXQodmFsdWUsIHJlZmVyZW5jZUNvdW50KTtcbiAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50ID09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZWdhdGUuc2NvcGVDb25uZWN0ZWQodmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnRVbm1hdGNoZWRWYWx1ZShlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VDb3VudCA9IHRoaXMuc2NvcGVSZWZlcmVuY2VDb3VudHMuZ2V0KHZhbHVlKTtcbiAgICAgICAgaWYgKHJlZmVyZW5jZUNvdW50KSB7XG4gICAgICAgICAgICB0aGlzLnNjb3BlUmVmZXJlbmNlQ291bnRzLnNldCh2YWx1ZSwgcmVmZXJlbmNlQ291bnQgLSAxKTtcbiAgICAgICAgICAgIGlmIChyZWZlcmVuY2VDb3VudCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5zY29wZURpc2Nvbm5lY3RlZCh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmV0Y2hTY29wZXNCeUlkZW50aWZpZXJGb3JFbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IHNjb3Blc0J5SWRlbnRpZmllciA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50LmdldChlbGVtZW50KTtcbiAgICAgICAgaWYgKCFzY29wZXNCeUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHNjb3Blc0J5SWRlbnRpZmllciA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyQnlFbGVtZW50LnNldChlbGVtZW50LCBzY29wZXNCeUlkZW50aWZpZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY29wZXNCeUlkZW50aWZpZXI7XG4gICAgfVxufVxuXG5jbGFzcyBSb3V0ZXIge1xuICAgIGNvbnN0cnVjdG9yKGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb24gPSBhcHBsaWNhdGlvbjtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyID0gbmV3IFNjb3BlT2JzZXJ2ZXIodGhpcy5lbGVtZW50LCB0aGlzLnNjaGVtYSwgdGhpcyk7XG4gICAgICAgIHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyID0gbmV3IE11bHRpbWFwKCk7XG4gICAgICAgIHRoaXMubW9kdWxlc0J5SWRlbnRpZmllciA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgZ2V0IGVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLmVsZW1lbnQ7XG4gICAgfVxuICAgIGdldCBzY2hlbWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICB9XG4gICAgZ2V0IGxvZ2dlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGljYXRpb24ubG9nZ2VyO1xuICAgIH1cbiAgICBnZXQgY29udHJvbGxlckF0dHJpYnV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZW1hLmNvbnRyb2xsZXJBdHRyaWJ1dGU7XG4gICAgfVxuICAgIGdldCBtb2R1bGVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIudmFsdWVzKCkpO1xuICAgIH1cbiAgICBnZXQgY29udGV4dHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZHVsZXMucmVkdWNlKChjb250ZXh0cywgbW9kdWxlKSA9PiBjb250ZXh0cy5jb25jYXQobW9kdWxlLmNvbnRleHRzKSwgW10pO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zY29wZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuc2NvcGVPYnNlcnZlci5zdG9wKCk7XG4gICAgfVxuICAgIGxvYWREZWZpbml0aW9uKGRlZmluaXRpb24pIHtcbiAgICAgICAgdGhpcy51bmxvYWRJZGVudGlmaWVyKGRlZmluaXRpb24uaWRlbnRpZmllcik7XG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IG5ldyBNb2R1bGUodGhpcy5hcHBsaWNhdGlvbiwgZGVmaW5pdGlvbik7XG4gICAgICAgIHRoaXMuY29ubmVjdE1vZHVsZShtb2R1bGUpO1xuICAgICAgICBjb25zdCBhZnRlckxvYWQgPSBkZWZpbml0aW9uLmNvbnRyb2xsZXJDb25zdHJ1Y3Rvci5hZnRlckxvYWQ7XG4gICAgICAgIGlmIChhZnRlckxvYWQpIHtcbiAgICAgICAgICAgIGFmdGVyTG9hZC5jYWxsKGRlZmluaXRpb24uY29udHJvbGxlckNvbnN0cnVjdG9yLCBkZWZpbml0aW9uLmlkZW50aWZpZXIsIHRoaXMuYXBwbGljYXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVubG9hZElkZW50aWZpZXIoaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RNb2R1bGUobW9kdWxlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRDb250ZXh0Rm9yRWxlbWVudEFuZElkZW50aWZpZXIoZWxlbWVudCwgaWRlbnRpZmllcikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KGlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmNvbnRleHRzLmZpbmQoKGNvbnRleHQpID0+IGNvbnRleHQuZWxlbWVudCA9PSBlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9wb3NlVG9Db25uZWN0U2NvcGVGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IHNjb3BlID0gdGhpcy5zY29wZU9ic2VydmVyLnBhcnNlVmFsdWVGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKHNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLnNjb3BlT2JzZXJ2ZXIuZWxlbWVudE1hdGNoZWRWYWx1ZShzY29wZS5lbGVtZW50LCBzY29wZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBDb3VsZG4ndCBmaW5kIG9yIGNyZWF0ZSBzY29wZSBmb3IgaWRlbnRpZmllcjogXCIke2lkZW50aWZpZXJ9XCIgYW5kIGVsZW1lbnQ6YCwgZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRXJyb3IoZXJyb3IsIG1lc3NhZ2UsIGRldGFpbCkge1xuICAgICAgICB0aGlzLmFwcGxpY2F0aW9uLmhhbmRsZUVycm9yKGVycm9yLCBtZXNzYWdlLCBkZXRhaWwpO1xuICAgIH1cbiAgICBjcmVhdGVTY29wZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTY29wZSh0aGlzLnNjaGVtYSwgZWxlbWVudCwgaWRlbnRpZmllciwgdGhpcy5sb2dnZXIpO1xuICAgIH1cbiAgICBzY29wZUNvbm5lY3RlZChzY29wZSkge1xuICAgICAgICB0aGlzLnNjb3Blc0J5SWRlbnRpZmllci5hZGQoc2NvcGUuaWRlbnRpZmllciwgc2NvcGUpO1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB0aGlzLm1vZHVsZXNCeUlkZW50aWZpZXIuZ2V0KHNjb3BlLmlkZW50aWZpZXIpO1xuICAgICAgICBpZiAobW9kdWxlKSB7XG4gICAgICAgICAgICBtb2R1bGUuY29ubmVjdENvbnRleHRGb3JTY29wZShzY29wZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2NvcGVEaXNjb25uZWN0ZWQoc2NvcGUpIHtcbiAgICAgICAgdGhpcy5zY29wZXNCeUlkZW50aWZpZXIuZGVsZXRlKHNjb3BlLmlkZW50aWZpZXIsIHNjb3BlKTtcbiAgICAgICAgY29uc3QgbW9kdWxlID0gdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyLmdldChzY29wZS5pZGVudGlmaWVyKTtcbiAgICAgICAgaWYgKG1vZHVsZSkge1xuICAgICAgICAgICAgbW9kdWxlLmRpc2Nvbm5lY3RDb250ZXh0Rm9yU2NvcGUoc2NvcGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbm5lY3RNb2R1bGUobW9kdWxlKSB7XG4gICAgICAgIHRoaXMubW9kdWxlc0J5SWRlbnRpZmllci5zZXQobW9kdWxlLmlkZW50aWZpZXIsIG1vZHVsZSk7XG4gICAgICAgIGNvbnN0IHNjb3BlcyA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyLmdldFZhbHVlc0ZvcktleShtb2R1bGUuaWRlbnRpZmllcik7XG4gICAgICAgIHNjb3Blcy5mb3JFYWNoKChzY29wZSkgPT4gbW9kdWxlLmNvbm5lY3RDb250ZXh0Rm9yU2NvcGUoc2NvcGUpKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdE1vZHVsZShtb2R1bGUpIHtcbiAgICAgICAgdGhpcy5tb2R1bGVzQnlJZGVudGlmaWVyLmRlbGV0ZShtb2R1bGUuaWRlbnRpZmllcik7XG4gICAgICAgIGNvbnN0IHNjb3BlcyA9IHRoaXMuc2NvcGVzQnlJZGVudGlmaWVyLmdldFZhbHVlc0ZvcktleShtb2R1bGUuaWRlbnRpZmllcik7XG4gICAgICAgIHNjb3Blcy5mb3JFYWNoKChzY29wZSkgPT4gbW9kdWxlLmRpc2Nvbm5lY3RDb250ZXh0Rm9yU2NvcGUoc2NvcGUpKTtcbiAgICB9XG59XG5cbmNvbnN0IGRlZmF1bHRTY2hlbWEgPSB7XG4gICAgY29udHJvbGxlckF0dHJpYnV0ZTogXCJkYXRhLWNvbnRyb2xsZXJcIixcbiAgICBhY3Rpb25BdHRyaWJ1dGU6IFwiZGF0YS1hY3Rpb25cIixcbiAgICB0YXJnZXRBdHRyaWJ1dGU6IFwiZGF0YS10YXJnZXRcIixcbiAgICB0YXJnZXRBdHRyaWJ1dGVGb3JTY29wZTogKGlkZW50aWZpZXIpID0+IGBkYXRhLSR7aWRlbnRpZmllcn0tdGFyZ2V0YCxcbiAgICBvdXRsZXRBdHRyaWJ1dGVGb3JTY29wZTogKGlkZW50aWZpZXIsIG91dGxldCkgPT4gYGRhdGEtJHtpZGVudGlmaWVyfS0ke291dGxldH0tb3V0bGV0YCxcbiAgICBrZXlNYXBwaW5nczogT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHsgZW50ZXI6IFwiRW50ZXJcIiwgdGFiOiBcIlRhYlwiLCBlc2M6IFwiRXNjYXBlXCIsIHNwYWNlOiBcIiBcIiwgdXA6IFwiQXJyb3dVcFwiLCBkb3duOiBcIkFycm93RG93blwiLCBsZWZ0OiBcIkFycm93TGVmdFwiLCByaWdodDogXCJBcnJvd1JpZ2h0XCIsIGhvbWU6IFwiSG9tZVwiLCBlbmQ6IFwiRW5kXCIsIHBhZ2VfdXA6IFwiUGFnZVVwXCIsIHBhZ2VfZG93bjogXCJQYWdlRG93blwiIH0sIG9iamVjdEZyb21FbnRyaWVzKFwiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIi5zcGxpdChcIlwiKS5tYXAoKGMpID0+IFtjLCBjXSkpKSwgb2JqZWN0RnJvbUVudHJpZXMoXCIwMTIzNDU2Nzg5XCIuc3BsaXQoXCJcIikubWFwKChuKSA9PiBbbiwgbl0pKSksXG59O1xuZnVuY3Rpb24gb2JqZWN0RnJvbUVudHJpZXMoYXJyYXkpIHtcbiAgICByZXR1cm4gYXJyYXkucmVkdWNlKChtZW1vLCBbaywgdl0pID0+IChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG1lbW8pLCB7IFtrXTogdiB9KSksIHt9KTtcbn1cblxuY2xhc3MgQXBwbGljYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHNjaGVtYSA9IGRlZmF1bHRTY2hlbWEpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBjb25zb2xlO1xuICAgICAgICB0aGlzLmRlYnVnID0gZmFsc2U7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eSA9IChpZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCA9IHt9KSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5kZWJ1Zykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nRm9ybWF0dGVkTWVzc2FnZShpZGVudGlmaWVyLCBmdW5jdGlvbk5hbWUsIGRldGFpbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih0aGlzKTtcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSBuZXcgUm91dGVyKHRoaXMpO1xuICAgICAgICB0aGlzLmFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEFjdGlvbkRlc2NyaXB0b3JGaWx0ZXJzKTtcbiAgICB9XG4gICAgc3RhdGljIHN0YXJ0KGVsZW1lbnQsIHNjaGVtYSkge1xuICAgICAgICBjb25zdCBhcHBsaWNhdGlvbiA9IG5ldyB0aGlzKGVsZW1lbnQsIHNjaGVtYSk7XG4gICAgICAgIGFwcGxpY2F0aW9uLnN0YXJ0KCk7XG4gICAgICAgIHJldHVybiBhcHBsaWNhdGlvbjtcbiAgICB9XG4gICAgYXN5bmMgc3RhcnQoKSB7XG4gICAgICAgIGF3YWl0IGRvbVJlYWR5KCk7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImFwcGxpY2F0aW9uXCIsIFwic3RhcnRpbmdcIik7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlci5zdGFydCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5zdGFydCgpO1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJhcHBsaWNhdGlvblwiLCBcInN0YXJ0XCIpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLmxvZ0RlYnVnQWN0aXZpdHkoXCJhcHBsaWNhdGlvblwiLCBcInN0b3BwaW5nXCIpO1xuICAgICAgICB0aGlzLmRpc3BhdGNoZXIuc3RvcCgpO1xuICAgICAgICB0aGlzLnJvdXRlci5zdG9wKCk7XG4gICAgICAgIHRoaXMubG9nRGVidWdBY3Rpdml0eShcImFwcGxpY2F0aW9uXCIsIFwic3RvcFwiKTtcbiAgICB9XG4gICAgcmVnaXN0ZXIoaWRlbnRpZmllciwgY29udHJvbGxlckNvbnN0cnVjdG9yKSB7XG4gICAgICAgIHRoaXMubG9hZCh7IGlkZW50aWZpZXIsIGNvbnRyb2xsZXJDb25zdHJ1Y3RvciB9KTtcbiAgICB9XG4gICAgcmVnaXN0ZXJBY3Rpb25PcHRpb24obmFtZSwgZmlsdGVyKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uRGVzY3JpcHRvckZpbHRlcnNbbmFtZV0gPSBmaWx0ZXI7XG4gICAgfVxuICAgIGxvYWQoaGVhZCwgLi4ucmVzdCkge1xuICAgICAgICBjb25zdCBkZWZpbml0aW9ucyA9IEFycmF5LmlzQXJyYXkoaGVhZCkgPyBoZWFkIDogW2hlYWQsIC4uLnJlc3RdO1xuICAgICAgICBkZWZpbml0aW9ucy5mb3JFYWNoKChkZWZpbml0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5jb250cm9sbGVyQ29uc3RydWN0b3Iuc2hvdWxkTG9hZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLmxvYWREZWZpbml0aW9uKGRlZmluaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdW5sb2FkKGhlYWQsIC4uLnJlc3QpIHtcbiAgICAgICAgY29uc3QgaWRlbnRpZmllcnMgPSBBcnJheS5pc0FycmF5KGhlYWQpID8gaGVhZCA6IFtoZWFkLCAuLi5yZXN0XTtcbiAgICAgICAgaWRlbnRpZmllcnMuZm9yRWFjaCgoaWRlbnRpZmllcikgPT4gdGhpcy5yb3V0ZXIudW5sb2FkSWRlbnRpZmllcihpZGVudGlmaWVyKSk7XG4gICAgfVxuICAgIGdldCBjb250cm9sbGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbnRleHRzLm1hcCgoY29udGV4dCkgPT4gY29udGV4dC5jb250cm9sbGVyKTtcbiAgICB9XG4gICAgZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpIHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMucm91dGVyLmdldENvbnRleHRGb3JFbGVtZW50QW5kSWRlbnRpZmllcihlbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQgPyBjb250ZXh0LmNvbnRyb2xsZXIgOiBudWxsO1xuICAgIH1cbiAgICBoYW5kbGVFcnJvcihlcnJvciwgbWVzc2FnZSwgZGV0YWlsKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoYCVzXFxuXFxuJW9cXG5cXG4lb2AsIG1lc3NhZ2UsIGVycm9yLCBkZXRhaWwpO1xuICAgICAgICAoX2EgPSB3aW5kb3cub25lcnJvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGwod2luZG93LCBtZXNzYWdlLCBcIlwiLCAwLCAwLCBlcnJvcik7XG4gICAgfVxuICAgIGxvZ0Zvcm1hdHRlZE1lc3NhZ2UoaWRlbnRpZmllciwgZnVuY3Rpb25OYW1lLCBkZXRhaWwgPSB7fSkge1xuICAgICAgICBkZXRhaWwgPSBPYmplY3QuYXNzaWduKHsgYXBwbGljYXRpb246IHRoaXMgfSwgZGV0YWlsKTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZ3JvdXBDb2xsYXBzZWQoYCR7aWRlbnRpZmllcn0gIyR7ZnVuY3Rpb25OYW1lfWApO1xuICAgICAgICB0aGlzLmxvZ2dlci5sb2coXCJkZXRhaWxzOlwiLCBPYmplY3QuYXNzaWduKHt9LCBkZXRhaWwpKTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZ3JvdXBFbmQoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkb21SZWFkeSgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT0gXCJsb2FkaW5nXCIpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gQ2xhc3NQcm9wZXJ0aWVzQmxlc3NpbmcoY29uc3RydWN0b3IpIHtcbiAgICBjb25zdCBjbGFzc2VzID0gcmVhZEluaGVyaXRhYmxlU3RhdGljQXJyYXlWYWx1ZXMoY29uc3RydWN0b3IsIFwiY2xhc3Nlc1wiKTtcbiAgICByZXR1cm4gY2xhc3Nlcy5yZWR1Y2UoKHByb3BlcnRpZXMsIGNsYXNzRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBwcm9wZXJ0aWVzRm9yQ2xhc3NEZWZpbml0aW9uKGNsYXNzRGVmaW5pdGlvbikpO1xuICAgIH0sIHt9KTtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JDbGFzc0RlZmluaXRpb24oa2V5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake2tleX1DbGFzc2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBjbGFzc2VzIH0gPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmIChjbGFzc2VzLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjbGFzc2VzLmdldChrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gY2xhc3Nlcy5nZXRBdHRyaWJ1dGVOYW1lKGtleSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBhdHRyaWJ1dGUgXCIke2F0dHJpYnV0ZX1cImApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtrZXl9Q2xhc3Nlc2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3Nlcy5nZXRBbGwoa2V5KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgaGFzJHtjYXBpdGFsaXplKGtleSl9Q2xhc3NgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsYXNzZXMuaGFzKGtleSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIE91dGxldFByb3BlcnRpZXNCbGVzc2luZyhjb25zdHJ1Y3Rvcikge1xuICAgIGNvbnN0IG91dGxldHMgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNBcnJheVZhbHVlcyhjb25zdHJ1Y3RvciwgXCJvdXRsZXRzXCIpO1xuICAgIHJldHVybiBvdXRsZXRzLnJlZHVjZSgocHJvcGVydGllcywgb3V0bGV0RGVmaW5pdGlvbikgPT4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBwcm9wZXJ0aWVzRm9yT3V0bGV0RGVmaW5pdGlvbihvdXRsZXREZWZpbml0aW9uKSk7XG4gICAgfSwge30pO1xufVxuZnVuY3Rpb24gZ2V0T3V0bGV0Q29udHJvbGxlcihjb250cm9sbGVyLCBlbGVtZW50LCBpZGVudGlmaWVyKSB7XG4gICAgcmV0dXJuIGNvbnRyb2xsZXIuYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIGlkZW50aWZpZXIpO1xufVxuZnVuY3Rpb24gZ2V0Q29udHJvbGxlckFuZEVuc3VyZUNvbm5lY3RlZFNjb3BlKGNvbnRyb2xsZXIsIGVsZW1lbnQsIG91dGxldE5hbWUpIHtcbiAgICBsZXQgb3V0bGV0Q29udHJvbGxlciA9IGdldE91dGxldENvbnRyb2xsZXIoY29udHJvbGxlciwgZWxlbWVudCwgb3V0bGV0TmFtZSk7XG4gICAgaWYgKG91dGxldENvbnRyb2xsZXIpXG4gICAgICAgIHJldHVybiBvdXRsZXRDb250cm9sbGVyO1xuICAgIGNvbnRyb2xsZXIuYXBwbGljYXRpb24ucm91dGVyLnByb3Bvc2VUb0Nvbm5lY3RTY29wZUZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIG91dGxldENvbnRyb2xsZXIgPSBnZXRPdXRsZXRDb250cm9sbGVyKGNvbnRyb2xsZXIsIGVsZW1lbnQsIG91dGxldE5hbWUpO1xuICAgIGlmIChvdXRsZXRDb250cm9sbGVyKVxuICAgICAgICByZXR1cm4gb3V0bGV0Q29udHJvbGxlcjtcbn1cbmZ1bmN0aW9uIHByb3BlcnRpZXNGb3JPdXRsZXREZWZpbml0aW9uKG5hbWUpIHtcbiAgICBjb25zdCBjYW1lbGl6ZWROYW1lID0gbmFtZXNwYWNlQ2FtZWxpemUobmFtZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake2NhbWVsaXplZE5hbWV9T3V0bGV0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRFbGVtZW50ID0gdGhpcy5vdXRsZXRzLmZpbmQobmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLm91dGxldHMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChvdXRsZXRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dGxldENvbnRyb2xsZXIgPSBnZXRDb250cm9sbGVyQW5kRW5zdXJlQ29ubmVjdGVkU2NvcGUodGhpcywgb3V0bGV0RWxlbWVudCwgbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRsZXRDb250cm9sbGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dGxldENvbnRyb2xsZXI7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHByb3ZpZGVkIG91dGxldCBlbGVtZW50IGlzIG1pc3NpbmcgYW4gb3V0bGV0IGNvbnRyb2xsZXIgXCIke25hbWV9XCIgaW5zdGFuY2UgZm9yIGhvc3QgY29udHJvbGxlciBcIiR7dGhpcy5pZGVudGlmaWVyfVwiYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBvdXRsZXQgZWxlbWVudCBcIiR7bmFtZX1cIiBmb3IgaG9zdCBjb250cm9sbGVyIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCIuIFN0aW11bHVzIGNvdWxkbid0IGZpbmQgYSBtYXRjaGluZyBvdXRsZXQgZWxlbWVudCB1c2luZyBzZWxlY3RvciBcIiR7c2VsZWN0b3J9XCIuYCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRzYF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRzID0gdGhpcy5vdXRsZXRzLmZpbmRBbGwobmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG91dGxldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0bGV0c1xuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgob3V0bGV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0bGV0Q29udHJvbGxlciA9IGdldENvbnRyb2xsZXJBbmRFbnN1cmVDb25uZWN0ZWRTY29wZSh0aGlzLCBvdXRsZXRFbGVtZW50LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdXRsZXRDb250cm9sbGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXRDb250cm9sbGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBUaGUgcHJvdmlkZWQgb3V0bGV0IGVsZW1lbnQgaXMgbWlzc2luZyBhbiBvdXRsZXQgY29udHJvbGxlciBcIiR7bmFtZX1cIiBpbnN0YW5jZSBmb3IgaG9zdCBjb250cm9sbGVyIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCJgLCBvdXRsZXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGNvbnRyb2xsZXIpID0+IGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRFbGVtZW50YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRsZXRFbGVtZW50ID0gdGhpcy5vdXRsZXRzLmZpbmQobmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLm91dGxldHMuZ2V0U2VsZWN0b3JGb3JPdXRsZXROYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChvdXRsZXRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRsZXRFbGVtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIG91dGxldCBlbGVtZW50IFwiJHtuYW1lfVwiIGZvciBob3N0IGNvbnRyb2xsZXIgXCIke3RoaXMuaWRlbnRpZmllcn1cIi4gU3RpbXVsdXMgY291bGRuJ3QgZmluZCBhIG1hdGNoaW5nIG91dGxldCBlbGVtZW50IHVzaW5nIHNlbGVjdG9yIFwiJHtzZWxlY3Rvcn1cIi5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYCR7Y2FtZWxpemVkTmFtZX1PdXRsZXRFbGVtZW50c2BdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3V0bGV0cy5maW5kQWxsKG5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgW2BoYXMke2NhcGl0YWxpemUoY2FtZWxpemVkTmFtZSl9T3V0bGV0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vdXRsZXRzLmhhcyhuYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gVGFyZ2V0UHJvcGVydGllc0JsZXNzaW5nKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgdGFyZ2V0cyA9IHJlYWRJbmhlcml0YWJsZVN0YXRpY0FycmF5VmFsdWVzKGNvbnN0cnVjdG9yLCBcInRhcmdldHNcIik7XG4gICAgcmV0dXJuIHRhcmdldHMucmVkdWNlKChwcm9wZXJ0aWVzLCB0YXJnZXREZWZpbml0aW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnRpZXMsIHByb3BlcnRpZXNGb3JUYXJnZXREZWZpbml0aW9uKHRhcmdldERlZmluaXRpb24pKTtcbiAgICB9LCB7fSk7XG59XG5mdW5jdGlvbiBwcm9wZXJ0aWVzRm9yVGFyZ2V0RGVmaW5pdGlvbihuYW1lKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgW2Ake25hbWV9VGFyZ2V0YF06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLnRhcmdldHMuZmluZChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgdGFyZ2V0IGVsZW1lbnQgXCIke25hbWV9XCIgZm9yIFwiJHt0aGlzLmlkZW50aWZpZXJ9XCIgY29udHJvbGxlcmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgJHtuYW1lfVRhcmdldHNgXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldHMuZmluZEFsbChuYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFtgaGFzJHtjYXBpdGFsaXplKG5hbWUpfVRhcmdldGBdOiB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0cy5oYXMobmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIFZhbHVlUHJvcGVydGllc0JsZXNzaW5nKGNvbnN0cnVjdG9yKSB7XG4gICAgY29uc3QgdmFsdWVEZWZpbml0aW9uUGFpcnMgPSByZWFkSW5oZXJpdGFibGVTdGF0aWNPYmplY3RQYWlycyhjb25zdHJ1Y3RvciwgXCJ2YWx1ZXNcIik7XG4gICAgY29uc3QgcHJvcGVydHlEZXNjcmlwdG9yTWFwID0ge1xuICAgICAgICB2YWx1ZURlc2NyaXB0b3JNYXA6IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVEZWZpbml0aW9uUGFpcnMucmVkdWNlKChyZXN1bHQsIHZhbHVlRGVmaW5pdGlvblBhaXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVEZXNjcmlwdG9yID0gcGFyc2VWYWx1ZURlZmluaXRpb25QYWlyKHZhbHVlRGVmaW5pdGlvblBhaXIsIHRoaXMuaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZU5hbWUgPSB0aGlzLmRhdGEuZ2V0QXR0cmlidXRlTmFtZUZvcktleSh2YWx1ZURlc2NyaXB0b3Iua2V5KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocmVzdWx0LCB7IFthdHRyaWJ1dGVOYW1lXTogdmFsdWVEZXNjcmlwdG9yIH0pO1xuICAgICAgICAgICAgICAgIH0sIHt9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZXR1cm4gdmFsdWVEZWZpbml0aW9uUGFpcnMucmVkdWNlKChwcm9wZXJ0aWVzLCB2YWx1ZURlZmluaXRpb25QYWlyKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHByb3BlcnRpZXMsIHByb3BlcnRpZXNGb3JWYWx1ZURlZmluaXRpb25QYWlyKHZhbHVlRGVmaW5pdGlvblBhaXIpKTtcbiAgICB9LCBwcm9wZXJ0eURlc2NyaXB0b3JNYXApO1xufVxuZnVuY3Rpb24gcHJvcGVydGllc0ZvclZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpciwgY29udHJvbGxlcikge1xuICAgIGNvbnN0IGRlZmluaXRpb24gPSBwYXJzZVZhbHVlRGVmaW5pdGlvblBhaXIodmFsdWVEZWZpbml0aW9uUGFpciwgY29udHJvbGxlcik7XG4gICAgY29uc3QgeyBrZXksIG5hbWUsIHJlYWRlcjogcmVhZCwgd3JpdGVyOiB3cml0ZSB9ID0gZGVmaW5pdGlvbjtcbiAgICByZXR1cm4ge1xuICAgICAgICBbbmFtZV06IHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGF0YS5nZXQoa2V5KTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlYWQodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmluaXRpb24uZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuc2V0KGtleSwgd3JpdGUodmFsdWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBbYGhhcyR7Y2FwaXRhbGl6ZShuYW1lKX1gXToge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEuaGFzKGtleSkgfHwgZGVmaW5pdGlvbi5oYXNDdXN0b21EZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH07XG59XG5mdW5jdGlvbiBwYXJzZVZhbHVlRGVmaW5pdGlvblBhaXIoW3Rva2VuLCB0eXBlRGVmaW5pdGlvbl0sIGNvbnRyb2xsZXIpIHtcbiAgICByZXR1cm4gdmFsdWVEZXNjcmlwdG9yRm9yVG9rZW5BbmRUeXBlRGVmaW5pdGlvbih7XG4gICAgICAgIGNvbnRyb2xsZXIsXG4gICAgICAgIHRva2VuLFxuICAgICAgICB0eXBlRGVmaW5pdGlvbixcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQoY29uc3RhbnQpIHtcbiAgICBzd2l0Y2ggKGNvbnN0YW50KSB7XG4gICAgICAgIGNhc2UgQXJyYXk6XG4gICAgICAgICAgICByZXR1cm4gXCJhcnJheVwiO1xuICAgICAgICBjYXNlIEJvb2xlYW46XG4gICAgICAgICAgICByZXR1cm4gXCJib29sZWFuXCI7XG4gICAgICAgIGNhc2UgTnVtYmVyOlxuICAgICAgICAgICAgcmV0dXJuIFwibnVtYmVyXCI7XG4gICAgICAgIGNhc2UgT2JqZWN0OlxuICAgICAgICAgICAgcmV0dXJuIFwib2JqZWN0XCI7XG4gICAgICAgIGNhc2UgU3RyaW5nOlxuICAgICAgICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KGRlZmF1bHRWYWx1ZSkge1xuICAgIHN3aXRjaCAodHlwZW9mIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYm9vbGVhblwiO1xuICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGRlZmF1bHRWYWx1ZSkpXG4gICAgICAgIHJldHVybiBcImFycmF5XCI7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkZWZhdWx0VmFsdWUpID09PSBcIltvYmplY3QgT2JqZWN0XVwiKVxuICAgICAgICByZXR1cm4gXCJvYmplY3RcIjtcbn1cbmZ1bmN0aW9uIHBhcnNlVmFsdWVUeXBlT2JqZWN0KHBheWxvYWQpIHtcbiAgICBjb25zdCB7IGNvbnRyb2xsZXIsIHRva2VuLCB0eXBlT2JqZWN0IH0gPSBwYXlsb2FkO1xuICAgIGNvbnN0IGhhc1R5cGUgPSBpc1NvbWV0aGluZyh0eXBlT2JqZWN0LnR5cGUpO1xuICAgIGNvbnN0IGhhc0RlZmF1bHQgPSBpc1NvbWV0aGluZyh0eXBlT2JqZWN0LmRlZmF1bHQpO1xuICAgIGNvbnN0IGZ1bGxPYmplY3QgPSBoYXNUeXBlICYmIGhhc0RlZmF1bHQ7XG4gICAgY29uc3Qgb25seVR5cGUgPSBoYXNUeXBlICYmICFoYXNEZWZhdWx0O1xuICAgIGNvbnN0IG9ubHlEZWZhdWx0ID0gIWhhc1R5cGUgJiYgaGFzRGVmYXVsdDtcbiAgICBjb25zdCB0eXBlRnJvbU9iamVjdCA9IHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQodHlwZU9iamVjdC50eXBlKTtcbiAgICBjb25zdCB0eXBlRnJvbURlZmF1bHRWYWx1ZSA9IHBhcnNlVmFsdWVUeXBlRGVmYXVsdChwYXlsb2FkLnR5cGVPYmplY3QuZGVmYXVsdCk7XG4gICAgaWYgKG9ubHlUeXBlKVxuICAgICAgICByZXR1cm4gdHlwZUZyb21PYmplY3Q7XG4gICAgaWYgKG9ubHlEZWZhdWx0KVxuICAgICAgICByZXR1cm4gdHlwZUZyb21EZWZhdWx0VmFsdWU7XG4gICAgaWYgKHR5cGVGcm9tT2JqZWN0ICE9PSB0eXBlRnJvbURlZmF1bHRWYWx1ZSkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0eVBhdGggPSBjb250cm9sbGVyID8gYCR7Y29udHJvbGxlcn0uJHt0b2tlbn1gIDogdG9rZW47XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHNwZWNpZmllZCBkZWZhdWx0IHZhbHVlIGZvciB0aGUgU3RpbXVsdXMgVmFsdWUgXCIke3Byb3BlcnR5UGF0aH1cIiBtdXN0IG1hdGNoIHRoZSBkZWZpbmVkIHR5cGUgXCIke3R5cGVGcm9tT2JqZWN0fVwiLiBUaGUgcHJvdmlkZWQgZGVmYXVsdCB2YWx1ZSBvZiBcIiR7dHlwZU9iamVjdC5kZWZhdWx0fVwiIGlzIG9mIHR5cGUgXCIke3R5cGVGcm9tRGVmYXVsdFZhbHVlfVwiLmApO1xuICAgIH1cbiAgICBpZiAoZnVsbE9iamVjdClcbiAgICAgICAgcmV0dXJuIHR5cGVGcm9tT2JqZWN0O1xufVxuZnVuY3Rpb24gcGFyc2VWYWx1ZVR5cGVEZWZpbml0aW9uKHBheWxvYWQpIHtcbiAgICBjb25zdCB7IGNvbnRyb2xsZXIsIHRva2VuLCB0eXBlRGVmaW5pdGlvbiB9ID0gcGF5bG9hZDtcbiAgICBjb25zdCB0eXBlT2JqZWN0ID0geyBjb250cm9sbGVyLCB0b2tlbiwgdHlwZU9iamVjdDogdHlwZURlZmluaXRpb24gfTtcbiAgICBjb25zdCB0eXBlRnJvbU9iamVjdCA9IHBhcnNlVmFsdWVUeXBlT2JqZWN0KHR5cGVPYmplY3QpO1xuICAgIGNvbnN0IHR5cGVGcm9tRGVmYXVsdFZhbHVlID0gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KHR5cGVEZWZpbml0aW9uKTtcbiAgICBjb25zdCB0eXBlRnJvbUNvbnN0YW50ID0gcGFyc2VWYWx1ZVR5cGVDb25zdGFudCh0eXBlRGVmaW5pdGlvbik7XG4gICAgY29uc3QgdHlwZSA9IHR5cGVGcm9tT2JqZWN0IHx8IHR5cGVGcm9tRGVmYXVsdFZhbHVlIHx8IHR5cGVGcm9tQ29uc3RhbnQ7XG4gICAgaWYgKHR5cGUpXG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgIGNvbnN0IHByb3BlcnR5UGF0aCA9IGNvbnRyb2xsZXIgPyBgJHtjb250cm9sbGVyfS4ke3R5cGVEZWZpbml0aW9ufWAgOiB0b2tlbjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdmFsdWUgdHlwZSBcIiR7cHJvcGVydHlQYXRofVwiIGZvciBcIiR7dG9rZW59XCIgdmFsdWVgKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRWYWx1ZUZvckRlZmluaXRpb24odHlwZURlZmluaXRpb24pIHtcbiAgICBjb25zdCBjb25zdGFudCA9IHBhcnNlVmFsdWVUeXBlQ29uc3RhbnQodHlwZURlZmluaXRpb24pO1xuICAgIGlmIChjb25zdGFudClcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZXNCeVR5cGVbY29uc3RhbnRdO1xuICAgIGNvbnN0IGhhc0RlZmF1bHQgPSBoYXNQcm9wZXJ0eSh0eXBlRGVmaW5pdGlvbiwgXCJkZWZhdWx0XCIpO1xuICAgIGNvbnN0IGhhc1R5cGUgPSBoYXNQcm9wZXJ0eSh0eXBlRGVmaW5pdGlvbiwgXCJ0eXBlXCIpO1xuICAgIGNvbnN0IHR5cGVPYmplY3QgPSB0eXBlRGVmaW5pdGlvbjtcbiAgICBpZiAoaGFzRGVmYXVsdClcbiAgICAgICAgcmV0dXJuIHR5cGVPYmplY3QuZGVmYXVsdDtcbiAgICBpZiAoaGFzVHlwZSkge1xuICAgICAgICBjb25zdCB7IHR5cGUgfSA9IHR5cGVPYmplY3Q7XG4gICAgICAgIGNvbnN0IGNvbnN0YW50RnJvbVR5cGUgPSBwYXJzZVZhbHVlVHlwZUNvbnN0YW50KHR5cGUpO1xuICAgICAgICBpZiAoY29uc3RhbnRGcm9tVHlwZSlcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWVzQnlUeXBlW2NvbnN0YW50RnJvbVR5cGVdO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZURlZmluaXRpb247XG59XG5mdW5jdGlvbiB2YWx1ZURlc2NyaXB0b3JGb3JUb2tlbkFuZFR5cGVEZWZpbml0aW9uKHBheWxvYWQpIHtcbiAgICBjb25zdCB7IHRva2VuLCB0eXBlRGVmaW5pdGlvbiB9ID0gcGF5bG9hZDtcbiAgICBjb25zdCBrZXkgPSBgJHtkYXNoZXJpemUodG9rZW4pfS12YWx1ZWA7XG4gICAgY29uc3QgdHlwZSA9IHBhcnNlVmFsdWVUeXBlRGVmaW5pdGlvbihwYXlsb2FkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlLFxuICAgICAgICBrZXksXG4gICAgICAgIG5hbWU6IGNhbWVsaXplKGtleSksXG4gICAgICAgIGdldCBkZWZhdWx0VmFsdWUoKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlRm9yRGVmaW5pdGlvbih0eXBlRGVmaW5pdGlvbik7XG4gICAgICAgIH0sXG4gICAgICAgIGdldCBoYXNDdXN0b21EZWZhdWx0VmFsdWUoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VWYWx1ZVR5cGVEZWZhdWx0KHR5cGVEZWZpbml0aW9uKSAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICByZWFkZXI6IHJlYWRlcnNbdHlwZV0sXG4gICAgICAgIHdyaXRlcjogd3JpdGVyc1t0eXBlXSB8fCB3cml0ZXJzLmRlZmF1bHQsXG4gICAgfTtcbn1cbmNvbnN0IGRlZmF1bHRWYWx1ZXNCeVR5cGUgPSB7XG4gICAgZ2V0IGFycmF5KCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICBib29sZWFuOiBmYWxzZSxcbiAgICBudW1iZXI6IDAsXG4gICAgZ2V0IG9iamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH0sXG4gICAgc3RyaW5nOiBcIlwiLFxufTtcbmNvbnN0IHJlYWRlcnMgPSB7XG4gICAgYXJyYXkodmFsdWUpIHtcbiAgICAgICAgY29uc3QgYXJyYXkgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFycmF5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgZXhwZWN0ZWQgdmFsdWUgb2YgdHlwZSBcImFycmF5XCIgYnV0IGluc3RlYWQgZ290IHZhbHVlIFwiJHt2YWx1ZX1cIiBvZiB0eXBlIFwiJHtwYXJzZVZhbHVlVHlwZURlZmF1bHQoYXJyYXkpfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH0sXG4gICAgYm9vbGVhbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gISh2YWx1ZSA9PSBcIjBcIiB8fCBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkgPT0gXCJmYWxzZVwiKTtcbiAgICB9LFxuICAgIG51bWJlcih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlLnJlcGxhY2UoL18vZywgXCJcIikpO1xuICAgIH0sXG4gICAgb2JqZWN0KHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdCA9IEpTT04ucGFyc2UodmFsdWUpO1xuICAgICAgICBpZiAob2JqZWN0ID09PSBudWxsIHx8IHR5cGVvZiBvYmplY3QgIT0gXCJvYmplY3RcIiB8fCBBcnJheS5pc0FycmF5KG9iamVjdCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIHZhbHVlIG9mIHR5cGUgXCJvYmplY3RcIiBidXQgaW5zdGVhZCBnb3QgdmFsdWUgXCIke3ZhbHVlfVwiIG9mIHR5cGUgXCIke3BhcnNlVmFsdWVUeXBlRGVmYXVsdChvYmplY3QpfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9LFxuICAgIHN0cmluZyh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbn07XG5jb25zdCB3cml0ZXJzID0ge1xuICAgIGRlZmF1bHQ6IHdyaXRlU3RyaW5nLFxuICAgIGFycmF5OiB3cml0ZUpTT04sXG4gICAgb2JqZWN0OiB3cml0ZUpTT04sXG59O1xuZnVuY3Rpb24gd3JpdGVKU09OKHZhbHVlKSB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHdyaXRlU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIGAke3ZhbHVlfWA7XG59XG5cbmNsYXNzIENvbnRyb2xsZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICB9XG4gICAgc3RhdGljIGdldCBzaG91bGRMb2FkKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgc3RhdGljIGFmdGVyTG9hZChfaWRlbnRpZmllciwgX2FwcGxpY2F0aW9uKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZ2V0IGFwcGxpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmFwcGxpY2F0aW9uO1xuICAgIH1cbiAgICBnZXQgc2NvcGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc2NvcGU7XG4gICAgfVxuICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5lbGVtZW50O1xuICAgIH1cbiAgICBnZXQgaWRlbnRpZmllcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuaWRlbnRpZmllcjtcbiAgICB9XG4gICAgZ2V0IHRhcmdldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLnRhcmdldHM7XG4gICAgfVxuICAgIGdldCBvdXRsZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY29wZS5vdXRsZXRzO1xuICAgIH1cbiAgICBnZXQgY2xhc3NlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NvcGUuY2xhc3NlcztcbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlLmRhdGE7XG4gICAgfVxuICAgIGluaXRpYWxpemUoKSB7XG4gICAgfVxuICAgIGNvbm5lY3QoKSB7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgfVxuICAgIGRpc3BhdGNoKGV2ZW50TmFtZSwgeyB0YXJnZXQgPSB0aGlzLmVsZW1lbnQsIGRldGFpbCA9IHt9LCBwcmVmaXggPSB0aGlzLmlkZW50aWZpZXIsIGJ1YmJsZXMgPSB0cnVlLCBjYW5jZWxhYmxlID0gdHJ1ZSwgfSA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBwcmVmaXggPyBgJHtwcmVmaXh9OiR7ZXZlbnROYW1lfWAgOiBldmVudE5hbWU7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KHR5cGUsIHsgZGV0YWlsLCBidWJibGVzLCBjYW5jZWxhYmxlIH0pO1xuICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICB9XG59XG5Db250cm9sbGVyLmJsZXNzaW5ncyA9IFtcbiAgICBDbGFzc1Byb3BlcnRpZXNCbGVzc2luZyxcbiAgICBUYXJnZXRQcm9wZXJ0aWVzQmxlc3NpbmcsXG4gICAgVmFsdWVQcm9wZXJ0aWVzQmxlc3NpbmcsXG4gICAgT3V0bGV0UHJvcGVydGllc0JsZXNzaW5nLFxuXTtcbkNvbnRyb2xsZXIudGFyZ2V0cyA9IFtdO1xuQ29udHJvbGxlci5vdXRsZXRzID0gW107XG5Db250cm9sbGVyLnZhbHVlcyA9IHt9O1xuXG5leHBvcnQgeyBBcHBsaWNhdGlvbiwgQXR0cmlidXRlT2JzZXJ2ZXIsIENvbnRleHQsIENvbnRyb2xsZXIsIEVsZW1lbnRPYnNlcnZlciwgSW5kZXhlZE11bHRpbWFwLCBNdWx0aW1hcCwgU2VsZWN0b3JPYnNlcnZlciwgU3RyaW5nTWFwT2JzZXJ2ZXIsIFRva2VuTGlzdE9ic2VydmVyLCBWYWx1ZUxpc3RPYnNlcnZlciwgYWRkLCBkZWZhdWx0U2NoZW1hLCBkZWwsIGZldGNoLCBwcnVuZSB9O1xuIiwiLyohXG5UdXJibyA4LjAuMTJcbkNvcHlyaWdodCDCqSAyMDI0IDM3c2lnbmFscyBMTENcbiAqL1xuLyoqXG4gKiBUaGUgTUlUIExpY2Vuc2UgKE1JVClcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTkgSmF2YW4gTWFraG1hbGlcbiAqXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gKlxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICpcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICovXG5cbihmdW5jdGlvbiAocHJvdG90eXBlKSB7XG4gIGlmICh0eXBlb2YgcHJvdG90eXBlLnJlcXVlc3RTdWJtaXQgPT0gXCJmdW5jdGlvblwiKSByZXR1cm5cblxuICBwcm90b3R5cGUucmVxdWVzdFN1Ym1pdCA9IGZ1bmN0aW9uIChzdWJtaXR0ZXIpIHtcbiAgICBpZiAoc3VibWl0dGVyKSB7XG4gICAgICB2YWxpZGF0ZVN1Ym1pdHRlcihzdWJtaXR0ZXIsIHRoaXMpO1xuICAgICAgc3VibWl0dGVyLmNsaWNrKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Ym1pdHRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICAgIHN1Ym1pdHRlci50eXBlID0gXCJzdWJtaXRcIjtcbiAgICAgIHN1Ym1pdHRlci5oaWRkZW4gPSB0cnVlO1xuICAgICAgdGhpcy5hcHBlbmRDaGlsZChzdWJtaXR0ZXIpO1xuICAgICAgc3VibWl0dGVyLmNsaWNrKCk7XG4gICAgICB0aGlzLnJlbW92ZUNoaWxkKHN1Ym1pdHRlcik7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbGlkYXRlU3VibWl0dGVyKHN1Ym1pdHRlciwgZm9ybSkge1xuICAgIHN1Ym1pdHRlciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IHx8IHJhaXNlKFR5cGVFcnJvciwgXCJwYXJhbWV0ZXIgMSBpcyBub3Qgb2YgdHlwZSAnSFRNTEVsZW1lbnQnXCIpO1xuICAgIHN1Ym1pdHRlci50eXBlID09IFwic3VibWl0XCIgfHwgcmFpc2UoVHlwZUVycm9yLCBcIlRoZSBzcGVjaWZpZWQgZWxlbWVudCBpcyBub3QgYSBzdWJtaXQgYnV0dG9uXCIpO1xuICAgIHN1Ym1pdHRlci5mb3JtID09IGZvcm0gfHxcbiAgICAgIHJhaXNlKERPTUV4Y2VwdGlvbiwgXCJUaGUgc3BlY2lmaWVkIGVsZW1lbnQgaXMgbm90IG93bmVkIGJ5IHRoaXMgZm9ybSBlbGVtZW50XCIsIFwiTm90Rm91bmRFcnJvclwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJhaXNlKGVycm9yQ29uc3RydWN0b3IsIG1lc3NhZ2UsIG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JDb25zdHJ1Y3RvcihcIkZhaWxlZCB0byBleGVjdXRlICdyZXF1ZXN0U3VibWl0JyBvbiAnSFRNTEZvcm1FbGVtZW50JzogXCIgKyBtZXNzYWdlICsgXCIuXCIsIG5hbWUpXG4gIH1cbn0pKEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUpO1xuXG5jb25zdCBzdWJtaXR0ZXJzQnlGb3JtID0gbmV3IFdlYWtNYXAoKTtcblxuZnVuY3Rpb24gZmluZFN1Ym1pdHRlckZyb21DbGlja1RhcmdldCh0YXJnZXQpIHtcbiAgY29uc3QgZWxlbWVudCA9IHRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQgPyB0YXJnZXQgOiB0YXJnZXQgaW5zdGFuY2VvZiBOb2RlID8gdGFyZ2V0LnBhcmVudEVsZW1lbnQgOiBudWxsO1xuICBjb25zdCBjYW5kaWRhdGUgPSBlbGVtZW50ID8gZWxlbWVudC5jbG9zZXN0KFwiaW5wdXQsIGJ1dHRvblwiKSA6IG51bGw7XG4gIHJldHVybiBjYW5kaWRhdGU/LnR5cGUgPT0gXCJzdWJtaXRcIiA/IGNhbmRpZGF0ZSA6IG51bGxcbn1cblxuZnVuY3Rpb24gY2xpY2tDYXB0dXJlZChldmVudCkge1xuICBjb25zdCBzdWJtaXR0ZXIgPSBmaW5kU3VibWl0dGVyRnJvbUNsaWNrVGFyZ2V0KGV2ZW50LnRhcmdldCk7XG5cbiAgaWYgKHN1Ym1pdHRlciAmJiBzdWJtaXR0ZXIuZm9ybSkge1xuICAgIHN1Ym1pdHRlcnNCeUZvcm0uc2V0KHN1Ym1pdHRlci5mb3JtLCBzdWJtaXR0ZXIpO1xuICB9XG59XG5cbihmdW5jdGlvbiAoKSB7XG4gIGlmIChcInN1Ym1pdHRlclwiIGluIEV2ZW50LnByb3RvdHlwZSkgcmV0dXJuXG5cbiAgbGV0IHByb3RvdHlwZSA9IHdpbmRvdy5FdmVudC5wcm90b3R5cGU7XG4gIC8vIENlcnRhaW4gdmVyc2lvbnMgb2YgU2FmYXJpIDE1IGhhdmUgYSBidWcgd2hlcmUgdGhleSB3b24ndFxuICAvLyBwb3B1bGF0ZSB0aGUgc3VibWl0dGVyLiBUaGlzIGh1cnRzIFR1cmJvRHJpdmUncyBlbmFibGUvZGlzYWJsZSBkZXRlY3Rpb24uXG4gIC8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjI5NjYwXG4gIGlmIChcIlN1Ym1pdEV2ZW50XCIgaW4gd2luZG93KSB7XG4gICAgY29uc3QgcHJvdG90eXBlT2ZTdWJtaXRFdmVudCA9IHdpbmRvdy5TdWJtaXRFdmVudC5wcm90b3R5cGU7XG5cbiAgICBpZiAoL0FwcGxlIENvbXB1dGVyLy50ZXN0KG5hdmlnYXRvci52ZW5kb3IpICYmICEoXCJzdWJtaXR0ZXJcIiBpbiBwcm90b3R5cGVPZlN1Ym1pdEV2ZW50KSkge1xuICAgICAgcHJvdG90eXBlID0gcHJvdG90eXBlT2ZTdWJtaXRFdmVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIC8vIHBvbHlmaWxsIG5vdCBuZWVkZWRcbiAgICB9XG4gIH1cblxuICBhZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2tDYXB0dXJlZCwgdHJ1ZSk7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZSwgXCJzdWJtaXR0ZXJcIiwge1xuICAgIGdldCgpIHtcbiAgICAgIGlmICh0aGlzLnR5cGUgPT0gXCJzdWJtaXRcIiAmJiB0aGlzLnRhcmdldCBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCkge1xuICAgICAgICByZXR1cm4gc3VibWl0dGVyc0J5Rm9ybS5nZXQodGhpcy50YXJnZXQpXG4gICAgICB9XG4gICAgfVxuICB9KTtcbn0pKCk7XG5cbmNvbnN0IEZyYW1lTG9hZGluZ1N0eWxlID0ge1xuICBlYWdlcjogXCJlYWdlclwiLFxuICBsYXp5OiBcImxhenlcIlxufTtcblxuLyoqXG4gKiBDb250YWlucyBhIGZyYWdtZW50IG9mIEhUTUwgd2hpY2ggaXMgdXBkYXRlZCBiYXNlZCBvbiBuYXZpZ2F0aW9uIHdpdGhpblxuICogaXQgKGUuZy4gdmlhIGxpbmtzIG9yIGZvcm0gc3VibWlzc2lvbnMpLlxuICpcbiAqIEBjdXN0b21FbGVtZW50IHR1cmJvLWZyYW1lXG4gKiBAZXhhbXBsZVxuICogICA8dHVyYm8tZnJhbWUgaWQ9XCJtZXNzYWdlc1wiPlxuICogICAgIDxhIGhyZWY9XCIvbWVzc2FnZXMvZXhwYW5kZWRcIj5cbiAqICAgICAgIFNob3cgYWxsIGV4cGFuZGVkIG1lc3NhZ2VzIGluIHRoaXMgZnJhbWUuXG4gKiAgICAgPC9hPlxuICpcbiAqICAgICA8Zm9ybSBhY3Rpb249XCIvbWVzc2FnZXNcIj5cbiAqICAgICAgIFNob3cgcmVzcG9uc2UgZnJvbSB0aGlzIGZvcm0gd2l0aGluIHRoaXMgZnJhbWUuXG4gKiAgICAgPC9mb3JtPlxuICogICA8L3R1cmJvLWZyYW1lPlxuICovXG5jbGFzcyBGcmFtZUVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIHN0YXRpYyBkZWxlZ2F0ZUNvbnN0cnVjdG9yID0gdW5kZWZpbmVkXG5cbiAgbG9hZGVkID0gUHJvbWlzZS5yZXNvbHZlKClcblxuICBzdGF0aWMgZ2V0IG9ic2VydmVkQXR0cmlidXRlcygpIHtcbiAgICByZXR1cm4gW1wiZGlzYWJsZWRcIiwgXCJsb2FkaW5nXCIsIFwic3JjXCJdXG4gIH1cblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZGVsZWdhdGUgPSBuZXcgRnJhbWVFbGVtZW50LmRlbGVnYXRlQ29uc3RydWN0b3IodGhpcyk7XG4gIH1cblxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLmRlbGVnYXRlLmNvbm5lY3QoKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRoaXMuZGVsZWdhdGUuZGlzY29ubmVjdCgpO1xuICB9XG5cbiAgcmVsb2FkKCkge1xuICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLnNvdXJjZVVSTFJlbG9hZGVkKClcbiAgfVxuXG4gIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lKSB7XG4gICAgaWYgKG5hbWUgPT0gXCJsb2FkaW5nXCIpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUubG9hZGluZ1N0eWxlQ2hhbmdlZCgpO1xuICAgIH0gZWxzZSBpZiAobmFtZSA9PSBcInNyY1wiKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnNvdXJjZVVSTENoYW5nZWQoKTtcbiAgICB9IGVsc2UgaWYgKG5hbWUgPT0gXCJkaXNhYmxlZFwiKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLmRpc2FibGVkQ2hhbmdlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBVUkwgdG8gbGF6aWx5IGxvYWQgc291cmNlIEhUTUwgZnJvbVxuICAgKi9cbiAgZ2V0IHNyYygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJzcmNcIilcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBVUkwgdG8gbGF6aWx5IGxvYWQgc291cmNlIEhUTUwgZnJvbVxuICAgKi9cbiAgc2V0IHNyYyh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcInNyY1wiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgcmVmcmVzaCBtb2RlIGZvciB0aGUgZnJhbWUuXG4gICAqL1xuICBnZXQgcmVmcmVzaCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJyZWZyZXNoXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgcmVmcmVzaCBtb2RlIGZvciB0aGUgZnJhbWUuXG4gICAqL1xuICBzZXQgcmVmcmVzaCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJyZWZyZXNoXCIsIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoXCJyZWZyZXNoXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzaG91bGRSZWxvYWRXaXRoTW9ycGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3JjICYmIHRoaXMucmVmcmVzaCA9PT0gXCJtb3JwaFwiXG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgZWxlbWVudCBpcyBsb2FkaW5nXG4gICAqL1xuICBnZXQgbG9hZGluZygpIHtcbiAgICByZXR1cm4gZnJhbWVMb2FkaW5nU3R5bGVGcm9tU3RyaW5nKHRoaXMuZ2V0QXR0cmlidXRlKFwibG9hZGluZ1wiKSB8fCBcIlwiKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHZhbHVlIG9mIGlmIHRoZSBlbGVtZW50IGlzIGxvYWRpbmdcbiAgICovXG4gIHNldCBsb2FkaW5nKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImxvYWRpbmdcIiwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShcImxvYWRpbmdcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGRpc2FibGVkIHN0YXRlIG9mIHRoZSBmcmFtZS5cbiAgICpcbiAgICogSWYgZGlzYWJsZWQsIG5vIHJlcXVlc3RzIHdpbGwgYmUgaW50ZXJjZXB0ZWQgYnkgdGhlIGZyYW1lLlxuICAgKi9cbiAgZ2V0IGRpc2FibGVkKCkge1xuICAgIHJldHVybiB0aGlzLmhhc0F0dHJpYnV0ZShcImRpc2FibGVkXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgZGlzYWJsZWQgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiBkaXNhYmxlZCwgbm8gcmVxdWVzdHMgd2lsbCBiZSBpbnRlcmNlcHRlZCBieSB0aGUgZnJhbWUuXG4gICAqL1xuICBzZXQgZGlzYWJsZWQodmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGF1dG9zY3JvbGwgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiB0cnVlLCB0aGUgZnJhbWUgd2lsbCBiZSBzY3JvbGxlZCBpbnRvIHZpZXcgYXV0b21hdGljYWxseSBvbiB1cGRhdGUuXG4gICAqL1xuICBnZXQgYXV0b3Njcm9sbCgpIHtcbiAgICByZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoXCJhdXRvc2Nyb2xsXCIpXG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYXV0b3Njcm9sbCBzdGF0ZSBvZiB0aGUgZnJhbWUuXG4gICAqXG4gICAqIElmIHRydWUsIHRoZSBmcmFtZSB3aWxsIGJlIHNjcm9sbGVkIGludG8gdmlldyBhdXRvbWF0aWNhbGx5IG9uIHVwZGF0ZS5cbiAgICovXG4gIHNldCBhdXRvc2Nyb2xsKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImF1dG9zY3JvbGxcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKFwiYXV0b3Njcm9sbFwiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgZWxlbWVudCBoYXMgZmluaXNoZWQgbG9hZGluZ1xuICAgKi9cbiAgZ2V0IGNvbXBsZXRlKCkge1xuICAgIHJldHVybiAhdGhpcy5kZWxlZ2F0ZS5pc0xvYWRpbmdcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBhY3RpdmUgc3RhdGUgb2YgdGhlIGZyYW1lLlxuICAgKlxuICAgKiBJZiBpbmFjdGl2ZSwgc291cmNlIGNoYW5nZXMgd2lsbCBub3QgYmUgb2JzZXJ2ZWQuXG4gICAqL1xuICBnZXQgaXNBY3RpdmUoKSB7XG4gICAgcmV0dXJuIHRoaXMub3duZXJEb2N1bWVudCA9PT0gZG9jdW1lbnQgJiYgIXRoaXMuaXNQcmV2aWV3XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgYWN0aXZlIHN0YXRlIG9mIHRoZSBmcmFtZS5cbiAgICpcbiAgICogSWYgaW5hY3RpdmUsIHNvdXJjZSBjaGFuZ2VzIHdpbGwgbm90IGJlIG9ic2VydmVkLlxuICAgKi9cbiAgZ2V0IGlzUHJldmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5vd25lckRvY3VtZW50Py5kb2N1bWVudEVsZW1lbnQ/Lmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tcHJldmlld1wiKVxuICB9XG59XG5cbmZ1bmN0aW9uIGZyYW1lTG9hZGluZ1N0eWxlRnJvbVN0cmluZyhzdHlsZSkge1xuICBzd2l0Y2ggKHN0eWxlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlIFwibGF6eVwiOlxuICAgICAgcmV0dXJuIEZyYW1lTG9hZGluZ1N0eWxlLmxhenlcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIEZyYW1lTG9hZGluZ1N0eWxlLmVhZ2VyXG4gIH1cbn1cblxuY29uc3QgZHJpdmUgPSB7XG4gIGVuYWJsZWQ6IHRydWUsXG4gIHByb2dyZXNzQmFyRGVsYXk6IDUwMCxcbiAgdW52aXNpdGFibGVFeHRlbnNpb25zOiBuZXcgU2V0KFxuICAgIFtcbiAgICAgIFwiLjd6XCIsIFwiLmFhY1wiLCBcIi5hcGtcIiwgXCIuYXZpXCIsIFwiLmJtcFwiLCBcIi5iejJcIiwgXCIuY3NzXCIsIFwiLmNzdlwiLCBcIi5kZWJcIiwgXCIuZG1nXCIsIFwiLmRvY1wiLFxuICAgICAgXCIuZG9jeFwiLCBcIi5leGVcIiwgXCIuZ2lmXCIsIFwiLmd6XCIsIFwiLmhlaWNcIiwgXCIuaGVpZlwiLCBcIi5pY29cIiwgXCIuaXNvXCIsIFwiLmpwZWdcIiwgXCIuanBnXCIsXG4gICAgICBcIi5qc1wiLCBcIi5qc29uXCIsIFwiLm00YVwiLCBcIi5ta3ZcIiwgXCIubW92XCIsIFwiLm1wM1wiLCBcIi5tcDRcIiwgXCIubXBlZ1wiLCBcIi5tcGdcIiwgXCIubXNpXCIsXG4gICAgICBcIi5vZ2dcIiwgXCIub2d2XCIsIFwiLnBkZlwiLCBcIi5wa2dcIiwgXCIucG5nXCIsIFwiLnBwdFwiLCBcIi5wcHR4XCIsIFwiLnJhclwiLCBcIi5ydGZcIixcbiAgICAgIFwiLnN2Z1wiLCBcIi50YXJcIiwgXCIudGlmXCIsIFwiLnRpZmZcIiwgXCIudHh0XCIsIFwiLndhdlwiLCBcIi53ZWJtXCIsIFwiLndlYnBcIiwgXCIud21hXCIsIFwiLndtdlwiLFxuICAgICAgXCIueGxzXCIsIFwiLnhsc3hcIiwgXCIueG1sXCIsIFwiLnppcFwiXG4gICAgXVxuICApXG59O1xuXG5mdW5jdGlvbiBhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWV2YWxcIikgPT0gXCJmYWxzZVwiKSB7XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBjcmVhdGVkU2NyaXB0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgY29uc3QgY3NwTm9uY2UgPSBnZXRDc3BOb25jZSgpO1xuICAgIGlmIChjc3BOb25jZSkge1xuICAgICAgY3JlYXRlZFNjcmlwdEVsZW1lbnQubm9uY2UgPSBjc3BOb25jZTtcbiAgICB9XG4gICAgY3JlYXRlZFNjcmlwdEVsZW1lbnQudGV4dENvbnRlbnQgPSBlbGVtZW50LnRleHRDb250ZW50O1xuICAgIGNyZWF0ZWRTY3JpcHRFbGVtZW50LmFzeW5jID0gZmFsc2U7XG4gICAgY29weUVsZW1lbnRBdHRyaWJ1dGVzKGNyZWF0ZWRTY3JpcHRFbGVtZW50LCBlbGVtZW50KTtcbiAgICByZXR1cm4gY3JlYXRlZFNjcmlwdEVsZW1lbnRcbiAgfVxufVxuXG5mdW5jdGlvbiBjb3B5RWxlbWVudEF0dHJpYnV0ZXMoZGVzdGluYXRpb25FbGVtZW50LCBzb3VyY2VFbGVtZW50KSB7XG4gIGZvciAoY29uc3QgeyBuYW1lLCB2YWx1ZSB9IG9mIHNvdXJjZUVsZW1lbnQuYXR0cmlidXRlcykge1xuICAgIGRlc3RpbmF0aW9uRWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50RnJhZ21lbnQoaHRtbCkge1xuICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZW1wbGF0ZVwiKTtcbiAgdGVtcGxhdGUuaW5uZXJIVE1MID0gaHRtbDtcbiAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnRcbn1cblxuZnVuY3Rpb24gZGlzcGF0Y2goZXZlbnROYW1lLCB7IHRhcmdldCwgY2FuY2VsYWJsZSwgZGV0YWlsIH0gPSB7fSkge1xuICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudE5hbWUsIHtcbiAgICBjYW5jZWxhYmxlLFxuICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgY29tcG9zZWQ6IHRydWUsXG4gICAgZGV0YWlsXG4gIH0pO1xuXG4gIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmlzQ29ubmVjdGVkKSB7XG4gICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9IGVsc2Uge1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfVxuXG4gIHJldHVybiBldmVudFxufVxuXG5mdW5jdGlvbiBjYW5jZWxFdmVudChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbn1cblxuZnVuY3Rpb24gbmV4dFJlcGFpbnQoKSB7XG4gIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT09IFwiaGlkZGVuXCIpIHtcbiAgICByZXR1cm4gbmV4dEV2ZW50TG9vcFRpY2soKVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBuZXh0QW5pbWF0aW9uRnJhbWUoKVxuICB9XG59XG5cbmZ1bmN0aW9uIG5leHRBbmltYXRpb25GcmFtZSgpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVzb2x2ZSgpKSlcbn1cblxuZnVuY3Rpb24gbmV4dEV2ZW50TG9vcFRpY2soKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKCksIDApKVxufVxuXG5mdW5jdGlvbiBuZXh0TWljcm90YXNrKCkge1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbn1cblxuZnVuY3Rpb24gcGFyc2VIVE1MRG9jdW1lbnQoaHRtbCA9IFwiXCIpIHtcbiAgcmV0dXJuIG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoaHRtbCwgXCJ0ZXh0L2h0bWxcIilcbn1cblxuZnVuY3Rpb24gdW5pbmRlbnQoc3RyaW5ncywgLi4udmFsdWVzKSB7XG4gIGNvbnN0IGxpbmVzID0gaW50ZXJwb2xhdGUoc3RyaW5ncywgdmFsdWVzKS5yZXBsYWNlKC9eXFxuLywgXCJcIikuc3BsaXQoXCJcXG5cIik7XG4gIGNvbnN0IG1hdGNoID0gbGluZXNbMF0ubWF0Y2goL15cXHMrLyk7XG4gIGNvbnN0IGluZGVudCA9IG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMDtcbiAgcmV0dXJuIGxpbmVzLm1hcCgobGluZSkgPT4gbGluZS5zbGljZShpbmRlbnQpKS5qb2luKFwiXFxuXCIpXG59XG5cbmZ1bmN0aW9uIGludGVycG9sYXRlKHN0cmluZ3MsIHZhbHVlcykge1xuICByZXR1cm4gc3RyaW5ncy5yZWR1Y2UoKHJlc3VsdCwgc3RyaW5nLCBpKSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV0gPT0gdW5kZWZpbmVkID8gXCJcIiA6IHZhbHVlc1tpXTtcbiAgICByZXR1cm4gcmVzdWx0ICsgc3RyaW5nICsgdmFsdWVcbiAgfSwgXCJcIilcbn1cblxuZnVuY3Rpb24gdXVpZCgpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGg6IDM2IH0pXG4gICAgLm1hcCgoXywgaSkgPT4ge1xuICAgICAgaWYgKGkgPT0gOCB8fCBpID09IDEzIHx8IGkgPT0gMTggfHwgaSA9PSAyMykge1xuICAgICAgICByZXR1cm4gXCItXCJcbiAgICAgIH0gZWxzZSBpZiAoaSA9PSAxNCkge1xuICAgICAgICByZXR1cm4gXCI0XCJcbiAgICAgIH0gZWxzZSBpZiAoaSA9PSAxOSkge1xuICAgICAgICByZXR1cm4gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgOCkudG9TdHJpbmcoMTYpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTUpLnRvU3RyaW5nKDE2KVxuICAgICAgfVxuICAgIH0pXG4gICAgLmpvaW4oXCJcIilcbn1cblxuZnVuY3Rpb24gZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIC4uLmVsZW1lbnRzKSB7XG4gIGZvciAoY29uc3QgdmFsdWUgb2YgZWxlbWVudHMubWFwKChlbGVtZW50KSA9PiBlbGVtZW50Py5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkpKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKSByZXR1cm4gdmFsdWVcbiAgfVxuXG4gIHJldHVybiBudWxsXG59XG5cbmZ1bmN0aW9uIGhhc0F0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCAuLi5lbGVtZW50cykge1xuICByZXR1cm4gZWxlbWVudHMuc29tZSgoZWxlbWVudCkgPT4gZWxlbWVudCAmJiBlbGVtZW50Lmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSlcbn1cblxuZnVuY3Rpb24gbWFya0FzQnVzeSguLi5lbGVtZW50cykge1xuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHtcbiAgICBpZiAoZWxlbWVudC5sb2NhbE5hbWUgPT0gXCJ0dXJiby1mcmFtZVwiKSB7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImJ1c3lcIiwgXCJcIik7XG4gICAgfVxuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1idXN5XCIsIFwidHJ1ZVwiKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjbGVhckJ1c3lTdGF0ZSguLi5lbGVtZW50cykge1xuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHMpIHtcbiAgICBpZiAoZWxlbWVudC5sb2NhbE5hbWUgPT0gXCJ0dXJiby1mcmFtZVwiKSB7XG4gICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImJ1c3lcIik7XG4gICAgfVxuXG4gICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWJ1c3lcIik7XG4gIH1cbn1cblxuZnVuY3Rpb24gd2FpdEZvckxvYWQoZWxlbWVudCwgdGltZW91dEluTWlsbGlzZWNvbmRzID0gMjAwMCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjb25zdCBvbkNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgb25Db21wbGV0ZSk7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uQ29tcGxldGUpO1xuICAgICAgcmVzb2x2ZSgpO1xuICAgIH07XG5cbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIG9uQ29tcGxldGUsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBvbkNvbXBsZXRlLCB7IG9uY2U6IHRydWUgfSk7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCB0aW1lb3V0SW5NaWxsaXNlY29uZHMpO1xuICB9KVxufVxuXG5mdW5jdGlvbiBnZXRIaXN0b3J5TWV0aG9kRm9yQWN0aW9uKGFjdGlvbikge1xuICBzd2l0Y2ggKGFjdGlvbikge1xuICAgIGNhc2UgXCJyZXBsYWNlXCI6XG4gICAgICByZXR1cm4gaGlzdG9yeS5yZXBsYWNlU3RhdGVcbiAgICBjYXNlIFwiYWR2YW5jZVwiOlxuICAgIGNhc2UgXCJyZXN0b3JlXCI6XG4gICAgICByZXR1cm4gaGlzdG9yeS5wdXNoU3RhdGVcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0FjdGlvbihhY3Rpb24pIHtcbiAgcmV0dXJuIGFjdGlvbiA9PSBcImFkdmFuY2VcIiB8fCBhY3Rpb24gPT0gXCJyZXBsYWNlXCIgfHwgYWN0aW9uID09IFwicmVzdG9yZVwiXG59XG5cbmZ1bmN0aW9uIGdldFZpc2l0QWN0aW9uKC4uLmVsZW1lbnRzKSB7XG4gIGNvbnN0IGFjdGlvbiA9IGdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tYWN0aW9uXCIsIC4uLmVsZW1lbnRzKTtcblxuICByZXR1cm4gaXNBY3Rpb24oYWN0aW9uKSA/IGFjdGlvbiA6IG51bGxcbn1cblxuZnVuY3Rpb24gZ2V0TWV0YUVsZW1lbnQobmFtZSkge1xuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbWV0YVtuYW1lPVwiJHtuYW1lfVwiXWApXG59XG5cbmZ1bmN0aW9uIGdldE1ldGFDb250ZW50KG5hbWUpIHtcbiAgY29uc3QgZWxlbWVudCA9IGdldE1ldGFFbGVtZW50KG5hbWUpO1xuICByZXR1cm4gZWxlbWVudCAmJiBlbGVtZW50LmNvbnRlbnRcbn1cblxuZnVuY3Rpb24gZ2V0Q3NwTm9uY2UoKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBnZXRNZXRhRWxlbWVudChcImNzcC1ub25jZVwiKTtcblxuICBpZiAoZWxlbWVudCkge1xuICAgIGNvbnN0IHsgbm9uY2UsIGNvbnRlbnQgfSA9IGVsZW1lbnQ7XG4gICAgcmV0dXJuIG5vbmNlID09IFwiXCIgPyBjb250ZW50IDogbm9uY2VcbiAgfVxufVxuXG5mdW5jdGlvbiBzZXRNZXRhQ29udGVudChuYW1lLCBjb250ZW50KSB7XG4gIGxldCBlbGVtZW50ID0gZ2V0TWV0YUVsZW1lbnQobmFtZSk7XG5cbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJtZXRhXCIpO1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBuYW1lKTtcblxuICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gIH1cblxuICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImNvbnRlbnRcIiwgY29udGVudCk7XG5cbiAgcmV0dXJuIGVsZW1lbnRcbn1cblxuZnVuY3Rpb24gZmluZENsb3Nlc3RSZWN1cnNpdmVseShlbGVtZW50LCBzZWxlY3Rvcikge1xuICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgZWxlbWVudC5jbG9zZXN0KHNlbGVjdG9yKSB8fCBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KGVsZW1lbnQuYXNzaWduZWRTbG90IHx8IGVsZW1lbnQuZ2V0Um9vdE5vZGUoKT8uaG9zdCwgc2VsZWN0b3IpXG4gICAgKVxuICB9XG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRJc0ZvY3VzYWJsZShlbGVtZW50KSB7XG4gIGNvbnN0IGluZXJ0RGlzYWJsZWRPckhpZGRlbiA9IFwiW2luZXJ0XSwgOmRpc2FibGVkLCBbaGlkZGVuXSwgZGV0YWlsczpub3QoW29wZW5dKSwgZGlhbG9nOm5vdChbb3Blbl0pXCI7XG5cbiAgcmV0dXJuICEhZWxlbWVudCAmJiBlbGVtZW50LmNsb3Nlc3QoaW5lcnREaXNhYmxlZE9ySGlkZGVuKSA9PSBudWxsICYmIHR5cGVvZiBlbGVtZW50LmZvY3VzID09IFwiZnVuY3Rpb25cIlxufVxuXG5mdW5jdGlvbiBxdWVyeUF1dG9mb2N1c2FibGVFbGVtZW50KGVsZW1lbnRPckRvY3VtZW50RnJhZ21lbnQpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudE9yRG9jdW1lbnRGcmFnbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2F1dG9mb2N1c11cIikpLmZpbmQoZWxlbWVudElzRm9jdXNhYmxlKVxufVxuXG5hc3luYyBmdW5jdGlvbiBhcm91bmQoY2FsbGJhY2ssIHJlYWRlcikge1xuICBjb25zdCBiZWZvcmUgPSByZWFkZXIoKTtcblxuICBjYWxsYmFjaygpO1xuXG4gIGF3YWl0IG5leHRBbmltYXRpb25GcmFtZSgpO1xuXG4gIGNvbnN0IGFmdGVyID0gcmVhZGVyKCk7XG5cbiAgcmV0dXJuIFtiZWZvcmUsIGFmdGVyXVxufVxuXG5mdW5jdGlvbiBkb2VzTm90VGFyZ2V0SUZyYW1lKG5hbWUpIHtcbiAgaWYgKG5hbWUgPT09IFwiX2JsYW5rXCIpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfSBlbHNlIGlmIChuYW1lKSB7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKG5hbWUpKSB7XG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KSByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9IGVsc2Uge1xuICAgIHJldHVybiB0cnVlXG4gIH1cbn1cblxuZnVuY3Rpb24gZmluZExpbmtGcm9tQ2xpY2tUYXJnZXQodGFyZ2V0KSB7XG4gIHJldHVybiBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KHRhcmdldCwgXCJhW2hyZWZdOm5vdChbdGFyZ2V0Xj1fXSk6bm90KFtkb3dubG9hZF0pXCIpXG59XG5cbmZ1bmN0aW9uIGdldExvY2F0aW9uRm9yTGluayhsaW5rKSB7XG4gIHJldHVybiBleHBhbmRVUkwobGluay5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpIHx8IFwiXCIpXG59XG5cbmZ1bmN0aW9uIGRlYm91bmNlKGZuLCBkZWxheSkge1xuICBsZXQgdGltZW91dElkID0gbnVsbDtcblxuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBjb25zdCBjYWxsYmFjayA9ICgpID0+IGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoY2FsbGJhY2ssIGRlbGF5KTtcbiAgfVxufVxuXG5jb25zdCBzdWJtaXR0ZXIgPSB7XG4gIFwiYXJpYS1kaXNhYmxlZFwiOiB7XG4gICAgYmVmb3JlU3VibWl0OiBzdWJtaXR0ZXIgPT4ge1xuICAgICAgc3VibWl0dGVyLnNldEF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xuICAgICAgc3VibWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjYW5jZWxFdmVudCk7XG4gICAgfSxcblxuICAgIGFmdGVyU3VibWl0OiBzdWJtaXR0ZXIgPT4ge1xuICAgICAgc3VibWl0dGVyLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIik7XG4gICAgICBzdWJtaXR0ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNhbmNlbEV2ZW50KTtcbiAgICB9XG4gIH0sXG5cbiAgXCJkaXNhYmxlZFwiOiB7XG4gICAgYmVmb3JlU3VibWl0OiBzdWJtaXR0ZXIgPT4gc3VibWl0dGVyLmRpc2FibGVkID0gdHJ1ZSxcbiAgICBhZnRlclN1Ym1pdDogc3VibWl0dGVyID0+IHN1Ym1pdHRlci5kaXNhYmxlZCA9IGZhbHNlXG4gIH1cbn07XG5cbmNsYXNzIENvbmZpZyB7XG4gICNzdWJtaXR0ZXIgPSBudWxsXG5cbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCBjb25maWcpO1xuICB9XG5cbiAgZ2V0IHN1Ym1pdHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy4jc3VibWl0dGVyXG4gIH1cblxuICBzZXQgc3VibWl0dGVyKHZhbHVlKSB7XG4gICAgdGhpcy4jc3VibWl0dGVyID0gc3VibWl0dGVyW3ZhbHVlXSB8fCB2YWx1ZTtcbiAgfVxufVxuXG5jb25zdCBmb3JtcyA9IG5ldyBDb25maWcoe1xuICBtb2RlOiBcIm9uXCIsXG4gIHN1Ym1pdHRlcjogXCJkaXNhYmxlZFwiXG59KTtcblxuY29uc3QgY29uZmlnID0ge1xuICBkcml2ZSxcbiAgZm9ybXNcbn07XG5cbmZ1bmN0aW9uIGV4cGFuZFVSTChsb2NhdGFibGUpIHtcbiAgcmV0dXJuIG5ldyBVUkwobG9jYXRhYmxlLnRvU3RyaW5nKCksIGRvY3VtZW50LmJhc2VVUkkpXG59XG5cbmZ1bmN0aW9uIGdldEFuY2hvcih1cmwpIHtcbiAgbGV0IGFuY2hvck1hdGNoO1xuICBpZiAodXJsLmhhc2gpIHtcbiAgICByZXR1cm4gdXJsLmhhc2guc2xpY2UoMSlcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uZC1hc3NpZ25cbiAgfSBlbHNlIGlmICgoYW5jaG9yTWF0Y2ggPSB1cmwuaHJlZi5tYXRjaCgvIyguKikkLykpKSB7XG4gICAgcmV0dXJuIGFuY2hvck1hdGNoWzFdXG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0QWN0aW9uJDEoZm9ybSwgc3VibWl0dGVyKSB7XG4gIGNvbnN0IGFjdGlvbiA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybWFjdGlvblwiKSB8fCBmb3JtLmdldEF0dHJpYnV0ZShcImFjdGlvblwiKSB8fCBmb3JtLmFjdGlvbjtcblxuICByZXR1cm4gZXhwYW5kVVJMKGFjdGlvbilcbn1cblxuZnVuY3Rpb24gZ2V0RXh0ZW5zaW9uKHVybCkge1xuICByZXR1cm4gKGdldExhc3RQYXRoQ29tcG9uZW50KHVybCkubWF0Y2goL1xcLlteLl0qJC8pIHx8IFtdKVswXSB8fCBcIlwiXG59XG5cbmZ1bmN0aW9uIGlzUHJlZml4ZWRCeShiYXNlVVJMLCB1cmwpIHtcbiAgY29uc3QgcHJlZml4ID0gZ2V0UHJlZml4KHVybCk7XG4gIHJldHVybiBiYXNlVVJMLmhyZWYgPT09IGV4cGFuZFVSTChwcmVmaXgpLmhyZWYgfHwgYmFzZVVSTC5ocmVmLnN0YXJ0c1dpdGgocHJlZml4KVxufVxuXG5mdW5jdGlvbiBsb2NhdGlvbklzVmlzaXRhYmxlKGxvY2F0aW9uLCByb290TG9jYXRpb24pIHtcbiAgcmV0dXJuIGlzUHJlZml4ZWRCeShsb2NhdGlvbiwgcm9vdExvY2F0aW9uKSAmJiAhY29uZmlnLmRyaXZlLnVudmlzaXRhYmxlRXh0ZW5zaW9ucy5oYXMoZ2V0RXh0ZW5zaW9uKGxvY2F0aW9uKSlcbn1cblxuZnVuY3Rpb24gZ2V0UmVxdWVzdFVSTCh1cmwpIHtcbiAgY29uc3QgYW5jaG9yID0gZ2V0QW5jaG9yKHVybCk7XG4gIHJldHVybiBhbmNob3IgIT0gbnVsbCA/IHVybC5ocmVmLnNsaWNlKDAsIC0oYW5jaG9yLmxlbmd0aCArIDEpKSA6IHVybC5ocmVmXG59XG5cbmZ1bmN0aW9uIHRvQ2FjaGVLZXkodXJsKSB7XG4gIHJldHVybiBnZXRSZXF1ZXN0VVJMKHVybClcbn1cblxuZnVuY3Rpb24gdXJsc0FyZUVxdWFsKGxlZnQsIHJpZ2h0KSB7XG4gIHJldHVybiBleHBhbmRVUkwobGVmdCkuaHJlZiA9PSBleHBhbmRVUkwocmlnaHQpLmhyZWZcbn1cblxuZnVuY3Rpb24gZ2V0UGF0aENvbXBvbmVudHModXJsKSB7XG4gIHJldHVybiB1cmwucGF0aG5hbWUuc3BsaXQoXCIvXCIpLnNsaWNlKDEpXG59XG5cbmZ1bmN0aW9uIGdldExhc3RQYXRoQ29tcG9uZW50KHVybCkge1xuICByZXR1cm4gZ2V0UGF0aENvbXBvbmVudHModXJsKS5zbGljZSgtMSlbMF1cbn1cblxuZnVuY3Rpb24gZ2V0UHJlZml4KHVybCkge1xuICByZXR1cm4gYWRkVHJhaWxpbmdTbGFzaCh1cmwub3JpZ2luICsgdXJsLnBhdGhuYW1lKVxufVxuXG5mdW5jdGlvbiBhZGRUcmFpbGluZ1NsYXNoKHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZS5lbmRzV2l0aChcIi9cIikgPyB2YWx1ZSA6IHZhbHVlICsgXCIvXCJcbn1cblxuY2xhc3MgRmV0Y2hSZXNwb25zZSB7XG4gIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICB9XG5cbiAgZ2V0IHN1Y2NlZWRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5yZXNwb25zZS5va1xuICB9XG5cbiAgZ2V0IGZhaWxlZCgpIHtcbiAgICByZXR1cm4gIXRoaXMuc3VjY2VlZGVkXG4gIH1cblxuICBnZXQgY2xpZW50RXJyb3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzQ29kZSA+PSA0MDAgJiYgdGhpcy5zdGF0dXNDb2RlIDw9IDQ5OVxuICB9XG5cbiAgZ2V0IHNlcnZlckVycm9yKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXR1c0NvZGUgPj0gNTAwICYmIHRoaXMuc3RhdHVzQ29kZSA8PSA1OTlcbiAgfVxuXG4gIGdldCByZWRpcmVjdGVkKCkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlLnJlZGlyZWN0ZWRcbiAgfVxuXG4gIGdldCBsb2NhdGlvbigpIHtcbiAgICByZXR1cm4gZXhwYW5kVVJMKHRoaXMucmVzcG9uc2UudXJsKVxuICB9XG5cbiAgZ2V0IGlzSFRNTCgpIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZW50VHlwZSAmJiB0aGlzLmNvbnRlbnRUeXBlLm1hdGNoKC9eKD86dGV4dFxcLyhbXlxcczssXStcXGIpP2h0bWx8YXBwbGljYXRpb25cXC94aHRtbFxcK3htbClcXGIvKVxuICB9XG5cbiAgZ2V0IHN0YXR1c0NvZGUoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzcG9uc2Uuc3RhdHVzXG4gIH1cblxuICBnZXQgY29udGVudFR5cGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZGVyKFwiQ29udGVudC1UeXBlXCIpXG4gIH1cblxuICBnZXQgcmVzcG9uc2VUZXh0KCkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlLmNsb25lKCkudGV4dCgpXG4gIH1cblxuICBnZXQgcmVzcG9uc2VIVE1MKCkge1xuICAgIGlmICh0aGlzLmlzSFRNTCkge1xuICAgICAgcmV0dXJuIHRoaXMucmVzcG9uc2UuY2xvbmUoKS50ZXh0KClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpXG4gICAgfVxuICB9XG5cbiAgaGVhZGVyKG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5yZXNwb25zZS5oZWFkZXJzLmdldChuYW1lKVxuICB9XG59XG5cbmNsYXNzIExpbWl0ZWRTZXQgZXh0ZW5kcyBTZXQge1xuICBjb25zdHJ1Y3RvcihtYXhTaXplKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm1heFNpemUgPSBtYXhTaXplO1xuICB9XG5cbiAgYWRkKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuc2l6ZSA+PSB0aGlzLm1heFNpemUpIHtcbiAgICAgIGNvbnN0IGl0ZXJhdG9yID0gdGhpcy52YWx1ZXMoKTtcbiAgICAgIGNvbnN0IG9sZGVzdFZhbHVlID0gaXRlcmF0b3IubmV4dCgpLnZhbHVlO1xuICAgICAgdGhpcy5kZWxldGUob2xkZXN0VmFsdWUpO1xuICAgIH1cbiAgICBzdXBlci5hZGQodmFsdWUpO1xuICB9XG59XG5cbmNvbnN0IHJlY2VudFJlcXVlc3RzID0gbmV3IExpbWl0ZWRTZXQoMjApO1xuXG5jb25zdCBuYXRpdmVGZXRjaCA9IHdpbmRvdy5mZXRjaDtcblxuZnVuY3Rpb24gZmV0Y2hXaXRoVHVyYm9IZWFkZXJzKHVybCwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IG1vZGlmaWVkSGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycyB8fCB7fSk7XG4gIGNvbnN0IHJlcXVlc3RVSUQgPSB1dWlkKCk7XG4gIHJlY2VudFJlcXVlc3RzLmFkZChyZXF1ZXN0VUlEKTtcbiAgbW9kaWZpZWRIZWFkZXJzLmFwcGVuZChcIlgtVHVyYm8tUmVxdWVzdC1JZFwiLCByZXF1ZXN0VUlEKTtcblxuICByZXR1cm4gbmF0aXZlRmV0Y2godXJsLCB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBoZWFkZXJzOiBtb2RpZmllZEhlYWRlcnNcbiAgfSlcbn1cblxuZnVuY3Rpb24gZmV0Y2hNZXRob2RGcm9tU3RyaW5nKG1ldGhvZCkge1xuICBzd2l0Y2ggKG1ldGhvZC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBcImdldFwiOlxuICAgICAgcmV0dXJuIEZldGNoTWV0aG9kLmdldFxuICAgIGNhc2UgXCJwb3N0XCI6XG4gICAgICByZXR1cm4gRmV0Y2hNZXRob2QucG9zdFxuICAgIGNhc2UgXCJwdXRcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5wdXRcbiAgICBjYXNlIFwicGF0Y2hcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5wYXRjaFxuICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgIHJldHVybiBGZXRjaE1ldGhvZC5kZWxldGVcbiAgfVxufVxuXG5jb25zdCBGZXRjaE1ldGhvZCA9IHtcbiAgZ2V0OiBcImdldFwiLFxuICBwb3N0OiBcInBvc3RcIixcbiAgcHV0OiBcInB1dFwiLFxuICBwYXRjaDogXCJwYXRjaFwiLFxuICBkZWxldGU6IFwiZGVsZXRlXCJcbn07XG5cbmZ1bmN0aW9uIGZldGNoRW5jdHlwZUZyb21TdHJpbmcoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChlbmNvZGluZy50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSBGZXRjaEVuY3R5cGUubXVsdGlwYXJ0OlxuICAgICAgcmV0dXJuIEZldGNoRW5jdHlwZS5tdWx0aXBhcnRcbiAgICBjYXNlIEZldGNoRW5jdHlwZS5wbGFpbjpcbiAgICAgIHJldHVybiBGZXRjaEVuY3R5cGUucGxhaW5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIEZldGNoRW5jdHlwZS51cmxFbmNvZGVkXG4gIH1cbn1cblxuY29uc3QgRmV0Y2hFbmN0eXBlID0ge1xuICB1cmxFbmNvZGVkOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICBtdWx0aXBhcnQ6IFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiLFxuICBwbGFpbjogXCJ0ZXh0L3BsYWluXCJcbn07XG5cbmNsYXNzIEZldGNoUmVxdWVzdCB7XG4gIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxuICAjcmVzb2x2ZVJlcXVlc3RQcm9taXNlID0gKF92YWx1ZSkgPT4ge31cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgbWV0aG9kLCBsb2NhdGlvbiwgcmVxdWVzdEJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCksIHRhcmdldCA9IG51bGwsIGVuY3R5cGUgPSBGZXRjaEVuY3R5cGUudXJsRW5jb2RlZCkge1xuICAgIGNvbnN0IFt1cmwsIGJvZHldID0gYnVpbGRSZXNvdXJjZUFuZEJvZHkoZXhwYW5kVVJMKGxvY2F0aW9uKSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgZW5jdHlwZSk7XG5cbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMgPSB7XG4gICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgcmVkaXJlY3Q6IFwiZm9sbG93XCIsXG4gICAgICBtZXRob2Q6IG1ldGhvZC50b1VwcGVyQ2FzZSgpLFxuICAgICAgaGVhZGVyczogeyAuLi50aGlzLmRlZmF1bHRIZWFkZXJzIH0sXG4gICAgICBib2R5OiBib2R5LFxuICAgICAgc2lnbmFsOiB0aGlzLmFib3J0U2lnbmFsLFxuICAgICAgcmVmZXJyZXI6IHRoaXMuZGVsZWdhdGUucmVmZXJyZXI/LmhyZWZcbiAgICB9O1xuICAgIHRoaXMuZW5jdHlwZSA9IGVuY3R5cGU7XG4gIH1cblxuICBnZXQgbWV0aG9kKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoT3B0aW9ucy5tZXRob2RcbiAgfVxuXG4gIHNldCBtZXRob2QodmFsdWUpIHtcbiAgICBjb25zdCBmZXRjaEJvZHkgPSB0aGlzLmlzU2FmZSA/IHRoaXMudXJsLnNlYXJjaFBhcmFtcyA6IHRoaXMuZmV0Y2hPcHRpb25zLmJvZHkgfHwgbmV3IEZvcm1EYXRhKCk7XG4gICAgY29uc3QgZmV0Y2hNZXRob2QgPSBmZXRjaE1ldGhvZEZyb21TdHJpbmcodmFsdWUpIHx8IEZldGNoTWV0aG9kLmdldDtcblxuICAgIHRoaXMudXJsLnNlYXJjaCA9IFwiXCI7XG5cbiAgICBjb25zdCBbdXJsLCBib2R5XSA9IGJ1aWxkUmVzb3VyY2VBbmRCb2R5KHRoaXMudXJsLCBmZXRjaE1ldGhvZCwgZmV0Y2hCb2R5LCB0aGlzLmVuY3R5cGUpO1xuXG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMuYm9keSA9IGJvZHk7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMubWV0aG9kID0gZmV0Y2hNZXRob2QudG9VcHBlckNhc2UoKTtcbiAgfVxuXG4gIGdldCBoZWFkZXJzKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoT3B0aW9ucy5oZWFkZXJzXG4gIH1cblxuICBzZXQgaGVhZGVycyh2YWx1ZSkge1xuICAgIHRoaXMuZmV0Y2hPcHRpb25zLmhlYWRlcnMgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBib2R5KCkge1xuICAgIGlmICh0aGlzLmlzU2FmZSkge1xuICAgICAgcmV0dXJuIHRoaXMudXJsLnNlYXJjaFBhcmFtc1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5mZXRjaE9wdGlvbnMuYm9keVxuICAgIH1cbiAgfVxuXG4gIHNldCBib2R5KHZhbHVlKSB7XG4gICAgdGhpcy5mZXRjaE9wdGlvbnMuYm9keSA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnVybFxuICB9XG5cbiAgZ2V0IHBhcmFtcygpIHtcbiAgICByZXR1cm4gdGhpcy51cmwuc2VhcmNoUGFyYW1zXG4gIH1cblxuICBnZXQgZW50cmllcygpIHtcbiAgICByZXR1cm4gdGhpcy5ib2R5ID8gQXJyYXkuZnJvbSh0aGlzLmJvZHkuZW50cmllcygpKSA6IFtdXG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgfVxuXG4gIGFzeW5jIHBlcmZvcm0oKSB7XG4gICAgY29uc3QgeyBmZXRjaE9wdGlvbnMgfSA9IHRoaXM7XG4gICAgdGhpcy5kZWxlZ2F0ZS5wcmVwYXJlUmVxdWVzdCh0aGlzKTtcbiAgICBjb25zdCBldmVudCA9IGF3YWl0IHRoaXMuI2FsbG93UmVxdWVzdFRvQmVJbnRlcmNlcHRlZChmZXRjaE9wdGlvbnMpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnJlcXVlc3RTdGFydGVkKHRoaXMpO1xuXG4gICAgICBpZiAoZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdCkge1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gZXZlbnQuZGV0YWlsLmZldGNoUmVxdWVzdC5yZXNwb25zZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSBmZXRjaFdpdGhUdXJib0hlYWRlcnModGhpcy51cmwuaHJlZiwgZmV0Y2hPcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlc3BvbnNlO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucmVjZWl2ZShyZXNwb25zZSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLm5hbWUgIT09IFwiQWJvcnRFcnJvclwiKSB7XG4gICAgICAgIGlmICh0aGlzLiN3aWxsRGVsZWdhdGVFcnJvckhhbmRsaW5nKGVycm9yKSkge1xuICAgICAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdEVycm9yZWQodGhpcywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdEZpbmlzaGVkKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlY2VpdmUocmVzcG9uc2UpIHtcbiAgICBjb25zdCBmZXRjaFJlc3BvbnNlID0gbmV3IEZldGNoUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtZmV0Y2gtcmVzcG9uc2VcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyBmZXRjaFJlc3BvbnNlIH0sXG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0XG4gICAgfSk7XG4gICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUucmVxdWVzdFByZXZlbnRlZEhhbmRsaW5nUmVzcG9uc2UodGhpcywgZmV0Y2hSZXNwb25zZSk7XG4gICAgfSBlbHNlIGlmIChmZXRjaFJlc3BvbnNlLnN1Y2NlZWRlZCkge1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5yZXF1ZXN0U3VjY2VlZGVkV2l0aFJlc3BvbnNlKHRoaXMsIGZldGNoUmVzcG9uc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UodGhpcywgZmV0Y2hSZXNwb25zZSk7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaFJlc3BvbnNlXG4gIH1cblxuICBnZXQgZGVmYXVsdEhlYWRlcnMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIEFjY2VwdDogXCJ0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3hodG1sK3htbFwiXG4gICAgfVxuICB9XG5cbiAgZ2V0IGlzU2FmZSgpIHtcbiAgICByZXR1cm4gaXNTYWZlKHRoaXMubWV0aG9kKVxuICB9XG5cbiAgZ2V0IGFib3J0U2lnbmFsKCkge1xuICAgIHJldHVybiB0aGlzLmFib3J0Q29udHJvbGxlci5zaWduYWxcbiAgfVxuXG4gIGFjY2VwdFJlc3BvbnNlVHlwZShtaW1lVHlwZSkge1xuICAgIHRoaXMuaGVhZGVyc1tcIkFjY2VwdFwiXSA9IFttaW1lVHlwZSwgdGhpcy5oZWFkZXJzW1wiQWNjZXB0XCJdXS5qb2luKFwiLCBcIik7XG4gIH1cblxuICBhc3luYyAjYWxsb3dSZXF1ZXN0VG9CZUludGVyY2VwdGVkKGZldGNoT3B0aW9ucykge1xuICAgIGNvbnN0IHJlcXVlc3RJbnRlcmNlcHRpb24gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gKHRoaXMuI3Jlc29sdmVSZXF1ZXN0UHJvbWlzZSA9IHJlc29sdmUpKTtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZldGNoLXJlcXVlc3RcIiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDoge1xuICAgICAgICBmZXRjaE9wdGlvbnMsXG4gICAgICAgIHVybDogdGhpcy51cmwsXG4gICAgICAgIHJlc3VtZTogdGhpcy4jcmVzb2x2ZVJlcXVlc3RQcm9taXNlXG4gICAgICB9LFxuICAgICAgdGFyZ2V0OiB0aGlzLnRhcmdldFxuICAgIH0pO1xuICAgIHRoaXMudXJsID0gZXZlbnQuZGV0YWlsLnVybDtcbiAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgYXdhaXQgcmVxdWVzdEludGVyY2VwdGlvbjtcblxuICAgIHJldHVybiBldmVudFxuICB9XG5cbiAgI3dpbGxEZWxlZ2F0ZUVycm9ySGFuZGxpbmcoZXJyb3IpIHtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86ZmV0Y2gtcmVxdWVzdC1lcnJvclwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMudGFyZ2V0LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyByZXF1ZXN0OiB0aGlzLCBlcnJvcjogZXJyb3IgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cbn1cblxuZnVuY3Rpb24gaXNTYWZlKGZldGNoTWV0aG9kKSB7XG4gIHJldHVybiBmZXRjaE1ldGhvZEZyb21TdHJpbmcoZmV0Y2hNZXRob2QpID09IEZldGNoTWV0aG9kLmdldFxufVxuXG5mdW5jdGlvbiBidWlsZFJlc291cmNlQW5kQm9keShyZXNvdXJjZSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgZW5jdHlwZSkge1xuICBjb25zdCBzZWFyY2hQYXJhbXMgPVxuICAgIEFycmF5LmZyb20ocmVxdWVzdEJvZHkpLmxlbmd0aCA+IDAgPyBuZXcgVVJMU2VhcmNoUGFyYW1zKGVudHJpZXNFeGNsdWRpbmdGaWxlcyhyZXF1ZXN0Qm9keSkpIDogcmVzb3VyY2Uuc2VhcmNoUGFyYW1zO1xuXG4gIGlmIChpc1NhZmUobWV0aG9kKSkge1xuICAgIHJldHVybiBbbWVyZ2VJbnRvVVJMU2VhcmNoUGFyYW1zKHJlc291cmNlLCBzZWFyY2hQYXJhbXMpLCBudWxsXVxuICB9IGVsc2UgaWYgKGVuY3R5cGUgPT0gRmV0Y2hFbmN0eXBlLnVybEVuY29kZWQpIHtcbiAgICByZXR1cm4gW3Jlc291cmNlLCBzZWFyY2hQYXJhbXNdXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFtyZXNvdXJjZSwgcmVxdWVzdEJvZHldXG4gIH1cbn1cblxuZnVuY3Rpb24gZW50cmllc0V4Y2x1ZGluZ0ZpbGVzKHJlcXVlc3RCb2R5KSB7XG4gIGNvbnN0IGVudHJpZXMgPSBbXTtcblxuICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgcmVxdWVzdEJvZHkpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBGaWxlKSBjb250aW51ZVxuICAgIGVsc2UgZW50cmllcy5wdXNoKFtuYW1lLCB2YWx1ZV0pO1xuICB9XG5cbiAgcmV0dXJuIGVudHJpZXNcbn1cblxuZnVuY3Rpb24gbWVyZ2VJbnRvVVJMU2VhcmNoUGFyYW1zKHVybCwgcmVxdWVzdEJvZHkpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhlbnRyaWVzRXhjbHVkaW5nRmlsZXMocmVxdWVzdEJvZHkpKTtcblxuICB1cmwuc2VhcmNoID0gc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCk7XG5cbiAgcmV0dXJuIHVybFxufVxuXG5jbGFzcyBBcHBlYXJhbmNlT2JzZXJ2ZXIge1xuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIodGhpcy5pbnRlcnNlY3QpO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlci51bm9ic2VydmUodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBpbnRlcnNlY3QgPSAoZW50cmllcykgPT4ge1xuICAgIGNvbnN0IGxhc3RFbnRyeSA9IGVudHJpZXMuc2xpY2UoLTEpWzBdO1xuICAgIGlmIChsYXN0RW50cnk/LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLmVsZW1lbnRBcHBlYXJlZEluVmlld3BvcnQodGhpcy5lbGVtZW50KTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgU3RyZWFtTWVzc2FnZSB7XG4gIHN0YXRpYyBjb250ZW50VHlwZSA9IFwidGV4dC92bmQudHVyYm8tc3RyZWFtLmh0bWxcIlxuXG4gIHN0YXRpYyB3cmFwKG1lc3NhZ2UpIHtcbiAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIG5ldyB0aGlzKGNyZWF0ZURvY3VtZW50RnJhZ21lbnQobWVzc2FnZSkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtZXNzYWdlXG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoZnJhZ21lbnQpIHtcbiAgICB0aGlzLmZyYWdtZW50ID0gaW1wb3J0U3RyZWFtRWxlbWVudHMoZnJhZ21lbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGltcG9ydFN0cmVhbUVsZW1lbnRzKGZyYWdtZW50KSB7XG4gIGZvciAoY29uc3QgZWxlbWVudCBvZiBmcmFnbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwidHVyYm8tc3RyZWFtXCIpKSB7XG4gICAgY29uc3Qgc3RyZWFtRWxlbWVudCA9IGRvY3VtZW50LmltcG9ydE5vZGUoZWxlbWVudCwgdHJ1ZSk7XG5cbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiBzdHJlYW1FbGVtZW50LnRlbXBsYXRlRWxlbWVudC5jb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIikpIHtcbiAgICAgIGluZXJ0U2NyaXB0RWxlbWVudC5yZXBsYWNlV2l0aChhY3RpdmF0ZVNjcmlwdEVsZW1lbnQoaW5lcnRTY3JpcHRFbGVtZW50KSk7XG4gICAgfVxuXG4gICAgZWxlbWVudC5yZXBsYWNlV2l0aChzdHJlYW1FbGVtZW50KTtcbiAgfVxuXG4gIHJldHVybiBmcmFnbWVudFxufVxuXG5jb25zdCBQUkVGRVRDSF9ERUxBWSA9IDEwMDtcblxuY2xhc3MgUHJlZmV0Y2hDYWNoZSB7XG4gICNwcmVmZXRjaFRpbWVvdXQgPSBudWxsXG4gICNwcmVmZXRjaGVkID0gbnVsbFxuXG4gIGdldCh1cmwpIHtcbiAgICBpZiAodGhpcy4jcHJlZmV0Y2hlZCAmJiB0aGlzLiNwcmVmZXRjaGVkLnVybCA9PT0gdXJsICYmIHRoaXMuI3ByZWZldGNoZWQuZXhwaXJlID4gRGF0ZS5ub3coKSkge1xuICAgICAgcmV0dXJuIHRoaXMuI3ByZWZldGNoZWQucmVxdWVzdFxuICAgIH1cbiAgfVxuXG4gIHNldExhdGVyKHVybCwgcmVxdWVzdCwgdHRsKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuXG4gICAgdGhpcy4jcHJlZmV0Y2hUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXF1ZXN0LnBlcmZvcm0oKTtcbiAgICAgIHRoaXMuc2V0KHVybCwgcmVxdWVzdCwgdHRsKTtcbiAgICAgIHRoaXMuI3ByZWZldGNoVGltZW91dCA9IG51bGw7XG4gICAgfSwgUFJFRkVUQ0hfREVMQVkpO1xuICB9XG5cbiAgc2V0KHVybCwgcmVxdWVzdCwgdHRsKSB7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZCA9IHsgdXJsLCByZXF1ZXN0LCBleHBpcmU6IG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgdHRsKSB9O1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgaWYgKHRoaXMuI3ByZWZldGNoVGltZW91dCkgY2xlYXJUaW1lb3V0KHRoaXMuI3ByZWZldGNoVGltZW91dCk7XG4gICAgdGhpcy4jcHJlZmV0Y2hlZCA9IG51bGw7XG4gIH1cbn1cblxuY29uc3QgY2FjaGVUdGwgPSAxMCAqIDEwMDA7XG5jb25zdCBwcmVmZXRjaENhY2hlID0gbmV3IFByZWZldGNoQ2FjaGUoKTtcblxuY29uc3QgRm9ybVN1Ym1pc3Npb25TdGF0ZSA9IHtcbiAgaW5pdGlhbGl6ZWQ6IFwiaW5pdGlhbGl6ZWRcIixcbiAgcmVxdWVzdGluZzogXCJyZXF1ZXN0aW5nXCIsXG4gIHdhaXRpbmc6IFwid2FpdGluZ1wiLFxuICByZWNlaXZpbmc6IFwicmVjZWl2aW5nXCIsXG4gIHN0b3BwaW5nOiBcInN0b3BwaW5nXCIsXG4gIHN0b3BwZWQ6IFwic3RvcHBlZFwiXG59O1xuXG5jbGFzcyBGb3JtU3VibWlzc2lvbiB7XG4gIHN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5pbml0aWFsaXplZFxuXG4gIHN0YXRpYyBjb25maXJtTWV0aG9kKG1lc3NhZ2UpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbmZpcm0obWVzc2FnZSkpXG4gIH1cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZm9ybUVsZW1lbnQsIHN1Ym1pdHRlciwgbXVzdFJlZGlyZWN0ID0gZmFsc2UpIHtcbiAgICBjb25zdCBtZXRob2QgPSBnZXRNZXRob2QoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgY29uc3QgYWN0aW9uID0gZ2V0QWN0aW9uKGdldEZvcm1BY3Rpb24oZm9ybUVsZW1lbnQsIHN1Ym1pdHRlciksIG1ldGhvZCk7XG4gICAgY29uc3QgYm9keSA9IGJ1aWxkRm9ybURhdGEoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgY29uc3QgZW5jdHlwZSA9IGdldEVuY3R5cGUoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcik7XG5cbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuc3VibWl0dGVyID0gc3VibWl0dGVyO1xuICAgIHRoaXMuZmV0Y2hSZXF1ZXN0ID0gbmV3IEZldGNoUmVxdWVzdCh0aGlzLCBtZXRob2QsIGFjdGlvbiwgYm9keSwgZm9ybUVsZW1lbnQsIGVuY3R5cGUpO1xuICAgIHRoaXMubXVzdFJlZGlyZWN0ID0gbXVzdFJlZGlyZWN0O1xuICB9XG5cbiAgZ2V0IG1ldGhvZCgpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QubWV0aG9kXG4gIH1cblxuICBzZXQgbWV0aG9kKHZhbHVlKSB7XG4gICAgdGhpcy5mZXRjaFJlcXVlc3QubWV0aG9kID0gdmFsdWU7XG4gIH1cblxuICBnZXQgYWN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdC51cmwudG9TdHJpbmcoKVxuICB9XG5cbiAgc2V0IGFjdGlvbih2YWx1ZSkge1xuICAgIHRoaXMuZmV0Y2hSZXF1ZXN0LnVybCA9IGV4cGFuZFVSTCh2YWx1ZSk7XG4gIH1cblxuICBnZXQgYm9keSgpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFJlcXVlc3QuYm9keVxuICB9XG5cbiAgZ2V0IGVuY3R5cGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LmVuY3R5cGVcbiAgfVxuXG4gIGdldCBpc1NhZmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LmlzU2FmZVxuICB9XG5cbiAgZ2V0IGxvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmZldGNoUmVxdWVzdC51cmxcbiAgfVxuXG4gIC8vIFRoZSBzdWJtaXNzaW9uIHByb2Nlc3NcblxuICBhc3luYyBzdGFydCgpIHtcbiAgICBjb25zdCB7IGluaXRpYWxpemVkLCByZXF1ZXN0aW5nIH0gPSBGb3JtU3VibWlzc2lvblN0YXRlO1xuICAgIGNvbnN0IGNvbmZpcm1hdGlvbk1lc3NhZ2UgPSBnZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIiwgdGhpcy5zdWJtaXR0ZXIsIHRoaXMuZm9ybUVsZW1lbnQpO1xuXG4gICAgaWYgKHR5cGVvZiBjb25maXJtYXRpb25NZXNzYWdlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBjb25maXJtTWV0aG9kID0gdHlwZW9mIGNvbmZpZy5mb3Jtcy5jb25maXJtID09PSBcImZ1bmN0aW9uXCIgP1xuICAgICAgICBjb25maWcuZm9ybXMuY29uZmlybSA6XG4gICAgICAgIEZvcm1TdWJtaXNzaW9uLmNvbmZpcm1NZXRob2Q7XG5cbiAgICAgIGNvbnN0IGFuc3dlciA9IGF3YWl0IGNvbmZpcm1NZXRob2QoY29uZmlybWF0aW9uTWVzc2FnZSwgdGhpcy5mb3JtRWxlbWVudCwgdGhpcy5zdWJtaXR0ZXIpO1xuICAgICAgaWYgKCFhbnN3ZXIpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gaW5pdGlhbGl6ZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSByZXF1ZXN0aW5nO1xuICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hSZXF1ZXN0LnBlcmZvcm0oKVxuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgY29uc3QgeyBzdG9wcGluZywgc3RvcHBlZCB9ID0gRm9ybVN1Ym1pc3Npb25TdGF0ZTtcbiAgICBpZiAodGhpcy5zdGF0ZSAhPSBzdG9wcGluZyAmJiB0aGlzLnN0YXRlICE9IHN0b3BwZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBzdG9wcGluZztcbiAgICAgIHRoaXMuZmV0Y2hSZXF1ZXN0LmNhbmNlbCgpO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cblxuICAvLyBGZXRjaCByZXF1ZXN0IGRlbGVnYXRlXG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIGlmICghcmVxdWVzdC5pc1NhZmUpIHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2V0Q29va2llVmFsdWUoZ2V0TWV0YUNvbnRlbnQoXCJjc3JmLXBhcmFtXCIpKSB8fCBnZXRNZXRhQ29udGVudChcImNzcmYtdG9rZW5cIik7XG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgcmVxdWVzdC5oZWFkZXJzW1wiWC1DU1JGLVRva2VuXCJdID0gdG9rZW47XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucmVxdWVzdEFjY2VwdHNUdXJib1N0cmVhbVJlc3BvbnNlKHJlcXVlc3QpKSB7XG4gICAgICByZXF1ZXN0LmFjY2VwdFJlc3BvbnNlVHlwZShTdHJlYW1NZXNzYWdlLmNvbnRlbnRUeXBlKTtcbiAgICB9XG4gIH1cblxuICByZXF1ZXN0U3RhcnRlZChfcmVxdWVzdCkge1xuICAgIHRoaXMuc3RhdGUgPSBGb3JtU3VibWlzc2lvblN0YXRlLndhaXRpbmc7XG4gICAgaWYgKHRoaXMuc3VibWl0dGVyKSBjb25maWcuZm9ybXMuc3VibWl0dGVyLmJlZm9yZVN1Ym1pdCh0aGlzLnN1Ym1pdHRlcik7XG4gICAgdGhpcy5zZXRTdWJtaXRzV2l0aCgpO1xuICAgIG1hcmtBc0J1c3kodGhpcy5mb3JtRWxlbWVudCk7XG4gICAgZGlzcGF0Y2goXCJ0dXJibzpzdWJtaXQtc3RhcnRcIiwge1xuICAgICAgdGFyZ2V0OiB0aGlzLmZvcm1FbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGZvcm1TdWJtaXNzaW9uOiB0aGlzIH1cbiAgICB9KTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uU3RhcnRlZCh0aGlzKTtcbiAgfVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuXG4gICAgdGhpcy5yZXN1bHQgPSB7IHN1Y2Nlc3M6IHJlc3BvbnNlLnN1Y2NlZWRlZCwgZmV0Y2hSZXNwb25zZTogcmVzcG9uc2UgfTtcbiAgfVxuXG4gIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBpZiAocmVzcG9uc2UuY2xpZW50RXJyb3IgfHwgcmVzcG9uc2Uuc2VydmVyRXJyb3IpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UodGhpcywgcmVzcG9uc2UpO1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgcHJlZmV0Y2hDYWNoZS5jbGVhcigpO1xuXG4gICAgaWYgKHRoaXMucmVxdWVzdE11c3RSZWRpcmVjdChyZXF1ZXN0KSAmJiByZXNwb25zZVN1Y2NlZWRlZFdpdGhvdXRSZWRpcmVjdChyZXNwb25zZSkpIHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiRm9ybSByZXNwb25zZXMgbXVzdCByZWRpcmVjdCB0byBhbm90aGVyIGxvY2F0aW9uXCIpO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkVycm9yZWQodGhpcywgZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5yZWNlaXZpbmc7XG4gICAgICB0aGlzLnJlc3VsdCA9IHsgc3VjY2VzczogdHJ1ZSwgZmV0Y2hSZXNwb25zZTogcmVzcG9uc2UgfTtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UodGhpcywgcmVzcG9uc2UpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICB0aGlzLnJlc3VsdCA9IHsgc3VjY2VzczogZmFsc2UsIGZldGNoUmVzcG9uc2U6IHJlc3BvbnNlIH07XG4gICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkZhaWxlZFdpdGhSZXNwb25zZSh0aGlzLCByZXNwb25zZSk7XG4gIH1cblxuICByZXF1ZXN0RXJyb3JlZChyZXF1ZXN0LCBlcnJvcikge1xuICAgIHRoaXMucmVzdWx0ID0geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3IgfTtcbiAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXNzaW9uRXJyb3JlZCh0aGlzLCBlcnJvcik7XG4gIH1cblxuICByZXF1ZXN0RmluaXNoZWQoX3JlcXVlc3QpIHtcbiAgICB0aGlzLnN0YXRlID0gRm9ybVN1Ym1pc3Npb25TdGF0ZS5zdG9wcGVkO1xuICAgIGlmICh0aGlzLnN1Ym1pdHRlcikgY29uZmlnLmZvcm1zLnN1Ym1pdHRlci5hZnRlclN1Ym1pdCh0aGlzLnN1Ym1pdHRlcik7XG4gICAgdGhpcy5yZXNldFN1Ym1pdHRlclRleHQoKTtcbiAgICBjbGVhckJ1c3lTdGF0ZSh0aGlzLmZvcm1FbGVtZW50KTtcbiAgICBkaXNwYXRjaChcInR1cmJvOnN1Ym1pdC1lbmRcIiwge1xuICAgICAgdGFyZ2V0OiB0aGlzLmZvcm1FbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGZvcm1TdWJtaXNzaW9uOiB0aGlzLCAuLi50aGlzLnJlc3VsdCB9XG4gICAgfSk7XG4gICAgdGhpcy5kZWxlZ2F0ZS5mb3JtU3VibWlzc2lvbkZpbmlzaGVkKHRoaXMpO1xuICB9XG5cbiAgLy8gUHJpdmF0ZVxuXG4gIHNldFN1Ym1pdHNXaXRoKCkge1xuICAgIGlmICghdGhpcy5zdWJtaXR0ZXIgfHwgIXRoaXMuc3VibWl0c1dpdGgpIHJldHVyblxuXG4gICAgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJidXR0b25cIikpIHtcbiAgICAgIHRoaXMub3JpZ2luYWxTdWJtaXRUZXh0ID0gdGhpcy5zdWJtaXR0ZXIuaW5uZXJIVE1MO1xuICAgICAgdGhpcy5zdWJtaXR0ZXIuaW5uZXJIVE1MID0gdGhpcy5zdWJtaXRzV2l0aDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJpbnB1dFwiKSkge1xuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLnN1Ym1pdHRlcjtcbiAgICAgIHRoaXMub3JpZ2luYWxTdWJtaXRUZXh0ID0gaW5wdXQudmFsdWU7XG4gICAgICBpbnB1dC52YWx1ZSA9IHRoaXMuc3VibWl0c1dpdGg7XG4gICAgfVxuICB9XG5cbiAgcmVzZXRTdWJtaXR0ZXJUZXh0KCkge1xuICAgIGlmICghdGhpcy5zdWJtaXR0ZXIgfHwgIXRoaXMub3JpZ2luYWxTdWJtaXRUZXh0KSByZXR1cm5cblxuICAgIGlmICh0aGlzLnN1Ym1pdHRlci5tYXRjaGVzKFwiYnV0dG9uXCIpKSB7XG4gICAgICB0aGlzLnN1Ym1pdHRlci5pbm5lckhUTUwgPSB0aGlzLm9yaWdpbmFsU3VibWl0VGV4dDtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3VibWl0dGVyLm1hdGNoZXMoXCJpbnB1dFwiKSkge1xuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLnN1Ym1pdHRlcjtcbiAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5vcmlnaW5hbFN1Ym1pdFRleHQ7XG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdE11c3RSZWRpcmVjdChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuICFyZXF1ZXN0LmlzU2FmZSAmJiB0aGlzLm11c3RSZWRpcmVjdFxuICB9XG5cbiAgcmVxdWVzdEFjY2VwdHNUdXJib1N0cmVhbVJlc3BvbnNlKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gIXJlcXVlc3QuaXNTYWZlIHx8IGhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tc3RyZWFtXCIsIHRoaXMuc3VibWl0dGVyLCB0aGlzLmZvcm1FbGVtZW50KVxuICB9XG5cbiAgZ2V0IHN1Ym1pdHNXaXRoKCkge1xuICAgIHJldHVybiB0aGlzLnN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1zdWJtaXRzLXdpdGhcIilcbiAgfVxufVxuXG5mdW5jdGlvbiBidWlsZEZvcm1EYXRhKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybUVsZW1lbnQpO1xuICBjb25zdCBuYW1lID0gc3VibWl0dGVyPy5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICBjb25zdCB2YWx1ZSA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XG5cbiAgaWYgKG5hbWUpIHtcbiAgICBmb3JtRGF0YS5hcHBlbmQobmFtZSwgdmFsdWUgfHwgXCJcIik7XG4gIH1cblxuICByZXR1cm4gZm9ybURhdGFcbn1cblxuZnVuY3Rpb24gZ2V0Q29va2llVmFsdWUoY29va2llTmFtZSkge1xuICBpZiAoY29va2llTmFtZSAhPSBudWxsKSB7XG4gICAgY29uc3QgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZSA/IGRvY3VtZW50LmNvb2tpZS5zcGxpdChcIjsgXCIpIDogW107XG4gICAgY29uc3QgY29va2llID0gY29va2llcy5maW5kKChjb29raWUpID0+IGNvb2tpZS5zdGFydHNXaXRoKGNvb2tpZU5hbWUpKTtcbiAgICBpZiAoY29va2llKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGNvb2tpZS5zcGxpdChcIj1cIikuc2xpY2UoMSkuam9pbihcIj1cIik7XG4gICAgICByZXR1cm4gdmFsdWUgPyBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpIDogdW5kZWZpbmVkXG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlc3BvbnNlU3VjY2VlZGVkV2l0aG91dFJlZGlyZWN0KHJlc3BvbnNlKSB7XG4gIHJldHVybiByZXNwb25zZS5zdGF0dXNDb2RlID09IDIwMCAmJiAhcmVzcG9uc2UucmVkaXJlY3RlZFxufVxuXG5mdW5jdGlvbiBnZXRGb3JtQWN0aW9uKGZvcm1FbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgY29uc3QgZm9ybUVsZW1lbnRBY3Rpb24gPSB0eXBlb2YgZm9ybUVsZW1lbnQuYWN0aW9uID09PSBcInN0cmluZ1wiID8gZm9ybUVsZW1lbnQuYWN0aW9uIDogbnVsbDtcblxuICBpZiAoc3VibWl0dGVyPy5oYXNBdHRyaWJ1dGUoXCJmb3JtYWN0aW9uXCIpKSB7XG4gICAgcmV0dXJuIHN1Ym1pdHRlci5nZXRBdHRyaWJ1dGUoXCJmb3JtYWN0aW9uXCIpIHx8IFwiXCJcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpIHx8IGZvcm1FbGVtZW50QWN0aW9uIHx8IFwiXCJcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRBY3Rpb24oZm9ybUFjdGlvbiwgZmV0Y2hNZXRob2QpIHtcbiAgY29uc3QgYWN0aW9uID0gZXhwYW5kVVJMKGZvcm1BY3Rpb24pO1xuXG4gIGlmIChpc1NhZmUoZmV0Y2hNZXRob2QpKSB7XG4gICAgYWN0aW9uLnNlYXJjaCA9IFwiXCI7XG4gIH1cblxuICByZXR1cm4gYWN0aW9uXG59XG5cbmZ1bmN0aW9uIGdldE1ldGhvZChmb3JtRWxlbWVudCwgc3VibWl0dGVyKSB7XG4gIGNvbnN0IG1ldGhvZCA9IHN1Ym1pdHRlcj8uZ2V0QXR0cmlidXRlKFwiZm9ybW1ldGhvZFwiKSB8fCBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIikgfHwgXCJcIjtcbiAgcmV0dXJuIGZldGNoTWV0aG9kRnJvbVN0cmluZyhtZXRob2QudG9Mb3dlckNhc2UoKSkgfHwgRmV0Y2hNZXRob2QuZ2V0XG59XG5cbmZ1bmN0aW9uIGdldEVuY3R5cGUoZm9ybUVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICByZXR1cm4gZmV0Y2hFbmN0eXBlRnJvbVN0cmluZyhzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImZvcm1lbmN0eXBlXCIpIHx8IGZvcm1FbGVtZW50LmVuY3R5cGUpXG59XG5cbmNsYXNzIFNuYXBzaG90IHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gIH1cblxuICBnZXQgYWN0aXZlRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuYWN0aXZlRWxlbWVudFxuICB9XG5cbiAgZ2V0IGNoaWxkcmVuKCkge1xuICAgIHJldHVybiBbLi4udGhpcy5lbGVtZW50LmNoaWxkcmVuXVxuICB9XG5cbiAgaGFzQW5jaG9yKGFuY2hvcikge1xuICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRGb3JBbmNob3IoYW5jaG9yKSAhPSBudWxsXG4gIH1cblxuICBnZXRFbGVtZW50Rm9yQW5jaG9yKGFuY2hvcikge1xuICAgIHJldHVybiBhbmNob3IgPyB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihgW2lkPScke2FuY2hvcn0nXSwgYVtuYW1lPScke2FuY2hvcn0nXWApIDogbnVsbFxuICB9XG5cbiAgZ2V0IGlzQ29ubmVjdGVkKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuaXNDb25uZWN0ZWRcbiAgfVxuXG4gIGdldCBmaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50KCkge1xuICAgIHJldHVybiBxdWVyeUF1dG9mb2N1c2FibGVFbGVtZW50KHRoaXMuZWxlbWVudClcbiAgfVxuXG4gIGdldCBwZXJtYW5lbnRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gcXVlcnlQZXJtYW5lbnRFbGVtZW50c0FsbCh0aGlzLmVsZW1lbnQpXG4gIH1cblxuICBnZXRQZXJtYW5lbnRFbGVtZW50QnlJZChpZCkge1xuICAgIHJldHVybiBnZXRQZXJtYW5lbnRFbGVtZW50QnlJZCh0aGlzLmVsZW1lbnQsIGlkKVxuICB9XG5cbiAgZ2V0UGVybWFuZW50RWxlbWVudE1hcEZvclNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgY29uc3QgcGVybWFuZW50RWxlbWVudE1hcCA9IHt9O1xuXG4gICAgZm9yIChjb25zdCBjdXJyZW50UGVybWFuZW50RWxlbWVudCBvZiB0aGlzLnBlcm1hbmVudEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSBjdXJyZW50UGVybWFuZW50RWxlbWVudDtcbiAgICAgIGNvbnN0IG5ld1Blcm1hbmVudEVsZW1lbnQgPSBzbmFwc2hvdC5nZXRQZXJtYW5lbnRFbGVtZW50QnlJZChpZCk7XG4gICAgICBpZiAobmV3UGVybWFuZW50RWxlbWVudCkge1xuICAgICAgICBwZXJtYW5lbnRFbGVtZW50TWFwW2lkXSA9IFtjdXJyZW50UGVybWFuZW50RWxlbWVudCwgbmV3UGVybWFuZW50RWxlbWVudF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHBlcm1hbmVudEVsZW1lbnRNYXBcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRQZXJtYW5lbnRFbGVtZW50QnlJZChub2RlLCBpZCkge1xuICByZXR1cm4gbm9kZS5xdWVyeVNlbGVjdG9yKGAjJHtpZH1bZGF0YS10dXJiby1wZXJtYW5lbnRdYClcbn1cblxuZnVuY3Rpb24gcXVlcnlQZXJtYW5lbnRFbGVtZW50c0FsbChub2RlKSB7XG4gIHJldHVybiBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbaWRdW2RhdGEtdHVyYm8tcGVybWFuZW50XVwiKVxufVxuXG5jbGFzcyBGb3JtU3VibWl0T2JzZXJ2ZXIge1xuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZXZlbnRUYXJnZXQpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5ldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0O1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLnN1Ym1pdENhcHR1cmVkLCB0cnVlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRDYXB0dXJlZCwgdHJ1ZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBzdWJtaXRDYXB0dXJlZCA9ICgpID0+IHtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRCdWJibGVkLCBmYWxzZSk7XG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuc3VibWl0QnViYmxlZCwgZmFsc2UpO1xuICB9XG5cbiAgc3VibWl0QnViYmxlZCA9IChldmVudCkgPT4ge1xuICAgIGlmICghZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgY29uc3QgZm9ybSA9IGV2ZW50LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCA/IGV2ZW50LnRhcmdldCA6IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IHN1Ym1pdHRlciA9IGV2ZW50LnN1Ym1pdHRlciB8fCB1bmRlZmluZWQ7XG5cbiAgICAgIGlmIChcbiAgICAgICAgZm9ybSAmJlxuICAgICAgICBzdWJtaXNzaW9uRG9lc05vdERpc21pc3NEaWFsb2coZm9ybSwgc3VibWl0dGVyKSAmJlxuICAgICAgICBzdWJtaXNzaW9uRG9lc05vdFRhcmdldElGcmFtZShmb3JtLCBzdWJtaXR0ZXIpICYmXG4gICAgICAgIHRoaXMuZGVsZWdhdGUud2lsbFN1Ym1pdEZvcm0oZm9ybSwgc3VibWl0dGVyKVxuICAgICAgKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLmZvcm1TdWJtaXR0ZWQoZm9ybSwgc3VibWl0dGVyKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gc3VibWlzc2lvbkRvZXNOb3REaXNtaXNzRGlhbG9nKGZvcm0sIHN1Ym1pdHRlcikge1xuICBjb25zdCBtZXRob2QgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImZvcm1tZXRob2RcIikgfHwgZm9ybS5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIik7XG5cbiAgcmV0dXJuIG1ldGhvZCAhPSBcImRpYWxvZ1wiXG59XG5cbmZ1bmN0aW9uIHN1Ym1pc3Npb25Eb2VzTm90VGFyZ2V0SUZyYW1lKGZvcm0sIHN1Ym1pdHRlcikge1xuICBjb25zdCB0YXJnZXQgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImZvcm10YXJnZXRcIikgfHwgZm9ybS5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIik7XG5cbiAgcmV0dXJuIGRvZXNOb3RUYXJnZXRJRnJhbWUodGFyZ2V0KVxufVxuXG5jbGFzcyBWaWV3IHtcbiAgI3Jlc29sdmVSZW5kZXJQcm9taXNlID0gKF92YWx1ZSkgPT4ge31cbiAgI3Jlc29sdmVJbnRlcmNlcHRpb25Qcm9taXNlID0gKF92YWx1ZSkgPT4ge31cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgLy8gU2Nyb2xsaW5nXG5cbiAgc2Nyb2xsVG9BbmNob3IoYW5jaG9yKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc25hcHNob3QuZ2V0RWxlbWVudEZvckFuY2hvcihhbmNob3IpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICB0aGlzLnNjcm9sbFRvRWxlbWVudChlbGVtZW50KTtcbiAgICAgIHRoaXMuZm9jdXNFbGVtZW50KGVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNjcm9sbFRvUG9zaXRpb24oeyB4OiAwLCB5OiAwIH0pO1xuICAgIH1cbiAgfVxuXG4gIHNjcm9sbFRvQW5jaG9yRnJvbUxvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgdGhpcy5zY3JvbGxUb0FuY2hvcihnZXRBbmNob3IobG9jYXRpb24pKTtcbiAgfVxuXG4gIHNjcm9sbFRvRWxlbWVudChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5zY3JvbGxJbnRvVmlldygpO1xuICB9XG5cbiAgZm9jdXNFbGVtZW50KGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKSkge1xuICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzY3JvbGxUb1Bvc2l0aW9uKHsgeCwgeSB9KSB7XG4gICAgdGhpcy5zY3JvbGxSb290LnNjcm9sbFRvKHgsIHkpO1xuICB9XG5cbiAgc2Nyb2xsVG9Ub3AoKSB7XG4gICAgdGhpcy5zY3JvbGxUb1Bvc2l0aW9uKHsgeDogMCwgeTogMCB9KTtcbiAgfVxuXG4gIGdldCBzY3JvbGxSb290KCkge1xuICAgIHJldHVybiB3aW5kb3dcbiAgfVxuXG4gIC8vIFJlbmRlcmluZ1xuXG4gIGFzeW5jIHJlbmRlcihyZW5kZXJlcikge1xuICAgIGNvbnN0IHsgaXNQcmV2aWV3LCBzaG91bGRSZW5kZXIsIHdpbGxSZW5kZXIsIG5ld1NuYXBzaG90OiBzbmFwc2hvdCB9ID0gcmVuZGVyZXI7XG5cbiAgICAvLyBBIHdvcmthcm91bmQgdG8gaWdub3JlIHRyYWNrZWQgZWxlbWVudCBtaXNtYXRjaCByZWxvYWRzIHdoZW4gcGVyZm9ybWluZ1xuICAgIC8vIGEgcHJvbW90ZWQgVmlzaXQgZnJvbSBhIGZyYW1lIG5hdmlnYXRpb25cbiAgICBjb25zdCBzaG91bGRJbnZhbGlkYXRlID0gd2lsbFJlbmRlcjtcblxuICAgIGlmIChzaG91bGRSZW5kZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiAodGhpcy4jcmVzb2x2ZVJlbmRlclByb21pc2UgPSByZXNvbHZlKSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgYXdhaXQgdGhpcy5wcmVwYXJlVG9SZW5kZXJTbmFwc2hvdChyZW5kZXJlcik7XG5cbiAgICAgICAgY29uc3QgcmVuZGVySW50ZXJjZXB0aW9uID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+ICh0aGlzLiNyZXNvbHZlSW50ZXJjZXB0aW9uUHJvbWlzZSA9IHJlc29sdmUpKTtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgcmVzdW1lOiB0aGlzLiNyZXNvbHZlSW50ZXJjZXB0aW9uUHJvbWlzZSwgcmVuZGVyOiB0aGlzLnJlbmRlcmVyLnJlbmRlckVsZW1lbnQsIHJlbmRlck1ldGhvZDogdGhpcy5yZW5kZXJlci5yZW5kZXJNZXRob2QgfTtcbiAgICAgICAgY29uc3QgaW1tZWRpYXRlUmVuZGVyID0gdGhpcy5kZWxlZ2F0ZS5hbGxvd3NJbW1lZGlhdGVSZW5kZXIoc25hcHNob3QsIG9wdGlvbnMpO1xuICAgICAgICBpZiAoIWltbWVkaWF0ZVJlbmRlcikgYXdhaXQgcmVuZGVySW50ZXJjZXB0aW9uO1xuXG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyU25hcHNob3QocmVuZGVyZXIpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLnZpZXdSZW5kZXJlZFNuYXBzaG90KHNuYXBzaG90LCBpc1ByZXZpZXcsIHRoaXMucmVuZGVyZXIucmVuZGVyTWV0aG9kKTtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5wcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KHRoaXMuZWxlbWVudCk7XG4gICAgICAgIHRoaXMuZmluaXNoUmVuZGVyaW5nU25hcHNob3QocmVuZGVyZXIpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgZGVsZXRlIHRoaXMucmVuZGVyZXI7XG4gICAgICAgIHRoaXMuI3Jlc29sdmVSZW5kZXJQcm9taXNlKHVuZGVmaW5lZCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLnJlbmRlclByb21pc2U7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzaG91bGRJbnZhbGlkYXRlKSB7XG4gICAgICB0aGlzLmludmFsaWRhdGUocmVuZGVyZXIucmVsb2FkUmVhc29uKTtcbiAgICB9XG4gIH1cblxuICBpbnZhbGlkYXRlKHJlYXNvbikge1xuICAgIHRoaXMuZGVsZWdhdGUudmlld0ludmFsaWRhdGVkKHJlYXNvbik7XG4gIH1cblxuICBhc3luYyBwcmVwYXJlVG9SZW5kZXJTbmFwc2hvdChyZW5kZXJlcikge1xuICAgIHRoaXMubWFya0FzUHJldmlldyhyZW5kZXJlci5pc1ByZXZpZXcpO1xuICAgIGF3YWl0IHJlbmRlcmVyLnByZXBhcmVUb1JlbmRlcigpO1xuICB9XG5cbiAgbWFya0FzUHJldmlldyhpc1ByZXZpZXcpIHtcbiAgICBpZiAoaXNQcmV2aWV3KSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1wcmV2aWV3XCIsIFwiXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS10dXJiby1wcmV2aWV3XCIpO1xuICAgIH1cbiAgfVxuXG4gIG1hcmtWaXNpdERpcmVjdGlvbihkaXJlY3Rpb24pIHtcbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby12aXNpdC1kaXJlY3Rpb25cIiwgZGlyZWN0aW9uKTtcbiAgfVxuXG4gIHVubWFya1Zpc2l0RGlyZWN0aW9uKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXZpc2l0LWRpcmVjdGlvblwiKTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlclNuYXBzaG90KHJlbmRlcmVyKSB7XG4gICAgYXdhaXQgcmVuZGVyZXIucmVuZGVyKCk7XG4gIH1cblxuICBmaW5pc2hSZW5kZXJpbmdTbmFwc2hvdChyZW5kZXJlcikge1xuICAgIHJlbmRlcmVyLmZpbmlzaFJlbmRlcmluZygpO1xuICB9XG59XG5cbmNsYXNzIEZyYW1lVmlldyBleHRlbmRzIFZpZXcge1xuICBtaXNzaW5nKCkge1xuICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSBgPHN0cm9uZyBjbGFzcz1cInR1cmJvLWZyYW1lLWVycm9yXCI+Q29udGVudCBtaXNzaW5nPC9zdHJvbmc+YDtcbiAgfVxuXG4gIGdldCBzbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gbmV3IFNuYXBzaG90KHRoaXMuZWxlbWVudClcbiAgfVxufVxuXG5jbGFzcyBMaW5rSW50ZXJjZXB0b3Ige1xuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQnViYmxlZCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOmNsaWNrXCIsIHRoaXMubGlua0NsaWNrZWQpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtdmlzaXRcIiwgdGhpcy53aWxsVmlzaXQpO1xuICB9XG5cbiAgc3RvcCgpIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tCdWJibGVkKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86Y2xpY2tcIiwgdGhpcy5saW5rQ2xpY2tlZCk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInR1cmJvOmJlZm9yZS12aXNpdFwiLCB0aGlzLndpbGxWaXNpdCk7XG4gIH1cblxuICBjbGlja0J1YmJsZWQgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAodGhpcy5jbGlja0V2ZW50SXNTaWduaWZpY2FudChldmVudCkpIHtcbiAgICAgIHRoaXMuY2xpY2tFdmVudCA9IGV2ZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWxldGUgdGhpcy5jbGlja0V2ZW50O1xuICAgIH1cbiAgfVxuXG4gIGxpbmtDbGlja2VkID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKHRoaXMuY2xpY2tFdmVudCAmJiB0aGlzLmNsaWNrRXZlbnRJc1NpZ25pZmljYW50KGV2ZW50KSkge1xuICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc2hvdWxkSW50ZXJjZXB0TGlua0NsaWNrKGV2ZW50LnRhcmdldCwgZXZlbnQuZGV0YWlsLnVybCwgZXZlbnQuZGV0YWlsLm9yaWdpbmFsRXZlbnQpKSB7XG4gICAgICAgIHRoaXMuY2xpY2tFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmRlbGVnYXRlLmxpbmtDbGlja0ludGVyY2VwdGVkKGV2ZW50LnRhcmdldCwgZXZlbnQuZGV0YWlsLnVybCwgZXZlbnQuZGV0YWlsLm9yaWdpbmFsRXZlbnQpO1xuICAgICAgfVxuICAgIH1cbiAgICBkZWxldGUgdGhpcy5jbGlja0V2ZW50O1xuICB9XG5cbiAgd2lsbFZpc2l0ID0gKF9ldmVudCkgPT4ge1xuICAgIGRlbGV0ZSB0aGlzLmNsaWNrRXZlbnQ7XG4gIH1cblxuICBjbGlja0V2ZW50SXNTaWduaWZpY2FudChldmVudCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LmNvbXBvc2VkID8gZXZlbnQudGFyZ2V0Py5wYXJlbnRFbGVtZW50IDogZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGVsZW1lbnQgPSBmaW5kTGlua0Zyb21DbGlja1RhcmdldCh0YXJnZXQpIHx8IHRhcmdldDtcblxuICAgIHJldHVybiBlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCAmJiBlbGVtZW50LmNsb3Nlc3QoXCJ0dXJiby1mcmFtZSwgaHRtbFwiKSA9PSB0aGlzLmVsZW1lbnRcbiAgfVxufVxuXG5jbGFzcyBMaW5rQ2xpY2tPYnNlcnZlciB7XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlLCBldmVudFRhcmdldCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZXZlbnRUYXJnZXQ7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbGlja0NhcHR1cmVkLCB0cnVlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQ2FwdHVyZWQsIHRydWUpO1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgY2xpY2tDYXB0dXJlZCA9ICgpID0+IHtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrQnViYmxlZCwgZmFsc2UpO1xuICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xpY2tCdWJibGVkLCBmYWxzZSk7XG4gIH1cblxuICBjbGlja0J1YmJsZWQgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ICYmIHRoaXMuY2xpY2tFdmVudElzU2lnbmlmaWNhbnQoZXZlbnQpKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSAoZXZlbnQuY29tcG9zZWRQYXRoICYmIGV2ZW50LmNvbXBvc2VkUGF0aCgpWzBdKSB8fCBldmVudC50YXJnZXQ7XG4gICAgICBjb25zdCBsaW5rID0gZmluZExpbmtGcm9tQ2xpY2tUYXJnZXQodGFyZ2V0KTtcbiAgICAgIGlmIChsaW5rICYmIGRvZXNOb3RUYXJnZXRJRnJhbWUobGluay50YXJnZXQpKSB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb25Gb3JMaW5rKGxpbmspO1xuICAgICAgICBpZiAodGhpcy5kZWxlZ2F0ZS53aWxsRm9sbG93TGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2ZW50KSkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdGhpcy5kZWxlZ2F0ZS5mb2xsb3dlZExpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNsaWNrRXZlbnRJc1NpZ25pZmljYW50KGV2ZW50KSB7XG4gICAgcmV0dXJuICEoXG4gICAgICAoZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5pc0NvbnRlbnRFZGl0YWJsZSkgfHxcbiAgICAgIGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQgfHxcbiAgICAgIGV2ZW50LndoaWNoID4gMSB8fFxuICAgICAgZXZlbnQuYWx0S2V5IHx8XG4gICAgICBldmVudC5jdHJsS2V5IHx8XG4gICAgICBldmVudC5tZXRhS2V5IHx8XG4gICAgICBldmVudC5zaGlmdEtleVxuICAgIClcbiAgfVxufVxuXG5jbGFzcyBGb3JtTGlua0NsaWNrT2JzZXJ2ZXIge1xuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZWxlbWVudCkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmxpbmtJbnRlcmNlcHRvciA9IG5ldyBMaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCBlbGVtZW50KTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0YXJ0KCk7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0b3AoKTtcbiAgfVxuXG4gIC8vIExpbmsgaG92ZXIgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBjYW5QcmVmZXRjaFJlcXVlc3RUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBwcmVmZXRjaEFuZENhY2hlUmVxdWVzdFRvTG9jYXRpb24obGluaywgbG9jYXRpb24pIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIC8vIExpbmsgY2xpY2sgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsRm9sbG93TGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIG9yaWdpbmFsRXZlbnQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5kZWxlZ2F0ZS53aWxsU3VibWl0Rm9ybUxpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uLCBvcmlnaW5hbEV2ZW50KSAmJlxuICAgICAgKGxpbmsuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1tZXRob2RcIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKSlcbiAgICApXG4gIH1cblxuICBmb2xsb3dlZExpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xuXG4gICAgY29uc3QgdHlwZSA9IFwiaGlkZGVuXCI7XG4gICAgZm9yIChjb25zdCBbbmFtZSwgdmFsdWVdIG9mIGxvY2F0aW9uLnNlYXJjaFBhcmFtcykge1xuICAgICAgZm9ybS5hcHBlbmQoT2JqZWN0LmFzc2lnbihkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksIHsgdHlwZSwgbmFtZSwgdmFsdWUgfSkpO1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGlvbiA9IE9iamVjdC5hc3NpZ24obG9jYXRpb24sIHsgc2VhcmNoOiBcIlwiIH0pO1xuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiZGF0YS10dXJib1wiLCBcInRydWVcIik7XG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIiwgYWN0aW9uLmhyZWYpO1xuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiaGlkZGVuXCIsIFwiXCIpO1xuXG4gICAgY29uc3QgbWV0aG9kID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLW1ldGhvZFwiKTtcbiAgICBpZiAobWV0aG9kKSBmb3JtLnNldEF0dHJpYnV0ZShcIm1ldGhvZFwiLCBtZXRob2QpO1xuXG4gICAgY29uc3QgdHVyYm9GcmFtZSA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKTtcbiAgICBpZiAodHVyYm9GcmFtZSkgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIsIHR1cmJvRnJhbWUpO1xuXG4gICAgY29uc3QgdHVyYm9BY3Rpb24gPSBnZXRWaXNpdEFjdGlvbihsaW5rKTtcbiAgICBpZiAodHVyYm9BY3Rpb24pIGZvcm0uc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1hY3Rpb25cIiwgdHVyYm9BY3Rpb24pO1xuXG4gICAgY29uc3QgdHVyYm9Db25maXJtID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIik7XG4gICAgaWYgKHR1cmJvQ29uZmlybSkgZm9ybS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIiwgdHVyYm9Db25maXJtKTtcblxuICAgIGNvbnN0IHR1cmJvU3RyZWFtID0gbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKTtcbiAgICBpZiAodHVyYm9TdHJlYW0pIGZvcm0uc2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIiwgXCJcIik7XG5cbiAgICB0aGlzLmRlbGVnYXRlLnN1Ym1pdHRlZEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZm9ybSk7XG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZvcm0pO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInR1cmJvOnN1Ym1pdC1lbmRcIiwgKCkgPT4gZm9ybS5yZW1vdmUoKSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBmb3JtLnJlcXVlc3RTdWJtaXQoKSk7XG4gIH1cbn1cblxuY2xhc3MgQmFyZG8ge1xuICBzdGF0aWMgYXN5bmMgcHJlc2VydmluZ1Blcm1hbmVudEVsZW1lbnRzKGRlbGVnYXRlLCBwZXJtYW5lbnRFbGVtZW50TWFwLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IGJhcmRvID0gbmV3IHRoaXMoZGVsZWdhdGUsIHBlcm1hbmVudEVsZW1lbnRNYXApO1xuICAgIGJhcmRvLmVudGVyKCk7XG4gICAgYXdhaXQgY2FsbGJhY2soKTtcbiAgICBiYXJkby5sZWF2ZSgpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIHBlcm1hbmVudEVsZW1lbnRNYXApIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwID0gcGVybWFuZW50RWxlbWVudE1hcDtcbiAgfVxuXG4gIGVudGVyKCkge1xuICAgIGZvciAoY29uc3QgaWQgaW4gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwKSB7XG4gICAgICBjb25zdCBbY3VycmVudFBlcm1hbmVudEVsZW1lbnQsIG5ld1Blcm1hbmVudEVsZW1lbnRdID0gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwW2lkXTtcbiAgICAgIHRoaXMuZGVsZWdhdGUuZW50ZXJpbmdCYXJkbyhjdXJyZW50UGVybWFuZW50RWxlbWVudCwgbmV3UGVybWFuZW50RWxlbWVudCk7XG4gICAgICB0aGlzLnJlcGxhY2VOZXdQZXJtYW5lbnRFbGVtZW50V2l0aFBsYWNlaG9sZGVyKG5ld1Blcm1hbmVudEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGxlYXZlKCkge1xuICAgIGZvciAoY29uc3QgaWQgaW4gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwKSB7XG4gICAgICBjb25zdCBbY3VycmVudFBlcm1hbmVudEVsZW1lbnRdID0gdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwW2lkXTtcbiAgICAgIHRoaXMucmVwbGFjZUN1cnJlbnRQZXJtYW5lbnRFbGVtZW50V2l0aENsb25lKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50KTtcbiAgICAgIHRoaXMucmVwbGFjZVBsYWNlaG9sZGVyV2l0aFBlcm1hbmVudEVsZW1lbnQoY3VycmVudFBlcm1hbmVudEVsZW1lbnQpO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5sZWF2aW5nQmFyZG8oY3VycmVudFBlcm1hbmVudEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJlcGxhY2VOZXdQZXJtYW5lbnRFbGVtZW50V2l0aFBsYWNlaG9sZGVyKHBlcm1hbmVudEVsZW1lbnQpIHtcbiAgICBjb25zdCBwbGFjZWhvbGRlciA9IGNyZWF0ZVBsYWNlaG9sZGVyRm9yUGVybWFuZW50RWxlbWVudChwZXJtYW5lbnRFbGVtZW50KTtcbiAgICBwZXJtYW5lbnRFbGVtZW50LnJlcGxhY2VXaXRoKHBsYWNlaG9sZGVyKTtcbiAgfVxuXG4gIHJlcGxhY2VDdXJyZW50UGVybWFuZW50RWxlbWVudFdpdGhDbG9uZShwZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgY29uc3QgY2xvbmUgPSBwZXJtYW5lbnRFbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgICBwZXJtYW5lbnRFbGVtZW50LnJlcGxhY2VXaXRoKGNsb25lKTtcbiAgfVxuXG4gIHJlcGxhY2VQbGFjZWhvbGRlcldpdGhQZXJtYW5lbnRFbGVtZW50KHBlcm1hbmVudEVsZW1lbnQpIHtcbiAgICBjb25zdCBwbGFjZWhvbGRlciA9IHRoaXMuZ2V0UGxhY2Vob2xkZXJCeUlkKHBlcm1hbmVudEVsZW1lbnQuaWQpO1xuICAgIHBsYWNlaG9sZGVyPy5yZXBsYWNlV2l0aChwZXJtYW5lbnRFbGVtZW50KTtcbiAgfVxuXG4gIGdldFBsYWNlaG9sZGVyQnlJZChpZCkge1xuICAgIHJldHVybiB0aGlzLnBsYWNlaG9sZGVycy5maW5kKChlbGVtZW50KSA9PiBlbGVtZW50LmNvbnRlbnQgPT0gaWQpXG4gIH1cblxuICBnZXQgcGxhY2Vob2xkZXJzKCkge1xuICAgIHJldHVybiBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIm1ldGFbbmFtZT10dXJiby1wZXJtYW5lbnQtcGxhY2Vob2xkZXJdW2NvbnRlbnRdXCIpXVxuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVBsYWNlaG9sZGVyRm9yUGVybWFuZW50RWxlbWVudChwZXJtYW5lbnRFbGVtZW50KSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibWV0YVwiKTtcbiAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwidHVyYm8tcGVybWFuZW50LXBsYWNlaG9sZGVyXCIpO1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImNvbnRlbnRcIiwgcGVybWFuZW50RWxlbWVudC5pZCk7XG4gIHJldHVybiBlbGVtZW50XG59XG5cbmNsYXNzIFJlbmRlcmVyIHtcbiAgI2FjdGl2ZUVsZW1lbnQgPSBudWxsXG5cbiAgc3RhdGljIHJlbmRlckVsZW1lbnQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgICAvLyBBYnN0cmFjdCBtZXRob2RcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGN1cnJlbnRTbmFwc2hvdCwgbmV3U25hcHNob3QsIGlzUHJldmlldywgd2lsbFJlbmRlciA9IHRydWUpIHtcbiAgICB0aGlzLmN1cnJlbnRTbmFwc2hvdCA9IGN1cnJlbnRTbmFwc2hvdDtcbiAgICB0aGlzLm5ld1NuYXBzaG90ID0gbmV3U25hcHNob3Q7XG4gICAgdGhpcy5pc1ByZXZpZXcgPSBpc1ByZXZpZXc7XG4gICAgdGhpcy53aWxsUmVuZGVyID0gd2lsbFJlbmRlcjtcbiAgICB0aGlzLnJlbmRlckVsZW1lbnQgPSB0aGlzLmNvbnN0cnVjdG9yLnJlbmRlckVsZW1lbnQ7XG4gICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gKHRoaXMucmVzb2x2aW5nRnVuY3Rpb25zID0geyByZXNvbHZlLCByZWplY3QgfSkpO1xuICB9XG5cbiAgZ2V0IHNob3VsZFJlbmRlcigpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgZ2V0IHNob3VsZEF1dG9mb2N1cygpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgZ2V0IHJlbG9hZFJlYXNvbigpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHByZXBhcmVUb1JlbmRlcigpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICAvLyBBYnN0cmFjdCBtZXRob2RcbiAgfVxuXG4gIGZpbmlzaFJlbmRlcmluZygpIHtcbiAgICBpZiAodGhpcy5yZXNvbHZpbmdGdW5jdGlvbnMpIHtcbiAgICAgIHRoaXMucmVzb2x2aW5nRnVuY3Rpb25zLnJlc29sdmUoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLnJlc29sdmluZ0Z1bmN0aW9ucztcbiAgICB9XG4gIH1cblxuICBhc3luYyBwcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoY2FsbGJhY2spIHtcbiAgICBhd2FpdCBCYXJkby5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHModGhpcywgdGhpcy5wZXJtYW5lbnRFbGVtZW50TWFwLCBjYWxsYmFjayk7XG4gIH1cblxuICBmb2N1c0ZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnQoKSB7XG4gICAgaWYgKHRoaXMuc2hvdWxkQXV0b2ZvY3VzKSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5jb25uZWN0ZWRTbmFwc2hvdC5maXJzdEF1dG9mb2N1c2FibGVFbGVtZW50O1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEJhcmRvIGRlbGVnYXRlXG5cbiAgZW50ZXJpbmdCYXJkbyhjdXJyZW50UGVybWFuZW50RWxlbWVudCkge1xuICAgIGlmICh0aGlzLiNhY3RpdmVFbGVtZW50KSByZXR1cm5cblxuICAgIGlmIChjdXJyZW50UGVybWFuZW50RWxlbWVudC5jb250YWlucyh0aGlzLmN1cnJlbnRTbmFwc2hvdC5hY3RpdmVFbGVtZW50KSkge1xuICAgICAgdGhpcy4jYWN0aXZlRWxlbWVudCA9IHRoaXMuY3VycmVudFNuYXBzaG90LmFjdGl2ZUVsZW1lbnQ7XG4gICAgfVxuICB9XG5cbiAgbGVhdmluZ0JhcmRvKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50KSB7XG4gICAgaWYgKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LmNvbnRhaW5zKHRoaXMuI2FjdGl2ZUVsZW1lbnQpICYmIHRoaXMuI2FjdGl2ZUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgdGhpcy4jYWN0aXZlRWxlbWVudC5mb2N1cygpO1xuXG4gICAgICB0aGlzLiNhY3RpdmVFbGVtZW50ID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBnZXQgY29ubmVjdGVkU25hcHNob3QoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3U25hcHNob3QuaXNDb25uZWN0ZWQgPyB0aGlzLm5ld1NuYXBzaG90IDogdGhpcy5jdXJyZW50U25hcHNob3RcbiAgfVxuXG4gIGdldCBjdXJyZW50RWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50U25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgZ2V0IG5ld0VsZW1lbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3U25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgZ2V0IHBlcm1hbmVudEVsZW1lbnRNYXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFNuYXBzaG90LmdldFBlcm1hbmVudEVsZW1lbnRNYXBGb3JTbmFwc2hvdCh0aGlzLm5ld1NuYXBzaG90KVxuICB9XG5cbiAgZ2V0IHJlbmRlck1ldGhvZCgpIHtcbiAgICByZXR1cm4gXCJyZXBsYWNlXCJcbiAgfVxufVxuXG5jbGFzcyBGcmFtZVJlbmRlcmVyIGV4dGVuZHMgUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIGNvbnN0IGRlc3RpbmF0aW9uUmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgIGRlc3RpbmF0aW9uUmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGN1cnJlbnRFbGVtZW50KTtcbiAgICBkZXN0aW5hdGlvblJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7XG5cbiAgICBjb25zdCBmcmFtZUVsZW1lbnQgPSBuZXdFbGVtZW50O1xuICAgIGNvbnN0IHNvdXJjZVJhbmdlID0gZnJhbWVFbGVtZW50Lm93bmVyRG9jdW1lbnQ/LmNyZWF0ZVJhbmdlKCk7XG4gICAgaWYgKHNvdXJjZVJhbmdlKSB7XG4gICAgICBzb3VyY2VSYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZnJhbWVFbGVtZW50KTtcbiAgICAgIGN1cnJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHNvdXJjZVJhbmdlLmV4dHJhY3RDb250ZW50cygpKTtcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgY3VycmVudFNuYXBzaG90LCBuZXdTbmFwc2hvdCwgcmVuZGVyRWxlbWVudCwgaXNQcmV2aWV3LCB3aWxsUmVuZGVyID0gdHJ1ZSkge1xuICAgIHN1cGVyKGN1cnJlbnRTbmFwc2hvdCwgbmV3U25hcHNob3QsIHJlbmRlckVsZW1lbnQsIGlzUHJldmlldywgd2lsbFJlbmRlcik7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgZ2V0IHNob3VsZFJlbmRlcigpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgYXN5bmMgcmVuZGVyKCkge1xuICAgIGF3YWl0IG5leHRSZXBhaW50KCk7XG4gICAgdGhpcy5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoKCkgPT4ge1xuICAgICAgdGhpcy5sb2FkRnJhbWVFbGVtZW50KCk7XG4gICAgfSk7XG4gICAgdGhpcy5zY3JvbGxGcmFtZUludG9WaWV3KCk7XG4gICAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICB0aGlzLmZvY3VzRmlyc3RBdXRvZm9jdXNhYmxlRWxlbWVudCgpO1xuICAgIGF3YWl0IG5leHRSZXBhaW50KCk7XG4gICAgdGhpcy5hY3RpdmF0ZVNjcmlwdEVsZW1lbnRzKCk7XG4gIH1cblxuICBsb2FkRnJhbWVFbGVtZW50KCkge1xuICAgIHRoaXMuZGVsZWdhdGUud2lsbFJlbmRlckZyYW1lKHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gICAgdGhpcy5yZW5kZXJFbGVtZW50KHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gIH1cblxuICBzY3JvbGxGcmFtZUludG9WaWV3KCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRFbGVtZW50LmF1dG9zY3JvbGwgfHwgdGhpcy5uZXdFbGVtZW50LmF1dG9zY3JvbGwpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmN1cnJlbnRFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgY29uc3QgYmxvY2sgPSByZWFkU2Nyb2xsTG9naWNhbFBvc2l0aW9uKHRoaXMuY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hdXRvc2Nyb2xsLWJsb2NrXCIpLCBcImVuZFwiKTtcbiAgICAgIGNvbnN0IGJlaGF2aW9yID0gcmVhZFNjcm9sbEJlaGF2aW9yKHRoaXMuY3VycmVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hdXRvc2Nyb2xsLWJlaGF2aW9yXCIpLCBcImF1dG9cIik7XG5cbiAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoeyBibG9jaywgYmVoYXZpb3IgfSk7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgYWN0aXZhdGVTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiB0aGlzLm5ld1NjcmlwdEVsZW1lbnRzKSB7XG4gICAgICBjb25zdCBhY3RpdmF0ZWRTY3JpcHRFbGVtZW50ID0gYWN0aXZhdGVTY3JpcHRFbGVtZW50KGluZXJ0U2NyaXB0RWxlbWVudCk7XG4gICAgICBpbmVydFNjcmlwdEVsZW1lbnQucmVwbGFjZVdpdGgoYWN0aXZhdGVkU2NyaXB0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IG5ld1NjcmlwdEVsZW1lbnRzKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHRcIilcbiAgfVxufVxuXG5mdW5jdGlvbiByZWFkU2Nyb2xsTG9naWNhbFBvc2l0aW9uKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgaWYgKHZhbHVlID09IFwiZW5kXCIgfHwgdmFsdWUgPT0gXCJzdGFydFwiIHx8IHZhbHVlID09IFwiY2VudGVyXCIgfHwgdmFsdWUgPT0gXCJuZWFyZXN0XCIpIHtcbiAgICByZXR1cm4gdmFsdWVcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlXG4gIH1cbn1cblxuZnVuY3Rpb24gcmVhZFNjcm9sbEJlaGF2aW9yKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgaWYgKHZhbHVlID09IFwiYXV0b1wiIHx8IHZhbHVlID09IFwic21vb3RoXCIpIHtcbiAgICByZXR1cm4gdmFsdWVcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlXG4gIH1cbn1cblxuLy8gYmFzZSBJSUZFIHRvIGRlZmluZSBpZGlvbW9ycGhcbnZhciBJZGlvbW9ycGggPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gQU5EIE5PVyBJVCBCRUdJTlMuLi5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBsZXQgRU1QVFlfU0VUID0gbmV3IFNldCgpO1xuXG4gICAgICAgIC8vIGRlZmF1bHQgY29uZmlndXJhdGlvbiB2YWx1ZXMsIHVwZGF0YWJsZSBieSB1c2VycyBub3dcbiAgICAgICAgbGV0IGRlZmF1bHRzID0ge1xuICAgICAgICAgICAgbW9ycGhTdHlsZTogXCJvdXRlckhUTUxcIixcbiAgICAgICAgICAgIGNhbGxiYWNrcyA6IHtcbiAgICAgICAgICAgICAgICBiZWZvcmVOb2RlQWRkZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYWZ0ZXJOb2RlQWRkZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYmVmb3JlTm9kZU1vcnBoZWQ6IG5vT3AsXG4gICAgICAgICAgICAgICAgYWZ0ZXJOb2RlTW9ycGhlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBiZWZvcmVOb2RlUmVtb3ZlZDogbm9PcCxcbiAgICAgICAgICAgICAgICBhZnRlck5vZGVSZW1vdmVkOiBub09wLFxuICAgICAgICAgICAgICAgIGJlZm9yZUF0dHJpYnV0ZVVwZGF0ZWQ6IG5vT3AsXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoZWFkOiB7XG4gICAgICAgICAgICAgICAgc3R5bGU6ICdtZXJnZScsXG4gICAgICAgICAgICAgICAgc2hvdWxkUHJlc2VydmU6IGZ1bmN0aW9uIChlbHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsdC5nZXRBdHRyaWJ1dGUoXCJpbS1wcmVzZXJ2ZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaG91bGRSZUFwcGVuZDogZnVuY3Rpb24gKGVsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWx0LmdldEF0dHJpYnV0ZShcImltLXJlLWFwcGVuZFwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaG91bGRSZW1vdmU6IG5vT3AsXG4gICAgICAgICAgICAgICAgYWZ0ZXJIZWFkTW9ycGhlZDogbm9PcCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIENvcmUgTW9ycGhpbmcgQWxnb3JpdGhtIC0gbW9ycGgsIG1vcnBoTm9ybWFsaXplZENvbnRlbnQsIG1vcnBoT2xkTm9kZVRvLCBtb3JwaENoaWxkcmVuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gbW9ycGgob2xkTm9kZSwgbmV3Q29udGVudCwgY29uZmlnID0ge30pIHtcblxuICAgICAgICAgICAgaWYgKG9sZE5vZGUgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xuICAgICAgICAgICAgICAgIG9sZE5vZGUgPSBvbGROb2RlLmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQgPSBwYXJzZUNvbnRlbnQobmV3Q29udGVudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBub3JtYWxpemVkQ29udGVudCA9IG5vcm1hbGl6ZUNvbnRlbnQobmV3Q29udGVudCk7XG5cbiAgICAgICAgICAgIGxldCBjdHggPSBjcmVhdGVNb3JwaENvbnRleHQob2xkTm9kZSwgbm9ybWFsaXplZENvbnRlbnQsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIHJldHVybiBtb3JwaE5vcm1hbGl6ZWRDb250ZW50KG9sZE5vZGUsIG5vcm1hbGl6ZWRDb250ZW50LCBjdHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbW9ycGhOb3JtYWxpemVkQ29udGVudChvbGROb2RlLCBub3JtYWxpemVkTmV3Q29udGVudCwgY3R4KSB7XG4gICAgICAgICAgICBpZiAoY3R4LmhlYWQuYmxvY2spIHtcbiAgICAgICAgICAgICAgICBsZXQgb2xkSGVhZCA9IG9sZE5vZGUucXVlcnlTZWxlY3RvcignaGVhZCcpO1xuICAgICAgICAgICAgICAgIGxldCBuZXdIZWFkID0gbm9ybWFsaXplZE5ld0NvbnRlbnQucXVlcnlTZWxlY3RvcignaGVhZCcpO1xuICAgICAgICAgICAgICAgIGlmIChvbGRIZWFkICYmIG5ld0hlYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHByb21pc2VzID0gaGFuZGxlSGVhZEVsZW1lbnQobmV3SGVhZCwgb2xkSGVhZCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiBoZWFkIHByb21pc2VzIHJlc29sdmUsIGNhbGwgbW9ycGggYWdhaW4sIGlnbm9yaW5nIHRoZSBoZWFkIHRhZ1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3JwaE5vcm1hbGl6ZWRDb250ZW50KG9sZE5vZGUsIG5vcm1hbGl6ZWROZXdDb250ZW50LCBPYmplY3QuYXNzaWduKGN0eCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3R4Lm1vcnBoU3R5bGUgPT09IFwiaW5uZXJIVE1MXCIpIHtcblxuICAgICAgICAgICAgICAgIC8vIGlubmVySFRNTCwgc28gd2UgYXJlIG9ubHkgdXBkYXRpbmcgdGhlIGNoaWxkcmVuXG4gICAgICAgICAgICAgICAgbW9ycGhDaGlsZHJlbihub3JtYWxpemVkTmV3Q29udGVudCwgb2xkTm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2xkTm9kZS5jaGlsZHJlbjtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChjdHgubW9ycGhTdHlsZSA9PT0gXCJvdXRlckhUTUxcIiB8fCBjdHgubW9ycGhTdHlsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGZpbmQgdGhlIGJlc3QgZWxlbWVudCBtYXRjaCBpbiB0aGUgbmV3IGNvbnRlbnQsIG1vcnBoIHRoYXQsIGFuZCBtZXJnZSBpdHMgc2libGluZ3NcbiAgICAgICAgICAgICAgICAvLyBpbnRvIGVpdGhlciBzaWRlIG9mIHRoZSBiZXN0IG1hdGNoXG4gICAgICAgICAgICAgICAgbGV0IGJlc3RNYXRjaCA9IGZpbmRCZXN0Tm9kZU1hdGNoKG5vcm1hbGl6ZWROZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgLy8gc3Rhc2ggdGhlIHNpYmxpbmdzIHRoYXQgd2lsbCBuZWVkIHRvIGJlIGluc2VydGVkIG9uIGVpdGhlciBzaWRlIG9mIHRoZSBiZXN0IG1hdGNoXG4gICAgICAgICAgICAgICAgbGV0IHByZXZpb3VzU2libGluZyA9IGJlc3RNYXRjaD8ucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgICAgIGxldCBuZXh0U2libGluZyA9IGJlc3RNYXRjaD8ubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICAvLyBtb3JwaCBpdFxuICAgICAgICAgICAgICAgIGxldCBtb3JwaGVkTm9kZSA9IG1vcnBoT2xkTm9kZVRvKG9sZE5vZGUsIGJlc3RNYXRjaCwgY3R4KTtcblxuICAgICAgICAgICAgICAgIGlmIChiZXN0TWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUgd2FzIGEgYmVzdCBtYXRjaCwgbWVyZ2UgdGhlIHNpYmxpbmdzIGluIHRvbyBhbmQgcmV0dXJuIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyB3aG9sZSBidW5jaFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0U2libGluZ3MocHJldmlvdXNTaWJsaW5nLCBtb3JwaGVkTm9kZSwgbmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBub3RoaW5nIHdhcyBhZGRlZCB0byB0aGUgRE9NXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgXCJEbyBub3QgdW5kZXJzdGFuZCBob3cgdG8gbW9ycGggc3R5bGUgXCIgKyBjdHgubW9ycGhTdHlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSBwb3NzaWJsZUFjdGl2ZUVsZW1lbnRcbiAgICAgICAgICogQHBhcmFtIGN0eFxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGlnbm9yZVZhbHVlT2ZBY3RpdmVFbGVtZW50KHBvc3NpYmxlQWN0aXZlRWxlbWVudCwgY3R4KSB7XG4gICAgICAgICAgICByZXR1cm4gY3R4Lmlnbm9yZUFjdGl2ZVZhbHVlICYmIHBvc3NpYmxlQWN0aXZlRWxlbWVudCA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBwb3NzaWJsZUFjdGl2ZUVsZW1lbnQgIT09IGRvY3VtZW50LmJvZHk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIG9sZE5vZGUgcm9vdCBub2RlIHRvIG1lcmdlIGNvbnRlbnQgaW50b1xuICAgICAgICAgKiBAcGFyYW0gbmV3Q29udGVudCBuZXcgY29udGVudCB0byBtZXJnZVxuICAgICAgICAgKiBAcGFyYW0gY3R4IHRoZSBtZXJnZSBjb250ZXh0XG4gICAgICAgICAqIEByZXR1cm5zIHtFbGVtZW50fSB0aGUgZWxlbWVudCB0aGF0IGVuZGVkIHVwIGluIHRoZSBET01cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1vcnBoT2xkTm9kZVRvKG9sZE5vZGUsIG5ld0NvbnRlbnQsIGN0eCkge1xuICAgICAgICAgICAgaWYgKGN0eC5pZ25vcmVBY3RpdmUgJiYgb2xkTm9kZSA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkgOyBlbHNlIGlmIChuZXdDb250ZW50ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlUmVtb3ZlZChvbGROb2RlKSA9PT0gZmFsc2UpIHJldHVybiBvbGROb2RlO1xuXG4gICAgICAgICAgICAgICAgb2xkTm9kZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBjdHguY2FsbGJhY2tzLmFmdGVyTm9kZVJlbW92ZWQob2xkTm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFpc1NvZnRNYXRjaChvbGROb2RlLCBuZXdDb250ZW50KSkge1xuICAgICAgICAgICAgICAgIGlmIChjdHguY2FsbGJhY2tzLmJlZm9yZU5vZGVSZW1vdmVkKG9sZE5vZGUpID09PSBmYWxzZSkgcmV0dXJuIG9sZE5vZGU7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZUFkZGVkKG5ld0NvbnRlbnQpID09PSBmYWxzZSkgcmV0dXJuIG9sZE5vZGU7XG5cbiAgICAgICAgICAgICAgICBvbGROb2RlLnBhcmVudEVsZW1lbnQucmVwbGFjZUNoaWxkKG5ld0NvbnRlbnQsIG9sZE5vZGUpO1xuICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVSZW1vdmVkKG9sZE5vZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdDb250ZW50O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlTW9ycGhlZChvbGROb2RlLCBuZXdDb250ZW50KSA9PT0gZmFsc2UpIHJldHVybiBvbGROb2RlO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9sZE5vZGUgaW5zdGFuY2VvZiBIVE1MSGVhZEVsZW1lbnQgJiYgY3R4LmhlYWQuaWdub3JlKSA7IGVsc2UgaWYgKG9sZE5vZGUgaW5zdGFuY2VvZiBIVE1MSGVhZEVsZW1lbnQgJiYgY3R4LmhlYWQuc3R5bGUgIT09IFwibW9ycGhcIikge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVIZWFkRWxlbWVudChuZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN5bmNOb2RlRnJvbShuZXdDb250ZW50LCBvbGROb2RlLCBjdHgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZVZhbHVlT2ZBY3RpdmVFbGVtZW50KG9sZE5vZGUsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vcnBoQ2hpbGRyZW4obmV3Q29udGVudCwgb2xkTm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdHguY2FsbGJhY2tzLmFmdGVyTm9kZU1vcnBoZWQob2xkTm9kZSwgbmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9sZE5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBpcyB0aGUgY29yZSBhbGdvcml0aG0gZm9yIG1hdGNoaW5nIHVwIGNoaWxkcmVuLiAgVGhlIGlkZWEgaXMgdG8gdXNlIGlkIHNldHMgdG8gdHJ5IHRvIG1hdGNoIHVwXG4gICAgICAgICAqIG5vZGVzIGFzIGZhaXRoZnVsbHkgYXMgcG9zc2libGUuICBXZSBncmVlZGlseSBtYXRjaCwgd2hpY2ggYWxsb3dzIHVzIHRvIGtlZXAgdGhlIGFsZ29yaXRobSBmYXN0LCBidXRcbiAgICAgICAgICogYnkgdXNpbmcgaWQgc2V0cywgd2UgYXJlIGFibGUgdG8gYmV0dGVyIG1hdGNoIHVwIHdpdGggY29udGVudCBkZWVwZXIgaW4gdGhlIERPTS5cbiAgICAgICAgICpcbiAgICAgICAgICogQmFzaWMgYWxnb3JpdGhtIGlzLCBmb3IgZWFjaCBub2RlIGluIHRoZSBuZXcgY29udGVudDpcbiAgICAgICAgICpcbiAgICAgICAgICogLSBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgb2xkIHBhcmVudCwgYXBwZW5kIHRoZSBuZXcgY29udGVudFxuICAgICAgICAgKiAtIGlmIHRoZSBuZXcgY29udGVudCBoYXMgYW4gaWQgc2V0IG1hdGNoIHdpdGggdGhlIGN1cnJlbnQgaW5zZXJ0aW9uIHBvaW50LCBtb3JwaFxuICAgICAgICAgKiAtIHNlYXJjaCBmb3IgYW4gaWQgc2V0IG1hdGNoXG4gICAgICAgICAqIC0gaWYgaWQgc2V0IG1hdGNoIGZvdW5kLCBtb3JwaFxuICAgICAgICAgKiAtIG90aGVyd2lzZSBzZWFyY2ggZm9yIGEgXCJzb2Z0XCIgbWF0Y2hcbiAgICAgICAgICogLSBpZiBhIHNvZnQgbWF0Y2ggaXMgZm91bmQsIG1vcnBoXG4gICAgICAgICAqIC0gb3RoZXJ3aXNlLCBwcmVwZW5kIHRoZSBuZXcgbm9kZSBiZWZvcmUgdGhlIGN1cnJlbnQgaW5zZXJ0aW9uIHBvaW50XG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSB0d28gc2VhcmNoIGFsZ29yaXRobXMgdGVybWluYXRlIGlmIGNvbXBldGluZyBub2RlIG1hdGNoZXMgYXBwZWFyIHRvIG91dHdlaWdoIHdoYXQgY2FuIGJlIGFjaGlldmVkXG4gICAgICAgICAqIHdpdGggdGhlIGN1cnJlbnQgbm9kZS4gIFNlZSBmaW5kSWRTZXRNYXRjaCgpIGFuZCBmaW5kU29mdE1hdGNoKCkgZm9yIGRldGFpbHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gbmV3UGFyZW50IHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgbmV3IGNvbnRlbnRcbiAgICAgICAgICogQHBhcmFtIHtFbGVtZW50IH0gb2xkUGFyZW50IHRoZSBvbGQgY29udGVudCB0aGF0IHdlIGFyZSBtZXJnaW5nIHRoZSBuZXcgY29udGVudCBpbnRvXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG1vcnBoQ2hpbGRyZW4obmV3UGFyZW50LCBvbGRQYXJlbnQsIGN0eCkge1xuXG4gICAgICAgICAgICBsZXQgbmV4dE5ld0NoaWxkID0gbmV3UGFyZW50LmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICBsZXQgaW5zZXJ0aW9uUG9pbnQgPSBvbGRQYXJlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIGxldCBuZXdDaGlsZDtcblxuICAgICAgICAgICAgLy8gcnVuIHRocm91Z2ggYWxsIHRoZSBuZXcgY29udGVudFxuICAgICAgICAgICAgd2hpbGUgKG5leHROZXdDaGlsZCkge1xuXG4gICAgICAgICAgICAgICAgbmV3Q2hpbGQgPSBuZXh0TmV3Q2hpbGQ7XG4gICAgICAgICAgICAgICAgbmV4dE5ld0NoaWxkID0gbmV3Q2hpbGQubmV4dFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBhcmUgYXQgdGhlIGVuZCBvZiB0aGUgZXhpdGluZyBwYXJlbnQncyBjaGlsZHJlbiwganVzdCBhcHBlbmRcbiAgICAgICAgICAgICAgICBpZiAoaW5zZXJ0aW9uUG9pbnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlQWRkZWQobmV3Q2hpbGQpID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIG9sZFBhcmVudC5hcHBlbmRDaGlsZChuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVJZHNGcm9tQ29uc2lkZXJhdGlvbihjdHgsIG5ld0NoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGN1cnJlbnQgbm9kZSBoYXMgYW4gaWQgc2V0IG1hdGNoIHRoZW4gbW9ycGhcbiAgICAgICAgICAgICAgICBpZiAoaXNJZFNldE1hdGNoKG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCwgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICBtb3JwaE9sZE5vZGVUbyhpbnNlcnRpb25Qb2ludCwgbmV3Q2hpbGQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydGlvblBvaW50ID0gaW5zZXJ0aW9uUG9pbnQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2Ugc2VhcmNoIGZvcndhcmQgaW4gdGhlIGV4aXN0aW5nIG9sZCBjaGlsZHJlbiBmb3IgYW4gaWQgc2V0IG1hdGNoXG4gICAgICAgICAgICAgICAgbGV0IGlkU2V0TWF0Y2ggPSBmaW5kSWRTZXRNYXRjaChuZXdQYXJlbnQsIG9sZFBhcmVudCwgbmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgZm91bmQgYSBwb3RlbnRpYWwgbWF0Y2gsIHJlbW92ZSB0aGUgbm9kZXMgdW50aWwgdGhhdCBwb2ludCBhbmQgbW9ycGhcbiAgICAgICAgICAgICAgICBpZiAoaWRTZXRNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRpb25Qb2ludCA9IHJlbW92ZU5vZGVzQmV0d2VlbihpbnNlcnRpb25Qb2ludCwgaWRTZXRNYXRjaCwgY3R4KTtcbiAgICAgICAgICAgICAgICAgICAgbW9ycGhPbGROb2RlVG8oaWRTZXRNYXRjaCwgbmV3Q2hpbGQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBubyBpZCBzZXQgbWF0Y2ggZm91bmQsIHNvIHNjYW4gZm9yd2FyZCBmb3IgYSBzb2Z0IG1hdGNoIGZvciB0aGUgY3VycmVudCBub2RlXG4gICAgICAgICAgICAgICAgbGV0IHNvZnRNYXRjaCA9IGZpbmRTb2Z0TWF0Y2gobmV3UGFyZW50LCBvbGRQYXJlbnQsIG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCwgY3R4KTtcblxuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGZvdW5kIGEgc29mdCBtYXRjaCBmb3IgdGhlIGN1cnJlbnQgbm9kZSwgbW9ycGhcbiAgICAgICAgICAgICAgICBpZiAoc29mdE1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydGlvblBvaW50ID0gcmVtb3ZlTm9kZXNCZXR3ZWVuKGluc2VydGlvblBvaW50LCBzb2Z0TWF0Y2gsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIG1vcnBoT2xkTm9kZVRvKHNvZnRNYXRjaCwgbmV3Q2hpbGQsIGN0eCk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBhYmFuZG9uIGFsbCBob3BlIG9mIG1vcnBoaW5nLCBqdXN0IGluc2VydCB0aGUgbmV3IGNoaWxkIGJlZm9yZSB0aGUgaW5zZXJ0aW9uIHBvaW50XG4gICAgICAgICAgICAgICAgLy8gYW5kIG1vdmUgb25cbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlQWRkZWQobmV3Q2hpbGQpID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgb2xkUGFyZW50Lmluc2VydEJlZm9yZShuZXdDaGlsZCwgaW5zZXJ0aW9uUG9pbnQpO1xuICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbmV3Q2hpbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZW1vdmUgYW55IHJlbWFpbmluZyBvbGQgbm9kZXMgdGhhdCBkaWRuJ3QgbWF0Y2ggdXAgd2l0aCBuZXcgY29udGVudFxuICAgICAgICAgICAgd2hpbGUgKGluc2VydGlvblBvaW50ICE9PSBudWxsKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgdGVtcE5vZGUgPSBpbnNlcnRpb25Qb2ludDtcbiAgICAgICAgICAgICAgICBpbnNlcnRpb25Qb2ludCA9IGluc2VydGlvblBvaW50Lm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIHJlbW92ZU5vZGUodGVtcE5vZGUsIGN0eCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEF0dHJpYnV0ZSBTeW5jaW5nIENvZGVcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gYXR0ciB7U3RyaW5nfSB0aGUgYXR0cmlidXRlIHRvIGJlIG11dGF0ZWRcbiAgICAgICAgICogQHBhcmFtIHRvIHtFbGVtZW50fSB0aGUgZWxlbWVudCB0aGF0IGlzIGdvaW5nIHRvIGJlIHVwZGF0ZWRcbiAgICAgICAgICogQHBhcmFtIHVwZGF0ZVR5cGUgeyhcInVwZGF0ZVwifFwicmVtb3ZlXCIpfVxuICAgICAgICAgKiBAcGFyYW0gY3R4IHRoZSBtZXJnZSBjb250ZXh0XG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIHRoZSBhdHRyaWJ1dGUgc2hvdWxkIGJlIGlnbm9yZWQsIGZhbHNlIG90aGVyd2lzZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gaWdub3JlQXR0cmlidXRlKGF0dHIsIHRvLCB1cGRhdGVUeXBlLCBjdHgpIHtcbiAgICAgICAgICAgIGlmKGF0dHIgPT09ICd2YWx1ZScgJiYgY3R4Lmlnbm9yZUFjdGl2ZVZhbHVlICYmIHRvID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjdHguY2FsbGJhY2tzLmJlZm9yZUF0dHJpYnV0ZVVwZGF0ZWQoYXR0ciwgdG8sIHVwZGF0ZVR5cGUpID09PSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzeW5jcyBhIGdpdmVuIG5vZGUgd2l0aCBhbm90aGVyIG5vZGUsIGNvcHlpbmcgb3ZlciBhbGwgYXR0cmlidXRlcyBhbmRcbiAgICAgICAgICogaW5uZXIgZWxlbWVudCBzdGF0ZSBmcm9tIHRoZSAnZnJvbScgbm9kZSB0byB0aGUgJ3RvJyBub2RlXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZnJvbSB0aGUgZWxlbWVudCB0byBjb3B5IGF0dHJpYnV0ZXMgJiBzdGF0ZSBmcm9tXG4gICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdG8gdGhlIGVsZW1lbnQgdG8gY29weSBhdHRyaWJ1dGVzICYgc3RhdGUgdG9cbiAgICAgICAgICogQHBhcmFtIGN0eCB0aGUgbWVyZ2UgY29udGV4dFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc3luY05vZGVGcm9tKGZyb20sIHRvLCBjdHgpIHtcbiAgICAgICAgICAgIGxldCB0eXBlID0gZnJvbS5ub2RlVHlwZTtcblxuICAgICAgICAgICAgLy8gaWYgaXMgYW4gZWxlbWVudCB0eXBlLCBzeW5jIHRoZSBhdHRyaWJ1dGVzIGZyb20gdGhlXG4gICAgICAgICAgICAvLyBuZXcgbm9kZSBpbnRvIHRoZSBuZXcgbm9kZVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IDEgLyogZWxlbWVudCB0eXBlICovKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZnJvbUF0dHJpYnV0ZXMgPSBmcm9tLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9BdHRyaWJ1dGVzID0gdG8uYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZyb21BdHRyaWJ1dGUgb2YgZnJvbUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlnbm9yZUF0dHJpYnV0ZShmcm9tQXR0cmlidXRlLm5hbWUsIHRvLCAndXBkYXRlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvLmdldEF0dHJpYnV0ZShmcm9tQXR0cmlidXRlLm5hbWUpICE9PSBmcm9tQXR0cmlidXRlLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRBdHRyaWJ1dGUoZnJvbUF0dHJpYnV0ZS5uYW1lLCBmcm9tQXR0cmlidXRlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpdGVyYXRlIGJhY2t3YXJkcyB0byBhdm9pZCBza2lwcGluZyBvdmVyIGl0ZW1zIHdoZW4gYSBkZWxldGUgb2NjdXJzXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHRvQXR0cmlidXRlcy5sZW5ndGggLSAxOyAwIDw9IGk7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0b0F0dHJpYnV0ZSA9IHRvQXR0cmlidXRlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlnbm9yZUF0dHJpYnV0ZSh0b0F0dHJpYnV0ZS5uYW1lLCB0bywgJ3JlbW92ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghZnJvbS5oYXNBdHRyaWJ1dGUodG9BdHRyaWJ1dGUubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnJlbW92ZUF0dHJpYnV0ZSh0b0F0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc3luYyB0ZXh0IG5vZGVzXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gOCAvKiBjb21tZW50ICovIHx8IHR5cGUgPT09IDMgLyogdGV4dCAqLykge1xuICAgICAgICAgICAgICAgIGlmICh0by5ub2RlVmFsdWUgIT09IGZyb20ubm9kZVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvLm5vZGVWYWx1ZSA9IGZyb20ubm9kZVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFpZ25vcmVWYWx1ZU9mQWN0aXZlRWxlbWVudCh0bywgY3R4KSkge1xuICAgICAgICAgICAgICAgIC8vIHN5bmMgaW5wdXQgdmFsdWVzXG4gICAgICAgICAgICAgICAgc3luY0lucHV0VmFsdWUoZnJvbSwgdG8sIGN0eCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIGZyb20ge0VsZW1lbnR9IGVsZW1lbnQgdG8gc3luYyB0aGUgdmFsdWUgZnJvbVxuICAgICAgICAgKiBAcGFyYW0gdG8ge0VsZW1lbnR9IGVsZW1lbnQgdG8gc3luYyB0aGUgdmFsdWUgdG9cbiAgICAgICAgICogQHBhcmFtIGF0dHJpYnV0ZU5hbWUge1N0cmluZ30gdGhlIGF0dHJpYnV0ZSBuYW1lXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCBhdHRyaWJ1dGVOYW1lLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChmcm9tW2F0dHJpYnV0ZU5hbWVdICE9PSB0b1thdHRyaWJ1dGVOYW1lXSkge1xuICAgICAgICAgICAgICAgIGxldCBpZ25vcmVVcGRhdGUgPSBpZ25vcmVBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgdG8sICd1cGRhdGUnLCBjdHgpO1xuICAgICAgICAgICAgICAgIGlmICghaWdub3JlVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvW2F0dHJpYnV0ZU5hbWVdID0gZnJvbVthdHRyaWJ1dGVOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZyb21bYXR0cmlidXRlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpZ25vcmVVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLCBmcm9tW2F0dHJpYnV0ZU5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaWdub3JlQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIHRvLCAncmVtb3ZlJywgY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8ucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE5COiBtYW55IGJvdGhhbnMgZGllZCB0byBicmluZyB1cyBpbmZvcm1hdGlvbjpcbiAgICAgICAgICpcbiAgICAgICAgICogIGh0dHBzOi8vZ2l0aHViLmNvbS9wYXRyaWNrLXN0ZWVsZS1pZGVtL21vcnBoZG9tL2Jsb2IvbWFzdGVyL3NyYy9zcGVjaWFsRWxIYW5kbGVycy5qc1xuICAgICAgICAgKiAgaHR0cHM6Ly9naXRodWIuY29tL2Nob29qcy9uYW5vbW9ycGgvYmxvYi9tYXN0ZXIvbGliL21vcnBoLmpzTDExM1xuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gZnJvbSB7RWxlbWVudH0gdGhlIGVsZW1lbnQgdG8gc3luYyB0aGUgaW5wdXQgdmFsdWUgZnJvbVxuICAgICAgICAgKiBAcGFyYW0gdG8ge0VsZW1lbnR9IHRoZSBlbGVtZW50IHRvIHN5bmMgdGhlIGlucHV0IHZhbHVlIHRvXG4gICAgICAgICAqIEBwYXJhbSBjdHggdGhlIG1lcmdlIGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN5bmNJbnB1dFZhbHVlKGZyb20sIHRvLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChmcm9tIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJlxuICAgICAgICAgICAgICAgIHRvIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJlxuICAgICAgICAgICAgICAgIGZyb20udHlwZSAhPT0gJ2ZpbGUnKSB7XG5cbiAgICAgICAgICAgICAgICBsZXQgZnJvbVZhbHVlID0gZnJvbS52YWx1ZTtcbiAgICAgICAgICAgICAgICBsZXQgdG9WYWx1ZSA9IHRvLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgLy8gc3luYyBib29sZWFuIGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICBzeW5jQm9vbGVhbkF0dHJpYnV0ZShmcm9tLCB0bywgJ2NoZWNrZWQnLCBjdHgpO1xuICAgICAgICAgICAgICAgIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCAnZGlzYWJsZWQnLCBjdHgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFmcm9tLmhhc0F0dHJpYnV0ZSgndmFsdWUnKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZUF0dHJpYnV0ZSgndmFsdWUnLCB0bywgJ3JlbW92ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0by5yZW1vdmVBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZyb21WYWx1ZSAhPT0gdG9WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZUF0dHJpYnV0ZSgndmFsdWUnLCB0bywgJ3VwZGF0ZScsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG8udmFsdWUgPSBmcm9tVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZyb20gaW5zdGFuY2VvZiBIVE1MT3B0aW9uRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHN5bmNCb29sZWFuQXR0cmlidXRlKGZyb20sIHRvLCAnc2VsZWN0ZWQnLCBjdHgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChmcm9tIGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudCAmJiB0byBpbnN0YW5jZW9mIEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBsZXQgZnJvbVZhbHVlID0gZnJvbS52YWx1ZTtcbiAgICAgICAgICAgICAgICBsZXQgdG9WYWx1ZSA9IHRvLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChpZ25vcmVBdHRyaWJ1dGUoJ3ZhbHVlJywgdG8sICd1cGRhdGUnLCBjdHgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZyb21WYWx1ZSAhPT0gdG9WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0by52YWx1ZSA9IGZyb21WYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRvLmZpcnN0Q2hpbGQgJiYgdG8uZmlyc3RDaGlsZC5ub2RlVmFsdWUgIT09IGZyb21WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0by5maXJzdENoaWxkLm5vZGVWYWx1ZSA9IGZyb21WYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIHRoZSBIRUFEIHRhZyBjYW4gYmUgaGFuZGxlZCBzcGVjaWFsbHksIGVpdGhlciB3LyBhICdtZXJnZScgb3IgJ2FwcGVuZCcgc3R5bGVcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVIZWFkRWxlbWVudChuZXdIZWFkVGFnLCBjdXJyZW50SGVhZCwgY3R4KSB7XG5cbiAgICAgICAgICAgIGxldCBhZGRlZCA9IFtdO1xuICAgICAgICAgICAgbGV0IHJlbW92ZWQgPSBbXTtcbiAgICAgICAgICAgIGxldCBwcmVzZXJ2ZWQgPSBbXTtcbiAgICAgICAgICAgIGxldCBub2Rlc1RvQXBwZW5kID0gW107XG5cbiAgICAgICAgICAgIGxldCBoZWFkTWVyZ2VTdHlsZSA9IGN0eC5oZWFkLnN0eWxlO1xuXG4gICAgICAgICAgICAvLyBwdXQgYWxsIG5ldyBoZWFkIGVsZW1lbnRzIGludG8gYSBNYXAsIGJ5IHRoZWlyIG91dGVySFRNTFxuICAgICAgICAgICAgbGV0IHNyY1RvTmV3SGVhZE5vZGVzID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuZXdIZWFkQ2hpbGQgb2YgbmV3SGVhZFRhZy5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIHNyY1RvTmV3SGVhZE5vZGVzLnNldChuZXdIZWFkQ2hpbGQub3V0ZXJIVE1MLCBuZXdIZWFkQ2hpbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBmb3IgZWFjaCBlbHQgaW4gdGhlIGN1cnJlbnQgaGVhZFxuICAgICAgICAgICAgZm9yIChjb25zdCBjdXJyZW50SGVhZEVsdCBvZiBjdXJyZW50SGVhZC5jaGlsZHJlbikge1xuXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgaGVhZCBlbGVtZW50IGlzIGluIHRoZSBtYXBcbiAgICAgICAgICAgICAgICBsZXQgaW5OZXdDb250ZW50ID0gc3JjVG9OZXdIZWFkTm9kZXMuaGFzKGN1cnJlbnRIZWFkRWx0Lm91dGVySFRNTCk7XG4gICAgICAgICAgICAgICAgbGV0IGlzUmVBcHBlbmRlZCA9IGN0eC5oZWFkLnNob3VsZFJlQXBwZW5kKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICBsZXQgaXNQcmVzZXJ2ZWQgPSBjdHguaGVhZC5zaG91bGRQcmVzZXJ2ZShjdXJyZW50SGVhZEVsdCk7XG4gICAgICAgICAgICAgICAgaWYgKGluTmV3Q29udGVudCB8fCBpc1ByZXNlcnZlZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNSZUFwcGVuZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIGN1cnJlbnQgdmVyc2lvbiBhbmQgbGV0IHRoZSBuZXcgdmVyc2lvbiByZXBsYWNlIGl0IGFuZCByZS1leGVjdXRlXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkLnB1c2goY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbGVtZW50IGFscmVhZHkgZXhpc3RzIGFuZCBzaG91bGQgbm90IGJlIHJlLWFwcGVuZGVkLCBzbyByZW1vdmUgaXQgZnJvbVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG5ldyBjb250ZW50IG1hcCwgcHJlc2VydmluZyBpdCBpbiB0aGUgRE9NXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmNUb05ld0hlYWROb2Rlcy5kZWxldGUoY3VycmVudEhlYWRFbHQub3V0ZXJIVE1MKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXNlcnZlZC5wdXNoKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoZWFkTWVyZ2VTdHlsZSA9PT0gXCJhcHBlbmRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgYXJlIGFwcGVuZGluZyBhbmQgdGhpcyBleGlzdGluZyBlbGVtZW50IGlzIG5vdCBuZXcgY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gaWYgYW5kIG9ubHkgaWYgaXQgaXMgbWFya2VkIGZvciByZS1hcHBlbmQgZG8gd2UgZG8gYW55dGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1JlQXBwZW5kZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkLnB1c2goY3VycmVudEhlYWRFbHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzVG9BcHBlbmQucHVzaChjdXJyZW50SGVhZEVsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgbWVyZ2UsIHdlIHJlbW92ZSB0aGlzIGNvbnRlbnQgc2luY2UgaXQgaXMgbm90IGluIHRoZSBuZXcgaGVhZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC5oZWFkLnNob3VsZFJlbW92ZShjdXJyZW50SGVhZEVsdCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKGN1cnJlbnRIZWFkRWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUHVzaCB0aGUgcmVtYWluaW5nIG5ldyBoZWFkIGVsZW1lbnRzIGluIHRoZSBNYXAgaW50byB0aGVcbiAgICAgICAgICAgIC8vIG5vZGVzIHRvIGFwcGVuZCB0byB0aGUgaGVhZCB0YWdcbiAgICAgICAgICAgIG5vZGVzVG9BcHBlbmQucHVzaCguLi5zcmNUb05ld0hlYWROb2Rlcy52YWx1ZXMoKSk7XG5cbiAgICAgICAgICAgIGxldCBwcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuZXdOb2RlIG9mIG5vZGVzVG9BcHBlbmQpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3RWx0ID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQobmV3Tm9kZS5vdXRlckhUTUwpLmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZUFkZGVkKG5ld0VsdCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdFbHQuaHJlZiB8fCBuZXdFbHQuc3JjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzb2x2ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChfcmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUgPSBfcmVzb2x2ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RWx0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHByb21pc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRIZWFkLmFwcGVuZENoaWxkKG5ld0VsdCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlQWRkZWQobmV3RWx0KTtcbiAgICAgICAgICAgICAgICAgICAgYWRkZWQucHVzaChuZXdFbHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCByZW1vdmVkIGVsZW1lbnRzLCBhZnRlciB3ZSBoYXZlIGFwcGVuZGVkIHRoZSBuZXcgZWxlbWVudHMgdG8gYXZvaWRcbiAgICAgICAgICAgIC8vIGFkZGl0aW9uYWwgbmV0d29yayByZXF1ZXN0cyBmb3IgdGhpbmdzIGxpa2Ugc3R5bGUgc2hlZXRzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlbW92ZWRFbGVtZW50IG9mIHJlbW92ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmNhbGxiYWNrcy5iZWZvcmVOb2RlUmVtb3ZlZChyZW1vdmVkRWxlbWVudCkgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRIZWFkLnJlbW92ZUNoaWxkKHJlbW92ZWRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgY3R4LmNhbGxiYWNrcy5hZnRlck5vZGVSZW1vdmVkKHJlbW92ZWRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGN0eC5oZWFkLmFmdGVySGVhZE1vcnBoZWQoY3VycmVudEhlYWQsIHthZGRlZDogYWRkZWQsIGtlcHQ6IHByZXNlcnZlZCwgcmVtb3ZlZDogcmVtb3ZlZH0pO1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbm9PcCgpIHtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAgRGVlcCBtZXJnZXMgdGhlIGNvbmZpZyBvYmplY3QgYW5kIHRoZSBJZGlvbW9yb3BoLmRlZmF1bHRzIG9iamVjdCB0b1xuICAgICAgICAgIHByb2R1Y2UgYSBmaW5hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gbWVyZ2VEZWZhdWx0cyhjb25maWcpIHtcbiAgICAgICAgICAgIGxldCBmaW5hbENvbmZpZyA9IHt9O1xuICAgICAgICAgICAgLy8gY29weSB0b3AgbGV2ZWwgc3R1ZmYgaW50byBmaW5hbCBjb25maWdcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmluYWxDb25maWcsIGRlZmF1bHRzKTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmluYWxDb25maWcsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIC8vIGNvcHkgY2FsbGJhY2tzIGludG8gZmluYWwgY29uZmlnIChkbyB0aGlzIHRvIGRlZXAgbWVyZ2UgdGhlIGNhbGxiYWNrcylcbiAgICAgICAgICAgIGZpbmFsQ29uZmlnLmNhbGxiYWNrcyA9IHt9O1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihmaW5hbENvbmZpZy5jYWxsYmFja3MsIGRlZmF1bHRzLmNhbGxiYWNrcyk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGZpbmFsQ29uZmlnLmNhbGxiYWNrcywgY29uZmlnLmNhbGxiYWNrcyk7XG5cbiAgICAgICAgICAgIC8vIGNvcHkgaGVhZCBjb25maWcgaW50byBmaW5hbCBjb25maWcgIChkbyB0aGlzIHRvIGRlZXAgbWVyZ2UgdGhlIGhlYWQpXG4gICAgICAgICAgICBmaW5hbENvbmZpZy5oZWFkID0ge307XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGZpbmFsQ29uZmlnLmhlYWQsIGRlZmF1bHRzLmhlYWQpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihmaW5hbENvbmZpZy5oZWFkLCBjb25maWcuaGVhZCk7XG4gICAgICAgICAgICByZXR1cm4gZmluYWxDb25maWc7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVNb3JwaENvbnRleHQob2xkTm9kZSwgbmV3Q29udGVudCwgY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcgPSBtZXJnZURlZmF1bHRzKGNvbmZpZyk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRhcmdldDogb2xkTm9kZSxcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50OiBuZXdDb250ZW50LFxuICAgICAgICAgICAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgICAgICAgICAgIG1vcnBoU3R5bGU6IGNvbmZpZy5tb3JwaFN0eWxlLFxuICAgICAgICAgICAgICAgIGlnbm9yZUFjdGl2ZTogY29uZmlnLmlnbm9yZUFjdGl2ZSxcbiAgICAgICAgICAgICAgICBpZ25vcmVBY3RpdmVWYWx1ZTogY29uZmlnLmlnbm9yZUFjdGl2ZVZhbHVlLFxuICAgICAgICAgICAgICAgIGlkTWFwOiBjcmVhdGVJZE1hcChvbGROb2RlLCBuZXdDb250ZW50KSxcbiAgICAgICAgICAgICAgICBkZWFkSWRzOiBuZXcgU2V0KCksXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzOiBjb25maWcuY2FsbGJhY2tzLFxuICAgICAgICAgICAgICAgIGhlYWQ6IGNvbmZpZy5oZWFkXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpc0lkU2V0TWF0Y2gobm9kZTEsIG5vZGUyLCBjdHgpIHtcbiAgICAgICAgICAgIGlmIChub2RlMSA9PSBudWxsIHx8IG5vZGUyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9kZTEubm9kZVR5cGUgPT09IG5vZGUyLm5vZGVUeXBlICYmIG5vZGUxLnRhZ05hbWUgPT09IG5vZGUyLnRhZ05hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZTEuaWQgIT09IFwiXCIgJiYgbm9kZTEuaWQgPT09IG5vZGUyLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRJZEludGVyc2VjdGlvbkNvdW50KGN0eCwgbm9kZTEsIG5vZGUyKSA+IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNTb2Z0TWF0Y2gobm9kZTEsIG5vZGUyKSB7XG4gICAgICAgICAgICBpZiAobm9kZTEgPT0gbnVsbCB8fCBub2RlMiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vZGUxLm5vZGVUeXBlID09PSBub2RlMi5ub2RlVHlwZSAmJiBub2RlMS50YWdOYW1lID09PSBub2RlMi50YWdOYW1lXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVOb2Rlc0JldHdlZW4oc3RhcnRJbmNsdXNpdmUsIGVuZEV4Y2x1c2l2ZSwgY3R4KSB7XG4gICAgICAgICAgICB3aGlsZSAoc3RhcnRJbmNsdXNpdmUgIT09IGVuZEV4Y2x1c2l2ZSkge1xuICAgICAgICAgICAgICAgIGxldCB0ZW1wTm9kZSA9IHN0YXJ0SW5jbHVzaXZlO1xuICAgICAgICAgICAgICAgIHN0YXJ0SW5jbHVzaXZlID0gc3RhcnRJbmNsdXNpdmUubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgcmVtb3ZlTm9kZSh0ZW1wTm9kZSwgY3R4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgZW5kRXhjbHVzaXZlKTtcbiAgICAgICAgICAgIHJldHVybiBlbmRFeGNsdXNpdmUubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFNjYW5zIGZvcndhcmQgZnJvbSB0aGUgaW5zZXJ0aW9uUG9pbnQgaW4gdGhlIG9sZCBwYXJlbnQgbG9va2luZyBmb3IgYSBwb3RlbnRpYWwgaWQgbWF0Y2hcbiAgICAgICAgLy8gZm9yIHRoZSBuZXdDaGlsZC4gIFdlIHN0b3AgaWYgd2UgZmluZCBhIHBvdGVudGlhbCBpZCBtYXRjaCBmb3IgdGhlIG5ldyBjaGlsZCBPUlxuICAgICAgICAvLyBpZiB0aGUgbnVtYmVyIG9mIHBvdGVudGlhbCBpZCBtYXRjaGVzIHdlIGFyZSBkaXNjYXJkaW5nIGlzIGdyZWF0ZXIgdGhhbiB0aGVcbiAgICAgICAgLy8gcG90ZW50aWFsIGlkIG1hdGNoZXMgZm9yIHRoZSBuZXcgY2hpbGRcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBmaW5kSWRTZXRNYXRjaChuZXdDb250ZW50LCBvbGRQYXJlbnQsIG5ld0NoaWxkLCBpbnNlcnRpb25Qb2ludCwgY3R4KSB7XG5cbiAgICAgICAgICAgIC8vIG1heCBpZCBtYXRjaGVzIHdlIGFyZSB3aWxsaW5nIHRvIGRpc2NhcmQgaW4gb3VyIHNlYXJjaFxuICAgICAgICAgICAgbGV0IG5ld0NoaWxkUG90ZW50aWFsSWRDb3VudCA9IGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBuZXdDaGlsZCwgb2xkUGFyZW50KTtcblxuICAgICAgICAgICAgbGV0IHBvdGVudGlhbE1hdGNoID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gb25seSBzZWFyY2ggZm9yd2FyZCBpZiB0aGVyZSBpcyBhIHBvc3NpYmlsaXR5IG9mIGFuIGlkIG1hdGNoXG4gICAgICAgICAgICBpZiAobmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgIGxldCBwb3RlbnRpYWxNYXRjaCA9IGluc2VydGlvblBvaW50O1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgcG9zc2liaWxpdHkgb2YgYW4gaWQgbWF0Y2gsIHNjYW4gZm9yd2FyZFxuICAgICAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIHBvdGVudGlhbCBpZCBtYXRjaCBjb3VudCB3ZSBhcmUgZGlzY2FyZGluZyAodGhlXG4gICAgICAgICAgICAgICAgLy8gbmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50IG11c3QgYmUgZ3JlYXRlciB0aGFuIHRoaXMgdG8gbWFrZSBpdCBsaWtlbHlcbiAgICAgICAgICAgICAgICAvLyB3b3J0aCBpdClcbiAgICAgICAgICAgICAgICBsZXQgb3RoZXJNYXRjaENvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAocG90ZW50aWFsTWF0Y2ggIT0gbnVsbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgYW4gaWQgbWF0Y2gsIHJldHVybiB0aGUgY3VycmVudCBwb3RlbnRpYWwgbWF0Y2hcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSWRTZXRNYXRjaChuZXdDaGlsZCwgcG90ZW50aWFsTWF0Y2gsIGN0eCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb3RlbnRpYWxNYXRjaDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbXB1dGVyIHRoZSBvdGhlciBwb3RlbnRpYWwgbWF0Y2hlcyBvZiB0aGlzIG5ldyBjb250ZW50XG4gICAgICAgICAgICAgICAgICAgIG90aGVyTWF0Y2hDb3VudCArPSBnZXRJZEludGVyc2VjdGlvbkNvdW50KGN0eCwgcG90ZW50aWFsTWF0Y2gsIG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJNYXRjaENvdW50ID4gbmV3Q2hpbGRQb3RlbnRpYWxJZENvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIG1vcmUgcG90ZW50aWFsIGlkIG1hdGNoZXMgaW4gX290aGVyXyBjb250ZW50LCB3ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90IGhhdmUgYSBnb29kIGNhbmRpZGF0ZSBmb3IgYW4gaWQgbWF0Y2gsIHNvIHJldHVybiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkdmFuY2VkIHRvIHRoZSBuZXh0IG9sZCBjb250ZW50IGNoaWxkXG4gICAgICAgICAgICAgICAgICAgIHBvdGVudGlhbE1hdGNoID0gcG90ZW50aWFsTWF0Y2gubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBvdGVudGlhbE1hdGNoO1xuICAgICAgICB9XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBTY2FucyBmb3J3YXJkIGZyb20gdGhlIGluc2VydGlvblBvaW50IGluIHRoZSBvbGQgcGFyZW50IGxvb2tpbmcgZm9yIGEgcG90ZW50aWFsIHNvZnQgbWF0Y2hcbiAgICAgICAgLy8gZm9yIHRoZSBuZXdDaGlsZC4gIFdlIHN0b3AgaWYgd2UgZmluZCBhIHBvdGVudGlhbCBzb2Z0IG1hdGNoIGZvciB0aGUgbmV3IGNoaWxkIE9SXG4gICAgICAgIC8vIGlmIHdlIGZpbmQgYSBwb3RlbnRpYWwgaWQgbWF0Y2ggaW4gdGhlIG9sZCBwYXJlbnRzIGNoaWxkcmVuIE9SIGlmIHdlIGZpbmQgdHdvXG4gICAgICAgIC8vIHBvdGVudGlhbCBzb2Z0IG1hdGNoZXMgZm9yIHRoZSBuZXh0IHR3byBwaWVjZXMgb2YgbmV3IGNvbnRlbnRcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBmaW5kU29mdE1hdGNoKG5ld0NvbnRlbnQsIG9sZFBhcmVudCwgbmV3Q2hpbGQsIGluc2VydGlvblBvaW50LCBjdHgpIHtcblxuICAgICAgICAgICAgbGV0IHBvdGVudGlhbFNvZnRNYXRjaCA9IGluc2VydGlvblBvaW50O1xuICAgICAgICAgICAgbGV0IG5leHRTaWJsaW5nID0gbmV3Q2hpbGQubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICBsZXQgc2libGluZ1NvZnRNYXRjaENvdW50ID0gMDtcblxuICAgICAgICAgICAgd2hpbGUgKHBvdGVudGlhbFNvZnRNYXRjaCAhPSBudWxsKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2V0SWRJbnRlcnNlY3Rpb25Db3VudChjdHgsIHBvdGVudGlhbFNvZnRNYXRjaCwgbmV3Q29udGVudCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjdXJyZW50IHBvdGVudGlhbCBzb2Z0IG1hdGNoIGhhcyBhIHBvdGVudGlhbCBpZCBzZXQgbWF0Y2ggd2l0aCB0aGUgcmVtYWluaW5nIG5ld1xuICAgICAgICAgICAgICAgICAgICAvLyBjb250ZW50IHNvIGJhaWwgb3V0IG9mIGxvb2tpbmdcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhIHNvZnQgbWF0Y2ggd2l0aCB0aGUgY3VycmVudCBub2RlLCByZXR1cm4gaXRcbiAgICAgICAgICAgICAgICBpZiAoaXNTb2Z0TWF0Y2gobmV3Q2hpbGQsIHBvdGVudGlhbFNvZnRNYXRjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvdGVudGlhbFNvZnRNYXRjaDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNTb2Z0TWF0Y2gobmV4dFNpYmxpbmcsIHBvdGVudGlhbFNvZnRNYXRjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG5leHQgbmV3IG5vZGUgaGFzIGEgc29mdCBtYXRjaCB3aXRoIHRoaXMgbm9kZSwgc29cbiAgICAgICAgICAgICAgICAgICAgLy8gaW5jcmVtZW50IHRoZSBjb3VudCBvZiBmdXR1cmUgc29mdCBtYXRjaGVzXG4gICAgICAgICAgICAgICAgICAgIHNpYmxpbmdTb2Z0TWF0Y2hDb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSB0d28gZnV0dXJlIHNvZnQgbWF0Y2hlcywgYmFpbCB0byBhbGxvdyB0aGUgc2libGluZ3MgdG8gc29mdCBtYXRjaFxuICAgICAgICAgICAgICAgICAgICAvLyBzbyB0aGF0IHdlIGRvbid0IGNvbnN1bWUgZnV0dXJlIHNvZnQgbWF0Y2hlcyBmb3IgdGhlIHNha2Ugb2YgdGhlIGN1cnJlbnQgbm9kZVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2libGluZ1NvZnRNYXRjaENvdW50ID49IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gYWR2YW5jZWQgdG8gdGhlIG5leHQgb2xkIGNvbnRlbnQgY2hpbGRcbiAgICAgICAgICAgICAgICBwb3RlbnRpYWxTb2Z0TWF0Y2ggPSBwb3RlbnRpYWxTb2Z0TWF0Y2gubmV4dFNpYmxpbmc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBwb3RlbnRpYWxTb2Z0TWF0Y2g7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwYXJzZUNvbnRlbnQobmV3Q29udGVudCkge1xuICAgICAgICAgICAgbGV0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblxuICAgICAgICAgICAgLy8gcmVtb3ZlIHN2Z3MgdG8gYXZvaWQgZmFsc2UtcG9zaXRpdmUgbWF0Y2hlcyBvbiBoZWFkLCBldGMuXG4gICAgICAgICAgICBsZXQgY29udGVudFdpdGhTdmdzUmVtb3ZlZCA9IG5ld0NvbnRlbnQucmVwbGFjZSgvPHN2ZyhcXHNbXj5dKj58PikoW1xcc1xcU10qPyk8XFwvc3ZnPi9naW0sICcnKTtcblxuICAgICAgICAgICAgLy8gaWYgdGhlIG5ld0NvbnRlbnQgY29udGFpbnMgYSBodG1sLCBoZWFkIG9yIGJvZHkgdGFnLCB3ZSBjYW4gc2ltcGx5IHBhcnNlIGl0IHcvbyB3cmFwcGluZ1xuICAgICAgICAgICAgaWYgKGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9odG1sPi8pIHx8IGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9oZWFkPi8pIHx8IGNvbnRlbnRXaXRoU3Znc1JlbW92ZWQubWF0Y2goLzxcXC9ib2R5Pi8pKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKG5ld0NvbnRlbnQsIFwidGV4dC9odG1sXCIpO1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIGEgZnVsbCBIVE1MIGRvY3VtZW50LCByZXR1cm4gdGhlIGRvY3VtZW50IGl0c2VsZiBhcyB0aGUgcGFyZW50IGNvbnRhaW5lclxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50V2l0aFN2Z3NSZW1vdmVkLm1hdGNoKC88XFwvaHRtbD4vKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50LmdlbmVyYXRlZEJ5SWRpb21vcnBoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHJldHVybiB0aGUgaHRtbCBlbGVtZW50IGFzIHRoZSBwYXJlbnQgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgIGxldCBodG1sRWxlbWVudCA9IGNvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGh0bWxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sRWxlbWVudC5nZW5lcmF0ZWRCeUlkaW9tb3JwaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaHRtbEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgcGFydGlhbCBIVE1MLCB3cmFwIGl0IGluIGEgdGVtcGxhdGUgdGFnIHRvIHByb3ZpZGUgYSBwYXJlbnQgZWxlbWVudCBhbmQgYWxzbyB0byBoZWxwXG4gICAgICAgICAgICAgICAgLy8gZGVhbCB3aXRoIHRvdWNoeSB0YWdzIGxpa2UgdHIsIHRib2R5LCBldGMuXG4gICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlRG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhcIjxib2R5Pjx0ZW1wbGF0ZT5cIiArIG5ld0NvbnRlbnQgKyBcIjwvdGVtcGxhdGU+PC9ib2R5PlwiLCBcInRleHQvaHRtbFwiKTtcbiAgICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHJlc3BvbnNlRG9jLmJvZHkucXVlcnlTZWxlY3RvcigndGVtcGxhdGUnKS5jb250ZW50O1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuZ2VuZXJhdGVkQnlJZGlvbW9ycGggPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb250ZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVDb250ZW50KG5ld0NvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmIChuZXdDb250ZW50ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBub2luc3BlY3Rpb24gVW5uZWNlc3NhcnlMb2NhbFZhcmlhYmxlSlNcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teVBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkdW1teVBhcmVudDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV3Q29udGVudC5nZW5lcmF0ZWRCeUlkaW9tb3JwaCkge1xuICAgICAgICAgICAgICAgIC8vIHRoZSB0ZW1wbGF0ZSB0YWcgY3JlYXRlZCBieSBpZGlvbW9ycGggcGFyc2luZyBjYW4gc2VydmUgYXMgYSBkdW1teSBwYXJlbnRcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q29udGVudDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV3Q29udGVudCBpbnN0YW5jZW9mIE5vZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBhIHNpbmdsZSBub2RlIGlzIGFkZGVkIGFzIGEgY2hpbGQgdG8gYSBkdW1teSBwYXJlbnRcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teVBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGR1bW15UGFyZW50LmFwcGVuZChuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZHVtbXlQYXJlbnQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGFsbCBub2RlcyBpbiB0aGUgYXJyYXkgb3IgSFRNTEVsZW1lbnQgY29sbGVjdGlvbiBhcmUgY29uc29saWRhdGVkIHVuZGVyXG4gICAgICAgICAgICAgICAgLy8gYSBzaW5nbGUgZHVtbXkgcGFyZW50IGVsZW1lbnRcbiAgICAgICAgICAgICAgICBjb25zdCBkdW1teVBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWx0IG9mIFsuLi5uZXdDb250ZW50XSkge1xuICAgICAgICAgICAgICAgICAgICBkdW1teVBhcmVudC5hcHBlbmQoZWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGR1bW15UGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5zZXJ0U2libGluZ3MocHJldmlvdXNTaWJsaW5nLCBtb3JwaGVkTm9kZSwgbmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIGxldCBzdGFjayA9IFtdO1xuICAgICAgICAgICAgbGV0IGFkZGVkID0gW107XG4gICAgICAgICAgICB3aGlsZSAocHJldmlvdXNTaWJsaW5nICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzdGFjay5wdXNoKHByZXZpb3VzU2libGluZyk7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNTaWJsaW5nID0gcHJldmlvdXNTaWJsaW5nLnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5vZGUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICBhZGRlZC5wdXNoKG5vZGUpOyAvLyBwdXNoIGFkZGVkIHByZWNlZGluZyBzaWJsaW5ncyBvbiBpbiBvcmRlciBhbmQgaW5zZXJ0XG4gICAgICAgICAgICAgICAgbW9ycGhlZE5vZGUucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUobm9kZSwgbW9ycGhlZE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkZWQucHVzaChtb3JwaGVkTm9kZSk7XG4gICAgICAgICAgICB3aGlsZSAobmV4dFNpYmxpbmcgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2gobmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIGFkZGVkLnB1c2gobmV4dFNpYmxpbmcpOyAvLyBoZXJlIHdlIGFyZSBnb2luZyBpbiBvcmRlciwgc28gcHVzaCBvbiBhcyB3ZSBzY2FuLCByYXRoZXIgdGhhbiBhZGRcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBtb3JwaGVkTm9kZS5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShzdGFjay5wb3AoKSwgbW9ycGhlZE5vZGUubmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFkZGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmluZEJlc3ROb2RlTWF0Y2gobmV3Q29udGVudCwgb2xkTm9kZSwgY3R4KSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudEVsZW1lbnQ7XG4gICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IG5ld0NvbnRlbnQuZmlyc3RDaGlsZDtcbiAgICAgICAgICAgIGxldCBiZXN0RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50O1xuICAgICAgICAgICAgbGV0IHNjb3JlID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxldCBuZXdTY29yZSA9IHNjb3JlRWxlbWVudChjdXJyZW50RWxlbWVudCwgb2xkTm9kZSwgY3R4KTtcbiAgICAgICAgICAgICAgICBpZiAobmV3U2NvcmUgPiBzY29yZSkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBzY29yZSA9IG5ld1Njb3JlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50Lm5leHRTaWJsaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJlc3RFbGVtZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2NvcmVFbGVtZW50KG5vZGUxLCBub2RlMiwgY3R4KSB7XG4gICAgICAgICAgICBpZiAoaXNTb2Z0TWF0Y2gobm9kZTEsIG5vZGUyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAuNSArIGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBub2RlMSwgbm9kZTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVOb2RlKHRlbXBOb2RlLCBjdHgpIHtcbiAgICAgICAgICAgIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgdGVtcE5vZGUpO1xuICAgICAgICAgICAgaWYgKGN0eC5jYWxsYmFja3MuYmVmb3JlTm9kZVJlbW92ZWQodGVtcE5vZGUpID09PSBmYWxzZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICB0ZW1wTm9kZS5yZW1vdmUoKTtcbiAgICAgICAgICAgIGN0eC5jYWxsYmFja3MuYWZ0ZXJOb2RlUmVtb3ZlZCh0ZW1wTm9kZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIElEIFNldCBGdW5jdGlvbnNcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgICAgIGZ1bmN0aW9uIGlzSWRJbkNvbnNpZGVyYXRpb24oY3R4LCBpZCkge1xuICAgICAgICAgICAgcmV0dXJuICFjdHguZGVhZElkcy5oYXMoaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaWRJc1dpdGhpbk5vZGUoY3R4LCBpZCwgdGFyZ2V0Tm9kZSkge1xuICAgICAgICAgICAgbGV0IGlkU2V0ID0gY3R4LmlkTWFwLmdldCh0YXJnZXROb2RlKSB8fCBFTVBUWV9TRVQ7XG4gICAgICAgICAgICByZXR1cm4gaWRTZXQuaGFzKGlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZUlkc0Zyb21Db25zaWRlcmF0aW9uKGN0eCwgbm9kZSkge1xuICAgICAgICAgICAgbGV0IGlkU2V0ID0gY3R4LmlkTWFwLmdldChub2RlKSB8fCBFTVBUWV9TRVQ7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIGlkU2V0KSB7XG4gICAgICAgICAgICAgICAgY3R4LmRlYWRJZHMuYWRkKGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldElkSW50ZXJzZWN0aW9uQ291bnQoY3R4LCBub2RlMSwgbm9kZTIpIHtcbiAgICAgICAgICAgIGxldCBzb3VyY2VTZXQgPSBjdHguaWRNYXAuZ2V0KG5vZGUxKSB8fCBFTVBUWV9TRVQ7XG4gICAgICAgICAgICBsZXQgbWF0Y2hDb3VudCA9IDA7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIHNvdXJjZVNldCkge1xuICAgICAgICAgICAgICAgIC8vIGEgcG90ZW50aWFsIG1hdGNoIGlzIGFuIGlkIGluIHRoZSBzb3VyY2UgYW5kIHBvdGVudGlhbElkc1NldCwgYnV0XG4gICAgICAgICAgICAgICAgLy8gdGhhdCBoYXMgbm90IGFscmVhZHkgYmVlbiBtZXJnZWQgaW50byB0aGUgRE9NXG4gICAgICAgICAgICAgICAgaWYgKGlzSWRJbkNvbnNpZGVyYXRpb24oY3R4LCBpZCkgJiYgaWRJc1dpdGhpbk5vZGUoY3R4LCBpZCwgbm9kZTIpKSB7XG4gICAgICAgICAgICAgICAgICAgICsrbWF0Y2hDb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hDb3VudDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGJvdHRvbSB1cCBhbGdvcml0aG0gdGhhdCBmaW5kcyBhbGwgZWxlbWVudHMgd2l0aCBpZHMgaW5zaWRlIG9mIHRoZSBub2RlXG4gICAgICAgICAqIGFyZ3VtZW50IGFuZCBwb3B1bGF0ZXMgaWQgc2V0cyBmb3IgdGhvc2Ugbm9kZXMgYW5kIGFsbCB0aGVpciBwYXJlbnRzLCBnZW5lcmF0aW5nXG4gICAgICAgICAqIGEgc2V0IG9mIGlkcyBjb250YWluZWQgd2l0aGluIGFsbCBub2RlcyBmb3IgdGhlIGVudGlyZSBoaWVyYXJjaHkgaW4gdGhlIERPTVxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gbm9kZSB7RWxlbWVudH1cbiAgICAgICAgICogQHBhcmFtIHtNYXA8Tm9kZSwgU2V0PFN0cmluZz4+fSBpZE1hcFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcG9wdWxhdGVJZE1hcEZvck5vZGUobm9kZSwgaWRNYXApIHtcbiAgICAgICAgICAgIGxldCBub2RlUGFyZW50ID0gbm9kZS5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgLy8gZmluZCBhbGwgZWxlbWVudHMgd2l0aCBhbiBpZCBwcm9wZXJ0eVxuICAgICAgICAgICAgbGV0IGlkRWxlbWVudHMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tpZF0nKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZWx0IG9mIGlkRWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IGVsdDtcbiAgICAgICAgICAgICAgICAvLyB3YWxrIHVwIHRoZSBwYXJlbnQgaGllcmFyY2h5IG9mIHRoYXQgZWxlbWVudCwgYWRkaW5nIHRoZSBpZFxuICAgICAgICAgICAgICAgIC8vIG9mIGVsZW1lbnQgdG8gdGhlIHBhcmVudCdzIGlkIHNldFxuICAgICAgICAgICAgICAgIHdoaWxlIChjdXJyZW50ICE9PSBub2RlUGFyZW50ICYmIGN1cnJlbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaWRTZXQgPSBpZE1hcC5nZXQoY3VycmVudCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBpZCBzZXQgZG9lc24ndCBleGlzdCwgY3JlYXRlIGl0IGFuZCBpbnNlcnQgaXQgaW4gdGhlICBtYXBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkU2V0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkU2V0ID0gbmV3IFNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWRNYXAuc2V0KGN1cnJlbnQsIGlkU2V0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZFNldC5hZGQoZWx0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhpcyBmdW5jdGlvbiBjb21wdXRlcyBhIG1hcCBvZiBub2RlcyB0byBhbGwgaWRzIGNvbnRhaW5lZCB3aXRoaW4gdGhhdCBub2RlIChpbmNsdXNpdmUgb2YgdGhlXG4gICAgICAgICAqIG5vZGUpLiAgVGhpcyBtYXAgY2FuIGJlIHVzZWQgdG8gYXNrIGlmIHR3byBub2RlcyBoYXZlIGludGVyc2VjdGluZyBzZXRzIG9mIGlkcywgd2hpY2ggYWxsb3dzXG4gICAgICAgICAqIGZvciBhIGxvb3NlciBkZWZpbml0aW9uIG9mIFwibWF0Y2hpbmdcIiB0aGFuIHRyYWRpdGlvbiBpZCBtYXRjaGluZywgYW5kIGFsbG93cyBjaGlsZCBub2Rlc1xuICAgICAgICAgKiB0byBjb250cmlidXRlIHRvIGEgcGFyZW50IG5vZGVzIG1hdGNoaW5nLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG9sZENvbnRlbnQgIHRoZSBvbGQgY29udGVudCB0aGF0IHdpbGwgYmUgbW9ycGhlZFxuICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5ld0NvbnRlbnQgIHRoZSBuZXcgY29udGVudCB0byBtb3JwaCB0b1xuICAgICAgICAgKiBAcmV0dXJucyB7TWFwPE5vZGUsIFNldDxTdHJpbmc+Pn0gYSBtYXAgb2Ygbm9kZXMgdG8gaWQgc2V0cyBmb3IgdGhlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBjcmVhdGVJZE1hcChvbGRDb250ZW50LCBuZXdDb250ZW50KSB7XG4gICAgICAgICAgICBsZXQgaWRNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBwb3B1bGF0ZUlkTWFwRm9yTm9kZShvbGRDb250ZW50LCBpZE1hcCk7XG4gICAgICAgICAgICBwb3B1bGF0ZUlkTWFwRm9yTm9kZShuZXdDb250ZW50LCBpZE1hcCk7XG4gICAgICAgICAgICByZXR1cm4gaWRNYXA7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFRoaXMgaXMgd2hhdCBlbmRzIHVwIGJlY29taW5nIHRoZSBJZGlvbW9ycGggZ2xvYmFsIG9iamVjdFxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtb3JwaCxcbiAgICAgICAgICAgIGRlZmF1bHRzXG4gICAgICAgIH1cbiAgICB9KSgpO1xuXG5mdW5jdGlvbiBtb3JwaEVsZW1lbnRzKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50LCB7IGNhbGxiYWNrcywgLi4ub3B0aW9ucyB9ID0ge30pIHtcbiAgSWRpb21vcnBoLm1vcnBoKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50LCB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBjYWxsYmFja3M6IG5ldyBEZWZhdWx0SWRpb21vcnBoQ2FsbGJhY2tzKGNhbGxiYWNrcylcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG1vcnBoQ2hpbGRyZW4oY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgbW9ycGhFbGVtZW50cyhjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudC5jaGlsZHJlbiwge1xuICAgIG1vcnBoU3R5bGU6IFwiaW5uZXJIVE1MXCJcbiAgfSk7XG59XG5cbmNsYXNzIERlZmF1bHRJZGlvbW9ycGhDYWxsYmFja3Mge1xuICAjYmVmb3JlTm9kZU1vcnBoZWRcblxuICBjb25zdHJ1Y3Rvcih7IGJlZm9yZU5vZGVNb3JwaGVkIH0gPSB7fSkge1xuICAgIHRoaXMuI2JlZm9yZU5vZGVNb3JwaGVkID0gYmVmb3JlTm9kZU1vcnBoZWQgfHwgKCgpID0+IHRydWUpO1xuICB9XG5cbiAgYmVmb3JlTm9kZUFkZGVkID0gKG5vZGUpID0+IHtcbiAgICByZXR1cm4gIShub2RlLmlkICYmIG5vZGUuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1wZXJtYW5lbnRcIikgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobm9kZS5pZCkpXG4gIH1cblxuICBiZWZvcmVOb2RlTW9ycGhlZCA9IChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkgPT4ge1xuICAgIGlmIChjdXJyZW50RWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgIGlmICghY3VycmVudEVsZW1lbnQuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1wZXJtYW5lbnRcIikgJiYgdGhpcy4jYmVmb3JlTm9kZU1vcnBoZWQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtbW9ycGgtZWxlbWVudFwiLCB7XG4gICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgICAgICB0YXJnZXQ6IGN1cnJlbnRFbGVtZW50LFxuICAgICAgICAgIGRldGFpbDogeyBjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYmVmb3JlQXR0cmlidXRlVXBkYXRlZCA9IChhdHRyaWJ1dGVOYW1lLCB0YXJnZXQsIG11dGF0aW9uVHlwZSkgPT4ge1xuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtbW9ycGgtYXR0cmlidXRlXCIsIHtcbiAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICB0YXJnZXQsXG4gICAgICBkZXRhaWw6IHsgYXR0cmlidXRlTmFtZSwgbXV0YXRpb25UeXBlIH1cbiAgICB9KTtcblxuICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICB9XG5cbiAgYmVmb3JlTm9kZVJlbW92ZWQgPSAobm9kZSkgPT4ge1xuICAgIHJldHVybiB0aGlzLmJlZm9yZU5vZGVNb3JwaGVkKG5vZGUpXG4gIH1cblxuICBhZnRlck5vZGVNb3JwaGVkID0gKGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSA9PiB7XG4gICAgaWYgKGN1cnJlbnRFbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgZGlzcGF0Y2goXCJ0dXJibzptb3JwaC1lbGVtZW50XCIsIHtcbiAgICAgICAgdGFyZ2V0OiBjdXJyZW50RWxlbWVudCxcbiAgICAgICAgZGV0YWlsOiB7IGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50IH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBNb3JwaGluZ0ZyYW1lUmVuZGVyZXIgZXh0ZW5kcyBGcmFtZVJlbmRlcmVyIHtcbiAgc3RhdGljIHJlbmRlckVsZW1lbnQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgICBkaXNwYXRjaChcInR1cmJvOmJlZm9yZS1mcmFtZS1tb3JwaFwiLCB7XG4gICAgICB0YXJnZXQ6IGN1cnJlbnRFbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50IH1cbiAgICB9KTtcblxuICAgIG1vcnBoQ2hpbGRyZW4oY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpO1xuICB9XG5cbiAgYXN5bmMgcHJlc2VydmluZ1Blcm1hbmVudEVsZW1lbnRzKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIGF3YWl0IGNhbGxiYWNrKClcbiAgfVxufVxuXG5jbGFzcyBQcm9ncmVzc0JhciB7XG4gIHN0YXRpYyBhbmltYXRpb25EdXJhdGlvbiA9IDMwMCAvKm1zKi9cblxuICBzdGF0aWMgZ2V0IGRlZmF1bHRDU1MoKSB7XG4gICAgcmV0dXJuIHVuaW5kZW50YFxuICAgICAgLnR1cmJvLXByb2dyZXNzLWJhciB7XG4gICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgIHRvcDogMDtcbiAgICAgICAgbGVmdDogMDtcbiAgICAgICAgaGVpZ2h0OiAzcHg7XG4gICAgICAgIGJhY2tncm91bmQ6ICMwMDc2ZmY7XG4gICAgICAgIHotaW5kZXg6IDIxNDc0ODM2NDc7XG4gICAgICAgIHRyYW5zaXRpb246XG4gICAgICAgICAgd2lkdGggJHtQcm9ncmVzc0Jhci5hbmltYXRpb25EdXJhdGlvbn1tcyBlYXNlLW91dCxcbiAgICAgICAgICBvcGFjaXR5ICR7UHJvZ3Jlc3NCYXIuYW5pbWF0aW9uRHVyYXRpb24gLyAyfW1zICR7UHJvZ3Jlc3NCYXIuYW5pbWF0aW9uRHVyYXRpb24gLyAyfW1zIGVhc2UtaW47XG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoMCwgMCwgMCk7XG4gICAgICB9XG4gICAgYFxuICB9XG5cbiAgaGlkaW5nID0gZmFsc2VcbiAgdmFsdWUgPSAwXG4gIHZpc2libGUgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3R5bGVzaGVldEVsZW1lbnQgPSB0aGlzLmNyZWF0ZVN0eWxlc2hlZXRFbGVtZW50KCk7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQgPSB0aGlzLmNyZWF0ZVByb2dyZXNzRWxlbWVudCgpO1xuICAgIHRoaXMuaW5zdGFsbFN0eWxlc2hlZXRFbGVtZW50KCk7XG4gICAgdGhpcy5zZXRWYWx1ZSgwKTtcbiAgfVxuXG4gIHNob3coKSB7XG4gICAgaWYgKCF0aGlzLnZpc2libGUpIHtcbiAgICAgIHRoaXMudmlzaWJsZSA9IHRydWU7XG4gICAgICB0aGlzLmluc3RhbGxQcm9ncmVzc0VsZW1lbnQoKTtcbiAgICAgIHRoaXMuc3RhcnRUcmlja2xpbmcoKTtcbiAgICB9XG4gIH1cblxuICBoaWRlKCkge1xuICAgIGlmICh0aGlzLnZpc2libGUgJiYgIXRoaXMuaGlkaW5nKSB7XG4gICAgICB0aGlzLmhpZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmZhZGVQcm9ncmVzc0VsZW1lbnQoKCkgPT4ge1xuICAgICAgICB0aGlzLnVuaW5zdGFsbFByb2dyZXNzRWxlbWVudCgpO1xuICAgICAgICB0aGlzLnN0b3BUcmlja2xpbmcoKTtcbiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaGlkaW5nID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBzZXRWYWx1ZSh2YWx1ZSkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBpbnN0YWxsU3R5bGVzaGVldEVsZW1lbnQoKSB7XG4gICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUodGhpcy5zdHlsZXNoZWV0RWxlbWVudCwgZG9jdW1lbnQuaGVhZC5maXJzdENoaWxkKTtcbiAgfVxuXG4gIGluc3RhbGxQcm9ncmVzc0VsZW1lbnQoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBcIjBcIjtcbiAgICB0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gXCIxXCI7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lmluc2VydEJlZm9yZSh0aGlzLnByb2dyZXNzRWxlbWVudCwgZG9jdW1lbnQuYm9keSk7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gIH1cblxuICBmYWRlUHJvZ3Jlc3NFbGVtZW50KGNhbGxiYWNrKSB7XG4gICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUub3BhY2l0eSA9IFwiMFwiO1xuICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIFByb2dyZXNzQmFyLmFuaW1hdGlvbkR1cmF0aW9uICogMS41KTtcbiAgfVxuXG4gIHVuaW5zdGFsbFByb2dyZXNzRWxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5wcm9ncmVzc0VsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMucHJvZ3Jlc3NFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBzdGFydFRyaWNrbGluZygpIHtcbiAgICBpZiAoIXRoaXMudHJpY2tsZUludGVydmFsKSB7XG4gICAgICB0aGlzLnRyaWNrbGVJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLnRyaWNrbGUsIFByb2dyZXNzQmFyLmFuaW1hdGlvbkR1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICBzdG9wVHJpY2tsaW5nKCkge1xuICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudHJpY2tsZUludGVydmFsKTtcbiAgICBkZWxldGUgdGhpcy50cmlja2xlSW50ZXJ2YWw7XG4gIH1cblxuICB0cmlja2xlID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0VmFsdWUodGhpcy52YWx1ZSArIE1hdGgucmFuZG9tKCkgLyAxMDApO1xuICB9XG5cbiAgcmVmcmVzaCgpIHtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBgJHsxMCArIHRoaXMudmFsdWUgKiA5MH0lYDtcbiAgICB9KTtcbiAgfVxuXG4gIGNyZWF0ZVN0eWxlc2hlZXRFbGVtZW50KCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgZWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSBQcm9ncmVzc0Jhci5kZWZhdWx0Q1NTO1xuICAgIGNvbnN0IGNzcE5vbmNlID0gZ2V0Q3NwTm9uY2UoKTtcbiAgICBpZiAoY3NwTm9uY2UpIHtcbiAgICAgIGVsZW1lbnQubm9uY2UgPSBjc3BOb25jZTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuXG4gIGNyZWF0ZVByb2dyZXNzRWxlbWVudCgpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBlbGVtZW50LmNsYXNzTmFtZSA9IFwidHVyYm8tcHJvZ3Jlc3MtYmFyXCI7XG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxufVxuXG5jbGFzcyBIZWFkU25hcHNob3QgZXh0ZW5kcyBTbmFwc2hvdCB7XG4gIGRldGFpbHNCeU91dGVySFRNTCA9IHRoaXMuY2hpbGRyZW5cbiAgICAuZmlsdGVyKChlbGVtZW50KSA9PiAhZWxlbWVudElzTm9zY3JpcHQoZWxlbWVudCkpXG4gICAgLm1hcCgoZWxlbWVudCkgPT4gZWxlbWVudFdpdGhvdXROb25jZShlbGVtZW50KSlcbiAgICAucmVkdWNlKChyZXN1bHQsIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgb3V0ZXJIVE1MIH0gPSBlbGVtZW50O1xuICAgICAgY29uc3QgZGV0YWlscyA9XG4gICAgICAgIG91dGVySFRNTCBpbiByZXN1bHRcbiAgICAgICAgICA/IHJlc3VsdFtvdXRlckhUTUxdXG4gICAgICAgICAgOiB7XG4gICAgICAgICAgICAgIHR5cGU6IGVsZW1lbnRUeXBlKGVsZW1lbnQpLFxuICAgICAgICAgICAgICB0cmFja2VkOiBlbGVtZW50SXNUcmFja2VkKGVsZW1lbnQpLFxuICAgICAgICAgICAgICBlbGVtZW50czogW11cbiAgICAgICAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgIFtvdXRlckhUTUxdOiB7XG4gICAgICAgICAgLi4uZGV0YWlscyxcbiAgICAgICAgICBlbGVtZW50czogWy4uLmRldGFpbHMuZWxlbWVudHMsIGVsZW1lbnRdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB7fSlcblxuICBnZXQgdHJhY2tlZEVsZW1lbnRTaWduYXR1cmUoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MKVxuICAgICAgLmZpbHRlcigob3V0ZXJIVE1MKSA9PiB0aGlzLmRldGFpbHNCeU91dGVySFRNTFtvdXRlckhUTUxdLnRyYWNrZWQpXG4gICAgICAuam9pbihcIlwiKVxuICB9XG5cbiAgZ2V0U2NyaXB0RWxlbWVudHNOb3RJblNuYXBzaG90KHNuYXBzaG90KSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudHNNYXRjaGluZ1R5cGVOb3RJblNuYXBzaG90KFwic2NyaXB0XCIsIHNuYXBzaG90KVxuICB9XG5cbiAgZ2V0U3R5bGVzaGVldEVsZW1lbnRzTm90SW5TbmFwc2hvdChzbmFwc2hvdCkge1xuICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRzTWF0Y2hpbmdUeXBlTm90SW5TbmFwc2hvdChcInN0eWxlc2hlZXRcIiwgc25hcHNob3QpXG4gIH1cblxuICBnZXRFbGVtZW50c01hdGNoaW5nVHlwZU5vdEluU25hcHNob3QobWF0Y2hlZFR5cGUsIHNuYXBzaG90KSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MKVxuICAgICAgLmZpbHRlcigob3V0ZXJIVE1MKSA9PiAhKG91dGVySFRNTCBpbiBzbmFwc2hvdC5kZXRhaWxzQnlPdXRlckhUTUwpKVxuICAgICAgLm1hcCgob3V0ZXJIVE1MKSA9PiB0aGlzLmRldGFpbHNCeU91dGVySFRNTFtvdXRlckhUTUxdKVxuICAgICAgLmZpbHRlcigoeyB0eXBlIH0pID0+IHR5cGUgPT0gbWF0Y2hlZFR5cGUpXG4gICAgICAubWFwKCh7IGVsZW1lbnRzOiBbZWxlbWVudF0gfSkgPT4gZWxlbWVudClcbiAgfVxuXG4gIGdldCBwcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmRldGFpbHNCeU91dGVySFRNTCkucmVkdWNlKChyZXN1bHQsIG91dGVySFRNTCkgPT4ge1xuICAgICAgY29uc3QgeyB0eXBlLCB0cmFja2VkLCBlbGVtZW50cyB9ID0gdGhpcy5kZXRhaWxzQnlPdXRlckhUTUxbb3V0ZXJIVE1MXTtcbiAgICAgIGlmICh0eXBlID09IG51bGwgJiYgIXRyYWNrZWQpIHtcbiAgICAgICAgcmV0dXJuIFsuLi5yZXN1bHQsIC4uLmVsZW1lbnRzXVxuICAgICAgfSBlbHNlIGlmIChlbGVtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHJldHVybiBbLi4ucmVzdWx0LCAuLi5lbGVtZW50cy5zbGljZSgxKV1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH1cbiAgICB9LCBbXSlcbiAgfVxuXG4gIGdldE1ldGFWYWx1ZShuYW1lKSB7XG4gICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZmluZE1ldGFFbGVtZW50QnlOYW1lKG5hbWUpO1xuICAgIHJldHVybiBlbGVtZW50ID8gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIpIDogbnVsbFxuICB9XG5cbiAgZmluZE1ldGFFbGVtZW50QnlOYW1lKG5hbWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5kZXRhaWxzQnlPdXRlckhUTUwpLnJlZHVjZSgocmVzdWx0LCBvdXRlckhUTUwpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZWxlbWVudHM6IFtlbGVtZW50XVxuICAgICAgfSA9IHRoaXMuZGV0YWlsc0J5T3V0ZXJIVE1MW291dGVySFRNTF07XG4gICAgICByZXR1cm4gZWxlbWVudElzTWV0YUVsZW1lbnRXaXRoTmFtZShlbGVtZW50LCBuYW1lKSA/IGVsZW1lbnQgOiByZXN1bHRcbiAgICB9LCB1bmRlZmluZWQgfCB1bmRlZmluZWQpXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudFR5cGUoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudElzU2NyaXB0KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFwic2NyaXB0XCJcbiAgfSBlbHNlIGlmIChlbGVtZW50SXNTdHlsZXNoZWV0KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFwic3R5bGVzaGVldFwiXG4gIH1cbn1cblxuZnVuY3Rpb24gZWxlbWVudElzVHJhY2tlZChlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tdHJhY2tcIikgPT0gXCJyZWxvYWRcIlxufVxuXG5mdW5jdGlvbiBlbGVtZW50SXNTY3JpcHQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwic2NyaXB0XCJcbn1cblxuZnVuY3Rpb24gZWxlbWVudElzTm9zY3JpcHQoZWxlbWVudCkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwibm9zY3JpcHRcIlxufVxuXG5mdW5jdGlvbiBlbGVtZW50SXNTdHlsZXNoZWV0KGVsZW1lbnQpIHtcbiAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQubG9jYWxOYW1lO1xuICByZXR1cm4gdGFnTmFtZSA9PSBcInN0eWxlXCIgfHwgKHRhZ05hbWUgPT0gXCJsaW5rXCIgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJyZWxcIikgPT0gXCJzdHlsZXNoZWV0XCIpXG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRJc01ldGFFbGVtZW50V2l0aE5hbWUoZWxlbWVudCwgbmFtZSkge1xuICBjb25zdCB0YWdOYW1lID0gZWxlbWVudC5sb2NhbE5hbWU7XG4gIHJldHVybiB0YWdOYW1lID09IFwibWV0YVwiICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSA9PSBuYW1lXG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRXaXRob3V0Tm9uY2UoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJub25jZVwiKSkge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwibm9uY2VcIiwgXCJcIik7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudFxufVxuXG5jbGFzcyBQYWdlU25hcHNob3QgZXh0ZW5kcyBTbmFwc2hvdCB7XG4gIHN0YXRpYyBmcm9tSFRNTFN0cmluZyhodG1sID0gXCJcIikge1xuICAgIHJldHVybiB0aGlzLmZyb21Eb2N1bWVudChwYXJzZUhUTUxEb2N1bWVudChodG1sKSlcbiAgfVxuXG4gIHN0YXRpYyBmcm9tRWxlbWVudChlbGVtZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuZnJvbURvY3VtZW50KGVsZW1lbnQub3duZXJEb2N1bWVudClcbiAgfVxuXG4gIHN0YXRpYyBmcm9tRG9jdW1lbnQoeyBkb2N1bWVudEVsZW1lbnQsIGJvZHksIGhlYWQgfSkge1xuICAgIHJldHVybiBuZXcgdGhpcyhkb2N1bWVudEVsZW1lbnQsIGJvZHksIG5ldyBIZWFkU25hcHNob3QoaGVhZCkpXG4gIH1cblxuICBjb25zdHJ1Y3Rvcihkb2N1bWVudEVsZW1lbnQsIGJvZHksIGhlYWRTbmFwc2hvdCkge1xuICAgIHN1cGVyKGJvZHkpO1xuICAgIHRoaXMuZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnRFbGVtZW50O1xuICAgIHRoaXMuaGVhZFNuYXBzaG90ID0gaGVhZFNuYXBzaG90O1xuICB9XG5cbiAgY2xvbmUoKSB7XG4gICAgY29uc3QgY2xvbmVkRWxlbWVudCA9IHRoaXMuZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICBjb25zdCBzZWxlY3RFbGVtZW50cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0XCIpO1xuICAgIGNvbnN0IGNsb25lZFNlbGVjdEVsZW1lbnRzID0gY2xvbmVkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0XCIpO1xuXG4gICAgZm9yIChjb25zdCBbaW5kZXgsIHNvdXJjZV0gb2Ygc2VsZWN0RWxlbWVudHMuZW50cmllcygpKSB7XG4gICAgICBjb25zdCBjbG9uZSA9IGNsb25lZFNlbGVjdEVsZW1lbnRzW2luZGV4XTtcbiAgICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIGNsb25lLnNlbGVjdGVkT3B0aW9ucykgb3B0aW9uLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBzb3VyY2Uuc2VsZWN0ZWRPcHRpb25zKSBjbG9uZS5vcHRpb25zW29wdGlvbi5pbmRleF0uc2VsZWN0ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgY2xvbmVkUGFzc3dvcmRJbnB1dCBvZiBjbG9uZWRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJwYXNzd29yZFwiXScpKSB7XG4gICAgICBjbG9uZWRQYXNzd29yZElucHV0LnZhbHVlID0gXCJcIjtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFBhZ2VTbmFwc2hvdCh0aGlzLmRvY3VtZW50RWxlbWVudCwgY2xvbmVkRWxlbWVudCwgdGhpcy5oZWFkU25hcHNob3QpXG4gIH1cblxuICBnZXQgbGFuZygpIHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibGFuZ1wiKVxuICB9XG5cbiAgZ2V0IGhlYWRFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLmhlYWRTbmFwc2hvdC5lbGVtZW50XG4gIH1cblxuICBnZXQgcm9vdExvY2F0aW9uKCkge1xuICAgIGNvbnN0IHJvb3QgPSB0aGlzLmdldFNldHRpbmcoXCJyb290XCIpID8/IFwiL1wiO1xuICAgIHJldHVybiBleHBhbmRVUkwocm9vdClcbiAgfVxuXG4gIGdldCBjYWNoZUNvbnRyb2xWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKFwiY2FjaGUtY29udHJvbFwiKVxuICB9XG5cbiAgZ2V0IGlzUHJldmlld2FibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FjaGVDb250cm9sVmFsdWUgIT0gXCJuby1wcmV2aWV3XCJcbiAgfVxuXG4gIGdldCBpc0NhY2hlYWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZUNvbnRyb2xWYWx1ZSAhPSBcIm5vLWNhY2hlXCJcbiAgfVxuXG4gIGdldCBpc1Zpc2l0YWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKFwidmlzaXQtY29udHJvbFwiKSAhPSBcInJlbG9hZFwiXG4gIH1cblxuICBnZXQgcHJlZmVyc1ZpZXdUcmFuc2l0aW9ucygpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkU25hcHNob3QuZ2V0TWV0YVZhbHVlKFwidmlldy10cmFuc2l0aW9uXCIpID09PSBcInNhbWUtb3JpZ2luXCJcbiAgfVxuXG4gIGdldCBzaG91bGRNb3JwaFBhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U2V0dGluZyhcInJlZnJlc2gtbWV0aG9kXCIpID09PSBcIm1vcnBoXCJcbiAgfVxuXG4gIGdldCBzaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmdldFNldHRpbmcoXCJyZWZyZXNoLXNjcm9sbFwiKSA9PT0gXCJwcmVzZXJ2ZVwiXG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgZ2V0U2V0dGluZyhuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZFNuYXBzaG90LmdldE1ldGFWYWx1ZShgdHVyYm8tJHtuYW1lfWApXG4gIH1cbn1cblxuY2xhc3MgVmlld1RyYW5zaXRpb25lciB7XG4gICN2aWV3VHJhbnNpdGlvblN0YXJ0ZWQgPSBmYWxzZVxuICAjbGFzdE9wZXJhdGlvbiA9IFByb21pc2UucmVzb2x2ZSgpXG5cbiAgcmVuZGVyQ2hhbmdlKHVzZVZpZXdUcmFuc2l0aW9uLCByZW5kZXIpIHtcbiAgICBpZiAodXNlVmlld1RyYW5zaXRpb24gJiYgdGhpcy52aWV3VHJhbnNpdGlvbnNBdmFpbGFibGUgJiYgIXRoaXMuI3ZpZXdUcmFuc2l0aW9uU3RhcnRlZCkge1xuICAgICAgdGhpcy4jdmlld1RyYW5zaXRpb25TdGFydGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuI2xhc3RPcGVyYXRpb24gPSB0aGlzLiNsYXN0T3BlcmF0aW9uLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBkb2N1bWVudC5zdGFydFZpZXdUcmFuc2l0aW9uKHJlbmRlcikuZmluaXNoZWQ7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4jbGFzdE9wZXJhdGlvbiA9IHRoaXMuI2xhc3RPcGVyYXRpb24udGhlbihyZW5kZXIpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLiNsYXN0T3BlcmF0aW9uXG4gIH1cblxuICBnZXQgdmlld1RyYW5zaXRpb25zQXZhaWxhYmxlKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5zdGFydFZpZXdUcmFuc2l0aW9uXG4gIH1cbn1cblxuY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gIGFjdGlvbjogXCJhZHZhbmNlXCIsXG4gIGhpc3RvcnlDaGFuZ2VkOiBmYWxzZSxcbiAgdmlzaXRDYWNoZWRTbmFwc2hvdDogKCkgPT4ge30sXG4gIHdpbGxSZW5kZXI6IHRydWUsXG4gIHVwZGF0ZUhpc3Rvcnk6IHRydWUsXG4gIHNob3VsZENhY2hlU25hcHNob3Q6IHRydWUsXG4gIGFjY2VwdHNTdHJlYW1SZXNwb25zZTogZmFsc2Vcbn07XG5cbmNvbnN0IFRpbWluZ01ldHJpYyA9IHtcbiAgdmlzaXRTdGFydDogXCJ2aXNpdFN0YXJ0XCIsXG4gIHJlcXVlc3RTdGFydDogXCJyZXF1ZXN0U3RhcnRcIixcbiAgcmVxdWVzdEVuZDogXCJyZXF1ZXN0RW5kXCIsXG4gIHZpc2l0RW5kOiBcInZpc2l0RW5kXCJcbn07XG5cbmNvbnN0IFZpc2l0U3RhdGUgPSB7XG4gIGluaXRpYWxpemVkOiBcImluaXRpYWxpemVkXCIsXG4gIHN0YXJ0ZWQ6IFwic3RhcnRlZFwiLFxuICBjYW5jZWxlZDogXCJjYW5jZWxlZFwiLFxuICBmYWlsZWQ6IFwiZmFpbGVkXCIsXG4gIGNvbXBsZXRlZDogXCJjb21wbGV0ZWRcIlxufTtcblxuY29uc3QgU3lzdGVtU3RhdHVzQ29kZSA9IHtcbiAgbmV0d29ya0ZhaWx1cmU6IDAsXG4gIHRpbWVvdXRGYWlsdXJlOiAtMSxcbiAgY29udGVudFR5cGVNaXNtYXRjaDogLTJcbn07XG5cbmNvbnN0IERpcmVjdGlvbiA9IHtcbiAgYWR2YW5jZTogXCJmb3J3YXJkXCIsXG4gIHJlc3RvcmU6IFwiYmFja1wiLFxuICByZXBsYWNlOiBcIm5vbmVcIlxufTtcblxuY2xhc3MgVmlzaXQge1xuICBpZGVudGlmaWVyID0gdXVpZCgpIC8vIFJlcXVpcmVkIGJ5IHR1cmJvLWlvc1xuICB0aW1pbmdNZXRyaWNzID0ge31cblxuICBmb2xsb3dlZFJlZGlyZWN0ID0gZmFsc2VcbiAgaGlzdG9yeUNoYW5nZWQgPSBmYWxzZVxuICBzY3JvbGxlZCA9IGZhbHNlXG4gIHNob3VsZENhY2hlU25hcHNob3QgPSB0cnVlXG4gIGFjY2VwdHNTdHJlYW1SZXNwb25zZSA9IGZhbHNlXG4gIHNuYXBzaG90Q2FjaGVkID0gZmFsc2VcbiAgc3RhdGUgPSBWaXNpdFN0YXRlLmluaXRpYWxpemVkXG4gIHZpZXdUcmFuc2l0aW9uZXIgPSBuZXcgVmlld1RyYW5zaXRpb25lcigpXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgICB0aGlzLmxvY2F0aW9uID0gbG9jYXRpb247XG4gICAgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIgPSByZXN0b3JhdGlvbklkZW50aWZpZXIgfHwgdXVpZCgpO1xuXG4gICAgY29uc3Qge1xuICAgICAgYWN0aW9uLFxuICAgICAgaGlzdG9yeUNoYW5nZWQsXG4gICAgICByZWZlcnJlcixcbiAgICAgIHNuYXBzaG90LFxuICAgICAgc25hcHNob3RIVE1MLFxuICAgICAgcmVzcG9uc2UsXG4gICAgICB2aXNpdENhY2hlZFNuYXBzaG90LFxuICAgICAgd2lsbFJlbmRlcixcbiAgICAgIHVwZGF0ZUhpc3RvcnksXG4gICAgICBzaG91bGRDYWNoZVNuYXBzaG90LFxuICAgICAgYWNjZXB0c1N0cmVhbVJlc3BvbnNlLFxuICAgICAgZGlyZWN0aW9uXG4gICAgfSA9IHtcbiAgICAgIC4uLmRlZmF1bHRPcHRpb25zLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH07XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG4gICAgdGhpcy5oaXN0b3J5Q2hhbmdlZCA9IGhpc3RvcnlDaGFuZ2VkO1xuICAgIHRoaXMucmVmZXJyZXIgPSByZWZlcnJlcjtcbiAgICB0aGlzLnNuYXBzaG90ID0gc25hcHNob3Q7XG4gICAgdGhpcy5zbmFwc2hvdEhUTUwgPSBzbmFwc2hvdEhUTUw7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMuaXNTYW1lUGFnZSA9IHRoaXMuZGVsZWdhdGUubG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZSh0aGlzLmxvY2F0aW9uLCB0aGlzLmFjdGlvbik7XG4gICAgdGhpcy5pc1BhZ2VSZWZyZXNoID0gdGhpcy52aWV3LmlzUGFnZVJlZnJlc2godGhpcyk7XG4gICAgdGhpcy52aXNpdENhY2hlZFNuYXBzaG90ID0gdmlzaXRDYWNoZWRTbmFwc2hvdDtcbiAgICB0aGlzLndpbGxSZW5kZXIgPSB3aWxsUmVuZGVyO1xuICAgIHRoaXMudXBkYXRlSGlzdG9yeSA9IHVwZGF0ZUhpc3Rvcnk7XG4gICAgdGhpcy5zY3JvbGxlZCA9ICF3aWxsUmVuZGVyO1xuICAgIHRoaXMuc2hvdWxkQ2FjaGVTbmFwc2hvdCA9IHNob3VsZENhY2hlU25hcHNob3Q7XG4gICAgdGhpcy5hY2NlcHRzU3RyZWFtUmVzcG9uc2UgPSBhY2NlcHRzU3RyZWFtUmVzcG9uc2U7XG4gICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb24gfHwgRGlyZWN0aW9uW2FjdGlvbl07XG4gIH1cblxuICBnZXQgYWRhcHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5hZGFwdGVyXG4gIH1cblxuICBnZXQgdmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS52aWV3XG4gIH1cblxuICBnZXQgaGlzdG9yeSgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5XG4gIH1cblxuICBnZXQgcmVzdG9yYXRpb25EYXRhKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkuZ2V0UmVzdG9yYXRpb25EYXRhRm9ySWRlbnRpZmllcih0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllcilcbiAgfVxuXG4gIGdldCBzaWxlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNTYW1lUGFnZVxuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gVmlzaXRTdGF0ZS5pbml0aWFsaXplZCkge1xuICAgICAgdGhpcy5yZWNvcmRUaW1pbmdNZXRyaWMoVGltaW5nTWV0cmljLnZpc2l0U3RhcnQpO1xuICAgICAgdGhpcy5zdGF0ZSA9IFZpc2l0U3RhdGUuc3RhcnRlZDtcbiAgICAgIHRoaXMuYWRhcHRlci52aXNpdFN0YXJ0ZWQodGhpcyk7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpc2l0U3RhcnRlZCh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gVmlzaXRTdGF0ZS5zdGFydGVkKSB7XG4gICAgICBpZiAodGhpcy5yZXF1ZXN0KSB7XG4gICAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2FuY2VsUmVuZGVyKCk7XG4gICAgICB0aGlzLnN0YXRlID0gVmlzaXRTdGF0ZS5jYW5jZWxlZDtcbiAgICB9XG4gIH1cblxuICBjb21wbGV0ZSgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBWaXNpdFN0YXRlLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy52aXNpdEVuZCk7XG4gICAgICB0aGlzLmFkYXB0ZXIudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgICB0aGlzLnN0YXRlID0gVmlzaXRTdGF0ZS5jb21wbGV0ZWQ7XG4gICAgICB0aGlzLmZvbGxvd1JlZGlyZWN0KCk7XG5cbiAgICAgIGlmICghdGhpcy5mb2xsb3dlZFJlZGlyZWN0KSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZmFpbCgpIHtcbiAgICBpZiAodGhpcy5zdGF0ZSA9PSBWaXNpdFN0YXRlLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBWaXNpdFN0YXRlLmZhaWxlZDtcbiAgICAgIHRoaXMuYWRhcHRlci52aXNpdEZhaWxlZCh0aGlzKTtcbiAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRDb21wbGV0ZWQodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgY2hhbmdlSGlzdG9yeSgpIHtcbiAgICBpZiAoIXRoaXMuaGlzdG9yeUNoYW5nZWQgJiYgdGhpcy51cGRhdGVIaXN0b3J5KSB7XG4gICAgICBjb25zdCBhY3Rpb25Gb3JIaXN0b3J5ID0gdGhpcy5sb2NhdGlvbi5ocmVmID09PSB0aGlzLnJlZmVycmVyPy5ocmVmID8gXCJyZXBsYWNlXCIgOiB0aGlzLmFjdGlvbjtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGdldEhpc3RvcnlNZXRob2RGb3JBY3Rpb24oYWN0aW9uRm9ySGlzdG9yeSk7XG4gICAgICB0aGlzLmhpc3RvcnkudXBkYXRlKG1ldGhvZCwgdGhpcy5sb2NhdGlvbiwgdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIpO1xuICAgICAgdGhpcy5oaXN0b3J5Q2hhbmdlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgaXNzdWVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLmhhc1ByZWxvYWRlZFJlc3BvbnNlKCkpIHtcbiAgICAgIHRoaXMuc2ltdWxhdGVSZXF1ZXN0KCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnNob3VsZElzc3VlUmVxdWVzdCgpICYmICF0aGlzLnJlcXVlc3QpIHtcbiAgICAgIHRoaXMucmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QodGhpcywgRmV0Y2hNZXRob2QuZ2V0LCB0aGlzLmxvY2F0aW9uKTtcbiAgICAgIHRoaXMucmVxdWVzdC5wZXJmb3JtKCk7XG4gICAgfVxuICB9XG5cbiAgc2ltdWxhdGVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLnJlc3BvbnNlKSB7XG4gICAgICB0aGlzLnN0YXJ0UmVxdWVzdCgpO1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSgpO1xuICAgICAgdGhpcy5maW5pc2hSZXF1ZXN0KCk7XG4gICAgfVxuICB9XG5cbiAgc3RhcnRSZXF1ZXN0KCkge1xuICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy5yZXF1ZXN0U3RhcnQpO1xuICAgIHRoaXMuYWRhcHRlci52aXNpdFJlcXVlc3RTdGFydGVkKHRoaXMpO1xuICB9XG5cbiAgcmVjb3JkUmVzcG9uc2UocmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlKSB7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgY29uc3QgeyBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICAgIGlmIChpc1N1Y2Nlc3NmdWwoc3RhdHVzQ29kZSkpIHtcbiAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVxdWVzdENvbXBsZXRlZCh0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYWRhcHRlci52aXNpdFJlcXVlc3RGYWlsZWRXaXRoU3RhdHVzQ29kZSh0aGlzLCBzdGF0dXNDb2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmaW5pc2hSZXF1ZXN0KCkge1xuICAgIHRoaXMucmVjb3JkVGltaW5nTWV0cmljKFRpbWluZ01ldHJpYy5yZXF1ZXN0RW5kKTtcbiAgICB0aGlzLmFkYXB0ZXIudmlzaXRSZXF1ZXN0RmluaXNoZWQodGhpcyk7XG4gIH1cblxuICBsb2FkUmVzcG9uc2UoKSB7XG4gICAgaWYgKHRoaXMucmVzcG9uc2UpIHtcbiAgICAgIGNvbnN0IHsgc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MIH0gPSB0aGlzLnJlc3BvbnNlO1xuICAgICAgdGhpcy5yZW5kZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zaG91bGRDYWNoZVNuYXBzaG90KSB0aGlzLmNhY2hlU25hcHNob3QoKTtcbiAgICAgICAgaWYgKHRoaXMudmlldy5yZW5kZXJQcm9taXNlKSBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUHJvbWlzZTtcblxuICAgICAgICBpZiAoaXNTdWNjZXNzZnVsKHN0YXR1c0NvZGUpICYmIHJlc3BvbnNlSFRNTCAhPSBudWxsKSB7XG4gICAgICAgICAgY29uc3Qgc25hcHNob3QgPSBQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclBhZ2VTbmFwc2hvdChzbmFwc2hvdCwgZmFsc2UpO1xuXG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJFcnJvcihQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKSwgdGhpcyk7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgdGhpcy5mYWlsKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGdldENhY2hlZFNuYXBzaG90KCkge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy52aWV3LmdldENhY2hlZFNuYXBzaG90Rm9yTG9jYXRpb24odGhpcy5sb2NhdGlvbikgfHwgdGhpcy5nZXRQcmVsb2FkZWRTbmFwc2hvdCgpO1xuXG4gICAgaWYgKHNuYXBzaG90ICYmICghZ2V0QW5jaG9yKHRoaXMubG9jYXRpb24pIHx8IHNuYXBzaG90Lmhhc0FuY2hvcihnZXRBbmNob3IodGhpcy5sb2NhdGlvbikpKSkge1xuICAgICAgaWYgKHRoaXMuYWN0aW9uID09IFwicmVzdG9yZVwiIHx8IHNuYXBzaG90LmlzUHJldmlld2FibGUpIHtcbiAgICAgICAgcmV0dXJuIHNuYXBzaG90XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0UHJlbG9hZGVkU25hcHNob3QoKSB7XG4gICAgaWYgKHRoaXMuc25hcHNob3RIVE1MKSB7XG4gICAgICByZXR1cm4gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHRoaXMuc25hcHNob3RIVE1MKVxuICAgIH1cbiAgfVxuXG4gIGhhc0NhY2hlZFNuYXBzaG90KCkge1xuICAgIHJldHVybiB0aGlzLmdldENhY2hlZFNuYXBzaG90KCkgIT0gbnVsbFxuICB9XG5cbiAgbG9hZENhY2hlZFNuYXBzaG90KCkge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy5nZXRDYWNoZWRTbmFwc2hvdCgpO1xuICAgIGlmIChzbmFwc2hvdCkge1xuICAgICAgY29uc3QgaXNQcmV2aWV3ID0gdGhpcy5zaG91bGRJc3N1ZVJlcXVlc3QoKTtcbiAgICAgIHRoaXMucmVuZGVyKGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5jYWNoZVNuYXBzaG90KCk7XG4gICAgICAgIGlmICh0aGlzLmlzU2FtZVBhZ2UgfHwgdGhpcy5pc1BhZ2VSZWZyZXNoKSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHRoaXMudmlldy5yZW5kZXJQcm9taXNlKSBhd2FpdCB0aGlzLnZpZXcucmVuZGVyUHJvbWlzZTtcblxuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyUGFnZVNuYXBzaG90KHNuYXBzaG90LCBpc1ByZXZpZXcpO1xuXG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UmVuZGVyZWQodGhpcyk7XG4gICAgICAgICAgaWYgKCFpc1ByZXZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZvbGxvd1JlZGlyZWN0KCkge1xuICAgIGlmICh0aGlzLnJlZGlyZWN0ZWRUb0xvY2F0aW9uICYmICF0aGlzLmZvbGxvd2VkUmVkaXJlY3QgJiYgdGhpcy5yZXNwb25zZT8ucmVkaXJlY3RlZCkge1xuICAgICAgdGhpcy5hZGFwdGVyLnZpc2l0UHJvcG9zZWRUb0xvY2F0aW9uKHRoaXMucmVkaXJlY3RlZFRvTG9jYXRpb24sIHtcbiAgICAgICAgYWN0aW9uOiBcInJlcGxhY2VcIixcbiAgICAgICAgcmVzcG9uc2U6IHRoaXMucmVzcG9uc2UsXG4gICAgICAgIHNob3VsZENhY2hlU25hcHNob3Q6IGZhbHNlLFxuICAgICAgICB3aWxsUmVuZGVyOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICB0aGlzLmZvbGxvd2VkUmVkaXJlY3QgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGdvVG9TYW1lUGFnZUFuY2hvcigpIHtcbiAgICBpZiAodGhpcy5pc1NhbWVQYWdlKSB7XG4gICAgICB0aGlzLnJlbmRlcihhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2FjaGVTbmFwc2hvdCgpO1xuICAgICAgICB0aGlzLnBlcmZvcm1TY3JvbGwoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VIaXN0b3J5KCk7XG4gICAgICAgIHRoaXMuYWRhcHRlci52aXNpdFJlbmRlcmVkKHRoaXMpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gRmV0Y2ggcmVxdWVzdCBkZWxlZ2F0ZVxuXG4gIHByZXBhcmVSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBpZiAodGhpcy5hY2NlcHRzU3RyZWFtUmVzcG9uc2UpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKCkge1xuICAgIHRoaXMuc3RhcnRSZXF1ZXN0KCk7XG4gIH1cblxuICByZXF1ZXN0UHJldmVudGVkSGFuZGxpbmdSZXNwb25zZShfcmVxdWVzdCwgX3Jlc3BvbnNlKSB7fVxuXG4gIGFzeW5jIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICBpZiAocmVzcG9uc2VIVE1MID09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSh7XG4gICAgICAgIHN0YXR1c0NvZGU6IFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaCxcbiAgICAgICAgcmVkaXJlY3RlZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVkaXJlY3RlZFRvTG9jYXRpb24gPSByZXNwb25zZS5yZWRpcmVjdGVkID8gcmVzcG9uc2UubG9jYXRpb24gOiB1bmRlZmluZWQ7XG4gICAgICB0aGlzLnJlY29yZFJlc3BvbnNlKHsgc3RhdHVzQ29kZTogc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MLCByZWRpcmVjdGVkIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RGYWlsZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgY29uc3QgeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlIH0gPSByZXNwb25zZTtcbiAgICBpZiAocmVzcG9uc2VIVE1MID09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5yZWNvcmRSZXNwb25zZSh7XG4gICAgICAgIHN0YXR1c0NvZGU6IFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaCxcbiAgICAgICAgcmVkaXJlY3RlZFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVjb3JkUmVzcG9uc2UoeyBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLCByZXNwb25zZUhUTUwsIHJlZGlyZWN0ZWQgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdEVycm9yZWQoX3JlcXVlc3QsIF9lcnJvcikge1xuICAgIHRoaXMucmVjb3JkUmVzcG9uc2Uoe1xuICAgICAgc3RhdHVzQ29kZTogU3lzdGVtU3RhdHVzQ29kZS5uZXR3b3JrRmFpbHVyZSxcbiAgICAgIHJlZGlyZWN0ZWQ6IGZhbHNlXG4gICAgfSk7XG4gIH1cblxuICByZXF1ZXN0RmluaXNoZWQoKSB7XG4gICAgdGhpcy5maW5pc2hSZXF1ZXN0KCk7XG4gIH1cblxuICAvLyBTY3JvbGxpbmdcblxuICBwZXJmb3JtU2Nyb2xsKCkge1xuICAgIGlmICghdGhpcy5zY3JvbGxlZCAmJiAhdGhpcy52aWV3LmZvcmNlUmVsb2FkZWQgJiYgIXRoaXMudmlldy5zaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKHRoaXMpKSB7XG4gICAgICBpZiAodGhpcy5hY3Rpb24gPT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb1Jlc3RvcmVkUG9zaXRpb24oKSB8fCB0aGlzLnNjcm9sbFRvQW5jaG9yKCkgfHwgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNjcm9sbFRvQW5jaG9yKCkgfHwgdGhpcy52aWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5pc1NhbWVQYWdlKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbih0aGlzLnZpZXcubGFzdFJlbmRlcmVkTG9jYXRpb24sIHRoaXMubG9jYXRpb24pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNjcm9sbGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzY3JvbGxUb1Jlc3RvcmVkUG9zaXRpb24oKSB7XG4gICAgY29uc3QgeyBzY3JvbGxQb3NpdGlvbiB9ID0gdGhpcy5yZXN0b3JhdGlvbkRhdGE7XG4gICAgaWYgKHNjcm9sbFBvc2l0aW9uKSB7XG4gICAgICB0aGlzLnZpZXcuc2Nyb2xsVG9Qb3NpdGlvbihzY3JvbGxQb3NpdGlvbik7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIHNjcm9sbFRvQW5jaG9yKCkge1xuICAgIGNvbnN0IGFuY2hvciA9IGdldEFuY2hvcih0aGlzLmxvY2F0aW9uKTtcbiAgICBpZiAoYW5jaG9yICE9IG51bGwpIHtcbiAgICAgIHRoaXMudmlldy5zY3JvbGxUb0FuY2hvcihhbmNob3IpO1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cblxuICAvLyBJbnN0cnVtZW50YXRpb25cblxuICByZWNvcmRUaW1pbmdNZXRyaWMobWV0cmljKSB7XG4gICAgdGhpcy50aW1pbmdNZXRyaWNzW21ldHJpY10gPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgfVxuXG4gIGdldFRpbWluZ01ldHJpY3MoKSB7XG4gICAgcmV0dXJuIHsgLi4udGhpcy50aW1pbmdNZXRyaWNzIH1cbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBnZXRIaXN0b3J5TWV0aG9kRm9yQWN0aW9uKGFjdGlvbikge1xuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlIFwicmVwbGFjZVwiOlxuICAgICAgICByZXR1cm4gaGlzdG9yeS5yZXBsYWNlU3RhdGVcbiAgICAgIGNhc2UgXCJhZHZhbmNlXCI6XG4gICAgICBjYXNlIFwicmVzdG9yZVwiOlxuICAgICAgICByZXR1cm4gaGlzdG9yeS5wdXNoU3RhdGVcbiAgICB9XG4gIH1cblxuICBoYXNQcmVsb2FkZWRSZXNwb25zZSgpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaXMucmVzcG9uc2UgPT0gXCJvYmplY3RcIlxuICB9XG5cbiAgc2hvdWxkSXNzdWVSZXF1ZXN0KCkge1xuICAgIGlmICh0aGlzLmlzU2FtZVBhZ2UpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0gZWxzZSBpZiAodGhpcy5hY3Rpb24gPT0gXCJyZXN0b3JlXCIpIHtcbiAgICAgIHJldHVybiAhdGhpcy5oYXNDYWNoZWRTbmFwc2hvdCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLndpbGxSZW5kZXJcbiAgICB9XG4gIH1cblxuICBjYWNoZVNuYXBzaG90KCkge1xuICAgIGlmICghdGhpcy5zbmFwc2hvdENhY2hlZCkge1xuICAgICAgdGhpcy52aWV3LmNhY2hlU25hcHNob3QodGhpcy5zbmFwc2hvdCkudGhlbigoc25hcHNob3QpID0+IHNuYXBzaG90ICYmIHRoaXMudmlzaXRDYWNoZWRTbmFwc2hvdChzbmFwc2hvdCkpO1xuICAgICAgdGhpcy5zbmFwc2hvdENhY2hlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVuZGVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5jYW5jZWxSZW5kZXIoKTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy5mcmFtZSA9XG4gICAgICAgIGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gXCJoaWRkZW5cIiA/IHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZSgpLCAwKSA6IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiByZXNvbHZlKCkpO1xuICAgIH0pO1xuICAgIGF3YWl0IGNhbGxiYWNrKCk7XG4gICAgZGVsZXRlIHRoaXMuZnJhbWU7XG4gIH1cblxuICBhc3luYyByZW5kZXJQYWdlU25hcHNob3Qoc25hcHNob3QsIGlzUHJldmlldykge1xuICAgIGF3YWl0IHRoaXMudmlld1RyYW5zaXRpb25lci5yZW5kZXJDaGFuZ2UodGhpcy52aWV3LnNob3VsZFRyYW5zaXRpb25UbyhzbmFwc2hvdCksIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJQYWdlKHNuYXBzaG90LCBpc1ByZXZpZXcsIHRoaXMud2lsbFJlbmRlciwgdGhpcyk7XG4gICAgICB0aGlzLnBlcmZvcm1TY3JvbGwoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNhbmNlbFJlbmRlcigpIHtcbiAgICBpZiAodGhpcy5mcmFtZSkge1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5mcmFtZSk7XG4gICAgICBkZWxldGUgdGhpcy5mcmFtZTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNTdWNjZXNzZnVsKHN0YXR1c0NvZGUpIHtcbiAgcmV0dXJuIHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDBcbn1cblxuY2xhc3MgQnJvd3NlckFkYXB0ZXIge1xuICBwcm9ncmVzc0JhciA9IG5ldyBQcm9ncmVzc0JhcigpXG5cbiAgY29uc3RydWN0b3Ioc2Vzc2lvbikge1xuICAgIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247XG4gIH1cblxuICB2aXNpdFByb3Bvc2VkVG9Mb2NhdGlvbihsb2NhdGlvbiwgb3B0aW9ucykge1xuICAgIGlmIChsb2NhdGlvbklzVmlzaXRhYmxlKGxvY2F0aW9uLCB0aGlzLm5hdmlnYXRvci5yb290TG9jYXRpb24pKSB7XG4gICAgICB0aGlzLm5hdmlnYXRvci5zdGFydFZpc2l0KGxvY2F0aW9uLCBvcHRpb25zPy5yZXN0b3JhdGlvbklkZW50aWZpZXIgfHwgdXVpZCgpLCBvcHRpb25zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBsb2NhdGlvbi50b1N0cmluZygpO1xuICAgIH1cbiAgfVxuXG4gIHZpc2l0U3RhcnRlZCh2aXNpdCkge1xuICAgIHRoaXMubG9jYXRpb24gPSB2aXNpdC5sb2NhdGlvbjtcbiAgICB2aXNpdC5sb2FkQ2FjaGVkU25hcHNob3QoKTtcbiAgICB2aXNpdC5pc3N1ZVJlcXVlc3QoKTtcbiAgICB2aXNpdC5nb1RvU2FtZVBhZ2VBbmNob3IoKTtcbiAgfVxuXG4gIHZpc2l0UmVxdWVzdFN0YXJ0ZWQodmlzaXQpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDApO1xuICAgIGlmICh2aXNpdC5oYXNDYWNoZWRTbmFwc2hvdCgpIHx8IHZpc2l0LmFjdGlvbiAhPSBcInJlc3RvcmVcIikge1xuICAgICAgdGhpcy5zaG93VmlzaXRQcm9ncmVzc0JhckFmdGVyRGVsYXkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zaG93UHJvZ3Jlc3NCYXIoKTtcbiAgICB9XG4gIH1cblxuICB2aXNpdFJlcXVlc3RDb21wbGV0ZWQodmlzaXQpIHtcbiAgICB2aXNpdC5sb2FkUmVzcG9uc2UoKTtcbiAgfVxuXG4gIHZpc2l0UmVxdWVzdEZhaWxlZFdpdGhTdGF0dXNDb2RlKHZpc2l0LCBzdGF0dXNDb2RlKSB7XG4gICAgc3dpdGNoIChzdGF0dXNDb2RlKSB7XG4gICAgICBjYXNlIFN5c3RlbVN0YXR1c0NvZGUubmV0d29ya0ZhaWx1cmU6XG4gICAgICBjYXNlIFN5c3RlbVN0YXR1c0NvZGUudGltZW91dEZhaWx1cmU6XG4gICAgICBjYXNlIFN5c3RlbVN0YXR1c0NvZGUuY29udGVudFR5cGVNaXNtYXRjaDpcbiAgICAgICAgcmV0dXJuIHRoaXMucmVsb2FkKHtcbiAgICAgICAgICByZWFzb246IFwicmVxdWVzdF9mYWlsZWRcIixcbiAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICBzdGF0dXNDb2RlXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHZpc2l0LmxvYWRSZXNwb25zZSgpXG4gICAgfVxuICB9XG5cbiAgdmlzaXRSZXF1ZXN0RmluaXNoZWQoX3Zpc2l0KSB7fVxuXG4gIHZpc2l0Q29tcGxldGVkKF92aXNpdCkge1xuICAgIHRoaXMucHJvZ3Jlc3NCYXIuc2V0VmFsdWUoMSk7XG4gICAgdGhpcy5oaWRlVmlzaXRQcm9ncmVzc0JhcigpO1xuICB9XG5cbiAgcGFnZUludmFsaWRhdGVkKHJlYXNvbikge1xuICAgIHRoaXMucmVsb2FkKHJlYXNvbik7XG4gIH1cblxuICB2aXNpdEZhaWxlZChfdmlzaXQpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDEpO1xuICAgIHRoaXMuaGlkZVZpc2l0UHJvZ3Jlc3NCYXIoKTtcbiAgfVxuXG4gIHZpc2l0UmVuZGVyZWQoX3Zpc2l0KSB7fVxuXG4gIC8vIEZvcm0gU3VibWlzc2lvbiBEZWxlZ2F0ZVxuXG4gIGZvcm1TdWJtaXNzaW9uU3RhcnRlZChfZm9ybVN1Ym1pc3Npb24pIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNldFZhbHVlKDApO1xuICAgIHRoaXMuc2hvd0Zvcm1Qcm9ncmVzc0JhckFmdGVyRGVsYXkoKTtcbiAgfVxuXG4gIGZvcm1TdWJtaXNzaW9uRmluaXNoZWQoX2Zvcm1TdWJtaXNzaW9uKSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5zZXRWYWx1ZSgxKTtcbiAgICB0aGlzLmhpZGVGb3JtUHJvZ3Jlc3NCYXIoKTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBzaG93VmlzaXRQcm9ncmVzc0JhckFmdGVyRGVsYXkoKSB7XG4gICAgdGhpcy52aXNpdFByb2dyZXNzQmFyVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KHRoaXMuc2hvd1Byb2dyZXNzQmFyLCB0aGlzLnNlc3Npb24ucHJvZ3Jlc3NCYXJEZWxheSk7XG4gIH1cblxuICBoaWRlVmlzaXRQcm9ncmVzc0JhcigpIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLmhpZGUoKTtcbiAgICBpZiAodGhpcy52aXNpdFByb2dyZXNzQmFyVGltZW91dCAhPSBudWxsKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudmlzaXRQcm9ncmVzc0JhclRpbWVvdXQpO1xuICAgICAgZGVsZXRlIHRoaXMudmlzaXRQcm9ncmVzc0JhclRpbWVvdXQ7XG4gICAgfVxuICB9XG5cbiAgc2hvd0Zvcm1Qcm9ncmVzc0JhckFmdGVyRGVsYXkoKSB7XG4gICAgaWYgKHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dCA9PSBudWxsKSB7XG4gICAgICB0aGlzLmZvcm1Qcm9ncmVzc0JhclRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCh0aGlzLnNob3dQcm9ncmVzc0JhciwgdGhpcy5zZXNzaW9uLnByb2dyZXNzQmFyRGVsYXkpO1xuICAgIH1cbiAgfVxuXG4gIGhpZGVGb3JtUHJvZ3Jlc3NCYXIoKSB7XG4gICAgdGhpcy5wcm9ncmVzc0Jhci5oaWRlKCk7XG4gICAgaWYgKHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dCAhPSBudWxsKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuZm9ybVByb2dyZXNzQmFyVGltZW91dCk7XG4gICAgICBkZWxldGUgdGhpcy5mb3JtUHJvZ3Jlc3NCYXJUaW1lb3V0O1xuICAgIH1cbiAgfVxuXG4gIHNob3dQcm9ncmVzc0JhciA9ICgpID0+IHtcbiAgICB0aGlzLnByb2dyZXNzQmFyLnNob3coKTtcbiAgfVxuXG4gIHJlbG9hZChyZWFzb24pIHtcbiAgICBkaXNwYXRjaChcInR1cmJvOnJlbG9hZFwiLCB7IGRldGFpbDogcmVhc29uIH0pO1xuXG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB0aGlzLmxvY2F0aW9uPy50b1N0cmluZygpIHx8IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICB9XG5cbiAgZ2V0IG5hdmlnYXRvcigpIHtcbiAgICByZXR1cm4gdGhpcy5zZXNzaW9uLm5hdmlnYXRvclxuICB9XG59XG5cbmNsYXNzIENhY2hlT2JzZXJ2ZXIge1xuICBzZWxlY3RvciA9IFwiW2RhdGEtdHVyYm8tdGVtcG9yYXJ5XVwiXG4gIGRlcHJlY2F0ZWRTZWxlY3RvciA9IFwiW2RhdGEtdHVyYm8tY2FjaGU9ZmFsc2VdXCJcblxuICBzdGFydGVkID0gZmFsc2VcblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtY2FjaGVcIiwgdGhpcy5yZW1vdmVUZW1wb3JhcnlFbGVtZW50cywgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWNhY2hlXCIsIHRoaXMucmVtb3ZlVGVtcG9yYXJ5RWxlbWVudHMsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVUZW1wb3JhcnlFbGVtZW50cyA9IChfZXZlbnQpID0+IHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy50ZW1wb3JhcnlFbGVtZW50cykge1xuICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICBnZXQgdGVtcG9yYXJ5RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2VsZWN0b3IpLCAuLi50aGlzLnRlbXBvcmFyeUVsZW1lbnRzV2l0aERlcHJlY2F0aW9uXVxuICB9XG5cbiAgZ2V0IHRlbXBvcmFyeUVsZW1lbnRzV2l0aERlcHJlY2F0aW9uKCkge1xuICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLmRlcHJlY2F0ZWRTZWxlY3Rvcik7XG5cbiAgICBpZiAoZWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBUaGUgJHt0aGlzLmRlcHJlY2F0ZWRTZWxlY3Rvcn0gc2VsZWN0b3IgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24uIFVzZSAke3RoaXMuc2VsZWN0b3J9IGluc3RlYWQuYFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gWy4uLmVsZW1lbnRzXVxuICB9XG59XG5cbmNsYXNzIEZyYW1lUmVkaXJlY3RvciB7XG4gIGNvbnN0cnVjdG9yKHNlc3Npb24sIGVsZW1lbnQpIHtcbiAgICB0aGlzLnNlc3Npb24gPSBzZXNzaW9uO1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5saW5rSW50ZXJjZXB0b3IgPSBuZXcgTGlua0ludGVyY2VwdG9yKHRoaXMsIGVsZW1lbnQpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyID0gbmV3IEZvcm1TdWJtaXRPYnNlcnZlcih0aGlzLCBlbGVtZW50KTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yLnN0YXJ0KCk7XG4gICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RvcCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyLnN0b3AoKTtcbiAgfVxuXG4gIC8vIExpbmsgaW50ZXJjZXB0b3IgZGVsZWdhdGVcblxuICBzaG91bGRJbnRlcmNlcHRMaW5rQ2xpY2soZWxlbWVudCwgX2xvY2F0aW9uLCBfZXZlbnQpIHtcbiAgICByZXR1cm4gdGhpcy4jc2hvdWxkUmVkaXJlY3QoZWxlbWVudClcbiAgfVxuXG4gIGxpbmtDbGlja0ludGVyY2VwdGVkKGVsZW1lbnQsIHVybCwgZXZlbnQpIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgaWYgKGZyYW1lKSB7XG4gICAgICBmcmFtZS5kZWxlZ2F0ZS5saW5rQ2xpY2tJbnRlcmNlcHRlZChlbGVtZW50LCB1cmwsIGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pdCBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxTdWJtaXRGb3JtKGVsZW1lbnQsIHN1Ym1pdHRlcikge1xuICAgIHJldHVybiAoXG4gICAgICBlbGVtZW50LmNsb3Nlc3QoXCJ0dXJiby1mcmFtZVwiKSA9PSBudWxsICYmXG4gICAgICB0aGlzLiNzaG91bGRTdWJtaXQoZWxlbWVudCwgc3VibWl0dGVyKSAmJlxuICAgICAgdGhpcy4jc2hvdWxkUmVkaXJlY3QoZWxlbWVudCwgc3VibWl0dGVyKVxuICAgIClcbiAgfVxuXG4gIGZvcm1TdWJtaXR0ZWQoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgaWYgKGZyYW1lKSB7XG4gICAgICBmcmFtZS5kZWxlZ2F0ZS5mb3JtU3VibWl0dGVkKGVsZW1lbnQsIHN1Ym1pdHRlcik7XG4gICAgfVxuICB9XG5cbiAgI3Nob3VsZFN1Ym1pdChmb3JtLCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBhY3Rpb24gPSBnZXRBY3Rpb24kMShmb3JtLCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IG1ldGEgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBtZXRhW25hbWU9XCJ0dXJiby1yb290XCJdYCk7XG4gICAgY29uc3Qgcm9vdExvY2F0aW9uID0gZXhwYW5kVVJMKG1ldGE/LmNvbnRlbnQgPz8gXCIvXCIpO1xuXG4gICAgcmV0dXJuIHRoaXMuI3Nob3VsZFJlZGlyZWN0KGZvcm0sIHN1Ym1pdHRlcikgJiYgbG9jYXRpb25Jc1Zpc2l0YWJsZShhY3Rpb24sIHJvb3RMb2NhdGlvbilcbiAgfVxuXG4gICNzaG91bGRSZWRpcmVjdChlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBpc05hdmlnYXRhYmxlID1cbiAgICAgIGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnRcbiAgICAgICAgPyB0aGlzLnNlc3Npb24uc3VibWlzc2lvbklzTmF2aWdhdGFibGUoZWxlbWVudCwgc3VibWl0dGVyKVxuICAgICAgICA6IHRoaXMuc2Vzc2lvbi5lbGVtZW50SXNOYXZpZ2F0YWJsZShlbGVtZW50KTtcblxuICAgIGlmIChpc05hdmlnYXRhYmxlKSB7XG4gICAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKTtcbiAgICAgIHJldHVybiBmcmFtZSA/IGZyYW1lICE9IGVsZW1lbnQuY2xvc2VzdChcInR1cmJvLWZyYW1lXCIpIDogZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgaWQgPSBzdWJtaXR0ZXI/LmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIikgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIpO1xuICAgIGlmIChpZCAmJiBpZCAhPSBcIl90b3BcIikge1xuICAgICAgY29uc3QgZnJhbWUgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aWR9Om5vdChbZGlzYWJsZWRdKWApO1xuICAgICAgaWYgKGZyYW1lIGluc3RhbmNlb2YgRnJhbWVFbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBmcmFtZVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBIaXN0b3J5IHtcbiAgbG9jYXRpb25cbiAgcmVzdG9yYXRpb25JZGVudGlmaWVyID0gdXVpZCgpXG4gIHJlc3RvcmF0aW9uRGF0YSA9IHt9XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuICBwYWdlTG9hZGVkID0gZmFsc2VcbiAgY3VycmVudEluZGV4ID0gMFxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCB0aGlzLm9uUG9wU3RhdGUsIGZhbHNlKTtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIHRoaXMub25QYWdlTG9hZCwgZmFsc2UpO1xuICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBoaXN0b3J5LnN0YXRlPy50dXJibz8ucmVzdG9yYXRpb25JbmRleCB8fCAwO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMucmVwbGFjZShuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKSk7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgdGhpcy5vblBvcFN0YXRlLCBmYWxzZSk7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCB0aGlzLm9uUGFnZUxvYWQsIGZhbHNlKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHB1c2gobG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllcikge1xuICAgIHRoaXMudXBkYXRlKGhpc3RvcnkucHVzaFN0YXRlLCBsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyKTtcbiAgfVxuXG4gIHJlcGxhY2UobG9jYXRpb24sIHJlc3RvcmF0aW9uSWRlbnRpZmllcikge1xuICAgIHRoaXMudXBkYXRlKGhpc3RvcnkucmVwbGFjZVN0YXRlLCBsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyKTtcbiAgfVxuXG4gIHVwZGF0ZShtZXRob2QsIGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIgPSB1dWlkKCkpIHtcbiAgICBpZiAobWV0aG9kID09PSBoaXN0b3J5LnB1c2hTdGF0ZSkgKyt0aGlzLmN1cnJlbnRJbmRleDtcblxuICAgIGNvbnN0IHN0YXRlID0geyB0dXJibzogeyByZXN0b3JhdGlvbklkZW50aWZpZXIsIHJlc3RvcmF0aW9uSW5kZXg6IHRoaXMuY3VycmVudEluZGV4IH0gfTtcbiAgICBtZXRob2QuY2FsbChoaXN0b3J5LCBzdGF0ZSwgXCJcIiwgbG9jYXRpb24uaHJlZik7XG4gICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgIHRoaXMucmVzdG9yYXRpb25JZGVudGlmaWVyID0gcmVzdG9yYXRpb25JZGVudGlmaWVyO1xuICB9XG5cbiAgLy8gUmVzdG9yYXRpb24gZGF0YVxuXG4gIGdldFJlc3RvcmF0aW9uRGF0YUZvcklkZW50aWZpZXIocmVzdG9yYXRpb25JZGVudGlmaWVyKSB7XG4gICAgcmV0dXJuIHRoaXMucmVzdG9yYXRpb25EYXRhW3Jlc3RvcmF0aW9uSWRlbnRpZmllcl0gfHwge31cbiAgfVxuXG4gIHVwZGF0ZVJlc3RvcmF0aW9uRGF0YShhZGRpdGlvbmFsRGF0YSkge1xuICAgIGNvbnN0IHsgcmVzdG9yYXRpb25JZGVudGlmaWVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHJlc3RvcmF0aW9uRGF0YSA9IHRoaXMucmVzdG9yYXRpb25EYXRhW3Jlc3RvcmF0aW9uSWRlbnRpZmllcl07XG4gICAgdGhpcy5yZXN0b3JhdGlvbkRhdGFbcmVzdG9yYXRpb25JZGVudGlmaWVyXSA9IHtcbiAgICAgIC4uLnJlc3RvcmF0aW9uRGF0YSxcbiAgICAgIC4uLmFkZGl0aW9uYWxEYXRhXG4gICAgfTtcbiAgfVxuXG4gIC8vIFNjcm9sbCByZXN0b3JhdGlvblxuXG4gIGFzc3VtZUNvbnRyb2xPZlNjcm9sbFJlc3RvcmF0aW9uKCkge1xuICAgIGlmICghdGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uKSB7XG4gICAgICB0aGlzLnByZXZpb3VzU2Nyb2xsUmVzdG9yYXRpb24gPSBoaXN0b3J5LnNjcm9sbFJlc3RvcmF0aW9uID8/IFwiYXV0b1wiO1xuICAgICAgaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbiA9IFwibWFudWFsXCI7XG4gICAgfVxuICB9XG5cbiAgcmVsaW5xdWlzaENvbnRyb2xPZlNjcm9sbFJlc3RvcmF0aW9uKCkge1xuICAgIGlmICh0aGlzLnByZXZpb3VzU2Nyb2xsUmVzdG9yYXRpb24pIHtcbiAgICAgIGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24gPSB0aGlzLnByZXZpb3VzU2Nyb2xsUmVzdG9yYXRpb247XG4gICAgICBkZWxldGUgdGhpcy5wcmV2aW91c1Njcm9sbFJlc3RvcmF0aW9uO1xuICAgIH1cbiAgfVxuXG4gIC8vIEV2ZW50IGhhbmRsZXJzXG5cbiAgb25Qb3BTdGF0ZSA9IChldmVudCkgPT4ge1xuICAgIGlmICh0aGlzLnNob3VsZEhhbmRsZVBvcFN0YXRlKCkpIHtcbiAgICAgIGNvbnN0IHsgdHVyYm8gfSA9IGV2ZW50LnN0YXRlIHx8IHt9O1xuICAgICAgaWYgKHR1cmJvKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbiAgICAgICAgY29uc3QgeyByZXN0b3JhdGlvbklkZW50aWZpZXIsIHJlc3RvcmF0aW9uSW5kZXggfSA9IHR1cmJvO1xuICAgICAgICB0aGlzLnJlc3RvcmF0aW9uSWRlbnRpZmllciA9IHJlc3RvcmF0aW9uSWRlbnRpZmllcjtcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gcmVzdG9yYXRpb25JbmRleCA+IHRoaXMuY3VycmVudEluZGV4ID8gXCJmb3J3YXJkXCIgOiBcImJhY2tcIjtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5UG9wcGVkVG9Mb2NhdGlvbldpdGhSZXN0b3JhdGlvbklkZW50aWZpZXJBbmREaXJlY3Rpb24odGhpcy5sb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCBkaXJlY3Rpb24pO1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IHJlc3RvcmF0aW9uSW5kZXg7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25QYWdlTG9hZCA9IGFzeW5jIChfZXZlbnQpID0+IHtcbiAgICBhd2FpdCBuZXh0TWljcm90YXNrKCk7XG4gICAgdGhpcy5wYWdlTG9hZGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBzaG91bGRIYW5kbGVQb3BTdGF0ZSgpIHtcbiAgICAvLyBTYWZhcmkgZGlzcGF0Y2hlcyBhIHBvcHN0YXRlIGV2ZW50IGFmdGVyIHdpbmRvdydzIGxvYWQgZXZlbnQsIGlnbm9yZSBpdFxuICAgIHJldHVybiB0aGlzLnBhZ2VJc0xvYWRlZCgpXG4gIH1cblxuICBwYWdlSXNMb2FkZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFnZUxvYWRlZCB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09IFwiY29tcGxldGVcIlxuICB9XG59XG5cbmNsYXNzIExpbmtQcmVmZXRjaE9ic2VydmVyIHtcbiAgc3RhcnRlZCA9IGZhbHNlXG4gICNwcmVmZXRjaGVkTGluayA9IG51bGxcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSwgZXZlbnRUYXJnZXQpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5ldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0O1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkgcmV0dXJuXG5cbiAgICBpZiAodGhpcy5ldmVudFRhcmdldC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xuICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCB0aGlzLiNlbmFibGUsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4jZW5hYmxlKCk7XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkgcmV0dXJuXG5cbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIHRoaXMuI3RyeVRvUHJlZmV0Y2hSZXF1ZXN0LCB7XG4gICAgICBjYXB0dXJlOiB0cnVlLFxuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgdGhpcy4jY2FuY2VsUmVxdWVzdElmT2Jzb2xldGUsIHtcbiAgICAgIGNhcHR1cmU6IHRydWUsXG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG5cbiAgICB0aGlzLmV2ZW50VGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0dXJibzpiZWZvcmUtZmV0Y2gtcmVxdWVzdFwiLCB0aGlzLiN0cnlUb1VzZVByZWZldGNoZWRSZXF1ZXN0LCB0cnVlKTtcbiAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgfVxuXG4gICNlbmFibGUgPSAoKSA9PiB7XG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCB0aGlzLiN0cnlUb1ByZWZldGNoUmVxdWVzdCwge1xuICAgICAgY2FwdHVyZTogdHJ1ZSxcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICB0aGlzLmV2ZW50VGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIHRoaXMuI2NhbmNlbFJlcXVlc3RJZk9ic29sZXRlLCB7XG4gICAgICBjYXB0dXJlOiB0cnVlLFxuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlcXVlc3RcIiwgdGhpcy4jdHJ5VG9Vc2VQcmVmZXRjaGVkUmVxdWVzdCwgdHJ1ZSk7XG4gICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgfVxuXG4gICN0cnlUb1ByZWZldGNoUmVxdWVzdCA9IChldmVudCkgPT4ge1xuICAgIGlmIChnZXRNZXRhQ29udGVudChcInR1cmJvLXByZWZldGNoXCIpID09PSBcImZhbHNlXCIpIHJldHVyblxuXG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGlzTGluayA9IHRhcmdldC5tYXRjaGVzICYmIHRhcmdldC5tYXRjaGVzKFwiYVtocmVmXTpub3QoW3RhcmdldF49X10pOm5vdChbZG93bmxvYWRdKVwiKTtcblxuICAgIGlmIChpc0xpbmsgJiYgdGhpcy4jaXNQcmVmZXRjaGFibGUodGFyZ2V0KSkge1xuICAgICAgY29uc3QgbGluayA9IHRhcmdldDtcbiAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb25Gb3JMaW5rKGxpbmspO1xuXG4gICAgICBpZiAodGhpcy5kZWxlZ2F0ZS5jYW5QcmVmZXRjaFJlcXVlc3RUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSkge1xuICAgICAgICB0aGlzLiNwcmVmZXRjaGVkTGluayA9IGxpbms7XG5cbiAgICAgICAgY29uc3QgZmV0Y2hSZXF1ZXN0ID0gbmV3IEZldGNoUmVxdWVzdChcbiAgICAgICAgICB0aGlzLFxuICAgICAgICAgIEZldGNoTWV0aG9kLmdldCxcbiAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICBuZXcgVVJMU2VhcmNoUGFyYW1zKCksXG4gICAgICAgICAgdGFyZ2V0XG4gICAgICAgICk7XG5cbiAgICAgICAgcHJlZmV0Y2hDYWNoZS5zZXRMYXRlcihsb2NhdGlvbi50b1N0cmluZygpLCBmZXRjaFJlcXVlc3QsIHRoaXMuI2NhY2hlVHRsKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAjY2FuY2VsUmVxdWVzdElmT2Jzb2xldGUgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLiNwcmVmZXRjaGVkTGluaykgdGhpcy4jY2FuY2VsUHJlZmV0Y2hSZXF1ZXN0KCk7XG4gIH1cblxuICAjY2FuY2VsUHJlZmV0Y2hSZXF1ZXN0ID0gKCkgPT4ge1xuICAgIHByZWZldGNoQ2FjaGUuY2xlYXIoKTtcbiAgICB0aGlzLiNwcmVmZXRjaGVkTGluayA9IG51bGw7XG4gIH1cblxuICAjdHJ5VG9Vc2VQcmVmZXRjaGVkUmVxdWVzdCA9IChldmVudCkgPT4ge1xuICAgIGlmIChldmVudC50YXJnZXQudGFnTmFtZSAhPT0gXCJGT1JNXCIgJiYgZXZlbnQuZGV0YWlsLmZldGNoT3B0aW9ucy5tZXRob2QgPT09IFwiR0VUXCIpIHtcbiAgICAgIGNvbnN0IGNhY2hlZCA9IHByZWZldGNoQ2FjaGUuZ2V0KGV2ZW50LmRldGFpbC51cmwudG9TdHJpbmcoKSk7XG5cbiAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgLy8gVXNlciBjbGlja2VkIGxpbmssIHVzZSBjYWNoZSByZXNwb25zZVxuICAgICAgICBldmVudC5kZXRhaWwuZmV0Y2hSZXF1ZXN0ID0gY2FjaGVkO1xuICAgICAgfVxuXG4gICAgICBwcmVmZXRjaENhY2hlLmNsZWFyKCk7XG4gICAgfVxuICB9XG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIGNvbnN0IGxpbmsgPSByZXF1ZXN0LnRhcmdldDtcblxuICAgIHJlcXVlc3QuaGVhZGVyc1tcIlgtU2VjLVB1cnBvc2VcIl0gPSBcInByZWZldGNoXCI7XG5cbiAgICBjb25zdCB0dXJib0ZyYW1lID0gbGluay5jbG9zZXN0KFwidHVyYm8tZnJhbWVcIik7XG4gICAgY29uc3QgdHVyYm9GcmFtZVRhcmdldCA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKSB8fCB0dXJib0ZyYW1lPy5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIikgfHwgdHVyYm9GcmFtZT8uaWQ7XG5cbiAgICBpZiAodHVyYm9GcmFtZVRhcmdldCAmJiB0dXJib0ZyYW1lVGFyZ2V0ICE9PSBcIl90b3BcIikge1xuICAgICAgcmVxdWVzdC5oZWFkZXJzW1wiVHVyYm8tRnJhbWVcIl0gPSB0dXJib0ZyYW1lVGFyZ2V0O1xuICAgIH1cbiAgfVxuXG4gIC8vIEZldGNoIHJlcXVlc3QgaW50ZXJmYWNlXG5cbiAgcmVxdWVzdFN1Y2NlZWRlZFdpdGhSZXNwb25zZSgpIHt9XG5cbiAgcmVxdWVzdFN0YXJ0ZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RFcnJvcmVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0RmluaXNoZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICByZXF1ZXN0RmFpbGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICBnZXQgI2NhY2hlVHRsKCkge1xuICAgIHJldHVybiBOdW1iZXIoZ2V0TWV0YUNvbnRlbnQoXCJ0dXJiby1wcmVmZXRjaC1jYWNoZS10aW1lXCIpKSB8fCBjYWNoZVR0bFxuICB9XG5cbiAgI2lzUHJlZmV0Y2hhYmxlKGxpbmspIHtcbiAgICBjb25zdCBocmVmID0gbGluay5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuXG4gICAgaWYgKCFocmVmKSByZXR1cm4gZmFsc2VcblxuICAgIGlmICh1bmZldGNoYWJsZUxpbmsobGluaykpIHJldHVybiBmYWxzZVxuICAgIGlmIChsaW5rVG9UaGVTYW1lUGFnZShsaW5rKSkgcmV0dXJuIGZhbHNlXG4gICAgaWYgKGxpbmtPcHRzT3V0KGxpbmspKSByZXR1cm4gZmFsc2VcbiAgICBpZiAobm9uU2FmZUxpbmsobGluaykpIHJldHVybiBmYWxzZVxuICAgIGlmIChldmVudFByZXZlbnRlZChsaW5rKSkgcmV0dXJuIGZhbHNlXG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59XG5cbmNvbnN0IHVuZmV0Y2hhYmxlTGluayA9IChsaW5rKSA9PiB7XG4gIHJldHVybiBsaW5rLm9yaWdpbiAhPT0gZG9jdW1lbnQubG9jYXRpb24ub3JpZ2luIHx8ICFbXCJodHRwOlwiLCBcImh0dHBzOlwiXS5pbmNsdWRlcyhsaW5rLnByb3RvY29sKSB8fCBsaW5rLmhhc0F0dHJpYnV0ZShcInRhcmdldFwiKVxufTtcblxuY29uc3QgbGlua1RvVGhlU2FtZVBhZ2UgPSAobGluaykgPT4ge1xuICByZXR1cm4gKGxpbmsucGF0aG5hbWUgKyBsaW5rLnNlYXJjaCA9PT0gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgKyBkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2gpIHx8IGxpbmsuaHJlZi5zdGFydHNXaXRoKFwiI1wiKVxufTtcblxuY29uc3QgbGlua09wdHNPdXQgPSAobGluaykgPT4ge1xuICBpZiAobGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXByZWZldGNoXCIpID09PSBcImZhbHNlXCIpIHJldHVybiB0cnVlXG4gIGlmIChsaW5rLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm9cIikgPT09IFwiZmFsc2VcIikgcmV0dXJuIHRydWVcblxuICBjb25zdCB0dXJib1ByZWZldGNoUGFyZW50ID0gZmluZENsb3Nlc3RSZWN1cnNpdmVseShsaW5rLCBcIltkYXRhLXR1cmJvLXByZWZldGNoXVwiKTtcbiAgaWYgKHR1cmJvUHJlZmV0Y2hQYXJlbnQgJiYgdHVyYm9QcmVmZXRjaFBhcmVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXByZWZldGNoXCIpID09PSBcImZhbHNlXCIpIHJldHVybiB0cnVlXG5cbiAgcmV0dXJuIGZhbHNlXG59O1xuXG5jb25zdCBub25TYWZlTGluayA9IChsaW5rKSA9PiB7XG4gIGNvbnN0IHR1cmJvTWV0aG9kID0gbGluay5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLW1ldGhvZFwiKTtcbiAgaWYgKHR1cmJvTWV0aG9kICYmIHR1cmJvTWV0aG9kLnRvTG93ZXJDYXNlKCkgIT09IFwiZ2V0XCIpIHJldHVybiB0cnVlXG5cbiAgaWYgKGlzVUpTKGxpbmspKSByZXR1cm4gdHJ1ZVxuICBpZiAobGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWNvbmZpcm1cIikpIHJldHVybiB0cnVlXG4gIGlmIChsaW5rLmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tc3RyZWFtXCIpKSByZXR1cm4gdHJ1ZVxuXG4gIHJldHVybiBmYWxzZVxufTtcblxuY29uc3QgaXNVSlMgPSAobGluaykgPT4ge1xuICByZXR1cm4gbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXJlbW90ZVwiKSB8fCBsaW5rLmhhc0F0dHJpYnV0ZShcImRhdGEtYmVoYXZpb3JcIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLWNvbmZpcm1cIikgfHwgbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLW1ldGhvZFwiKVxufTtcblxuY29uc3QgZXZlbnRQcmV2ZW50ZWQgPSAobGluaykgPT4ge1xuICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLXByZWZldGNoXCIsIHsgdGFyZ2V0OiBsaW5rLCBjYW5jZWxhYmxlOiB0cnVlIH0pO1xuICByZXR1cm4gZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxufTtcblxuY2xhc3MgTmF2aWdhdG9yIHtcbiAgY29uc3RydWN0b3IoZGVsZWdhdGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gIH1cblxuICBwcm9wb3NlVmlzaXQobG9jYXRpb24sIG9wdGlvbnMgPSB7fSkge1xuICAgIGlmICh0aGlzLmRlbGVnYXRlLmFsbG93c1Zpc2l0aW5nTG9jYXRpb25XaXRoQWN0aW9uKGxvY2F0aW9uLCBvcHRpb25zLmFjdGlvbikpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUudmlzaXRQcm9wb3NlZFRvTG9jYXRpb24obG9jYXRpb24sIG9wdGlvbnMpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXJ0VmlzaXQobG9jYXRhYmxlLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuc3RvcCgpO1xuICAgIHRoaXMuY3VycmVudFZpc2l0ID0gbmV3IFZpc2l0KHRoaXMsIGV4cGFuZFVSTChsb2NhdGFibGUpLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIHtcbiAgICAgIHJlZmVycmVyOiB0aGlzLmxvY2F0aW9uLFxuICAgICAgLi4ub3B0aW9uc1xuICAgIH0pO1xuICAgIHRoaXMuY3VycmVudFZpc2l0LnN0YXJ0KCk7XG4gIH1cblxuICBzdWJtaXRGb3JtKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIHRoaXMuc3RvcCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pc3Npb24gPSBuZXcgRm9ybVN1Ym1pc3Npb24odGhpcywgZm9ybSwgc3VibWl0dGVyLCB0cnVlKTtcblxuICAgIHRoaXMuZm9ybVN1Ym1pc3Npb24uc3RhcnQoKTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuZm9ybVN1Ym1pc3Npb24pIHtcbiAgICAgIHRoaXMuZm9ybVN1Ym1pc3Npb24uc3RvcCgpO1xuICAgICAgZGVsZXRlIHRoaXMuZm9ybVN1Ym1pc3Npb247XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY3VycmVudFZpc2l0KSB7XG4gICAgICB0aGlzLmN1cnJlbnRWaXNpdC5jYW5jZWwoKTtcbiAgICAgIGRlbGV0ZSB0aGlzLmN1cnJlbnRWaXNpdDtcbiAgICB9XG4gIH1cblxuICBnZXQgYWRhcHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5hZGFwdGVyXG4gIH1cblxuICBnZXQgdmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS52aWV3XG4gIH1cblxuICBnZXQgcm9vdExvY2F0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnZpZXcuc25hcHNob3Qucm9vdExvY2F0aW9uXG4gIH1cblxuICBnZXQgaGlzdG9yeSgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5oaXN0b3J5XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pc3Npb24gZGVsZWdhdGVcblxuICBmb3JtU3VibWlzc2lvblN0YXJ0ZWQoZm9ybVN1Ym1pc3Npb24pIHtcbiAgICAvLyBOb3QgYWxsIGFkYXB0ZXJzIGltcGxlbWVudCBmb3JtU3VibWlzc2lvblN0YXJ0ZWRcbiAgICBpZiAodHlwZW9mIHRoaXMuYWRhcHRlci5mb3JtU3VibWlzc2lvblN0YXJ0ZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5hZGFwdGVyLmZvcm1TdWJtaXNzaW9uU3RhcnRlZChmb3JtU3VibWlzc2lvbik7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICBpZiAoZm9ybVN1Ym1pc3Npb24gPT0gdGhpcy5mb3JtU3VibWlzc2lvbikge1xuICAgICAgY29uc3QgcmVzcG9uc2VIVE1MID0gYXdhaXQgZmV0Y2hSZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgICBpZiAocmVzcG9uc2VIVE1MKSB7XG4gICAgICAgIGNvbnN0IHNob3VsZENhY2hlU25hcHNob3QgPSBmb3JtU3VibWlzc2lvbi5pc1NhZmU7XG4gICAgICAgIGlmICghc2hvdWxkQ2FjaGVTbmFwc2hvdCkge1xuICAgICAgICAgIHRoaXMudmlldy5jbGVhclNuYXBzaG90Q2FjaGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgc3RhdHVzQ29kZSwgcmVkaXJlY3RlZCB9ID0gZmV0Y2hSZXNwb25zZTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy4jZ2V0QWN0aW9uRm9yRm9ybVN1Ym1pc3Npb24oZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpO1xuICAgICAgICBjb25zdCB2aXNpdE9wdGlvbnMgPSB7XG4gICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgIHNob3VsZENhY2hlU25hcHNob3QsXG4gICAgICAgICAgcmVzcG9uc2U6IHsgc3RhdHVzQ29kZSwgcmVzcG9uc2VIVE1MLCByZWRpcmVjdGVkIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcm9wb3NlVmlzaXQoZmV0Y2hSZXNwb25zZS5sb2NhdGlvbiwgdmlzaXRPcHRpb25zKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBmb3JtU3VibWlzc2lvbkZhaWxlZFdpdGhSZXNwb25zZShmb3JtU3VibWlzc2lvbiwgZmV0Y2hSZXNwb25zZSkge1xuICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IGZldGNoUmVzcG9uc2UucmVzcG9uc2VIVE1MO1xuXG4gICAgaWYgKHJlc3BvbnNlSFRNTCkge1xuICAgICAgY29uc3Qgc25hcHNob3QgPSBQYWdlU25hcHNob3QuZnJvbUhUTUxTdHJpbmcocmVzcG9uc2VIVE1MKTtcbiAgICAgIGlmIChmZXRjaFJlc3BvbnNlLnNlcnZlckVycm9yKSB7XG4gICAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXJFcnJvcihzbmFwc2hvdCwgdGhpcy5jdXJyZW50VmlzaXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy52aWV3LnJlbmRlclBhZ2Uoc25hcHNob3QsIGZhbHNlLCB0cnVlLCB0aGlzLmN1cnJlbnRWaXNpdCk7XG4gICAgICB9XG4gICAgICBpZighc25hcHNob3Quc2hvdWxkUHJlc2VydmVTY3JvbGxQb3NpdGlvbikge1xuICAgICAgICB0aGlzLnZpZXcuc2Nyb2xsVG9Ub3AoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudmlldy5jbGVhclNuYXBzaG90Q2FjaGUoKTtcbiAgICB9XG4gIH1cblxuICBmb3JtU3VibWlzc2lvbkVycm9yZWQoZm9ybVN1Ym1pc3Npb24sIGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH1cblxuICBmb3JtU3VibWlzc2lvbkZpbmlzaGVkKGZvcm1TdWJtaXNzaW9uKSB7XG4gICAgLy8gTm90IGFsbCBhZGFwdGVycyBpbXBsZW1lbnQgZm9ybVN1Ym1pc3Npb25GaW5pc2hlZFxuICAgIGlmICh0eXBlb2YgdGhpcy5hZGFwdGVyLmZvcm1TdWJtaXNzaW9uRmluaXNoZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5hZGFwdGVyLmZvcm1TdWJtaXNzaW9uRmluaXNoZWQoZm9ybVN1Ym1pc3Npb24pO1xuICAgIH1cbiAgfVxuXG4gIC8vIFZpc2l0IGRlbGVnYXRlXG5cbiAgdmlzaXRTdGFydGVkKHZpc2l0KSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS52aXNpdFN0YXJ0ZWQodmlzaXQpO1xuICB9XG5cbiAgdmlzaXRDb21wbGV0ZWQodmlzaXQpIHtcbiAgICB0aGlzLmRlbGVnYXRlLnZpc2l0Q29tcGxldGVkKHZpc2l0KTtcbiAgICBkZWxldGUgdGhpcy5jdXJyZW50VmlzaXQ7XG4gIH1cblxuICBsb2NhdGlvbldpdGhBY3Rpb25Jc1NhbWVQYWdlKGxvY2F0aW9uLCBhY3Rpb24pIHtcbiAgICBjb25zdCBhbmNob3IgPSBnZXRBbmNob3IobG9jYXRpb24pO1xuICAgIGNvbnN0IGN1cnJlbnRBbmNob3IgPSBnZXRBbmNob3IodGhpcy52aWV3Lmxhc3RSZW5kZXJlZExvY2F0aW9uKTtcbiAgICBjb25zdCBpc1Jlc3RvcmF0aW9uVG9Ub3AgPSBhY3Rpb24gPT09IFwicmVzdG9yZVwiICYmIHR5cGVvZiBhbmNob3IgPT09IFwidW5kZWZpbmVkXCI7XG5cbiAgICByZXR1cm4gKFxuICAgICAgYWN0aW9uICE9PSBcInJlcGxhY2VcIiAmJlxuICAgICAgZ2V0UmVxdWVzdFVSTChsb2NhdGlvbikgPT09IGdldFJlcXVlc3RVUkwodGhpcy52aWV3Lmxhc3RSZW5kZXJlZExvY2F0aW9uKSAmJlxuICAgICAgKGlzUmVzdG9yYXRpb25Ub1RvcCB8fCAoYW5jaG9yICE9IG51bGwgJiYgYW5jaG9yICE9PSBjdXJyZW50QW5jaG9yKSlcbiAgICApXG4gIH1cblxuICB2aXNpdFNjcm9sbGVkVG9TYW1lUGFnZUxvY2F0aW9uKG9sZFVSTCwgbmV3VVJMKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS52aXNpdFNjcm9sbGVkVG9TYW1lUGFnZUxvY2F0aW9uKG9sZFVSTCwgbmV3VVJMKTtcbiAgfVxuXG4gIC8vIFZpc2l0c1xuXG4gIGdldCBsb2NhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5oaXN0b3J5LmxvY2F0aW9uXG4gIH1cblxuICBnZXQgcmVzdG9yYXRpb25JZGVudGlmaWVyKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkucmVzdG9yYXRpb25JZGVudGlmaWVyXG4gIH1cblxuICAjZ2V0QWN0aW9uRm9yRm9ybVN1Ym1pc3Npb24oZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICBjb25zdCB7IHN1Ym1pdHRlciwgZm9ybUVsZW1lbnQgfSA9IGZvcm1TdWJtaXNzaW9uO1xuICAgIHJldHVybiBnZXRWaXNpdEFjdGlvbihzdWJtaXR0ZXIsIGZvcm1FbGVtZW50KSB8fCB0aGlzLiNnZXREZWZhdWx0QWN0aW9uKGZldGNoUmVzcG9uc2UpXG4gIH1cblxuICAjZ2V0RGVmYXVsdEFjdGlvbihmZXRjaFJlc3BvbnNlKSB7XG4gICAgY29uc3Qgc2FtZUxvY2F0aW9uUmVkaXJlY3QgPSBmZXRjaFJlc3BvbnNlLnJlZGlyZWN0ZWQgJiYgZmV0Y2hSZXNwb25zZS5sb2NhdGlvbi5ocmVmID09PSB0aGlzLmxvY2F0aW9uPy5ocmVmO1xuICAgIHJldHVybiBzYW1lTG9jYXRpb25SZWRpcmVjdCA/IFwicmVwbGFjZVwiIDogXCJhZHZhbmNlXCJcbiAgfVxufVxuXG5jb25zdCBQYWdlU3RhZ2UgPSB7XG4gIGluaXRpYWw6IDAsXG4gIGxvYWRpbmc6IDEsXG4gIGludGVyYWN0aXZlOiAyLFxuICBjb21wbGV0ZTogM1xufTtcblxuY2xhc3MgUGFnZU9ic2VydmVyIHtcbiAgc3RhZ2UgPSBQYWdlU3RhZ2UuaW5pdGlhbFxuICBzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICBpZiAodGhpcy5zdGFnZSA9PSBQYWdlU3RhZ2UuaW5pdGlhbCkge1xuICAgICAgICB0aGlzLnN0YWdlID0gUGFnZVN0YWdlLmxvYWRpbmc7XG4gICAgICB9XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLCB0aGlzLmludGVycHJldFJlYWR5U3RhdGUsIGZhbHNlKTtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJwYWdlaGlkZVwiLCB0aGlzLnBhZ2VXaWxsVW5sb2FkLCBmYWxzZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlYWR5c3RhdGVjaGFuZ2VcIiwgdGhpcy5pbnRlcnByZXRSZWFkeVN0YXRlLCBmYWxzZSk7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5wYWdlV2lsbFVubG9hZCwgZmFsc2UpO1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaW50ZXJwcmV0UmVhZHlTdGF0ZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHJlYWR5U3RhdGUgfSA9IHRoaXM7XG4gICAgaWYgKHJlYWR5U3RhdGUgPT0gXCJpbnRlcmFjdGl2ZVwiKSB7XG4gICAgICB0aGlzLnBhZ2VJc0ludGVyYWN0aXZlKCk7XG4gICAgfSBlbHNlIGlmIChyZWFkeVN0YXRlID09IFwiY29tcGxldGVcIikge1xuICAgICAgdGhpcy5wYWdlSXNDb21wbGV0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIHBhZ2VJc0ludGVyYWN0aXZlKCkge1xuICAgIGlmICh0aGlzLnN0YWdlID09IFBhZ2VTdGFnZS5sb2FkaW5nKSB7XG4gICAgICB0aGlzLnN0YWdlID0gUGFnZVN0YWdlLmludGVyYWN0aXZlO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5wYWdlQmVjYW1lSW50ZXJhY3RpdmUoKTtcbiAgICB9XG4gIH1cblxuICBwYWdlSXNDb21wbGV0ZSgpIHtcbiAgICB0aGlzLnBhZ2VJc0ludGVyYWN0aXZlKCk7XG4gICAgaWYgKHRoaXMuc3RhZ2UgPT0gUGFnZVN0YWdlLmludGVyYWN0aXZlKSB7XG4gICAgICB0aGlzLnN0YWdlID0gUGFnZVN0YWdlLmNvbXBsZXRlO1xuICAgICAgdGhpcy5kZWxlZ2F0ZS5wYWdlTG9hZGVkKCk7XG4gICAgfVxuICB9XG5cbiAgcGFnZVdpbGxVbmxvYWQgPSAoKSA9PiB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5wYWdlV2lsbFVubG9hZCgpO1xuICB9XG5cbiAgZ2V0IHJlYWR5U3RhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnJlYWR5U3RhdGVcbiAgfVxufVxuXG5jbGFzcyBTY3JvbGxPYnNlcnZlciB7XG4gIHN0YXJ0ZWQgPSBmYWxzZVxuXG4gIGNvbnN0cnVjdG9yKGRlbGVnYXRlKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgdGhpcy5vblNjcm9sbCwgZmFsc2UpO1xuICAgICAgdGhpcy5vblNjcm9sbCgpO1xuICAgICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgdGhpcy5vblNjcm9sbCwgZmFsc2UpO1xuICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgb25TY3JvbGwgPSAoKSA9PiB7XG4gICAgdGhpcy51cGRhdGVQb3NpdGlvbih7IHg6IHdpbmRvdy5wYWdlWE9mZnNldCwgeTogd2luZG93LnBhZ2VZT2Zmc2V0IH0pO1xuICB9XG5cbiAgLy8gUHJpdmF0ZVxuXG4gIHVwZGF0ZVBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5zY3JvbGxQb3NpdGlvbkNoYW5nZWQocG9zaXRpb24pO1xuICB9XG59XG5cbmNsYXNzIFN0cmVhbU1lc3NhZ2VSZW5kZXJlciB7XG4gIHJlbmRlcih7IGZyYWdtZW50IH0pIHtcbiAgICBCYXJkby5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHModGhpcywgZ2V0UGVybWFuZW50RWxlbWVudE1hcEZvckZyYWdtZW50KGZyYWdtZW50KSwgKCkgPT4ge1xuICAgICAgd2l0aEF1dG9mb2N1c0Zyb21GcmFnbWVudChmcmFnbWVudCwgKCkgPT4ge1xuICAgICAgICB3aXRoUHJlc2VydmVkRm9jdXMoKCkgPT4ge1xuICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBCYXJkbyBkZWxlZ2F0ZVxuXG4gIGVudGVyaW5nQmFyZG8oY3VycmVudFBlcm1hbmVudEVsZW1lbnQsIG5ld1Blcm1hbmVudEVsZW1lbnQpIHtcbiAgICBuZXdQZXJtYW5lbnRFbGVtZW50LnJlcGxhY2VXaXRoKGN1cnJlbnRQZXJtYW5lbnRFbGVtZW50LmNsb25lTm9kZSh0cnVlKSk7XG4gIH1cblxuICBsZWF2aW5nQmFyZG8oKSB7fVxufVxuXG5mdW5jdGlvbiBnZXRQZXJtYW5lbnRFbGVtZW50TWFwRm9yRnJhZ21lbnQoZnJhZ21lbnQpIHtcbiAgY29uc3QgcGVybWFuZW50RWxlbWVudHNJbkRvY3VtZW50ID0gcXVlcnlQZXJtYW5lbnRFbGVtZW50c0FsbChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuICBjb25zdCBwZXJtYW5lbnRFbGVtZW50TWFwID0ge307XG4gIGZvciAoY29uc3QgcGVybWFuZW50RWxlbWVudEluRG9jdW1lbnQgb2YgcGVybWFuZW50RWxlbWVudHNJbkRvY3VtZW50KSB7XG4gICAgY29uc3QgeyBpZCB9ID0gcGVybWFuZW50RWxlbWVudEluRG9jdW1lbnQ7XG5cbiAgICBmb3IgKGNvbnN0IHN0cmVhbUVsZW1lbnQgb2YgZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbChcInR1cmJvLXN0cmVhbVwiKSkge1xuICAgICAgY29uc3QgZWxlbWVudEluU3RyZWFtID0gZ2V0UGVybWFuZW50RWxlbWVudEJ5SWQoc3RyZWFtRWxlbWVudC50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCwgaWQpO1xuXG4gICAgICBpZiAoZWxlbWVudEluU3RyZWFtKSB7XG4gICAgICAgIHBlcm1hbmVudEVsZW1lbnRNYXBbaWRdID0gW3Blcm1hbmVudEVsZW1lbnRJbkRvY3VtZW50LCBlbGVtZW50SW5TdHJlYW1dO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwZXJtYW5lbnRFbGVtZW50TWFwXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHdpdGhBdXRvZm9jdXNGcm9tRnJhZ21lbnQoZnJhZ21lbnQsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGdlbmVyYXRlZElEID0gYHR1cmJvLXN0cmVhbS1hdXRvZm9jdXMtJHt1dWlkKCl9YDtcbiAgY29uc3QgdHVyYm9TdHJlYW1zID0gZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbChcInR1cmJvLXN0cmVhbVwiKTtcbiAgY29uc3QgZWxlbWVudFdpdGhBdXRvZm9jdXMgPSBmaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50SW5TdHJlYW1zKHR1cmJvU3RyZWFtcyk7XG4gIGxldCB3aWxsQXV0b2ZvY3VzSWQgPSBudWxsO1xuXG4gIGlmIChlbGVtZW50V2l0aEF1dG9mb2N1cykge1xuICAgIGlmIChlbGVtZW50V2l0aEF1dG9mb2N1cy5pZCkge1xuICAgICAgd2lsbEF1dG9mb2N1c0lkID0gZWxlbWVudFdpdGhBdXRvZm9jdXMuaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbGxBdXRvZm9jdXNJZCA9IGdlbmVyYXRlZElEO1xuICAgIH1cblxuICAgIGVsZW1lbnRXaXRoQXV0b2ZvY3VzLmlkID0gd2lsbEF1dG9mb2N1c0lkO1xuICB9XG5cbiAgY2FsbGJhY2soKTtcbiAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcblxuICBjb25zdCBoYXNOb0FjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09IG51bGwgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PSBkb2N1bWVudC5ib2R5O1xuXG4gIGlmIChoYXNOb0FjdGl2ZUVsZW1lbnQgJiYgd2lsbEF1dG9mb2N1c0lkKSB7XG4gICAgY29uc3QgZWxlbWVudFRvQXV0b2ZvY3VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQod2lsbEF1dG9mb2N1c0lkKTtcblxuICAgIGlmIChlbGVtZW50SXNGb2N1c2FibGUoZWxlbWVudFRvQXV0b2ZvY3VzKSkge1xuICAgICAgZWxlbWVudFRvQXV0b2ZvY3VzLmZvY3VzKCk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50VG9BdXRvZm9jdXMgJiYgZWxlbWVudFRvQXV0b2ZvY3VzLmlkID09IGdlbmVyYXRlZElEKSB7XG4gICAgICBlbGVtZW50VG9BdXRvZm9jdXMucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XG4gICAgfVxuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHdpdGhQcmVzZXJ2ZWRGb2N1cyhjYWxsYmFjaykge1xuICBjb25zdCBbYWN0aXZlRWxlbWVudEJlZm9yZVJlbmRlciwgYWN0aXZlRWxlbWVudEFmdGVyUmVuZGVyXSA9IGF3YWl0IGFyb3VuZChjYWxsYmFjaywgKCkgPT4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7XG5cbiAgY29uc3QgcmVzdG9yZUZvY3VzVG8gPSBhY3RpdmVFbGVtZW50QmVmb3JlUmVuZGVyICYmIGFjdGl2ZUVsZW1lbnRCZWZvcmVSZW5kZXIuaWQ7XG5cbiAgaWYgKHJlc3RvcmVGb2N1c1RvKSB7XG4gICAgY29uc3QgZWxlbWVudFRvRm9jdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyZXN0b3JlRm9jdXNUbyk7XG5cbiAgICBpZiAoZWxlbWVudElzRm9jdXNhYmxlKGVsZW1lbnRUb0ZvY3VzKSAmJiBlbGVtZW50VG9Gb2N1cyAhPSBhY3RpdmVFbGVtZW50QWZ0ZXJSZW5kZXIpIHtcbiAgICAgIGVsZW1lbnRUb0ZvY3VzLmZvY3VzKCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGZpcnN0QXV0b2ZvY3VzYWJsZUVsZW1lbnRJblN0cmVhbXMobm9kZUxpc3RPZlN0cmVhbUVsZW1lbnRzKSB7XG4gIGZvciAoY29uc3Qgc3RyZWFtRWxlbWVudCBvZiBub2RlTGlzdE9mU3RyZWFtRWxlbWVudHMpIHtcbiAgICBjb25zdCBlbGVtZW50V2l0aEF1dG9mb2N1cyA9IHF1ZXJ5QXV0b2ZvY3VzYWJsZUVsZW1lbnQoc3RyZWFtRWxlbWVudC50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCk7XG5cbiAgICBpZiAoZWxlbWVudFdpdGhBdXRvZm9jdXMpIHJldHVybiBlbGVtZW50V2l0aEF1dG9mb2N1c1xuICB9XG5cbiAgcmV0dXJuIG51bGxcbn1cblxuY2xhc3MgU3RyZWFtT2JzZXJ2ZXIge1xuICBzb3VyY2VzID0gbmV3IFNldCgpXG4gICNzdGFydGVkID0gZmFsc2VcblxuICBjb25zdHJ1Y3RvcihkZWxlZ2F0ZSkge1xuICAgIHRoaXMuZGVsZWdhdGUgPSBkZWxlZ2F0ZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmICghdGhpcy4jc3RhcnRlZCkge1xuICAgICAgdGhpcy4jc3RhcnRlZCA9IHRydWU7XG4gICAgICBhZGRFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlc3BvbnNlXCIsIHRoaXMuaW5zcGVjdEZldGNoUmVzcG9uc2UsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLiNzdGFydGVkKSB7XG4gICAgICB0aGlzLiNzdGFydGVkID0gZmFsc2U7XG4gICAgICByZW1vdmVFdmVudExpc3RlbmVyKFwidHVyYm86YmVmb3JlLWZldGNoLXJlc3BvbnNlXCIsIHRoaXMuaW5zcGVjdEZldGNoUmVzcG9uc2UsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSkge1xuICAgIGlmICghdGhpcy5zdHJlYW1Tb3VyY2VJc0Nvbm5lY3RlZChzb3VyY2UpKSB7XG4gICAgICB0aGlzLnNvdXJjZXMuYWRkKHNvdXJjZSk7XG4gICAgICBzb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5yZWNlaXZlTWVzc2FnZUV2ZW50LCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgZGlzY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5zdHJlYW1Tb3VyY2VJc0Nvbm5lY3RlZChzb3VyY2UpKSB7XG4gICAgICB0aGlzLnNvdXJjZXMuZGVsZXRlKHNvdXJjZSk7XG4gICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5yZWNlaXZlTWVzc2FnZUV2ZW50LCBmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgc3RyZWFtU291cmNlSXNDb25uZWN0ZWQoc291cmNlKSB7XG4gICAgcmV0dXJuIHRoaXMuc291cmNlcy5oYXMoc291cmNlKVxuICB9XG5cbiAgaW5zcGVjdEZldGNoUmVzcG9uc2UgPSAoZXZlbnQpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGZldGNoUmVzcG9uc2VGcm9tRXZlbnQoZXZlbnQpO1xuICAgIGlmIChyZXNwb25zZSAmJiBmZXRjaFJlc3BvbnNlSXNTdHJlYW0ocmVzcG9uc2UpKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB9XG4gIH1cblxuICByZWNlaXZlTWVzc2FnZUV2ZW50ID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKHRoaXMuI3N0YXJ0ZWQgJiYgdHlwZW9mIGV2ZW50LmRhdGEgPT0gXCJzdHJpbmdcIikge1xuICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZUhUTUwoZXZlbnQuZGF0YSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVjZWl2ZU1lc3NhZ2VSZXNwb25zZShyZXNwb25zZSkge1xuICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS5yZXNwb25zZUhUTUw7XG4gICAgaWYgKGh0bWwpIHtcbiAgICAgIHRoaXMucmVjZWl2ZU1lc3NhZ2VIVE1MKGh0bWwpO1xuICAgIH1cbiAgfVxuXG4gIHJlY2VpdmVNZXNzYWdlSFRNTChodG1sKSB7XG4gICAgdGhpcy5kZWxlZ2F0ZS5yZWNlaXZlZE1lc3NhZ2VGcm9tU3RyZWFtKFN0cmVhbU1lc3NhZ2Uud3JhcChodG1sKSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmV0Y2hSZXNwb25zZUZyb21FdmVudChldmVudCkge1xuICBjb25zdCBmZXRjaFJlc3BvbnNlID0gZXZlbnQuZGV0YWlsPy5mZXRjaFJlc3BvbnNlO1xuICBpZiAoZmV0Y2hSZXNwb25zZSBpbnN0YW5jZW9mIEZldGNoUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZmV0Y2hSZXNwb25zZVxuICB9XG59XG5cbmZ1bmN0aW9uIGZldGNoUmVzcG9uc2VJc1N0cmVhbShyZXNwb25zZSkge1xuICBjb25zdCBjb250ZW50VHlwZSA9IHJlc3BvbnNlLmNvbnRlbnRUeXBlID8/IFwiXCI7XG4gIHJldHVybiBjb250ZW50VHlwZS5zdGFydHNXaXRoKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpXG59XG5cbmNsYXNzIEVycm9yUmVuZGVyZXIgZXh0ZW5kcyBSZW5kZXJlciB7XG4gIHN0YXRpYyByZW5kZXJFbGVtZW50KGN1cnJlbnRFbGVtZW50LCBuZXdFbGVtZW50KSB7XG4gICAgY29uc3QgeyBkb2N1bWVudEVsZW1lbnQsIGJvZHkgfSA9IGRvY3VtZW50O1xuXG4gICAgZG9jdW1lbnRFbGVtZW50LnJlcGxhY2VDaGlsZChuZXdFbGVtZW50LCBib2R5KTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpIHtcbiAgICB0aGlzLnJlcGxhY2VIZWFkQW5kQm9keSgpO1xuICAgIHRoaXMuYWN0aXZhdGVTY3JpcHRFbGVtZW50cygpO1xuICB9XG5cbiAgcmVwbGFjZUhlYWRBbmRCb2R5KCkge1xuICAgIGNvbnN0IHsgZG9jdW1lbnRFbGVtZW50LCBoZWFkIH0gPSBkb2N1bWVudDtcbiAgICBkb2N1bWVudEVsZW1lbnQucmVwbGFjZUNoaWxkKHRoaXMubmV3SGVhZCwgaGVhZCk7XG4gICAgdGhpcy5yZW5kZXJFbGVtZW50KHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gIH1cblxuICBhY3RpdmF0ZVNjcmlwdEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgcmVwbGFjZWFibGVFbGVtZW50IG9mIHRoaXMuc2NyaXB0RWxlbWVudHMpIHtcbiAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSByZXBsYWNlYWJsZUVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICAgIGlmIChwYXJlbnROb2RlKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBhY3RpdmF0ZVNjcmlwdEVsZW1lbnQocmVwbGFjZWFibGVFbGVtZW50KTtcbiAgICAgICAgcGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZWxlbWVudCwgcmVwbGFjZWFibGVFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXQgbmV3SGVhZCgpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5oZWFkU25hcHNob3QuZWxlbWVudFxuICB9XG5cbiAgZ2V0IHNjcmlwdEVsZW1lbnRzKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcInNjcmlwdFwiKVxuICB9XG59XG5cbmNsYXNzIFBhZ2VSZW5kZXJlciBleHRlbmRzIFJlbmRlcmVyIHtcbiAgc3RhdGljIHJlbmRlckVsZW1lbnQoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQpIHtcbiAgICBpZiAoZG9jdW1lbnQuYm9keSAmJiBuZXdFbGVtZW50IGluc3RhbmNlb2YgSFRNTEJvZHlFbGVtZW50KSB7XG4gICAgICBkb2N1bWVudC5ib2R5LnJlcGxhY2VXaXRoKG5ld0VsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNob3VsZFJlbmRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5pc1Zpc2l0YWJsZSAmJiB0aGlzLnRyYWNrZWRFbGVtZW50c0FyZUlkZW50aWNhbFxuICB9XG5cbiAgZ2V0IHJlbG9hZFJlYXNvbigpIHtcbiAgICBpZiAoIXRoaXMubmV3U25hcHNob3QuaXNWaXNpdGFibGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlYXNvbjogXCJ0dXJib192aXNpdF9jb250cm9sX2lzX3JlbG9hZFwiXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnRyYWNrZWRFbGVtZW50c0FyZUlkZW50aWNhbCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVhc29uOiBcInRyYWNrZWRfZWxlbWVudF9taXNtYXRjaFwiXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJlcGFyZVRvUmVuZGVyKCkge1xuICAgIHRoaXMuI3NldExhbmd1YWdlKCk7XG4gICAgYXdhaXQgdGhpcy5tZXJnZUhlYWQoKTtcbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpIHtcbiAgICBpZiAodGhpcy53aWxsUmVuZGVyKSB7XG4gICAgICBhd2FpdCB0aGlzLnJlcGxhY2VCb2R5KCk7XG4gICAgfVxuICB9XG5cbiAgZmluaXNoUmVuZGVyaW5nKCkge1xuICAgIHN1cGVyLmZpbmlzaFJlbmRlcmluZygpO1xuICAgIGlmICghdGhpcy5pc1ByZXZpZXcpIHtcbiAgICAgIHRoaXMuZm9jdXNGaXJzdEF1dG9mb2N1c2FibGVFbGVtZW50KCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGN1cnJlbnRIZWFkU25hcHNob3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFNuYXBzaG90LmhlYWRTbmFwc2hvdFxuICB9XG5cbiAgZ2V0IG5ld0hlYWRTbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdTbmFwc2hvdC5oZWFkU25hcHNob3RcbiAgfVxuXG4gIGdldCBuZXdFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLm5ld1NuYXBzaG90LmVsZW1lbnRcbiAgfVxuXG4gICNzZXRMYW5ndWFnZSgpIHtcbiAgICBjb25zdCB7IGRvY3VtZW50RWxlbWVudCB9ID0gdGhpcy5jdXJyZW50U25hcHNob3Q7XG4gICAgY29uc3QgeyBsYW5nIH0gPSB0aGlzLm5ld1NuYXBzaG90O1xuXG4gICAgaWYgKGxhbmcpIHtcbiAgICAgIGRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJsYW5nXCIsIGxhbmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwibGFuZ1wiKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBtZXJnZUhlYWQoKSB7XG4gICAgY29uc3QgbWVyZ2VkSGVhZEVsZW1lbnRzID0gdGhpcy5tZXJnZVByb3Zpc2lvbmFsRWxlbWVudHMoKTtcbiAgICBjb25zdCBuZXdTdHlsZXNoZWV0RWxlbWVudHMgPSB0aGlzLmNvcHlOZXdIZWFkU3R5bGVzaGVldEVsZW1lbnRzKCk7XG4gICAgdGhpcy5jb3B5TmV3SGVhZFNjcmlwdEVsZW1lbnRzKCk7XG5cbiAgICBhd2FpdCBtZXJnZWRIZWFkRWxlbWVudHM7XG4gICAgYXdhaXQgbmV3U3R5bGVzaGVldEVsZW1lbnRzO1xuXG4gICAgaWYgKHRoaXMud2lsbFJlbmRlcikge1xuICAgICAgdGhpcy5yZW1vdmVVbnVzZWREeW5hbWljU3R5bGVzaGVldEVsZW1lbnRzKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVwbGFjZUJvZHkoKSB7XG4gICAgYXdhaXQgdGhpcy5wcmVzZXJ2aW5nUGVybWFuZW50RWxlbWVudHMoYXN5bmMgKCkgPT4ge1xuICAgICAgdGhpcy5hY3RpdmF0ZU5ld0JvZHkoKTtcbiAgICAgIGF3YWl0IHRoaXMuYXNzaWduTmV3Qm9keSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0IHRyYWNrZWRFbGVtZW50c0FyZUlkZW50aWNhbCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50SGVhZFNuYXBzaG90LnRyYWNrZWRFbGVtZW50U2lnbmF0dXJlID09IHRoaXMubmV3SGVhZFNuYXBzaG90LnRyYWNrZWRFbGVtZW50U2lnbmF0dXJlXG4gIH1cblxuICBhc3luYyBjb3B5TmV3SGVhZFN0eWxlc2hlZXRFbGVtZW50cygpIHtcbiAgICBjb25zdCBsb2FkaW5nRWxlbWVudHMgPSBbXTtcblxuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm5ld0hlYWRTdHlsZXNoZWV0RWxlbWVudHMpIHtcbiAgICAgIGxvYWRpbmdFbGVtZW50cy5wdXNoKHdhaXRGb3JMb2FkKGVsZW1lbnQpKTtcblxuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICB9XG5cbiAgICBhd2FpdCBQcm9taXNlLmFsbChsb2FkaW5nRWxlbWVudHMpO1xuICB9XG5cbiAgY29weU5ld0hlYWRTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5uZXdIZWFkU2NyaXB0RWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoYWN0aXZhdGVTY3JpcHRFbGVtZW50KGVsZW1lbnQpKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVVbnVzZWREeW5hbWljU3R5bGVzaGVldEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLnVudXNlZER5bmFtaWNTdHlsZXNoZWV0RWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbWVyZ2VQcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIGNvbnN0IG5ld0hlYWRFbGVtZW50cyA9IFsuLi50aGlzLm5ld0hlYWRQcm92aXNpb25hbEVsZW1lbnRzXTtcblxuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLmN1cnJlbnRIZWFkUHJvdmlzaW9uYWxFbGVtZW50cykge1xuICAgICAgaWYgKCF0aGlzLmlzQ3VycmVudEVsZW1lbnRJbkVsZW1lbnRMaXN0KGVsZW1lbnQsIG5ld0hlYWRFbGVtZW50cykpIHtcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgbmV3SGVhZEVsZW1lbnRzKSB7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGlzQ3VycmVudEVsZW1lbnRJbkVsZW1lbnRMaXN0KGVsZW1lbnQsIGVsZW1lbnRMaXN0KSB7XG4gICAgZm9yIChjb25zdCBbaW5kZXgsIG5ld0VsZW1lbnRdIG9mIGVsZW1lbnRMaXN0LmVudHJpZXMoKSkge1xuICAgICAgLy8gaWYgdGl0bGUgZWxlbWVudC4uLlxuICAgICAgaWYgKGVsZW1lbnQudGFnTmFtZSA9PSBcIlRJVExFXCIpIHtcbiAgICAgICAgaWYgKG5ld0VsZW1lbnQudGFnTmFtZSAhPSBcIlRJVExFXCIpIHtcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtZW50LmlubmVySFRNTCA9PSBuZXdFbGVtZW50LmlubmVySFRNTCkge1xuICAgICAgICAgIGVsZW1lbnRMaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBpZiBhbnkgb3RoZXIgZWxlbWVudC4uLlxuICAgICAgaWYgKG5ld0VsZW1lbnQuaXNFcXVhbE5vZGUoZWxlbWVudCkpIHtcbiAgICAgICAgZWxlbWVudExpc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJlbW92ZUN1cnJlbnRIZWFkUHJvdmlzaW9uYWxFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5jdXJyZW50SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMpIHtcbiAgICAgIGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgY29weU5ld0hlYWRQcm92aXNpb25hbEVsZW1lbnRzKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLm5ld0hlYWRQcm92aXNpb25hbEVsZW1lbnRzKSB7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGFjdGl2YXRlTmV3Qm9keSgpIHtcbiAgICBkb2N1bWVudC5hZG9wdE5vZGUodGhpcy5uZXdFbGVtZW50KTtcbiAgICB0aGlzLmFjdGl2YXRlTmV3Qm9keVNjcmlwdEVsZW1lbnRzKCk7XG4gIH1cblxuICBhY3RpdmF0ZU5ld0JvZHlTY3JpcHRFbGVtZW50cygpIHtcbiAgICBmb3IgKGNvbnN0IGluZXJ0U2NyaXB0RWxlbWVudCBvZiB0aGlzLm5ld0JvZHlTY3JpcHRFbGVtZW50cykge1xuICAgICAgY29uc3QgYWN0aXZhdGVkU2NyaXB0RWxlbWVudCA9IGFjdGl2YXRlU2NyaXB0RWxlbWVudChpbmVydFNjcmlwdEVsZW1lbnQpO1xuICAgICAgaW5lcnRTY3JpcHRFbGVtZW50LnJlcGxhY2VXaXRoKGFjdGl2YXRlZFNjcmlwdEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGFzc2lnbk5ld0JvZHkoKSB7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXJFbGVtZW50KHRoaXMuY3VycmVudEVsZW1lbnQsIHRoaXMubmV3RWxlbWVudCk7XG4gIH1cblxuICBnZXQgdW51c2VkRHluYW1pY1N0eWxlc2hlZXRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5vbGRIZWFkU3R5bGVzaGVldEVsZW1lbnRzLmZpbHRlcigoZWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby10cmFja1wiKSA9PT0gXCJkeW5hbWljXCJcbiAgICB9KVxuICB9XG5cbiAgZ2V0IG9sZEhlYWRTdHlsZXNoZWV0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWRTbmFwc2hvdC5nZXRTdHlsZXNoZWV0RWxlbWVudHNOb3RJblNuYXBzaG90KHRoaXMubmV3SGVhZFNuYXBzaG90KVxuICB9XG5cbiAgZ2V0IG5ld0hlYWRTdHlsZXNoZWV0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3SGVhZFNuYXBzaG90LmdldFN0eWxlc2hlZXRFbGVtZW50c05vdEluU25hcHNob3QodGhpcy5jdXJyZW50SGVhZFNuYXBzaG90KVxuICB9XG5cbiAgZ2V0IG5ld0hlYWRTY3JpcHRFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5uZXdIZWFkU25hcHNob3QuZ2V0U2NyaXB0RWxlbWVudHNOb3RJblNuYXBzaG90KHRoaXMuY3VycmVudEhlYWRTbmFwc2hvdClcbiAgfVxuXG4gIGdldCBjdXJyZW50SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWRTbmFwc2hvdC5wcm92aXNpb25hbEVsZW1lbnRzXG4gIH1cblxuICBnZXQgbmV3SGVhZFByb3Zpc2lvbmFsRWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3SGVhZFNuYXBzaG90LnByb3Zpc2lvbmFsRWxlbWVudHNcbiAgfVxuXG4gIGdldCBuZXdCb2R5U2NyaXB0RWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubmV3RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2NyaXB0XCIpXG4gIH1cbn1cblxuY2xhc3MgTW9ycGhpbmdQYWdlUmVuZGVyZXIgZXh0ZW5kcyBQYWdlUmVuZGVyZXIge1xuICBzdGF0aWMgcmVuZGVyRWxlbWVudChjdXJyZW50RWxlbWVudCwgbmV3RWxlbWVudCkge1xuICAgIG1vcnBoRWxlbWVudHMoY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQsIHtcbiAgICAgIGNhbGxiYWNrczoge1xuICAgICAgICBiZWZvcmVOb2RlTW9ycGhlZDogZWxlbWVudCA9PiAhY2FuUmVmcmVzaEZyYW1lKGVsZW1lbnQpXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBmb3IgKGNvbnN0IGZyYW1lIG9mIGN1cnJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0dXJiby1mcmFtZVwiKSkge1xuICAgICAgaWYgKGNhblJlZnJlc2hGcmFtZShmcmFtZSkpIGZyYW1lLnJlbG9hZCgpO1xuICAgIH1cblxuICAgIGRpc3BhdGNoKFwidHVyYm86bW9ycGhcIiwgeyBkZXRhaWw6IHsgY3VycmVudEVsZW1lbnQsIG5ld0VsZW1lbnQgfSB9KTtcbiAgfVxuXG4gIGFzeW5jIHByZXNlcnZpbmdQZXJtYW5lbnRFbGVtZW50cyhjYWxsYmFjaykge1xuICAgIHJldHVybiBhd2FpdCBjYWxsYmFjaygpXG4gIH1cblxuICBnZXQgcmVuZGVyTWV0aG9kKCkge1xuICAgIHJldHVybiBcIm1vcnBoXCJcbiAgfVxuXG4gIGdldCBzaG91bGRBdXRvZm9jdXMoKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24gY2FuUmVmcmVzaEZyYW1lKGZyYW1lKSB7XG4gIHJldHVybiBmcmFtZSBpbnN0YW5jZW9mIEZyYW1lRWxlbWVudCAmJlxuICAgIGZyYW1lLnNyYyAmJlxuICAgIGZyYW1lLnJlZnJlc2ggPT09IFwibW9ycGhcIiAmJlxuICAgICFmcmFtZS5jbG9zZXN0KFwiW2RhdGEtdHVyYm8tcGVybWFuZW50XVwiKVxufVxuXG5jbGFzcyBTbmFwc2hvdENhY2hlIHtcbiAga2V5cyA9IFtdXG4gIHNuYXBzaG90cyA9IHt9XG5cbiAgY29uc3RydWN0b3Ioc2l6ZSkge1xuICAgIHRoaXMuc2l6ZSA9IHNpemU7XG4gIH1cblxuICBoYXMobG9jYXRpb24pIHtcbiAgICByZXR1cm4gdG9DYWNoZUtleShsb2NhdGlvbikgaW4gdGhpcy5zbmFwc2hvdHNcbiAgfVxuXG4gIGdldChsb2NhdGlvbikge1xuICAgIGlmICh0aGlzLmhhcyhsb2NhdGlvbikpIHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy5yZWFkKGxvY2F0aW9uKTtcbiAgICAgIHRoaXMudG91Y2gobG9jYXRpb24pO1xuICAgICAgcmV0dXJuIHNuYXBzaG90XG4gICAgfVxuICB9XG5cbiAgcHV0KGxvY2F0aW9uLCBzbmFwc2hvdCkge1xuICAgIHRoaXMud3JpdGUobG9jYXRpb24sIHNuYXBzaG90KTtcbiAgICB0aGlzLnRvdWNoKGxvY2F0aW9uKTtcbiAgICByZXR1cm4gc25hcHNob3RcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuc25hcHNob3RzID0ge307XG4gIH1cblxuICAvLyBQcml2YXRlXG5cbiAgcmVhZChsb2NhdGlvbikge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90c1t0b0NhY2hlS2V5KGxvY2F0aW9uKV1cbiAgfVxuXG4gIHdyaXRlKGxvY2F0aW9uLCBzbmFwc2hvdCkge1xuICAgIHRoaXMuc25hcHNob3RzW3RvQ2FjaGVLZXkobG9jYXRpb24pXSA9IHNuYXBzaG90O1xuICB9XG5cbiAgdG91Y2gobG9jYXRpb24pIHtcbiAgICBjb25zdCBrZXkgPSB0b0NhY2hlS2V5KGxvY2F0aW9uKTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMua2V5cy5pbmRleE9mKGtleSk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHRoaXMua2V5cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIHRoaXMua2V5cy51bnNoaWZ0KGtleSk7XG4gICAgdGhpcy50cmltKCk7XG4gIH1cblxuICB0cmltKCkge1xuICAgIGZvciAoY29uc3Qga2V5IG9mIHRoaXMua2V5cy5zcGxpY2UodGhpcy5zaXplKSkge1xuICAgICAgZGVsZXRlIHRoaXMuc25hcHNob3RzW2tleV07XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFBhZ2VWaWV3IGV4dGVuZHMgVmlldyB7XG4gIHNuYXBzaG90Q2FjaGUgPSBuZXcgU25hcHNob3RDYWNoZSgxMClcbiAgbGFzdFJlbmRlcmVkTG9jYXRpb24gPSBuZXcgVVJMKGxvY2F0aW9uLmhyZWYpXG4gIGZvcmNlUmVsb2FkZWQgPSBmYWxzZVxuXG4gIHNob3VsZFRyYW5zaXRpb25UbyhuZXdTbmFwc2hvdCkge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90LnByZWZlcnNWaWV3VHJhbnNpdGlvbnMgJiYgbmV3U25hcHNob3QucHJlZmVyc1ZpZXdUcmFuc2l0aW9uc1xuICB9XG5cbiAgcmVuZGVyUGFnZShzbmFwc2hvdCwgaXNQcmV2aWV3ID0gZmFsc2UsIHdpbGxSZW5kZXIgPSB0cnVlLCB2aXNpdCkge1xuICAgIGNvbnN0IHNob3VsZE1vcnBoUGFnZSA9IHRoaXMuaXNQYWdlUmVmcmVzaCh2aXNpdCkgJiYgdGhpcy5zbmFwc2hvdC5zaG91bGRNb3JwaFBhZ2U7XG4gICAgY29uc3QgcmVuZGVyZXJDbGFzcyA9IHNob3VsZE1vcnBoUGFnZSA/IE1vcnBoaW5nUGFnZVJlbmRlcmVyIDogUGFnZVJlbmRlcmVyO1xuXG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgcmVuZGVyZXJDbGFzcyh0aGlzLnNuYXBzaG90LCBzbmFwc2hvdCwgaXNQcmV2aWV3LCB3aWxsUmVuZGVyKTtcblxuICAgIGlmICghcmVuZGVyZXIuc2hvdWxkUmVuZGVyKSB7XG4gICAgICB0aGlzLmZvcmNlUmVsb2FkZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2aXNpdD8uY2hhbmdlSGlzdG9yeSgpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlbmRlcihyZW5kZXJlcilcbiAgfVxuXG4gIHJlbmRlckVycm9yKHNuYXBzaG90LCB2aXNpdCkge1xuICAgIHZpc2l0Py5jaGFuZ2VIaXN0b3J5KCk7XG4gICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgRXJyb3JSZW5kZXJlcih0aGlzLnNuYXBzaG90LCBzbmFwc2hvdCwgZmFsc2UpO1xuICAgIHJldHVybiB0aGlzLnJlbmRlcihyZW5kZXJlcilcbiAgfVxuXG4gIGNsZWFyU25hcHNob3RDYWNoZSgpIHtcbiAgICB0aGlzLnNuYXBzaG90Q2FjaGUuY2xlYXIoKTtcbiAgfVxuXG4gIGFzeW5jIGNhY2hlU25hcHNob3Qoc25hcHNob3QgPSB0aGlzLnNuYXBzaG90KSB7XG4gICAgaWYgKHNuYXBzaG90LmlzQ2FjaGVhYmxlKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlLnZpZXdXaWxsQ2FjaGVTbmFwc2hvdCgpO1xuICAgICAgY29uc3QgeyBsYXN0UmVuZGVyZWRMb2NhdGlvbjogbG9jYXRpb24gfSA9IHRoaXM7XG4gICAgICBhd2FpdCBuZXh0RXZlbnRMb29wVGljaygpO1xuICAgICAgY29uc3QgY2FjaGVkU25hcHNob3QgPSBzbmFwc2hvdC5jbG9uZSgpO1xuICAgICAgdGhpcy5zbmFwc2hvdENhY2hlLnB1dChsb2NhdGlvbiwgY2FjaGVkU25hcHNob3QpO1xuICAgICAgcmV0dXJuIGNhY2hlZFNuYXBzaG90XG4gICAgfVxuICB9XG5cbiAgZ2V0Q2FjaGVkU25hcHNob3RGb3JMb2NhdGlvbihsb2NhdGlvbikge1xuICAgIHJldHVybiB0aGlzLnNuYXBzaG90Q2FjaGUuZ2V0KGxvY2F0aW9uKVxuICB9XG5cbiAgaXNQYWdlUmVmcmVzaCh2aXNpdCkge1xuICAgIHJldHVybiAhdmlzaXQgfHwgKHRoaXMubGFzdFJlbmRlcmVkTG9jYXRpb24ucGF0aG5hbWUgPT09IHZpc2l0LmxvY2F0aW9uLnBhdGhuYW1lICYmIHZpc2l0LmFjdGlvbiA9PT0gXCJyZXBsYWNlXCIpXG4gIH1cblxuICBzaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uKHZpc2l0KSB7XG4gICAgcmV0dXJuIHRoaXMuaXNQYWdlUmVmcmVzaCh2aXNpdCkgJiYgdGhpcy5zbmFwc2hvdC5zaG91bGRQcmVzZXJ2ZVNjcm9sbFBvc2l0aW9uXG4gIH1cblxuICBnZXQgc25hcHNob3QoKSB7XG4gICAgcmV0dXJuIFBhZ2VTbmFwc2hvdC5mcm9tRWxlbWVudCh0aGlzLmVsZW1lbnQpXG4gIH1cbn1cblxuY2xhc3MgUHJlbG9hZGVyIHtcbiAgc2VsZWN0b3IgPSBcImFbZGF0YS10dXJiby1wcmVsb2FkXVwiXG5cbiAgY29uc3RydWN0b3IoZGVsZWdhdGUsIHNuYXBzaG90Q2FjaGUpIHtcbiAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7XG4gICAgdGhpcy5zbmFwc2hvdENhY2hlID0gc25hcHNob3RDYWNoZTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgdGhpcy4jcHJlbG9hZEFsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhkb2N1bWVudC5ib2R5KTtcbiAgICB9XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIHRoaXMuI3ByZWxvYWRBbGwpO1xuICB9XG5cbiAgcHJlbG9hZE9uTG9hZExpbmtzRm9yVmlldyhlbGVtZW50KSB7XG4gICAgZm9yIChjb25zdCBsaW5rIG9mIGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yKSkge1xuICAgICAgaWYgKHRoaXMuZGVsZWdhdGUuc2hvdWxkUHJlbG9hZExpbmsobGluaykpIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVVJMKGxpbmspO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHByZWxvYWRVUkwobGluaykge1xuICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IFVSTChsaW5rLmhyZWYpO1xuXG4gICAgaWYgKHRoaXMuc25hcHNob3RDYWNoZS5oYXMobG9jYXRpb24pKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBmZXRjaFJlcXVlc3QgPSBuZXcgRmV0Y2hSZXF1ZXN0KHRoaXMsIEZldGNoTWV0aG9kLmdldCwgbG9jYXRpb24sIG5ldyBVUkxTZWFyY2hQYXJhbXMoKSwgbGluayk7XG4gICAgYXdhaXQgZmV0Y2hSZXF1ZXN0LnBlcmZvcm0oKTtcbiAgfVxuXG4gIC8vIEZldGNoIHJlcXVlc3QgZGVsZWdhdGVcblxuICBwcmVwYXJlUmVxdWVzdChmZXRjaFJlcXVlc3QpIHtcbiAgICBmZXRjaFJlcXVlc3QuaGVhZGVyc1tcIlgtU2VjLVB1cnBvc2VcIl0gPSBcInByZWZldGNoXCI7XG4gIH1cblxuICBhc3luYyByZXF1ZXN0U3VjY2VlZGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZUhUTUwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gUGFnZVNuYXBzaG90LmZyb21IVE1MU3RyaW5nKHJlc3BvbnNlSFRNTCk7XG5cbiAgICAgIHRoaXMuc25hcHNob3RDYWNoZS5wdXQoZmV0Y2hSZXF1ZXN0LnVybCwgc25hcHNob3QpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIC8vIElmIHdlIGNhbm5vdCBwcmVsb2FkIHRoYXQgaXMgb2shXG4gICAgfVxuICB9XG5cbiAgcmVxdWVzdFN0YXJ0ZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RFcnJvcmVkKGZldGNoUmVxdWVzdCkge31cblxuICByZXF1ZXN0RmluaXNoZWQoZmV0Y2hSZXF1ZXN0KSB7fVxuXG4gIHJlcXVlc3RQcmV2ZW50ZWRIYW5kbGluZ1Jlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICByZXF1ZXN0RmFpbGVkV2l0aFJlc3BvbnNlKGZldGNoUmVxdWVzdCwgZmV0Y2hSZXNwb25zZSkge31cblxuICAjcHJlbG9hZEFsbCA9ICgpID0+IHtcbiAgICB0aGlzLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZG9jdW1lbnQuYm9keSk7XG4gIH1cbn1cblxuY2xhc3MgQ2FjaGUge1xuICBjb25zdHJ1Y3RvcihzZXNzaW9uKSB7XG4gICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG4gIH1cblxuICByZXNldENhY2hlQ29udHJvbCgpIHtcbiAgICB0aGlzLiNzZXRDYWNoZUNvbnRyb2woXCJcIik7XG4gIH1cblxuICBleGVtcHRQYWdlRnJvbUNhY2hlKCkge1xuICAgIHRoaXMuI3NldENhY2hlQ29udHJvbChcIm5vLWNhY2hlXCIpO1xuICB9XG5cbiAgZXhlbXB0UGFnZUZyb21QcmV2aWV3KCkge1xuICAgIHRoaXMuI3NldENhY2hlQ29udHJvbChcIm5vLXByZXZpZXdcIik7XG4gIH1cblxuICAjc2V0Q2FjaGVDb250cm9sKHZhbHVlKSB7XG4gICAgc2V0TWV0YUNvbnRlbnQoXCJ0dXJiby1jYWNoZS1jb250cm9sXCIsIHZhbHVlKTtcbiAgfVxufVxuXG5jbGFzcyBTZXNzaW9uIHtcbiAgbmF2aWdhdG9yID0gbmV3IE5hdmlnYXRvcih0aGlzKVxuICBoaXN0b3J5ID0gbmV3IEhpc3RvcnkodGhpcylcbiAgdmlldyA9IG5ldyBQYWdlVmlldyh0aGlzLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpXG4gIGFkYXB0ZXIgPSBuZXcgQnJvd3NlckFkYXB0ZXIodGhpcylcblxuICBwYWdlT2JzZXJ2ZXIgPSBuZXcgUGFnZU9ic2VydmVyKHRoaXMpXG4gIGNhY2hlT2JzZXJ2ZXIgPSBuZXcgQ2FjaGVPYnNlcnZlcigpXG4gIGxpbmtQcmVmZXRjaE9ic2VydmVyID0gbmV3IExpbmtQcmVmZXRjaE9ic2VydmVyKHRoaXMsIGRvY3VtZW50KVxuICBsaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBMaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCB3aW5kb3cpXG4gIGZvcm1TdWJtaXRPYnNlcnZlciA9IG5ldyBGb3JtU3VibWl0T2JzZXJ2ZXIodGhpcywgZG9jdW1lbnQpXG4gIHNjcm9sbE9ic2VydmVyID0gbmV3IFNjcm9sbE9ic2VydmVyKHRoaXMpXG4gIHN0cmVhbU9ic2VydmVyID0gbmV3IFN0cmVhbU9ic2VydmVyKHRoaXMpXG4gIGZvcm1MaW5rQ2xpY2tPYnNlcnZlciA9IG5ldyBGb3JtTGlua0NsaWNrT2JzZXJ2ZXIodGhpcywgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KVxuICBmcmFtZVJlZGlyZWN0b3IgPSBuZXcgRnJhbWVSZWRpcmVjdG9yKHRoaXMsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudClcbiAgc3RyZWFtTWVzc2FnZVJlbmRlcmVyID0gbmV3IFN0cmVhbU1lc3NhZ2VSZW5kZXJlcigpXG4gIGNhY2hlID0gbmV3IENhY2hlKHRoaXMpXG5cbiAgZW5hYmxlZCA9IHRydWVcbiAgc3RhcnRlZCA9IGZhbHNlXG4gICNwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gMTUwXG5cbiAgY29uc3RydWN0b3IocmVjZW50UmVxdWVzdHMpIHtcbiAgICB0aGlzLnJlY2VudFJlcXVlc3RzID0gcmVjZW50UmVxdWVzdHM7XG4gICAgdGhpcy5wcmVsb2FkZXIgPSBuZXcgUHJlbG9hZGVyKHRoaXMsIHRoaXMudmlldy5zbmFwc2hvdENhY2hlKTtcbiAgICB0aGlzLmRlYm91bmNlZFJlZnJlc2ggPSB0aGlzLnJlZnJlc2g7XG4gICAgdGhpcy5wYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gdGhpcy5wYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kO1xuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucGFnZU9ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmNhY2hlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMubGlua1ByZWZldGNoT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmZvcm1TdWJtaXRPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5zY3JvbGxPYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5zdHJlYW1PYnNlcnZlci5zdGFydCgpO1xuICAgICAgdGhpcy5mcmFtZVJlZGlyZWN0b3Iuc3RhcnQoKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5zdGFydCgpO1xuICAgICAgdGhpcy5wcmVsb2FkZXIuc3RhcnQoKTtcbiAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGRpc2FibGUoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHRoaXMucGFnZU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuY2FjaGVPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLmxpbmtQcmVmZXRjaE9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMubGlua0NsaWNrT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5zY3JvbGxPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLnN0cmVhbU9ic2VydmVyLnN0b3AoKTtcbiAgICAgIHRoaXMuZnJhbWVSZWRpcmVjdG9yLnN0b3AoKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5zdG9wKCk7XG4gICAgICB0aGlzLnByZWxvYWRlci5zdG9wKCk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZWdpc3RlckFkYXB0ZXIoYWRhcHRlcikge1xuICAgIHRoaXMuYWRhcHRlciA9IGFkYXB0ZXI7XG4gIH1cblxuICB2aXNpdChsb2NhdGlvbiwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgZnJhbWVFbGVtZW50ID0gb3B0aW9ucy5mcmFtZSA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMuZnJhbWUpIDogbnVsbDtcblxuICAgIGlmIChmcmFtZUVsZW1lbnQgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IG9wdGlvbnMuYWN0aW9uIHx8IGdldFZpc2l0QWN0aW9uKGZyYW1lRWxlbWVudCk7XG5cbiAgICAgIGZyYW1lRWxlbWVudC5kZWxlZ2F0ZS5wcm9wb3NlVmlzaXRJZk5hdmlnYXRlZFdpdGhBY3Rpb24oZnJhbWVFbGVtZW50LCBhY3Rpb24pO1xuICAgICAgZnJhbWVFbGVtZW50LnNyYyA9IGxvY2F0aW9uLnRvU3RyaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubmF2aWdhdG9yLnByb3Bvc2VWaXNpdChleHBhbmRVUkwobG9jYXRpb24pLCBvcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICByZWZyZXNoKHVybCwgcmVxdWVzdElkKSB7XG4gICAgY29uc3QgaXNSZWNlbnRSZXF1ZXN0ID0gcmVxdWVzdElkICYmIHRoaXMucmVjZW50UmVxdWVzdHMuaGFzKHJlcXVlc3RJZCk7XG4gICAgaWYgKCFpc1JlY2VudFJlcXVlc3QgJiYgIXRoaXMubmF2aWdhdG9yLmN1cnJlbnRWaXNpdCkge1xuICAgICAgdGhpcy52aXNpdCh1cmwsIHsgYWN0aW9uOiBcInJlcGxhY2VcIiwgc2hvdWxkQ2FjaGVTbmFwc2hvdDogZmFsc2UgfSk7XG4gICAgfVxuICB9XG5cbiAgY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgICB0aGlzLnN0cmVhbU9ic2VydmVyLmNvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gICAgdGhpcy5zdHJlYW1PYnNlcnZlci5kaXNjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSk7XG4gIH1cblxuICByZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICB0aGlzLnN0cmVhbU1lc3NhZ2VSZW5kZXJlci5yZW5kZXIoU3RyZWFtTWVzc2FnZS53cmFwKG1lc3NhZ2UpKTtcbiAgfVxuXG4gIGNsZWFyQ2FjaGUoKSB7XG4gICAgdGhpcy52aWV3LmNsZWFyU25hcHNob3RDYWNoZSgpO1xuICB9XG5cbiAgc2V0UHJvZ3Jlc3NCYXJEZWxheShkZWxheSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiUGxlYXNlIHJlcGxhY2UgYHNlc3Npb24uc2V0UHJvZ3Jlc3NCYXJEZWxheShkZWxheSlgIHdpdGggYHNlc3Npb24ucHJvZ3Jlc3NCYXJEZWxheSA9IGRlbGF5YC4gVGhlIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uIG9mIFR1cmJvLmBcIlxuICAgICk7XG5cbiAgICB0aGlzLnByb2dyZXNzQmFyRGVsYXkgPSBkZWxheTtcbiAgfVxuXG4gIHNldCBwcm9ncmVzc0JhckRlbGF5KGRlbGF5KSB7XG4gICAgY29uZmlnLmRyaXZlLnByb2dyZXNzQmFyRGVsYXkgPSBkZWxheTtcbiAgfVxuXG4gIGdldCBwcm9ncmVzc0JhckRlbGF5KCkge1xuICAgIHJldHVybiBjb25maWcuZHJpdmUucHJvZ3Jlc3NCYXJEZWxheVxuICB9XG5cbiAgc2V0IGRyaXZlKHZhbHVlKSB7XG4gICAgY29uZmlnLmRyaXZlLmVuYWJsZWQgPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBkcml2ZSgpIHtcbiAgICByZXR1cm4gY29uZmlnLmRyaXZlLmVuYWJsZWRcbiAgfVxuXG4gIHNldCBmb3JtTW9kZSh2YWx1ZSkge1xuICAgIGNvbmZpZy5mb3Jtcy5tb2RlID0gdmFsdWU7XG4gIH1cblxuICBnZXQgZm9ybU1vZGUoKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5mb3Jtcy5tb2RlXG4gIH1cblxuICBnZXQgbG9jYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5sb2NhdGlvblxuICB9XG5cbiAgZ2V0IHJlc3RvcmF0aW9uSWRlbnRpZmllcigpIHtcbiAgICByZXR1cm4gdGhpcy5oaXN0b3J5LnJlc3RvcmF0aW9uSWRlbnRpZmllclxuICB9XG5cbiAgZ2V0IHBhZ2VSZWZyZXNoRGVib3VuY2VQZXJpb2QoKSB7XG4gICAgcmV0dXJuIHRoaXMuI3BhZ2VSZWZyZXNoRGVib3VuY2VQZXJpb2RcbiAgfVxuXG4gIHNldCBwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kKHZhbHVlKSB7XG4gICAgdGhpcy5yZWZyZXNoID0gZGVib3VuY2UodGhpcy5kZWJvdW5jZWRSZWZyZXNoLmJpbmQodGhpcyksIHZhbHVlKTtcbiAgICB0aGlzLiNwYWdlUmVmcmVzaERlYm91bmNlUGVyaW9kID0gdmFsdWU7XG4gIH1cblxuICAvLyBQcmVsb2FkZXIgZGVsZWdhdGVcblxuICBzaG91bGRQcmVsb2FkTGluayhlbGVtZW50KSB7XG4gICAgY29uc3QgaXNVbnNhZmUgPSBlbGVtZW50Lmhhc0F0dHJpYnV0ZShcImRhdGEtdHVyYm8tbWV0aG9kXCIpO1xuICAgIGNvbnN0IGlzU3RyZWFtID0gZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKTtcbiAgICBjb25zdCBmcmFtZVRhcmdldCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10dXJiby1mcmFtZVwiKTtcbiAgICBjb25zdCBmcmFtZSA9IGZyYW1lVGFyZ2V0ID09IFwiX3RvcFwiID9cbiAgICAgIG51bGwgOlxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhbWVUYXJnZXQpIHx8IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkoZWxlbWVudCwgXCJ0dXJiby1mcmFtZTpub3QoW2Rpc2FibGVkXSlcIik7XG5cbiAgICBpZiAoaXNVbnNhZmUgfHwgaXNTdHJlYW0gfHwgZnJhbWUgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9IG5ldyBVUkwoZWxlbWVudC5ocmVmKTtcblxuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCkgJiYgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gICAgfVxuICB9XG5cbiAgLy8gSGlzdG9yeSBkZWxlZ2F0ZVxuXG4gIGhpc3RvcnlQb3BwZWRUb0xvY2F0aW9uV2l0aFJlc3RvcmF0aW9uSWRlbnRpZmllckFuZERpcmVjdGlvbihsb2NhdGlvbiwgcmVzdG9yYXRpb25JZGVudGlmaWVyLCBkaXJlY3Rpb24pIHtcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLm5hdmlnYXRvci5zdGFydFZpc2l0KGxvY2F0aW9uLCByZXN0b3JhdGlvbklkZW50aWZpZXIsIHtcbiAgICAgICAgYWN0aW9uOiBcInJlc3RvcmVcIixcbiAgICAgICAgaGlzdG9yeUNoYW5nZWQ6IHRydWUsXG4gICAgICAgIGRpcmVjdGlvblxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWRhcHRlci5wYWdlSW52YWxpZGF0ZWQoe1xuICAgICAgICByZWFzb246IFwidHVyYm9fZGlzYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU2Nyb2xsIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgc2Nyb2xsUG9zaXRpb25DaGFuZ2VkKHBvc2l0aW9uKSB7XG4gICAgdGhpcy5oaXN0b3J5LnVwZGF0ZVJlc3RvcmF0aW9uRGF0YSh7IHNjcm9sbFBvc2l0aW9uOiBwb3NpdGlvbiB9KTtcbiAgfVxuXG4gIC8vIEZvcm0gY2xpY2sgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybUxpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUobGluaykgJiYgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gIH1cblxuICBzdWJtaXR0ZWRGb3JtTGlua1RvTG9jYXRpb24oKSB7fVxuXG4gIC8vIExpbmsgaG92ZXIgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBjYW5QcmVmZXRjaFJlcXVlc3RUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUobGluaykgJiZcbiAgICAgICAgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pXG4gICAgKVxuICB9XG5cbiAgLy8gTGluayBjbGljayBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxGb2xsb3dMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXZlbnQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5lbGVtZW50SXNOYXZpZ2F0YWJsZShsaW5rKSAmJlxuICAgICAgbG9jYXRpb25Jc1Zpc2l0YWJsZShsb2NhdGlvbiwgdGhpcy5zbmFwc2hvdC5yb290TG9jYXRpb24pICYmXG4gICAgICB0aGlzLmFwcGxpY2F0aW9uQWxsb3dzRm9sbG93aW5nTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24sIGV2ZW50KVxuICAgIClcbiAgfVxuXG4gIGZvbGxvd2VkTGlua1RvTG9jYXRpb24obGluaywgbG9jYXRpb24pIHtcbiAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmdldEFjdGlvbkZvckxpbmsobGluayk7XG4gICAgY29uc3QgYWNjZXB0c1N0cmVhbVJlc3BvbnNlID0gbGluay5oYXNBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLXN0cmVhbVwiKTtcblxuICAgIHRoaXMudmlzaXQobG9jYXRpb24uaHJlZiwgeyBhY3Rpb24sIGFjY2VwdHNTdHJlYW1SZXNwb25zZSB9KTtcbiAgfVxuXG4gIC8vIE5hdmlnYXRvciBkZWxlZ2F0ZVxuXG4gIGFsbG93c1Zpc2l0aW5nTG9jYXRpb25XaXRoQWN0aW9uKGxvY2F0aW9uLCBhY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhdGlvbldpdGhBY3Rpb25Jc1NhbWVQYWdlKGxvY2F0aW9uLCBhY3Rpb24pIHx8IHRoaXMuYXBwbGljYXRpb25BbGxvd3NWaXNpdGluZ0xvY2F0aW9uKGxvY2F0aW9uKVxuICB9XG5cbiAgdmlzaXRQcm9wb3NlZFRvTG9jYXRpb24obG9jYXRpb24sIG9wdGlvbnMpIHtcbiAgICBleHRlbmRVUkxXaXRoRGVwcmVjYXRlZFByb3BlcnRpZXMobG9jYXRpb24pO1xuICAgIHRoaXMuYWRhcHRlci52aXNpdFByb3Bvc2VkVG9Mb2NhdGlvbihsb2NhdGlvbiwgb3B0aW9ucyk7XG4gIH1cblxuICAvLyBWaXNpdCBkZWxlZ2F0ZVxuXG4gIHZpc2l0U3RhcnRlZCh2aXNpdCkge1xuICAgIGlmICghdmlzaXQuYWNjZXB0c1N0cmVhbVJlc3BvbnNlKSB7XG4gICAgICBtYXJrQXNCdXN5KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCk7XG4gICAgICB0aGlzLnZpZXcubWFya1Zpc2l0RGlyZWN0aW9uKHZpc2l0LmRpcmVjdGlvbik7XG4gICAgfVxuICAgIGV4dGVuZFVSTFdpdGhEZXByZWNhdGVkUHJvcGVydGllcyh2aXNpdC5sb2NhdGlvbik7XG4gICAgaWYgKCF2aXNpdC5zaWxlbnQpIHtcbiAgICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlclZpc2l0aW5nTG9jYXRpb24odmlzaXQubG9jYXRpb24sIHZpc2l0LmFjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgdmlzaXRDb21wbGV0ZWQodmlzaXQpIHtcbiAgICB0aGlzLnZpZXcudW5tYXJrVmlzaXREaXJlY3Rpb24oKTtcbiAgICBjbGVhckJ1c3lTdGF0ZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlclBhZ2VMb2FkKHZpc2l0LmdldFRpbWluZ01ldHJpY3MoKSk7XG4gIH1cblxuICBsb2NhdGlvbldpdGhBY3Rpb25Jc1NhbWVQYWdlKGxvY2F0aW9uLCBhY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5uYXZpZ2F0b3IubG9jYXRpb25XaXRoQWN0aW9uSXNTYW1lUGFnZShsb2NhdGlvbiwgYWN0aW9uKVxuICB9XG5cbiAgdmlzaXRTY3JvbGxlZFRvU2FtZVBhZ2VMb2NhdGlvbihvbGRVUkwsIG5ld1VSTCkge1xuICAgIHRoaXMubm90aWZ5QXBwbGljYXRpb25BZnRlclZpc2l0aW5nU2FtZVBhZ2VMb2NhdGlvbihvbGRVUkwsIG5ld1VSTCk7XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pdCBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHdpbGxTdWJtaXRGb3JtKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGFjdGlvbiA9IGdldEFjdGlvbiQxKGZvcm0sIHN1Ym1pdHRlcik7XG5cbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5zdWJtaXNzaW9uSXNOYXZpZ2F0YWJsZShmb3JtLCBzdWJtaXR0ZXIpICYmXG4gICAgICBsb2NhdGlvbklzVmlzaXRhYmxlKGV4cGFuZFVSTChhY3Rpb24pLCB0aGlzLnNuYXBzaG90LnJvb3RMb2NhdGlvbilcbiAgICApXG4gIH1cblxuICBmb3JtU3VibWl0dGVkKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIHRoaXMubmF2aWdhdG9yLnN1Ym1pdEZvcm0oZm9ybSwgc3VibWl0dGVyKTtcbiAgfVxuXG4gIC8vIFBhZ2Ugb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBwYWdlQmVjYW1lSW50ZXJhY3RpdmUoKSB7XG4gICAgdGhpcy52aWV3Lmxhc3RSZW5kZXJlZExvY2F0aW9uID0gdGhpcy5sb2NhdGlvbjtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJQYWdlTG9hZCgpO1xuICB9XG5cbiAgcGFnZUxvYWRlZCgpIHtcbiAgICB0aGlzLmhpc3RvcnkuYXNzdW1lQ29udHJvbE9mU2Nyb2xsUmVzdG9yYXRpb24oKTtcbiAgfVxuXG4gIHBhZ2VXaWxsVW5sb2FkKCkge1xuICAgIHRoaXMuaGlzdG9yeS5yZWxpbnF1aXNoQ29udHJvbE9mU2Nyb2xsUmVzdG9yYXRpb24oKTtcbiAgfVxuXG4gIC8vIFN0cmVhbSBvYnNlcnZlciBkZWxlZ2F0ZVxuXG4gIHJlY2VpdmVkTWVzc2FnZUZyb21TdHJlYW0obWVzc2FnZSkge1xuICAgIHRoaXMucmVuZGVyU3RyZWFtTWVzc2FnZShtZXNzYWdlKTtcbiAgfVxuXG4gIC8vIFBhZ2UgdmlldyBkZWxlZ2F0ZVxuXG4gIHZpZXdXaWxsQ2FjaGVTbmFwc2hvdCgpIHtcbiAgICBpZiAoIXRoaXMubmF2aWdhdG9yLmN1cnJlbnRWaXNpdD8uc2lsZW50KSB7XG4gICAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlQ2FjaGluZ1NuYXBzaG90KCk7XG4gICAgfVxuICB9XG5cbiAgYWxsb3dzSW1tZWRpYXRlUmVuZGVyKHsgZWxlbWVudCB9LCBvcHRpb25zKSB7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlUmVuZGVyKGVsZW1lbnQsIG9wdGlvbnMpO1xuICAgIGNvbnN0IHtcbiAgICAgIGRlZmF1bHRQcmV2ZW50ZWQsXG4gICAgICBkZXRhaWw6IHsgcmVuZGVyIH1cbiAgICB9ID0gZXZlbnQ7XG5cbiAgICBpZiAodGhpcy52aWV3LnJlbmRlcmVyICYmIHJlbmRlcikge1xuICAgICAgdGhpcy52aWV3LnJlbmRlcmVyLnJlbmRlckVsZW1lbnQgPSByZW5kZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuICFkZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICB2aWV3UmVuZGVyZWRTbmFwc2hvdChfc25hcHNob3QsIF9pc1ByZXZpZXcsIHJlbmRlck1ldGhvZCkge1xuICAgIHRoaXMudmlldy5sYXN0UmVuZGVyZWRMb2NhdGlvbiA9IHRoaXMuaGlzdG9yeS5sb2NhdGlvbjtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJSZW5kZXIocmVuZGVyTWV0aG9kKTtcbiAgfVxuXG4gIHByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZWxlbWVudCkge1xuICAgIHRoaXMucHJlbG9hZGVyLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZWxlbWVudCk7XG4gIH1cblxuICB2aWV3SW52YWxpZGF0ZWQocmVhc29uKSB7XG4gICAgdGhpcy5hZGFwdGVyLnBhZ2VJbnZhbGlkYXRlZChyZWFzb24pO1xuICB9XG5cbiAgLy8gRnJhbWUgZWxlbWVudFxuXG4gIGZyYW1lTG9hZGVkKGZyYW1lKSB7XG4gICAgdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyRnJhbWVMb2FkKGZyYW1lKTtcbiAgfVxuXG4gIGZyYW1lUmVuZGVyZWQoZmV0Y2hSZXNwb25zZSwgZnJhbWUpIHtcbiAgICB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJGcmFtZVJlbmRlcihmZXRjaFJlc3BvbnNlLCBmcmFtZSk7XG4gIH1cblxuICAvLyBBcHBsaWNhdGlvbiBldmVudHNcblxuICBhcHBsaWNhdGlvbkFsbG93c0ZvbGxvd2luZ0xpbmtUb0xvY2F0aW9uKGxpbmssIGxvY2F0aW9uLCBldikge1xuICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5ub3RpZnlBcHBsaWNhdGlvbkFmdGVyQ2xpY2tpbmdMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXYpO1xuICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZFxuICB9XG5cbiAgYXBwbGljYXRpb25BbGxvd3NWaXNpdGluZ0xvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLm5vdGlmeUFwcGxpY2F0aW9uQmVmb3JlVmlzaXRpbmdMb2NhdGlvbihsb2NhdGlvbik7XG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyQ2xpY2tpbmdMaW5rVG9Mb2NhdGlvbihsaW5rLCBsb2NhdGlvbiwgZXZlbnQpIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goXCJ0dXJibzpjbGlja1wiLCB7XG4gICAgICB0YXJnZXQ6IGxpbmssXG4gICAgICBkZXRhaWw6IHsgdXJsOiBsb2NhdGlvbi5ocmVmLCBvcmlnaW5hbEV2ZW50OiBldmVudCB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkJlZm9yZVZpc2l0aW5nTG9jYXRpb24obG9jYXRpb24pIHtcbiAgICByZXR1cm4gZGlzcGF0Y2goXCJ0dXJibzpiZWZvcmUtdmlzaXRcIiwge1xuICAgICAgZGV0YWlsOiB7IHVybDogbG9jYXRpb24uaHJlZiB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyVmlzaXRpbmdMb2NhdGlvbihsb2NhdGlvbiwgYWN0aW9uKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86dmlzaXRcIiwgeyBkZXRhaWw6IHsgdXJsOiBsb2NhdGlvbi5ocmVmLCBhY3Rpb24gfSB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25CZWZvcmVDYWNoaW5nU25hcHNob3QoKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWNhY2hlXCIpXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkJlZm9yZVJlbmRlcihuZXdCb2R5LCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLXJlbmRlclwiLCB7XG4gICAgICBkZXRhaWw6IHsgbmV3Qm9keSwgLi4ub3B0aW9ucyB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyUmVuZGVyKHJlbmRlck1ldGhvZCkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOnJlbmRlclwiLCB7IGRldGFpbDogeyByZW5kZXJNZXRob2QgfSB9KVxuICB9XG5cbiAgbm90aWZ5QXBwbGljYXRpb25BZnRlclBhZ2VMb2FkKHRpbWluZyA9IHt9KSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86bG9hZFwiLCB7XG4gICAgICBkZXRhaWw6IHsgdXJsOiB0aGlzLmxvY2F0aW9uLmhyZWYsIHRpbWluZyB9XG4gICAgfSlcbiAgfVxuXG4gIG5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJWaXNpdGluZ1NhbWVQYWdlTG9jYXRpb24ob2xkVVJMLCBuZXdVUkwpIHtcbiAgICBkaXNwYXRjaEV2ZW50KFxuICAgICAgbmV3IEhhc2hDaGFuZ2VFdmVudChcImhhc2hjaGFuZ2VcIiwge1xuICAgICAgICBvbGRVUkw6IG9sZFVSTC50b1N0cmluZygpLFxuICAgICAgICBuZXdVUkw6IG5ld1VSTC50b1N0cmluZygpXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBub3RpZnlBcHBsaWNhdGlvbkFmdGVyRnJhbWVMb2FkKGZyYW1lKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKFwidHVyYm86ZnJhbWUtbG9hZFwiLCB7IHRhcmdldDogZnJhbWUgfSlcbiAgfVxuXG4gIG5vdGlmeUFwcGxpY2F0aW9uQWZ0ZXJGcmFtZVJlbmRlcihmZXRjaFJlc3BvbnNlLCBmcmFtZSkge1xuICAgIHJldHVybiBkaXNwYXRjaChcInR1cmJvOmZyYW1lLXJlbmRlclwiLCB7XG4gICAgICBkZXRhaWw6IHsgZmV0Y2hSZXNwb25zZSB9LFxuICAgICAgdGFyZ2V0OiBmcmFtZSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWVcbiAgICB9KVxuICB9XG5cbiAgLy8gSGVscGVyc1xuXG4gIHN1Ym1pc3Npb25Jc05hdmlnYXRhYmxlKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIGlmIChjb25maWcuZm9ybXMubW9kZSA9PSBcIm9mZlwiKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc3VibWl0dGVySXNOYXZpZ2F0YWJsZSA9IHN1Ym1pdHRlciA/IHRoaXMuZWxlbWVudElzTmF2aWdhdGFibGUoc3VibWl0dGVyKSA6IHRydWU7XG5cbiAgICAgIGlmIChjb25maWcuZm9ybXMubW9kZSA9PSBcIm9wdGluXCIpIHtcbiAgICAgICAgcmV0dXJuIHN1Ym1pdHRlcklzTmF2aWdhdGFibGUgJiYgZm9ybS5jbG9zZXN0KCdbZGF0YS10dXJibz1cInRydWVcIl0nKSAhPSBudWxsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gc3VibWl0dGVySXNOYXZpZ2F0YWJsZSAmJiB0aGlzLmVsZW1lbnRJc05hdmlnYXRhYmxlKGZvcm0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGZpbmRDbG9zZXN0UmVjdXJzaXZlbHkoZWxlbWVudCwgXCJbZGF0YS10dXJib11cIik7XG4gICAgY29uc3Qgd2l0aGluRnJhbWUgPSBmaW5kQ2xvc2VzdFJlY3Vyc2l2ZWx5KGVsZW1lbnQsIFwidHVyYm8tZnJhbWVcIik7XG5cbiAgICAvLyBDaGVjayBpZiBEcml2ZSBpcyBlbmFibGVkIG9uIHRoZSBzZXNzaW9uIG9yIHdlJ3JlIHdpdGhpbiBhIEZyYW1lLlxuICAgIGlmIChjb25maWcuZHJpdmUuZW5hYmxlZCB8fCB3aXRoaW5GcmFtZSkge1xuICAgICAgLy8gRWxlbWVudCBpcyBuYXZpZ2F0YWJsZSBieSBkZWZhdWx0LCB1bmxlc3MgYGRhdGEtdHVyYm89XCJmYWxzZVwiYC5cbiAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvXCIpICE9IFwiZmFsc2VcIlxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRWxlbWVudCBpc24ndCBuYXZpZ2F0YWJsZSBieSBkZWZhdWx0LCB1bmxlc3MgYGRhdGEtdHVyYm89XCJ0cnVlXCJgLlxuICAgICAgaWYgKGNvbnRhaW5lcikge1xuICAgICAgICByZXR1cm4gY29udGFpbmVyLmdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm9cIikgPT0gXCJ0cnVlXCJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBnZXRBY3Rpb25Gb3JMaW5rKGxpbmspIHtcbiAgICByZXR1cm4gZ2V0VmlzaXRBY3Rpb24obGluaykgfHwgXCJhZHZhbmNlXCJcbiAgfVxuXG4gIGdldCBzbmFwc2hvdCgpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3LnNuYXBzaG90XG4gIH1cbn1cblxuLy8gT2xkZXIgdmVyc2lvbnMgb2YgdGhlIFR1cmJvIE5hdGl2ZSBhZGFwdGVycyByZWZlcmVuY2VkIHRoZVxuLy8gYExvY2F0aW9uI2Fic29sdXRlVVJMYCBwcm9wZXJ0eSBpbiB0aGVpciBpbXBsZW1lbnRhdGlvbnMgb2Zcbi8vIHRoZSBgQWRhcHRlciN2aXNpdFByb3Bvc2VkVG9Mb2NhdGlvbigpYCBhbmQgYCN2aXNpdFN0YXJ0ZWQoKWBcbi8vIG1ldGhvZHMuIFRoZSBMb2NhdGlvbiBjbGFzcyBoYXMgc2luY2UgYmVlbiByZW1vdmVkIGluIGZhdm9yXG4vLyBvZiB0aGUgRE9NIFVSTCBBUEksIGFuZCBhY2NvcmRpbmdseSBhbGwgQWRhcHRlciBtZXRob2RzIG5vd1xuLy8gcmVjZWl2ZSBVUkwgb2JqZWN0cy5cbi8vXG4vLyBXZSBhbGlhcyAjYWJzb2x1dGVVUkwgdG8gI3RvU3RyaW5nKCkgaGVyZSB0byBhdm9pZCBjcmFzaGluZ1xuLy8gb2xkZXIgYWRhcHRlcnMgd2hpY2ggZG8gbm90IGV4cGVjdCBVUkwgb2JqZWN0cy4gV2Ugc2hvdWxkXG4vLyBjb25zaWRlciByZW1vdmluZyB0aGlzIHN1cHBvcnQgYXQgc29tZSBwb2ludCBpbiB0aGUgZnV0dXJlLlxuXG5mdW5jdGlvbiBleHRlbmRVUkxXaXRoRGVwcmVjYXRlZFByb3BlcnRpZXModXJsKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHVybCwgZGVwcmVjYXRlZExvY2F0aW9uUHJvcGVydHlEZXNjcmlwdG9ycyk7XG59XG5cbmNvbnN0IGRlcHJlY2F0ZWRMb2NhdGlvblByb3BlcnR5RGVzY3JpcHRvcnMgPSB7XG4gIGFic29sdXRlVVJMOiB7XG4gICAgZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKVxuICAgIH1cbiAgfVxufTtcblxuY29uc3Qgc2Vzc2lvbiA9IG5ldyBTZXNzaW9uKHJlY2VudFJlcXVlc3RzKTtcbmNvbnN0IHsgY2FjaGUsIG5hdmlnYXRvcjogbmF2aWdhdG9yJDEgfSA9IHNlc3Npb247XG5cbi8qKlxuICogU3RhcnRzIHRoZSBtYWluIHNlc3Npb24uXG4gKiBUaGlzIGluaXRpYWxpc2VzIGFueSBuZWNlc3Nhcnkgb2JzZXJ2ZXJzIHN1Y2ggYXMgdGhvc2UgdG8gbW9uaXRvclxuICogbGluayBpbnRlcmFjdGlvbnMuXG4gKi9cbmZ1bmN0aW9uIHN0YXJ0KCkge1xuICBzZXNzaW9uLnN0YXJ0KCk7XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGFuIGFkYXB0ZXIgZm9yIHRoZSBtYWluIHNlc3Npb24uXG4gKlxuICogQHBhcmFtIGFkYXB0ZXIgQWRhcHRlciB0byByZWdpc3RlclxuICovXG5mdW5jdGlvbiByZWdpc3RlckFkYXB0ZXIoYWRhcHRlcikge1xuICBzZXNzaW9uLnJlZ2lzdGVyQWRhcHRlcihhZGFwdGVyKTtcbn1cblxuLyoqXG4gKiBQZXJmb3JtcyBhbiBhcHBsaWNhdGlvbiB2aXNpdCB0byB0aGUgZ2l2ZW4gbG9jYXRpb24uXG4gKlxuICogQHBhcmFtIGxvY2F0aW9uIExvY2F0aW9uIHRvIHZpc2l0IChhIFVSTCBvciBwYXRoKVxuICogQHBhcmFtIG9wdGlvbnMgT3B0aW9ucyB0byBhcHBseVxuICogQHBhcmFtIG9wdGlvbnMuYWN0aW9uIFR5cGUgb2YgaGlzdG9yeSBuYXZpZ2F0aW9uIHRvIGFwcGx5IChcInJlc3RvcmVcIixcbiAqIFwicmVwbGFjZVwiIG9yIFwiYWR2YW5jZVwiKVxuICogQHBhcmFtIG9wdGlvbnMuaGlzdG9yeUNoYW5nZWQgU3BlY2lmaWVzIHdoZXRoZXIgdGhlIGJyb3dzZXIgaGlzdG9yeSBoYXNcbiAqIGFscmVhZHkgYmVlbiBjaGFuZ2VkIGZvciB0aGlzIHZpc2l0IG9yIG5vdFxuICogQHBhcmFtIG9wdGlvbnMucmVmZXJyZXIgU3BlY2lmaWVzIHRoZSByZWZlcnJlciBvZiB0aGlzIHZpc2l0IHN1Y2ggdGhhdFxuICogbmF2aWdhdGlvbnMgdG8gdGhlIHNhbWUgcGFnZSB3aWxsIG5vdCByZXN1bHQgaW4gYSBuZXcgaGlzdG9yeSBlbnRyeS5cbiAqIEBwYXJhbSBvcHRpb25zLnNuYXBzaG90SFRNTCBDYWNoZWQgc25hcHNob3QgdG8gcmVuZGVyXG4gKiBAcGFyYW0gb3B0aW9ucy5yZXNwb25zZSBSZXNwb25zZSBvZiB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uXG4gKi9cbmZ1bmN0aW9uIHZpc2l0KGxvY2F0aW9uLCBvcHRpb25zKSB7XG4gIHNlc3Npb24udmlzaXQobG9jYXRpb24sIG9wdGlvbnMpO1xufVxuXG4vKipcbiAqIENvbm5lY3RzIGEgc3RyZWFtIHNvdXJjZSB0byB0aGUgbWFpbiBzZXNzaW9uLlxuICpcbiAqIEBwYXJhbSBzb3VyY2UgU3RyZWFtIHNvdXJjZSB0byBjb25uZWN0XG4gKi9cbmZ1bmN0aW9uIGNvbm5lY3RTdHJlYW1Tb3VyY2Uoc291cmNlKSB7XG4gIHNlc3Npb24uY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpO1xufVxuXG4vKipcbiAqIERpc2Nvbm5lY3RzIGEgc3RyZWFtIHNvdXJjZSBmcm9tIHRoZSBtYWluIHNlc3Npb24uXG4gKlxuICogQHBhcmFtIHNvdXJjZSBTdHJlYW0gc291cmNlIHRvIGRpc2Nvbm5lY3RcbiAqL1xuZnVuY3Rpb24gZGlzY29ubmVjdFN0cmVhbVNvdXJjZShzb3VyY2UpIHtcbiAgc2Vzc2lvbi5kaXNjb25uZWN0U3RyZWFtU291cmNlKHNvdXJjZSk7XG59XG5cbi8qKlxuICogUmVuZGVycyBhIHN0cmVhbSBtZXNzYWdlIHRvIHRoZSBtYWluIHNlc3Npb24gYnkgYXBwZW5kaW5nIGl0IHRvIHRoZVxuICogY3VycmVudCBkb2N1bWVudC5cbiAqXG4gKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIHJlbmRlclxuICovXG5mdW5jdGlvbiByZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgc2Vzc2lvbi5yZW5kZXJTdHJlYW1NZXNzYWdlKG1lc3NhZ2UpO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgYWxsIGVudHJpZXMgZnJvbSB0aGUgVHVyYm8gRHJpdmUgcGFnZSBjYWNoZS5cbiAqIENhbGwgdGhpcyB3aGVuIHN0YXRlIGhhcyBjaGFuZ2VkIG9uIHRoZSBzZXJ2ZXIgdGhhdCBtYXkgYWZmZWN0IGNhY2hlZCBwYWdlcy5cbiAqXG4gKiBAZGVwcmVjYXRlZCBzaW5jZSB2ZXJzaW9uIDcuMi4wIGluIGZhdm9yIG9mIGBUdXJiby5jYWNoZS5jbGVhcigpYFxuICovXG5mdW5jdGlvbiBjbGVhckNhY2hlKCkge1xuICBjb25zb2xlLndhcm4oXG4gICAgXCJQbGVhc2UgcmVwbGFjZSBgVHVyYm8uY2xlYXJDYWNoZSgpYCB3aXRoIGBUdXJiby5jYWNoZS5jbGVhcigpYC4gVGhlIHRvcC1sZXZlbCBmdW5jdGlvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBUdXJiby5gXCJcbiAgKTtcbiAgc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG59XG5cbi8qKlxuICogU2V0cyB0aGUgZGVsYXkgYWZ0ZXIgd2hpY2ggdGhlIHByb2dyZXNzIGJhciB3aWxsIGFwcGVhciBkdXJpbmcgbmF2aWdhdGlvbi5cbiAqXG4gKiBUaGUgcHJvZ3Jlc3MgYmFyIGFwcGVhcnMgYWZ0ZXIgNTAwbXMgYnkgZGVmYXVsdC5cbiAqXG4gKiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgaGFzIG5vIGVmZmVjdCB3aGVuIHVzZWQgd2l0aCB0aGUgaU9TIG9yIEFuZHJvaWRcbiAqIGFkYXB0ZXJzLlxuICpcbiAqIEBwYXJhbSBkZWxheSBUaW1lIHRvIGRlbGF5IGluIG1pbGxpc2Vjb25kc1xuICovXG5mdW5jdGlvbiBzZXRQcm9ncmVzc0JhckRlbGF5KGRlbGF5KSB7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIlBsZWFzZSByZXBsYWNlIGBUdXJiby5zZXRQcm9ncmVzc0JhckRlbGF5KGRlbGF5KWAgd2l0aCBgVHVyYm8uY29uZmlnLmRyaXZlLnByb2dyZXNzQmFyRGVsYXkgPSBkZWxheWAuIFRoZSB0b3AtbGV2ZWwgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIHZlcnNpb24gb2YgVHVyYm8uYFwiXG4gICk7XG4gIGNvbmZpZy5kcml2ZS5wcm9ncmVzc0JhckRlbGF5ID0gZGVsYXk7XG59XG5cbmZ1bmN0aW9uIHNldENvbmZpcm1NZXRob2QoY29uZmlybU1ldGhvZCkge1xuICBjb25zb2xlLndhcm4oXG4gICAgXCJQbGVhc2UgcmVwbGFjZSBgVHVyYm8uc2V0Q29uZmlybU1ldGhvZChjb25maXJtTWV0aG9kKWAgd2l0aCBgVHVyYm8uY29uZmlnLmZvcm1zLmNvbmZpcm0gPSBjb25maXJtTWV0aG9kYC4gVGhlIHRvcC1sZXZlbCBmdW5jdGlvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBUdXJiby5gXCJcbiAgKTtcbiAgY29uZmlnLmZvcm1zLmNvbmZpcm0gPSBjb25maXJtTWV0aG9kO1xufVxuXG5mdW5jdGlvbiBzZXRGb3JtTW9kZShtb2RlKSB7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIlBsZWFzZSByZXBsYWNlIGBUdXJiby5zZXRGb3JtTW9kZShtb2RlKWAgd2l0aCBgVHVyYm8uY29uZmlnLmZvcm1zLm1vZGUgPSBtb2RlYC4gVGhlIHRvcC1sZXZlbCBmdW5jdGlvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgdmVyc2lvbiBvZiBUdXJiby5gXCJcbiAgKTtcbiAgY29uZmlnLmZvcm1zLm1vZGUgPSBtb2RlO1xufVxuXG52YXIgVHVyYm8gPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgbmF2aWdhdG9yOiBuYXZpZ2F0b3IkMSxcbiAgc2Vzc2lvbjogc2Vzc2lvbixcbiAgY2FjaGU6IGNhY2hlLFxuICBQYWdlUmVuZGVyZXI6IFBhZ2VSZW5kZXJlcixcbiAgUGFnZVNuYXBzaG90OiBQYWdlU25hcHNob3QsXG4gIEZyYW1lUmVuZGVyZXI6IEZyYW1lUmVuZGVyZXIsXG4gIGZldGNoOiBmZXRjaFdpdGhUdXJib0hlYWRlcnMsXG4gIGNvbmZpZzogY29uZmlnLFxuICBzdGFydDogc3RhcnQsXG4gIHJlZ2lzdGVyQWRhcHRlcjogcmVnaXN0ZXJBZGFwdGVyLFxuICB2aXNpdDogdmlzaXQsXG4gIGNvbm5lY3RTdHJlYW1Tb3VyY2U6IGNvbm5lY3RTdHJlYW1Tb3VyY2UsXG4gIGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2U6IGRpc2Nvbm5lY3RTdHJlYW1Tb3VyY2UsXG4gIHJlbmRlclN0cmVhbU1lc3NhZ2U6IHJlbmRlclN0cmVhbU1lc3NhZ2UsXG4gIGNsZWFyQ2FjaGU6IGNsZWFyQ2FjaGUsXG4gIHNldFByb2dyZXNzQmFyRGVsYXk6IHNldFByb2dyZXNzQmFyRGVsYXksXG4gIHNldENvbmZpcm1NZXRob2Q6IHNldENvbmZpcm1NZXRob2QsXG4gIHNldEZvcm1Nb2RlOiBzZXRGb3JtTW9kZVxufSk7XG5cbmNsYXNzIFR1cmJvRnJhbWVNaXNzaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7fVxuXG5jbGFzcyBGcmFtZUNvbnRyb2xsZXIge1xuICBmZXRjaFJlc3BvbnNlTG9hZGVkID0gKF9mZXRjaFJlc3BvbnNlKSA9PiBQcm9taXNlLnJlc29sdmUoKVxuICAjY3VycmVudEZldGNoUmVxdWVzdCA9IG51bGxcbiAgI3Jlc29sdmVWaXNpdFByb21pc2UgPSAoKSA9PiB7fVxuICAjY29ubmVjdGVkID0gZmFsc2VcbiAgI2hhc0JlZW5Mb2FkZWQgPSBmYWxzZVxuICAjaWdub3JlZEF0dHJpYnV0ZXMgPSBuZXcgU2V0KClcbiAgI3Nob3VsZE1vcnBoRnJhbWUgPSBmYWxzZVxuICBhY3Rpb24gPSBudWxsXG5cbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy52aWV3ID0gbmV3IEZyYW1lVmlldyh0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMuYXBwZWFyYW5jZU9ic2VydmVyID0gbmV3IEFwcGVhcmFuY2VPYnNlcnZlcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyID0gbmV3IEZvcm1MaW5rQ2xpY2tPYnNlcnZlcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMubGlua0ludGVyY2VwdG9yID0gbmV3IExpbmtJbnRlcmNlcHRvcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICAgIHRoaXMucmVzdG9yYXRpb25JZGVudGlmaWVyID0gdXVpZCgpO1xuICAgIHRoaXMuZm9ybVN1Ym1pdE9ic2VydmVyID0gbmV3IEZvcm1TdWJtaXRPYnNlcnZlcih0aGlzLCB0aGlzLmVsZW1lbnQpO1xuICB9XG5cbiAgLy8gRnJhbWUgZGVsZWdhdGVcblxuICBjb25uZWN0KCkge1xuICAgIGlmICghdGhpcy4jY29ubmVjdGVkKSB7XG4gICAgICB0aGlzLiNjb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoaXMubG9hZGluZ1N0eWxlID09IEZyYW1lTG9hZGluZ1N0eWxlLmxhenkpIHtcbiAgICAgICAgdGhpcy5hcHBlYXJhbmNlT2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuI2xvYWRTb3VyY2VVUkwoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZm9ybUxpbmtDbGlja09ic2VydmVyLnN0YXJ0KCk7XG4gICAgICB0aGlzLmxpbmtJbnRlcmNlcHRvci5zdGFydCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RhcnQoKTtcbiAgICB9XG4gIH1cblxuICBkaXNjb25uZWN0KCkge1xuICAgIGlmICh0aGlzLiNjb25uZWN0ZWQpIHtcbiAgICAgIHRoaXMuI2Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5hcHBlYXJhbmNlT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtTGlua0NsaWNrT2JzZXJ2ZXIuc3RvcCgpO1xuICAgICAgdGhpcy5saW5rSW50ZXJjZXB0b3Iuc3RvcCgpO1xuICAgICAgdGhpcy5mb3JtU3VibWl0T2JzZXJ2ZXIuc3RvcCgpO1xuICAgIH1cbiAgfVxuXG4gIGRpc2FibGVkQ2hhbmdlZCgpIHtcbiAgICBpZiAodGhpcy5sb2FkaW5nU3R5bGUgPT0gRnJhbWVMb2FkaW5nU3R5bGUuZWFnZXIpIHtcbiAgICAgIHRoaXMuI2xvYWRTb3VyY2VVUkwoKTtcbiAgICB9XG4gIH1cblxuICBzb3VyY2VVUkxDaGFuZ2VkKCkge1xuICAgIGlmICh0aGlzLiNpc0lnbm9yaW5nQ2hhbmdlc1RvKFwic3JjXCIpKSByZXR1cm5cblxuICAgIGlmICh0aGlzLmVsZW1lbnQuaXNDb25uZWN0ZWQpIHtcbiAgICAgIHRoaXMuY29tcGxldGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5sb2FkaW5nU3R5bGUgPT0gRnJhbWVMb2FkaW5nU3R5bGUuZWFnZXIgfHwgdGhpcy4jaGFzQmVlbkxvYWRlZCkge1xuICAgICAgdGhpcy4jbG9hZFNvdXJjZVVSTCgpO1xuICAgIH1cbiAgfVxuXG4gIHNvdXJjZVVSTFJlbG9hZGVkKCkge1xuICAgIGNvbnN0IHsgcmVmcmVzaCwgc3JjIH0gPSB0aGlzLmVsZW1lbnQ7XG5cbiAgICB0aGlzLiNzaG91bGRNb3JwaEZyYW1lID0gc3JjICYmIHJlZnJlc2ggPT09IFwibW9ycGhcIjtcblxuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKTtcbiAgICB0aGlzLmVsZW1lbnQuc3JjID0gbnVsbDtcbiAgICB0aGlzLmVsZW1lbnQuc3JjID0gc3JjO1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQubG9hZGVkXG4gIH1cblxuICBsb2FkaW5nU3R5bGVDaGFuZ2VkKCkge1xuICAgIGlmICh0aGlzLmxvYWRpbmdTdHlsZSA9PSBGcmFtZUxvYWRpbmdTdHlsZS5sYXp5KSB7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdG9wKCk7XG4gICAgICB0aGlzLiNsb2FkU291cmNlVVJMKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgI2xvYWRTb3VyY2VVUkwoKSB7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmlzQWN0aXZlICYmICF0aGlzLmNvbXBsZXRlICYmIHRoaXMuc291cmNlVVJMKSB7XG4gICAgICB0aGlzLmVsZW1lbnQubG9hZGVkID0gdGhpcy4jdmlzaXQoZXhwYW5kVVJMKHRoaXMuc291cmNlVVJMKSk7XG4gICAgICB0aGlzLmFwcGVhcmFuY2VPYnNlcnZlci5zdG9wKCk7XG4gICAgICBhd2FpdCB0aGlzLmVsZW1lbnQubG9hZGVkO1xuICAgICAgdGhpcy4jaGFzQmVlbkxvYWRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZFJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICBpZiAoZmV0Y2hSZXNwb25zZS5yZWRpcmVjdGVkIHx8IChmZXRjaFJlc3BvbnNlLnN1Y2NlZWRlZCAmJiBmZXRjaFJlc3BvbnNlLmlzSFRNTCkpIHtcbiAgICAgIHRoaXMuc291cmNlVVJMID0gZmV0Y2hSZXNwb25zZS5yZXNwb25zZS51cmw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCBmZXRjaFJlc3BvbnNlLnJlc3BvbnNlSFRNTDtcbiAgICAgIGlmIChodG1sKSB7XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gcGFyc2VIVE1MRG9jdW1lbnQoaHRtbCk7XG4gICAgICAgIGNvbnN0IHBhZ2VTbmFwc2hvdCA9IFBhZ2VTbmFwc2hvdC5mcm9tRG9jdW1lbnQoZG9jdW1lbnQpO1xuXG4gICAgICAgIGlmIChwYWdlU25hcHNob3QuaXNWaXNpdGFibGUpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLiNsb2FkRnJhbWVSZXNwb25zZShmZXRjaFJlc3BvbnNlLCBkb2N1bWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy4jaGFuZGxlVW52aXNpdGFibGVGcmFtZVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuI3Nob3VsZE1vcnBoRnJhbWUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZmV0Y2hSZXNwb25zZUxvYWRlZCA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFwcGVhcmFuY2Ugb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICBlbGVtZW50QXBwZWFyZWRJblZpZXdwb3J0KGVsZW1lbnQpIHtcbiAgICB0aGlzLnByb3Bvc2VWaXNpdElmTmF2aWdhdGVkV2l0aEFjdGlvbihlbGVtZW50LCBnZXRWaXNpdEFjdGlvbihlbGVtZW50KSk7XG4gICAgdGhpcy4jbG9hZFNvdXJjZVVSTCgpO1xuICB9XG5cbiAgLy8gRm9ybSBsaW5rIGNsaWNrIG9ic2VydmVyIGRlbGVnYXRlXG5cbiAgd2lsbFN1Ym1pdEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuI3Nob3VsZEludGVyY2VwdE5hdmlnYXRpb24obGluaylcbiAgfVxuXG4gIHN1Ym1pdHRlZEZvcm1MaW5rVG9Mb2NhdGlvbihsaW5rLCBfbG9jYXRpb24sIGZvcm0pIHtcbiAgICBjb25zdCBmcmFtZSA9IHRoaXMuI2ZpbmRGcmFtZUVsZW1lbnQobGluayk7XG4gICAgaWYgKGZyYW1lKSBmb3JtLnNldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgZnJhbWUuaWQpO1xuICB9XG5cbiAgLy8gTGluayBpbnRlcmNlcHRvciBkZWxlZ2F0ZVxuXG4gIHNob3VsZEludGVyY2VwdExpbmtDbGljayhlbGVtZW50LCBfbG9jYXRpb24sIF9ldmVudCkge1xuICAgIHJldHVybiB0aGlzLiNzaG91bGRJbnRlcmNlcHROYXZpZ2F0aW9uKGVsZW1lbnQpXG4gIH1cblxuICBsaW5rQ2xpY2tJbnRlcmNlcHRlZChlbGVtZW50LCBsb2NhdGlvbikge1xuICAgIHRoaXMuI25hdmlnYXRlRnJhbWUoZWxlbWVudCwgbG9jYXRpb24pO1xuICB9XG5cbiAgLy8gRm9ybSBzdWJtaXQgb2JzZXJ2ZXIgZGVsZWdhdGVcblxuICB3aWxsU3VibWl0Rm9ybShlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICByZXR1cm4gZWxlbWVudC5jbG9zZXN0KFwidHVyYm8tZnJhbWVcIikgPT0gdGhpcy5lbGVtZW50ICYmIHRoaXMuI3Nob3VsZEludGVyY2VwdE5hdmlnYXRpb24oZWxlbWVudCwgc3VibWl0dGVyKVxuICB9XG5cbiAgZm9ybVN1Ym1pdHRlZChlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBpZiAodGhpcy5mb3JtU3VibWlzc2lvbikge1xuICAgICAgdGhpcy5mb3JtU3VibWlzc2lvbi5zdG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy5mb3JtU3VibWlzc2lvbiA9IG5ldyBGb3JtU3VibWlzc2lvbih0aGlzLCBlbGVtZW50LCBzdWJtaXR0ZXIpO1xuICAgIGNvbnN0IHsgZmV0Y2hSZXF1ZXN0IH0gPSB0aGlzLmZvcm1TdWJtaXNzaW9uO1xuICAgIHRoaXMucHJlcGFyZVJlcXVlc3QoZmV0Y2hSZXF1ZXN0KTtcbiAgICB0aGlzLmZvcm1TdWJtaXNzaW9uLnN0YXJ0KCk7XG4gIH1cblxuICAvLyBGZXRjaCByZXF1ZXN0IGRlbGVnYXRlXG5cbiAgcHJlcGFyZVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJlcXVlc3QuaGVhZGVyc1tcIlR1cmJvLUZyYW1lXCJdID0gdGhpcy5pZDtcblxuICAgIGlmICh0aGlzLmN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudD8uaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdHJlYW1cIikpIHtcbiAgICAgIHJlcXVlc3QuYWNjZXB0UmVzcG9uc2VUeXBlKFN0cmVhbU1lc3NhZ2UuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlcXVlc3RTdGFydGVkKF9yZXF1ZXN0KSB7XG4gICAgbWFya0FzQnVzeSh0aGlzLmVsZW1lbnQpO1xuICB9XG5cbiAgcmVxdWVzdFByZXZlbnRlZEhhbmRsaW5nUmVzcG9uc2UoX3JlcXVlc3QsIF9yZXNwb25zZSkge1xuICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKTtcbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RTdWNjZWVkZWRXaXRoUmVzcG9uc2UocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRSZXNwb25zZShyZXNwb25zZSk7XG4gICAgdGhpcy4jcmVzb2x2ZVZpc2l0UHJvbWlzZSgpO1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdEZhaWxlZFdpdGhSZXNwb25zZShyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGF3YWl0IHRoaXMubG9hZFJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlKCk7XG4gIH1cblxuICByZXF1ZXN0RXJyb3JlZChyZXF1ZXN0LCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKTtcbiAgfVxuXG4gIHJlcXVlc3RGaW5pc2hlZChfcmVxdWVzdCkge1xuICAgIGNsZWFyQnVzeVN0YXRlKHRoaXMuZWxlbWVudCk7XG4gIH1cblxuICAvLyBGb3JtIHN1Ym1pc3Npb24gZGVsZWdhdGVcblxuICBmb3JtU3VibWlzc2lvblN0YXJ0ZWQoeyBmb3JtRWxlbWVudCB9KSB7XG4gICAgbWFya0FzQnVzeShmb3JtRWxlbWVudCwgdGhpcy4jZmluZEZyYW1lRWxlbWVudChmb3JtRWxlbWVudCkpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25TdWNjZWVkZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIHJlc3BvbnNlKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGZvcm1TdWJtaXNzaW9uLmZvcm1FbGVtZW50LCBmb3JtU3VibWlzc2lvbi5zdWJtaXR0ZXIpO1xuXG4gICAgZnJhbWUuZGVsZWdhdGUucHJvcG9zZVZpc2l0SWZOYXZpZ2F0ZWRXaXRoQWN0aW9uKGZyYW1lLCBnZXRWaXNpdEFjdGlvbihmb3JtU3VibWlzc2lvbi5zdWJtaXR0ZXIsIGZvcm1TdWJtaXNzaW9uLmZvcm1FbGVtZW50LCBmcmFtZSkpO1xuICAgIGZyYW1lLmRlbGVnYXRlLmxvYWRSZXNwb25zZShyZXNwb25zZSk7XG5cbiAgICBpZiAoIWZvcm1TdWJtaXNzaW9uLmlzU2FmZSkge1xuICAgICAgc2Vzc2lvbi5jbGVhckNhY2hlKCk7XG4gICAgfVxuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GYWlsZWRXaXRoUmVzcG9uc2UoZm9ybVN1Ym1pc3Npb24sIGZldGNoUmVzcG9uc2UpIHtcbiAgICB0aGlzLmVsZW1lbnQuZGVsZWdhdGUubG9hZFJlc3BvbnNlKGZldGNoUmVzcG9uc2UpO1xuICAgIHNlc3Npb24uY2xlYXJDYWNoZSgpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25FcnJvcmVkKGZvcm1TdWJtaXNzaW9uLCBlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICB9XG5cbiAgZm9ybVN1Ym1pc3Npb25GaW5pc2hlZCh7IGZvcm1FbGVtZW50IH0pIHtcbiAgICBjbGVhckJ1c3lTdGF0ZShmb3JtRWxlbWVudCwgdGhpcy4jZmluZEZyYW1lRWxlbWVudChmb3JtRWxlbWVudCkpO1xuICB9XG5cbiAgLy8gVmlldyBkZWxlZ2F0ZVxuXG4gIGFsbG93c0ltbWVkaWF0ZVJlbmRlcih7IGVsZW1lbnQ6IG5ld0ZyYW1lIH0sIG9wdGlvbnMpIHtcbiAgICBjb25zdCBldmVudCA9IGRpc3BhdGNoKFwidHVyYm86YmVmb3JlLWZyYW1lLXJlbmRlclwiLCB7XG4gICAgICB0YXJnZXQ6IHRoaXMuZWxlbWVudCxcbiAgICAgIGRldGFpbDogeyBuZXdGcmFtZSwgLi4ub3B0aW9ucyB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgY29uc3Qge1xuICAgICAgZGVmYXVsdFByZXZlbnRlZCxcbiAgICAgIGRldGFpbDogeyByZW5kZXIgfVxuICAgIH0gPSBldmVudDtcblxuICAgIGlmICh0aGlzLnZpZXcucmVuZGVyZXIgJiYgcmVuZGVyKSB7XG4gICAgICB0aGlzLnZpZXcucmVuZGVyZXIucmVuZGVyRWxlbWVudCA9IHJlbmRlcjtcbiAgICB9XG5cbiAgICByZXR1cm4gIWRlZmF1bHRQcmV2ZW50ZWRcbiAgfVxuXG4gIHZpZXdSZW5kZXJlZFNuYXBzaG90KF9zbmFwc2hvdCwgX2lzUHJldmlldywgX3JlbmRlck1ldGhvZCkge31cblxuICBwcmVsb2FkT25Mb2FkTGlua3NGb3JWaWV3KGVsZW1lbnQpIHtcbiAgICBzZXNzaW9uLnByZWxvYWRPbkxvYWRMaW5rc0ZvclZpZXcoZWxlbWVudCk7XG4gIH1cblxuICB2aWV3SW52YWxpZGF0ZWQoKSB7fVxuXG4gIC8vIEZyYW1lIHJlbmRlcmVyIGRlbGVnYXRlXG5cbiAgd2lsbFJlbmRlckZyYW1lKGN1cnJlbnRFbGVtZW50LCBfbmV3RWxlbWVudCkge1xuICAgIHRoaXMucHJldmlvdXNGcmFtZUVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICB2aXNpdENhY2hlZFNuYXBzaG90ID0gKHsgZWxlbWVudCB9KSA9PiB7XG4gICAgY29uc3QgZnJhbWUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyB0aGlzLmVsZW1lbnQuaWQpO1xuXG4gICAgaWYgKGZyYW1lICYmIHRoaXMucHJldmlvdXNGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGZyYW1lLnJlcGxhY2VDaGlsZHJlbiguLi50aGlzLnByZXZpb3VzRnJhbWVFbGVtZW50LmNoaWxkcmVuKTtcbiAgICB9XG5cbiAgICBkZWxldGUgdGhpcy5wcmV2aW91c0ZyYW1lRWxlbWVudDtcbiAgfVxuXG4gIC8vIFByaXZhdGVcblxuICBhc3luYyAjbG9hZEZyYW1lUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSwgZG9jdW1lbnQpIHtcbiAgICBjb25zdCBuZXdGcmFtZUVsZW1lbnQgPSBhd2FpdCB0aGlzLmV4dHJhY3RGb3JlaWduRnJhbWVFbGVtZW50KGRvY3VtZW50LmJvZHkpO1xuICAgIGNvbnN0IHJlbmRlcmVyQ2xhc3MgPSB0aGlzLiNzaG91bGRNb3JwaEZyYW1lID8gTW9ycGhpbmdGcmFtZVJlbmRlcmVyIDogRnJhbWVSZW5kZXJlcjtcblxuICAgIGlmIChuZXdGcmFtZUVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gbmV3IFNuYXBzaG90KG5ld0ZyYW1lRWxlbWVudCk7XG4gICAgICBjb25zdCByZW5kZXJlciA9IG5ldyByZW5kZXJlckNsYXNzKHRoaXMsIHRoaXMudmlldy5zbmFwc2hvdCwgc25hcHNob3QsIGZhbHNlLCBmYWxzZSk7XG4gICAgICBpZiAodGhpcy52aWV3LnJlbmRlclByb21pc2UpIGF3YWl0IHRoaXMudmlldy5yZW5kZXJQcm9taXNlO1xuICAgICAgdGhpcy5jaGFuZ2VIaXN0b3J5KCk7XG5cbiAgICAgIGF3YWl0IHRoaXMudmlldy5yZW5kZXIocmVuZGVyZXIpO1xuICAgICAgdGhpcy5jb21wbGV0ZSA9IHRydWU7XG4gICAgICBzZXNzaW9uLmZyYW1lUmVuZGVyZWQoZmV0Y2hSZXNwb25zZSwgdGhpcy5lbGVtZW50KTtcbiAgICAgIHNlc3Npb24uZnJhbWVMb2FkZWQodGhpcy5lbGVtZW50KTtcbiAgICAgIGF3YWl0IHRoaXMuZmV0Y2hSZXNwb25zZUxvYWRlZChmZXRjaFJlc3BvbnNlKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuI3dpbGxIYW5kbGVGcmFtZU1pc3NpbmdGcm9tUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSkpIHtcbiAgICAgIHRoaXMuI2hhbmRsZUZyYW1lTWlzc2luZ0Zyb21SZXNwb25zZShmZXRjaFJlc3BvbnNlKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyAjdmlzaXQodXJsKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IG5ldyBGZXRjaFJlcXVlc3QodGhpcywgRmV0Y2hNZXRob2QuZ2V0LCB1cmwsIG5ldyBVUkxTZWFyY2hQYXJhbXMoKSwgdGhpcy5lbGVtZW50KTtcblxuICAgIHRoaXMuI2N1cnJlbnRGZXRjaFJlcXVlc3Q/LmNhbmNlbCgpO1xuICAgIHRoaXMuI2N1cnJlbnRGZXRjaFJlcXVlc3QgPSByZXF1ZXN0O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLiNyZXNvbHZlVmlzaXRQcm9taXNlID0gKCkgPT4ge307XG4gICAgICAgIHRoaXMuI2N1cnJlbnRGZXRjaFJlcXVlc3QgPSBudWxsO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgcmVxdWVzdC5wZXJmb3JtKCk7XG4gICAgfSlcbiAgfVxuXG4gICNuYXZpZ2F0ZUZyYW1lKGVsZW1lbnQsIHVybCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLiNmaW5kRnJhbWVFbGVtZW50KGVsZW1lbnQsIHN1Ym1pdHRlcik7XG5cbiAgICBmcmFtZS5kZWxlZ2F0ZS5wcm9wb3NlVmlzaXRJZk5hdmlnYXRlZFdpdGhBY3Rpb24oZnJhbWUsIGdldFZpc2l0QWN0aW9uKHN1Ym1pdHRlciwgZWxlbWVudCwgZnJhbWUpKTtcblxuICAgIHRoaXMuI3dpdGhDdXJyZW50TmF2aWdhdGlvbkVsZW1lbnQoZWxlbWVudCwgKCkgPT4ge1xuICAgICAgZnJhbWUuc3JjID0gdXJsO1xuICAgIH0pO1xuICB9XG5cbiAgcHJvcG9zZVZpc2l0SWZOYXZpZ2F0ZWRXaXRoQWN0aW9uKGZyYW1lLCBhY3Rpb24gPSBudWxsKSB7XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG5cbiAgICBpZiAodGhpcy5hY3Rpb24pIHtcbiAgICAgIGNvbnN0IHBhZ2VTbmFwc2hvdCA9IFBhZ2VTbmFwc2hvdC5mcm9tRWxlbWVudChmcmFtZSkuY2xvbmUoKTtcbiAgICAgIGNvbnN0IHsgdmlzaXRDYWNoZWRTbmFwc2hvdCB9ID0gZnJhbWUuZGVsZWdhdGU7XG5cbiAgICAgIGZyYW1lLmRlbGVnYXRlLmZldGNoUmVzcG9uc2VMb2FkZWQgPSBhc3luYyAoZmV0Y2hSZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoZnJhbWUuc3JjKSB7XG4gICAgICAgICAgY29uc3QgeyBzdGF0dXNDb2RlLCByZWRpcmVjdGVkIH0gPSBmZXRjaFJlc3BvbnNlO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IGZldGNoUmVzcG9uc2UucmVzcG9uc2VIVE1MO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0geyBzdGF0dXNDb2RlLCByZWRpcmVjdGVkLCByZXNwb25zZUhUTUwgfTtcbiAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICB2aXNpdENhY2hlZFNuYXBzaG90LFxuICAgICAgICAgICAgd2lsbFJlbmRlcjogZmFsc2UsXG4gICAgICAgICAgICB1cGRhdGVIaXN0b3J5OiBmYWxzZSxcbiAgICAgICAgICAgIHJlc3RvcmF0aW9uSWRlbnRpZmllcjogdGhpcy5yZXN0b3JhdGlvbklkZW50aWZpZXIsXG4gICAgICAgICAgICBzbmFwc2hvdDogcGFnZVNuYXBzaG90XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGlmICh0aGlzLmFjdGlvbikgb3B0aW9ucy5hY3Rpb24gPSB0aGlzLmFjdGlvbjtcblxuICAgICAgICAgIHNlc3Npb24udmlzaXQoZnJhbWUuc3JjLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBjaGFuZ2VIaXN0b3J5KCkge1xuICAgIGlmICh0aGlzLmFjdGlvbikge1xuICAgICAgY29uc3QgbWV0aG9kID0gZ2V0SGlzdG9yeU1ldGhvZEZvckFjdGlvbih0aGlzLmFjdGlvbik7XG4gICAgICBzZXNzaW9uLmhpc3RvcnkudXBkYXRlKG1ldGhvZCwgZXhwYW5kVVJMKHRoaXMuZWxlbWVudC5zcmMgfHwgXCJcIiksIHRoaXMucmVzdG9yYXRpb25JZGVudGlmaWVyKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyAjaGFuZGxlVW52aXNpdGFibGVGcmFtZVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBgVGhlIHJlc3BvbnNlICgke2ZldGNoUmVzcG9uc2Uuc3RhdHVzQ29kZX0pIGZyb20gPHR1cmJvLWZyYW1lIGlkPVwiJHt0aGlzLmVsZW1lbnQuaWR9XCI+IGlzIHBlcmZvcm1pbmcgYSBmdWxsIHBhZ2UgdmlzaXQgZHVlIHRvIHR1cmJvLXZpc2l0LWNvbnRyb2wuYFxuICAgICk7XG5cbiAgICBhd2FpdCB0aGlzLiN2aXNpdFJlc3BvbnNlKGZldGNoUmVzcG9uc2UucmVzcG9uc2UpO1xuICB9XG5cbiAgI3dpbGxIYW5kbGVGcmFtZU1pc3NpbmdGcm9tUmVzcG9uc2UoZmV0Y2hSZXNwb25zZSkge1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiLCBcIlwiKTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gZmV0Y2hSZXNwb25zZS5yZXNwb25zZTtcbiAgICBjb25zdCB2aXNpdCA9IGFzeW5jICh1cmwsIG9wdGlvbnMpID0+IHtcbiAgICAgIGlmICh1cmwgaW5zdGFuY2VvZiBSZXNwb25zZSkge1xuICAgICAgICB0aGlzLiN2aXNpdFJlc3BvbnNlKHVybCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXNzaW9uLnZpc2l0KHVybCwgb3B0aW9ucyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IGV2ZW50ID0gZGlzcGF0Y2goXCJ0dXJibzpmcmFtZS1taXNzaW5nXCIsIHtcbiAgICAgIHRhcmdldDogdGhpcy5lbGVtZW50LFxuICAgICAgZGV0YWlsOiB7IHJlc3BvbnNlLCB2aXNpdCB9LFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICAjaGFuZGxlRnJhbWVNaXNzaW5nRnJvbVJlc3BvbnNlKGZldGNoUmVzcG9uc2UpIHtcbiAgICB0aGlzLnZpZXcubWlzc2luZygpO1xuICAgIHRoaXMuI3Rocm93RnJhbWVNaXNzaW5nRXJyb3IoZmV0Y2hSZXNwb25zZSk7XG4gIH1cblxuICAjdGhyb3dGcmFtZU1pc3NpbmdFcnJvcihmZXRjaFJlc3BvbnNlKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGBUaGUgcmVzcG9uc2UgKCR7ZmV0Y2hSZXNwb25zZS5zdGF0dXNDb2RlfSkgZGlkIG5vdCBjb250YWluIHRoZSBleHBlY3RlZCA8dHVyYm8tZnJhbWUgaWQ9XCIke3RoaXMuZWxlbWVudC5pZH1cIj4gYW5kIHdpbGwgYmUgaWdub3JlZC4gVG8gcGVyZm9ybSBhIGZ1bGwgcGFnZSB2aXNpdCBpbnN0ZWFkLCBzZXQgdHVyYm8tdmlzaXQtY29udHJvbCB0byByZWxvYWQuYDtcbiAgICB0aHJvdyBuZXcgVHVyYm9GcmFtZU1pc3NpbmdFcnJvcihtZXNzYWdlKVxuICB9XG5cbiAgYXN5bmMgI3Zpc2l0UmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICBjb25zdCB3cmFwcGVkID0gbmV3IEZldGNoUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlSFRNTCA9IGF3YWl0IHdyYXBwZWQucmVzcG9uc2VIVE1MO1xuICAgIGNvbnN0IHsgbG9jYXRpb24sIHJlZGlyZWN0ZWQsIHN0YXR1c0NvZGUgfSA9IHdyYXBwZWQ7XG5cbiAgICByZXR1cm4gc2Vzc2lvbi52aXNpdChsb2NhdGlvbiwgeyByZXNwb25zZTogeyByZWRpcmVjdGVkLCBzdGF0dXNDb2RlLCByZXNwb25zZUhUTUwgfSB9KVxuICB9XG5cbiAgI2ZpbmRGcmFtZUVsZW1lbnQoZWxlbWVudCwgc3VibWl0dGVyKSB7XG4gICAgY29uc3QgaWQgPSBnZXRBdHRyaWJ1dGUoXCJkYXRhLXR1cmJvLWZyYW1lXCIsIHN1Ym1pdHRlciwgZWxlbWVudCkgfHwgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZShcInRhcmdldFwiKTtcbiAgICByZXR1cm4gZ2V0RnJhbWVFbGVtZW50QnlJZChpZCkgPz8gdGhpcy5lbGVtZW50XG4gIH1cblxuICBhc3luYyBleHRyYWN0Rm9yZWlnbkZyYW1lRWxlbWVudChjb250YWluZXIpIHtcbiAgICBsZXQgZWxlbWVudDtcbiAgICBjb25zdCBpZCA9IENTUy5lc2NhcGUodGhpcy5pZCk7XG5cbiAgICB0cnkge1xuICAgICAgZWxlbWVudCA9IGFjdGl2YXRlRWxlbWVudChjb250YWluZXIucXVlcnlTZWxlY3RvcihgdHVyYm8tZnJhbWUjJHtpZH1gKSwgdGhpcy5zb3VyY2VVUkwpO1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRcbiAgICAgIH1cblxuICAgICAgZWxlbWVudCA9IGFjdGl2YXRlRWxlbWVudChjb250YWluZXIucXVlcnlTZWxlY3RvcihgdHVyYm8tZnJhbWVbc3JjXVtyZWN1cnNlfj0ke2lkfV1gKSwgdGhpcy5zb3VyY2VVUkwpO1xuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgYXdhaXQgZWxlbWVudC5sb2FkZWQ7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmV4dHJhY3RGb3JlaWduRnJhbWVFbGVtZW50KGVsZW1lbnQpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmV0dXJuIG5ldyBGcmFtZUVsZW1lbnQoKVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAjZm9ybUFjdGlvbklzVmlzaXRhYmxlKGZvcm0sIHN1Ym1pdHRlcikge1xuICAgIGNvbnN0IGFjdGlvbiA9IGdldEFjdGlvbiQxKGZvcm0sIHN1Ym1pdHRlcik7XG5cbiAgICByZXR1cm4gbG9jYXRpb25Jc1Zpc2l0YWJsZShleHBhbmRVUkwoYWN0aW9uKSwgdGhpcy5yb290TG9jYXRpb24pXG4gIH1cblxuICAjc2hvdWxkSW50ZXJjZXB0TmF2aWdhdGlvbihlbGVtZW50LCBzdWJtaXR0ZXIpIHtcbiAgICBjb25zdCBpZCA9IGdldEF0dHJpYnV0ZShcImRhdGEtdHVyYm8tZnJhbWVcIiwgc3VibWl0dGVyLCBlbGVtZW50KSB8fCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidGFyZ2V0XCIpO1xuXG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnQgJiYgIXRoaXMuI2Zvcm1BY3Rpb25Jc1Zpc2l0YWJsZShlbGVtZW50LCBzdWJtaXR0ZXIpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZW5hYmxlZCB8fCBpZCA9PSBcIl90b3BcIikge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKGlkKSB7XG4gICAgICBjb25zdCBmcmFtZUVsZW1lbnQgPSBnZXRGcmFtZUVsZW1lbnRCeUlkKGlkKTtcbiAgICAgIGlmIChmcmFtZUVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuICFmcmFtZUVsZW1lbnQuZGlzYWJsZWRcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXNlc3Npb24uZWxlbWVudElzTmF2aWdhdGFibGUoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmIChzdWJtaXR0ZXIgJiYgIXNlc3Npb24uZWxlbWVudElzTmF2aWdhdGFibGUoc3VibWl0dGVyKSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8vIENvbXB1dGVkIHByb3BlcnRpZXNcblxuICBnZXQgaWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pZFxuICB9XG5cbiAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgcmV0dXJuICF0aGlzLmVsZW1lbnQuZGlzYWJsZWRcbiAgfVxuXG4gIGdldCBzb3VyY2VVUkwoKSB7XG4gICAgaWYgKHRoaXMuZWxlbWVudC5zcmMpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuc3JjXG4gICAgfVxuICB9XG5cbiAgc2V0IHNvdXJjZVVSTChzb3VyY2VVUkwpIHtcbiAgICB0aGlzLiNpZ25vcmluZ0NoYW5nZXNUb0F0dHJpYnV0ZShcInNyY1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmVsZW1lbnQuc3JjID0gc291cmNlVVJMID8/IG51bGw7XG4gICAgfSk7XG4gIH1cblxuICBnZXQgbG9hZGluZ1N0eWxlKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQubG9hZGluZ1xuICB9XG5cbiAgZ2V0IGlzTG9hZGluZygpIHtcbiAgICByZXR1cm4gdGhpcy5mb3JtU3VibWlzc2lvbiAhPT0gdW5kZWZpbmVkIHx8IHRoaXMuI3Jlc29sdmVWaXNpdFByb21pc2UoKSAhPT0gdW5kZWZpbmVkXG4gIH1cblxuICBnZXQgY29tcGxldGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKVxuICB9XG5cbiAgc2V0IGNvbXBsZXRlKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwiY29tcGxldGVcIiwgXCJcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJjb21wbGV0ZVwiKTtcbiAgICB9XG4gIH1cblxuICBnZXQgaXNBY3RpdmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5pc0FjdGl2ZSAmJiB0aGlzLiNjb25uZWN0ZWRcbiAgfVxuXG4gIGdldCByb290TG9jYXRpb24oKSB7XG4gICAgY29uc3QgbWV0YSA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYG1ldGFbbmFtZT1cInR1cmJvLXJvb3RcIl1gKTtcbiAgICBjb25zdCByb290ID0gbWV0YT8uY29udGVudCA/PyBcIi9cIjtcbiAgICByZXR1cm4gZXhwYW5kVVJMKHJvb3QpXG4gIH1cblxuICAjaXNJZ25vcmluZ0NoYW5nZXNUbyhhdHRyaWJ1dGVOYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuI2lnbm9yZWRBdHRyaWJ1dGVzLmhhcyhhdHRyaWJ1dGVOYW1lKVxuICB9XG5cbiAgI2lnbm9yaW5nQ2hhbmdlc1RvQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy4jaWdub3JlZEF0dHJpYnV0ZXMuYWRkKGF0dHJpYnV0ZU5hbWUpO1xuICAgIGNhbGxiYWNrKCk7XG4gICAgdGhpcy4jaWdub3JlZEF0dHJpYnV0ZXMuZGVsZXRlKGF0dHJpYnV0ZU5hbWUpO1xuICB9XG5cbiAgI3dpdGhDdXJyZW50TmF2aWdhdGlvbkVsZW1lbnQoZWxlbWVudCwgY2FsbGJhY2spIHtcbiAgICB0aGlzLmN1cnJlbnROYXZpZ2F0aW9uRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgY2FsbGJhY2soKTtcbiAgICBkZWxldGUgdGhpcy5jdXJyZW50TmF2aWdhdGlvbkVsZW1lbnQ7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RnJhbWVFbGVtZW50QnlJZChpZCkge1xuICBpZiAoaWQgIT0gbnVsbCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBGcmFtZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBlbGVtZW50XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGFjdGl2YXRlRWxlbWVudChlbGVtZW50LCBjdXJyZW50VVJMKSB7XG4gIGlmIChlbGVtZW50KSB7XG4gICAgY29uc3Qgc3JjID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJzcmNcIik7XG4gICAgaWYgKHNyYyAhPSBudWxsICYmIGN1cnJlbnRVUkwgIT0gbnVsbCAmJiB1cmxzQXJlRXF1YWwoc3JjLCBjdXJyZW50VVJMKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBNYXRjaGluZyA8dHVyYm8tZnJhbWUgaWQ9XCIke2VsZW1lbnQuaWR9XCI+IGVsZW1lbnQgaGFzIGEgc291cmNlIFVSTCB3aGljaCByZWZlcmVuY2VzIGl0c2VsZmApXG4gICAgfVxuICAgIGlmIChlbGVtZW50Lm93bmVyRG9jdW1lbnQgIT09IGRvY3VtZW50KSB7XG4gICAgICBlbGVtZW50ID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShlbGVtZW50LCB0cnVlKTtcbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEZyYW1lRWxlbWVudCkge1xuICAgICAgZWxlbWVudC5jb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgICAgZWxlbWVudC5kaXNjb25uZWN0ZWRDYWxsYmFjaygpO1xuICAgICAgcmV0dXJuIGVsZW1lbnRcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgU3RyZWFtQWN0aW9ucyA9IHtcbiAgYWZ0ZXIoKSB7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZSh0aGlzLnRlbXBsYXRlQ29udGVudCwgZS5uZXh0U2libGluZykpO1xuICB9LFxuXG4gIGFwcGVuZCgpIHtcbiAgICB0aGlzLnJlbW92ZUR1cGxpY2F0ZVRhcmdldENoaWxkcmVuKCk7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLmFwcGVuZCh0aGlzLnRlbXBsYXRlQ29udGVudCkpO1xuICB9LFxuXG4gIGJlZm9yZSgpIHtcbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKGUpID0+IGUucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKHRoaXMudGVtcGxhdGVDb250ZW50LCBlKSk7XG4gIH0sXG5cbiAgcHJlcGVuZCgpIHtcbiAgICB0aGlzLnJlbW92ZUR1cGxpY2F0ZVRhcmdldENoaWxkcmVuKCk7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLnByZXBlbmQodGhpcy50ZW1wbGF0ZUNvbnRlbnQpKTtcbiAgfSxcblxuICByZW1vdmUoKSB7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKChlKSA9PiBlLnJlbW92ZSgpKTtcbiAgfSxcblxuICByZXBsYWNlKCkge1xuICAgIGNvbnN0IG1ldGhvZCA9IHRoaXMuZ2V0QXR0cmlidXRlKFwibWV0aG9kXCIpO1xuXG4gICAgdGhpcy50YXJnZXRFbGVtZW50cy5mb3JFYWNoKCh0YXJnZXRFbGVtZW50KSA9PiB7XG4gICAgICBpZiAobWV0aG9kID09PSBcIm1vcnBoXCIpIHtcbiAgICAgICAgbW9ycGhFbGVtZW50cyh0YXJnZXRFbGVtZW50LCB0aGlzLnRlbXBsYXRlQ29udGVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXRFbGVtZW50LnJlcGxhY2VXaXRoKHRoaXMudGVtcGxhdGVDb250ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICB1cGRhdGUoKSB7XG4gICAgY29uc3QgbWV0aG9kID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJtZXRob2RcIik7XG5cbiAgICB0aGlzLnRhcmdldEVsZW1lbnRzLmZvckVhY2goKHRhcmdldEVsZW1lbnQpID0+IHtcbiAgICAgIGlmIChtZXRob2QgPT09IFwibW9ycGhcIikge1xuICAgICAgICBtb3JwaENoaWxkcmVuKHRhcmdldEVsZW1lbnQsIHRoaXMudGVtcGxhdGVDb250ZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldEVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgICAgdGFyZ2V0RWxlbWVudC5hcHBlbmQodGhpcy50ZW1wbGF0ZUNvbnRlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIHJlZnJlc2goKSB7XG4gICAgc2Vzc2lvbi5yZWZyZXNoKHRoaXMuYmFzZVVSSSwgdGhpcy5yZXF1ZXN0SWQpO1xuICB9XG59O1xuXG4vLyA8dHVyYm8tc3RyZWFtIGFjdGlvbj1yZXBsYWNlIHRhcmdldD1pZD48dGVtcGxhdGU+Li4uXG5cbi8qKlxuICogUmVuZGVycyB1cGRhdGVzIHRvIHRoZSBwYWdlIGZyb20gYSBzdHJlYW0gb2YgbWVzc2FnZXMuXG4gKlxuICogVXNpbmcgdGhlIGBhY3Rpb25gIGF0dHJpYnV0ZSwgdGhpcyBjYW4gYmUgY29uZmlndXJlZCBvbmUgb2YgZWlnaHQgd2F5czpcbiAqXG4gKiAtIGBhZnRlcmAgLSBpbnNlcnRzIHRoZSByZXN1bHQgYWZ0ZXIgdGhlIHRhcmdldFxuICogLSBgYXBwZW5kYCAtIGFwcGVuZHMgdGhlIHJlc3VsdCB0byB0aGUgdGFyZ2V0XG4gKiAtIGBiZWZvcmVgIC0gaW5zZXJ0cyB0aGUgcmVzdWx0IGJlZm9yZSB0aGUgdGFyZ2V0XG4gKiAtIGBwcmVwZW5kYCAtIHByZXBlbmRzIHRoZSByZXN1bHQgdG8gdGhlIHRhcmdldFxuICogLSBgcmVmcmVzaGAgLSBpbml0aWF0ZXMgYSBwYWdlIHJlZnJlc2hcbiAqIC0gYHJlbW92ZWAgLSByZW1vdmVzIHRoZSB0YXJnZXRcbiAqIC0gYHJlcGxhY2VgIC0gcmVwbGFjZXMgdGhlIG91dGVyIEhUTUwgb2YgdGhlIHRhcmdldFxuICogLSBgdXBkYXRlYCAtIHJlcGxhY2VzIHRoZSBpbm5lciBIVE1MIG9mIHRoZSB0YXJnZXRcbiAqXG4gKiBAY3VzdG9tRWxlbWVudCB0dXJiby1zdHJlYW1cbiAqIEBleGFtcGxlXG4gKiAgIDx0dXJiby1zdHJlYW0gYWN0aW9uPVwiYXBwZW5kXCIgdGFyZ2V0PVwiZG9tX2lkXCI+XG4gKiAgICAgPHRlbXBsYXRlPlxuICogICAgICAgQ29udGVudCB0byBhcHBlbmQgdG8gdGFyZ2V0IGRlc2lnbmF0ZWQgd2l0aCB0aGUgZG9tX2lkLlxuICogICAgIDwvdGVtcGxhdGU+XG4gKiAgIDwvdHVyYm8tc3RyZWFtPlxuICovXG5jbGFzcyBTdHJlYW1FbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdGF0aWMgYXN5bmMgcmVuZGVyRWxlbWVudChuZXdFbGVtZW50KSB7XG4gICAgYXdhaXQgbmV3RWxlbWVudC5wZXJmb3JtQWN0aW9uKCk7XG4gIH1cblxuICBhc3luYyBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZGlzY29ubmVjdCgpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKHRoaXMucmVuZGVyUHJvbWlzZSA/Pz0gKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5iZWZvcmVSZW5kZXJFdmVudDtcblxuICAgICAgaWYgKHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCkpIHtcbiAgICAgICAgYXdhaXQgbmV4dFJlcGFpbnQoKTtcbiAgICAgICAgYXdhaXQgZXZlbnQuZGV0YWlsLnJlbmRlcih0aGlzKTtcbiAgICAgIH1cbiAgICB9KSgpKVxuICB9XG5cbiAgZGlzY29ubmVjdCgpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICAgIH0gY2F0Y2gge31cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGR1cGxpY2F0ZSBjaGlsZHJlbiAoYnkgSUQpXG4gICAqL1xuICByZW1vdmVEdXBsaWNhdGVUYXJnZXRDaGlsZHJlbigpIHtcbiAgICB0aGlzLmR1cGxpY2F0ZUNoaWxkcmVuLmZvckVhY2goKGMpID0+IGMucmVtb3ZlKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGxpc3Qgb2YgZHVwbGljYXRlIGNoaWxkcmVuIChpLmUuIHRob3NlIHdpdGggdGhlIHNhbWUgSUQpXG4gICAqL1xuICBnZXQgZHVwbGljYXRlQ2hpbGRyZW4oKSB7XG4gICAgY29uc3QgZXhpc3RpbmdDaGlsZHJlbiA9IHRoaXMudGFyZ2V0RWxlbWVudHMuZmxhdE1hcCgoZSkgPT4gWy4uLmUuY2hpbGRyZW5dKS5maWx0ZXIoKGMpID0+ICEhYy5pZCk7XG4gICAgY29uc3QgbmV3Q2hpbGRyZW5JZHMgPSBbLi4uKHRoaXMudGVtcGxhdGVDb250ZW50Py5jaGlsZHJlbiB8fCBbXSldLmZpbHRlcigoYykgPT4gISFjLmlkKS5tYXAoKGMpID0+IGMuaWQpO1xuXG4gICAgcmV0dXJuIGV4aXN0aW5nQ2hpbGRyZW4uZmlsdGVyKChjKSA9PiBuZXdDaGlsZHJlbklkcy5pbmNsdWRlcyhjLmlkKSlcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBhY3Rpb24gZnVuY3Rpb24gdG8gYmUgcGVyZm9ybWVkLlxuICAgKi9cbiAgZ2V0IHBlcmZvcm1BY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuYWN0aW9uKSB7XG4gICAgICBjb25zdCBhY3Rpb25GdW5jdGlvbiA9IFN0cmVhbUFjdGlvbnNbdGhpcy5hY3Rpb25dO1xuICAgICAgaWYgKGFjdGlvbkZ1bmN0aW9uKSB7XG4gICAgICAgIHJldHVybiBhY3Rpb25GdW5jdGlvblxuICAgICAgfVxuICAgICAgdGhpcy4jcmFpc2UoXCJ1bmtub3duIGFjdGlvblwiKTtcbiAgICB9XG4gICAgdGhpcy4jcmFpc2UoXCJhY3Rpb24gYXR0cmlidXRlIGlzIG1pc3NpbmdcIik7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgdGFyZ2V0IGVsZW1lbnRzIHdoaWNoIHRoZSB0ZW1wbGF0ZSB3aWxsIGJlIHJlbmRlcmVkIHRvLlxuICAgKi9cbiAgZ2V0IHRhcmdldEVsZW1lbnRzKCkge1xuICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgcmV0dXJuIHRoaXMudGFyZ2V0RWxlbWVudHNCeUlkXG4gICAgfSBlbHNlIGlmICh0aGlzLnRhcmdldHMpIHtcbiAgICAgIHJldHVybiB0aGlzLnRhcmdldEVsZW1lbnRzQnlRdWVyeVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiNyYWlzZShcInRhcmdldCBvciB0YXJnZXRzIGF0dHJpYnV0ZSBpcyBtaXNzaW5nXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb250ZW50cyBvZiB0aGUgbWFpbiBgPHRlbXBsYXRlPmAuXG4gICAqL1xuICBnZXQgdGVtcGxhdGVDb250ZW50KCkge1xuICAgIHJldHVybiB0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LmNsb25lTm9kZSh0cnVlKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG1haW4gYDx0ZW1wbGF0ZT5gIHVzZWQgZm9yIHJlbmRlcmluZ1xuICAgKi9cbiAgZ2V0IHRlbXBsYXRlRWxlbWVudCgpIHtcbiAgICBpZiAodGhpcy5maXJzdEVsZW1lbnRDaGlsZCA9PT0gbnVsbCkge1xuICAgICAgY29uc3QgdGVtcGxhdGUgPSB0aGlzLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRlbXBsYXRlXCIpO1xuICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0ZW1wbGF0ZSk7XG4gICAgICByZXR1cm4gdGVtcGxhdGVcbiAgICB9IGVsc2UgaWYgKHRoaXMuZmlyc3RFbGVtZW50Q2hpbGQgaW5zdGFuY2VvZiBIVE1MVGVtcGxhdGVFbGVtZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5maXJzdEVsZW1lbnRDaGlsZFxuICAgIH1cbiAgICB0aGlzLiNyYWlzZShcImZpcnN0IGNoaWxkIGVsZW1lbnQgbXVzdCBiZSBhIDx0ZW1wbGF0ZT4gZWxlbWVudFwiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjdXJyZW50IGFjdGlvbi5cbiAgICovXG4gIGdldCBhY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpXG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCB0YXJnZXQgKGFuIGVsZW1lbnQgSUQpIHRvIHdoaWNoIHRoZSByZXN1bHQgd2lsbFxuICAgKiBiZSByZW5kZXJlZC5cbiAgICovXG4gIGdldCB0YXJnZXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwidGFyZ2V0XCIpXG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgY3VycmVudCBcInRhcmdldHNcIiBzZWxlY3RvciAoYSBDU1Mgc2VsZWN0b3IpXG4gICAqL1xuICBnZXQgdGFyZ2V0cygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJ0YXJnZXRzXCIpXG4gIH1cblxuICAvKipcbiAgICogUmVhZHMgdGhlIHJlcXVlc3QtaWQgYXR0cmlidXRlXG4gICAqL1xuICBnZXQgcmVxdWVzdElkKCkge1xuICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZShcInJlcXVlc3QtaWRcIilcbiAgfVxuXG4gICNyYWlzZShtZXNzYWdlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke3RoaXMuZGVzY3JpcHRpb259OiAke21lc3NhZ2V9YClcbiAgfVxuXG4gIGdldCBkZXNjcmlwdGlvbigpIHtcbiAgICByZXR1cm4gKHRoaXMub3V0ZXJIVE1MLm1hdGNoKC88W14+XSs+LykgPz8gW10pWzBdID8/IFwiPHR1cmJvLXN0cmVhbT5cIlxuICB9XG5cbiAgZ2V0IGJlZm9yZVJlbmRlckV2ZW50KCkge1xuICAgIHJldHVybiBuZXcgQ3VzdG9tRXZlbnQoXCJ0dXJibzpiZWZvcmUtc3RyZWFtLXJlbmRlclwiLCB7XG4gICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGRldGFpbDogeyBuZXdTdHJlYW06IHRoaXMsIHJlbmRlcjogU3RyZWFtRWxlbWVudC5yZW5kZXJFbGVtZW50IH1cbiAgICB9KVxuICB9XG5cbiAgZ2V0IHRhcmdldEVsZW1lbnRzQnlJZCgpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5vd25lckRvY3VtZW50Py5nZXRFbGVtZW50QnlJZCh0aGlzLnRhcmdldCk7XG5cbiAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIFtlbGVtZW50XVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cblxuICBnZXQgdGFyZ2V0RWxlbWVudHNCeVF1ZXJ5KCkge1xuICAgIGNvbnN0IGVsZW1lbnRzID0gdGhpcy5vd25lckRvY3VtZW50Py5xdWVyeVNlbGVjdG9yQWxsKHRoaXMudGFyZ2V0cyk7XG5cbiAgICBpZiAoZWxlbWVudHMubGVuZ3RoICE9PSAwKSB7XG4gICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZWxlbWVudHMpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBTdHJlYW1Tb3VyY2VFbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdHJlYW1Tb3VyY2UgPSBudWxsXG5cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5zdHJlYW1Tb3VyY2UgPSB0aGlzLnNyYy5tYXRjaCgvXndzezEsMn06LykgPyBuZXcgV2ViU29ja2V0KHRoaXMuc3JjKSA6IG5ldyBFdmVudFNvdXJjZSh0aGlzLnNyYyk7XG5cbiAgICBjb25uZWN0U3RyZWFtU291cmNlKHRoaXMuc3RyZWFtU291cmNlKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGlmICh0aGlzLnN0cmVhbVNvdXJjZSkge1xuICAgICAgdGhpcy5zdHJlYW1Tb3VyY2UuY2xvc2UoKTtcblxuICAgICAgZGlzY29ubmVjdFN0cmVhbVNvdXJjZSh0aGlzLnN0cmVhbVNvdXJjZSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNyYygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgfHwgXCJcIlxuICB9XG59XG5cbkZyYW1lRWxlbWVudC5kZWxlZ2F0ZUNvbnN0cnVjdG9yID0gRnJhbWVDb250cm9sbGVyO1xuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KFwidHVyYm8tZnJhbWVcIikgPT09IHVuZGVmaW5lZCkge1xuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoXCJ0dXJiby1mcmFtZVwiLCBGcmFtZUVsZW1lbnQpO1xufVxuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KFwidHVyYm8tc3RyZWFtXCIpID09PSB1bmRlZmluZWQpIHtcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKFwidHVyYm8tc3RyZWFtXCIsIFN0cmVhbUVsZW1lbnQpO1xufVxuXG5pZiAoY3VzdG9tRWxlbWVudHMuZ2V0KFwidHVyYm8tc3RyZWFtLXNvdXJjZVwiKSA9PT0gdW5kZWZpbmVkKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcInR1cmJvLXN0cmVhbS1zb3VyY2VcIiwgU3RyZWFtU291cmNlRWxlbWVudCk7XG59XG5cbigoKSA9PiB7XG4gIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdDtcbiAgaWYgKCFlbGVtZW50KSByZXR1cm5cbiAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKFwiZGF0YS10dXJiby1zdXBwcmVzcy13YXJuaW5nXCIpKSByZXR1cm5cblxuICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICB3aGlsZSAoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50ID09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLndhcm4oXG4gICAgICAgIHVuaW5kZW50YFxuICAgICAgICBZb3UgYXJlIGxvYWRpbmcgVHVyYm8gZnJvbSBhIDxzY3JpcHQ+IGVsZW1lbnQgaW5zaWRlIHRoZSA8Ym9keT4gZWxlbWVudC4gVGhpcyBpcyBwcm9iYWJseSBub3Qgd2hhdCB5b3UgbWVhbnQgdG8gZG8hXG5cbiAgICAgICAgTG9hZCB5b3VyIGFwcGxpY2F0aW9u4oCZcyBKYXZhU2NyaXB0IGJ1bmRsZSBpbnNpZGUgdGhlIDxoZWFkPiBlbGVtZW50IGluc3RlYWQuIDxzY3JpcHQ+IGVsZW1lbnRzIGluIDxib2R5PiBhcmUgZXZhbHVhdGVkIHdpdGggZWFjaCBwYWdlIGNoYW5nZS5cblxuICAgICAgICBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlOiBodHRwczovL3R1cmJvLmhvdHdpcmVkLmRldi9oYW5kYm9vay9idWlsZGluZyN3b3JraW5nLXdpdGgtc2NyaXB0LWVsZW1lbnRzXG5cbiAgICAgICAg4oCU4oCUXG4gICAgICAgIFN1cHByZXNzIHRoaXMgd2FybmluZyBieSBhZGRpbmcgYSBcImRhdGEtdHVyYm8tc3VwcHJlc3Mtd2FybmluZ1wiIGF0dHJpYnV0ZSB0bzogJXNcbiAgICAgIGAsXG4gICAgICAgIGVsZW1lbnQub3V0ZXJIVE1MXG4gICAgICApXG4gICAgfVxuXG4gICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgfVxufSkoKTtcblxud2luZG93LlR1cmJvID0geyAuLi5UdXJibywgU3RyZWFtQWN0aW9ucyB9O1xuc3RhcnQoKTtcblxuZXhwb3J0IHsgRmV0Y2hFbmN0eXBlLCBGZXRjaE1ldGhvZCwgRmV0Y2hSZXF1ZXN0LCBGZXRjaFJlc3BvbnNlLCBGcmFtZUVsZW1lbnQsIEZyYW1lTG9hZGluZ1N0eWxlLCBGcmFtZVJlbmRlcmVyLCBQYWdlUmVuZGVyZXIsIFBhZ2VTbmFwc2hvdCwgU3RyZWFtQWN0aW9ucywgU3RyZWFtRWxlbWVudCwgU3RyZWFtU291cmNlRWxlbWVudCwgY2FjaGUsIGNsZWFyQ2FjaGUsIGNvbmZpZywgY29ubmVjdFN0cmVhbVNvdXJjZSwgZGlzY29ubmVjdFN0cmVhbVNvdXJjZSwgZmV0Y2hXaXRoVHVyYm9IZWFkZXJzIGFzIGZldGNoLCBmZXRjaEVuY3R5cGVGcm9tU3RyaW5nLCBmZXRjaE1ldGhvZEZyb21TdHJpbmcsIGlzU2FmZSwgbmF2aWdhdG9yJDEgYXMgbmF2aWdhdG9yLCByZWdpc3RlckFkYXB0ZXIsIHJlbmRlclN0cmVhbU1lc3NhZ2UsIHNlc3Npb24sIHNldENvbmZpcm1NZXRob2QsIHNldEZvcm1Nb2RlLCBzZXRQcm9ncmVzc0JhckRlbGF5LCBzdGFydCwgdmlzaXQgfTtcbiIsIi8qISBQaWNrciAxLjkuMCBNSVQgfCBodHRwczovL2dpdGh1Yi5jb20vU2ltb253ZXAvcGlja3IgKi9cbiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuUGlja3I9ZSgpOnQuUGlja3I9ZSgpfShzZWxmLCgoKT0+KCgpPT57XCJ1c2Ugc3RyaWN0XCI7dmFyIHQ9e2Q6KGUsbyk9Pntmb3IodmFyIG4gaW4gbyl0Lm8obyxuKSYmIXQubyhlLG4pJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxuLHtlbnVtZXJhYmxlOiEwLGdldDpvW25dfSl9LG86KHQsZSk9Pk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LGUpLHI6dD0+e1widW5kZWZpbmVkXCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZTpcIk1vZHVsZVwifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9fSxlPXt9O3QuZChlLHtkZWZhdWx0OigpPT5FfSk7dmFyIG89e307ZnVuY3Rpb24gbih0LGUsbyxuLGk9e30pe2UgaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbnx8ZSBpbnN0YW5jZW9mIE5vZGVMaXN0P2U9QXJyYXkuZnJvbShlKTpBcnJheS5pc0FycmF5KGUpfHwoZT1bZV0pLEFycmF5LmlzQXJyYXkobyl8fChvPVtvXSk7Zm9yKGNvbnN0IHMgb2YgZSlmb3IoY29uc3QgZSBvZiBvKXNbdF0oZSxuLHtjYXB0dXJlOiExLC4uLml9KTtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpfXQucihvKSx0LmQobyx7YWRqdXN0YWJsZUlucHV0TnVtYmVyczooKT0+cCxjcmVhdGVFbGVtZW50RnJvbVN0cmluZzooKT0+cixjcmVhdGVGcm9tVGVtcGxhdGU6KCk9PmEsZXZlbnRQYXRoOigpPT5sLG9mZjooKT0+cyxvbjooKT0+aSxyZXNvbHZlRWxlbWVudDooKT0+Y30pO2NvbnN0IGk9bi5iaW5kKG51bGwsXCJhZGRFdmVudExpc3RlbmVyXCIpLHM9bi5iaW5kKG51bGwsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIpO2Z1bmN0aW9uIHIodCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBlLmlubmVySFRNTD10LnRyaW0oKSxlLmZpcnN0RWxlbWVudENoaWxkfWZ1bmN0aW9uIGEodCl7Y29uc3QgZT0odCxlKT0+e2NvbnN0IG89dC5nZXRBdHRyaWJ1dGUoZSk7cmV0dXJuIHQucmVtb3ZlQXR0cmlidXRlKGUpLG99LG89KHQsbj17fSk9Pntjb25zdCBpPWUodCxcIjpvYmpcIikscz1lKHQsXCI6cmVmXCIpLHI9aT9uW2ldPXt9Om47cyYmKG5bc109dCk7Zm9yKGNvbnN0IG4gb2YgQXJyYXkuZnJvbSh0LmNoaWxkcmVuKSl7Y29uc3QgdD1lKG4sXCI6YXJyXCIpLGk9byhuLHQ/e306cik7dCYmKHJbdF18fChyW3RdPVtdKSkucHVzaChPYmplY3Qua2V5cyhpKS5sZW5ndGg/aTpuKX1yZXR1cm4gbn07cmV0dXJuIG8ocih0KSl9ZnVuY3Rpb24gbCh0KXtsZXQgZT10LnBhdGh8fHQuY29tcG9zZWRQYXRoJiZ0LmNvbXBvc2VkUGF0aCgpO2lmKGUpcmV0dXJuIGU7bGV0IG89dC50YXJnZXQucGFyZW50RWxlbWVudDtmb3IoZT1bdC50YXJnZXQsb107bz1vLnBhcmVudEVsZW1lbnQ7KWUucHVzaChvKTtyZXR1cm4gZS5wdXNoKGRvY3VtZW50LHdpbmRvdyksZX1mdW5jdGlvbiBjKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRWxlbWVudD90Olwic3RyaW5nXCI9PXR5cGVvZiB0P3Quc3BsaXQoLz4+L2cpLnJlZHVjZSgoKHQsZSxvLG4pPT4odD10LnF1ZXJ5U2VsZWN0b3IoZSksbzxuLmxlbmd0aC0xP3Quc2hhZG93Um9vdDp0KSksZG9jdW1lbnQpOm51bGx9ZnVuY3Rpb24gcCh0LGU9KHQ9PnQpKXtmdW5jdGlvbiBvKG8pe2NvbnN0IG49Wy4wMDEsLjAxLC4xXVtOdW1iZXIoby5zaGlmdEtleXx8MipvLmN0cmxLZXkpXSooby5kZWx0YVk8MD8xOi0xKTtsZXQgaT0wLHM9dC5zZWxlY3Rpb25TdGFydDt0LnZhbHVlPXQudmFsdWUucmVwbGFjZSgvW1xcZC5dKy9nLCgodCxvKT0+bzw9cyYmbyt0Lmxlbmd0aD49cz8ocz1vLGUoTnVtYmVyKHQpLG4saSkpOihpKyssdCkpKSx0LmZvY3VzKCksdC5zZXRTZWxlY3Rpb25SYW5nZShzLHMpLG8ucHJldmVudERlZmF1bHQoKSx0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiaW5wdXRcIikpfWkodCxcImZvY3VzXCIsKCgpPT5pKHdpbmRvdyxcIndoZWVsXCIsbyx7cGFzc2l2ZTohMX0pKSksaSh0LFwiYmx1clwiLCgoKT0+cyh3aW5kb3csXCJ3aGVlbFwiLG8pKSl9Y29uc3R7bWluOnUsbWF4OmgsZmxvb3I6ZCxyb3VuZDptfT1NYXRoO2Z1bmN0aW9uIGYodCxlLG8pe2UvPTEwMCxvLz0xMDA7Y29uc3Qgbj1kKHQ9dC8zNjAqNiksaT10LW4scz1vKigxLWUpLHI9byooMS1pKmUpLGE9byooMS0oMS1pKSplKSxsPW4lNjtyZXR1cm5bMjU1KltvLHIscyxzLGEsb11bbF0sMjU1KlthLG8sbyxyLHMsc11bbF0sMjU1KltzLHMsYSxvLG8scl1bbF1dfWZ1bmN0aW9uIHYodCxlLG8pe2NvbnN0IG49KDItKGUvPTEwMCkpKihvLz0xMDApLzI7cmV0dXJuIDAhPT1uJiYoZT0xPT09bj8wOm48LjU/ZSpvLygyKm4pOmUqby8oMi0yKm4pKSxbdCwxMDAqZSwxMDAqbl19ZnVuY3Rpb24gYih0LGUsbyl7Y29uc3Qgbj11KHQvPTI1NSxlLz0yNTUsby89MjU1KSxpPWgodCxlLG8pLHM9aS1uO2xldCByLGE7aWYoMD09PXMpcj1hPTA7ZWxzZXthPXMvaTtjb25zdCBuPSgoaS10KS82K3MvMikvcyxsPSgoaS1lKS82K3MvMikvcyxjPSgoaS1vKS82K3MvMikvczt0PT09aT9yPWMtbDplPT09aT9yPTEvMytuLWM6bz09PWkmJihyPTIvMytsLW4pLHI8MD9yKz0xOnI+MSYmKHItPTEpfXJldHVyblszNjAqciwxMDAqYSwxMDAqaV19ZnVuY3Rpb24geSh0LGUsbyxuKXtlLz0xMDAsby89MTAwO3JldHVyblsuLi5iKDI1NSooMS11KDEsKHQvPTEwMCkqKDEtKG4vPTEwMCkpK24pKSwyNTUqKDEtdSgxLGUqKDEtbikrbikpLDI1NSooMS11KDEsbyooMS1uKStuKSkpXX1mdW5jdGlvbiBnKHQsZSxvKXtlLz0xMDA7Y29uc3Qgbj0yKihlKj0oby89MTAwKTwuNT9vOjEtbykvKG8rZSkqMTAwLGk9MTAwKihvK2UpO3JldHVyblt0LGlzTmFOKG4pPzA6bixpXX1mdW5jdGlvbiBfKHQpe3JldHVybiBiKC4uLnQubWF0Y2goLy57Mn0vZykubWFwKCh0PT5wYXJzZUludCh0LDE2KSkpKX1mdW5jdGlvbiB3KHQpe3Q9dC5tYXRjaCgvXlthLXpBLVpdKyQvKT9mdW5jdGlvbih0KXtpZihcImJsYWNrXCI9PT10LnRvTG93ZXJDYXNlKCkpcmV0dXJuXCIjMDAwXCI7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLmdldENvbnRleHQoXCIyZFwiKTtyZXR1cm4gZS5maWxsU3R5bGU9dCxcIiMwMDBcIj09PWUuZmlsbFN0eWxlP251bGw6ZS5maWxsU3R5bGV9KHQpOnQ7Y29uc3QgZT17Y215azovXmNteWtcXEQrKFtcXGQuXSspXFxEKyhbXFxkLl0rKVxcRCsoW1xcZC5dKylcXEQrKFtcXGQuXSspL2kscmdiYTovXnJnYmE/XFxEKyhbXFxkLl0rKSglPylcXEQrKFtcXGQuXSspKCU/KVxcRCsoW1xcZC5dKykoJT8pXFxEKj8oKFtcXGQuXSspKCU/KXwkKS9pLGhzbGE6L15oc2xhP1xcRCsoW1xcZC5dKylcXEQrKFtcXGQuXSspXFxEKyhbXFxkLl0rKVxcRCo/KChbXFxkLl0rKSglPyl8JCkvaSxoc3ZhOi9eaHN2YT9cXEQrKFtcXGQuXSspXFxEKyhbXFxkLl0rKVxcRCsoW1xcZC5dKylcXEQqPygoW1xcZC5dKykoJT8pfCQpL2ksaGV4YTovXiM/KChbXFxkQS1GYS1mXXszLDR9KXwoW1xcZEEtRmEtZl17Nn0pfChbXFxkQS1GYS1mXXs4fSkpJC9pfSxvPXQ9PnQubWFwKCh0PT4vXih8XFxkKylcXC5cXGQrfFxcZCskLy50ZXN0KHQpP051bWJlcih0KTp2b2lkIDApKTtsZXQgbjt0OmZvcihjb25zdCBpIGluIGUpaWYobj1lW2ldLmV4ZWModCkpc3dpdGNoKGkpe2Nhc2VcImNteWtcIjp7Y29uc3RbLHQsZSxzLHJdPW8obik7aWYodD4xMDB8fGU+MTAwfHxzPjEwMHx8cj4xMDApYnJlYWsgdDtyZXR1cm57dmFsdWVzOnkodCxlLHMsciksdHlwZTppfX1jYXNlXCJyZ2JhXCI6e2xldFssdCwsZSwscywsLHJdPW8obik7aWYodD1cIiVcIj09PW5bMl0/dC8xMDAqMjU1OnQsZT1cIiVcIj09PW5bNF0/ZS8xMDAqMjU1OmUscz1cIiVcIj09PW5bNl0/cy8xMDAqMjU1OnMscj1cIiVcIj09PW5bOV0/ci8xMDA6cix0PjI1NXx8ZT4yNTV8fHM+MjU1fHxyPDB8fHI+MSlicmVhayB0O3JldHVybnt2YWx1ZXM6Wy4uLmIodCxlLHMpLHJdLGE6cix0eXBlOml9fWNhc2VcImhleGFcIjp7bGV0Wyx0XT1uOzQhPT10Lmxlbmd0aCYmMyE9PXQubGVuZ3RofHwodD10LnNwbGl0KFwiXCIpLm1hcCgodD0+dCt0KSkuam9pbihcIlwiKSk7Y29uc3QgZT10LnN1YnN0cmluZygwLDYpO2xldCBvPXQuc3Vic3RyaW5nKDYpO3JldHVybiBvPW8/cGFyc2VJbnQobywxNikvMjU1OnZvaWQgMCx7dmFsdWVzOlsuLi5fKGUpLG9dLGE6byx0eXBlOml9fWNhc2VcImhzbGFcIjp7bGV0Wyx0LGUscywscl09byhuKTtpZihyPVwiJVwiPT09bls2XT9yLzEwMDpyLHQ+MzYwfHxlPjEwMHx8cz4xMDB8fHI8MHx8cj4xKWJyZWFrIHQ7cmV0dXJue3ZhbHVlczpbLi4uZyh0LGUscykscl0sYTpyLHR5cGU6aX19Y2FzZVwiaHN2YVwiOntsZXRbLHQsZSxzLCxyXT1vKG4pO2lmKHI9XCIlXCI9PT1uWzZdP3IvMTAwOnIsdD4zNjB8fGU+MTAwfHxzPjEwMHx8cjwwfHxyPjEpYnJlYWsgdDtyZXR1cm57dmFsdWVzOlt0LGUscyxyXSxhOnIsdHlwZTppfX19cmV0dXJue3ZhbHVlczpudWxsLHR5cGU6bnVsbH19ZnVuY3Rpb24gQSh0PTAsZT0wLG89MCxuPTEpe2NvbnN0IGk9KHQsZSk9PihvPS0xKT0+ZSh+bz90Lm1hcCgodD0+TnVtYmVyKHQudG9GaXhlZChvKSkpKTp0KSxzPXtoOnQsczplLHY6byxhOm4sdG9IU1ZBKCl7Y29uc3QgdD1bcy5oLHMucyxzLnYscy5hXTtyZXR1cm4gdC50b1N0cmluZz1pKHQsKHQ9PmBoc3ZhKCR7dFswXX0sICR7dFsxXX0lLCAke3RbMl19JSwgJHtzLmF9KWApKSx0fSx0b0hTTEEoKXtjb25zdCB0PVsuLi52KHMuaCxzLnMscy52KSxzLmFdO3JldHVybiB0LnRvU3RyaW5nPWkodCwodD0+YGhzbGEoJHt0WzBdfSwgJHt0WzFdfSUsICR7dFsyXX0lLCAke3MuYX0pYCkpLHR9LHRvUkdCQSgpe2NvbnN0IHQ9Wy4uLmYocy5oLHMucyxzLnYpLHMuYV07cmV0dXJuIHQudG9TdHJpbmc9aSh0LCh0PT5gcmdiYSgke3RbMF19LCAke3RbMV19LCAke3RbMl19LCAke3MuYX0pYCkpLHR9LHRvQ01ZSygpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlLG8pe2NvbnN0IG49Zih0LGUsbyksaT1uWzBdLzI1NSxzPW5bMV0vMjU1LHI9blsyXS8yNTUsYT11KDEtaSwxLXMsMS1yKTtyZXR1cm5bMTAwKigxPT09YT8wOigxLWktYSkvKDEtYSkpLDEwMCooMT09PWE/MDooMS1zLWEpLygxLWEpKSwxMDAqKDE9PT1hPzA6KDEtci1hKS8oMS1hKSksMTAwKmFdfShzLmgscy5zLHMudik7cmV0dXJuIHQudG9TdHJpbmc9aSh0LCh0PT5gY215aygke3RbMF19JSwgJHt0WzFdfSUsICR7dFsyXX0lLCAke3RbM119JSlgKSksdH0sdG9IRVhBKCl7Y29uc3QgdD1mdW5jdGlvbih0LGUsbyl7cmV0dXJuIGYodCxlLG8pLm1hcCgodD0+bSh0KS50b1N0cmluZygxNikucGFkU3RhcnQoMixcIjBcIikpKX0ocy5oLHMucyxzLnYpLGU9cy5hPj0xP1wiXCI6TnVtYmVyKCgyNTUqcy5hKS50b0ZpeGVkKDApKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKS5wYWRTdGFydCgyLFwiMFwiKTtyZXR1cm4gZSYmdC5wdXNoKGUpLHQudG9TdHJpbmc9KCk9PmAjJHt0LmpvaW4oXCJcIikudG9VcHBlckNhc2UoKX1gLHR9LGNsb25lOigpPT5BKHMuaCxzLnMscy52LHMuYSl9O3JldHVybiBzfWNvbnN0ICQ9dD0+TWF0aC5tYXgoTWF0aC5taW4odCwxKSwwKTtmdW5jdGlvbiBDKHQpe2NvbnN0IGU9e29wdGlvbnM6T2JqZWN0LmFzc2lnbih7bG9jazpudWxsLG9uY2hhbmdlOigpPT4wLG9uc3RvcDooKT0+MH0sdCksX2tleWJvYXJkKHQpe2NvbnN0e29wdGlvbnM6b309ZSx7dHlwZTpuLGtleTppfT10O2lmKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ9PT1vLndyYXBwZXIpe2NvbnN0e2xvY2s6b309ZS5vcHRpb25zLHM9XCJBcnJvd1VwXCI9PT1pLHI9XCJBcnJvd1JpZ2h0XCI9PT1pLGE9XCJBcnJvd0Rvd25cIj09PWksbD1cIkFycm93TGVmdFwiPT09aTtpZihcImtleWRvd25cIj09PW4mJihzfHxyfHxhfHxsKSl7bGV0IG49MCxpPTA7XCJ2XCI9PT1vP249c3x8cj8xOi0xOlwiaFwiPT09bz9uPXN8fHI/LTE6MTooaT1zPy0xOmE/MTowLG49bD8tMTpyPzE6MCksZS51cGRhdGUoJChlLmNhY2hlLngrLjAxKm4pLCQoZS5jYWNoZS55Ky4wMSppKSksdC5wcmV2ZW50RGVmYXVsdCgpfWVsc2UgaS5zdGFydHNXaXRoKFwiQXJyb3dcIikmJihlLm9wdGlvbnMub25zdG9wKCksdC5wcmV2ZW50RGVmYXVsdCgpKX19LF90YXBzdGFydCh0KXtpKGRvY3VtZW50LFtcIm1vdXNldXBcIixcInRvdWNoZW5kXCIsXCJ0b3VjaGNhbmNlbFwiXSxlLl90YXBzdG9wKSxpKGRvY3VtZW50LFtcIm1vdXNlbW92ZVwiLFwidG91Y2htb3ZlXCJdLGUuX3RhcG1vdmUpLHQuY2FuY2VsYWJsZSYmdC5wcmV2ZW50RGVmYXVsdCgpLGUuX3RhcG1vdmUodCl9LF90YXBtb3ZlKHQpe2NvbnN0e29wdGlvbnM6byxjYWNoZTpufT1lLHtsb2NrOmksZWxlbWVudDpzLHdyYXBwZXI6cn09byxhPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7bGV0IGw9MCxjPTA7aWYodCl7Y29uc3QgZT10JiZ0LnRvdWNoZXMmJnQudG91Y2hlc1swXTtsPXQ/KGV8fHQpLmNsaWVudFg6MCxjPXQ/KGV8fHQpLmNsaWVudFk6MCxsPGEubGVmdD9sPWEubGVmdDpsPmEubGVmdCthLndpZHRoJiYobD1hLmxlZnQrYS53aWR0aCksYzxhLnRvcD9jPWEudG9wOmM+YS50b3ArYS5oZWlnaHQmJihjPWEudG9wK2EuaGVpZ2h0KSxsLT1hLmxlZnQsYy09YS50b3B9ZWxzZSBuJiYobD1uLngqYS53aWR0aCxjPW4ueSphLmhlaWdodCk7XCJoXCIhPT1pJiYocy5zdHlsZS5sZWZ0PWBjYWxjKCR7bC9hLndpZHRoKjEwMH0lIC0gJHtzLm9mZnNldFdpZHRoLzJ9cHgpYCksXCJ2XCIhPT1pJiYocy5zdHlsZS50b3A9YGNhbGMoJHtjL2EuaGVpZ2h0KjEwMH0lIC0gJHtzLm9mZnNldEhlaWdodC8yfXB4KWApLGUuY2FjaGU9e3g6bC9hLndpZHRoLHk6Yy9hLmhlaWdodH07Y29uc3QgcD0kKGwvYS53aWR0aCksdT0kKGMvYS5oZWlnaHQpO3N3aXRjaChpKXtjYXNlXCJ2XCI6cmV0dXJuIG8ub25jaGFuZ2UocCk7Y2FzZVwiaFwiOnJldHVybiBvLm9uY2hhbmdlKHUpO2RlZmF1bHQ6cmV0dXJuIG8ub25jaGFuZ2UocCx1KX19LF90YXBzdG9wKCl7ZS5vcHRpb25zLm9uc3RvcCgpLHMoZG9jdW1lbnQsW1wibW91c2V1cFwiLFwidG91Y2hlbmRcIixcInRvdWNoY2FuY2VsXCJdLGUuX3RhcHN0b3ApLHMoZG9jdW1lbnQsW1wibW91c2Vtb3ZlXCIsXCJ0b3VjaG1vdmVcIl0sZS5fdGFwbW92ZSl9LHRyaWdnZXIoKXtlLl90YXBtb3ZlKCl9LHVwZGF0ZSh0PTAsbz0wKXtjb25zdHtsZWZ0Om4sdG9wOmksd2lkdGg6cyxoZWlnaHQ6cn09ZS5vcHRpb25zLndyYXBwZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XCJoXCI9PT1lLm9wdGlvbnMubG9jayYmKG89dCksZS5fdGFwbW92ZSh7Y2xpZW50WDpuK3MqdCxjbGllbnRZOmkrcipvfSl9LGRlc3Ryb3koKXtjb25zdHtvcHRpb25zOnQsX3RhcHN0YXJ0Om8sX2tleWJvYXJkOm59PWU7cyhkb2N1bWVudCxbXCJrZXlkb3duXCIsXCJrZXl1cFwiXSxuKSxzKFt0LndyYXBwZXIsdC5lbGVtZW50XSxcIm1vdXNlZG93blwiLG8pLHMoW3Qud3JhcHBlcix0LmVsZW1lbnRdLFwidG91Y2hzdGFydFwiLG8se3Bhc3NpdmU6ITF9KX19LHtvcHRpb25zOm8sX3RhcHN0YXJ0Om4sX2tleWJvYXJkOnJ9PWU7cmV0dXJuIGkoW28ud3JhcHBlcixvLmVsZW1lbnRdLFwibW91c2Vkb3duXCIsbiksaShbby53cmFwcGVyLG8uZWxlbWVudF0sXCJ0b3VjaHN0YXJ0XCIsbix7cGFzc2l2ZTohMX0pLGkoZG9jdW1lbnQsW1wia2V5ZG93blwiLFwia2V5dXBcIl0sciksZX1mdW5jdGlvbiBrKHQ9e30pe3Q9T2JqZWN0LmFzc2lnbih7b25jaGFuZ2U6KCk9PjAsY2xhc3NOYW1lOlwiXCIsZWxlbWVudHM6W119LHQpO2NvbnN0IGU9aSh0LmVsZW1lbnRzLFwiY2xpY2tcIiwoZT0+e3QuZWxlbWVudHMuZm9yRWFjaCgobz0+by5jbGFzc0xpc3RbZS50YXJnZXQ9PT1vP1wiYWRkXCI6XCJyZW1vdmVcIl0odC5jbGFzc05hbWUpKSksdC5vbmNoYW5nZShlKSxlLnN0b3BQcm9wYWdhdGlvbigpfSkpO3JldHVybntkZXN0cm95OigpPT5zKC4uLmUpfX1jb25zdCBTPXt2YXJpYW50RmxpcE9yZGVyOntzdGFydDpcInNtZVwiLG1pZGRsZTpcIm1zZVwiLGVuZDpcImVtc1wifSxwb3NpdGlvbkZsaXBPcmRlcjp7dG9wOlwidGJybFwiLHJpZ2h0Olwicmx0YlwiLGJvdHRvbTpcImJ0cmxcIixsZWZ0OlwibHJidFwifSxwb3NpdGlvbjpcImJvdHRvbVwiLG1hcmdpbjo4LHBhZGRpbmc6MH0sTz0odCxlLG8pPT57Y29uc3Qgbj1cIm9iamVjdFwiIT10eXBlb2YgdHx8dCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50P3tyZWZlcmVuY2U6dCxwb3BwZXI6ZSwuLi5vfTp0O3JldHVybnt1cGRhdGUodD1uKXtjb25zdHtyZWZlcmVuY2U6ZSxwb3BwZXI6b309T2JqZWN0LmFzc2lnbihuLHQpO2lmKCFvfHwhZSl0aHJvdyBuZXcgRXJyb3IoXCJQb3BwZXItIG9yIHJlZmVyZW5jZS1lbGVtZW50IG1pc3NpbmcuXCIpO3JldHVybigodCxlLG8pPT57Y29uc3R7Y29udGFpbmVyOm4sYXJyb3c6aSxtYXJnaW46cyxwYWRkaW5nOnIscG9zaXRpb246YSx2YXJpYW50RmxpcE9yZGVyOmwscG9zaXRpb25GbGlwT3JkZXI6Y309e2NvbnRhaW5lcjpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksLi4uUywuLi5vfSx7bGVmdDpwLHRvcDp1fT1lLnN0eWxlO2Uuc3R5bGUubGVmdD1cIjBcIixlLnN0eWxlLnRvcD1cIjBcIjtjb25zdCBoPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksZD1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG09e3Q6aC50b3AtZC5oZWlnaHQtcyxiOmguYm90dG9tK3MscjpoLnJpZ2h0K3MsbDpoLmxlZnQtZC53aWR0aC1zfSxmPXt2czpoLmxlZnQsdm06aC5sZWZ0K2gud2lkdGgvMi1kLndpZHRoLzIsdmU6aC5sZWZ0K2gud2lkdGgtZC53aWR0aCxoczpoLnRvcCxobTpoLmJvdHRvbS1oLmhlaWdodC8yLWQuaGVpZ2h0LzIsaGU6aC5ib3R0b20tZC5oZWlnaHR9LFt2LGI9XCJtaWRkbGVcIl09YS5zcGxpdChcIi1cIikseT1jW3ZdLGc9bFtiXSx7dG9wOl8sbGVmdDp3LGJvdHRvbTpBLHJpZ2h0OiR9PW47Zm9yKGNvbnN0IHQgb2YgeSl7Y29uc3Qgbz1cInRcIj09PXR8fFwiYlwiPT09dDtsZXQgbj1tW3RdO2NvbnN0W3MsYV09bz9bXCJ0b3BcIixcImxlZnRcIl06W1wibGVmdFwiLFwidG9wXCJdLFtsLGNdPW8/W2QuaGVpZ2h0LGQud2lkdGhdOltkLndpZHRoLGQuaGVpZ2h0XSxbcCx1XT1vP1tBLCRdOlskLEFdLFt2LGJdPW8/W18sd106W3csX107aWYoIShuPHZ8fG4rbCtyPnApKWZvcihjb25zdCBwIG9mIGcpe2xldCBtPWZbKG8/XCJ2XCI6XCJoXCIpK3BdO2lmKCEobTxifHxtK2Mrcj51KSl7aWYobS09ZFthXSxuLT1kW3NdLGUuc3R5bGVbYV09YCR7bX1weGAsZS5zdHlsZVtzXT1gJHtufXB4YCxpKXtjb25zdCB0PW8/aC53aWR0aC8yOmguaGVpZ2h0LzIsZT0yKnQ8Yz9oW2FdK3Q6bStjLzI7bjxoW3NdJiYobis9bCksaS5zdHlsZVthXT1gJHtlfXB4YCxpLnN0eWxlW3NdPWAke259cHhgfXJldHVybiB0K3B9fX1yZXR1cm4gZS5zdHlsZS5sZWZ0PXAsZS5zdHlsZS50b3A9dSxudWxsfSkoZSxvLG4pfX19O2NsYXNzIEV7c3RhdGljIHV0aWxzPW87c3RhdGljIHZlcnNpb249XCIxLjkuMFwiO3N0YXRpYyBJMThOX0RFRkFVTFRTPXtcInVpOmRpYWxvZ1wiOlwiY29sb3IgcGlja2VyIGRpYWxvZ1wiLFwiYnRuOnRvZ2dsZVwiOlwidG9nZ2xlIGNvbG9yIHBpY2tlciBkaWFsb2dcIixcImJ0bjpzd2F0Y2hcIjpcImNvbG9yIHN3YXRjaFwiLFwiYnRuOmxhc3QtY29sb3JcIjpcInVzZSBwcmV2aW91cyBjb2xvclwiLFwiYnRuOnNhdmVcIjpcIlNhdmVcIixcImJ0bjpjYW5jZWxcIjpcIkNhbmNlbFwiLFwiYnRuOmNsZWFyXCI6XCJDbGVhclwiLFwiYXJpYTpidG46c2F2ZVwiOlwic2F2ZSBhbmQgY2xvc2VcIixcImFyaWE6YnRuOmNhbmNlbFwiOlwiY2FuY2VsIGFuZCBjbG9zZVwiLFwiYXJpYTpidG46Y2xlYXJcIjpcImNsZWFyIGFuZCBjbG9zZVwiLFwiYXJpYTppbnB1dFwiOlwiY29sb3IgaW5wdXQgZmllbGRcIixcImFyaWE6cGFsZXR0ZVwiOlwiY29sb3Igc2VsZWN0aW9uIGFyZWFcIixcImFyaWE6aHVlXCI6XCJodWUgc2VsZWN0aW9uIHNsaWRlclwiLFwiYXJpYTpvcGFjaXR5XCI6XCJzZWxlY3Rpb24gc2xpZGVyXCJ9O3N0YXRpYyBERUZBVUxUX09QVElPTlM9e2FwcENsYXNzOm51bGwsdGhlbWU6XCJjbGFzc2ljXCIsdXNlQXNCdXR0b246ITEscGFkZGluZzo4LGRpc2FibGVkOiExLGNvbXBhcmlzb246ITAsY2xvc2VPblNjcm9sbDohMSxvdXRwdXRQcmVjaXNpb246MCxsb2NrT3BhY2l0eTohMSxhdXRvUmVwb3NpdGlvbjohMCxjb250YWluZXI6XCJib2R5XCIsY29tcG9uZW50czp7aW50ZXJhY3Rpb246e319LGkxOG46e30sc3dhdGNoZXM6bnVsbCxpbmxpbmU6ITEsc2xpZGVyczpudWxsLGRlZmF1bHQ6XCIjNDI0NDVhXCIsZGVmYXVsdFJlcHJlc2VudGF0aW9uOm51bGwscG9zaXRpb246XCJib3R0b20tbWlkZGxlXCIsYWRqdXN0YWJsZU51bWJlcnM6ITAsc2hvd0Fsd2F5czohMSxjbG9zZVdpdGhLZXk6XCJFc2NhcGVcIn07X2luaXRpYWxpemluZ0FjdGl2ZT0hMDtfcmVjYWxjPSEwO19uYW5vcG9wPW51bGw7X3Jvb3Q9bnVsbDtfY29sb3I9QSgpO19sYXN0Q29sb3I9QSgpO19zd2F0Y2hDb2xvcnM9W107X3NldHVwQW5pbWF0aW9uRnJhbWU9bnVsbDtfZXZlbnRMaXN0ZW5lcj17aW5pdDpbXSxzYXZlOltdLGhpZGU6W10sc2hvdzpbXSxjbGVhcjpbXSxjaGFuZ2U6W10sY2hhbmdlc3RvcDpbXSxjYW5jZWw6W10sc3dhdGNoc2VsZWN0OltdfTtjb25zdHJ1Y3Rvcih0KXt0aGlzLm9wdGlvbnM9dD1PYmplY3QuYXNzaWduKHsuLi5FLkRFRkFVTFRfT1BUSU9OU30sdCk7Y29uc3R7c3dhdGNoZXM6ZSxjb21wb25lbnRzOm8sdGhlbWU6bixzbGlkZXJzOmksbG9ja09wYWNpdHk6cyxwYWRkaW5nOnJ9PXQ7W1wibmFub1wiLFwibW9ub2xpdGhcIl0uaW5jbHVkZXMobikmJiFpJiYodC5zbGlkZXJzPVwiaFwiKSxvLmludGVyYWN0aW9ufHwoby5pbnRlcmFjdGlvbj17fSk7Y29uc3R7cHJldmlldzphLG9wYWNpdHk6bCxodWU6YyxwYWxldHRlOnB9PW87by5vcGFjaXR5PSFzJiZsLG8ucGFsZXR0ZT1wfHxhfHxsfHxjLHRoaXMuX3ByZUJ1aWxkKCksdGhpcy5fYnVpbGRDb21wb25lbnRzKCksdGhpcy5fYmluZEV2ZW50cygpLHRoaXMuX2ZpbmFsQnVpbGQoKSxlJiZlLmxlbmd0aCYmZS5mb3JFYWNoKCh0PT50aGlzLmFkZFN3YXRjaCh0KSkpO2NvbnN0e2J1dHRvbjp1LGFwcDpofT10aGlzLl9yb290O3RoaXMuX25hbm9wb3A9Tyh1LGgse21hcmdpbjpyfSksdS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJidXR0b25cIiksdS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsdGhpcy5fdChcImJ0bjp0b2dnbGVcIikpO2NvbnN0IGQ9dGhpczt0aGlzLl9zZXR1cEFuaW1hdGlvbkZyYW1lPXJlcXVlc3RBbmltYXRpb25GcmFtZSgoZnVuY3Rpb24gZSgpe2lmKCFoLm9mZnNldFdpZHRoKXJldHVybiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSk7ZC5zZXRDb2xvcih0LmRlZmF1bHQpLGQuX3JlUG9zaXRpb25pbmdQaWNrZXIoKSx0LmRlZmF1bHRSZXByZXNlbnRhdGlvbiYmKGQuX3JlcHJlc2VudGF0aW9uPXQuZGVmYXVsdFJlcHJlc2VudGF0aW9uLGQuc2V0Q29sb3JSZXByZXNlbnRhdGlvbihkLl9yZXByZXNlbnRhdGlvbikpLHQuc2hvd0Fsd2F5cyYmZC5zaG93KCksZC5faW5pdGlhbGl6aW5nQWN0aXZlPSExLGQuX2VtaXQoXCJpbml0XCIpfSkpfXN0YXRpYyBjcmVhdGU9dD0+bmV3IEUodCk7X3ByZUJ1aWxkKCl7Y29uc3R7b3B0aW9uczp0fT10aGlzO2Zvcihjb25zdCBlIG9mW1wiZWxcIixcImNvbnRhaW5lclwiXSl0W2VdPWModFtlXSk7dGhpcy5fcm9vdD0odD0+e2NvbnN0e2NvbXBvbmVudHM6ZSx1c2VBc0J1dHRvbjpvLGlubGluZTpuLGFwcENsYXNzOmksdGhlbWU6cyxsb2NrT3BhY2l0eTpyfT10Lm9wdGlvbnMsbD10PT50P1wiXCI6J3N0eWxlPVwiZGlzcGxheTpub25lXCIgaGlkZGVuJyxjPWU9PnQuX3QoZSkscD1hKGBcXG4gICAgICA8ZGl2IDpyZWY9XCJyb290XCIgY2xhc3M9XCJwaWNrclwiPlxcblxcbiAgICAgICAgJHtvP1wiXCI6JzxidXR0b24gdHlwZT1cImJ1dHRvblwiIDpyZWY9XCJidXR0b25cIiBjbGFzcz1cInBjci1idXR0b25cIj48L2J1dHRvbj4nfVxcblxcbiAgICAgICAgPGRpdiA6cmVmPVwiYXBwXCIgY2xhc3M9XCJwY3ItYXBwICR7aXx8XCJcIn1cIiBkYXRhLXRoZW1lPVwiJHtzfVwiICR7bj8nc3R5bGU9XCJwb3NpdGlvbjogdW5zZXRcIic6XCJcIn0gYXJpYS1sYWJlbD1cIiR7YyhcInVpOmRpYWxvZ1wiKX1cIiByb2xlPVwid2luZG93XCI+XFxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJwY3Itc2VsZWN0aW9uXCIgJHtsKGUucGFsZXR0ZSl9PlxcbiAgICAgICAgICAgIDxkaXYgOm9iaj1cInByZXZpZXdcIiBjbGFzcz1cInBjci1jb2xvci1wcmV2aWV3XCIgJHtsKGUucHJldmlldyl9PlxcbiAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgOnJlZj1cImxhc3RDb2xvclwiIGNsYXNzPVwicGNyLWxhc3QtY29sb3JcIiBhcmlhLWxhYmVsPVwiJHtjKFwiYnRuOmxhc3QtY29sb3JcIil9XCI+PC9idXR0b24+XFxuICAgICAgICAgICAgICA8ZGl2IDpyZWY9XCJjdXJyZW50Q29sb3JcIiBjbGFzcz1cInBjci1jdXJyZW50LWNvbG9yXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiA6b2JqPVwicGFsZXR0ZVwiIGNsYXNzPVwicGNyLWNvbG9yLXBhbGV0dGVcIj5cXG4gICAgICAgICAgICAgIDxkaXYgOnJlZj1cInBpY2tlclwiIGNsYXNzPVwicGNyLXBpY2tlclwiPjwvZGl2PlxcbiAgICAgICAgICAgICAgPGRpdiA6cmVmPVwicGFsZXR0ZVwiIGNsYXNzPVwicGNyLXBhbGV0dGVcIiB0YWJpbmRleD1cIjBcIiBhcmlhLWxhYmVsPVwiJHtjKFwiYXJpYTpwYWxldHRlXCIpfVwiIHJvbGU9XCJsaXN0Ym94XCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiA6b2JqPVwiaHVlXCIgY2xhc3M9XCJwY3ItY29sb3ItY2hvb3NlclwiICR7bChlLmh1ZSl9PlxcbiAgICAgICAgICAgICAgPGRpdiA6cmVmPVwicGlja2VyXCIgY2xhc3M9XCJwY3ItcGlja2VyXCI+PC9kaXY+XFxuICAgICAgICAgICAgICA8ZGl2IDpyZWY9XCJzbGlkZXJcIiBjbGFzcz1cInBjci1odWUgcGNyLXNsaWRlclwiIHRhYmluZGV4PVwiMFwiIGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOmh1ZVwiKX1cIiByb2xlPVwic2xpZGVyXCI+PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuXFxuICAgICAgICAgICAgPGRpdiA6b2JqPVwib3BhY2l0eVwiIGNsYXNzPVwicGNyLWNvbG9yLW9wYWNpdHlcIiAke2woZS5vcGFjaXR5KX0+XFxuICAgICAgICAgICAgICA8ZGl2IDpyZWY9XCJwaWNrZXJcIiBjbGFzcz1cInBjci1waWNrZXJcIj48L2Rpdj5cXG4gICAgICAgICAgICAgIDxkaXYgOnJlZj1cInNsaWRlclwiIGNsYXNzPVwicGNyLW9wYWNpdHkgcGNyLXNsaWRlclwiIHRhYmluZGV4PVwiMFwiIGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOm9wYWNpdHlcIil9XCIgcm9sZT1cInNsaWRlclwiPjwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8L2Rpdj5cXG5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInBjci1zd2F0Y2hlcyAke2UucGFsZXR0ZT9cIlwiOlwicGNyLWxhc3RcIn1cIiA6cmVmPVwic3dhdGNoZXNcIj48L2Rpdj5cXG5cXG4gICAgICAgICAgPGRpdiA6b2JqPVwiaW50ZXJhY3Rpb25cIiBjbGFzcz1cInBjci1pbnRlcmFjdGlvblwiICR7bChPYmplY3Qua2V5cyhlLmludGVyYWN0aW9uKS5sZW5ndGgpfT5cXG4gICAgICAgICAgICA8aW5wdXQgOnJlZj1cInJlc3VsdFwiIGNsYXNzPVwicGNyLXJlc3VsdFwiIHR5cGU9XCJ0ZXh0XCIgc3BlbGxjaGVjaz1cImZhbHNlXCIgJHtsKGUuaW50ZXJhY3Rpb24uaW5wdXQpfSBhcmlhLWxhYmVsPVwiJHtjKFwiYXJpYTppbnB1dFwiKX1cIj5cXG5cXG4gICAgICAgICAgICA8aW5wdXQgOmFycj1cIm9wdGlvbnNcIiBjbGFzcz1cInBjci10eXBlXCIgZGF0YS10eXBlPVwiSEVYQVwiIHZhbHVlPVwiJHtyP1wiSEVYXCI6XCJIRVhBXCJ9XCIgdHlwZT1cImJ1dHRvblwiICR7bChlLmludGVyYWN0aW9uLmhleCl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJSR0JBXCIgdmFsdWU9XCIke3I/XCJSR0JcIjpcIlJHQkFcIn1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24ucmdiYSl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJIU0xBXCIgdmFsdWU9XCIke3I/XCJIU0xcIjpcIkhTTEFcIn1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24uaHNsYSl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJIU1ZBXCIgdmFsdWU9XCIke3I/XCJIU1ZcIjpcIkhTVkFcIn1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24uaHN2YSl9PlxcbiAgICAgICAgICAgIDxpbnB1dCA6YXJyPVwib3B0aW9uc1wiIGNsYXNzPVwicGNyLXR5cGVcIiBkYXRhLXR5cGU9XCJDTVlLXCIgdmFsdWU9XCJDTVlLXCIgdHlwZT1cImJ1dHRvblwiICR7bChlLmludGVyYWN0aW9uLmNteWspfT5cXG5cXG4gICAgICAgICAgICA8aW5wdXQgOnJlZj1cInNhdmVcIiBjbGFzcz1cInBjci1zYXZlXCIgdmFsdWU9XCIke2MoXCJidG46c2F2ZVwiKX1cIiB0eXBlPVwiYnV0dG9uXCIgJHtsKGUuaW50ZXJhY3Rpb24uc2F2ZSl9IGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOmJ0bjpzYXZlXCIpfVwiPlxcbiAgICAgICAgICAgIDxpbnB1dCA6cmVmPVwiY2FuY2VsXCIgY2xhc3M9XCJwY3ItY2FuY2VsXCIgdmFsdWU9XCIke2MoXCJidG46Y2FuY2VsXCIpfVwiIHR5cGU9XCJidXR0b25cIiAke2woZS5pbnRlcmFjdGlvbi5jYW5jZWwpfSBhcmlhLWxhYmVsPVwiJHtjKFwiYXJpYTpidG46Y2FuY2VsXCIpfVwiPlxcbiAgICAgICAgICAgIDxpbnB1dCA6cmVmPVwiY2xlYXJcIiBjbGFzcz1cInBjci1jbGVhclwiIHZhbHVlPVwiJHtjKFwiYnRuOmNsZWFyXCIpfVwiIHR5cGU9XCJidXR0b25cIiAke2woZS5pbnRlcmFjdGlvbi5jbGVhcil9IGFyaWEtbGFiZWw9XCIke2MoXCJhcmlhOmJ0bjpjbGVhclwiKX1cIj5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgYCksdT1wLmludGVyYWN0aW9uO3JldHVybiB1Lm9wdGlvbnMuZmluZCgodD0+IXQuaGlkZGVuJiYhdC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpKSksdS50eXBlPSgpPT51Lm9wdGlvbnMuZmluZCgodD0+dC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpKSxwfSkodGhpcyksdC51c2VBc0J1dHRvbiYmKHRoaXMuX3Jvb3QuYnV0dG9uPXQuZWwpLHQuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuX3Jvb3Qucm9vdCl9X2ZpbmFsQnVpbGQoKXtjb25zdCB0PXRoaXMub3B0aW9ucyxlPXRoaXMuX3Jvb3Q7aWYodC5jb250YWluZXIucmVtb3ZlQ2hpbGQoZS5yb290KSx0LmlubGluZSl7Y29uc3Qgbz10LmVsLnBhcmVudEVsZW1lbnQ7dC5lbC5uZXh0U2libGluZz9vLmluc2VydEJlZm9yZShlLmFwcCx0LmVsLm5leHRTaWJsaW5nKTpvLmFwcGVuZENoaWxkKGUuYXBwKX1lbHNlIHQuY29udGFpbmVyLmFwcGVuZENoaWxkKGUuYXBwKTt0LnVzZUFzQnV0dG9uP3QuaW5saW5lJiZ0LmVsLnJlbW92ZSgpOnQuZWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZS5yb290LHQuZWwpLHQuZGlzYWJsZWQmJnRoaXMuZGlzYWJsZSgpLHQuY29tcGFyaXNvbnx8KGUuYnV0dG9uLnN0eWxlLnRyYW5zaXRpb249XCJub25lXCIsdC51c2VBc0J1dHRvbnx8KGUucHJldmlldy5sYXN0Q29sb3Iuc3R5bGUudHJhbnNpdGlvbj1cIm5vbmVcIikpLHRoaXMuaGlkZSgpfV9idWlsZENvbXBvbmVudHMoKXtjb25zdCB0PXRoaXMsZT10aGlzLm9wdGlvbnMuY29tcG9uZW50cyxvPSh0Lm9wdGlvbnMuc2xpZGVyc3x8XCJ2XCIpLnJlcGVhdCgyKSxbbixpXT1vLm1hdGNoKC9eW3ZoXSskL2cpP286W10scz0oKT0+dGhpcy5fY29sb3J8fCh0aGlzLl9jb2xvcj10aGlzLl9sYXN0Q29sb3IuY2xvbmUoKSkscj17cGFsZXR0ZTpDKHtlbGVtZW50OnQuX3Jvb3QucGFsZXR0ZS5waWNrZXIsd3JhcHBlcjp0Ll9yb290LnBhbGV0dGUucGFsZXR0ZSxvbnN0b3A6KCk9PnQuX2VtaXQoXCJjaGFuZ2VzdG9wXCIsXCJzbGlkZXJcIix0KSxvbmNoYW5nZShvLG4pe2lmKCFlLnBhbGV0dGUpcmV0dXJuO2NvbnN0IGk9cygpLHtfcm9vdDpyLG9wdGlvbnM6YX09dCx7bGFzdENvbG9yOmwsY3VycmVudENvbG9yOmN9PXIucHJldmlldzt0Ll9yZWNhbGMmJihpLnM9MTAwKm8saS52PTEwMC0xMDAqbixpLnY8MCYmKGkudj0wKSx0Ll91cGRhdGVPdXRwdXQoXCJzbGlkZXJcIikpO2NvbnN0IHA9aS50b1JHQkEoKS50b1N0cmluZygwKTt0aGlzLmVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZD1wLHRoaXMud3JhcHBlci5zdHlsZS5iYWNrZ3JvdW5kPWBcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lYXItZ3JhZGllbnQodG8gdG9wLCByZ2JhKDAsIDAsIDAsICR7aS5hfSksIHRyYW5zcGFyZW50KSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lYXItZ3JhZGllbnQodG8gbGVmdCwgaHNsYSgke2kuaH0sIDEwMCUsIDUwJSwgJHtpLmF9KSwgcmdiYSgyNTUsIDI1NSwgMjU1LCAke2kuYX0pKVxcbiAgICAgICAgICAgICAgICAgICAgYCxhLmNvbXBhcmlzb24/YS51c2VBc0J1dHRvbnx8dC5fbGFzdENvbG9yfHxsLnN0eWxlLnNldFByb3BlcnR5KFwiLS1wY3ItY29sb3JcIixwKTooci5idXR0b24uc3R5bGUuc2V0UHJvcGVydHkoXCItLXBjci1jb2xvclwiLHApLHIuYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjbGVhclwiKSk7Y29uc3QgdT1pLnRvSEVYQSgpLnRvU3RyaW5nKCk7Zm9yKGNvbnN0e2VsOmUsY29sb3I6b31vZiB0Ll9zd2F0Y2hDb2xvcnMpZS5jbGFzc0xpc3RbdT09PW8udG9IRVhBKCkudG9TdHJpbmcoKT9cImFkZFwiOlwicmVtb3ZlXCJdKFwicGNyLWFjdGl2ZVwiKTtjLnN0eWxlLnNldFByb3BlcnR5KFwiLS1wY3ItY29sb3JcIixwKX19KSxodWU6Qyh7bG9jazpcInZcIj09PWk/XCJoXCI6XCJ2XCIsZWxlbWVudDp0Ll9yb290Lmh1ZS5waWNrZXIsd3JhcHBlcjp0Ll9yb290Lmh1ZS5zbGlkZXIsb25zdG9wOigpPT50Ll9lbWl0KFwiY2hhbmdlc3RvcFwiLFwic2xpZGVyXCIsdCksb25jaGFuZ2Uobyl7aWYoIWUuaHVlfHwhZS5wYWxldHRlKXJldHVybjtjb25zdCBuPXMoKTt0Ll9yZWNhbGMmJihuLmg9MzYwKm8pLHRoaXMuZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9YGhzbCgke24uaH0sIDEwMCUsIDUwJSlgLHIucGFsZXR0ZS50cmlnZ2VyKCl9fSksb3BhY2l0eTpDKHtsb2NrOlwidlwiPT09bj9cImhcIjpcInZcIixlbGVtZW50OnQuX3Jvb3Qub3BhY2l0eS5waWNrZXIsd3JhcHBlcjp0Ll9yb290Lm9wYWNpdHkuc2xpZGVyLG9uc3RvcDooKT0+dC5fZW1pdChcImNoYW5nZXN0b3BcIixcInNsaWRlclwiLHQpLG9uY2hhbmdlKG8pe2lmKCFlLm9wYWNpdHl8fCFlLnBhbGV0dGUpcmV0dXJuO2NvbnN0IG49cygpO3QuX3JlY2FsYyYmKG4uYT1NYXRoLnJvdW5kKDEwMCpvKS8xMDApLHRoaXMuZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kPWByZ2JhKDAsIDAsIDAsICR7bi5hfSlgLHIucGFsZXR0ZS50cmlnZ2VyKCl9fSksc2VsZWN0YWJsZTprKHtlbGVtZW50czp0Ll9yb290LmludGVyYWN0aW9uLm9wdGlvbnMsY2xhc3NOYW1lOlwiYWN0aXZlXCIsb25jaGFuZ2UoZSl7dC5fcmVwcmVzZW50YXRpb249ZS50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS10eXBlXCIpLnRvVXBwZXJDYXNlKCksdC5fcmVjYWxjJiZ0Ll91cGRhdGVPdXRwdXQoXCJzd2F0Y2hcIil9fSl9O3RoaXMuX2NvbXBvbmVudHM9cn1fYmluZEV2ZW50cygpe2NvbnN0e19yb290OnQsb3B0aW9uczplfT10aGlzLG89W2kodC5pbnRlcmFjdGlvbi5jbGVhcixcImNsaWNrXCIsKCgpPT50aGlzLl9jbGVhckNvbG9yKCkpKSxpKFt0LmludGVyYWN0aW9uLmNhbmNlbCx0LnByZXZpZXcubGFzdENvbG9yXSxcImNsaWNrXCIsKCgpPT57dGhpcy5zZXRIU1ZBKC4uLih0aGlzLl9sYXN0Q29sb3J8fHRoaXMuX2NvbG9yKS50b0hTVkEoKSwhMCksdGhpcy5fZW1pdChcImNhbmNlbFwiKX0pKSxpKHQuaW50ZXJhY3Rpb24uc2F2ZSxcImNsaWNrXCIsKCgpPT57IXRoaXMuYXBwbHlDb2xvcigpJiYhZS5zaG93QWx3YXlzJiZ0aGlzLmhpZGUoKX0pKSxpKHQuaW50ZXJhY3Rpb24ucmVzdWx0LFtcImtleXVwXCIsXCJpbnB1dFwiXSwodD0+e3RoaXMuc2V0Q29sb3IodC50YXJnZXQudmFsdWUsITApJiYhdGhpcy5faW5pdGlhbGl6aW5nQWN0aXZlJiYodGhpcy5fZW1pdChcImNoYW5nZVwiLHRoaXMuX2NvbG9yLFwiaW5wdXRcIix0aGlzKSx0aGlzLl9lbWl0KFwiY2hhbmdlc3RvcFwiLFwiaW5wdXRcIix0aGlzKSksdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKX0pKSxpKHQuaW50ZXJhY3Rpb24ucmVzdWx0LFtcImZvY3VzXCIsXCJibHVyXCJdLCh0PT57dGhpcy5fcmVjYWxjPVwiYmx1clwiPT09dC50eXBlLHRoaXMuX3JlY2FsYyYmdGhpcy5fdXBkYXRlT3V0cHV0KG51bGwpfSkpLGkoW3QucGFsZXR0ZS5wYWxldHRlLHQucGFsZXR0ZS5waWNrZXIsdC5odWUuc2xpZGVyLHQuaHVlLnBpY2tlcix0Lm9wYWNpdHkuc2xpZGVyLHQub3BhY2l0eS5waWNrZXJdLFtcIm1vdXNlZG93blwiLFwidG91Y2hzdGFydFwiXSwoKCk9PnRoaXMuX3JlY2FsYz0hMCkse3Bhc3NpdmU6ITB9KV07aWYoIWUuc2hvd0Fsd2F5cyl7Y29uc3Qgbj1lLmNsb3NlV2l0aEtleTtvLnB1c2goaSh0LmJ1dHRvbixcImNsaWNrXCIsKCgpPT50aGlzLmlzT3BlbigpP3RoaXMuaGlkZSgpOnRoaXMuc2hvdygpKSksaShkb2N1bWVudCxcImtleXVwXCIsKHQ9PnRoaXMuaXNPcGVuKCkmJih0LmtleT09PW58fHQuY29kZT09PW4pJiZ0aGlzLmhpZGUoKSkpLGkoZG9jdW1lbnQsW1widG91Y2hzdGFydFwiLFwibW91c2Vkb3duXCJdLChlPT57dGhpcy5pc09wZW4oKSYmIWwoZSkuc29tZSgoZT0+ZT09PXQuYXBwfHxlPT09dC5idXR0b24pKSYmdGhpcy5oaWRlKCl9KSx7Y2FwdHVyZTohMH0pKX1pZihlLmFkanVzdGFibGVOdW1iZXJzKXtjb25zdCBlPXtyZ2JhOlsyNTUsMjU1LDI1NSwxXSxoc3ZhOlszNjAsMTAwLDEwMCwxXSxoc2xhOlszNjAsMTAwLDEwMCwxXSxjbXlrOlsxMDAsMTAwLDEwMCwxMDBdfTtwKHQuaW50ZXJhY3Rpb24ucmVzdWx0LCgodCxvLG4pPT57Y29uc3QgaT1lW3RoaXMuZ2V0Q29sb3JSZXByZXNlbnRhdGlvbigpLnRvTG93ZXJDYXNlKCldO2lmKGkpe2NvbnN0IGU9aVtuXSxzPXQrKGU+PTEwMD8xZTMqbzpvKTtyZXR1cm4gczw9MD8wOk51bWJlcigoczxlP3M6ZSkudG9QcmVjaXNpb24oMykpfXJldHVybiB0fSkpfWlmKGUuYXV0b1JlcG9zaXRpb24mJiFlLmlubGluZSl7bGV0IHQ9bnVsbDtjb25zdCBuPXRoaXM7by5wdXNoKGkod2luZG93LFtcInNjcm9sbFwiLFwicmVzaXplXCJdLCgoKT0+e24uaXNPcGVuKCkmJihlLmNsb3NlT25TY3JvbGwmJm4uaGlkZSgpLG51bGw9PT10Pyh0PXNldFRpbWVvdXQoKCgpPT50PW51bGwpLDEwMCkscmVxdWVzdEFuaW1hdGlvbkZyYW1lKChmdW5jdGlvbiBlKCl7bi5fcmVQb3NpdGlvbmluZ1BpY2tlcigpLG51bGwhPT10JiZyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSl9KSkpOihjbGVhclRpbWVvdXQodCksdD1zZXRUaW1lb3V0KCgoKT0+dD1udWxsKSwxMDApKSl9KSx7Y2FwdHVyZTohMH0pKX10aGlzLl9ldmVudEJpbmRpbmdzPW99X3JlUG9zaXRpb25pbmdQaWNrZXIoKXtjb25zdHtvcHRpb25zOnR9PXRoaXM7aWYoIXQuaW5saW5lKXtpZighdGhpcy5fbmFub3BvcC51cGRhdGUoe2NvbnRhaW5lcjpkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHBvc2l0aW9uOnQucG9zaXRpb259KSl7Y29uc3QgdD10aGlzLl9yb290LmFwcCxlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7dC5zdHlsZS50b3A9KHdpbmRvdy5pbm5lckhlaWdodC1lLmhlaWdodCkvMitcInB4XCIsdC5zdHlsZS5sZWZ0PSh3aW5kb3cuaW5uZXJXaWR0aC1lLndpZHRoKS8yK1wicHhcIn19fV91cGRhdGVPdXRwdXQodCl7Y29uc3R7X3Jvb3Q6ZSxfY29sb3I6byxvcHRpb25zOm59PXRoaXM7aWYoZS5pbnRlcmFjdGlvbi50eXBlKCkpe2NvbnN0IHQ9YHRvJHtlLmludGVyYWN0aW9uLnR5cGUoKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGVcIil9YDtlLmludGVyYWN0aW9uLnJlc3VsdC52YWx1ZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBvW3RdP29bdF0oKS50b1N0cmluZyhuLm91dHB1dFByZWNpc2lvbik6XCJcIn0hdGhpcy5faW5pdGlhbGl6aW5nQWN0aXZlJiZ0aGlzLl9yZWNhbGMmJnRoaXMuX2VtaXQoXCJjaGFuZ2VcIixvLHQsdGhpcyl9X2NsZWFyQ29sb3IodD0hMSl7Y29uc3R7X3Jvb3Q6ZSxvcHRpb25zOm99PXRoaXM7by51c2VBc0J1dHRvbnx8ZS5idXR0b24uc3R5bGUuc2V0UHJvcGVydHkoXCItLXBjci1jb2xvclwiLFwicmdiYSgwLCAwLCAwLCAwLjE1KVwiKSxlLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2xlYXJcIiksby5zaG93QWx3YXlzfHx0aGlzLmhpZGUoKSx0aGlzLl9sYXN0Q29sb3I9bnVsbCx0aGlzLl9pbml0aWFsaXppbmdBY3RpdmV8fHR8fCh0aGlzLl9lbWl0KFwic2F2ZVwiLG51bGwpLHRoaXMuX2VtaXQoXCJjbGVhclwiKSl9X3BhcnNlTG9jYWxDb2xvcih0KXtjb25zdHt2YWx1ZXM6ZSx0eXBlOm8sYTpufT13KHQpLHtsb2NrT3BhY2l0eTppfT10aGlzLm9wdGlvbnMscz12b2lkIDAhPT1uJiYxIT09bjtyZXR1cm4gZSYmMz09PWUubGVuZ3RoJiYoZVszXT12b2lkIDApLHt2YWx1ZXM6IWV8fGkmJnM/bnVsbDplLHR5cGU6b319X3QodCl7cmV0dXJuIHRoaXMub3B0aW9ucy5pMThuW3RdfHxFLkkxOE5fREVGQVVMVFNbdF19X2VtaXQodCwuLi5lKXt0aGlzLl9ldmVudExpc3RlbmVyW3RdLmZvckVhY2goKHQ9PnQoLi4uZSx0aGlzKSkpfW9uKHQsZSl7cmV0dXJuIHRoaXMuX2V2ZW50TGlzdGVuZXJbdF0ucHVzaChlKSx0aGlzfW9mZih0LGUpe2NvbnN0IG89dGhpcy5fZXZlbnRMaXN0ZW5lclt0XXx8W10sbj1vLmluZGV4T2YoZSk7cmV0dXJufm4mJm8uc3BsaWNlKG4sMSksdGhpc31hZGRTd2F0Y2godCl7Y29uc3R7dmFsdWVzOmV9PXRoaXMuX3BhcnNlTG9jYWxDb2xvcih0KTtpZihlKXtjb25zdHtfc3dhdGNoQ29sb3JzOnQsX3Jvb3Q6b309dGhpcyxuPUEoLi4uZSkscz1yKGA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBzdHlsZT1cIi0tcGNyLWNvbG9yOiAke24udG9SR0JBKCkudG9TdHJpbmcoMCl9XCIgYXJpYS1sYWJlbD1cIiR7dGhpcy5fdChcImJ0bjpzd2F0Y2hcIil9XCIvPmApO3JldHVybiBvLnN3YXRjaGVzLmFwcGVuZENoaWxkKHMpLHQucHVzaCh7ZWw6cyxjb2xvcjpufSksdGhpcy5fZXZlbnRCaW5kaW5ncy5wdXNoKGkocyxcImNsaWNrXCIsKCgpPT57dGhpcy5zZXRIU1ZBKC4uLm4udG9IU1ZBKCksITApLHRoaXMuX2VtaXQoXCJzd2F0Y2hzZWxlY3RcIixuKSx0aGlzLl9lbWl0KFwiY2hhbmdlXCIsbixcInN3YXRjaFwiLHRoaXMpfSkpKSwhMH1yZXR1cm4hMX1yZW1vdmVTd2F0Y2godCl7Y29uc3QgZT10aGlzLl9zd2F0Y2hDb2xvcnNbdF07aWYoZSl7Y29uc3R7ZWw6b309ZTtyZXR1cm4gdGhpcy5fcm9vdC5zd2F0Y2hlcy5yZW1vdmVDaGlsZChvKSx0aGlzLl9zd2F0Y2hDb2xvcnMuc3BsaWNlKHQsMSksITB9cmV0dXJuITF9YXBwbHlDb2xvcih0PSExKXtjb25zdHtwcmV2aWV3OmUsYnV0dG9uOm99PXRoaXMuX3Jvb3Qsbj10aGlzLl9jb2xvci50b1JHQkEoKS50b1N0cmluZygwKTtyZXR1cm4gZS5sYXN0Q29sb3Iuc3R5bGUuc2V0UHJvcGVydHkoXCItLXBjci1jb2xvclwiLG4pLHRoaXMub3B0aW9ucy51c2VBc0J1dHRvbnx8by5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tcGNyLWNvbG9yXCIsbiksby5jbGFzc0xpc3QucmVtb3ZlKFwiY2xlYXJcIiksdGhpcy5fbGFzdENvbG9yPXRoaXMuX2NvbG9yLmNsb25lKCksdGhpcy5faW5pdGlhbGl6aW5nQWN0aXZlfHx0fHx0aGlzLl9lbWl0KFwic2F2ZVwiLHRoaXMuX2NvbG9yKSx0aGlzfWRlc3Ryb3koKXtjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl9zZXR1cEFuaW1hdGlvbkZyYW1lKSx0aGlzLl9ldmVudEJpbmRpbmdzLmZvckVhY2goKHQ9PnMoLi4udCkpKSxPYmplY3Qua2V5cyh0aGlzLl9jb21wb25lbnRzKS5mb3JFYWNoKCh0PT50aGlzLl9jb21wb25lbnRzW3RdLmRlc3Ryb3koKSkpfWRlc3Ryb3lBbmRSZW1vdmUoKXt0aGlzLmRlc3Ryb3koKTtjb25zdHtyb290OnQsYXBwOmV9PXRoaXMuX3Jvb3Q7dC5wYXJlbnRFbGVtZW50JiZ0LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodCksZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGUpLE9iamVjdC5rZXlzKHRoaXMpLmZvckVhY2goKHQ9PnRoaXNbdF09bnVsbCkpfWhpZGUoKXtyZXR1cm4hIXRoaXMuaXNPcGVuKCkmJih0aGlzLl9yb290LmFwcC5jbGFzc0xpc3QucmVtb3ZlKFwidmlzaWJsZVwiKSx0aGlzLl9lbWl0KFwiaGlkZVwiKSwhMCl9c2hvdygpe3JldHVybiF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJiF0aGlzLmlzT3BlbigpJiYodGhpcy5fcm9vdC5hcHAuY2xhc3NMaXN0LmFkZChcInZpc2libGVcIiksdGhpcy5fcmVQb3NpdGlvbmluZ1BpY2tlcigpLHRoaXMuX2VtaXQoXCJzaG93XCIsdGhpcy5fY29sb3IpLHRoaXMpfWlzT3Blbigpe3JldHVybiB0aGlzLl9yb290LmFwcC5jbGFzc0xpc3QuY29udGFpbnMoXCJ2aXNpYmxlXCIpfXNldEhTVkEodD0zNjAsZT0wLG89MCxuPTEsaT0hMSl7Y29uc3Qgcz10aGlzLl9yZWNhbGM7aWYodGhpcy5fcmVjYWxjPSExLHQ8MHx8dD4zNjB8fGU8MHx8ZT4xMDB8fG88MHx8bz4xMDB8fG48MHx8bj4xKXJldHVybiExO3RoaXMuX2NvbG9yPUEodCxlLG8sbik7Y29uc3R7aHVlOnIsb3BhY2l0eTphLHBhbGV0dGU6bH09dGhpcy5fY29tcG9uZW50cztyZXR1cm4gci51cGRhdGUodC8zNjApLGEudXBkYXRlKG4pLGwudXBkYXRlKGUvMTAwLDEtby8xMDApLGl8fHRoaXMuYXBwbHlDb2xvcigpLHMmJnRoaXMuX3VwZGF0ZU91dHB1dCgpLHRoaXMuX3JlY2FsYz1zLCEwfXNldENvbG9yKHQsZT0hMSl7aWYobnVsbD09PXQpcmV0dXJuIHRoaXMuX2NsZWFyQ29sb3IoZSksITA7Y29uc3R7dmFsdWVzOm8sdHlwZTpufT10aGlzLl9wYXJzZUxvY2FsQ29sb3IodCk7aWYobyl7Y29uc3QgdD1uLnRvVXBwZXJDYXNlKCkse29wdGlvbnM6aX09dGhpcy5fcm9vdC5pbnRlcmFjdGlvbixzPWkuZmluZCgoZT0+ZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGVcIik9PT10KSk7aWYocyYmIXMuaGlkZGVuKWZvcihjb25zdCB0IG9mIGkpdC5jbGFzc0xpc3RbdD09PXM/XCJhZGRcIjpcInJlbW92ZVwiXShcImFjdGl2ZVwiKTtyZXR1cm4hIXRoaXMuc2V0SFNWQSguLi5vLGUpJiZ0aGlzLnNldENvbG9yUmVwcmVzZW50YXRpb24odCl9cmV0dXJuITF9c2V0Q29sb3JSZXByZXNlbnRhdGlvbih0KXtyZXR1cm4gdD10LnRvVXBwZXJDYXNlKCksISF0aGlzLl9yb290LmludGVyYWN0aW9uLm9wdGlvbnMuZmluZCgoZT0+ZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGVcIikuc3RhcnRzV2l0aCh0KSYmIWUuY2xpY2soKSkpfWdldENvbG9yUmVwcmVzZW50YXRpb24oKXtyZXR1cm4gdGhpcy5fcmVwcmVzZW50YXRpb259Z2V0Q29sb3IoKXtyZXR1cm4gdGhpcy5fY29sb3J9Z2V0U2VsZWN0ZWRDb2xvcigpe3JldHVybiB0aGlzLl9sYXN0Q29sb3J9Z2V0Um9vdCgpe3JldHVybiB0aGlzLl9yb290fWRpc2FibGUoKXtyZXR1cm4gdGhpcy5oaWRlKCksdGhpcy5vcHRpb25zLmRpc2FibGVkPSEwLHRoaXMuX3Jvb3QuYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJkaXNhYmxlZFwiKSx0aGlzfWVuYWJsZSgpe3JldHVybiB0aGlzLm9wdGlvbnMuZGlzYWJsZWQ9ITEsdGhpcy5fcm9vdC5idXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImRpc2FibGVkXCIpLHRoaXN9fXJldHVybiBlPWUuZGVmYXVsdH0pKCkpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBpY2tyLm1pbi5qcy5tYXAiLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlYWRPbmx5OiBCb29sZWFuLFxuICAgIH1cblxuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIGRpdiB0byBhcHBseSB0aGUgZWRpdG9yIHRvXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLmlkID0gdGhpcy5lbGVtZW50LmlkICsgJ19kaXYnO1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc05hbWUgPSB0aGlzLmVsZW1lbnQuY2xhc3NOYW1lO1xuICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5jb250YWluZXIsIHRoaXMuZWxlbWVudC5uZXh0U2libGluZyk7XG5cbiAgICAgICAgLy8gSGlkZSB0aGUgdGV4dGFyZWFcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlWydkaXNwbGF5J10gPSAnbm9uZSc7XG5cbiAgICAgICAgLy8gSW5zdGFudGlhdGUgdGhlIGVkaXRvclxuICAgICAgICB0aGlzLmVkaXRvciA9IGFjZS5lZGl0KHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5lZGl0b3IuZ2V0U2Vzc2lvbigpLnNldFZhbHVlKHRoaXMuZWxlbWVudC52YWx1ZSk7XG5cbiAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2ZvY3VzJywgKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IHRoaXMuZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERpc2FibGUgY29tbWFuZCBjb25mbGljdHMgd2l0aCBBbHRHciAoc2VlICM1NzkyKVxuICAgICAgICB0aGlzLmVkaXRvci5jb21tYW5kcy5iaW5kS2V5KCdDdHJsLWFsdC1hfEN0cmwtYWx0LWV8Q3RybC1hbHQtaHxDdHJsLWFsdC1sfEN0cmwtYWx0LXMnLCBudWxsKTtcblxuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjb25maWcgY2FsbGJhY2tcbiAgICAgICAgdGhpcy5lbGVtZW50Py5jb25maWdDYWxsYmFjayh0aGlzLmVkaXRvcik7XG5cbiAgICAgICAgdGhpcy5zZXRNYXhMaW5lcygpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5zZXRNYXhMaW5lcy5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0aGlzLmVkaXRvci5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIHNldE1heExpbmVzKCkge1xuICAgICAgICB0aGlzLmVkaXRvci5zZXRPcHRpb24oJ21heExpbmVzJywgTWF0aC5mbG9vcigod2luZG93LmlubmVySGVpZ2h0IC0gMzIwKSAvIE1hdGguZmxvb3IoMTIgKiB0aGlzLmVkaXRvci5jb250YWluZXIuc3R5bGUubGluZUhlaWdodCkpKTtcbiAgICB9XG59XG4iLCJpbXBvcnQge0NvbnRyb2xsZXJ9IGZyb20gXCJAaG90d2lyZWQvc3RpbXVsdXNcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCYWNrZW5kU2VhcmNoQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gW1xuICAgICAgICBcImlucHV0XCIsXG4gICAgICAgIFwicmVzdWx0c1wiLFxuICAgIF07XG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICByb3V0ZTogU3RyaW5nLFxuICAgICAgICBtaW5DaGFyYWN0ZXJzOiB7XG4gICAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgICBkZWZhdWx0OiAzLFxuICAgICAgICB9LFxuICAgICAgICBkZWxheToge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgICAgICAgZGVmYXVsdDogMTUwLFxuICAgICAgICB9LFxuICAgIH1cblxuICAgIHN0YXRpYyBjbGFzc2VzID0gW1xuICAgICAgICBcImhpZGRlblwiLFxuICAgICAgICBcImluaXRpYWxcIixcbiAgICAgICAgXCJsb2FkaW5nXCIsXG4gICAgICAgIFwiaW52YWxpZFwiLFxuICAgICAgICBcInJlc3VsdHNcIixcbiAgICAgICAgXCJlcnJvclwiLFxuICAgIF1cblxuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGltZW91dCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZShcImhpZGRlblwiKTtcbiAgICB9XG5cbiAgICBwZXJmb3JtU2VhcmNoKCkge1xuICAgICAgICBpZiAodGhpcy5pbnB1dFRhcmdldC52YWx1ZS5sZW5ndGggPCB0aGlzLm1pbkNoYXJhY3RlcnNWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0U3RhdGUoXCJpbnZhbGlkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG5cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvYWRSZXN1bHRzKCk7XG4gICAgICAgIH0sIHRoaXMuZGVsYXlWYWx1ZSk7XG4gICAgfVxuXG4gICAgbG9hZFJlc3VsdHMoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoXCJsb2FkaW5nXCIpO1xuXG4gICAgICAgIGZldGNoKHRoaXMuc2VhcmNoUm91dGUpXG4gICAgICAgICAgICAudGhlbihyZXM9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnRleHQoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihodG1sID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHNUYXJnZXQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKFwicmVzdWx0c1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcImVycm9yXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLmFjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShcImluaXRpYWxcIik7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5pbnB1dFRhcmdldC5ibHVyKCk7XG4gICAgICAgIHRoaXMuaW5wdXRUYXJnZXQudmFsdWUgPSBcIlwiO1xuXG4gICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGltZW91dCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZShcImhpZGRlblwiKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudENsaWNrKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cblxuICAgIHNldFN0YXRlKHN0YXRlKSB7XG4gICAgICAgIEJhY2tlbmRTZWFyY2hDb250cm9sbGVyLmNsYXNzZXMuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC50b2dnbGUodGhpc1tgJHtjbGFzc05hbWV9Q2xhc3NgXSwgY2xhc3NOYW1lID09PSBzdGF0ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldCBzZWFyY2hSb3V0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm91dGVWYWx1ZSArIHRoaXMuaW5wdXRUYXJnZXQudmFsdWU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHtDb250cm9sbGVyfSBmcm9tIFwiQGhvdHdpcmVkL3N0aW11bHVzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2hvaWNlc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy5pbml0R3VhcmQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENob2ljZXMgd3JhcHMgdGhlIGVsZW1lbnQgbXVsdGlwbGUgdGltZXMgZHVyaW5nIGluaXRpYWxpemF0aW9uLCBsZWFkaW5nIHRvXG4gICAgICAgIC8vIG11bHRpcGxlIGRpc2Nvbm5lY3MvcmVjb25uZWN0cyBvZiB0aGUgY29udHJvbGxlciwgdGhhdCB3ZSBuZWVkIHRvIGlnbm9yZS5cbiAgICAgICAgdGhpcy5pbml0R3VhcmQgPSB0cnVlO1xuXG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IHRoaXMuZWxlbWVudDtcblxuICAgICAgICB0aGlzLmNob2ljZXMgPSBuZXcgQ2hvaWNlcyhzZWxlY3QsIHtcbiAgICAgICAgICAgIHNob3VsZFNvcnQ6IGZhbHNlLFxuICAgICAgICAgICAgZHVwbGljYXRlSXRlbXNBbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGFsbG93SFRNTDogZmFsc2UsXG4gICAgICAgICAgICByZW1vdmVJdGVtQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgc2VhcmNoRW5hYmxlZDogc2VsZWN0Lm9wdGlvbnMubGVuZ3RoID4gNyxcbiAgICAgICAgICAgIGNsYXNzTmFtZXM6IHtcbiAgICAgICAgICAgICAgICBjb250YWluZXJPdXRlcjogWydjaG9pY2VzJywgLi4uQXJyYXkuZnJvbShzZWxlY3QuY2xhc3NMaXN0KV0sXG4gICAgICAgICAgICAgICAgZmxpcHBlZFN0YXRlOiAnJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdXNlT3B0aW9uczoge1xuICAgICAgICAgICAgICAgIGluY2x1ZGVTY29yZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDAuNCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYWxsYmFja09uSW5pdDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNob2ljZXMgPSBzZWxlY3QuY2xvc2VzdCgnLmNob2ljZXMnKT8ucXVlcnlTZWxlY3RvcignLmNob2ljZXNfX2xpc3QtLWRyb3Bkb3duID4gLmNob2ljZXNfX2xpc3QnKTtcblxuICAgICAgICAgICAgICAgIGlmIChjaG9pY2VzICYmIHNlbGVjdC5kYXRhc2V0LnBsYWNlaG9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNob2ljZXMuZGF0YXNldC5wbGFjZWhvbGRlciA9IHNlbGVjdC5kYXRhc2V0LnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFJlc2V0IGd1YXJkIGFzIHNvb24gYXMgdGhlIGNhbGwgc3RhY2sgaGFzIGNsZWFyZWRcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0R3VhcmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsb2FkaW5nVGV4dDogQ29udGFvLmxhbmcubG9hZGluZyxcbiAgICAgICAgICAgIG5vUmVzdWx0c1RleHQ6IENvbnRhby5sYW5nLm5vUmVzdWx0cyxcbiAgICAgICAgICAgIG5vQ2hvaWNlc1RleHQ6IENvbnRhby5sYW5nLm5vT3B0aW9ucyxcbiAgICAgICAgICAgIHJlbW92ZUl0ZW1MYWJlbFRleHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDb250YW8ubGFuZy5yZW1vdmVJdGVtLmNvbmNhdCgnICcpLmNvbmNhdCh2YWx1ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIGlmICh0aGlzLmluaXRHdWFyZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jaG9pY2VzLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5jaG9pY2VzID0gbnVsbDtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBjb250ZW50OiBTdHJpbmdcbiAgICB9XG5cbiAgICB3cml0ZSAoKSB7XG4gICAgICAgIGlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkICYmIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KSB7XG4gICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0aGlzLmNvbnRlbnRWYWx1ZSkuY2F0Y2godGhpcy5jbGlwYm9hcmRGYWxsYmFjay5iaW5kKHRoaXMpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkRmFsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsaXBib2FyZEZhbGxiYWNrICAoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSB0aGlzLmNvbnRlbnRWYWx1ZTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgIGlucHV0LnNlbGVjdCgpO1xuICAgICAgICBpbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSgwLCA5OTk5OSk7XG4gICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdjb3B5Jyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaW5wdXQpO1xuICAgIH1cbn1cbiIsImltcG9ydCBDb2xvclBpY2tlciBmcm9tIFwiQHN0aW11bHVzLWNvbXBvbmVudHMvY29sb3ItcGlja2VyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29sb3JQaWNrZXIge1xuICAgIC8vIE92ZXJyaWRlIHRoZSBvblNhdmUgZnVuY3Rpb24gdG8gc3RyaXAgdGhlIGxlYWRpbmcgYCNgXG4gICAgb25TYXZlKGNvbG9yKSB7XG4gICAgICAgIHRoaXMuaW5wdXRUYXJnZXQudmFsdWUgPSBudWxsO1xuXG4gICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgbGV0IHZhbHVlID0gY29sb3IudG9IRVhBKCkudG9TdHJpbmcoKTtcblxuICAgICAgICAgICAgaWYgKCcjJyA9PT0gdmFsdWUuY2hhckF0KDApKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaW5wdXRUYXJnZXQudmFsdWUgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5waWNrZXIuaGlkZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5jb25zdCBwcmVmZXJzRGFyayA9ICgpID0+IHtcbiAgICBjb25zdCBwcmVmZXJzRGFyayA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjb250YW8tLXByZWZlcnMtZGFyaycpO1xuXG4gICAgaWYgKG51bGwgPT09IHByZWZlcnNEYXJrKSB7XG4gICAgICAgIHJldHVybiAhIXdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykubWF0Y2hlcztcbiAgICB9XG5cbiAgICByZXR1cm4gcHJlZmVyc0RhcmsgPT09ICd0cnVlJztcbn1cblxuY29uc3Qgc2V0Q29sb3JTY2hlbWUgPSAoKSA9PiB7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQuY29sb3JTY2hlbWUgPSBwcmVmZXJzRGFyaygpID8gJ2RhcmsnIDogJ2xpZ2h0Jztcbn07XG5cbndpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2V0Q29sb3JTY2hlbWUpO1xuc2V0Q29sb3JTY2hlbWUoKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnbGFiZWwnXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIGkxOG46IHtcbiAgICAgICAgICAgIHR5cGU6IE9iamVjdCxcbiAgICAgICAgICAgIGRlZmF1bHQ6IHsgbGlnaHQ6ICdEaXNhYmxlIGRhcmsgbW9kZScsIGRhcms6ICdFbmFibGUgZGFyayBtb2RlJyB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgaW5pdGlhbGl6ZSAoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlID0gdGhpcy50b2dnbGUuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRMYWJlbCA9IHRoaXMuc2V0TGFiZWwuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb25uZWN0ICgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGUpO1xuXG4gICAgICAgIHRoaXMubWF0Y2hNZWRpYSA9IHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJyk7XG4gICAgICAgIHRoaXMubWF0Y2hNZWRpYS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLnNldExhYmVsKTtcbiAgICAgICAgdGhpcy5zZXRMYWJlbCgpO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QgKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnRvZ2dsZSk7XG4gICAgICAgIHRoaXMubWF0Y2hNZWRpYS5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLnNldExhYmVsKTtcbiAgICB9XG5cbiAgICB0b2dnbGUgKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IGlzRGFyayA9ICFwcmVmZXJzRGFyaygpO1xuXG4gICAgICAgIGlmIChpc0RhcmsgPT09IHRoaXMubWF0Y2hNZWRpYS5tYXRjaGVzKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnY29udGFvLS1wcmVmZXJzLWRhcmsnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjb250YW8tLXByZWZlcnMtZGFyaycsIFN0cmluZyhpc0RhcmspKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldENvbG9yU2NoZW1lKCk7XG5cbiAgICAgICAgdGhpcy5kaXNwYXRjaCgnY2hhbmdlJywge1xuICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgbW9kZTogaXNEYXJrID8gJ2RhcmsnIDogJ2xpZ2h0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2hhbmdlIHRoZSBsYWJlbCBhZnRlciB0aGUgZHJvcGRvd24gaXMgaGlkZGVuXG4gICAgICAgIHNldFRpbWVvdXQodGhpcy5zZXRMYWJlbCwgMzAwKTtcbiAgICB9XG5cbiAgICBzZXRMYWJlbCAoKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNMYWJlbFRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLmkxOG5WYWx1ZVtwcmVmZXJzRGFyaygpID8gJ2xpZ2h0JyA6ICdkYXJrJ107XG5cbiAgICAgICAgdGhpcy5sYWJlbFRhcmdldC50aXRsZSA9IGxhYmVsO1xuICAgICAgICB0aGlzLmxhYmVsVGFyZ2V0LmlubmVyVGV4dCA9IGxhYmVsO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuaW1wb3J0ICogYXMgVHVyYm8gZnJvbSAnQGhvdHdpcmVkL3R1cmJvJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsncHJpbWFyeScsICdzZWNvbmRhcnknXTtcblxuICAgIHN0YXRpYyBhZnRlckxvYWQgKGlkZW50aWZpZXIpIHtcbiAgICAgICAgY29uc3Qgc2V0dXBDb250cm9sbGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNsaWNrMmVkaXQnKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2NsaWNrMmVkaXQnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHByaW1hcnkgPSBlbC5xdWVyeVNlbGVjdG9yKCdhLmVkaXQnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWNvbmRhcnkgPSBlbC5xdWVyeVNlbGVjdG9yKCdhLmNoaWxkcmVuJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJpbWFyeSkge1xuICAgICAgICAgICAgICAgICAgICBwcmltYXJ5LnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LXRhcmdldGAsIFwicHJpbWFyeVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc2Vjb25kYXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlY29uZGFyeS5zZXRBdHRyaWJ1dGUoYGRhdGEtJHtpZGVudGlmaWVyfS10YXJnZXRgLCBcInNlY29uZGFyeVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBlbC5kYXRhc2V0LmNvbnRyb2xsZXIgPSBgJHtlbC5kYXRhc2V0LmNvbnRyb2xsZXIgfHwgJyd9ICR7aWRlbnRpZmllcn1gO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHNldHVwQ29udHJvbGxlcik7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2FqYXhfY2hhbmdlJywgc2V0dXBDb250cm9sbGVyKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHVyYm86cmVuZGVyJywgc2V0dXBDb250cm9sbGVyKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHVyYm86ZnJhbWUtcmVuZGVyJywgc2V0dXBDb250cm9sbGVyKTtcbiAgICAgICAgc2V0dXBDb250cm9sbGVyKCk7XG5cbiAgICAgICAgVGhlbWUuc2V0dXBDdHJsQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1VzaW5nIFRoZW1lLnNldHVwQ3RybENsaWNrKCkgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIENvbnRhbyA2LiBBcHBseSB0aGUgU3RpbXVsdXMgYWN0aW9ucyBpbnN0ZWFkLicpO1xuICAgICAgICAgICAgc2V0dXBDb250cm9sbGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbml0aWFsaXplICgpIHtcbiAgICAgICAgdGhpcy5oYW5kbGUgPSB0aGlzLmhhbmRsZS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZSk7XG4gICAgfVxuXG4gICAgZGlzY29ubmVjdCAoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlKTtcbiAgICB9XG5cbiAgICBoYW5kbGUgKGV2ZW50KSB7XG4gICAgICAgIC8vIElnbm9yZSBjbGlja3Mgb24gYW5jaG9yIGVsZW1lbnRzXG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHByaW1hcnlLZXkgPSB3aW5kb3cubmF2aWdhdG9yLnBsYXRmb3JtPy5zdGFydHNXaXRoKCdNYWMnKSA/ICdtZXRhS2V5JyA6ICdjdHJsS2V5JztcblxuICAgICAgICBpZiAoZXZlbnRbcHJpbWFyeUtleV0gJiYgIWV2ZW50LnNoaWZ0S2V5ICYmIHRoaXMuaGFzUHJpbWFyeVRhcmdldCAmJiB0aGlzLnByaW1hcnlUYXJnZXQuaHJlZikge1xuICAgICAgICAgICAgVHVyYm8udmlzaXQodGhpcy5wcmltYXJ5VGFyZ2V0LmhyZWYpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV2ZW50W3ByaW1hcnlLZXldICYmIGV2ZW50LnNoaWZ0S2V5ICYmIHRoaXMuaGFzU2Vjb25kYXJ5VGFyZ2V0ICYmIHRoaXMuc2Vjb25kYXJ5VGFyZ2V0LmhyZWYpIHtcbiAgICAgICAgICAgIFR1cmJvLnZpc2l0KHRoaXMuc2Vjb25kYXJ5VGFyZ2V0LmhyZWYpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAnbW91c2UnIHx8ICF0aGlzLmhhc1ByaW1hcnlUYXJnZXQgfHwgIXRoaXMucHJpbWFyeVRhcmdldC5ocmVmKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy4kdGltZXIpO1xuXG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS12aXNpdGVkJykpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmlzaXRlZCcsICcxJyk7XG5cbiAgICAgICAgICAgIHRoaXMuJHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS12aXNpdGVkJyk7XG4gICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtdmlzaXRlZCcpO1xuICAgICAgICAgICAgVHVyYm8udmlzaXQodGhpcy5wcmltYXJ5VGFyZ2V0LmhyZWYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmlzaXRQcmltYXJ5IChldmVudCkge1xuICAgICAgICBpZiAodGhpcy5oYXNQcmltYXJ5VGFyZ2V0ICYmIHRoaXMucHJpbWFyeVRhcmdldC5ocmVmICYmIHRoaXMuaXNWYWxpZChldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgICBUdXJiby52aXNpdCh0aGlzLnByaW1hcnlUYXJnZXQuaHJlZik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2aXNpdFNlY29uZGFyeSAoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzU2Vjb25kYXJ5VGFyZ2V0ICYmIHRoaXMuc2Vjb25kYXJ5VGFyZ2V0LmhyZWYgJiYgdGhpcy5pc1ZhbGlkKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIFR1cmJvLnZpc2l0KHRoaXMuc2Vjb25kYXJ5VGFyZ2V0LmhyZWYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaXNWYWxpZCAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gJ2EnICE9PSBlbGVtZW50LnRhZ05hbWUgJiYgIWVsZW1lbnQuY2xvc2VzdCgnYSwgYnV0dG9uJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgY29uZmlnOiBPYmplY3QsXG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZSAoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlV2l6YXJkID0gdGhpcy51cGRhdGVXaXphcmQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5vcGVuTW9kYWwgPSB0aGlzLm9wZW5Nb2RhbC5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdzZWxlY3QnKTtcbiAgICAgICAgdGhpcy5idXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgdGhpcy5idXR0b24udHlwZSA9ICdidXR0b24nO1xuICAgICAgICB0aGlzLmJ1dHRvbi50aXRsZSA9ICcnO1xuICAgICAgICB0aGlzLmJ1dHRvbkltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICAgIHRoaXMuYnV0dG9uLmFwcGVuZCh0aGlzLmJ1dHRvbkltYWdlKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnd2l6YXJkJyk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hZnRlcih0aGlzLmJ1dHRvbik7XG5cbiAgICAgICAgdGhpcy5zZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy51cGRhdGVXaXphcmQpO1xuICAgICAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3Blbk1vZGFsKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVdpemFyZCgpO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QgKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCd3aXphcmQnKTtcbiAgICAgICAgdGhpcy5zZWxlY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy51cGRhdGVXaXphcmQpO1xuICAgICAgICB0aGlzLmJ1dHRvbkltYWdlLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmJ1dHRvbi5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICB1cGRhdGVXaXphcmQgKCkge1xuICAgICAgICBpZiAodGhpcy5jYW5FZGl0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uLnRpdGxlID0gdGhpcy5jb25maWdWYWx1ZS50aXRsZTtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvbkltYWdlLnNyYyA9IHRoaXMuY29uZmlnVmFsdWUuaWNvbjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uLnRpdGxlID0gJyc7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvbkltYWdlLnNyYyA9IHRoaXMuY29uZmlnVmFsdWUuaWNvbkRpc2FibGVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb3Blbk1vZGFsICgpIHtcbiAgICAgICAgQmFja2VuZC5vcGVuTW9kYWxJZnJhbWUoe1xuICAgICAgICAgICAgdGl0bGU6IHRoaXMuY29uZmlnVmFsdWUudGl0bGUsXG4gICAgICAgICAgICB1cmw6IGAkeyB0aGlzLmNvbmZpZ1ZhbHVlLmhyZWYgfSZpZD0keyB0aGlzLnNlbGVjdC52YWx1ZSB9YFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjYW5FZGl0ICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnVmFsdWUuaWRzLmluY2x1ZGVzKE51bWJlcih0aGlzLnNlbGVjdC52YWx1ZSkpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWyduYXZpZ2F0aW9uJywgJ3NlY3Rpb24nXTtcblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICB0aGlzLnJlYnVpbGROYXZpZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBzZWN0aW9uVGFyZ2V0Q29ubmVjdGVkICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZWJ1aWxkTmF2aWdhdGlvbigpO1xuICAgIH1cblxuICAgIHJlYnVpbGROYXZpZ2F0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc05hdmlnYXRpb25UYXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxpbmtzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcblxuICAgICAgICB0aGlzLnNlY3Rpb25UYXJnZXRzLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgICAgIGFjdGlvbi5pbm5lclRleHQgPSBlbC5nZXRBdHRyaWJ1dGUoYGRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LWxhYmVsLXZhbHVlYCk7XG5cbiAgICAgICAgICAgIGFjdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCgnc2Nyb2xsdG8nLCB7IHRhcmdldDogZWwgfSk7XG4gICAgICAgICAgICAgICAgZWwuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgICBsaS5hcHBlbmQoYWN0aW9uKTtcblxuICAgICAgICAgICAgbGlua3MuYXBwZW5kKGxpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uVGFyZ2V0LnJlcGxhY2VDaGlsZHJlbihsaW5rcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgbWF4OiBOdW1iZXIsXG4gICAgICAgIGV4cGFuZDogU3RyaW5nLFxuICAgICAgICBjb2xsYXBzZTogU3RyaW5nLFxuICAgICAgICBleHBhbmRBbGw6IFN0cmluZyxcbiAgICAgICAgZXhwYW5kQWxsVGl0bGU6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2VBbGw6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2VBbGxUaXRsZTogU3RyaW5nLFxuICAgIH1cblxuICAgIHN0YXRpYyB0YXJnZXRzID0gWydvcGVyYXRpb24nLCAnbm9kZSddO1xuXG4gICAgaW5pdGlhbGl6ZSAoKSB7XG4gICAgICAgIHN1cGVyLmluaXRpYWxpemUoKTtcbiAgICAgICAgdGhpcy50b2dnbGVyTWFwID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgICAgdGhpcy5uZXh0SWQgPSAxO1xuICAgIH1cblxuICAgIG9wZXJhdGlvblRhcmdldENvbm5lY3RlZCAoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKCk7XG4gICAgfVxuXG4gICAgbm9kZVRhcmdldENvbm5lY3RlZCAobm9kZSkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG5vZGUsIG51bGwpO1xuICAgICAgICBjb25zdCBwYWRkaW5nID0gcGFyc2VGbG9hdChzdHlsZS5wYWRkaW5nVG9wKSArIHBhcnNlRmxvYXQoc3R5bGUucGFkZGluZ0JvdHRvbSk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IG5vZGUuY2xpZW50SGVpZ2h0IC0gcGFkZGluZztcblxuICAgICAgICAvLyBSZXNpemUgdGhlIGVsZW1lbnQgaWYgaXQgaXMgaGlnaGVyIHRoYW4gdGhlIG1heGltdW0gaGVpZ2h0XG4gICAgICAgIGlmICh0aGlzLm1heFZhbHVlID4gaGVpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIW5vZGUuaWQpIHtcbiAgICAgICAgICAgIG5vZGUuaWQgPSBgbGltaXQtaGVpZ2h0LSR7dGhpcy5uZXh0SWQrK31gO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgICBub2RlLnN0eWxlLm1heEhlaWdodCA9IGAke3RoaXMubWF4VmFsdWV9cHhgO1xuXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICBidXR0b24udGl0bGUgPSB0aGlzLmV4cGFuZFZhbHVlO1xuICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gJzxzcGFuPi4uLjwvc3Bhbj4nO1xuICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgndW5zZWxlY3RhYmxlJyk7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIG5vZGUuaWQpO1xuXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlKG5vZGUpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oZXZlbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0b2dnbGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRvZ2dsZXIuY2xhc3NMaXN0LmFkZCgnbGltaXRfdG9nZ2xlcicpO1xuICAgICAgICB0b2dnbGVyLmFwcGVuZChidXR0b24pO1xuXG4gICAgICAgIHRoaXMudG9nZ2xlck1hcC5zZXQobm9kZSwgdG9nZ2xlcik7XG5cbiAgICAgICAgbm9kZS5hcHBlbmQodG9nZ2xlcik7XG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKCk7XG4gICAgfVxuXG4gICAgbm9kZVRhcmdldERpc2Nvbm5lY3RlZCAobm9kZSkge1xuICAgICAgICBpZiAoIXRoaXMudG9nZ2xlck1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudG9nZ2xlck1hcC5nZXQobm9kZSkucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMudG9nZ2xlck1hcC5kZWxldGUobm9kZSk7XG4gICAgICAgIG5vZGUuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgICAgbm9kZS5zdHlsZS5tYXhIZWlnaHQgPSAnJztcbiAgICB9XG5cbiAgICB0b2dnbGUgKG5vZGUpIHtcbiAgICAgICAgaWYgKG5vZGUuc3R5bGUubWF4SGVpZ2h0ID09PSAnJykge1xuICAgICAgICAgICAgdGhpcy5jb2xsYXBzZShub2RlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZXhwYW5kKG5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZXhwYW5kIChub2RlKSB7XG4gICAgICAgIGlmICghdGhpcy50b2dnbGVyTWFwLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZS5zdHlsZS5tYXhIZWlnaHQgPSAnJztcbiAgICAgICAgY29uc3QgYnV0dG9uID0gdGhpcy50b2dnbGVyTWFwLmdldChub2RlKS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLnRpdGxlID0gdGhpcy5jb2xsYXBzZVZhbHVlO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICB9XG5cbiAgICBjb2xsYXBzZSAobm9kZSkge1xuICAgICAgICBpZiAoIXRoaXMudG9nZ2xlck1hcC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGUuc3R5bGUubWF4SGVpZ2h0ID0gYCR7dGhpcy5tYXhWYWx1ZX1weGA7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMudG9nZ2xlck1hcC5nZXQobm9kZSkucXVlcnlTZWxlY3RvcignYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi50aXRsZSA9IHRoaXMuZXhwYW5kVmFsdWU7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICB9XG5cbiAgICB0b2dnbGVBbGwgKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSB0aGlzLmhhc0V4cGFuZGVkKCkgXiBldmVudC5hbHRLZXk7XG5cbiAgICAgICAgdGhpcy5ub2RlVGFyZ2V0cy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgICBpZiAoaXNFeHBhbmRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sbGFwc2Uobm9kZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZXhwYW5kKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbihldmVudCk7XG4gICAgfVxuXG4gICAga2V5cHJlc3MgKGV2ZW50KSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3BlcmF0aW9uKGV2ZW50KTtcbiAgICB9XG5cbiAgICB1cGRhdGVPcGVyYXRpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNPcGVyYXRpb25UYXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGhhc1RvZ2dsZXJzID0gISF0aGlzLm5vZGVUYXJnZXRzLmZpbmQoKGVsKSA9PiB0aGlzLnRvZ2dsZXJNYXAuaGFzKGVsKSk7XG4gICAgICAgIGNvbnN0IGV4cGFuZGVkID0gdGhpcy5oYXNFeHBhbmRlZCgpO1xuXG4gICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSBoYXNUb2dnbGVycyA/ICcnIDogJ25vbmUnO1xuICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCB0aGlzLm5vZGVUYXJnZXRzLm1hcCgoZWwpID0+IGVsLmlkKS5qb2luKCcgJykpO1xuICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBleHBhbmRlZCA/ICd0cnVlJyA6ICdmYWxzZScpO1xuXG4gICAgICAgIGlmIChleHBhbmRlZCBeIChldmVudCA/IGV2ZW50LmFsdEtleSA6IGZhbHNlKSkge1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuaW5uZXJUZXh0ID0gdGhpcy5jb2xsYXBzZUFsbFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQudGl0bGUgPSB0aGlzLmNvbGxhcHNlQWxsVGl0bGVWYWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LmlubmVyVGV4dCA9IHRoaXMuZXhwYW5kQWxsVmFsdWU7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC50aXRsZSA9IHRoaXMuZXhwYW5kQWxsVGl0bGVWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGhhc0V4cGFuZGVkICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5ub2RlVGFyZ2V0cy5maW5kKChlbCkgPT4gdGhpcy50b2dnbGVyTWFwLmhhcyhlbCkgJiYgZWwuc3R5bGUubWF4SGVpZ2h0ID09PSAnJyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ2lucHV0J107XG5cbiAgICBkZWxldGUgKCkge1xuICAgICAgICB0aGlzLmlucHV0VGFyZ2V0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgfSlcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJztcbmltcG9ydCBBY2Nlc3NpYmxlTWVudSBmcm9tICdhY2Nlc3NpYmxlLW1lbnUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydtZW51JywgJ2NvbnRyb2xsZXInXTtcblxuICAgIGluaXRpYWxpemUgKCkge1xuICAgICAgICB0aGlzLmNsb3NlID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbm5lY3QgKCkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzTWVudVRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCB0aGlzLmNsb3NlKTtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyVGFyZ2V0Py5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsICgpID0+IHsgdGhpcy5zZXRGaXhlZFBvc2l0aW9uKCkgfSk7XG5cbiAgICAgICAgdGhpcy4kbWVudSA9IG5ldyBBY2Nlc3NpYmxlTWVudS5EaXNjbG9zdXJlTWVudSh7XG4gICAgICAgICAgICBtZW51RWxlbWVudDogdGhpcy5tZW51VGFyZ2V0LFxuICAgICAgICAgICAgY29udGFpbmVyRWxlbWVudDogdGhpcy5lbGVtZW50LFxuICAgICAgICAgICAgY29udHJvbGxlckVsZW1lbnQ6IHRoaXMuY29udHJvbGxlclRhcmdldCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy4kbWVudS5kb20uY29udHJvbGxlci5hZGRFdmVudExpc3RlbmVyKCdhY2Nlc3NpYmxlTWVudUV4cGFuZCcsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdob3ZlcicpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLiRtZW51LmRvbS5jb250cm9sbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2FjY2Vzc2libGVNZW51Q29sbGFwc2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaG92ZXInKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZGlzY29ubmVjdCAoKSB7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgdGhpcy5jbG9zZSk7XG4gICAgfVxuXG4gICAgb3BlbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc01lbnVUYXJnZXQgfHwgdGhpcy5pc0ludGVyYWN0aXZlKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIHRoaXMuJG1lbnUuZWxlbWVudHMuY29udHJvbGxlci5wcmV2aWV3KCk7XG4gICAgICAgIHRoaXMuc2V0Rml4ZWRQb3NpdGlvbihldmVudCk7XG4gICAgfVxuXG4gICAgY2xvc2UgKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLiRtZW51ICYmICF0aGlzLm1lbnVUYXJnZXQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSAmJiAhdGhpcy5jb250cm9sbGVyVGFyZ2V0Py5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgICB0aGlzLiRtZW51LmVsZW1lbnRzLmNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldEZpeGVkUG9zaXRpb24gKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLm1lbnVUYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGxldCB4LCB5LCBvZmZzZXQgPSAwO1xuXG4gICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgeCA9IGV2ZW50LmNsaWVudFg7XG4gICAgICAgICAgICB5ID0gZXZlbnQuY2xpZW50WTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNvbnRyb2xsZXJUYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICB4ID0gci54O1xuICAgICAgICAgICAgeSA9IHIueTtcbiAgICAgICAgICAgIG9mZnNldCA9IDIwO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5tZW51VGFyZ2V0LnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgICAgdGhpcy5tZW51VGFyZ2V0LnN0eWxlLnJpZ2h0ID0gJ2F1dG8nO1xuXG4gICAgICAgIGlmICh3aW5kb3cuaW5uZXJIZWlnaHQgPCB5ICsgcmVjdC5oZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMubWVudVRhcmdldC5zdHlsZS50b3AgPSBgJHt5IC0gcmVjdC5oZWlnaHR9cHhgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tZW51VGFyZ2V0LnN0eWxlLnRvcCA9IGAke3kgKyBvZmZzZXR9cHhgO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIDwgeCArIHJlY3Qud2lkdGgpIHtcbiAgICAgICAgICAgIHRoaXMubWVudVRhcmdldC5zdHlsZS5sZWZ0ID0gYCR7eCAtIHJlY3Qud2lkdGggKyBvZmZzZXR9cHhgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tZW51VGFyZ2V0LnN0eWxlLmxlZnQgPSBgJHt4ICsgb2Zmc2V0fXB4YDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlzSW50ZXJhY3RpdmUgKGVsKSB7XG4gICAgICAgIGxldCBub2RlID0gZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBpZiAoJ2EnID09PSBub2RlIHx8ICdidXR0b24nID09PSBub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFsc28gY2hlY2sgdGhlIHBhcmVudCBlbGVtZW50IGlmIGVsIGlzIG5vdCBpbnRlcmFjdGl2ZVxuICAgICAgICBub2RlID0gZWwucGFyZW50RWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIHJldHVybiAnYScgPT09IG5vZGUgfHwgJ2J1dHRvbicgPT09IG5vZGU7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ2Zvcm0nLCAnbmFtZUlucHV0J107XG5cbiAgICBuYW1lSW5wdXRUYXJnZXRDb25uZWN0ZWQoZWwpIHtcbiAgICAgICAgZWwuZm9jdXMoKTtcbiAgICAgICAgZWwuc2VsZWN0KCk7XG4gICAgfVxuXG4gICAgY2FuY2VsRWRpdChlKSB7XG4gICAgICAgIHRoaXMubmFtZUlucHV0VGFyZ2V0LnZhbHVlID0gdGhpcy5uYW1lSW5wdXRUYXJnZXQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpO1xuICAgICAgICB0aGlzLmZvcm1UYXJnZXQucmVxdWVzdFN1Ym1pdCgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydidXR0b24nLCAnbWVudSddO1xuXG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgbmFtZTogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICd0bWVudV9fcHJvZmlsZScgfVxuICAgIH1cblxuICAgIGJ1dHRvblRhcmdldENvbm5lY3RlZChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRoaXMubmFtZVZhbHVlKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIH1cblxuICAgIG1lbnVUYXJnZXRDb25uZWN0ZWQobWVudSkge1xuICAgICAgICBtZW51LnNldEF0dHJpYnV0ZSgnaWQnLCB0aGlzLm5hbWVWYWx1ZSk7XG4gICAgfVxuXG4gICAgdG9nZ2xlKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIHRoaXMubWVudVRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcblxuICAgICAgICBpZiAodGhpcy5tZW51VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uVGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1dHRvblRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLm1lbnVUYXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuYnV0dG9uVGFyZ2V0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIH1cblxuICAgIGRvY3VtZW50Q2xpY2soZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuYnV0dG9uVGFyZ2V0LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB0YXJnZXRzID0gWydzY3JvbGxUbycsICdhdXRvRm9jdXMnLCAnd2lkZ2V0RXJyb3InXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIHNlc3Npb25LZXk6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICAgIGRlZmF1bHQ6ICdjb250YW9fYmFja2VuZF9vZmZzZXQnXG4gICAgICAgIH0sXG4gICAgICAgIGJlaGF2aW9yOiB7XG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0OiAnaW5zdGFudCdcbiAgICAgICAgfSxcbiAgICAgICAgYmxvY2s6IHtcbiAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICAgIGRlZmF1bHQ6ICdjZW50ZXInXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHk6IGF1dG9tYXRpY2FsbHkgcmVnaXN0ZXIgdGhlIFN0aW11bHVzIGNvbnRyb2xsZXIgaWYgdGhlIGxlZ2FjeSBtZXRob2RzIGFyZSB1c2VkXG4gICAgc3RhdGljIGFmdGVyTG9hZChpZGVudGlmaWVyLCBhcHBsaWNhdGlvbikge1xuICAgICAgICBjb25zdCBsb2FkRmFsbGJhY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBhcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBpZGVudGlmaWVyKTtcblxuICAgICAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCB7IGNvbnRyb2xsZXJBdHRyaWJ1dGUgfSA9IGFwcGxpY2F0aW9uLnNjaGVtYTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKGNvbnRyb2xsZXJBdHRyaWJ1dGUsIGAke2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoY29udHJvbGxlckF0dHJpYnV0ZSkgfHwgJyd9ICR7IGlkZW50aWZpZXIgfWApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBhcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBpZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlciAmJiByZXNvbHZlKGNvbnRyb2xsZXIpIHx8IHJlamVjdChjb250cm9sbGVyKTtcbiAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2luZG93LkJhY2tlbmQgJiYgIXdpbmRvdy5CYWNrZW5kLmluaXRTY3JvbGxPZmZzZXQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5CYWNrZW5kLmluaXRTY3JvbGxPZmZzZXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdCYWNrZW5kLmluaXRTY3JvbGxPZmZzZXQoKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBTdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG4gICAgICAgICAgICAgICAgbG9hZEZhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAod2luZG93LkJhY2tlbmQgJiYgIXdpbmRvdy5CYWNrZW5kLmdldFNjcm9sbE9mZnNldCkge1xuICAgICAgICAgICAgd2luZG93LkJhY2tlbmQuZ2V0U2Nyb2xsT2Zmc2V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQmFja2VuZC5nZXRTY3JvbGxPZmZzZXQoKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBTdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG4gICAgICAgICAgICAgICAgbG9hZEZhbGxiYWNrKCkudGhlbigoY29udHJvbGxlcikgPT4gY29udHJvbGxlci5kaXNjYXJkKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZSAoKSB7XG4gICAgICAgIHRoaXMuc3RvcmUgPSB0aGlzLnN0b3JlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgY29ubmVjdCAoKSB7XG4gICAgICAgIGlmICghdGhpcy5vZmZzZXQpIHJldHVybjtcblxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oe1xuICAgICAgICAgICAgdG9wOiB0aGlzLm9mZnNldCxcbiAgICAgICAgICAgIGJlaGF2aW9yOiB0aGlzLmJlaGF2aW9yVmFsdWUsXG4gICAgICAgICAgICBibG9jazogdGhpcy5ibG9ja1ZhbHVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMub2Zmc2V0ID0gbnVsbDtcbiAgICB9XG5cbiAgICBzY3JvbGxUb1RhcmdldENvbm5lY3RlZCgpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb1RhcmdldC5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICBiZWhhdmlvcjogdGhpcy5iZWhhdmlvclZhbHVlLFxuICAgICAgICAgICAgYmxvY2s6IHRoaXMuYmxvY2tWYWx1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhdXRvRm9jdXNUYXJnZXRDb25uZWN0ZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLm9mZnNldCB8fCB0aGlzLmF1dG9Gb2N1cykgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGlucHV0ID0gdGhpcy5hdXRvRm9jdXNUYXJnZXQ7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgaW5wdXQuZGlzYWJsZWQgfHwgaW5wdXQucmVhZG9ubHlcbiAgICAgICAgICAgIHx8ICFpbnB1dC5vZmZzZXRXaWR0aCB8fCAhaW5wdXQub2Zmc2V0SGVpZ2h0XG4gICAgICAgICAgICB8fCBpbnB1dC5jbG9zZXN0KCcuY2h6bi1zZWFyY2gnKVxuICAgICAgICAgICAgfHwgaW5wdXQuYXV0b2NvbXBsZXRlICYmIGlucHV0LmF1dG9jb21wbGV0ZSAhPT0gJ29mZidcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmF1dG9Gb2N1cyA9IHRydWU7XG4gICAgICAgIGlucHV0LmZvY3VzKCk7XG4gICAgfVxuXG4gICAgd2lkZ2V0RXJyb3JUYXJnZXRDb25uZWN0ZWQoKSB7XG4gICAgICAgIHRoaXMud2lkZ2V0RXJyb3JUYXJnZXQuc2Nyb2xsSW50b1ZpZXcoe1xuICAgICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnLFxuICAgICAgICAgICAgYmxvY2s6ICdzdGFydCdcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc3RvcmUgKCkge1xuICAgICAgICB0aGlzLm9mZnNldCA9IHRoaXMuZWxlbWVudC5zY3JvbGxUb3A7XG4gICAgfVxuXG4gICAgZGlzY2FyZCAoKSB7XG4gICAgICAgIHRoaXMub2Zmc2V0ID0gbnVsbDtcbiAgICB9XG5cbiAgICBzY3JvbGxUb1dpZGdldEVycm9yKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNXaWRnZXRFcnJvclRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXRFcnJvclRhcmdldENvbm5lY3RlZCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG9mZnNldCAoKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0odGhpcy5zZXNzaW9uS2V5VmFsdWUpO1xuXG4gICAgICAgIHJldHVybiB2YWx1ZSA/IHBhcnNlSW50KHZhbHVlKSA6IG51bGw7XG4gICAgfVxuXG4gICAgc2V0IG9mZnNldCAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMuc2Vzc2lvbktleVZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHRoaXMuc2Vzc2lvbktleVZhbHVlLCBTdHJpbmcodmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYWJzQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIGNsb3NlTGFiZWw6IFN0cmluZyxcbiAgICB9XG5cbiAgICBzdGF0aWMgdGFyZ2V0cyA9IFsnbmF2aWdhdGlvbicsICdwYW5lbCddO1xuICAgIHN0YXRpYyBpbnN0YW5jZUNvdW50ID0gMDtcblxuICAgIGluc3RhbmNlSWQgPSB1bmRlZmluZWQ7XG4gICAgbGFzdFRhYklkID0gMDtcbiAgICBhY3RpdmVUYWIgPSBudWxsO1xuXG4gICAgaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgVGFic0NvbnRyb2xsZXIuaW5zdGFuY2VDb3VudCsrO1xuICAgICAgICB0aGlzLmluc3RhbmNlSWQgPSBUYWJzQ29udHJvbGxlci5pbnN0YW5jZUNvdW50O1xuICAgIH1cblxuICAgIHBhbmVsVGFyZ2V0Q29ubmVjdGVkKHBhbmVsKSB7XG4gICAgICAgIHRoaXMubGFzdFRhYklkKys7XG5cbiAgICAgICAgY29uc3QgY29udHJvbF9yZWZlcmVuY2UgPSBgdGFiLWNvbnRyb2xfJHt0aGlzLmluc3RhbmNlSWR9XyR7dGhpcy5sYXN0VGFiSWR9YDtcbiAgICAgICAgY29uc3QgcGFuZWxfcmVmZXJlbmNlID0gcGFuZWwuaWQgfHwgYHRhYi1wYW5lbF8ke3RoaXMuaW5zdGFuY2VJZH1fJHt0aGlzLmxhc3RUYWJJZH1gO1xuXG4gICAgICAgIC8vIENyZWF0ZSBuYXZpZ2F0aW9uIGVsZW1lbnRzXG4gICAgICAgIGNvbnN0IHNlbGVjdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICBzZWxlY3RCdXR0b24uaWQgPSBjb250cm9sX3JlZmVyZW5jZTtcbiAgICAgICAgc2VsZWN0QnV0dG9uLmNsYXNzTmFtZSA9ICdzZWxlY3QnO1xuICAgICAgICBzZWxlY3RCdXR0b24uaW5uZXJUZXh0ID0gcGFuZWwuZGF0YXNldC5sYWJlbDtcbiAgICAgICAgc2VsZWN0QnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICAgICAgc2VsZWN0QnV0dG9uLnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWInKTtcbiAgICAgICAgc2VsZWN0QnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHBhbmVsX3JlZmVyZW5jZSk7XG5cbiAgICAgICAgc2VsZWN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RUYWIocGFuZWwpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGNsb3NlQnV0dG9uLmNsYXNzTmFtZSA9ICdjbG9zZSc7XG4gICAgICAgIGNsb3NlQnV0dG9uLmlubmVyVGV4dCA9ICd4JztcbiAgICAgICAgY2xvc2VCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgICAgICBjbG9zZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCBwYW5lbF9yZWZlcmVuY2UpO1xuICAgICAgICBjbG9zZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCB0aGlzLmNsb3NlTGFiZWxWYWx1ZSk7XG5cbiAgICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHBhbmVsIGFuZCBsZXQgdGhlIGRpc2Nvbm5lY3QgaGFuZGxlciBkbyB0aGUgcmVzdFxuICAgICAgICAgICAgcGFuZWwucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgbGkuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3ByZXNlbnRhdGlvbicpO1xuICAgICAgICBsaS5hcHBlbmQoc2VsZWN0QnV0dG9uKTtcbiAgICAgICAgbGkuYXBwZW5kKGNsb3NlQnV0dG9uKTtcblxuICAgICAgICAvLyBFbmhhbmNlIHBhbmVsIGNvbnRhaW5lclxuICAgICAgICBwYW5lbC5pZCA9IHBhbmVsX3JlZmVyZW5jZTtcbiAgICAgICAgcGFuZWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYnBhbmVsJyk7XG4gICAgICAgIHBhbmVsLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5JywgY29udHJvbF9yZWZlcmVuY2UpO1xuXG4gICAgICAgIC8vIEFkZCBuYXZpZ2F0aW9uIGVsZW1lbnQgYW5kIGFjdGl2YXRlIHRoZSBuZXdseSBhZGRlZCB0YWJcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uVGFyZ2V0LmFwcGVuZChsaSk7XG4gICAgICAgIHRoaXMuc2VsZWN0VGFiKHBhbmVsKTtcbiAgICB9XG5cbiAgICBwYW5lbFRhcmdldERpc2Nvbm5lY3RlZChwYW5lbCkge1xuICAgICAgICAvLyBSZW1vdmUgY29udHJvbHNcbiAgICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYW5lbC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScpKS5wYXJlbnRFbGVtZW50O1xuICAgICAgICBsaS5yZW1vdmUoKTtcblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGZpcnN0IHRhYi9ubyB0YWIgaWYgdGhlIGN1cnJlbnQgdGFiIHdhcyBhY3RpdmUgYmVmb3JlIGNsb3NpbmcuXG4gICAgICAgIGlmIChwYW5lbCA9PT0gdGhpcy5hY3RpdmVUYWIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc1BhbmVsVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RUYWIodGhpcy5wYW5lbFRhcmdldCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlVGFiID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNlbGVjdFRhYihwYW5lbCkge1xuICAgICAgICB0aGlzLnBhbmVsVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNUYXJnZXQgPSBlbCA9PT0gcGFuZWw7XG5cbiAgICAgICAgICAgIGVsLnRvZ2dsZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsIGlzVGFyZ2V0KTtcbiAgICAgICAgICAgIGVsLnRvZ2dsZUF0dHJpYnV0ZSgnZGF0YS1hY3RpdmUnLCBpc1RhcmdldCk7XG4gICAgICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gaXNUYXJnZXQgPyAncmV2ZXJ0JyA6ICdub25lJztcblxuICAgICAgICAgICAgLy8gUmUtZW5hYmxlL2Rpc2FibGUgdGhlIGJ1dHRvbiBhY2Nlc3Mga2V5c1xuICAgICAgICAgICAgaWYgKGlzVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2RhdGEtZGlzYWJsZWQtYWNjZXNza2V5XScpLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYWNjZXNza2V5JywgYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS1kaXNhYmxlZC1hY2Nlc3NrZXknKSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZGlzYWJsZWQtYWNjZXNza2V5Jyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2FjY2Vzc2tleV0nKS5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGlzYWJsZWQtYWNjZXNza2V5JywgYnV0dG9uLmdldEF0dHJpYnV0ZSgnYWNjZXNza2V5JykpO1xuICAgICAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlQXR0cmlidXRlKCdhY2Nlc3NrZXknKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScpKTtcbiAgICAgICAgICAgIHNlbGVjdEJ1dHRvbj8udG9nZ2xlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgaXNUYXJnZXQpO1xuICAgICAgICAgICAgc2VsZWN0QnV0dG9uPy5wYXJlbnRFbGVtZW50LnRvZ2dsZUF0dHJpYnV0ZSgnZGF0YS1hY3RpdmUnLCBpc1RhcmdldCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWN0aXZlVGFiID0gcGFuZWw7XG4gICAgfVxuXG4gICAgZ2V0QWN0aXZlVGFiKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVUYWI7XG4gICAgfVxuXG4gICAgZ2V0VGFicygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFuZWxUYXJnZXRzLnJlZHVjZSgocmVzdWx0LCBwYW5lbCkgPT4ge1xuICAgICAgICAgICAgcmVzdWx0W3BhbmVsLmlkXSA9IHBhbmVsO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSwge30pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuaW1wb3J0IHsgVHdpZ0VkaXRvciB9IGZyb20gJy4uL21vZHVsZXMvdHdpZy1lZGl0b3InO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIGVkaXRvcnMgPSBuZXcgTWFwKCk7XG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICBmb2xsb3dVcmw6IFN0cmluZyxcbiAgICAgICAgYmxvY2tJbmZvVXJsOiBTdHJpbmcsXG4gICAgfTtcblxuICAgIHN0YXRpYyB0YXJnZXRzID0gWyd0aGVtZVNlbGVjdG9yJywgJ3RhYnMnLCAnZWRpdG9yJywgJ2VkaXRvckFubm90YXRpb25zJywgJ2RpYWxvZyddO1xuXG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgLy8gU3Vic2NyaWJlIHRvIGV2ZW50cyBkaXNwYXRjaGVkIGJ5IHRoZSBlZGl0b3JzXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0d2lnLWVkaXRvcjpsZW5zOmZvbGxvdycsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3Zpc2l0KHRoaXMuZm9sbG93VXJsVmFsdWUsIHtuYW1lOiBldmVudC5kZXRhaWwubmFtZX0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHdpZy1lZGl0b3I6bGVuczpibG9jay1pbmZvJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgdGhpcy5fdmlzaXQodGhpcy5ibG9ja0luZm9VcmxWYWx1ZSwgZXZlbnQuZGV0YWlsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOnN1Ym1pdC1zdGFydCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgIC8vIEFkZCB0aGUgY3VycmVudGx5IG9wZW4gZWRpdG9yIHRhYnMgdG8gdGhlIHJlcXVlc3Qgd2hlbiBzZWxlY3RpbmcgYSB0aGVtZVxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcy50aGVtZVNlbGVjdG9yVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkT3BlbkVkaXRvclRhYnNUb1JlcXVlc3QoZXZlbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbmNsdWRlIHRoZSBhY3RpdmUgZWRpdG9yJ3MgY29udGVudCB3aGVuIHRoZSBzYXZlIG9wZXJhdGlvbiB3YXMgdHJpZ2dlcmVkXG4gICAgICAgICAgICBpZiAoZXZlbnQuZGV0YWlsLmZvcm1TdWJtaXNzaW9uLnN1Ym1pdHRlcj8uZGF0YXNldD8ub3BlcmF0aW9uID09PSAnc2F2ZScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRFZGl0b3JDb250ZW50VG9SZXF1ZXN0KGV2ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9nZXRBY3RpdmVNdXRhYmxlRWRpdG9yKCk/LmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNsb3NlKGV2ZW50KSB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKSkuaW5uZXJUZXh0ID0gJyc7XG4gICAgfVxuXG4gICAgZWRpdG9yVGFyZ2V0Q29ubmVjdGVkKGVsKSB7XG4gICAgICAgIHRoaXMuZWRpdG9ycy5zZXQoZWwsIG5ldyBUd2lnRWRpdG9yKGVsLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykpKTtcbiAgICB9XG5cbiAgICBlZGl0b3JUYXJnZXREaXNjb25uZWN0ZWQoZWwpIHtcbiAgICAgICAgdGhpcy5lZGl0b3JzLmdldChlbCkuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLmVkaXRvcnMuZGVsZXRlKGVsKTtcbiAgICB9XG5cbiAgICBlZGl0b3JBbm5vdGF0aW9uc1RhcmdldENvbm5lY3RlZChlbCkge1xuICAgICAgICB0aGlzLmVkaXRvcnNcbiAgICAgICAgICAgIC5nZXQoZWwuY2xvc2VzdCgnKltkYXRhLWNvbnRhby0tdGVtcGxhdGUtc3R1ZGlvLXRhcmdldD1cImVkaXRvclwiXScpKVxuICAgICAgICAgICAgPy5zZXRBbm5vdGF0aW9uc0RhdGEoSlNPTi5wYXJzZShlbC5pbm5lclRleHQpKVxuICAgICAgICA7XG4gICAgfVxuXG4gICAgZGlhbG9nVGFyZ2V0Q29ubmVjdGVkKGVsKSB7XG4gICAgICAgIGVsLnNob3dNb2RhbCgpO1xuICAgICAgICBlbC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpPy5mb2N1cygpO1xuICAgICAgICBlbC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwidGV4dFwiXScpPy5zZWxlY3QoKTtcblxuICAgICAgICBlbC5xdWVyeVNlbGVjdG9yKCdmb3JtJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsICgpID0+IHtcbiAgICAgICAgICAgIGVsLnJlbW92ZSgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIGNvbG9yQ2hhbmdlKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuZWRpdG9ycy5mb3JFYWNoKGVkaXRvciA9PiB7XG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q29sb3JTY2hlbWUoZXZlbnQuZGV0YWlsLm1vZGUpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIF9hZGRPcGVuRWRpdG9yVGFic1RvUmVxdWVzdChldmVudCkge1xuICAgICAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSBldmVudC5kZXRhaWwuZm9ybVN1Ym1pc3Npb24ubG9jYXRpb24uc2VhcmNoUGFyYW1zO1xuXG4gICAgICAgIGNvbnN0IHRhYnMgPSB0aGlzLmFwcGxpY2F0aW9uXG4gICAgICAgICAgICAuZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKHRoaXMudGFic1RhcmdldCwgJ2NvbnRhby0tdGFicycpXG4gICAgICAgICAgICAuZ2V0VGFicygpXG4gICAgICAgIDtcblxuICAgICAgICBPYmplY3Qua2V5cyh0YWJzKS5mb3JFYWNoKHRhYklkID0+IHtcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgaWRlbnRpZmllciBmcm9tIHRhYklkIFwidGVtcGxhdGUtc3R1ZGlvLS10YWJfPGlkZW50aWZpZXI+XCJcbiAgICAgICAgICAgIHNlYXJjaFBhcmFtcy5hcHBlbmQoJ29wZW5fdGFiW10nLCB0YWJJZC5zdWJzdHJpbmcoMjEpKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBfYWRkRWRpdG9yQ29udGVudFRvUmVxdWVzdChldmVudCkge1xuICAgICAgICBldmVudC5kZXRhaWwuZm9ybVN1Ym1pc3Npb24uZmV0Y2hSZXF1ZXN0LmJvZHkuYXBwZW5kKFxuICAgICAgICAgICAgJ2NvZGUnLFxuICAgICAgICAgICAgdGhpcy5fZ2V0QWN0aXZlTXV0YWJsZUVkaXRvcigpPy5nZXRDb250ZW50KCkgPz8gJydcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBfZ2V0QWN0aXZlTXV0YWJsZUVkaXRvcigpIHtcbiAgICAgICAgY29uc3QgZWRpdG9yRWxlbWVudHNPbkFjdGl2ZVRhYiA9IHRoaXMuYXBwbGljYXRpb25cbiAgICAgICAgICAgIC5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIodGhpcy50YWJzVGFyZ2V0LCAnY29udGFvLS10YWJzJylcbiAgICAgICAgICAgIC5nZXRBY3RpdmVUYWIoKVxuICAgICAgICAgICAgPy5xdWVyeVNlbGVjdG9yQWxsKCcqW2RhdGEtY29udGFvLS10ZW1wbGF0ZS1zdHVkaW8tdGFyZ2V0PVwiZWRpdG9yXCJdJylcbiAgICAgICAgO1xuXG4gICAgICAgIGZvciAoY29uc3QgZWwgb2YgZWRpdG9yRWxlbWVudHNPbkFjdGl2ZVRhYiA/PyBbXSkge1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdGhpcy5lZGl0b3JzLmdldChlbCk7XG5cbiAgICAgICAgICAgIGlmIChlZGl0b3IgJiYgZWRpdG9yLmlzRWRpdGFibGUoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlZGl0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBhc3luYyBfdmlzaXQodXJsLCBwYXJhbXMpIHtcbiAgICAgICAgaWYgKHBhcmFtcyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdXJsICs9ICc/JyArIG5ldyBVUkxTZWFyY2hQYXJhbXMocGFyYW1zKS50b1N0cmluZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0FjY2VwdCc6ICd0ZXh0L3ZuZC50dXJiby1zdHJlYW0uaHRtbCcsXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5yZWRpcmVjdGVkKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbiA9IHJlc3BvbnNlLnVybDtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykuc3RhcnRzV2l0aCgndGV4dC92bmQudHVyYm8tc3RyZWFtLmh0bWwnKSB8fCByZXNwb25zZS5zdGF0dXMgPj0gMzAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBUaGVyZSB3YXMgYW4gZXJyb3IgcHJvY2Vzc2luZyB0aGUgVHVyYm8gc3RyZWFtIHJlc3BvbnNlIGZyb20gXCIke3VybH1cImApO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcbiAgICAgICBUdXJiby5yZW5kZXJTdHJlYW1NZXNzYWdlKGh0bWwpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIGluaXRpYWxpemUoKSB7XG4gICAgICAgIFR1cmJvLmNhY2hlLmV4ZW1wdFBhZ2VGcm9tQ2FjaGUoKTtcbiAgICB9XG5cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBpZiAoIXRoaXMuZWxlbWVudC50aW55bWNlQ29uZmlnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdObyBUaW55TUNFIGNvbmZpZyB3YXMgYXR0YWNoZWQgdG8gdGhlIERPTSBlbGVtZW50LCBleHBlY3RlZCBhbiBleHBhbmRvIHByb3BlcnR5IGNhbGxlZCBcInRpbnltY2VDb25maWdcIi4nLCB0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5lbGVtZW50LnRpbnltY2VDb25maWc7XG4gICAgICAgIGNvbmZpZy50YXJnZXQgPSB0aGlzLmVsZW1lbnQ7XG5cbiAgICAgICAgLy8gVGlueU1DRSBjcmVhdGVzIHRoZSBlZGl0b3IgSUQgYmFzZWQgb24gdGhlIHRhcmdldCBlbGVtZW50J3MgSUQgKGlmIHNldCkuXG4gICAgICAgIC8vIFRoaXMgbGVhZHMgdG8gYSBwcm9ibGVtIGlmIGFuIGVkaXRvciB3aXRoIHRoZSBzYW1lIElEIGlzIHN0aWxsIGFyb3VuZCxcbiAgICAgICAgLy8gd2hpY2ggd291bGQgYmUgdGhlIGNhc2UgaWYgdGhlIGRpc2Nvbm5lY3QgZXZlbnQgY2xlYW5pbmcgdXAgdGhlIHJlc291cmNlXG4gICAgICAgIC8vIGhhcyBub3QgcnVuIHlldC4gV2UgdGhlcmVmb3JlIHJlbW92ZSB0aGUgSUQgYW5kIHJlLWFkZCBpdCBhZnRlclxuICAgICAgICAvLyBpbml0aWFsaXppbmcgdGhlIGVkaXRvci5cbiAgICAgICAgY29uc3QgZWxlbWVudElkID0gdGhpcy5lbGVtZW50LmlkO1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xuXG4gICAgICAgIHRpbnltY2U/LmluaXQoY29uZmlnKS50aGVuKChlZGl0b3JzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVkaXRvcklkID0gZWRpdG9yc1swXT8uaWQ7XG5cbiAgICAgICAgICAgIC8vIEZpcmUgYSBjdXN0b20gZXZlbnQgd2hlbiB0aGUgZWRpdG9yIGZpbmlzaGVkIGluaXRpYWxpemluZy5cbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goJ2VkaXRvci1sb2FkZWQnLCB7IGRldGFpbDogeyBjb250ZW50OiBlZGl0b3JzWzBdID8/IG51bGwgfSB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCBlbGVtZW50SWQpO1xuICAgIH1cblxuICAgIGRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRpbnltY2U/LmdldCh0aGlzLmVkaXRvcklkKT8ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgbGVhdmUoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gdGlueW1jZT8uZ2V0KHRoaXMuZWRpdG9ySWQpXG5cbiAgICAgICAgaWYgKCFlZGl0b3IgfHwgIWVkaXRvci5wbHVnaW5zLmhhc093blByb3BlcnR5KCdhdXRvc2F2ZScpIHx8IGVkaXRvci5pc05vdERpcnR5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmlnZ2VyIGEgYmVmb3JldW5sb2FkIGV2ZW50IGxpa2Ugd2hlbiBuYXZpZ2F0aW5nIGF3YXkgdG8gY2FwdHVyZSB0aGUgVGlueU1DRSBhdXRvc2F2ZSBtZXNzYWdlXG4gICAgICAgIGNvbnN0IGRlbGVnYXRlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0JlZm9yZVVubG9hZEV2ZW50Jyk7XG4gICAgICAgIGRlbGVnYXRlLmluaXRFdmVudCgnYmVmb3JldW5sb2FkJywgZmFsc2UsIHRydWUpO1xuXG4gICAgICAgIGlmICghd2luZG93LmRpc3BhdGNoRXZlbnQoZGVsZWdhdGUpICYmICFjb25maXJtKGRlbGVnYXRlLnJldHVyblZhbHVlKSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRyb2xsZXIgfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIGlkOiBTdHJpbmcsXG4gICAgICAgIHRhYmxlOiBTdHJpbmcsXG4gICAgfVxuXG4gICAgc3RhdGljIGNsYXNzZXMgPSBbJ2NvbGxhcHNlZCddO1xuXG4gICAgc3RhdGljIGFmdGVyTG9hZCAoaWRlbnRpZmllciwgYXBwbGljYXRpb24pIHtcbiAgICAgICAgY29uc3QgYWRkQ29udHJvbGxlciA9IChlbCwgaWQsIHRhYmxlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmcyA9IGVsLnBhcmVudE5vZGU7XG5cbiAgICAgICAgICAgIGZzLmRhdGFzZXQuY29udHJvbGxlciA9IGAke2ZzLmRhdGFzZXQuY29udHJvbGxlciB8fCAnJ30gJHtpZGVudGlmaWVyfWA7XG4gICAgICAgICAgICBmcy5zZXRBdHRyaWJ1dGUoYGRhdGEtJHtpZGVudGlmaWVyfS1pZC12YWx1ZWAsIGlkKTtcbiAgICAgICAgICAgIGZzLnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LXRhYmxlLXZhbHVlYCwgdGFibGUpO1xuICAgICAgICAgICAgZnMuc2V0QXR0cmlidXRlKGBkYXRhLSR7aWRlbnRpZmllcn0tY29sbGFwc2VkLWNsYXNzYCwgJ2NvbGxhcHNlZCcpO1xuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLWFjdGlvbicsIGBjbGljay0+JHtpZGVudGlmaWVyfSN0b2dnbGUga2V5ZG93bi5lbnRlci0+JHtpZGVudGlmaWVyfSN0b2dnbGUga2V5ZG93bi5zcGFjZS0+JHtpZGVudGlmaWVyfSNwcmV2ZW50OnByZXZlbnQga2V5dXAuc3BhY2UtPiR7aWRlbnRpZmllcn0jdG9nZ2xlOnByZXZlbnRgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG1pZ3JhdGVMZWdhY3kgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdsZWdlbmRbZGF0YS10b2dnbGUtZmllbGRzZXRdJykuZm9yRWFjaChmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuY29uc29sZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVzaW5nIHRoZSBcImRhdGEtdG9nZ2xlLWZpZWxkc2V0XCIgYXR0cmlidXRlIG9uIGZpZWxkc2V0IGxlZ2VuZHMgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIENvbnRhbyA2LiBBcHBseSB0aGUgXCIke2lkZW50aWZpZXJ9XCIgU3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLmApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHsgaWQsIHRhYmxlIH0gPSBKU09OLnBhcnNlKGVsLmdldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUtZmllbGRzZXQnKSk7XG4gICAgICAgICAgICAgICAgYWRkQ29udHJvbGxlcihlbCwgaWQsIHRhYmxlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBBamF4UmVxdWVzdC50b2dnbGVGaWVsZHNldCA9IChlbCwgaWQsIHRhYmxlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZnMgPSBlbC5wYXJlbnROb2RlO1xuXG4gICAgICAgICAgICAgICAgLy8gQWxyZWFkeSBjbGlja2VkLCBTdGltdWx1cyBjb250cm9sbGVyIHdhcyBhZGRlZCBkeW5hbWljYWxseVxuICAgICAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbi5nZXRDb250cm9sbGVyRm9yRWxlbWVudEFuZElkZW50aWZpZXIoZnMsIGlkZW50aWZpZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdVc2luZyBBamF4UmVxdWVzdC50b2dnbGVGaWVsZHNldCgpIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBDb250YW8gNi4gQXBwbHkgdGhlIFN0aW11bHVzIGFjdGlvbnMgaW5zdGVhZC4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBhZGRDb250cm9sbGVyKGVsLCBpZCwgdGFibGUpO1xuXG4gICAgICAgICAgICAgICAgLy8gT3B0aW1pc3RpY2FsbHkgd2FpdCB1bnRpbCBTdGltdWx1cyBoYXMgcmVnaXN0ZXJlZCB0aGUgbmV3IGNvbnRyb2xsZXJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgYXBwbGljYXRpb24uZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyKGZzLCBpZGVudGlmaWVyKS50b2dnbGUoKTsgfSwgMTAwKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYWxsZWQgYXMgc29vbiBhcyByZWdpc3RlcmVkLCBzbyBET00gbWF5IG5vdCBoYXZlIGJlZW4gbG9hZGVkIHlldFxuICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkaW5nXCIpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIG1pZ3JhdGVMZWdhY3kpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWlncmF0ZUxlZ2FjeSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29ubmVjdCAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGFiZWwuZXJyb3IsIGxhYmVsLm1hbmRhdG9yeScpLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5jb2xsYXBzZWRDbGFzcyk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnaGlkZScpKSB7XG4gICAgICAgICAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVzaW5nIGNsYXNzIFwiaGlkZVwiIG9uIGEgZmllbGRzZXQgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIENvbnRhbyA2LiBVc2UgY2xhc3MgXCIke3RoaXMuY29sbGFwc2VkQ2xhc3N9XCIgaW5zdGVhZC5gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jb2xsYXBzZWRDbGFzcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLmNvbGxhcHNlZENsYXNzKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRBcmlhRXhwYW5kZWQoZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRBcmlhRXhwYW5kZWQodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2dnbGUgKCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLmNvbGxhcHNlZENsYXNzKSkge1xuICAgICAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgICAgICAgICB0aGlzLnNldEFyaWFFeHBhbmRlZCh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXJpYUV4cGFuZGVkKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wZW4gKCkge1xuICAgICAgICBpZiAoIXRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5jb2xsYXBzZWRDbGFzcykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuICAgICAgICB0aGlzLnN0b3JlU3RhdGUoMSk7XG4gICAgfVxuXG4gICAgY2xvc2UgKCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLmNvbGxhcHNlZENsYXNzKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZm9ybSA9IHRoaXMuZWxlbWVudC5jbG9zZXN0KCdmb3JtJyk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyZXF1aXJlZF0nKTtcblxuICAgICAgICBsZXQgY29sbGFwc2UgPSB0cnVlO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIWlucHV0W2ldLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY29sbGFwc2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY29sbGFwc2UpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YoZm9ybS5jaGVja1ZhbGlkaXR5KSA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpLmNsaWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLmNvbGxhcHNlZENsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcmVTdGF0ZSgwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0b3JlU3RhdGUgKHN0YXRlKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNJZFZhbHVlIHx8ICF0aGlzLmhhc1RhYmxlVmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZldGNoKHdpbmRvdy5sb2NhdGlvbi5ocmVmLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnWC1SZXF1ZXN0ZWQtV2l0aCc6ICdYTUxIdHRwUmVxdWVzdCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICd0b2dnbGVGaWVsZHNldCcsXG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuaWRWYWx1ZSxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZVZhbHVlLFxuICAgICAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldEFyaWFFeHBhbmRlZChzdGF0ZSkge1xuICAgICAgICBjb25zdCBidXR0b24gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uJyk7XG5cbiAgICAgICAgaWYgKGJ1dHRvbikge1xuICAgICAgICAgICAgYnV0dG9uLmFyaWFFeHBhbmRlZCA9IHN0YXRlO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIGNsYXNzZXMgPSBbJ2NvbGxhcHNlZCddXG5cbiAgICBzdGF0aWMgdmFsdWVzID0ge1xuICAgICAgICB1cmw6IFN0cmluZyxcbiAgICAgICAgcmVxdWVzdFRva2VuOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZFRpdGxlOiBTdHJpbmcsXG4gICAgICAgIGNvbGxhcHNlVGl0bGU6IFN0cmluZyxcbiAgICB9XG5cbiAgICB0b2dnbGUgKHsgY3VycmVudFRhcmdldCwgcGFyYW1zOiB7IGNhdGVnb3J5IH19KSB7XG4gICAgICAgIGNvbnN0IGVsID0gY3VycmVudFRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICBjb25zdCBjb2xsYXBzZWQgPSBlbC5jbGFzc0xpc3QudG9nZ2xlKHRoaXMuY29sbGFwc2VkQ2xhc3MpO1xuXG4gICAgICAgIGN1cnJlbnRUYXJnZXQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgY29sbGFwc2VkID8gJ2ZhbHNlJyA6ICd0cnVlJyk7XG4gICAgICAgIGN1cnJlbnRUYXJnZXQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGNvbGxhcHNlZCA/IHRoaXMuZXhwYW5kVGl0bGVWYWx1ZSA6IHRoaXMuY29sbGFwc2VUaXRsZVZhbHVlKTtcblxuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGNhdGVnb3J5LCBjb2xsYXBzZWQpO1xuICAgIH1cblxuICAgIHNlbmRSZXF1ZXN0IChjYXRlZ29yeSwgY29sbGFwc2VkKSB7XG4gICAgICAgIGZldGNoKHRoaXMudXJsVmFsdWUsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3RvZ2dsZU5hdmlnYXRpb24nLFxuICAgICAgICAgICAgICAgIGlkOiBjYXRlZ29yeSxcbiAgICAgICAgICAgICAgICBzdGF0ZTogY29sbGFwc2VkID8gMCA6IDEsXG4gICAgICAgICAgICAgICAgUkVRVUVTVF9UT0tFTjogdGhpcy5yZXF1ZXN0VG9rZW5WYWx1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHZhbHVlcyA9IHtcbiAgICAgICAgbW9kZToge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgICAgICAgZGVmYXVsdDogNVxuICAgICAgICB9LFxuICAgICAgICB0b2dnbGVBY3Rpb246IFN0cmluZyxcbiAgICAgICAgbG9hZEFjdGlvbjogU3RyaW5nLFxuICAgICAgICByZXF1ZXN0VG9rZW46IFN0cmluZyxcbiAgICAgICAgcmVmZXJlcklkOiBTdHJpbmcsXG4gICAgICAgIGV4cGFuZDogU3RyaW5nLFxuICAgICAgICBjb2xsYXBzZTogU3RyaW5nLFxuICAgICAgICBleHBhbmRBbGw6IFN0cmluZyxcbiAgICAgICAgZXhwYW5kQWxsVGl0bGU6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2VBbGw6IFN0cmluZyxcbiAgICAgICAgY29sbGFwc2VBbGxUaXRsZTogU3RyaW5nLFxuICAgIH1cblxuICAgIHN0YXRpYyB0YXJnZXRzID0gWydvcGVyYXRpb24nLCAnbm9kZScsICd0b2dnbGUnLCAnY2hpbGQnLCAncm9vdENoaWxkJ107XG5cbiAgICBvcGVyYXRpb25UYXJnZXRDb25uZWN0ZWQgKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbigpO1xuICAgIH1cblxuICAgIGNoaWxkVGFyZ2V0Q29ubmVjdGVkICgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICB0b2dnbGUgKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICBlbC5ibHVyKCk7XG5cbiAgICAgICAgdGhpcy50b2dnbGVUb2dnbGVyKGVsLCBldmVudC5wYXJhbXMuaWQsIGV2ZW50LnBhcmFtcy5sZXZlbCwgZXZlbnQucGFyYW1zLmZvbGRlcik7XG4gICAgfVxuXG4gICAgdG9nZ2xlVG9nZ2xlciAoZWwsIGlkLCBsZXZlbCwgZm9sZGVyKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5pZChpZCk7XG5cbiAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbS5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0NoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5leHBhbmRUb2dnbGVyKGVsKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoZWwsIGlkLCAxKTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2VUb2dnbGVyKGVsKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoZWwsIGlkLCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hDaGlsZChlbCwgaWQsIGxldmVsLCBmb2xkZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGVPcGVyYXRpb24oKTtcbiAgICB9XG5cbiAgICBleHBhbmRUb2dnbGVyIChlbCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdmb2xkYWJsZS0tb3BlbicpO1xuXG4gICAgICAgIGlmIChlbC5oYXNBdHRyaWJ1dGUoJ3RpdGxlJykpIHtcbiAgICAgICAgICAgIGVsLnRpdGxlID0gdGhpcy5jb2xsYXBzZVZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZWwuZ2V0RWxlbWVudHMoJ2ltZycpPy5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgICAgICAgICAgaW1hZ2UuYWx0ID0gdGhpcy5jb2xsYXBzZVZhbHVlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb2xsYXBzZVRvZ2dsZXIgKGVsKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cbiAgICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgndGl0bGUnKSkge1xuICAgICAgICAgICAgZWwudGl0bGUgPSB0aGlzLmV4cGFuZFZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZWwuZ2V0RWxlbWVudHMoJ2ltZycpPy5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgICAgICAgICAgaW1hZ2UuYWx0ID0gdGhpcy5leHBhbmRWYWx1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbG9hZFRvZ2dsZXIgKGVsLCBlbmFibGVkKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdFtlbmFibGVkID8gJ2FkZCcgOiAncmVtb3ZlJ10oJ2ZvbGRhYmxlLS1sb2FkaW5nJyk7XG4gICAgfVxuXG4gICAgc2hvd0NoaWxkIChpdGVtKSB7XG4gICAgICAgIGl0ZW0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgIH1cblxuICAgIGhpZGVDaGlsZCAoaXRlbSkge1xuICAgICAgICBpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxuXG4gICAgYXN5bmMgZmV0Y2hDaGlsZCAoZWwsIGlkLCBsZXZlbCwgZm9sZGVyKSB7XG4gICAgICAgIHRoaXMubG9hZFRvZ2dsZXIoZWwsIHRydWUpO1xuXG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwobG9jYXRpb24uaHJlZik7XG4gICAgICAgIGNvbnN0IHNlYXJjaCA9IHVybC5zZWFyY2hQYXJhbXM7XG4gICAgICAgIHNlYXJjaC5zZXQoJ3JlZicsIHRoaXMucmVmZXJlcklkVmFsdWUpO1xuICAgICAgICB1cmwuc2VhcmNoID0gc2VhcmNoLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyxcbiAgICAgICAgICAgICAgICAnWC1SZXF1ZXN0ZWQtV2l0aCc6ICdYTUxIdHRwUmVxdWVzdCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgICAgICAgICAnYWN0aW9uJzogdGhpcy5sb2FkQWN0aW9uVmFsdWUsXG4gICAgICAgICAgICAgICAgJ2lkJzogaWQsXG4gICAgICAgICAgICAgICAgJ2xldmVsJzogbGV2ZWwsXG4gICAgICAgICAgICAgICAgJ2ZvbGRlcic6IGZvbGRlcixcbiAgICAgICAgICAgICAgICAnc3RhdGUnOiAxLFxuICAgICAgICAgICAgICAgICdSRVFVRVNUX1RPS0VOJzogdGhpcy5yZXF1ZXN0VG9rZW5WYWx1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBjb25zdCB0eHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgICAgIGxpLmlkID0gaWQ7XG4gICAgICAgICAgICBsaS5jbGFzc0xpc3QuYWRkKCdwYXJlbnQnKTtcbiAgICAgICAgICAgIGxpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJztcbiAgICAgICAgICAgIGxpLnNldEF0dHJpYnV0ZShgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0tdGFyZ2V0YCwgbGV2ZWwgPT09IDAgPyAnY2hpbGQgcm9vdENoaWxkJyA6ICdjaGlsZCcpO1xuXG4gICAgICAgICAgICBjb25zdCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgICAgICAgICB1bC5jbGFzc0xpc3QuYWRkKCdsZXZlbF8nICsgbGV2ZWwpO1xuICAgICAgICAgICAgdWwuaW5uZXJIVE1MID0gdHh0O1xuICAgICAgICAgICAgbGkuYXBwZW5kKHVsKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZVZhbHVlID09PSA1KSB7XG4gICAgICAgICAgICAgICAgZWwuY2xvc2VzdCgnbGknKS5hZnRlcihsaSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBpc0ZvbGRlciA9IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBlbC5jbG9zZXN0KCdsaScpLFxuICAgICAgICAgICAgICAgICAgICBuZXh0O1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKHR5cGVPZihwYXJlbnQpID09PSAnZWxlbWVudCcgJiYgcGFyZW50LnRhZ05hbWUgPT09ICdMSScgJiYgKG5leHQgPSBwYXJlbnQubmV4dEVsZW1lbnRTaWJsaW5nKSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBuZXh0O1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50LmNsYXNzTGlzdC5jb250YWlucygndGxfZm9sZGVyJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRm9sZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzRm9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5iZWZvcmUobGkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudC5hZnRlcihsaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3N0cnVjdHVyZScpKTtcbiAgICAgICAgICAgIHRoaXMuZXhwYW5kVG9nZ2xlcihlbCk7XG5cbiAgICAgICAgICAgIC8vIEhPT0sgKHNlZSAjNjc1MilcbiAgICAgICAgICAgIHdpbmRvdy5maXJlRXZlbnQoJ2FqYXhfY2hhbmdlJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxvYWRUb2dnbGVyKGVsLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgYXN5bmMgdG9nZ2xlQWxsIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IGhyZWYgPSBldmVudC5jdXJyZW50VGFyZ2V0LmhyZWY7XG5cbiAgICAgICAgaWYgKHRoaXMuaGFzRXhwYW5kZWRSb290KCkgXiAoZXZlbnQgPyBldmVudC5hbHRLZXkgOiBmYWxzZSkpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQWxsU3RhdGUoaHJlZiwgMCk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVRhcmdldHMuZm9yRWFjaCgoZWwpID0+IHRoaXMuY29sbGFwc2VUb2dnbGVyKGVsKSk7XG4gICAgICAgICAgICB0aGlzLmNoaWxkVGFyZ2V0cy5mb3JFYWNoKChpdGVtKSA9PiBpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jaGlsZFRhcmdldHMuZm9yRWFjaCgoZWwpID0+IGVsLnJlbW92ZSgpKTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlVGFyZ2V0cy5mb3JFYWNoKChlbCkgPT4gdGhpcy5sb2FkVG9nZ2xlcihlbCwgdHJ1ZSkpO1xuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUFsbFN0YXRlKGhyZWYsIDEpO1xuICAgICAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcblxuICAgICAgICAgICAgdGhpcy50b2dnbGVUYXJnZXRzLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLmZldGNoQ2hpbGQoXG4gICAgICAgICAgICAgICAgICAgIGVsLFxuICAgICAgICAgICAgICAgICAgICBlbC5nZXRBdHRyaWJ1dGUoYGRhdGEtJHt0aGlzLmlkZW50aWZpZXJ9LWlkLXBhcmFtYCksXG4gICAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICAgIGVsLmdldEF0dHJpYnV0ZShgZGF0YS0ke3RoaXMuaWRlbnRpZmllcn0tZm9sZGVyLXBhcmFtYClcbiAgICAgICAgICAgICAgICApKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbigpO1xuICAgIH1cblxuICAgIGtleXByZXNzIChldmVudCkge1xuICAgICAgICB0aGlzLnVwZGF0ZU9wZXJhdGlvbihldmVudCk7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlU3RhdGUgKGVsLCBpZCwgc3RhdGUpIHtcbiAgICAgICAgYXdhaXQgZmV0Y2gobG9jYXRpb24uaHJlZiwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgICAgICdhY3Rpb24nOiB0aGlzLnRvZ2dsZUFjdGlvblZhbHVlLFxuICAgICAgICAgICAgICAgICdpZCc6IGlkLFxuICAgICAgICAgICAgICAgICdzdGF0ZSc6IHN0YXRlLFxuICAgICAgICAgICAgICAgICdSRVFVRVNUX1RPS0VOJzogdGhpcy5yZXF1ZXN0VG9rZW5WYWx1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlQWxsU3RhdGUgKGhyZWYsIHN0YXRlKSB7XG4gICAgICAgIGF3YWl0IGZldGNoKGAke2hyZWZ9JnN0YXRlPSR7c3RhdGV9YCk7XG4gICAgfVxuXG4gICAgdXBkYXRlT3BlcmF0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMuaGFzT3BlcmF0aW9uVGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oYXNFeHBhbmRlZFJvb3QoKSBeIChldmVudCA/IGV2ZW50LmFsdEtleSA6IGZhbHNlKSkge1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQuaW5uZXJUZXh0ID0gdGhpcy5jb2xsYXBzZUFsbFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25UYXJnZXQudGl0bGUgPSB0aGlzLmNvbGxhcHNlQWxsVGl0bGVWYWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9uVGFyZ2V0LmlubmVyVGV4dCA9IHRoaXMuZXhwYW5kQWxsVmFsdWU7XG4gICAgICAgICAgICB0aGlzLm9wZXJhdGlvblRhcmdldC50aXRsZSA9IHRoaXMuZXhwYW5kQWxsVGl0bGVWYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGhhc0V4cGFuZGVkUm9vdCAoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMucm9vdENoaWxkVGFyZ2V0cy5maW5kKChlbCkgPT4gZWwuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKVxuICAgIH1cbn1cbiIsImltcG9ydCB7Q29udHJvbGxlcn0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb29sdGlwc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgZGVmYXVsdE9wdGlvbnNNYXAgPSB7XG4gICAgICAgICdhIGltZ1thbHRdJzoge3g6IC05LCB5OiAzMH0sXG4gICAgICAgICcuc2dhbGxlcnkgaW1nW2FsdF0nOiB7eDogMCwgeTogNzV9LFxuICAgICAgICAncC50bF90aXAnOiB7eDogMCwgeTogMjMsIHVzZUNvbnRlbnQ6IHRydWV9LFxuICAgICAgICAnI2hvbWVbdGl0bGVdJzoge3g6IDYsIHk6IDQyfSxcbiAgICAgICAgJyN0bWVudSBhW3RpdGxlXSc6IHt4OiAwLCB5OiA0Mn0sXG4gICAgICAgICdhW3RpdGxlXVtjbGFzc149XCJncm91cC1cIl0nOiB7eDogLTYsIHk6IDI3fSxcbiAgICAgICAgJ2FbdGl0bGVdLm5hdmlnYXRpb24nOiB7eDogMjUsIHk6IDMyfSxcbiAgICAgICAgJ2ltZ1t0aXRsZV0uZ2ltYWdlJzoge3g6IC05LCB5OiA2MH0sXG4gICAgICAgICdpbWdbdGl0bGVdOm5vdCguZ2ltYWdlKSc6IHt4OiAtOSwgeTogMzB9LFxuICAgICAgICAnYVt0aXRsZV0ucGlja2VyLXdpemFyZCc6IHt4OiAtNCwgeTogMzB9LFxuICAgICAgICAnYnV0dG9uIGltZ1thbHRdJzoge3g6IC05LCB5OiAzMH0sXG4gICAgICAgICdidXR0b25bdGl0bGVdLnVuc2VsZWN0YWJsZSc6IHt4OiAtNCwgeTogMjB9LFxuICAgICAgICAnYnV0dG9uW3RpdGxlXTpub3QoLnVuc2VsZWN0YWJsZSknOiB7eDogLTksIHk6IDMwfSxcbiAgICAgICAgJ2FbdGl0bGVdOm5vdCgucGlja2VyLXdpemFyZCknOiB7eDogLTksIHk6IDMwfSxcbiAgICAgICAgJ2lucHV0W3RpdGxlXSc6IHt4OiAtOSwgeTogMzB9LFxuICAgICAgICAndGltZVt0aXRsZV0nOiB7eDogLTksIHk6IDI2fSxcbiAgICAgICAgJ3NwYW5bdGl0bGVdJzoge3g6IC05LCB5OiAyNn0sXG4gICAgfTtcblxuICAgIGFjdGl2ZVRhcmdldHMgPSBuZXcgU2V0KCk7XG4gICAgcmVtb3ZlQ2xpY2tUYXJnZXRIYW5kbGVyRGVsZWdhdGVzID0gbmV3IE1hcCgpO1xuXG4gICAgLyoqXG4gICAgICogVGhlcmUgaXMgb25lIGNvbnRyb2xsZXIgaGFuZGxpbmcgbXVsdGlwbGUgdG9vbHRpcCB0YXJnZXRzLiBUaGUgdG9vbHRpcFxuICAgICAqIERPTSBlbGVtZW50IGlzIHNoYXJlZCBhY3Jvc3MgdGFyZ2V0cy5cbiAgICAgKi9cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMudG9vbHRpcCA9IHRoaXMuX2NyZWF0ZVRpcENvbnRhaW5lcigpKTtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5fdG91Y2hTdGFydERlbGVnYXRlKTtcbiAgICB9XG5cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICB0aGlzLnRvb2x0aXAucmVtb3ZlKCk7XG5cbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuX3RvdWNoU3RhcnREZWxlZ2F0ZSk7XG4gICAgfVxuXG4gICAgdG9vbHRpcFRhcmdldENvbm5lY3RlZChlbCkge1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKGUpID0+IHRoaXMuX3Nob3dUb29sdGlwKGUudGFyZ2V0LCAxMDAwKSk7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKGUpID0+IHRoaXMuX3Nob3dUb29sdGlwKGUudGFyZ2V0KSk7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoZSkgPT4gdGhpcy5faGlkZVRvb2x0aXAoZS50YXJnZXQpKTtcblxuICAgICAgICAvLyBJbiBjYXNlIHRoZSB0b29sdGlwIHRhcmdldCBpcyBpbnNpZGUgYSBsaW5rIG9yIGJ1dHRvbiwgYWxzbyBjbG9zZSBpdFxuICAgICAgICAvLyB3aGVuIGEgY2xpY2sgaGFwcGVuZWRcbiAgICAgICAgY29uc3QgY2xpY2tUYXJnZXQgPSBlbC5jbG9zZXN0KCdidXR0b24sIGEnKTtcblxuICAgICAgICBpZiAoY2xpY2tUYXJnZXQpIHtcbiAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB0aGlzLl9oaWRlVG9vbHRpcChlbCk7XG5cbiAgICAgICAgICAgIGNsaWNrVGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUNsaWNrVGFyZ2V0SGFuZGxlckRlbGVnYXRlcy5zZXQoZWwsICgpID0+IGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlcikpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdG9vbHRpcFRhcmdldERpc2Nvbm5lY3RlZChlbCkge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVUYXJnZXRzLmhhcyhlbCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVUb29sdGlwKGVsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnJlbW92ZUNsaWNrVGFyZ2V0SGFuZGxlckRlbGVnYXRlcy5oYXMoZWwpKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUNsaWNrVGFyZ2V0SGFuZGxlckRlbGVnYXRlcy5nZXQoZWwpKCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUNsaWNrVGFyZ2V0SGFuZGxlckRlbGVnYXRlcy5kZWxldGUoZWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2NyZWF0ZVRpcENvbnRhaW5lcigpIHtcbiAgICAgICAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0b29sdGlwLnNldEF0dHJpYnV0ZSgncm9sZScsICd0b29sdGlwJyk7XG4gICAgICAgIHRvb2x0aXAuY2xhc3NMaXN0LmFkZCgndGlwJyk7XG4gICAgICAgIHRvb2x0aXAuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICB0b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgcmV0dXJuIHRvb2x0aXA7XG4gICAgfVxuXG4gICAgX3RvdWNoU3RhcnREZWxlZ2F0ZSA9IChlKSA9PiB7XG4gICAgICAgIFsuLi50aGlzLmFjdGl2ZVRhcmdldHNdLmZpbHRlcihlbCA9PiAhZWwuY29udGFpbnMoZS50YXJnZXQpKS5mb3JFYWNoKHRoaXMuX2hpZGVUb29sdGlwLmJpbmQodGhpcykpXG4gICAgfTtcblxuICAgIF9zaG93VG9vbHRpcChlbCwgZGVsYXkgPSAwKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLl9nZXRPcHRpb25zRm9yRWxlbWVudChlbCk7XG4gICAgICAgIGxldCB0ZXh0O1xuXG4gICAgICAgIGlmIChvcHRpb25zLnVzZUNvbnRlbnQpIHtcbiAgICAgICAgICAgIHRleHQgPSBlbC5pbm5lckhUTUw7XG4gICAgICAgIH0gZWxzZSBpZiAoJ2ltZycgPT09IGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIHRleHQgPSBlbC5nZXRBdHRyaWJ1dGUoJ2FsdCcpO1xuICAgICAgICAgICAgdGV4dCA9IHRleHQ/LnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKS5yZXBsYWNlKC8nL2csICcmYXBvczsnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRleHQgPSBlbC5nZXRBdHRyaWJ1dGUoJ3RpdGxlJyk7XG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLCB0ZXh0KTtcbiAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgndGl0bGUnKTtcbiAgICAgICAgICAgIHRleHQgPSB0ZXh0Py5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLzwvZywgJyZsdDsnKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykucmVwbGFjZSgvJy9nLCAnJmFwb3M7Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnZGlzcGxheSxjb250ZW50cyc7XG5cbiAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRzLmFkZChlbCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCBydGwgPSBnZXRDb21wdXRlZFN0eWxlKGVsKS5kaXJlY3Rpb24gPT09ICdydGwnO1xuICAgICAgICAgICAgY29uc3QgY2xpZW50V2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XG5cbiAgICAgICAgICAgIGlmICgocnRsICYmIHBvc2l0aW9uLnggPCAyMDApIHx8ICghcnRsICYmIHBvc2l0aW9uLnggPCAoY2xpZW50V2lkdGggLSAyMDApKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS5sZWZ0ID0gYCR7KHdpbmRvdy5zY3JvbGxYICsgcG9zaXRpb24ubGVmdCArIG9wdGlvbnMueCl9cHhgO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS5yaWdodCA9ICdhdXRvJztcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2x0aXAuY2xhc3NMaXN0LnJlbW92ZSgndGlwLS1ydGwnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLmxlZnQgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLnJpZ2h0ID0gYCR7KGNsaWVudFdpZHRoIC0gd2luZG93LnNjcm9sbFggLSBwb3NpdGlvbi5yaWdodCArIG9wdGlvbnMueCl9cHhgO1xuICAgICAgICAgICAgICAgIHRoaXMudG9vbHRpcC5jbGFzc0xpc3QuYWRkKCd0aXAtLXJ0bCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuaW5uZXJIVE1MID0gYDxkaXY+JHt0ZXh0fTwvZGl2PmA7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUudG9wID0gYCR7KHdpbmRvdy5zY3JvbGxZICsgcG9zaXRpb24udG9wICsgb3B0aW9ucy55KX1weGA7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUud2lsbENoYW5nZSA9ICdhdXRvJztcbiAgICAgICAgfSwgZGVsYXkpO1xuICAgIH1cblxuICAgIF9oaWRlVG9vbHRpcChlbCwgZGVsYXkgPSAwKSB7XG4gICAgICAgIGlmIChlbC5oYXNBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKSkge1xuICAgICAgICAgICAgaWYgKCFlbC5oYXNBdHRyaWJ1dGUoJ3RpdGxlJykpIHtcbiAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnYXV0byc7XG5cbiAgICAgICAgaWYgKHRoaXMudG9vbHRpcC5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldHMuZGVsZXRlKGVsKTtcblxuICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnZGlzcGxheSc7XG4gICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLndpbGxDaGFuZ2UgPSAnYXV0byc7XG4gICAgICAgICAgICB9LCBkZWxheSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfZ2V0T3B0aW9uc0ZvckVsZW1lbnQoZWwpIHtcbiAgICAgICAgZm9yIChjb25zdCBbY3JpdGVyaWEsIGRlZmF1bHRPcHRpb25zXSBvZiBPYmplY3QuZW50cmllcyhUb29sdGlwc0NvbnRyb2xsZXIuZGVmYXVsdE9wdGlvbnNNYXApKSB7XG4gICAgICAgICAgICBpZiAoZWwubWF0Y2goY3JpdGVyaWEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHt4OiAtOSwgeTogMzB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1pZ3JhdGUgbGVnYWN5IHRhcmdldHMgdG8gcHJvcGVyIGNvbnRyb2xsZXIgdGFyZ2V0cy5cbiAgICAgKi9cbiAgICBzdGF0aWMgYWZ0ZXJMb2FkKGlkZW50aWZpZXIsIGFwcGxpY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFNlbGVjdG9ycyA9IE9iamVjdC5rZXlzKFRvb2x0aXBzQ29udHJvbGxlci5kZWZhdWx0T3B0aW9uc01hcCk7XG5cbiAgICAgICAgY29uc3QgbWlncmF0ZVRhcmdldCA9IGVsID0+IHtcbiAgICAgICAgICAgIHRhcmdldFNlbGVjdG9ycy5mb3JFYWNoKHRhcmdldCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFlbC5oYXNBdHRyaWJ1dGUoYGRhdGEtJHtpZGVudGlmaWVyfS10YXJnZXRgKSAmJiBlbC5tYXRjaCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShgZGF0YS0ke2lkZW50aWZpZXJ9LXRhcmdldGAsICd0b29sdGlwJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zTGlzdCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnNMaXN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgIT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAobGV0IG5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG1pZ3JhdGVUYXJnZXQobm9kZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGx5IG1pZ3JhdGUgYWxsIHRhcmdldHMgdGhhdCBhcmUgYWxyZWFkeSBpbiB0aGUgRE9NXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFyZ2V0U2VsZWN0b3JzLmpvaW4oJywnKSkuZm9yRWFjaChlbCA9PiBtaWdyYXRlVGFyZ2V0KGVsKSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgQ29udHJvbGxlciB7XG4gICAgc3RhdGljIHRhcmdldHMgPSBbJ21lc3NhZ2UnXTtcblxuICAgIHN0YXRpYyB2YWx1ZXMgPSB7XG4gICAgICAgIHVuc3VwcG9ydGVkTWVzc2FnZTogU3RyaW5nLFxuICAgICAgICBhc3NlcnRpb25GYWlsdXJlTWVzc2FnZTogU3RyaW5nLFxuICAgICAgICBhdHRlc3RhdGlvbkZhaWx1cmVNZXNzYWdlOiBTdHJpbmdcbiAgICB9XG5cbiAgICBoYW5kbGVVbnN1cHBvcnRlZCgpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlVGFyZ2V0LmlubmVySFRNTCA9IHRoaXMucmVuZGVyTWVzc2FnZSh0aGlzLnVuc3VwcG9ydGVkTWVzc2FnZVZhbHVlKTtcbiAgICB9XG5cbiAgICBoYW5kbGVBc3NlcnRpb25GYWlsdXJlKGUpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlVGFyZ2V0LmlubmVySFRNTCA9IHRoaXMucmVuZGVyTWVzc2FnZSh0aGlzLmFzc2VydGlvbkZhaWx1cmVNZXNzYWdlVmFsdWUpO1xuICAgIH1cblxuICAgIGhhbmRsZUF0dGVzdGF0aW9uRmFpbHVyZSgpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlVGFyZ2V0LmlubmVySFRNTCA9IHRoaXMucmVuZGVyTWVzc2FnZSh0aGlzLmF0dGVzdGF0aW9uRmFpbHVyZU1lc3NhZ2VWYWx1ZSk7XG4gICAgfVxuXG4gICAgcmVuZGVyTWVzc2FnZShtZXNzYWdlLCB0eXBlKSB7XG4gICAgICAgIHR5cGUgPSB0eXBlID8/ICdlcnJvcic7XG5cbiAgICAgICAgcmV0dXJuIGA8cCBjbGFzcz1cInRsXyR7dHlwZX1cIj4ke21lc3NhZ2V9PC9wPmA7IFxuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBUd2lnRWRpdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgICAgIHRoaXMubmFtZSA9IGVsZW1lbnQuZGF0YXNldC5uYW1lO1xuICAgICAgICB0aGlzLnJlc291cmNlVXJsID0gZWxlbWVudC5kYXRhc2V0LnJlc291cmNlVXJsO1xuXG4gICAgICAgIHRoaXMuZWRpdG9yID0gYWNlLmVkaXQoZWxlbWVudCwge1xuICAgICAgICAgICAgbW9kZTogJ2FjZS9tb2RlL3R3aWcnLFxuICAgICAgICAgICAgbWF4TGluZXM6IDEwMCxcbiAgICAgICAgICAgIHdyYXA6IHRydWUsXG4gICAgICAgICAgICB1c2VTb2Z0VGFiczogZmFsc2UsXG4gICAgICAgICAgICBhdXRvU2Nyb2xsRWRpdG9ySW50b1ZpZXc6IHRydWUsXG4gICAgICAgICAgICByZWFkT25seTogZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3JlYWRvbmx5JyksXG4gICAgICAgICAgICBlbmFibGVMaXZlQXV0b2NvbXBsZXRpb246IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0Q29sb3JTY2hlbWUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQuY29sb3JTY2hlbWUpO1xuICAgICAgICB0aGlzLmVkaXRvci5jb250YWluZXIuc3R5bGUubGluZUhlaWdodCA9ICcxLjQ1JztcblxuICAgICAgICBjb25zdCB3aGl0ZXNwYWNlID0gYWNlLnJlcXVpcmUoJ2FjZS9leHQvd2hpdGVzcGFjZScpO1xuICAgICAgICB3aGl0ZXNwYWNlLmRldGVjdEluZGVudGF0aW9uKHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKSk7XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgY29tbWFuZHNcbiAgICAgICAgdGhpcy5lZGl0b3IuY29tbWFuZHMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBuYW1lOiAnbGVuczpibG9jay1pbmZvJyxcbiAgICAgICAgICAgIHJlYWRPbmx5OiB0cnVlLFxuICAgICAgICAgICAgZXhlYzogKGVkaXRvciwgYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRvci5jb250YWluZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KCd0d2lnLWVkaXRvcjpsZW5zOmJsb2NrLWluZm8nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrOiBhcmdzWzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmVkaXRvci5jb21tYW5kcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIG5hbWU6ICdsZW5zOmZvbGxvdycsXG4gICAgICAgICAgICByZWFkT25seTogdHJ1ZSxcbiAgICAgICAgICAgIGV4ZWM6IChlZGl0b3IsIGFyZ3MpID0+IHtcbiAgICAgICAgICAgICAgICBlZGl0b3IuY29udGFpbmVyLmRpc3BhdGNoRXZlbnQoXG4gICAgICAgICAgICAgICAgICAgIG5ldyBDdXN0b21FdmVudCgndHdpZy1lZGl0b3I6bGVuczpmb2xsb3cnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYXJnc1swXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTZXR1cCBjb2RlIGxlbnNlc1xuICAgICAgICB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkub25jZSgndG9rZW5pemVyVXBkYXRlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckNvZGVMZW5zUHJvdmlkZXIoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICByZWdpc3RlckNvZGVMZW5zUHJvdmlkZXIoKSB7XG4gICAgICAgIGNvbnN0IGNvZGVMZW5zID0gYWNlLnJlcXVpcmUoJ2FjZS9leHQvY29kZV9sZW5zJyk7XG5cbiAgICAgICAgY29kZUxlbnMucmVnaXN0ZXJDb2RlTGVuc1Byb3ZpZGVyKHRoaXMuZWRpdG9yLCB7XG4gICAgICAgICAgICBwcm92aWRlQ29kZUxlbnNlczogKHNlc3Npb24sIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHBheWxvYWQgPSBbXTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYW5hbHl6ZVJlZmVyZW5jZXMoKS5mb3JFYWNoKHJlZmVyZW5jZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydDoge3JvdzogcmVmZXJlbmNlLnJvdywgY29sdW1uOiByZWZlcmVuY2UuY29sdW1ufSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2xlbnM6Zm9sbG93JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcmVmZXJlbmNlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRzOiBbcmVmZXJlbmNlLm5hbWVdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFuYWx5emVCbG9ja3MoKS5mb3JFYWNoKGJsb2NrID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiB7cm93OiBibG9jay5yb3csIGNvbHVtbjogYmxvY2suY29sdW1ufSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2xlbnM6YmxvY2staW5mbycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGBCbG9jayBcIiR7YmxvY2submFtZX1cImAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRzOiBbYmxvY2submFtZV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHBheWxvYWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGFuYWx5emVSZWZlcmVuY2VzKCkge1xuICAgICAgICBsZXQgcmVmZXJlbmNlcyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5nZXRMZW5ndGgoKTsgcm93KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VucyA9IHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5nZXRUb2tlbnMocm93KTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodG9rZW5zW2ldLnR5cGUgPT09ICdtZXRhLnRhZy50d2lnJ1xuICAgICAgICAgICAgICAgICAgICAmJiAvXnslLT8kLy50ZXN0KHRva2Vuc1tpXS52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgJiYgdG9rZW5zW2kgKyAyXT8udHlwZSA9PT0gJ2tleXdvcmQuY29udHJvbC50d2lnJ1xuICAgICAgICAgICAgICAgICAgICAmJiBbJ2V4dGVuZHMnLCAndXNlJ10uaW5jbHVkZXModG9rZW5zW2kgKyAyXS52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgJiYgdG9rZW5zW2kgKyA0XT8udHlwZSA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHRva2Vuc1tpICsgNF0udmFsdWUucmVwbGFjZSgvW1wiJ10vZywgJycpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgvXkBDb250YW8oXy4rKT9cXC8vLnRlc3QobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZXMucHVzaCh7bmFtZSwgcm93LCBjb2x1bW46IHRva2Vuc1tpXS5zdGFydH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlZmVyZW5jZXM7XG4gICAgfVxuXG4gICAgYW5hbHl6ZUJsb2NrcygpIHtcbiAgICAgICAgbGV0IGJsb2NrcyA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5nZXRMZW5ndGgoKTsgcm93KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VucyA9IHRoaXMuZWRpdG9yLmdldFNlc3Npb24oKS5nZXRUb2tlbnMocm93KTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodG9rZW5zW2ldLnR5cGUgPT09ICdtZXRhLnRhZy50d2lnJ1xuICAgICAgICAgICAgICAgICAgICAmJiAvXnslLT8kLy50ZXN0KHRva2Vuc1tpXS52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgJiYgdG9rZW5zW2kgKyAyXT8udHlwZSA9PT0gJ2tleXdvcmQuY29udHJvbC50d2lnJ1xuICAgICAgICAgICAgICAgICAgICAmJiB0b2tlbnNbaSArIDJdLnZhbHVlID09PSAnYmxvY2snXG4gICAgICAgICAgICAgICAgICAgICYmIHRva2Vuc1tpICsgNF0/LnR5cGUgPT09ICdpZGVudGlmaWVyJ1xuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBibG9ja3MucHVzaCh7bmFtZTogdG9rZW5zW2kgKyA0XS52YWx1ZSwgcm93LCBjb2x1bW46IHRva2Vuc1tpXS5zdGFydH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBibG9ja3M7XG4gICAgfVxuXG4gICAgc2V0QW5ub3RhdGlvbnNEYXRhKGRhdGEpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IuY29tcGxldGVycyA9IFt7XG4gICAgICAgICAgICBnZXRDb21wbGV0aW9uczogZnVuY3Rpb24oZWRpdG9yLCBzZXNzaW9uLCBwb3MsIHByZWZpeCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmF1dG9jb21wbGV0ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9XTtcblxuICAgICAgICBpZiAoJ2Vycm9yJyBpbiBkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRvci5nZXRTZXNzaW9uKCkuc2V0QW5ub3RhdGlvbnMoW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcm93OiBkYXRhLmVycm9yLmxpbmUgLSAxLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBkYXRhLmVycm9yLnR5cGUgfHwgJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogYCAke2RhdGEuZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0Q29sb3JTY2hlbWUobW9kZSkge1xuICAgICAgICB0aGlzLmVkaXRvci5zZXRUaGVtZShtb2RlID09PSAnZGFyaycgPyAnYWNlL3RoZW1lL3R3aWxpZ2h0JyA6ICdhY2UvdGhlbWUvY2xvdWRzJyk7XG4gICAgfVxuXG4gICAgaXNFZGl0YWJsZSgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmVkaXRvci5nZXRSZWFkT25seSgpO1xuICAgIH1cblxuICAgIGdldENvbnRlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xuICAgIH1cblxuICAgIGZvY3VzKCkge1xuICAgICAgICB0aGlzLmVkaXRvci5mb2N1cygpO1xuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yLmRlc3Ryb3koKTtcbiAgICB9XG59XG4iLCIvKipcbiAqIFByb3ZpZGUgbWV0aG9kcyB0byBoYW5kbGUgQWpheCByZXF1ZXN0cy5cbiAqXG4gKiBAYXV0aG9yIExlbyBGZXllciA8aHR0cHM6Ly9naXRodWIuY29tL2xlb2ZleWVyPlxuICovXG53aW5kb3cuQWpheFJlcXVlc3QgPVxue1xuXHQvKipcblx0ICogVG9nZ2xlIHRoZSBuYXZpZ2F0aW9uIG1lbnVcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkICBUaGUgSUQgb2YgdGhlIG1lbnUgaXRlbVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBBamF4IFVSTFxuXHQgKlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICovXG5cdHRvZ2dsZU5hdmlnYXRpb246IGZ1bmN0aW9uKGVsLCBpZCwgdXJsKSB7XG5cdFx0aWYgKHdpbmRvdy5jb25zb2xlKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0FqYXhSZXF1ZXN0LnRvZ2dsZU5hdmlnYXRpb24oKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRoZSBzdGltdWx1cyBjb250cm9sbGVyIGluc3RlYWQuJyk7XG5cdFx0fVxuXG5cdFx0dmFyIGl0ZW0gPSAkKGlkKSxcblx0XHRcdHBhcmVudCA9ICQoZWwpLmdldFBhcmVudCgnbGknKTtcblxuXHRcdGlmIChpdGVtKSB7XG5cdFx0XHRpZiAocGFyZW50Lmhhc0NsYXNzKCdjb2xsYXBzZWQnKSkge1xuXHRcdFx0XHRwYXJlbnQucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgQ29udGFvLmxhbmcuY29sbGFwc2UpO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oeyB1cmw6IHVybCB9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlTmF2aWdhdGlvbicsICdpZCc6aWQsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwYXJlbnQuYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmV4cGFuZCk7XG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7IHVybDogdXJsIH0pLnBvc3QoeydhY3Rpb24nOid0b2dnbGVOYXZpZ2F0aW9uJywgJ2lkJzppZCwgJ3N0YXRlJzowLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSB0aGUgcGFnZSB0cmVlXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkICAgIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICogQHBhcmFtIHtpbnR9ICAgIGxldmVsIFRoZSBpbmRlbnRhdGlvbiBsZXZlbFxuXHQgKiBAcGFyYW0ge2ludH0gICAgbW9kZSAgVGhlIGluc2VydCBtb2RlXG5cdCAqXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxuXHQgKi9cblx0dG9nZ2xlU3RydWN0dXJlOiBmdW5jdGlvbihlbCwgaWQsIGxldmVsLCBtb2RlKSB7XG5cdFx0aWYgKHdpbmRvdy5jb25zb2xlKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0FqYXhSZXF1ZXN0LnRvZ2dsZVN0cnVjdHVyZSgpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgdGhlIHN0aW11bHVzIGNvbnRyb2xsZXIgaW5zdGVhZC4nKTtcblx0XHR9XG5cblx0XHRlbC5ibHVyKCk7XG5cblx0XHR2YXIgaXRlbSA9ICQoaWQpO1xuXG5cdFx0aWYgKGl0ZW0pIHtcblx0XHRcdGlmIChpdGVtLmdldFN0eWxlKCdkaXNwbGF5JykgPT0gJ25vbmUnKSB7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcblxuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOmVsfSkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZVN0cnVjdHVyZScsICdpZCc6aWQsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblxuXHRcdFx0XHQkKGVsKS5yZW1vdmVDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmV4cGFuZCk7XG5cblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtmaWVsZDplbH0pLnBvc3QoeydhY3Rpb24nOid0b2dnbGVTdHJ1Y3R1cmUnLCAnaWQnOmlkLCAnc3RhdGUnOjAsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7XG5cdFx0XHRmaWVsZDogZWwsXG5cdFx0XHRldmFsU2NyaXB0czogdHJ1ZSxcblx0XHRcdG9uUmVxdWVzdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmRpc3BsYXlCb3goQ29udGFvLmxhbmcubG9hZGluZyArICcg4oCmJyk7XG5cdFx0XHR9LFxuXHRcdFx0b25TdWNjZXNzOiBmdW5jdGlvbih0eHQpIHtcblx0XHRcdFx0dmFyIGxpID0gbmV3IEVsZW1lbnQoJ2xpJywge1xuXHRcdFx0XHRcdCdpZCc6IGlkLFxuXHRcdFx0XHRcdCdjbGFzcyc6ICdwYXJlbnQnLFxuXHRcdFx0XHRcdCdzdHlsZXMnOiB7XG5cdFx0XHRcdFx0XHQnZGlzcGxheSc6ICdpbmxpbmUnXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRuZXcgRWxlbWVudCgndWwnLCB7XG5cdFx0XHRcdFx0J2NsYXNzJzogJ2xldmVsXycgKyBsZXZlbCxcblx0XHRcdFx0XHQnaHRtbCc6IHR4dFxuXHRcdFx0XHR9KS5pbmplY3QobGksICdib3R0b20nKTtcblxuXHRcdFx0XHRpZiAobW9kZSA9PSA1KSB7XG5cdFx0XHRcdFx0bGkuaW5qZWN0KCQoZWwpLmdldFBhcmVudCgnbGknKSwgJ2FmdGVyJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmFyIGZvbGRlciA9IGZhbHNlLFxuXHRcdFx0XHRcdFx0cGFyZW50ID0gJChlbCkuZ2V0UGFyZW50KCdsaScpLFxuXHRcdFx0XHRcdFx0bmV4dDtcblxuXHRcdFx0XHRcdHdoaWxlICh0eXBlT2YocGFyZW50KSA9PSAnZWxlbWVudCcgJiYgKG5leHQgPSBwYXJlbnQuZ2V0TmV4dCgnbGknKSkpIHtcblx0XHRcdFx0XHRcdHBhcmVudCA9IG5leHQ7XG5cdFx0XHRcdFx0XHRpZiAocGFyZW50Lmhhc0NsYXNzKCd0bF9mb2xkZXInKSkge1xuXHRcdFx0XHRcdFx0XHRmb2xkZXIgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoZm9sZGVyKSB7XG5cdFx0XHRcdFx0XHRsaS5pbmplY3QocGFyZW50LCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGxpLmluamVjdChwYXJlbnQsICdhZnRlcicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFVwZGF0ZSB0aGUgcmVmZXJlciBJRFxuXHRcdFx0XHRsaS5nZXRFbGVtZW50cygnYScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0XHRlbC5ocmVmID0gZWwuaHJlZi5yZXBsYWNlKC8mcmVmPVthLWYwLTldKy8sICcmcmVmPScgKyBDb250YW8ucmVmZXJlcl9pZCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdCQoZWwpLmFkZENsYXNzKCdmb2xkYWJsZS0tb3BlbicpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgQ29udGFvLmxhbmcuY29sbGFwc2UpO1xuXG5cdFx0XHRcdHdpbmRvdy5maXJlRXZlbnQoJ3N0cnVjdHVyZScpO1xuXHRcdFx0XHRBamF4UmVxdWVzdC5oaWRlQm94KCk7XG5cblx0XHRcdFx0Ly8gSE9PS1xuXHRcdFx0XHR3aW5kb3cuZmlyZUV2ZW50KCdhamF4X2NoYW5nZScpO1xuICAgXHRcdFx0fVxuXHRcdH0pLnBvc3QoeydhY3Rpb24nOidsb2FkU3RydWN0dXJlJywgJ2lkJzppZCwgJ2xldmVsJzpsZXZlbCwgJ3N0YXRlJzoxLCAnUkVRVUVTVF9UT0tFTic6Q29udGFvLnJlcXVlc3RfdG9rZW59KTtcblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIHRoZSBmaWxlIHRyZWVcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsICAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkICAgICBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBmb2xkZXIgVGhlIGZvbGRlcidzIHBhdGhcblx0ICogQHBhcmFtIHtpbnR9ICAgIGxldmVsICBUaGUgaW5kZW50YXRpb24gbGV2ZWxcblx0ICpcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHR0b2dnbGVGaWxlTWFuYWdlcjogZnVuY3Rpb24oZWwsIGlkLCBmb2xkZXIsIGxldmVsKSB7XG5cdFx0aWYgKHdpbmRvdy5jb25zb2xlKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0FqYXhSZXF1ZXN0LnRvZ2dsZUZpbGVNYW5hZ2VyKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgc3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuXHRcdH1cblxuXHRcdGVsLmJsdXIoKTtcblxuXHRcdHZhciBpdGVtID0gJChpZCk7XG5cblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKGl0ZW0uZ2V0U3R5bGUoJ2Rpc3BsYXknKSA9PSAnbm9uZScpIHtcblx0XHRcdFx0aXRlbS5zZXRTdHlsZSgnZGlzcGxheScsIG51bGwpO1xuXG5cdFx0XHRcdCQoZWwpLmFkZENsYXNzKCdmb2xkYWJsZS0tb3BlbicpO1xuXHRcdFx0XHQkKGVsKS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgQ29udGFvLmxhbmcuY29sbGFwc2UpO1xuXG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7ZmllbGQ6ZWx9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlRmlsZU1hbmFnZXInLCAnaWQnOmlkLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aXRlbS5zZXRTdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cblx0XHRcdFx0JChlbCkucmVtb3ZlQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cdFx0XHRcdCQoZWwpLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBDb250YW8ubGFuZy5leHBhbmQpO1xuXG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7ZmllbGQ6ZWx9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlRmlsZU1hbmFnZXInLCAnaWQnOmlkLCAnc3RhdGUnOjAsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7XG5cdFx0XHRmaWVsZDogZWwsXG5cdFx0XHRldmFsU2NyaXB0czogdHJ1ZSxcblx0XHRcdG9uUmVxdWVzdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmRpc3BsYXlCb3goQ29udGFvLmxhbmcubG9hZGluZyArICcg4oCmJyk7XG5cdFx0XHR9LFxuXHRcdFx0b25TdWNjZXNzOiBmdW5jdGlvbih0eHQpIHtcblx0XHRcdFx0dmFyIGxpID0gbmV3IEVsZW1lbnQoJ2xpJywge1xuXHRcdFx0XHRcdCdpZCc6IGlkLFxuXHRcdFx0XHRcdCdjbGFzcyc6ICdwYXJlbnQnLFxuXHRcdFx0XHRcdCdzdHlsZXMnOiB7XG5cdFx0XHRcdFx0XHQnZGlzcGxheSc6ICdpbmxpbmUnXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRuZXcgRWxlbWVudCgndWwnLCB7XG5cdFx0XHRcdFx0J2NsYXNzJzogJ2xldmVsXycgKyBsZXZlbCxcblx0XHRcdFx0XHQnaHRtbCc6IHR4dFxuXHRcdFx0XHR9KS5pbmplY3QobGksICdib3R0b20nKTtcblxuXHRcdFx0XHRsaS5pbmplY3QoJChlbCkuZ2V0UGFyZW50KCdsaScpLCAnYWZ0ZXInKTtcblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHJlZmVyZXIgSURcblx0XHRcdFx0bGkuZ2V0RWxlbWVudHMoJ2EnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdFx0ZWwuaHJlZiA9IGVsLmhyZWYucmVwbGFjZSgvJnJlZj1bYS1mMC05XSsvLCAnJnJlZj0nICsgQ29udGFvLnJlZmVyZXJfaWQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblx0XHRcdFx0JChlbCkuc2V0QXR0cmlidXRlKCd0aXRsZScsIENvbnRhby5sYW5nLmNvbGxhcHNlKTtcblxuXHRcdFx0XHRBamF4UmVxdWVzdC5oaWRlQm94KCk7XG5cblx0XHRcdFx0Ly8gSE9PS1xuXHRcdFx0XHR3aW5kb3cuZmlyZUV2ZW50KCdhamF4X2NoYW5nZScpO1xuICAgXHRcdFx0fVxuXHRcdH0pLnBvc3QoeydhY3Rpb24nOidsb2FkRmlsZU1hbmFnZXInLCAnaWQnOmlkLCAnbGV2ZWwnOmxldmVsLCAnZm9sZGVyJzpmb2xkZXIsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSBzdWItcGFsZXR0ZXMgaW4gZWRpdCBtb2RlXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkICAgIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIFRoZSBmaWVsZCBuYW1lXG5cdCAqL1xuXHR0b2dnbGVTdWJwYWxldHRlOiBmdW5jdGlvbihlbCwgaWQsIGZpZWxkKSB7XG5cdFx0ZWwuYmx1cigpO1xuXHRcdHZhciBpdGVtID0gJChpZCk7XG5cblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKCFlbC52YWx1ZSkge1xuXHRcdFx0XHRlbC52YWx1ZSA9IDE7XG5cdFx0XHRcdGVsLmNoZWNrZWQgPSAnY2hlY2tlZCc7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCBudWxsKTtcblx0XHRcdFx0aXRlbS5nZXRFbGVtZW50cygnW2RhdGEtcmVxdWlyZWRdJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLnNldCgncmVxdWlyZWQnLCAnJykuc2V0KCdkYXRhLXJlcXVpcmVkJywgbnVsbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOiBlbCwgb25TdWNjZXNzOnVwZGF0ZVZlcnNpb25OdW1iZXJ9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbC52YWx1ZSA9ICcnO1xuXHRcdFx0XHRlbC5jaGVja2VkID0gJyc7XG5cdFx0XHRcdGl0ZW0uc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHRpdGVtLmdldEVsZW1lbnRzKCdbcmVxdWlyZWRdJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLnNldCgncmVxdWlyZWQnLCBudWxsKS5zZXQoJ2RhdGEtcmVxdWlyZWQnLCAnJyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oe2ZpZWxkOiBlbCwgb25TdWNjZXNzOnVwZGF0ZVZlcnNpb25OdW1iZXJ9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdzdGF0ZSc6MCwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0bmV3IFJlcXVlc3QuQ29udGFvKHtcblx0XHRcdGZpZWxkOiBlbCxcblx0XHRcdGV2YWxTY3JpcHRzOiBmYWxzZSxcblx0XHRcdG9uUmVxdWVzdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmRpc3BsYXlCb3goQ29udGFvLmxhbmcubG9hZGluZyArICcg4oCmJyk7XG5cdFx0XHR9LFxuXHRcdFx0b25TdWNjZXNzOiBmdW5jdGlvbih0eHQsIGpzb24pIHtcblx0XHRcdFx0dmFyIGRpdiA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdFx0J2lkJzogaWQsXG5cdFx0XHRcdFx0J2NsYXNzJzogJ3N1YnBhbCB3aWRnZXQtZ3JvdXAnLFxuXHRcdFx0XHRcdCdodG1sJzogdHh0XG5cdFx0XHRcdH0pLmluamVjdCgkKGVsKS5nZXRQYXJlbnQoJ2RpdicpLmdldFBhcmVudCgnZGl2JyksICdhZnRlcicpO1xuXG5cdFx0XHRcdC8vIEV4ZWN1dGUgc2NyaXB0cyBhZnRlciB0aGUgRE9NIGhhcyBiZWVuIHVwZGF0ZWRcblx0XHRcdFx0aWYgKGpzb24uamF2YXNjcmlwdCkge1xuXG5cdFx0XHRcdFx0Ly8gVXNlIEFzc2V0LmphdmFzY3JpcHQoKSBpbnN0ZWFkIG9mIGRvY3VtZW50LndyaXRlKCkgdG8gbG9hZCBhXG5cdFx0XHRcdFx0Ly8gSmF2YVNjcmlwdCBmaWxlIGFuZCByZS1leGVjdXRlIHRoZSBjb2RlIGFmdGVyIGl0IGhhcyBiZWVuIGxvYWRlZFxuXHRcdFx0XHRcdGRvY3VtZW50LndyaXRlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0XHRcdFx0XHR2YXIgc3JjID0gJyc7XG5cdFx0XHRcdFx0XHRzdHIucmVwbGFjZSgvPHNjcmlwdCBzcmM9XCIoW15cIl0rKVwiL2ksIGZ1bmN0aW9uKGFsbCwgbWF0Y2gpe1xuXHRcdFx0XHRcdFx0XHRzcmMgPSBtYXRjaDtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0c3JjICYmIEFzc2V0LmphdmFzY3JpcHQoc3JjLCB7XG5cdFx0XHRcdFx0XHRcdG9uTG9hZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0QnJvd3Nlci5leGVjKGpzb24uamF2YXNjcmlwdCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRCcm93c2VyLmV4ZWMoanNvbi5qYXZhc2NyaXB0KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGVsLnZhbHVlID0gMTtcblx0XHRcdFx0ZWwuY2hlY2tlZCA9ICdjaGVja2VkJztcblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHJlZmVyZXIgSURcblx0XHRcdFx0ZGl2LmdldEVsZW1lbnRzKCdhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRcdGVsLmhyZWYgPSBlbC5ocmVmLnJlcGxhY2UoLyZyZWY9W2EtZjAtOV0rLywgJyZyZWY9JyArIENvbnRhby5yZWZlcmVyX2lkKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dXBkYXRlVmVyc2lvbk51bWJlcih0eHQpO1xuXG5cdFx0XHRcdEFqYXhSZXF1ZXN0LmhpZGVCb3goKTtcblx0XHRcdFx0d2luZG93LmZpcmVFdmVudCgnYWpheF9jaGFuZ2UnKTtcblx0XHRcdH1cblx0XHR9KS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlU3VicGFsZXR0ZScsICdpZCc6aWQsICdmaWVsZCc6ZmllbGQsICdsb2FkJzoxLCAnc3RhdGUnOjEsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXG5cdFx0ZnVuY3Rpb24gdXBkYXRlVmVyc2lvbk51bWJlcihodG1sKSB7XG5cdFx0XHR2YXIgZmllbGRzID0gZWwuZm9ybS5lbGVtZW50cy5WRVJTSU9OX05VTUJFUiB8fCBbXTtcblx0XHRcdGlmICghZmllbGRzLmZvckVhY2gpIHtcblx0XHRcdFx0ZmllbGRzID0gW2ZpZWxkc107XG5cdFx0XHR9XG5cdFx0XHRmaWVsZHMuZm9yRWFjaChmdW5jdGlvbihmaWVsZCkge1xuXHRcdFx0XHRmaWVsZC52YWx1ZSA9IC88aW5wdXRcXHMrW14+XSo/bmFtZT1cIlZFUlNJT05fTlVNQkVSXCJcXHMrW14+XSo/dmFsdWU9XCIoW15cIl0qKVwiL2kuZXhlYyhodG1sKVsxXTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIHRoZSBzdGF0ZSBvZiBhIGNoZWNrYm94IGZpZWxkXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSAgZWwgICAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtib29sZWFufSByb3dJY29uIFdoZXRoZXIgdGhlIHJvdyBpY29uIHNob3VsZCBiZSB0b2dnbGVkIGFzIHdlbGxcblx0ICpcblx0ICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAqL1xuXHR0b2dnbGVGaWVsZDogZnVuY3Rpb24oZWwsIHJvd0ljb24pIHtcblx0XHRlbC5ibHVyKCk7XG5cblx0XHR2YXIgaW1nID0gbnVsbCxcblx0XHRcdGltYWdlcyA9ICQoZWwpLmdldEVsZW1lbnRzKCdpbWcnKSxcblx0XHRcdHB1Ymxpc2hlZCA9IChpbWFnZXNbMF0uZ2V0KCdkYXRhLXN0YXRlJykgPT0gMSksXG5cdFx0XHRkaXYgPSBlbC5nZXRQYXJlbnQoJ2RpdicpLFxuXHRcdFx0bmV4dCwgcGE7XG5cblx0XHRpZiAocm93SWNvbikge1xuXHRcdFx0Ly8gRmluZCB0aGUgaWNvbiBkZXBlbmRpbmcgb24gdGhlIHZpZXcgKHRyZWUgdmlldywgbGlzdCB2aWV3LCBwYXJlbnQgdmlldylcblx0XHRcdGlmIChkaXYuaGFzQ2xhc3MoJ3RsX3JpZ2h0JykpIHtcblx0XHRcdFx0aW1nID0gZGl2LmdldFByZXZpb3VzKCdkaXYnKS5nZXRFbGVtZW50cygnaW1nJyk7XG5cdFx0XHR9IGVsc2UgaWYgKGRpdi5oYXNDbGFzcygndGxfbGlzdGluZ19jb250YWluZXInKSkge1xuXHRcdFx0XHRpbWcgPSBlbC5nZXRQYXJlbnQoJ3RkJykuZ2V0UHJldmlvdXMoJ3RkJykuZ2V0Rmlyc3QoJ2Rpdi5saXN0X2ljb24nKTtcblx0XHRcdFx0aWYgKGltZyA9PT0gbnVsbCkgeyAvLyBjb21tZW50c1xuXHRcdFx0XHRcdGltZyA9IGVsLmdldFBhcmVudCgndGQnKS5nZXRQcmV2aW91cygndGQnKS5nZXRFbGVtZW50KCdkaXYuY3RlX3R5cGUnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaW1nID09PSBudWxsKSB7IC8vIHNob3dDb2x1bW5zXG5cdFx0XHRcdFx0aW1nID0gZWwuZ2V0UGFyZW50KCd0cicpLmdldEZpcnN0KCd0ZCcpLmdldEVsZW1lbnQoJ2Rpdi5saXN0X2ljb25fbmV3Jyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobmV4dCA9IGRpdi5nZXROZXh0KCdkaXYnKSkge1xuXHRcdFx0XHRpZiAobmV4dC5oYXNDbGFzcygnY3RlX3R5cGUnKSkge1xuXHRcdFx0XHRcdGltZyA9IG5leHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGltZyA9PT0gbnVsbCkgeyAvLyBuZXdzbGV0dGVyIHJlY2lwaWVudHNcblx0XHRcdFx0XHRpbWcgPSBuZXh0LmdldEZpcnN0KCdkaXYubGlzdF9pY29uJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hhbmdlIHRoZSByb3cgaWNvblxuXHRcdFx0aWYgKGltZyAhPT0gbnVsbCkge1xuXHRcdFx0XHQvLyBUcmVlIHZpZXdcblx0XHRcdFx0aWYgKCEoaW1nIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpICYmIGltZy5mb3JFYWNoKSB7XG5cdFx0XHRcdFx0aW1nLmZvckVhY2goKGltZykgPT4ge1xuXHRcdFx0XHRcdFx0aWYgKGltZy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09ICdpbWcnKSB7XG5cdFx0XHRcdFx0XHRcdGlmICghaW1nLmdldFBhcmVudCgndWwudGxfbGlzdGluZycpLmhhc0NsYXNzKCd0bF90cmVlX3h0bmQnKSkge1xuXHRcdFx0XHRcdFx0XHRcdHBhID0gaW1nLmdldFBhcmVudCgnYScpO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHBhICYmIHBhLmhyZWYuaW5kZXhPZignY29udGFvL3ByZXZpZXcnKSA9PSAtMSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG5leHQgPSBwYS5nZXROZXh0KCdhJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aW1nID0gbmV4dC5nZXRFbGVtZW50KCdpbWcnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGltZyA9IG5ldyBFbGVtZW50KCdpbWcnKTsgLy8gbm8gaWNvbnMgdXNlZCAoc2VlICMyMjg2KVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGNvbnN0IG5ld1NyYyA9ICFwdWJsaXNoZWQgPyBpbWcuZ2V0KCdkYXRhLWljb24nKSA6IGltZy5nZXQoJ2RhdGEtaWNvbi1kaXNhYmxlZCcpO1xuXHRcdFx0XHRcdFx0XHRpbWcuc3JjID0gKGltZy5zcmMuaW5jbHVkZXMoJy8nKSAmJiAhbmV3U3JjLmluY2x1ZGVzKCcvJykpID8gaW1nLnNyYy5zbGljZSgwLCBpbWcuc3JjLmxhc3RJbmRleE9mKCcvJykgKyAxKSArIG5ld1NyYyA6IG5ld1NyYztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIFBhcmVudCB2aWV3XG5cdFx0XHRcdGVsc2UgaWYgKGltZy5oYXNDbGFzcygnY3RlX3R5cGUnKSkge1xuXHRcdFx0XHRcdGlmICghcHVibGlzaGVkKSB7XG5cdFx0XHRcdFx0XHRpbWcuYWRkQ2xhc3MoJ3B1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdFx0aW1nLnJlbW92ZUNsYXNzKCd1bnB1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpbWcuYWRkQ2xhc3MoJ3VucHVibGlzaGVkJyk7XG5cdFx0XHRcdFx0XHRpbWcucmVtb3ZlQ2xhc3MoJ3B1Ymxpc2hlZCcpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBMaXN0IHZpZXdcblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0aW1nLnNldFN0eWxlKCdiYWNrZ3JvdW5kLWltYWdlJywgJ3VybCgnICsgKCFwdWJsaXNoZWQgPyBpbWcuZ2V0KCdkYXRhLWljb24nKSA6IGltZy5nZXQoJ2RhdGEtaWNvbi1kaXNhYmxlZCcpKSArICcpJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTZW5kIHJlcXVlc3Rcblx0XHRpbWFnZXMuZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xuXHRcdFx0Y29uc3QgbmV3U3JjID0gIXB1Ymxpc2hlZCA/IGltYWdlLmdldCgnZGF0YS1pY29uJykgOiBpbWFnZS5nZXQoJ2RhdGEtaWNvbi1kaXNhYmxlZCcpO1xuXHRcdFx0aW1hZ2Uuc3JjID0gKGltYWdlLnNyYy5pbmNsdWRlcygnLycpICYmICFuZXdTcmMuaW5jbHVkZXMoJy8nKSkgPyBpbWFnZS5zcmMuc2xpY2UoMCwgaW1hZ2Uuc3JjLmxhc3RJbmRleE9mKCcvJykgKyAxKSArIG5ld1NyYyA6IG5ld1NyYztcblx0XHRcdGltYWdlLmFsdCA9ICFwdWJsaXNoZWQgPyBpbWFnZS5nZXQoJ2RhdGEtYWx0JykgOiBpbWFnZS5nZXQoJ2RhdGEtYWx0LWRpc2FibGVkJyk7XG5cdFx0XHRpbWFnZS5zZXQoJ2RhdGEtc3RhdGUnLCAhcHVibGlzaGVkID8gMSA6IDApO1xuXHRcdH0pO1xuXG5cdFx0aWYgKCFwdWJsaXNoZWQgJiYgJChlbCkuZ2V0KCdkYXRhLXRpdGxlJykpIHtcblx0XHRcdGVsLnRpdGxlID0gJChlbCkuZ2V0KCdkYXRhLXRpdGxlJyk7XG5cdFx0fSBlbHNlIGlmIChwdWJsaXNoZWQgJiYgJChlbCkuZ2V0KCdkYXRhLXRpdGxlLWRpc2FibGVkJykpIHtcblx0XHRcdGVsLnRpdGxlID0gJChlbCkuZ2V0KCdkYXRhLXRpdGxlLWRpc2FibGVkJyk7XG5cdFx0fVxuXG5cdFx0bmV3IFJlcXVlc3QuQ29udGFvKHsndXJsJzplbC5ocmVmLCAnZm9sbG93UmVkaXJlY3RzJzpmYWxzZX0pLmdldCgpO1xuXG5cdFx0Ly8gUmV0dXJuIGZhbHNlIHRvIHN0b3AgdGhlIGNsaWNrIGV2ZW50IG9uIGxpbmtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSBhIGdyb3VwIG9mIGEgbXVsdGktY2hlY2tib3ggZmllbGRcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKlxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cblx0ICovXG5cdHRvZ2dsZUNoZWNrYm94R3JvdXA6IGZ1bmN0aW9uKGVsLCBpZCkge1xuXHRcdGVsLmJsdXIoKTtcblxuXHRcdHZhciBpdGVtID0gJChpZCk7XG5cblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKGl0ZW0uZ2V0U3R5bGUoJ2Rpc3BsYXknKSA9PSAnbm9uZScpIHtcblx0XHRcdFx0aXRlbS5zZXRTdHlsZSgnZGlzcGxheScsIG51bGwpO1xuXHRcdFx0XHQkKGVsKS5hZGRDbGFzcygnZm9sZGFibGUtLW9wZW4nKTtcblxuXHRcdFx0XHRuZXcgUmVxdWVzdC5Db250YW8oKS5wb3N0KHsnYWN0aW9uJzondG9nZ2xlQ2hlY2tib3hHcm91cCcsICdpZCc6aWQsICdzdGF0ZSc6MSwgJ1JFUVVFU1RfVE9LRU4nOkNvbnRhby5yZXF1ZXN0X3Rva2VufSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtLnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdFx0JChlbCkucmVtb3ZlQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJyk7XG5cblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKCkucG9zdCh7J2FjdGlvbic6J3RvZ2dsZUNoZWNrYm94R3JvdXAnLCAnaWQnOmlkLCAnc3RhdGUnOjAsICdSRVFVRVNUX1RPS0VOJzpDb250YW8ucmVxdWVzdF90b2tlbn0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBEaXNwbGF5IHRoZSBcImxvYWRpbmcgZGF0YVwiIG1lc3NhZ2Vcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdGV4dFxuXHQgKi9cblx0ZGlzcGxheUJveDogZnVuY3Rpb24obWVzc2FnZSkge1xuXHRcdHZhciBib3ggPSAkKCd0bF9hamF4Qm94JyksXG5cdFx0XHRvdmVybGF5ID0gJCgndGxfYWpheE92ZXJsYXknKSxcblx0XHRcdHNjcm9sbCA9IHdpbmRvdy5nZXRTY3JvbGwoKTtcblxuXHRcdGlmIChvdmVybGF5ID09PSBudWxsKSB7XG5cdFx0XHRvdmVybGF5ID0gbmV3IEVsZW1lbnQoJ2RpdicsIHtcblx0XHRcdFx0J2lkJzogJ3RsX2FqYXhPdmVybGF5J1xuXHRcdFx0fSkuaW5qZWN0KCQoZG9jdW1lbnQuYm9keSksICdib3R0b20nKTtcblx0XHR9XG5cblx0XHRvdmVybGF5LnNldCh7XG5cdFx0XHQnc3R5bGVzJzoge1xuXHRcdFx0XHQnZGlzcGxheSc6ICdibG9jaycsXG5cdFx0XHRcdCd0b3AnOiBzY3JvbGwueSArICdweCdcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGlmIChib3ggPT09IG51bGwpIHtcblx0XHRcdGJveCA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdCdpZCc6ICd0bF9hamF4Qm94J1xuXHRcdFx0fSkuaW5qZWN0KCQoZG9jdW1lbnQuYm9keSksICdib3R0b20nKTtcblx0XHR9XG5cblx0XHRib3guc2V0KHtcblx0XHRcdCdodG1sJzogbWVzc2FnZSxcblx0XHRcdCdzdHlsZXMnOiB7XG5cdFx0XHRcdCdkaXNwbGF5JzogJ2Jsb2NrJyxcblx0XHRcdFx0J3RvcCc6IChzY3JvbGwueSArIDEwMCkgKyAncHgnXG5cdFx0XHR9XG5cdFx0fSlcblx0fSxcblxuXHQvKipcblx0ICogSGlkZSB0aGUgXCJsb2FkaW5nIGRhdGFcIiBtZXNzYWdlXG5cdCAqL1xuXHRoaWRlQm94OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYm94ID0gJCgndGxfYWpheEJveCcpLFxuXHRcdFx0b3ZlcmxheSA9ICQoJ3RsX2FqYXhPdmVybGF5Jyk7XG5cblx0XHRpZiAob3ZlcmxheSkge1xuXHRcdFx0b3ZlcmxheS5zZXRTdHlsZSgnZGlzcGxheScsICdub25lJyk7XG5cdFx0fVxuXG5cdFx0aWYgKGJveCkge1xuXHRcdFx0Ym94LnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHR9XG5cdH1cbn07XG5cbi8qKlxuICogUHJvdmlkZSBtZXRob2RzIHRvIGhhbmRsZSBiYWNrIGVuZCB0YXNrcy5cbiAqXG4gKiBAYXV0aG9yIExlbyBGZXllciA8aHR0cHM6Ly9naXRodWIuY29tL2xlb2ZleWVyPlxuICovXG53aW5kb3cuQmFja2VuZCA9XG57XG5cdC8qKlxuXHQgKiBUaGUgY3VycmVudCBJRFxuXHQgKiBAbWVtYmVyIHsoc3RyaW5nfG51bGwpfVxuXHQgKi9cblx0Y3VycmVudElkOiBudWxsLFxuXG5cdC8qKlxuXHQgKiBUaGUgcG9wdXAgd2luZG93XG5cdCAqIEBtZW1iZXIge29iamVjdH1cblx0ICovXG5cdHBvcHVwV2luZG93OiBudWxsLFxuXG5cdC8qKlxuXHQgKiBUaGUgdGhlbWUgcGF0aFxuXHQgKiBAbWVtYmVyIHtzdHJpbmd9XG5cdCAqL1xuXHR0aGVtZVBhdGg6IENvbnRhby5zY3JpcHRfdXJsICsgJ3N5c3RlbS90aGVtZXMvJyArIENvbnRhby50aGVtZSArICcvJyxcblxuXHQvKipcblx0ICogT3BlbiBhIG1vZGFsIHdpbmRvd1xuXHQgKlxuXHQgKiBAcGFyYW0ge2ludH0gICAgd2lkdGggICBUaGUgd2lkdGggaW4gcGl4ZWxzXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0aXRsZSAgIFRoZSB3aW5kb3cncyB0aXRsZVxuXHQgKiBAcGFyYW0ge3N0cmluZ30gY29udGVudCBUaGUgd2luZG93J3MgY29udGVudFxuXHQgKi9cblx0b3Blbk1vZGFsV2luZG93OiBmdW5jdGlvbih3aWR0aCwgdGl0bGUsIGNvbnRlbnQpIHtcblx0XHRuZXcgU2ltcGxlTW9kYWwoe1xuXHRcdFx0J3dpZHRoJzogd2lkdGgsXG5cdFx0XHQnaGlkZUZvb3Rlcic6IHRydWUsXG5cdFx0XHQnZHJhZ2dhYmxlJzogZmFsc2UsXG5cdFx0XHQnb3ZlcmxheU9wYWNpdHknOiAuNyxcblx0XHRcdCdvdmVybGF5Q2xpY2snOiBmYWxzZSxcblx0XHRcdCdvblNob3cnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7IH0sXG5cdFx0XHQnb25IaWRlJzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2F1dG8nKTsgfVxuXHRcdH0pLnNob3coe1xuXHRcdFx0J3RpdGxlJzogdGl0bGUsXG5cdFx0XHQnY29udGVudHMnOiBjb250ZW50XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wZW4gYW4gaW1hZ2UgaW4gYSBtb2RhbCB3aW5kb3dcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9uYWwgb3B0aW9ucyBvYmplY3Rcblx0ICovXG5cdG9wZW5Nb2RhbEltYWdlOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dmFyIG9wdCA9IG9wdGlvbnMgfHwge30sXG5cdFx0XHRtYXhXaWR0aCA9ICh3aW5kb3cuZ2V0U2l6ZSgpLnggLSAyMCkudG9JbnQoKTtcblx0XHRpZiAoIW9wdC53aWR0aCB8fCBvcHQud2lkdGggPiBtYXhXaWR0aCkgb3B0LndpZHRoID0gTWF0aC5taW4obWF4V2lkdGgsIDkwMCk7XG5cdFx0dmFyIE0gPSBuZXcgU2ltcGxlTW9kYWwoe1xuXHRcdFx0J3dpZHRoJzogb3B0LndpZHRoLFxuXHRcdFx0J2hpZGVGb290ZXInOiB0cnVlLFxuXHRcdFx0J2RyYWdnYWJsZSc6IGZhbHNlLFxuXHRcdFx0J292ZXJsYXlPcGFjaXR5JzogLjcsXG5cdFx0XHQnb25TaG93JzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2hpZGRlbicpOyB9LFxuXHRcdFx0J29uSGlkZSc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdhdXRvJyk7IH1cblx0XHR9KTtcblx0XHRNLnNob3coe1xuXHRcdFx0J3RpdGxlJzogb3B0LnRpdGxlPy5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLzwvZywgJyZsdDsnKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykucmVwbGFjZSgvJy9nLCAnJmFwb3M7JyksXG5cdFx0XHQnY29udGVudHMnOiAnPGltZyBzcmM9XCInICsgb3B0LnVybCArICdcIiBhbHQ9XCJcIj4nXG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE9wZW4gYW4gaWZyYW1lIGluIGEgbW9kYWwgd2luZG93XG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0XG5cdCAqL1xuXHRvcGVuTW9kYWxJZnJhbWU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgb3B0ID0gb3B0aW9ucyB8fCB7fSxcblx0XHRcdG1heFdpZHRoID0gKHdpbmRvdy5nZXRTaXplKCkueCAtIDIwKS50b0ludCgpLFxuXHRcdFx0bWF4SGVpZ2h0ID0gKHdpbmRvdy5nZXRTaXplKCkueSAtIDEzNykudG9JbnQoKTtcblx0XHRpZiAoIW9wdC53aWR0aCB8fCBvcHQud2lkdGggPiBtYXhXaWR0aCkgb3B0LndpZHRoID0gTWF0aC5taW4obWF4V2lkdGgsIDkwMCk7XG5cdFx0aWYgKCFvcHQuaGVpZ2h0IHx8IG9wdC5oZWlnaHQgPiBtYXhIZWlnaHQpIG9wdC5oZWlnaHQgPSBtYXhIZWlnaHQ7XG5cdFx0dmFyIE0gPSBuZXcgU2ltcGxlTW9kYWwoe1xuXHRcdFx0J3dpZHRoJzogb3B0LndpZHRoLFxuXHRcdFx0J2hpZGVGb290ZXInOiB0cnVlLFxuXHRcdFx0J2RyYWdnYWJsZSc6IGZhbHNlLFxuXHRcdFx0J292ZXJsYXlPcGFjaXR5JzogLjcsXG5cdFx0XHQnb3ZlcmxheUNsaWNrJzogZmFsc2UsXG5cdFx0XHQnb25TaG93JzogZnVuY3Rpb24oKSB7IGRvY3VtZW50LmJvZHkuc2V0U3R5bGUoJ292ZXJmbG93JywgJ2hpZGRlbicpOyB9LFxuXHRcdFx0J29uSGlkZSc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdhdXRvJyk7IH1cblx0XHR9KTtcblx0XHRNLnNob3coe1xuXHRcdFx0J3RpdGxlJzogb3B0LnRpdGxlPy5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLzwvZywgJyZsdDsnKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykucmVwbGFjZSgvJy9nLCAnJmFwb3M7JyksXG5cdFx0XHQnY29udGVudHMnOiAnPGlmcmFtZSBzcmM9XCInICsgb3B0LnVybCArICdcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCInICsgb3B0LmhlaWdodCArICdcIiBmcmFtZWJvcmRlcj1cIjBcIj48L2lmcmFtZT4nLFxuXHRcdFx0J21vZGVsJzogJ21vZGFsJ1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBPcGVuIGEgc2VsZWN0b3IgcGFnZSBpbiBhIG1vZGFsIHdpbmRvd1xuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBBbiBvcHRpb25hbCBvcHRpb25zIG9iamVjdFxuXHQgKi9cblx0b3Blbk1vZGFsU2VsZWN0b3I6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgb3B0ID0gb3B0aW9ucyB8fCB7fSxcblx0XHRcdG1heFdpZHRoID0gKHdpbmRvdy5nZXRTaXplKCkueCAtIDIwKS50b0ludCgpLFxuXHRcdFx0bWF4SGVpZ2h0ID0gKHdpbmRvdy5nZXRTaXplKCkueSAtIDE5MikudG9JbnQoKTtcblx0XHRpZiAoIW9wdC5pZCkgb3B0LmlkID0gJ3RsX3NlbGVjdCc7XG5cdFx0aWYgKCFvcHQud2lkdGggfHwgb3B0LndpZHRoID4gbWF4V2lkdGgpIG9wdC53aWR0aCA9IE1hdGgubWluKG1heFdpZHRoLCA5MDApO1xuXHRcdGlmICghb3B0LmhlaWdodCB8fCBvcHQuaGVpZ2h0ID4gbWF4SGVpZ2h0KSBvcHQuaGVpZ2h0ID0gbWF4SGVpZ2h0O1xuXHRcdHZhciBNID0gbmV3IFNpbXBsZU1vZGFsKHtcblx0XHRcdCd3aWR0aCc6IG9wdC53aWR0aCxcblx0XHRcdCdkcmFnZ2FibGUnOiBmYWxzZSxcblx0XHRcdCdvdmVybGF5T3BhY2l0eSc6IC43LFxuXHRcdFx0J292ZXJsYXlDbGljayc6IGZhbHNlLFxuXHRcdFx0J29uU2hvdyc6IGZ1bmN0aW9uKCkgeyBkb2N1bWVudC5ib2R5LnNldFN0eWxlKCdvdmVyZmxvdycsICdoaWRkZW4nKTsgfSxcblx0XHRcdCdvbkhpZGUnOiBmdW5jdGlvbigpIHsgZG9jdW1lbnQuYm9keS5zZXRTdHlsZSgnb3ZlcmZsb3cnLCAnYXV0bycpOyB9XG5cdFx0fSk7XG5cdFx0TS5hZGRCdXR0b24oQ29udGFvLmxhbmcuY2FuY2VsLCAnYnRuJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodGhpcy5idXR0b25zWzBdLmhhc0NsYXNzKCdidG4tZGlzYWJsZWQnKSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmhpZGUoKTtcblx0XHR9KTtcblx0XHRNLmFkZEJ1dHRvbihDb250YW8ubGFuZy5hcHBseSwgJ2J0biBwcmltYXJ5JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodGhpcy5idXR0b25zWzFdLmhhc0NsYXNzKCdidG4tZGlzYWJsZWQnKSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR2YXIgZnJtID0gd2luZG93LmZyYW1lc1snc2ltcGxlLW1vZGFsLWlmcmFtZSddLFxuXHRcdFx0XHR2YWwgPSBbXSwgdWwsIGlucCwgaSwgcGlja2VyVmFsdWUsIHNJbmRleDtcblx0XHRcdGlmIChmcm0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRhbGVydCgnQ291bGQgbm90IGZpbmQgdGhlIFNpbXBsZU1vZGFsIGZyYW1lJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHVsID0gZnJtLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdC5pZCk7XG5cdFx0XHQvLyBMb2FkIHRoZSBwcmV2aW91cyB2YWx1ZXMgKCMxODE2KVxuXHRcdFx0aWYgKHBpY2tlclZhbHVlID0gdWwuZ2V0KCdkYXRhLXBpY2tlci12YWx1ZScpKSB7XG5cdFx0XHRcdHZhbCA9IEpTT04ucGFyc2UocGlja2VyVmFsdWUpO1xuXHRcdFx0fVxuXHRcdFx0aW5wID0gdWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2lucHV0Jyk7XG5cdFx0XHRmb3IgKGk9MDsgaTxpbnAubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKGlucFtpXS5pZC5tYXRjaCgvXihjaGVja19hbGxffHJlc2V0XykvKSkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIEFkZCBjdXJyZW50bHkgc2VsZWN0ZWQgdmFsdWUsIG90aGVyd2lzZSByZW1vdmUgKCMxODE2KVxuXHRcdFx0XHRzSW5kZXggPSB2YWwuaW5kZXhPZihpbnBbaV0uZ2V0KCd2YWx1ZScpKTtcblx0XHRcdFx0aWYgKGlucFtpXS5jaGVja2VkKSB7XG5cdFx0XHRcdFx0aWYgKHNJbmRleCA9PSAtMSkge1xuXHRcdFx0XHRcdFx0dmFsLnB1c2goaW5wW2ldLmdldCgndmFsdWUnKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2UgaWYgKHNJbmRleCAhPSAtMSkge1xuXHRcdFx0XHRcdHZhbC5zcGxpY2Uoc0luZGV4LCAxKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0b3B0LmNhbGxiYWNrKHVsLmdldCgnZGF0YS10YWJsZScpLCB2YWwpO1xuXHRcdFx0dGhpcy5oaWRlKCk7XG5cdFx0fSk7XG5cdFx0TS5zaG93KHtcblx0XHRcdCd0aXRsZSc6IG9wdC50aXRsZT8ucmVwbGFjZSgvJi9nLCAnJmFtcDsnKS5yZXBsYWNlKC88L2csICcmbHQ7JykucmVwbGFjZSgvXCIvZywgJyZxdW90OycpLnJlcGxhY2UoLycvZywgJyZhcG9zOycpLFxuXHRcdFx0J2NvbnRlbnRzJzogJzxpZnJhbWUgc3JjPVwiJyArIG9wdC51cmwgKyAnXCIgbmFtZT1cInNpbXBsZS1tb2RhbC1pZnJhbWVcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCInICsgb3B0LmhlaWdodCArICdcIiBmcmFtZWJvcmRlcj1cIjBcIj48L2lmcmFtZT4nLFxuXHRcdFx0J21vZGVsJzogJ21vZGFsJ1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBPcGVuIGEgVGlueU1DRSBmaWxlIGJyb3dzZXIgaW4gYSBtb2RhbCB3aW5kb3dcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkX25hbWUgVGhlIGZpZWxkIG5hbWVcblx0ICogQHBhcmFtIHtzdHJpbmd9IHVybCAgICAgICAgVGhlIFVSTFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAgICAgICBUaGUgcGlja2VyIHR5cGVcblx0ICogQHBhcmFtIHtvYmplY3R9IHdpbiAgICAgICAgVGhlIHdpbmRvdyBvYmplY3Rcblx0ICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZSAgICAgVGhlIHNvdXJjZSByZWNvcmRcblx0ICovXG5cdG9wZW5Nb2RhbEJyb3dzZXI6IGZ1bmN0aW9uKGZpZWxkX25hbWUsIHVybCwgdHlwZSwgd2luLCBzb3VyY2UpIHtcblx0XHRCYWNrZW5kLm9wZW5Nb2RhbFNlbGVjdG9yKHtcblx0XHRcdCdpZCc6ICd0bF9saXN0aW5nJyxcblx0XHRcdCd0aXRsZSc6IHdpbi5kb2N1bWVudC5nZXRFbGVtZW50KCdkaXYubWNlLXRpdGxlJykuZ2V0KCd0ZXh0JyksXG5cdFx0XHQndXJsJzogQ29udGFvLnJvdXRlcy5iYWNrZW5kX3BpY2tlciArICc/Y29udGV4dD0nICsgKHR5cGUgPT0gJ2ZpbGUnID8gJ2xpbmsnIDogJ2ZpbGUnKSArICcmYW1wO2V4dHJhc1tmaWVsZFR5cGVdPXJhZGlvJmFtcDtleHRyYXNbZmlsZXNPbmx5XT10cnVlJmFtcDtleHRyYXNbc291cmNlXT0nICsgc291cmNlICsgJyZhbXA7dmFsdWU9JyArIHVybCArICcmYW1wO3BvcHVwPTEnLFxuXHRcdFx0J2NhbGxiYWNrJzogZnVuY3Rpb24odGFibGUsIHZhbHVlKSB7XG5cdFx0XHRcdHdpbi5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChmaWVsZF9uYW1lKS52YWx1ZSA9IHZhbHVlLmpvaW4oJywnKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogQXV0b21hdGljYWxseSBzdWJtaXQgYSBmb3JtXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCBUaGUgRE9NIGVsZW1lbnRcblx0ICovXG5cdGF1dG9TdWJtaXQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXG5cdFx0dmFyIGhpZGRlbiA9IG5ldyBFbGVtZW50KCdpbnB1dCcsIHtcblx0XHRcdCd0eXBlJzogJ2hpZGRlbicsXG5cdFx0XHQnbmFtZSc6ICdTVUJNSVRfVFlQRScsXG5cdFx0XHQndmFsdWUnOiAnYXV0bydcblx0XHR9KTtcblxuXHRcdHZhciBmb3JtID0gJChlbCkgfHwgZWw7XG5cdFx0aGlkZGVuLmluamVjdChmb3JtLCAnYm90dG9tJyk7XG5cdFx0Zm9ybS5zdWJtaXQoKTtcblx0fSxcblxuXHQvKipcblx0ICogU2Nyb2xsIHRoZSB3aW5kb3cgdG8gYSBjZXJ0YWluIHZlcnRpY2FsIHBvc2l0aW9uXG5cdCAqXG5cdCAqIEBwYXJhbSB7aW50fSBvZmZzZXQgVGhlIG9mZnNldCB0byBzY3JvbGwgdG9cblx0ICovXG5cdHZTY3JvbGxUbzogZnVuY3Rpb24ob2Zmc2V0KSB7XG5cdFx0aWYgKHdpbmRvdy5jb25zb2xlKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oJ0JhY2tlbmQudlNjcm9sbFRvKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgU3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuXHRcdH1cblxuXHRcdHdpbmRvdy5hZGRFdmVudCgnbG9hZCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0d2luZG93LnNjcm9sbFRvKG51bGwsIHBhcnNlSW50KG9mZnNldCkpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUb2dnbGUgY2hlY2tib3hlc1xuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gZWwgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IFtpZF0gVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0dG9nZ2xlQ2hlY2tib3hlczogZnVuY3Rpb24oZWwsIGlkKSB7XG5cdFx0dmFyIGl0ZW1zID0gJCQoJ2lucHV0JyksXG5cdFx0XHRzdGF0dXMgPSAkKGVsKS5jaGVja2VkID8gJ2NoZWNrZWQnIDogJyc7XG5cblx0XHRmb3IgKHZhciBpPTA7IGk8aXRlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmIChpdGVtc1tpXS50eXBlLnRvTG93ZXJDYXNlKCkgIT0gJ2NoZWNrYm94Jykge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblx0XHRcdGlmIChpZCAhPT0gdW5kZWZpbmVkICYmIGlkICE9IGl0ZW1zW2ldLmlkLnN1YnN0cigwLCBpZC5sZW5ndGgpKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0aXRlbXNbaV0uY2hlY2tlZCA9IHN0YXR1cztcblx0XHR9XG5cdH0sXG5cblx0LyoqXG5cdCAqIFRvZ2dsZSBhIGNoZWNrYm94IGdyb3VwXG5cdCAqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBlbCBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICovXG5cdHRvZ2dsZUNoZWNrYm94R3JvdXA6IGZ1bmN0aW9uKGVsLCBpZCkge1xuXHRcdHZhciBjbHMgPSAkKGVsKS5jbGFzc05hbWUsXG5cdFx0XHRzdGF0dXMgPSAkKGVsKS5jaGVja2VkID8gJ2NoZWNrZWQnIDogJyc7XG5cblx0XHRpZiAoY2xzID09ICd0bF9jaGVja2JveCcpIHtcblx0XHRcdHZhciBjYnggPSAkKGlkKSA/ICQkKCcjJyArIGlkICsgJyAudGxfY2hlY2tib3gnKSA6ICQoZWwpLmdldFBhcmVudCgnZmllbGRzZXQnKS5nZXRFbGVtZW50cygnLnRsX2NoZWNrYm94Jyk7XG5cdFx0XHRjYnguZWFjaChmdW5jdGlvbihjaGVja2JveCkge1xuXHRcdFx0XHRjaGVja2JveC5jaGVja2VkID0gc3RhdHVzO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChjbHMgPT0gJ3RsX3RyZWVfY2hlY2tib3gnKSB7XG5cdFx0XHQkJCgnIycgKyBpZCArICcgLnBhcmVudCAudGxfdHJlZV9jaGVja2JveCcpLmVhY2goZnVuY3Rpb24oY2hlY2tib3gpIHtcblx0XHRcdFx0Y2hlY2tib3guY2hlY2tlZCA9IHN0YXR1cztcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0fSxcblxuXHQvKipcblx0ICogVG9nZ2xlIGNoZWNrYm94IGVsZW1lbnRzXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlbCAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBjbHMgVGhlIENTUyBjbGFzcyBuYW1lXG5cdCAqL1xuXHR0b2dnbGVDaGVja2JveEVsZW1lbnRzOiBmdW5jdGlvbihlbCwgY2xzKSB7XG5cdFx0dmFyIHN0YXR1cyA9ICQoZWwpLmNoZWNrZWQgPyAnY2hlY2tlZCcgOiAnJztcblxuXHRcdCQkKCcuJyArIGNscykuZWFjaChmdW5jdGlvbihjaGVja2JveCkge1xuXHRcdFx0aWYgKGNoZWNrYm94Lmhhc0NsYXNzKCd0bF9jaGVja2JveCcpKSB7XG5cdFx0XHRcdGNoZWNrYm94LmNoZWNrZWQgPSBzdGF0dXM7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIE1ha2UgcGFyZW50IHZpZXcgaXRlbXMgc29ydGFibGVcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IHVsIFRoZSBET00gZWxlbWVudFxuXHQgKlxuXHQgKiBAYXV0aG9yIEpvZSBSYXkgR3JlZ29yeVxuXHQgKiBAYXV0aG9yIE1hcnRpbiBBdXN3w7ZnZXJcblx0ICovXG5cdG1ha2VQYXJlbnRWaWV3U29ydGFibGU6IGZ1bmN0aW9uKHVsKSB7XG5cdFx0dmFyIGRzID0gbmV3IFNjcm9sbGVyKGRvY3VtZW50LmdldEVsZW1lbnQoJ2JvZHknKSwge1xuXHRcdFx0b25DaGFuZ2U6IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnNjcm9sbFRvKHRoaXMuZWxlbWVudC5nZXRTY3JvbGwoKS54LCB5KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHZhciBsaXN0ID0gbmV3IFNvcnRhYmxlcyh1bCwge1xuXHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0b3BhY2l0eTogMC42LFxuXHRcdFx0b25TdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRzLnN0YXJ0KCk7XG5cdFx0XHR9LFxuXHRcdFx0b25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRzLnN0b3AoKTtcblx0XHRcdH0sXG5cdFx0XHRvblNvcnQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdHZhciB1bCA9IGVsLmdldFBhcmVudCgndWwnKSxcblx0XHRcdFx0XHR3cmFwTGV2ZWwgPSAwLCBkaXZzLCBpO1xuXG5cdFx0XHRcdGlmICghdWwpIHJldHVybjtcblxuXHRcdFx0XHRkaXZzID0gdWwuZ2V0Q2hpbGRyZW4oJ2xpID4gZGl2OmZpcnN0LWNoaWxkJyk7XG5cblx0XHRcdFx0aWYgKCFkaXZzKSByZXR1cm47XG5cblx0XHRcdFx0Zm9yIChpPTA7IGk8ZGl2cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChkaXZzW2ldLmhhc0NsYXNzKCd3cmFwcGVyX3N0b3AnKSAmJiB3cmFwTGV2ZWwgPiAwKSB7XG5cdFx0XHRcdFx0XHR3cmFwTGV2ZWwtLTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRkaXZzW2ldLmNsYXNzTmFtZSA9IGRpdnNbaV0uY2xhc3NOYW1lLnJlcGxhY2UoLyhefFxccylpbmRlbnRbXlxcc10qL2csICcnKTtcblxuXHRcdFx0XHRcdGlmICh3cmFwTGV2ZWwgPiAwKSB7XG5cdFx0XHRcdFx0XHRkaXZzW2ldLmFkZENsYXNzKCdpbmRlbnQnKS5hZGRDbGFzcygnaW5kZW50XycgKyB3cmFwTGV2ZWwpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChkaXZzW2ldLmhhc0NsYXNzKCd3cmFwcGVyX3N0YXJ0JykpIHtcblx0XHRcdFx0XHRcdHdyYXBMZXZlbCsrO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRpdnNbaV0ucmVtb3ZlQ2xhc3MoJ2luZGVudF9maXJzdCcpO1xuXHRcdFx0XHRcdGRpdnNbaV0ucmVtb3ZlQ2xhc3MoJ2luZGVudF9sYXN0Jyk7XG5cblx0XHRcdFx0XHRpZiAoZGl2c1tpLTFdICYmIGRpdnNbaS0xXS5oYXNDbGFzcygnd3JhcHBlcl9zdGFydCcpKSB7XG5cdFx0XHRcdFx0XHRkaXZzW2ldLmFkZENsYXNzKCdpbmRlbnRfZmlyc3QnKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoZGl2c1tpKzFdICYmIGRpdnNbaSsxXS5oYXNDbGFzcygnd3JhcHBlcl9zdG9wJykpIHtcblx0XHRcdFx0XHRcdGRpdnNbaV0uYWRkQ2xhc3MoJ2luZGVudF9sYXN0Jyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0aGFuZGxlOiAnLmRyYWctaGFuZGxlJ1xuXHRcdH0pO1xuXG5cdFx0bGlzdC5hY3RpdmUgPSBmYWxzZTtcblxuXHRcdGxpc3QuYWRkRXZlbnQoJ3N0YXJ0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRsaXN0LmFjdGl2ZSA9IHRydWU7XG5cdFx0fSk7XG5cblx0XHRsaXN0LmFkZEV2ZW50KCdjb21wbGV0ZScsIGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRpZiAoIWxpc3QuYWN0aXZlKSByZXR1cm47XG5cdFx0XHR2YXIgaWQsIHBpZCwgcmVxLCBocmVmO1xuXG5cdFx0XHRpZiAoZWwuZ2V0UHJldmlvdXMoJ2xpJykpIHtcblx0XHRcdFx0aWQgPSBlbC5nZXQoJ2lkJykucmVwbGFjZSgvbGlfLywgJycpO1xuXHRcdFx0XHRwaWQgPSBlbC5nZXRQcmV2aW91cygnbGknKS5nZXQoJ2lkJykucmVwbGFjZSgvbGlfLywgJycpO1xuXHRcdFx0XHRyZXEgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnJlcGxhY2UoL2lkPVswLTldKi8sICdpZD0nICsgaWQpICsgJyZhY3Q9Y3V0Jm1vZGU9MSZwaWQ9JyArIHBpZDtcblx0XHRcdFx0aHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnJlcGxhY2UoL1xcPy4qJC8sICcnKTtcblx0XHRcdFx0bmV3IFJlcXVlc3QuQ29udGFvKHsndXJsJzpocmVmICsgcmVxLCAnZm9sbG93UmVkaXJlY3RzJzpmYWxzZX0pLmdldCgpO1xuXHRcdFx0fSBlbHNlIGlmIChlbC5nZXRQYXJlbnQoJ3VsJykpIHtcblx0XHRcdFx0aWQgPSBlbC5nZXQoJ2lkJykucmVwbGFjZSgvbGlfLywgJycpO1xuXHRcdFx0XHRwaWQgPSBlbC5nZXRQYXJlbnQoJ3VsJykuZ2V0KCdpZCcpLnJlcGxhY2UoL3VsXy8sICcnKTtcblx0XHRcdFx0cmVxID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5yZXBsYWNlKC9pZD1bMC05XSovLCAnaWQ9JyArIGlkKSArICcmYWN0PWN1dCZtb2RlPTImcGlkPScgKyBwaWQ7XG5cdFx0XHRcdGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5yZXBsYWNlKC9cXD8uKiQvLCAnJyk7XG5cdFx0XHRcdG5ldyBSZXF1ZXN0LkNvbnRhbyh7J3VybCc6aHJlZiArIHJlcSwgJ2ZvbGxvd1JlZGlyZWN0cyc6ZmFsc2V9KS5nZXQoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogTWFrZSBtdWx0aVNSQyBpdGVtcyBzb3J0YWJsZVxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICogQHBhcmFtIHtzdHJpbmd9IG9pZCBUaGUgb3JkZXIgZmllbGRcblx0ICogQHBhcmFtIHtzdHJpbmd9IHZhbCBUaGUgdmFsdWUgZmllbGRcblx0ICovXG5cdG1ha2VNdWx0aVNyY1NvcnRhYmxlOiBmdW5jdGlvbihpZCwgb2lkLCB2YWwpIHtcblx0XHR2YXIgbGlzdCA9IG5ldyBTb3J0YWJsZXMoJChpZCksIHtcblx0XHRcdGNvbnN0cmFpbjogdHJ1ZSxcblx0XHRcdG9wYWNpdHk6IDAuNlxuXHRcdH0pLmFkZEV2ZW50KCdjb21wbGV0ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGVscyA9IFtdLFxuXHRcdFx0XHRsaXMgPSAkKGlkKS5nZXRDaGlsZHJlbignW2RhdGEtaWRdJyksXG5cdFx0XHRcdGk7XG5cdFx0XHRmb3IgKGk9MDsgaTxsaXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0ZWxzLnB1c2gobGlzW2ldLmdldCgnZGF0YS1pZCcpKTtcblx0XHRcdH1cblx0XHRcdGlmIChvaWQgPT09IHZhbCkge1xuXHRcdFx0XHQkKHZhbCkudmFsdWUuc3BsaXQoJywnKS5mb3JFYWNoKGZ1bmN0aW9uKGopIHtcblx0XHRcdFx0XHRpZiAoZWxzLmluZGV4T2YoaikgPT09IC0xKSB7XG5cdFx0XHRcdFx0XHRlbHMucHVzaChqKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0JChvaWQpLnZhbHVlID0gZWxzLmpvaW4oJywnKTtcblx0XHR9KTtcblx0XHQkKGlkKS5nZXRFbGVtZW50cygnLmdpbWFnZScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdGlmIChlbC5oYXNDbGFzcygncmVtb3ZhYmxlJykpIHtcblx0XHRcdFx0bmV3IEVsZW1lbnQoJ2J1dHRvbicsIHtcblx0XHRcdFx0XHR0eXBlOiAnYnV0dG9uJyxcblx0XHRcdFx0XHRodG1sOiAnJnRpbWVzOycsXG5cdFx0XHRcdFx0J2NsYXNzJzogJ3RsX3JlZCdcblx0XHRcdFx0fSkuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIGxpID0gZWwuZ2V0UGFyZW50KCdsaScpLFxuXHRcdFx0XHRcdFx0ZGlkID0gbGkuZ2V0KCdkYXRhLWlkJyk7XG5cdFx0XHRcdFx0JCh2YWwpLnZhbHVlID0gJCh2YWwpLnZhbHVlLnNwbGl0KCcsJykuZmlsdGVyKGZ1bmN0aW9uKGopIHsgcmV0dXJuIGogIT0gZGlkOyB9KS5qb2luKCcsJyk7XG5cdFx0XHRcdFx0JChvaWQpLnZhbHVlID0gJChvaWQpLnZhbHVlLnNwbGl0KCcsJykuZmlsdGVyKGZ1bmN0aW9uKGopIHsgcmV0dXJuIGogIT0gZGlkOyB9KS5qb2luKCcsJyk7XG5cdFx0XHRcdFx0bGkuZGlzcG9zZSgpO1xuXHRcdFx0XHR9KS5pbmplY3QoZWwsICdhZnRlcicpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmV3IEVsZW1lbnQoJ2J1dHRvbicsIHtcblx0XHRcdFx0XHR0eXBlOiAnYnV0dG9uJyxcblx0XHRcdFx0XHRodG1sOiAnJnRpbWVzJyxcblx0XHRcdFx0XHRkaXNhYmxlZDogdHJ1ZVxuXHRcdFx0XHR9KS5pbmplY3QoZWwsICdhZnRlcicpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdGxpc3QuZmlyZUV2ZW50KFwiY29tcGxldGVcIik7IC8vIEluaXRpYWwgc29ydGluZ1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBFbmFibGUgZHJhZyBhbmQgZHJvcCBmb3IgdGhlIGZpbGUgdHJlZVxuXHQgKlxuXHQgKiBAcGFyYW0ge29iamVjdH0gdWwgICAgICBUaGUgRE9NIGVsZW1lbnRcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9uYWwgb3B0aW9ucyBvYmplY3Rcblx0ICovXG5cdGVuYWJsZUZpbGVUcmVlRHJhZ0FuZERyb3A6IGZ1bmN0aW9uKHVsLCBvcHRpb25zKSB7XG5cdFx0dmFyIGRzID0gbmV3IFNjcm9sbGVyKGRvY3VtZW50LmdldEVsZW1lbnQoJ2JvZHknKSwge1xuXHRcdFx0b25DaGFuZ2U6IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHRcdFx0dGhpcy5lbGVtZW50LnNjcm9sbFRvKHRoaXMuZWxlbWVudC5nZXRTY3JvbGwoKS54LCB5KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHVsLmFkZEV2ZW50KCdtb3VzZWRvd24nLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0dmFyIGRyYWdIYW5kbGUgPSBldmVudC50YXJnZXQuaGFzQ2xhc3MoJ2RyYWctaGFuZGxlJykgPyBldmVudC50YXJnZXQgOiBldmVudC50YXJnZXQuZ2V0UGFyZW50KCcuZHJhZy1oYW5kbGUnKTtcblx0XHRcdHZhciBkcmFnRWxlbWVudCA9IGV2ZW50LnRhcmdldC5nZXRQYXJlbnQoJy50bF9maWxlLC50bF9mb2xkZXInKTtcblxuXHRcdFx0aWYgKCFkcmFnSGFuZGxlIHx8ICFkcmFnRWxlbWVudCB8fCBldmVudC5yaWdodENsaWNrKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0ZHMuc3RhcnQoKTtcblx0XHRcdHVsLmFkZENsYXNzKCd0bF9saXN0aW5nX2RyYWdnaW5nJyk7XG5cblx0XHRcdHZhciBjbG9uZUJhc2UgPSAoZHJhZ0VsZW1lbnQuZ2V0RWxlbWVudHMoJy50bF9sZWZ0JylbMF0gfHwgZHJhZ0VsZW1lbnQpLFxuXHRcdFx0XHRjbG9uZSA9IGNsb25lQmFzZS5jbG9uZSh0cnVlKVxuXHRcdFx0XHRcdC5pbmplY3QodWwpXG5cdFx0XHRcdFx0LmFkZENsYXNzKCd0bF9sZWZ0X2RyYWdnaW5nJyksXG5cdFx0XHRcdGN1cnJlbnRIb3ZlciwgY3VycmVudEhvdmVyVGltZSwgZXhwYW5kTGluaztcblxuXHRcdFx0Y2xvbmUuc2V0UG9zaXRpb24oe1xuXHRcdFx0XHR4OiBldmVudC5wYWdlLnggLSBjbG9uZUJhc2UuZ2V0T2Zmc2V0UGFyZW50KCkuZ2V0UG9zaXRpb24oKS54IC0gY2xvbmUuZ2V0U2l6ZSgpLngsXG5cdFx0XHRcdHk6IGNsb25lQmFzZS5nZXRQb3NpdGlvbihjbG9uZUJhc2UuZ2V0T2Zmc2V0UGFyZW50KCkpLnlcblx0XHRcdH0pLnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblxuXHRcdFx0dmFyIG1vdmUgPSBuZXcgRHJhZy5Nb3ZlKGNsb25lLCB7XG5cdFx0XHRcdGRyb3BwYWJsZXM6ICQkKFt1bF0pLmFwcGVuZCh1bC5nZXRFbGVtZW50cygnLnRsX2ZvbGRlcixsaS5wYXJlbnQsLnRsX2ZvbGRlcl90b3AnKSksXG5cdFx0XHRcdHVuRHJhZ2dhYmxlVGFnczogW10sXG5cdFx0XHRcdG1vZGlmaWVyczoge1xuXHRcdFx0XHRcdHg6ICdsZWZ0Jyxcblx0XHRcdFx0XHR5OiAndG9wJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRvblN0YXJ0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjbG9uZS5zZXRTdHlsZSgnZGlzcGxheScsICcnKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0b25FbnRlcjogZnVuY3Rpb24oZWxlbWVudCwgZHJvcHBhYmxlKSB7XG5cdFx0XHRcdFx0ZHJvcHBhYmxlID0gZml4RHJvcHBhYmxlKGRyb3BwYWJsZSk7XG5cdFx0XHRcdFx0ZHJvcHBhYmxlLmFkZENsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblxuXHRcdFx0XHRcdGlmIChkcm9wcGFibGUuaGFzQ2xhc3MoJ3RsX2ZvbGRlcicpICYmIGN1cnJlbnRIb3ZlciAhPT0gZHJvcHBhYmxlKSB7XG5cdFx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSBkcm9wcGFibGU7XG5cdFx0XHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdFx0XHRcdFx0XHRleHBhbmRMaW5rID0gZHJvcHBhYmxlLmdldEVsZW1lbnQoJ2EuZm9sZGFibGUnKTtcblxuXHRcdFx0XHRcdFx0aWYgKGV4cGFuZExpbmsgJiYgIWV4cGFuZExpbmsuaGFzQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJykpIHtcblx0XHRcdFx0XHRcdFx0Ly8gRXhwYW5kIHRoZSBmb2xkZXIgYWZ0ZXIgb25lIHNlY29uZCBob3ZlciB0aW1lXG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRIb3ZlciA9PT0gZHJvcHBhYmxlICYmIGN1cnJlbnRIb3ZlclRpbWUgKyA5MDAgPCBuZXcgRGF0ZSgpLmdldFRpbWUoKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcblx0XHRcdFx0XHRcdFx0XHRcdGV2ZW50LmluaXRFdmVudCgnY2xpY2snLCB0cnVlLCB0cnVlKTtcblx0XHRcdFx0XHRcdFx0XHRcdGV4cGFuZExpbmsuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cblx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRIb3ZlciA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cblx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5hZGRFdmVudCgnYWpheF9jaGFuZ2UnLCBmdW5jdGlvbiBvbkFqYXgoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChtb3ZlICYmIG1vdmUuZHJvcHBhYmxlcyAmJiB1bCAmJiB1bC5nZXRFbGVtZW50cykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdG1vdmUuZHJvcHBhYmxlcyA9ICQkKFt1bF0pLmFwcGVuZCh1bC5nZXRFbGVtZW50cygnLnRsX2ZvbGRlcixsaS5wYXJlbnQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LnJlbW92ZUV2ZW50KCdhamF4X2NoYW5nZScsIG9uQWpheCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0sIDEwMDApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSxcblx0XHRcdFx0b25DYW5jZWw6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlciA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdFx0ZHMuc3RvcCgpO1xuXHRcdFx0XHRcdGNsb25lLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR3aW5kb3cucmVtb3ZlRXZlbnQoJ2tleXVwJywgb25LZXl1cCk7XG5cdFx0XHRcdFx0dWwuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXJfZHJvcHBpbmcnKS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHRcdFx0dWwucmVtb3ZlQ2xhc3MoJ3RsX2xpc3RpbmdfZHJhZ2dpbmcnKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0b25Ecm9wOiBmdW5jdGlvbihlbGVtZW50LCBkcm9wcGFibGUpIHtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IHVuZGVmaW5lZDtcblxuXHRcdFx0XHRcdGRzLnN0b3AoKTtcblx0XHRcdFx0XHRjbG9uZS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0d2luZG93LnJlbW92ZUV2ZW50KCdrZXl1cCcsIG9uS2V5dXApO1xuXHRcdFx0XHRcdHVsLmdldEVsZW1lbnRzKCcudGxfZm9sZGVyX2Ryb3BwaW5nJykucmVtb3ZlQ2xhc3MoJ3RsX2ZvbGRlcl9kcm9wcGluZycpO1xuXHRcdFx0XHRcdHVsLnJlbW92ZUNsYXNzKCd0bF9saXN0aW5nX2RyYWdnaW5nJyk7XG5cblx0XHRcdFx0XHRkcm9wcGFibGUgPSBmaXhEcm9wcGFibGUoZHJvcHBhYmxlKTtcblxuXHRcdFx0XHRcdGlmICghZHJvcHBhYmxlKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGlkID0gZHJhZ0VsZW1lbnQuZ2V0KCdkYXRhLWlkJyksXG5cdFx0XHRcdFx0XHRwaWQgPSBkcm9wcGFibGUuZ2V0KCdkYXRhLWlkJykgfHwgZGVjb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMudXJsLnNwbGl0KC9bPyZdcGlkPS8pWzFdLnNwbGl0KCcmJylbMF0pO1xuXG5cdFx0XHRcdFx0Ly8gSWdub3JlIGludmFsaWQgbW92ZSBvcGVyYXRpb25zXG5cdFx0XHRcdFx0aWYgKGlkICYmIHBpZCAmJiAoKHBpZCsnLycpLmluZGV4T2YoaWQrJy8nKSA9PT0gMCB8fCBwaWQrJy8nID09PSBpZC5yZXBsYWNlKC9bXi9dKyQvLCAnJykpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBvcHRpb25zLnVybCArICcmaWQ9JyArIGVuY29kZVVSSUNvbXBvbmVudChpZCkgKyAnJnBpZD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHBpZCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uTGVhdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIGRyb3BwYWJsZSkge1xuXHRcdFx0XHRcdGRyb3BwYWJsZSA9IGZpeERyb3BwYWJsZShkcm9wcGFibGUpO1xuXHRcdFx0XHRcdGRyb3BwYWJsZS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRtb3ZlLnN0YXJ0KGV2ZW50KTtcblx0XHRcdHdpbmRvdy5hZGRFdmVudCgna2V5dXAnLCBvbktleXVwKTtcblxuXHRcdFx0ZnVuY3Rpb24gb25LZXl1cChldmVudCkge1xuXHRcdFx0XHRpZiAoZXZlbnQua2V5ID09PSAnZXNjJyAmJiBtb3ZlICYmIG1vdmUuc3RvcCkge1xuXHRcdFx0XHRcdG1vdmUuZHJvcHBhYmxlcyA9ICQkKFtdKTtcblx0XHRcdFx0XHRtb3ZlLnN0b3AoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZnVuY3Rpb24gZml4RHJvcHBhYmxlKGRyb3BwYWJsZSkge1xuXHRcdFx0aWYgKGRyb3BwYWJsZSAmJiBkcm9wcGFibGUuaGFzQ2xhc3MoJ3BhcmVudCcpICYmIGRyb3BwYWJsZS5nZXRQcmV2aW91cygnLnRsX2ZvbGRlcicpKSB7XG5cdFx0XHRcdHJldHVybiBkcm9wcGFibGUuZ2V0UHJldmlvdXMoJy50bF9mb2xkZXInKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGRyb3BwYWJsZTtcblx0XHR9XG5cdH0sXG5cblx0LyoqXG5cdCAqIExpc3Qgd2l6YXJkXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHRsaXN0V2l6YXJkOiBmdW5jdGlvbihpZCkge1xuXHRcdHZhciB1bCA9ICQoaWQpLFxuXHRcdFx0bWFrZVNvcnRhYmxlID0gZnVuY3Rpb24odWwpIHtcblx0XHRcdFx0bmV3IFNvcnRhYmxlcyh1bCwge1xuXHRcdFx0XHRcdGNvbnN0cmFpbjogdHJ1ZSxcblx0XHRcdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRcdFx0aGFuZGxlOiAnLmRyYWctaGFuZGxlJ1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRhZGRFdmVudHNUbyA9IGZ1bmN0aW9uKGxpKSB7XG5cdFx0XHRcdHZhciBjb21tYW5kLCBjbG9uZSwgaW5wdXQsIHByZXZpb3VzLCBuZXh0O1xuXG5cdFx0XHRcdGxpLmdldEVsZW1lbnRzKCdidXR0b24nKS5lYWNoKGZ1bmN0aW9uKGJ0KSB7XG5cdFx0XHRcdFx0aWYgKGJ0Lmhhc0V2ZW50KCdjbGljaycpKSByZXR1cm47XG5cdFx0XHRcdFx0Y29tbWFuZCA9IGJ0LmdldFByb3BlcnR5KCdkYXRhLWNvbW1hbmQnKTtcblxuXHRcdFx0XHRcdHN3aXRjaCAoY29tbWFuZCkge1xuXHRcdFx0XHRcdFx0Y2FzZSAnY29weSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRjbG9uZSA9IGxpLmNsb25lKHRydWUpLmluamVjdChsaSwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChpbnB1dCA9IGxpLmdldEZpcnN0KCdpbnB1dCcpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjbG9uZS5nZXRGaXJzdCgnaW5wdXQnKS52YWx1ZSA9IGlucHV0LnZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRhZGRFdmVudHNUbyhjbG9uZSk7XG5cdFx0XHRcdFx0XHRcdFx0aW5wdXQuc2VsZWN0KCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2RlbGV0ZSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodWwuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRsaS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlIG51bGw6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMzgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChwcmV2aW91cyA9IGxpLmdldFByZXZpb3VzKCdsaScpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpLmluamVjdChwcmV2aW91cywgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGkuaW5qZWN0KHVsLCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZS5ldmVudC5rZXlDb2RlID09IDQwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobmV4dCA9IGxpLmdldE5leHQoJ2xpJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGkuaW5qZWN0KG5leHQsICdhZnRlcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGkuaW5qZWN0KHVsLmdldEZpcnN0KCdsaScpLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9O1xuXG5cdFx0bWFrZVNvcnRhYmxlKHVsKTtcblxuXHRcdHVsLmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbihsaSkge1xuXHRcdFx0YWRkRXZlbnRzVG8obGkpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBUYWJsZSB3aXphcmRcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICovXG5cdHRhYmxlV2l6YXJkOiBmdW5jdGlvbihpZCkge1xuXHRcdHZhciB0YWJsZSA9ICQoaWQpLFxuXHRcdFx0dGhlYWQgPSB0YWJsZS5nZXRFbGVtZW50KCd0aGVhZCcpLFxuXHRcdFx0dGJvZHkgPSB0YWJsZS5nZXRFbGVtZW50KCd0Ym9keScpLFxuXHRcdFx0bWFrZVNvcnRhYmxlID0gZnVuY3Rpb24odGJvZHkpIHtcblx0XHRcdFx0dmFyIHJvd3MgPSB0Ym9keS5nZXRDaGlsZHJlbigpLFxuXHRcdFx0XHRcdHRleHRhcmVhLCBjaGlsZHJlbiwgaSwgajtcblxuXHRcdFx0XHRmb3IgKGk9MDsgaTxyb3dzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Y2hpbGRyZW4gPSByb3dzW2ldLmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0Zm9yIChqPTA7IGo8Y2hpbGRyZW4ubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdGlmICh0ZXh0YXJlYSA9IGNoaWxkcmVuW2pdLmdldEZpcnN0KCd0ZXh0YXJlYScpKSB7XG5cdFx0XHRcdFx0XHRcdHRleHRhcmVhLm5hbWUgPSB0ZXh0YXJlYS5uYW1lLnJlcGxhY2UoL1xcW1swLTldK11bWzAtOV0rXS9nLCAnWycgKyBpICsgJ11bJyArIGogKyAnXScpXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bmV3IFNvcnRhYmxlcyh0Ym9keSwge1xuXHRcdFx0XHRcdGNvbnN0cmFpbjogdHJ1ZSxcblx0XHRcdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRcdFx0aGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcblx0XHRcdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRhZGRFdmVudHNUbyA9IGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRcdHZhciBoZWFkID0gdGhlYWQuZ2V0Rmlyc3QoJ3RyJyksXG5cdFx0XHRcdFx0Y29tbWFuZCwgdGV4dGFyZWEsIGN1cnJlbnQsIG5leHQsIG50ciwgY2hpbGRyZW4sIGluZGV4LCBpO1xuXG5cdFx0XHRcdHRyLmdldEVsZW1lbnRzKCdidXR0b24nKS5lYWNoKGZ1bmN0aW9uKGJ0KSB7XG5cdFx0XHRcdFx0aWYgKGJ0Lmhhc0V2ZW50KCdjbGljaycpKSByZXR1cm47XG5cdFx0XHRcdFx0Y29tbWFuZCA9IGJ0LmdldFByb3BlcnR5KCdkYXRhLWNvbW1hbmQnKTtcblxuXHRcdFx0XHRcdHN3aXRjaCAoY29tbWFuZCkge1xuXHRcdFx0XHRcdFx0Y2FzZSAncmNvcHknOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0bnRyID0gbmV3IEVsZW1lbnQoJ3RyJyk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0ci5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXh0ID0gY2hpbGRyZW5baV0uY2xvbmUodHJ1ZSkuaW5qZWN0KG50ciwgJ2JvdHRvbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRleHRhcmVhID0gY2hpbGRyZW5baV0uZ2V0Rmlyc3QoJ3RleHRhcmVhJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmV4dC5nZXRGaXJzdCgndGV4dGFyZWEnKS52YWx1ZSA9IHRleHRhcmVhLnZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRudHIuaW5qZWN0KHRyLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRhZGRFdmVudHNUbyhudHIpO1xuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0bnRyLmdldEZpcnN0KCd0ZCcpLmdldEZpcnN0KCd0ZXh0YXJlYScpLnNlbGVjdCgpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdyZGVsZXRlJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0Ym9keS5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnY2NvcHknOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aW5kZXggPSBnZXRJbmRleChidCk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0Ym9keS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gY2hpbGRyZW5baV0uZ2V0Q2hpbGRyZW4oKVtpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXh0ID0gY3VycmVudC5jbG9uZSh0cnVlKS5pbmplY3QoY3VycmVudCwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGV4dGFyZWEgPSBjdXJyZW50LmdldEZpcnN0KCd0ZXh0YXJlYScpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG5leHQuZ2V0Rmlyc3QoJ3RleHRhcmVhJykudmFsdWUgPSB0ZXh0YXJlYS52YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGFkZEV2ZW50c1RvKG5leHQpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR2YXIgaGVhZEZpcnN0ID0gaGVhZC5nZXRGaXJzdCgndGQnKTtcblx0XHRcdFx0XHRcdFx0XHRuZXh0ID0gaGVhZEZpcnN0LmNsb25lKHRydWUpLmluamVjdChoZWFkLmdldExhc3QoJ3RkJyksICdiZWZvcmUnKTtcblx0XHRcdFx0XHRcdFx0XHRhZGRFdmVudHNUbyhuZXh0KTtcblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuWzBdLmdldENoaWxkcmVuKClbaW5kZXggKyAxXS5nZXRGaXJzdCgndGV4dGFyZWEnKS5zZWxlY3QoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnY21vdmVsJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGluZGV4ID0gZ2V0SW5kZXgoYnQpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoaW5kZXggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gY2hpbGRyZW5baV0uZ2V0Q2hpbGRyZW4oKVtpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQuaW5qZWN0KGN1cnJlbnQuZ2V0UHJldmlvdXMoKSwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gY2hpbGRyZW5baV0uZ2V0Q2hpbGRyZW4oKVtpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQuaW5qZWN0KGNoaWxkcmVuW2ldLmdldExhc3QoKSwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdjbW92ZXInOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aW5kZXggPSBnZXRJbmRleChidCk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0Ym9keS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChpbmRleCA8ICh0ci5nZXRDaGlsZHJlbigpLmxlbmd0aCAtIDIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gY2hpbGRyZW5baV0uZ2V0Q2hpbGRyZW4oKVtpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnQuaW5qZWN0KGN1cnJlbnQuZ2V0TmV4dCgpLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudCA9IGNoaWxkcmVuW2ldLmdldENoaWxkcmVuKClbaW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50LmluamVjdChjaGlsZHJlbltpXS5nZXRGaXJzdCgpLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2NkZWxldGUnOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aW5kZXggPSBnZXRJbmRleChidCk7XG5cdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW4gPSB0Ym9keS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0ci5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAoaT0wOyBpPGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuW2ldLmdldENoaWxkcmVuKClbaW5kZXhdLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGhlYWQuZ2V0Rmlyc3QoJ3RkJykuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlIG51bGw6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMzgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChudHIgPSB0ci5nZXRQcmV2aW91cygndHInKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QobnRyLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QodGJvZHksICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZS5ldmVudC5rZXlDb2RlID09IDQwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobnRyID0gdHIuZ2V0TmV4dCgndHInKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QobnRyLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdCh0Ym9keSwgJ3RvcCcpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRnZXRJbmRleCA9IGZ1bmN0aW9uKGJ0KSB7XG5cdFx0XHRcdHZhciB0ZCA9ICQoYnQpLmdldFBhcmVudCgndGQnKSxcblx0XHRcdFx0XHR0ciA9IHRkLmdldFBhcmVudCgndHInKSxcblx0XHRcdFx0XHRjb2xzID0gdHIuZ2V0Q2hpbGRyZW4oKSxcblx0XHRcdFx0XHRpbmRleCA9IDAsIGk7XG5cblx0XHRcdFx0Zm9yIChpPTA7IGk8Y29scy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChjb2xzW2ldID09IHRkKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBpbmRleDtcblx0XHRcdH07XG5cblx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXG5cdFx0dGhlYWQuZ2V0Q2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRhZGRFdmVudHNUbyh0cik7XG5cdFx0fSk7XG5cblx0XHR0Ym9keS5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24odHIpIHtcblx0XHRcdGFkZEV2ZW50c1RvKHRyKTtcblx0XHR9KTtcblxuXHRcdEJhY2tlbmQudGFibGVXaXphcmRSZXNpemUoKTtcblx0fSxcblxuXHQvKipcblx0ICogUmVzaXplIHRoZSB0YWJsZSB3aXphcmQgZmllbGRzIG9uIGZvY3VzXG5cdCAqXG5cdCAqIEBwYXJhbSB7ZmxvYXR9IFtmYWN0b3JdIFRoZSByZXNpemUgZmFjdG9yXG5cdCAqL1xuXHR0YWJsZVdpemFyZFJlc2l6ZTogZnVuY3Rpb24oZmFjdG9yKSB7XG5cdFx0dmFyIHNpemUgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NvbnRhb190YWJsZV93aXphcmRfY2VsbF9zaXplJyk7XG5cblx0XHRpZiAoZmFjdG9yICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHNpemUgPSAnJztcblx0XHRcdCQkKCcudGxfdGFibGV3aXphcmQgdGV4dGFyZWEnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdGVsLnNldFN0eWxlKCd3aWR0aCcsIChlbC5nZXRTdHlsZSgnd2lkdGgnKS50b0ludCgpICogZmFjdG9yKS5yb3VuZCgpLmxpbWl0KDE0MiwgMjg0KSk7XG5cdFx0XHRcdGVsLnNldFN0eWxlKCdoZWlnaHQnLCAoZWwuZ2V0U3R5bGUoJ2hlaWdodCcpLnRvSW50KCkgKiBmYWN0b3IpLnJvdW5kKCkubGltaXQoNjYsIDEzMikpO1xuXHRcdFx0XHRpZiAoc2l6ZSA9PSAnJykge1xuXHRcdFx0XHRcdHNpemUgPSBlbC5nZXRTdHlsZSgnd2lkdGgnKSArICd8JyArIGVsLmdldFN0eWxlKCdoZWlnaHQnKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NvbnRhb190YWJsZV93aXphcmRfY2VsbF9zaXplJywgc2l6ZSk7XG5cdFx0fSBlbHNlIGlmIChzaXplICE9PSBudWxsKSB7XG5cdFx0XHR2YXIgY2h1bmtzID0gc2l6ZS5zcGxpdCgnfCcpO1xuXHRcdFx0JCQoJy50bF90YWJsZXdpemFyZCB0ZXh0YXJlYScpLmVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0ZWwuc2V0U3R5bGUoJ3dpZHRoJywgY2h1bmtzWzBdKTtcblx0XHRcdFx0ZWwuc2V0U3R5bGUoJ2hlaWdodCcsIGNodW5rc1sxXSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0sXG5cblx0LyoqXG5cdCAqIFNldCB0aGUgd2lkdGggb2YgdGhlIHRhYmxlIHdpemFyZFxuXHQgKi9cblx0dGFibGVXaXphcmRTZXRXaWR0aDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHdyYXAgPSAkKCd0bF90YWJsZXdpemFyZCcpO1xuXHRcdGlmICghd3JhcCkgcmV0dXJuO1xuXHRcdHdyYXAuc2V0U3R5bGUoJ3dpZHRoJywgTWF0aC5yb3VuZCh3cmFwLmdldFBhcmVudCgnLnRsX2Zvcm1ib2R5X2VkaXQnKS5nZXRDb21wdXRlZFNpemUoKS53aWR0aCAqIDAuOTYpKTtcblx0fSxcblxuXHQvKipcblx0ICogT3B0aW9ucyB3aXphcmRcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJRCBvZiB0aGUgdGFyZ2V0IGVsZW1lbnRcblx0ICovXG5cdG9wdGlvbnNXaXphcmQ6IGZ1bmN0aW9uKGlkKSB7XG5cdFx0dmFyIHRhYmxlID0gJChpZCksXG5cdFx0XHR0Ym9keSA9IHRhYmxlLmdldEVsZW1lbnQoJ3Rib2R5JyksXG5cdFx0XHRtYWtlU29ydGFibGUgPSBmdW5jdGlvbih0Ym9keSkge1xuXHRcdFx0XHR2YXIgcm93cyA9IHRib2R5LmdldENoaWxkcmVuKCksXG5cdFx0XHRcdFx0Y2hpbGRyZW4sIGksIGosIGlucHV0O1xuXG5cdFx0XHRcdGZvciAoaT0wOyBpPHJvd3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRjaGlsZHJlbiA9IHJvd3NbaV0uZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRmb3IgKGo9MDsgajxjaGlsZHJlbi5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0aWYgKGlucHV0ID0gY2hpbGRyZW5bal0uZ2V0Rmlyc3QoJ2lucHV0JykpIHtcblx0XHRcdFx0XHRcdFx0aW5wdXQubmFtZSA9IGlucHV0Lm5hbWUucmVwbGFjZSgvXFxbWzAtOV0rXS9nLCAnWycgKyBpICsgJ10nKTtcblx0XHRcdFx0XHRcdFx0aWYgKGlucHV0LnR5cGUgPT0gJ2NoZWNrYm94Jykge1xuXHRcdFx0XHRcdFx0XHRcdGlucHV0LmlkID0gaW5wdXQubmFtZS5yZXBsYWNlKC9cXFtbMC05XStdL2csICcnKS5yZXBsYWNlKC9cXFsvZywgJ18nKS5yZXBsYWNlKC9dL2csICcnKSArICdfJyArIGk7XG5cdFx0XHRcdFx0XHRcdFx0aW5wdXQuZ2V0TmV4dCgnbGFiZWwnKS5zZXQoJ2ZvcicsIGlucHV0LmlkKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG5ldyBTb3J0YWJsZXModGJvZHksIHtcblx0XHRcdFx0XHRjb25zdHJhaW46IHRydWUsXG5cdFx0XHRcdFx0b3BhY2l0eTogMC42LFxuXHRcdFx0XHRcdGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG5cdFx0XHRcdFx0b25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0YWRkRXZlbnRzVG8gPSBmdW5jdGlvbih0cikge1xuXHRcdFx0XHR2YXIgY29tbWFuZCwgaW5wdXQsIG5leHQsIG50ciwgY2hpbGRyZW4sIGk7XG5cdFx0XHRcdHRyLmdldEVsZW1lbnRzKCdidXR0b24nKS5lYWNoKGZ1bmN0aW9uKGJ0KSB7XG5cdFx0XHRcdFx0aWYgKGJ0Lmhhc0V2ZW50KCdjbGljaycpKSByZXR1cm47XG5cdFx0XHRcdFx0Y29tbWFuZCA9IGJ0LmdldFByb3BlcnR5KCdkYXRhLWNvbW1hbmQnKTtcblxuXHRcdFx0XHRcdHN3aXRjaCAoY29tbWFuZCkge1xuXHRcdFx0XHRcdFx0Y2FzZSAnY29weSc6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHRcdFx0XHRcdFx0XHRudHIgPSBuZXcgRWxlbWVudCgndHInKTtcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbiA9IHRyLmdldENoaWxkcmVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yIChpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdG5leHQgPSBjaGlsZHJlbltpXS5jbG9uZSh0cnVlKS5pbmplY3QobnRyLCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoaW5wdXQgPSBjaGlsZHJlbltpXS5nZXRGaXJzdCgnaW5wdXQnKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRuZXh0LmdldEZpcnN0KCdpbnB1dCcpLnZhbHVlID0gaW5wdXQudmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChpbnB1dC50eXBlID09ICdjaGVja2JveCcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRuZXh0LmdldEZpcnN0KCdpbnB1dCcpLmNoZWNrZWQgPSBpbnB1dC5jaGVja2VkID8gJ2NoZWNrZWQnIDogJyc7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bnRyLmluamVjdCh0ciwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0YWRkRXZlbnRzVG8obnRyKTtcblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdG50ci5nZXRGaXJzdCgndGQnKS5nZXRGaXJzdCgnaW5wdXQnKS5zZWxlY3QoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnZGVsZXRlJzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0Ym9keS5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSBudWxsOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZS5ldmVudC5rZXlDb2RlID09IDM4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobnRyID0gdHIuZ2V0UHJldmlvdXMoJ3RyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KG50ciwgJ2JlZm9yZScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KHRib2R5LCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRidC5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGUuZXZlbnQua2V5Q29kZSA9PSA0MCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG50ciA9IHRyLmdldE5leHQoJ3RyJykpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHIuaW5qZWN0KG50ciwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QodGJvZHksICd0b3AnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9O1xuXG5cdFx0bWFrZVNvcnRhYmxlKHRib2R5KTtcblxuXHRcdHRib2R5LmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbih0cikge1xuXHRcdFx0YWRkRXZlbnRzVG8odHIpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBLZXkvdmFsdWUgd2l6YXJkXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSUQgb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqL1xuXHRrZXlWYWx1ZVdpemFyZDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgdGFibGUgPSAkKGlkKSxcblx0XHRcdHRib2R5ID0gdGFibGUuZ2V0RWxlbWVudCgndGJvZHknKSxcblx0XHRcdG1ha2VTb3J0YWJsZSA9IGZ1bmN0aW9uKHRib2R5KSB7XG5cdFx0XHRcdHZhciByb3dzID0gdGJvZHkuZ2V0Q2hpbGRyZW4oKSxcblx0XHRcdFx0XHRjaGlsZHJlbiwgaSwgaiwgaW5wdXQ7XG5cblx0XHRcdFx0Zm9yIChpPTA7IGk8cm93cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGNoaWxkcmVuID0gcm93c1tpXS5nZXRDaGlsZHJlbigpO1xuXHRcdFx0XHRcdGZvciAoaj0wOyBqPGNoaWxkcmVuLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0XHRpZiAoaW5wdXQgPSBjaGlsZHJlbltqXS5nZXRGaXJzdCgnaW5wdXQnKSkge1xuXHRcdFx0XHRcdFx0XHRpbnB1dC5uYW1lID0gaW5wdXQubmFtZS5yZXBsYWNlKC9cXFtbMC05XStdL2csICdbJyArIGkgKyAnXScpXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bmV3IFNvcnRhYmxlcyh0Ym9keSwge1xuXHRcdFx0XHRcdGNvbnN0cmFpbjogdHJ1ZSxcblx0XHRcdFx0XHRvcGFjaXR5OiAwLjYsXG5cdFx0XHRcdFx0aGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcblx0XHRcdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRhZGRFdmVudHNUbyA9IGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRcdHZhciBjb21tYW5kLCBpbnB1dCwgbmV4dCwgbnRyLCBjaGlsZHJlbiwgaTtcblx0XHRcdFx0dHIuZ2V0RWxlbWVudHMoJ2J1dHRvbicpLmVhY2goZnVuY3Rpb24oYnQpIHtcblx0XHRcdFx0XHRpZiAoYnQuaGFzRXZlbnQoJ2NsaWNrJykpIHJldHVybjtcblx0XHRcdFx0XHRjb21tYW5kID0gYnQuZ2V0UHJvcGVydHkoJ2RhdGEtY29tbWFuZCcpO1xuXG5cdFx0XHRcdFx0c3dpdGNoIChjb21tYW5kKSB7XG5cdFx0XHRcdFx0XHRjYXNlICdjb3B5Jzpcblx0XHRcdFx0XHRcdFx0YnQuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0JykpO1xuXHRcdFx0XHRcdFx0XHRcdG50ciA9IG5ldyBFbGVtZW50KCd0cicpO1xuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuID0gdHIuZ2V0Q2hpbGRyZW4oKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGk9MDsgaTxjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0bmV4dCA9IGNoaWxkcmVuW2ldLmNsb25lKHRydWUpLmluamVjdChudHIsICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChpbnB1dCA9IGNoaWxkcmVuW2ldLmdldEZpcnN0KCdpbnB1dCcpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG5leHQuZ2V0Rmlyc3QoKS52YWx1ZSA9IGlucHV0LnZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRudHIuaW5qZWN0KHRyLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRhZGRFdmVudHNUbyhudHIpO1xuXHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0bnRyLmdldEZpcnN0KCd0ZCcpLmdldEZpcnN0KCdpbnB1dCcpLnNlbGVjdCgpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdkZWxldGUnOlxuXHRcdFx0XHRcdFx0XHRidC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N0b3JlLXNjcm9sbC1vZmZzZXQnKSk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRib2R5LmdldENoaWxkcmVuKCkubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dHIuZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlIG51bGw6XG5cdFx0XHRcdFx0XHRcdGJ0LmFkZEV2ZW50KCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMzgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChudHIgPSB0ci5nZXRQcmV2aW91cygndHInKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QobnRyLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QodGJvZHksICdib3R0b20nKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGJ0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZS5ldmVudC5rZXlDb2RlID09IDQwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobnRyID0gdHIuZ2V0TmV4dCgndHInKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ci5pbmplY3QobnRyLCAnYWZ0ZXInKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyLmluamVjdCh0Ym9keSwgJ3RvcCcpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdG1ha2VTb3J0YWJsZSh0Ym9keSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH07XG5cblx0XHRtYWtlU29ydGFibGUodGJvZHkpO1xuXG5cdFx0dGJvZHkuZ2V0Q2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKHRyKSB7XG5cdFx0XHRhZGRFdmVudHNUbyh0cik7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqXG5cdCAqIENoZWNrYm94IHdpemFyZFxuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElEIG9mIHRoZSB0YXJnZXQgZWxlbWVudFxuXHQgKi9cblx0Y2hlY2tib3hXaXphcmQ6IGZ1bmN0aW9uKGlkKSB7XG5cdFx0dmFyIGNvbnRhaW5lciA9ICQoaWQpLmdldEVsZW1lbnQoJy5zb3J0YWJsZScpLFxuXHRcdFx0bWFrZVNvcnRhYmxlID0gZnVuY3Rpb24oY29udGFpbmVyKSB7XG5cdFx0XHRcdG5ldyBTb3J0YWJsZXMoY29udGFpbmVyLCB7XG5cdFx0XHRcdFx0Y29uc3RyYWluOiB0cnVlLFxuXHRcdFx0XHRcdG9wYWNpdHk6IDAuNixcblx0XHRcdFx0XHRoYW5kbGU6ICcuZHJhZy1oYW5kbGUnXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdGFkZEV2ZW50c1RvID0gZnVuY3Rpb24oc3Bhbikge1xuXHRcdFx0XHR2YXIgbnNwYW47XG5cdFx0XHRcdHNwYW4uZ2V0RWxlbWVudHMoJ2J1dHRvbicpLmVhY2goZnVuY3Rpb24oYnQpIHtcblx0XHRcdFx0XHRpZiAoYnQuaGFzRXZlbnQoJ2NsaWNrJykpIHJldHVybjtcblx0XHRcdFx0XHRidC5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMzgpIHtcblx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRpZiAoKG5zcGFuID0gc3Bhbi5nZXRQcmV2aW91cygnc3BhbicpKSkge1xuXHRcdFx0XHRcdFx0XHRcdHNwYW4uaW5qZWN0KG5zcGFuLCAnYmVmb3JlJyk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0c3Bhbi5pbmplY3QoY29udGFpbmVyLCAnYm90dG9tJyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZS5ldmVudC5rZXlDb2RlID09IDQwKSB7XG5cdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0aWYgKG5zcGFuID0gc3Bhbi5nZXROZXh0KCdzcGFuJykpIHtcblx0XHRcdFx0XHRcdFx0XHRzcGFuLmluamVjdChuc3BhbiwgJ2FmdGVyJyk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0c3Bhbi5pbmplY3QoY29udGFpbmVyLCAndG9wJyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0YnQuZm9jdXMoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9O1xuXG5cdFx0bWFrZVNvcnRhYmxlKGNvbnRhaW5lcik7XG5cblx0XHRjb250YWluZXIuZ2V0Q2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKHNwYW4pIHtcblx0XHRcdGFkZEV2ZW50c1RvKHNwYW4pO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBVcGRhdGUgdGhlIGZpZWxkcyBvZiB0aGUgaW1hZ2VTaXplIHdpZGdldCB1cG9uIGNoYW5nZVxuXHQgKi9cblx0ZW5hYmxlSW1hZ2VTaXplV2lkZ2V0czogZnVuY3Rpb24oKSB7XG5cdFx0JCQoJy50bF9pbWFnZV9zaXplJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0dmFyIHNlbGVjdCA9IGVsLmdldEVsZW1lbnQoJ3NlbGVjdCcpLFxuXHRcdFx0XHR3aWR0aElucHV0ID0gZWwuZ2V0Q2hpbGRyZW4oJ2lucHV0JylbMF0sXG5cdFx0XHRcdGhlaWdodElucHV0ID0gZWwuZ2V0Q2hpbGRyZW4oJ2lucHV0JylbMV0sXG5cdFx0XHRcdHVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmIChzZWxlY3QuZ2V0KCd2YWx1ZScpID09PSAnJyB8fCBzZWxlY3QuZ2V0KCd2YWx1ZScpLmluZGV4T2YoJ18nKSA9PT0gMCB8fCBzZWxlY3QuZ2V0KCd2YWx1ZScpLnRvSW50KCkudG9TdHJpbmcoKSA9PT0gc2VsZWN0LmdldCgndmFsdWUnKSkge1xuXHRcdFx0XHRcdFx0d2lkdGhJbnB1dC5yZWFkT25seSA9IHRydWU7XG5cdFx0XHRcdFx0XHRoZWlnaHRJbnB1dC5yZWFkT25seSA9IHRydWU7XG5cdFx0XHRcdFx0XHR2YXIgZGltZW5zaW9ucyA9ICQoc2VsZWN0LmdldFNlbGVjdGVkKClbMF0pLmdldCgndGV4dCcpO1xuXHRcdFx0XHRcdFx0ZGltZW5zaW9ucyA9IGRpbWVuc2lvbnMuc3BsaXQoJygnKS5sZW5ndGggPiAxXG5cdFx0XHRcdFx0XHRcdD8gZGltZW5zaW9ucy5zcGxpdCgnKCcpLmdldExhc3QoKS5zcGxpdCgnKScpWzBdLnNwbGl0KCd4Jylcblx0XHRcdFx0XHRcdFx0OiBbJycsICcnXTtcblx0XHRcdFx0XHRcdHdpZHRoSW5wdXQuc2V0KCd2YWx1ZScsICcnKS5zZXQoJ3BsYWNlaG9sZGVyJywgZGltZW5zaW9uc1swXSAqIDEgfHwgJycpO1xuXHRcdFx0XHRcdFx0aGVpZ2h0SW5wdXQuc2V0KCd2YWx1ZScsICcnKS5zZXQoJ3BsYWNlaG9sZGVyJywgZGltZW5zaW9uc1sxXSAqIDEgfHwgJycpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR3aWR0aElucHV0LnNldCgncGxhY2Vob2xkZXInLCAnJyk7XG5cdFx0XHRcdFx0XHRoZWlnaHRJbnB1dC5zZXQoJ3BsYWNlaG9sZGVyJywgJycpO1xuXHRcdFx0XHRcdFx0d2lkdGhJbnB1dC5yZWFkT25seSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0aGVpZ2h0SW5wdXQucmVhZE9ubHkgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdDtcblxuXHRcdFx0dXBkYXRlKCk7XG5cdFx0XHRzZWxlY3QuYWRkRXZlbnQoJ2NoYW5nZScsIHVwZGF0ZSk7XG5cdFx0XHRzZWxlY3QuYWRkRXZlbnQoJ2tleXVwJywgdXBkYXRlKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogQWxsb3cgdG9nZ2xpbmcgY2hlY2tib3hlcyBvciByYWRpbyBidXR0b25zIGJ5IGNsaWNraW5nIGEgcm93XG5cdCAqXG5cdCAqIEBhdXRob3IgS2FtaWwgS3V6bWluc2tpXG5cdCAqL1xuXHRlbmFibGVUb2dnbGVTZWxlY3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjb250YWluZXIgPSAkKCd0bF9saXN0aW5nJyksXG5cdFx0XHRzaGlmdFRvZ2dsZSA9IGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdHRoaXNJbmRleCA9IGNoZWNrYm94ZXMuaW5kZXhPZihlbCk7XG5cdFx0XHRcdHN0YXJ0SW5kZXggPSBjaGVja2JveGVzLmluZGV4T2Yoc3RhcnQpO1xuXHRcdFx0XHRmcm9tID0gTWF0aC5taW4odGhpc0luZGV4LCBzdGFydEluZGV4KTtcblx0XHRcdFx0dG8gPSBNYXRoLm1heCh0aGlzSW5kZXgsIHN0YXJ0SW5kZXgpO1xuXHRcdFx0XHRzdGF0dXMgPSAhIWNoZWNrYm94ZXNbc3RhcnRJbmRleF0uY2hlY2tlZDtcblxuXHRcdFx0XHRmb3IgKGZyb207IGZyb208PXRvOyBmcm9tKyspIHtcblx0XHRcdFx0XHRjaGVja2JveGVzW2Zyb21dLmNoZWNrZWQgPSBzdGF0dXM7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRjbGlja0V2ZW50ID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0XHR2YXIgaW5wdXQgPSB0aGlzLmdldEVsZW1lbnQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXSxpbnB1dFt0eXBlPVwicmFkaW9cIl0nKSxcblx0XHRcdFx0XHRsaW1pdFRvZ2dsZXIgPSAkKGUudGFyZ2V0KS5nZXRQYXJlbnQoJy5saW1pdF90b2dnbGVyJyk7XG5cblx0XHRcdFx0aWYgKCFpbnB1dCB8fCBpbnB1dC5nZXQoJ2Rpc2FibGVkJykgfHwgbGltaXRUb2dnbGVyICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmFkaW8gYnV0dG9uc1xuXHRcdFx0XHRpZiAoaW5wdXQudHlwZSA9PSAncmFkaW8nKSB7XG5cdFx0XHRcdFx0aWYgKCFpbnB1dC5jaGVja2VkKSB7XG5cdFx0XHRcdFx0XHRpbnB1dC5jaGVja2VkID0gJ2NoZWNrZWQnO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrYm94ZXNcblx0XHRcdFx0aWYgKGUuc2hpZnQgJiYgc3RhcnQpIHtcblx0XHRcdFx0XHRzaGlmdFRvZ2dsZShpbnB1dCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aW5wdXQuY2hlY2tlZCA9IGlucHV0LmNoZWNrZWQgPyAnJyA6ICdjaGVja2VkJztcblxuXHRcdFx0XHRcdGlmIChpbnB1dC5nZXQoJ29uY2xpY2snKSA9PSAnQmFja2VuZC50b2dnbGVDaGVja2JveGVzKHRoaXMpJykge1xuXHRcdFx0XHRcdFx0QmFja2VuZC50b2dnbGVDaGVja2JveGVzKGlucHV0KTsgLy8gc2VlICM2Mzk5XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3RhcnQgPSBpbnB1dDtcblx0XHRcdH0sXG5cdFx0XHRjaGVja2JveGVzID0gW10sIHN0YXJ0LCB0aGlzSW5kZXgsIHN0YXJ0SW5kZXgsIHN0YXR1cywgZnJvbSwgdG87XG5cblx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0XHRjaGVja2JveGVzID0gY29udGFpbmVyLmdldEVsZW1lbnRzKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcblx0XHR9XG5cblx0XHQvLyBSb3cgY2xpY2tcblx0XHQkJCgnLnRvZ2dsZV9zZWxlY3QnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHR2YXIgYm91bmRFdmVudCA9IGVsLnJldHJpZXZlKCdib3VuZEV2ZW50Jyk7XG5cblx0XHRcdGlmIChib3VuZEV2ZW50KSB7XG5cdFx0XHRcdGVsLnJlbW92ZUV2ZW50KCdjbGljaycsIGJvdW5kRXZlbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEbyBub3QgcHJvcGFnYXRlIHRoZSBmb3JtIGZpZWxkIGNsaWNrIGV2ZW50c1xuXHRcdFx0ZWwuZ2V0RWxlbWVudHMoJ2xhYmVsLGlucHV0W3R5cGU9XCJjaGVja2JveFwiXSxpbnB1dFt0eXBlPVwicmFkaW9cIl0nKS5lYWNoKGZ1bmN0aW9uKGkpIHtcblx0XHRcdFx0aS5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ym91bmRFdmVudCA9IGNsaWNrRXZlbnQuYmluZChlbCk7XG5cblx0XHRcdGVsLmFkZEV2ZW50KCdjbGljaycsIGJvdW5kRXZlbnQpO1xuXHRcdFx0ZWwuc3RvcmUoJ2JvdW5kRXZlbnQnLCBib3VuZEV2ZW50KTtcblx0XHR9KTtcblxuXHRcdC8vIENoZWNrYm94IGNsaWNrXG5cdFx0Y2hlY2tib3hlcy5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRlbC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGlmIChlLnNoaWZ0ICYmIHN0YXJ0KSB7XG5cdFx0XHRcdFx0c2hpZnRUb2dnbGUodGhpcyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzdGFydCA9IHRoaXM7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogQWxsb3cgdG8gbWFyayB0aGUgaW1wb3J0YW50IHBhcnQgb2YgYW4gaW1hZ2Vcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IGVsIFRoZSBET00gZWxlbWVudFxuXHQgKi9cblx0ZWRpdFByZXZpZXdXaXphcmQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0ZWwgPSAkKGVsKTtcblx0XHR2YXIgaW1hZ2VFbGVtZW50ID0gZWwuZ2V0RWxlbWVudCgnaW1nJyksXG5cdFx0XHRpbnB1dEVsZW1lbnRzID0ge30sXG5cdFx0XHRpc0RyYXdpbmcgPSBmYWxzZSxcblx0XHRcdHBhcnRFbGVtZW50LCBzdGFydFBvcyxcblx0XHRcdGdldFNjYWxlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0eDogaW1hZ2VFbGVtZW50LmdldENvbXB1dGVkU2l6ZSgpLndpZHRoLFxuXHRcdFx0XHRcdHk6IGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKS5oZWlnaHRcblx0XHRcdFx0fTtcblx0XHRcdH0sXG5cdFx0XHR1cGRhdGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgc2NhbGUgPSBnZXRTY2FsZSgpLFxuXHRcdFx0XHRcdGltYWdlU2l6ZSA9IGltYWdlRWxlbWVudC5nZXRDb21wdXRlZFNpemUoKTtcblx0XHRcdFx0cGFydEVsZW1lbnQuc2V0U3R5bGVzKHtcblx0XHRcdFx0XHR0b3A6IGltYWdlU2l6ZS5jb21wdXRlZFRvcCArIChpbnB1dEVsZW1lbnRzLnkuZ2V0KCd2YWx1ZScpICogc2NhbGUueSkucm91bmQoKSArICdweCcsXG5cdFx0XHRcdFx0bGVmdDogaW1hZ2VTaXplLmNvbXB1dGVkTGVmdCArIChpbnB1dEVsZW1lbnRzLnguZ2V0KCd2YWx1ZScpICogc2NhbGUueCkucm91bmQoKSArICdweCcsXG5cdFx0XHRcdFx0d2lkdGg6IChpbnB1dEVsZW1lbnRzLndpZHRoLmdldCgndmFsdWUnKSAqIHNjYWxlLngpLnJvdW5kKCkgKyAncHgnLFxuXHRcdFx0XHRcdGhlaWdodDogKGlucHV0RWxlbWVudHMuaGVpZ2h0LmdldCgndmFsdWUnKSAqIHNjYWxlLnkpLnJvdW5kKCkgKyAncHgnXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoIWlucHV0RWxlbWVudHMud2lkdGguZ2V0KCd2YWx1ZScpLnRvRmxvYXQoKSB8fCAhaW5wdXRFbGVtZW50cy5oZWlnaHQuZ2V0KCd2YWx1ZScpLnRvRmxvYXQoKSkge1xuXHRcdFx0XHRcdHBhcnRFbGVtZW50LnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwYXJ0RWxlbWVudC5zZXRTdHlsZSgnZGlzcGxheScsIG51bGwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0dXBkYXRlVmFsdWVzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBzY2FsZSA9IGdldFNjYWxlKCksXG5cdFx0XHRcdFx0c3R5bGVzID0gcGFydEVsZW1lbnQuZ2V0U3R5bGVzKCd0b3AnLCAnbGVmdCcsICd3aWR0aCcsICdoZWlnaHQnKSxcblx0XHRcdFx0XHRpbWFnZVNpemUgPSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCksXG5cdFx0XHRcdFx0dmFsdWVzID0ge1xuXHRcdFx0XHRcdFx0eDogTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHN0eWxlcy5sZWZ0LnRvRmxvYXQoKSAtIGltYWdlU2l6ZS5jb21wdXRlZExlZnQpIC8gc2NhbGUueCkpLFxuXHRcdFx0XHRcdFx0eTogTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgKHN0eWxlcy50b3AudG9GbG9hdCgpIC0gaW1hZ2VTaXplLmNvbXB1dGVkVG9wKSAvIHNjYWxlLnkpKVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdHZhbHVlcy53aWR0aCA9IE1hdGgubWluKDEgLSB2YWx1ZXMueCwgc3R5bGVzLndpZHRoLnRvRmxvYXQoKSAvIHNjYWxlLngpO1xuXHRcdFx0XHR2YWx1ZXMuaGVpZ2h0ID0gTWF0aC5taW4oMSAtIHZhbHVlcy55LCBzdHlsZXMuaGVpZ2h0LnRvRmxvYXQoKSAvIHNjYWxlLnkpO1xuXHRcdFx0XHRpZiAoIXZhbHVlcy53aWR0aCB8fCAhdmFsdWVzLmhlaWdodCkge1xuXHRcdFx0XHRcdHZhbHVlcy54ID0gdmFsdWVzLnkgPSB2YWx1ZXMud2lkdGggPSB2YWx1ZXMuaGVpZ2h0ID0gJyc7XG5cdFx0XHRcdFx0cGFydEVsZW1lbnQuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBhcnRFbGVtZW50LnNldFN0eWxlKCdkaXNwbGF5JywgbnVsbCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0T2JqZWN0LmVhY2godmFsdWVzLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG5cdFx0XHRcdFx0aW5wdXRFbGVtZW50c1trZXldLnNldCgndmFsdWUnLCB2YWx1ZSA9PT0gJycgPyAnJyA6IE51bWJlcih2YWx1ZSkudG9GaXhlZCgxNSkpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sXG5cdFx0XHRzdGFydCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGlmIChpc0RyYXdpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0aXNEcmF3aW5nID0gdHJ1ZTtcblx0XHRcdFx0c3RhcnRQb3MgPSB7XG5cdFx0XHRcdFx0eDogZXZlbnQucGFnZS54IC0gZWwuZ2V0UG9zaXRpb24oKS54IC0gaW1hZ2VFbGVtZW50LmdldENvbXB1dGVkU2l6ZSgpLmNvbXB1dGVkTGVmdCxcblx0XHRcdFx0XHR5OiBldmVudC5wYWdlLnkgLSBlbC5nZXRQb3NpdGlvbigpLnkgLSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCkuY29tcHV0ZWRUb3Bcblx0XHRcdFx0fTtcblx0XHRcdFx0bW92ZShldmVudCk7XG5cdFx0XHR9LFxuXHRcdFx0bW92ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdGlmICghaXNEcmF3aW5nKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHZhciBpbWFnZVNpemUgPSBpbWFnZUVsZW1lbnQuZ2V0Q29tcHV0ZWRTaXplKCk7XG5cdFx0XHRcdHZhciByZWN0ID0ge1xuXHRcdFx0XHRcdHg6IFtcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIE1hdGgubWluKGltYWdlU2l6ZS53aWR0aCwgc3RhcnRQb3MueCkpLFxuXHRcdFx0XHRcdFx0TWF0aC5tYXgoMCwgTWF0aC5taW4oaW1hZ2VTaXplLndpZHRoLCBldmVudC5wYWdlLnggLSBlbC5nZXRQb3NpdGlvbigpLnggLSBpbWFnZVNpemUuY29tcHV0ZWRMZWZ0KSlcblx0XHRcdFx0XHRdLFxuXHRcdFx0XHRcdHk6IFtcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIE1hdGgubWluKGltYWdlU2l6ZS5oZWlnaHQsIHN0YXJ0UG9zLnkpKSxcblx0XHRcdFx0XHRcdE1hdGgubWF4KDAsIE1hdGgubWluKGltYWdlU2l6ZS5oZWlnaHQsIGV2ZW50LnBhZ2UueSAtIGVsLmdldFBvc2l0aW9uKCkueSAtIGltYWdlU2l6ZS5jb21wdXRlZFRvcCkpXG5cdFx0XHRcdFx0XVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRwYXJ0RWxlbWVudC5zZXRTdHlsZXMoe1xuXHRcdFx0XHRcdHRvcDogTWF0aC5taW4ocmVjdC55WzBdLCByZWN0LnlbMV0pICsgaW1hZ2VTaXplLmNvbXB1dGVkVG9wICsgJ3B4Jyxcblx0XHRcdFx0XHRsZWZ0OiBNYXRoLm1pbihyZWN0LnhbMF0sIHJlY3QueFsxXSkgKyBpbWFnZVNpemUuY29tcHV0ZWRMZWZ0ICsgJ3B4Jyxcblx0XHRcdFx0XHR3aWR0aDogTWF0aC5hYnMocmVjdC54WzBdIC0gcmVjdC54WzFdKSArICdweCcsXG5cdFx0XHRcdFx0aGVpZ2h0OiBNYXRoLmFicyhyZWN0LnlbMF0gLSByZWN0LnlbMV0pICsgJ3B4J1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0dXBkYXRlVmFsdWVzKCk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdG1vdmUoZXZlbnQpO1xuXHRcdFx0XHRpc0RyYXdpbmcgPSBmYWxzZTtcblx0XHRcdH0sXG5cdFx0XHRpbml0ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGVsLmdldFBhcmVudCgnLnRsX3Rib3gsLnRsX2JveCcpLmdldEVsZW1lbnRzKCdpbnB1dFtuYW1lXj1cImltcG9ydGFudFBhcnRcIl0nKS5lYWNoKGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0XHRcdFx0Wyd4JywgJ3knLCAnd2lkdGgnLCAnaGVpZ2h0J10uZWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHRcdFx0XHRcdGlmIChpbnB1dC5nZXQoJ25hbWUnKS5zdWJzdHIoMTMsIGtleS5sZW5ndGgpID09PSBrZXkuY2FwaXRhbGl6ZSgpKSB7XG5cdFx0XHRcdFx0XHRcdGlucHV0RWxlbWVudHNba2V5XSA9IGlucHV0ID0gJChpbnB1dCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoT2JqZWN0LmdldExlbmd0aChpbnB1dEVsZW1lbnRzKSAhPT0gNCkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRPYmplY3QuZWFjaChpbnB1dEVsZW1lbnRzLCBmdW5jdGlvbihpbnB1dCkge1xuXHRcdFx0XHRcdGlucHV0LmdldFBhcmVudCgpLnNldFN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGVsLmFkZENsYXNzKCd0bF9lZGl0X3ByZXZpZXdfZW5hYmxlZCcpO1xuXHRcdFx0XHRwYXJ0RWxlbWVudCA9IG5ldyBFbGVtZW50KCdkaXYnLCB7XG5cdFx0XHRcdFx0J2NsYXNzJzogJ3RsX2VkaXRfcHJldmlld19pbXBvcnRhbnRfcGFydCdcblx0XHRcdFx0fSkuaW5qZWN0KGVsKTtcblx0XHRcdFx0dXBkYXRlSW1hZ2UoKTtcblx0XHRcdFx0aW1hZ2VFbGVtZW50LmFkZEV2ZW50KCdsb2FkJywgdXBkYXRlSW1hZ2UpO1xuXHRcdFx0XHRlbC5hZGRFdmVudHMoe1xuXHRcdFx0XHRcdG1vdXNlZG93bjogc3RhcnQsXG5cdFx0XHRcdFx0dG91Y2hzdGFydDogc3RhcnRcblx0XHRcdFx0fSk7XG5cdFx0XHRcdCQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hZGRFdmVudHMoe1xuXHRcdFx0XHRcdG1vdXNlbW92ZTogbW92ZSxcblx0XHRcdFx0XHR0b3VjaG1vdmU6IG1vdmUsXG5cdFx0XHRcdFx0bW91c2V1cDogc3RvcCxcblx0XHRcdFx0XHR0b3VjaGVuZDogc3RvcCxcblx0XHRcdFx0XHR0b3VjaGNhbmNlbDogc3RvcCxcblx0XHRcdFx0XHRyZXNpemU6IHVwZGF0ZUltYWdlXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdDtcblxuXHRcdHdpbmRvdy5hZGRFdmVudCgnZG9tcmVhZHknLCBpbml0KTtcblx0fSxcblxuXHQvKipcblx0ICogRW5hYmxlIGRyYWcgYW5kIGRyb3AgZmlsZSB1cGxvYWQgZm9yIHRoZSBmaWxlIHRyZWVcblx0ICpcblx0ICogQHBhcmFtIHtvYmplY3R9IHdyYXAgICAgVGhlIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIEFuIG9wdGlvbmFsIG9wdGlvbnMgb2JqZWN0XG5cdCAqL1xuXHRlbmFibGVGaWxlVHJlZVVwbG9hZDogZnVuY3Rpb24od3JhcCwgb3B0aW9ucykge1xuXHRcdHdyYXAgPSAkKHdyYXApO1xuXG5cdFx0dmFyIGZhbGxiYWNrVXJsID0gb3B0aW9ucy51cmwsXG5cdFx0XHRkekVsZW1lbnQgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHQnY2xhc3MnOiAnZHJvcHpvbmUgZHJvcHpvbmUtZmlsZXRyZWUnLFxuXHRcdFx0XHRodG1sOiAnPHNwYW4gY2xhc3M9XCJkcm9wem9uZS1wcmV2aWV3c1wiPjwvc3Bhbj4nXG5cdFx0XHR9KS5pbmplY3Qod3JhcCwgJ3RvcCcpLFxuXHRcdFx0Y3VycmVudEhvdmVyLCBjdXJyZW50SG92ZXJUaW1lLCBleHBhbmRMaW5rO1xuXG5cdFx0b3B0aW9ucy5wcmV2aWV3c0NvbnRhaW5lciA9IGR6RWxlbWVudC5nZXRFbGVtZW50KCcuZHJvcHpvbmUtcHJldmlld3MnKTtcblx0XHRvcHRpb25zLmNsaWNrYWJsZSA9IGZhbHNlO1xuXG5cdFx0dmFyIGR6ID0gbmV3IERyb3B6b25lKHdyYXAsIG9wdGlvbnMpO1xuXG5cdFx0ZHoub24oJ3F1ZXVlY29tcGxldGUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcblx0XHR9KTtcblxuXHRcdGR6Lm9uKCdkcmFnb3ZlcicsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoIWV2ZW50LmRhdGFUcmFuc2ZlciB8fCAhZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzIHx8IGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlcy5pbmRleE9mKCdGaWxlcycpID09PSAtMSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHdyYXAuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXJfZHJvcHBpbmcnKS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0ICYmICQoZXZlbnQudGFyZ2V0KTtcblxuXHRcdFx0aWYgKHRhcmdldCkge1xuXHRcdFx0XHR2YXIgZm9sZGVyID0gdGFyZ2V0Lm1hdGNoKCcudGxfZm9sZGVyJykgPyB0YXJnZXQgOiB0YXJnZXQuZ2V0UGFyZW50KCcudGxfZm9sZGVyJyk7XG5cblx0XHRcdFx0aWYgKCFmb2xkZXIpIHtcblx0XHRcdFx0XHRmb2xkZXIgPSB0YXJnZXQuZ2V0UGFyZW50KCcucGFyZW50Jyk7XG5cdFx0XHRcdFx0Zm9sZGVyID0gZm9sZGVyICYmIGZvbGRlci5nZXRQcmV2aW91cygnLnRsX2ZvbGRlcicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGZvbGRlcikge1xuXHRcdFx0XHRcdHZhciBsaW5rID0gZm9sZGVyLmdldEVsZW1lbnQoJ2ltZ1tzcmMkPVwiL2ljb25zL25ldy5zdmdcIl0nKTtcblx0XHRcdFx0XHRsaW5rID0gbGluayAmJiBsaW5rLmdldFBhcmVudCgnYScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChsaW5rICYmIGxpbmsuaHJlZikge1xuXHRcdFx0XHRkei5vcHRpb25zLnVybCA9ICcnK2xpbmsuaHJlZjtcblx0XHRcdFx0Zm9sZGVyLmFkZENsYXNzKCd0bF9mb2xkZXJfZHJvcHBpbmcnKTtcblxuXHRcdFx0XHRpZiAoY3VycmVudEhvdmVyICE9PSBmb2xkZXIpIHtcblx0XHRcdFx0XHRjdXJyZW50SG92ZXIgPSBmb2xkZXI7XG5cdFx0XHRcdFx0Y3VycmVudEhvdmVyVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHRcdFx0XHRcdGV4cGFuZExpbmsgPSBmb2xkZXIuZ2V0RWxlbWVudCgnYS5mb2xkYWJsZScpO1xuXG5cdFx0XHRcdFx0aWYgKGV4cGFuZExpbmsgJiYgIWV4cGFuZExpbmsuaGFzQ2xhc3MoJ2ZvbGRhYmxlLS1vcGVuJykpIHtcblx0XHRcdFx0XHRcdC8vIEV4cGFuZCB0aGUgZm9sZGVyIGFmdGVyIG9uZSBzZWNvbmQgaG92ZXIgdGltZVxuXHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRIb3ZlciA9PT0gZm9sZGVyICYmIGN1cnJlbnRIb3ZlclRpbWUgKyA5MDAgPCBuZXcgRGF0ZSgpLmdldFRpbWUoKSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdIVE1MRXZlbnRzJyk7XG5cdFx0XHRcdFx0XHRcdFx0ZXZlbnQuaW5pdEV2ZW50KCdjbGljaycsIHRydWUsIHRydWUpO1xuXHRcdFx0XHRcdFx0XHRcdGV4cGFuZExpbmsuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cdFx0XHRcdFx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRIb3ZlclRpbWUgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0sIDEwMDApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZHoub3B0aW9ucy51cmwgPSBmYWxsYmFja1VybDtcblx0XHRcdFx0Y3VycmVudEhvdmVyID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZHoub24oJ2Ryb3AnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0aWYgKCFldmVudC5kYXRhVHJhbnNmZXIgfHwgIWV2ZW50LmRhdGFUcmFuc2Zlci50eXBlcyB8fCBldmVudC5kYXRhVHJhbnNmZXIudHlwZXMuaW5kZXhPZignRmlsZXMnKSA9PT0gLTEpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRkekVsZW1lbnQuYWRkQ2xhc3MoJ2Ryb3B6b25lLWZpbGV0cmVlLWVuYWJsZWQnKTtcblx0XHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpKTtcblx0XHR9KTtcblxuXHRcdGR6Lm9uKCdkcmFnbGVhdmUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHdyYXAuZ2V0RWxlbWVudHMoJy50bF9mb2xkZXJfZHJvcHBpbmcnKS5yZW1vdmVDbGFzcygndGxfZm9sZGVyX2Ryb3BwaW5nJyk7XG5cdFx0XHRjdXJyZW50SG92ZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHRjdXJyZW50SG92ZXJUaW1lID0gdW5kZWZpbmVkO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBDcmF3bCB0aGUgd2Vic2l0ZVxuXHQgKi9cblx0Y3Jhd2w6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB0aW1lb3V0ID0gMjAwMCxcblx0XHRcdGNyYXdsID0gJCgndGxfY3Jhd2wnKSxcblx0XHRcdHByb2dyZXNzQmFyID0gY3Jhd2wuZ2V0RWxlbWVudCgnZGl2LnByb2dyZXNzLWJhcicpLFxuXHRcdFx0cHJvZ3Jlc3NDb3VudCA9IGNyYXdsLmdldEVsZW1lbnQoJ3AucHJvZ3Jlc3MtY291bnQnKSxcblx0XHRcdHJlc3VsdHMgPSBjcmF3bC5nZXRFbGVtZW50KCdkaXYucmVzdWx0cycpLFxuXHRcdFx0ZGVidWdMb2cgPSBjcmF3bC5nZXRFbGVtZW50KCdwLmRlYnVnLWxvZycpO1xuXG5cdFx0ZnVuY3Rpb24gdXBkYXRlRGF0YShyZXNwb25zZSkge1xuXHRcdFx0dmFyIHRvdGFsID0gcmVzcG9uc2UudG90YWwsXG5cdFx0XHRcdGRvbmUgPSB0b3RhbCAtIHJlc3BvbnNlLnBlbmRpbmcsXG5cdFx0XHRcdHBlcmNlbnRhZ2UgPSB0b3RhbCA+IDAgPyBwYXJzZUludChkb25lIC8gdG90YWwgKiAxMDAsIDEwKSA6IDEwMCxcblx0XHRcdFx0cmVzdWx0O1xuXG5cdFx0XHQvLyBJbml0aWFsaXplIHRoZSBzdGF0dXMgYmFyIGF0IDEwJVxuXHRcdFx0aWYgKGRvbmUgPCAxICYmIHBlcmNlbnRhZ2UgPCAxKSB7XG5cdFx0XHRcdGRvbmUgPSAxO1xuXHRcdFx0XHRwZXJjZW50YWdlID0gMTA7XG5cdFx0XHRcdHRvdGFsID0gMTA7XG5cdFx0XHR9XG5cblx0XHRcdHByb2dyZXNzQmFyLnNldFN0eWxlKCd3aWR0aCcsIHBlcmNlbnRhZ2UgKyAnJScpO1xuXHRcdFx0cHJvZ3Jlc3NCYXIuc2V0KCdodG1sJywgcGVyY2VudGFnZSArICclJyk7XG5cdFx0XHRwcm9ncmVzc0Jhci5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCBwZXJjZW50YWdlKTtcblx0XHRcdHByb2dyZXNzQ291bnQuc2V0KCdodG1sJywgZG9uZSArICcgLyAnICsgdG90YWwpO1xuXG5cdFx0XHRpZiAocmVzcG9uc2UuaGFzRGVidWdMb2cpIHtcblx0XHRcdFx0ZGVidWdMb2cuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHJlc3BvbnNlLmhhc0RlYnVnTG9nKSB7XG5cdFx0XHRcdGRlYnVnTG9nLnNldFN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghcmVzcG9uc2UuZmluaXNoZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRwcm9ncmVzc0Jhci5yZW1vdmVDbGFzcygncnVubmluZycpLmFkZENsYXNzKCdmaW5pc2hlZCcpO1xuXHRcdFx0cmVzdWx0cy5yZW1vdmVDbGFzcygncnVubmluZycpLmFkZENsYXNzKCdmaW5pc2hlZCcpO1xuXG5cdFx0XHRmb3IgKHJlc3VsdCBpbiByZXNwb25zZS5yZXN1bHRzKSB7XG5cdFx0XHRcdGlmIChyZXNwb25zZS5yZXN1bHRzLmhhc093blByb3BlcnR5KHJlc3VsdCkpIHtcblx0XHRcdFx0XHR2YXIgc3VtbWFyeSA9IHJlc3VsdHMuZ2V0RWxlbWVudCgnLnJlc3VsdFtkYXRhLXN1YnNjcmliZXI9XCInICsgcmVzdWx0ICsgJ1wiXSBwLnN1bW1hcnknKSxcblx0XHRcdFx0XHRcdHdhcm5pbmcgPSByZXN1bHRzLmdldEVsZW1lbnQoJy5yZXN1bHRbZGF0YS1zdWJzY3JpYmVyPVwiJyArIHJlc3VsdCArICdcIl0gcC53YXJuaW5nJyksXG5cdFx0XHRcdFx0XHRsb2cgPSByZXN1bHRzLmdldEVsZW1lbnQoJy5yZXN1bHRbZGF0YS1zdWJzY3JpYmVyPVwiJyArIHJlc3VsdCArICdcIl0gcC5zdWJzY3JpYmVyLWxvZycpLFxuXHRcdFx0XHRcdFx0c3Vic2NyaWJlclJlc3VsdHMgPSByZXNwb25zZS5yZXN1bHRzW3Jlc3VsdF0sXG5cdFx0XHRcdFx0XHRzdWJzY3JpYmVyU3VtbWFyeSA9IHN1YnNjcmliZXJSZXN1bHRzLnN1bW1hcnk7XG5cblx0XHRcdFx0XHRpZiAoc3Vic2NyaWJlclJlc3VsdHMud2FybmluZykge1xuXHRcdFx0XHRcdFx0d2FybmluZy5zZXQoJ2h0bWwnLCBzdWJzY3JpYmVyUmVzdWx0cy53YXJuaW5nKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoc3Vic2NyaWJlclJlc3VsdHMuaGFzTG9nKSB7XG5cdFx0XHRcdFx0XHRsb2cuc2V0U3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRzdW1tYXJ5LmFkZENsYXNzKHN1YnNjcmliZXJSZXN1bHRzLndhc1N1Y2Nlc3NmdWwgPyAnc3VjY2VzcycgOiAnZmFpbHVyZScpO1xuXHRcdFx0XHRcdHN1bW1hcnkuc2V0KCdodG1sJywgc3Vic2NyaWJlclN1bW1hcnkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZXhlY1JlcXVlc3Qob25seVN0YXR1c1VwZGF0ZSA9IGZhbHNlKSB7XG5cdFx0XHRuZXcgUmVxdWVzdCh7XG5cdFx0XHRcdHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsXG5cdFx0XHRcdGhlYWRlcnM6IHtcblx0XHRcdFx0XHQnT25seS1TdGF0dXMtVXBkYXRlJzogb25seVN0YXR1c1VwZGF0ZVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRvblN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlVGV4dCkge1xuXHRcdFx0XHRcdHZhciByZXNwb25zZSA9IEpTT04uZGVjb2RlKHJlc3BvbnNlVGV4dCk7XG5cblx0XHRcdFx0XHR1cGRhdGVEYXRhKHJlc3BvbnNlKTtcblxuXHRcdFx0XHRcdGlmICghcmVzcG9uc2UuZmluaXNoZWQpIHtcblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZXhlY1JlcXVlc3QsIHRpbWVvdXQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSkuc2VuZCgpO1xuXHRcdH1cblxuXHRcdGV4ZWNSZXF1ZXN0KHRydWUpO1xuXHR9XG59O1xuXG53aW5kb3cuVGhlbWUgPVxue1xuXHQvKipcblx0ICogQ2hlY2sgZm9yIFdlYktpdFxuXHQgKiBAbWVtYmVyIHtib29sZWFufVxuIFx0ICovXG5cdGlzV2Via2l0OiAoQnJvd3Nlci5jaHJvbWUgfHwgQnJvd3Nlci5zYWZhcmkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvKD86d2Via2l0fGtodG1sKS9pKSksXG5cblx0LyoqXG5cdCAqIFN0b3AgdGhlIHByb3BhZ2F0aW9uIG9mIGNsaWNrIGV2ZW50cyBvZiBjZXJ0YWluIGVsZW1lbnRzXG5cdCAqL1xuXHRzdG9wQ2xpY2tQcm9wYWdhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gRG8gbm90IHByb3BhZ2F0ZSB0aGUgY2xpY2sgZXZlbnRzIG9mIHRoZSBpY29uc1xuXHRcdCQkKCcucGlja2VyX3NlbGVjdG9yJykuZWFjaChmdW5jdGlvbih1bCkge1xuXHRcdFx0dWwuZ2V0RWxlbWVudHMoJ2EnKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRcdGVsLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gRG8gbm90IHByb3BhZ2F0ZSB0aGUgY2xpY2sgZXZlbnRzIG9mIHRoZSBjaGVja2JveGVzXG5cdFx0JCQoJy5waWNrZXJfc2VsZWN0b3IsLmNsaWNrMmVkaXQnKS5lYWNoKGZ1bmN0aW9uKHVsKSB7XG5cdFx0XHR1bC5nZXRFbGVtZW50cygnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0XHRlbC5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSB0ZXh0YXJlYSByZXNpemluZ1xuXHQgKi9cblx0c2V0dXBUZXh0YXJlYVJlc2l6aW5nOiBmdW5jdGlvbigpIHtcblx0XHQkJCgnLnRsX3RleHRhcmVhJykuZWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0aWYgKEJyb3dzZXIuaWU2IHx8IEJyb3dzZXIuaWU3IHx8IEJyb3dzZXIuaWU4KSByZXR1cm47XG5cdFx0XHRpZiAoZWwuaGFzQ2xhc3MoJ25vcmVzaXplJykgfHwgZWwucmV0cmlldmUoJ2F1dG9ncm93JykpIHJldHVybjtcblxuXHRcdFx0Ly8gU2V0IHVwIHRoZSBkdW1teSBlbGVtZW50XG5cdFx0XHR2YXIgZHVtbXkgPSBuZXcgRWxlbWVudCgnZGl2Jywge1xuXHRcdFx0XHRodG1sOiAnWCcsXG5cdFx0XHRcdHN0eWxlczoge1xuXHRcdFx0XHRcdCdwb3NpdGlvbic6J2Fic29sdXRlJyxcblx0XHRcdFx0XHQndG9wJzowLFxuXHRcdFx0XHRcdCdsZWZ0JzonLTk5OWVtJyxcblx0XHRcdFx0XHQnb3ZlcmZsb3cteCc6J2hpZGRlbidcblx0XHRcdFx0fVxuXHRcdFx0fSkuc2V0U3R5bGVzKFxuXHRcdFx0XHRlbC5nZXRTdHlsZXMoJ2ZvbnQtc2l6ZScsICdmb250LWZhbWlseScsICd3aWR0aCcsICdsaW5lLWhlaWdodCcpXG5cdFx0XHQpLmluamVjdChkb2N1bWVudC5ib2R5KTtcblxuXHRcdFx0Ly8gQWxzbyBjb25zaWRlciB0aGUgYm94LXNpemluZ1xuXHRcdFx0aWYgKGVsLmdldFN0eWxlKCctbW96LWJveC1zaXppbmcnKSA9PSAnYm9yZGVyLWJveCcgfHwgZWwuZ2V0U3R5bGUoJy13ZWJraXQtYm94LXNpemluZycpID09ICdib3JkZXItYm94JyB8fCBlbC5nZXRTdHlsZSgnYm94LXNpemluZycpID09ICdib3JkZXItYm94Jykge1xuXHRcdFx0XHRkdW1teS5zZXRTdHlsZXMoe1xuXHRcdFx0XHRcdCdwYWRkaW5nJzogZWwuZ2V0U3R5bGUoJ3BhZGRpbmcnKSxcblx0XHRcdFx0XHQnYm9yZGVyJzogZWwuZ2V0U3R5bGUoJ2JvcmRlci1sZWZ0Jylcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNpbmdsZSBsaW5lIGhlaWdodFxuXHRcdFx0dmFyIGxpbmUgPSBNYXRoLm1heChkdW1teS5jbGllbnRIZWlnaHQsIDMwKTtcblxuXHRcdFx0Ly8gUmVzcG9uZCB0byB0aGUgXCJpbnB1dFwiIGV2ZW50XG5cdFx0XHRlbC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZHVtbXkuc2V0KCdodG1sJywgdGhpcy5nZXQoJ3ZhbHVlJylcblx0XHRcdFx0XHQucmVwbGFjZSgvPC9nLCAnJmx0OycpXG5cdFx0XHRcdFx0LnJlcGxhY2UoLz4vZywgJyZndDsnKVxuXHRcdFx0XHRcdC5yZXBsYWNlKC9cXG58XFxyXFxuL2csICc8YnI+WCcpKTtcblx0XHRcdFx0dmFyIGhlaWdodCA9IE1hdGgubWF4KGxpbmUsIGR1bW15LmdldFNpemUoKS55KTtcblx0XHRcdFx0aWYgKHRoaXMuY2xpZW50SGVpZ2h0ICE9IGhlaWdodCkgdGhpcy50d2VlbignaGVpZ2h0JywgaGVpZ2h0KTtcblx0XHRcdH0pLnNldCgndHdlZW4nLCB7ICdkdXJhdGlvbic6MTAwIH0pLnNldFN0eWxlKCdoZWlnaHQnLCBsaW5lICsgJ3B4Jyk7XG5cblx0XHRcdC8vIEZpcmUgdGhlIGV2ZW50XG5cdFx0XHRlbC5maXJlRXZlbnQoJ2lucHV0Jyk7XG5cdFx0XHRlbC5zdG9yZSgnYXV0b2dyb3cnLCB0cnVlKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBtZW51IHRvZ2dsZVxuXHQgKi9cblx0c2V0dXBNZW51VG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYnVyZ2VyID0gJCgnYnVyZ2VyJyk7XG5cdFx0aWYgKCFidXJnZXIpIHJldHVybjtcblxuXHRcdGJ1cmdlclxuXHRcdFx0LmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LnRvZ2dsZUNsYXNzKCdzaG93LW5hdmlnYXRpb24nKTtcblx0XHRcdFx0YnVyZ2VyLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGRvY3VtZW50LmJvZHkuaGFzQ2xhc3MoJ3Nob3ctbmF2aWdhdGlvbicpID8gJ3RydWUnIDogJ2ZhbHNlJylcblx0XHRcdH0pXG5cdFx0XHQuYWRkRXZlbnQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGlmIChlLmV2ZW50LmtleUNvZGUgPT0gMjcpIHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdzaG93LW5hdmlnYXRpb24nKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHQ7XG5cblx0XHRpZiAod2luZG93Lm1hdGNoTWVkaWEpIHtcblx0XHRcdHZhciBtYXRjaE1lZGlhID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6OTkxcHgpJyk7XG5cdFx0XHR2YXIgc2V0QXJpYUNvbnRyb2xzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChtYXRjaE1lZGlhLm1hdGNoZXMpIHtcblx0XHRcdFx0XHRidXJnZXIuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgJ2xlZnQnKVxuXHRcdFx0XHRcdGJ1cmdlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBkb2N1bWVudC5ib2R5Lmhhc0NsYXNzKCdzaG93LW5hdmlnYXRpb24nKSA/ICd0cnVlJyA6ICdmYWxzZScpXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YnVyZ2VyLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xuXHRcdFx0XHRcdGJ1cmdlci5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdG1hdGNoTWVkaWEuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2V0QXJpYUNvbnRyb2xzKTtcblx0XHRcdHNldEFyaWFDb250cm9scygpO1xuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBwcm9maWxlIHRvZ2dsZVxuXHQgKi9cblx0c2V0dXBQcm9maWxlVG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAod2luZG93LmNvbnNvbGUpIHtcblx0XHRcdGNvbnNvbGUud2FybignVGhlbWUuc2V0dXBQcm9maWxlVG9nZ2xlKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0aGUgc3RpbXVsdXMgY29udHJvbGxlciBpbnN0ZWFkLicpO1xuXHRcdH1cblxuXHRcdHZhciB0bWVudSA9ICQoJ3RtZW51Jyk7XG5cdFx0aWYgKCF0bWVudSkgcmV0dXJuO1xuXG5cdFx0dmFyIGxpID0gdG1lbnUuZ2V0RWxlbWVudCgnLnN1Ym1lbnUnKSxcblx0XHRcdGJ1dHRvbiA9IGxpLmdldEZpcnN0KCdzcGFuJykuZ2V0Rmlyc3QoJ2J1dHRvbicpLFxuXHRcdFx0bWVudSA9IGxpLmdldEZpcnN0KCd1bCcpO1xuXHRcdGlmICghbGkgfHwgIWJ1dHRvbiB8fCAhbWVudSkgcmV0dXJuO1xuXG5cdFx0YnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsICd0bWVudV9fcHJvZmlsZScpO1xuXHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcblxuXHRcdG1lbnUuaWQgPSAndG1lbnVfX3Byb2ZpbGUnO1xuXG5cdFx0YnV0dG9uLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmIChsaS5oYXNDbGFzcygnYWN0aXZlJykpIHtcblx0XHRcdFx0bGkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsaS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuXHRcdFx0fVxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9KTtcblxuXHRcdCQoZG9jdW1lbnQuYm9keSkuYWRkRXZlbnQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAobGkuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG5cdFx0XHRcdGxpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogU2V0IHVwIHRoZSBzcGxpdCBidXR0b24gdG9nZ2xlXG5cdCAqL1xuXHRzZXR1cFNwbGl0QnV0dG9uVG9nZ2xlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdG9nZ2xlID0gJCgnc2J0b2cnKTtcblx0XHRpZiAoIXRvZ2dsZSkgcmV0dXJuO1xuXG5cdFx0dmFyIHVsID0gdG9nZ2xlLmdldFBhcmVudCgnLnNwbGl0LWJ1dHRvbicpLmdldEVsZW1lbnQoJ3VsJyksXG5cdFx0XHR0YWIsIHRpbWVyO1xuXG5cdFx0dG9nZ2xlLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRhYiA9IGZhbHNlO1xuXHRcdFx0dWwudG9nZ2xlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXHRcdFx0dG9nZ2xlLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cblx0XHQkKGRvY3VtZW50LmJvZHkpLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGFiID0gZmFsc2U7XG5cdFx0XHR1bC5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG5cdFx0XHR0b2dnbGUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdH0pO1xuXG5cdFx0JChkb2N1bWVudC5ib2R5KS5hZGRFdmVudCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRhYiA9IChlLmV2ZW50LmtleUNvZGUgPT0gOSk7XG5cdFx0fSk7XG5cblx0XHRbdG9nZ2xlXS5hcHBlbmQodWwuZ2V0RWxlbWVudHMoJ2J1dHRvbicpKS5lYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRlbC5hZGRFdmVudCgnZm9jdXMnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCF0YWIpIHJldHVybjtcblx0XHRcdFx0dWwucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXHRcdFx0XHR0b2dnbGUuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGVsLmFkZEV2ZW50KCdibHVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghdGFiKSByZXR1cm47XG5cdFx0XHRcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR1bC5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG5cdFx0XHRcdFx0dG9nZ2xlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0dG9nZ2xlLnNldCgndGFiaW5kZXgnLCAnLTEnKTtcblx0fVxufTtcblxuLy8gSW5pdGlhbGl6ZSB0aGUgYmFjayBlbmQgc2NyaXB0XG53aW5kb3cuYWRkRXZlbnQoJ2RvbXJlYWR5JywgZnVuY3Rpb24oKSB7XG5cdCQoZG9jdW1lbnQuYm9keSkuYWRkQ2xhc3MoJ2pzJyk7XG5cblx0Ly8gTWFyayB0b3VjaCBkZXZpY2VzIChzZWUgIzU1NjMpXG5cdGlmIChCcm93c2VyLkZlYXR1cmVzLlRvdWNoKSB7XG5cdFx0JChkb2N1bWVudC5ib2R5KS5hZGRDbGFzcygndG91Y2gnKTtcblx0fVxuXG5cdEJhY2tlbmQudGFibGVXaXphcmRTZXRXaWR0aCgpO1xuXHRCYWNrZW5kLmVuYWJsZUltYWdlU2l6ZVdpZGdldHMoKTtcblx0QmFja2VuZC5lbmFibGVUb2dnbGVTZWxlY3QoKTtcblxuXHRUaGVtZS5zdG9wQ2xpY2tQcm9wYWdhdGlvbigpO1xuXHRUaGVtZS5zZXR1cFRleHRhcmVhUmVzaXppbmcoKTtcblx0VGhlbWUuc2V0dXBNZW51VG9nZ2xlKCk7XG5cdFRoZW1lLnNldHVwU3BsaXRCdXR0b25Ub2dnbGUoKTtcbn0pO1xuXG4vLyBSZXNpemUgdGhlIHRhYmxlIHdpemFyZFxud2luZG93LmFkZEV2ZW50KCdyZXNpemUnLCBmdW5jdGlvbigpIHtcblx0QmFja2VuZC50YWJsZVdpemFyZFNldFdpZHRoKCk7XG59KTtcblxuLy8gUmUtYXBwbHkgY2VydGFpbiBjaGFuZ2VzIHVwb24gYWpheF9jaGFuZ2VcbndpbmRvdy5hZGRFdmVudCgnYWpheF9jaGFuZ2UnLCBmdW5jdGlvbigpIHtcblx0QmFja2VuZC5lbmFibGVJbWFnZVNpemVXaWRnZXRzKCk7XG5cdEJhY2tlbmQuZW5hYmxlVG9nZ2xlU2VsZWN0KCk7XG5cblx0VGhlbWUuc3RvcENsaWNrUHJvcGFnYXRpb24oKTtcblx0VGhlbWUuc2V0dXBUZXh0YXJlYVJlc2l6aW5nKCk7XG59KTtcbiIsIndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2LmxpbWl0X2hlaWdodCcpLmZvckVhY2goZnVuY3Rpb24oZGl2KSB7XG4gICAgICAgIGlmICh3aW5kb3cuY29uc29sZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdVc2luZyBcImxpbWl0X2hlaWdodFwiIGNsYXNzIG9uIGNoaWxkX3JlY29yZF9jYWxsYmFjayBpcyBkZXByZWNhdGVkLiBTZXQgYSBsaXN0LnNvcnRpbmcubGltaXRIZWlnaHQgaW4geW91ciBEQ0EgaW5zdGVhZC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGRpdi5wYXJlbnROb2RlLmNsb3Nlc3QoJy50bF9jb250ZW50Jyk7XG5cbiAgICAgICAgLy8gUmV0dXJuIGlmIHRoZSBlbGVtZW50IGlzIGEgd3JhcHBlclxuICAgICAgICBpZiAocGFyZW50ICYmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCd3cmFwcGVyX3N0YXJ0JykgfHwgcGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnd3JhcHBlcl9zdG9wJykpKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgaGd0ID0gTnVtYmVyKGRpdi5jbGFzc05hbWUucmVwbGFjZSgvW14wLTldKi8sICcnKSk7XG5cbiAgICAgICAgLy8gUmV0dXJuIGlmIHRoZXJlIGlzIG5vIGhlaWdodCB2YWx1ZVxuICAgICAgICBpZiAoIWhndCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZGl2LCBudWxsKTtcbiAgICAgICAgY29uc3QgcGFkZGluZyA9IHBhcnNlRmxvYXQoc3R5bGUucGFkZGluZ1RvcCkgKyBwYXJzZUZsb2F0KHN0eWxlLnBhZGRpbmdCb3R0b20pO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBkaXYuY2xpZW50SGVpZ2h0IC0gcGFkZGluZztcblxuICAgICAgICAvLyBEbyBub3QgYWRkIHRoZSB0b2dnbGUgaWYgdGhlIHByZXZpZXcgaGVpZ2h0IGlzIGJlbG93IHRoZSBtYXgtaGVpZ2h0XG4gICAgICAgIGlmIChoZWlnaHQgPD0gaGd0KSByZXR1cm47XG5cbiAgICAgICAgLy8gUmVzaXplIHRoZSBlbGVtZW50IGlmIGl0IGlzIGhpZ2hlciB0aGFuIHRoZSBtYXhpbXVtIGhlaWdodFxuICAgICAgICBkaXYuc3R5bGUuaGVpZ2h0ID0gaGd0KydweCc7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi50aXRsZSA9IENvbnRhby5sYW5nLmV4cGFuZDtcbiAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9ICc8c3Bhbj4uLi48L3NwYW4+JztcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Vuc2VsZWN0YWJsZScpO1xuXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGRpdi5zdHlsZS5oZWlnaHQgPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgZGl2LnN0eWxlLmhlaWdodCA9IGhndCsncHgnO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi50aXRsZSA9IENvbnRhby5sYW5nLmV4cGFuZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGl2LnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgICAgICAgICBidXR0b24udGl0bGUgPSBDb250YW8ubGFuZy5jb2xsYXBzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0b2dnbGVyLmNsYXNzTGlzdC5hZGQoJ2xpbWl0X3RvZ2dsZXInKTtcbiAgICAgICAgdG9nZ2xlci5hcHBlbmQoYnV0dG9uKTtcblxuICAgICAgICBkaXYuYXBwZW5kKHRvZ2dsZXIpO1xuICAgIH0pO1xufSk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBjb25zdCBpbml0aWFsaXplZFJvd3MgPSBuZXcgV2Vha01hcCgpO1xuICAgIGNvbnN0IHNhdmVTY3JvbGxPZmZzZXRFdmVudCA9IG5ldyBFdmVudCgnc3RvcmUtc2Nyb2xsLW9mZnNldCcpO1xuXG4gICAgY29uc3QgaW5pdCA9IChyb3cpID0+IHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyByb3cgaGFzIGFscmVhZHkgYmVlbiBpbml0aWFsaXplZFxuICAgICAgICBpZiAoaW5pdGlhbGl6ZWRSb3dzLmhhcyhyb3cpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcm93IGhhcyBhbGwgbmVjZXNzYXJ5IGVsZW1lbnRzIHRvIHByZXZlbnQgdGhlIG11dGF0aW9uIG9ic2VydmVyXG4gICAgICAgIC8vIGZyb20gaW5pdGlhbGl6aW5nIHRoZSBpbmNvbXBsZXRlIHdpZGdldC5cbiAgICAgICAgaWYgKCFyb3cucXVlcnlTZWxlY3RvcignYnV0dG9uLmRyYWctaGFuZGxlJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGluaXRpYWxpemVkUm93cy5zZXQocm93LCB0cnVlKTtcblxuICAgICAgICBjb25zdCB0Ym9keSA9IHJvdy5jbG9zZXN0KCd0Ym9keScpO1xuXG4gICAgICAgIGNvbnN0IG1ha2VTb3J0YWJsZSA9ICh0Ym9keSkgPT4ge1xuICAgICAgICAgICAgQXJyYXkuZnJvbSh0Ym9keS5jaGlsZHJlbikuZm9yRWFjaCgodHIsIGkpID0+IHtcbiAgICAgICAgICAgICAgICB0ci5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgc2VsZWN0JykuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZWwubmFtZSA9IGVsLm5hbWUucmVwbGFjZSgvXFxbWzAtOV0rXS9nLCAnWycgKyBpICsgJ10nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiByZXBsYWNlIHRoaXMgd2l0aCBhIHZhbmlsbGEgSlMgc29sdXRpb25cbiAgICAgICAgICAgIG5ldyBTb3J0YWJsZXModGJvZHksIHtcbiAgICAgICAgICAgICAgICBjb25zdHJhaW46IHRydWUsXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMC42LFxuICAgICAgICAgICAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICAgICAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgYWRkRXZlbnRzVG8gPSAodHIpID0+IHtcbiAgICAgICAgICAgIHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpLmZvckVhY2goKGJ0KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IGJ0LmRhdGFzZXQuY29tbWFuZDtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb3B5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBudHIgPSB0ci5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0cyA9IHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5zZWxlY3RzID0gbnRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaj0wOyBqPHNlbGVjdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnNlbGVjdHNbal0udmFsdWUgPSBzZWxlY3RzW2pdLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG50ci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1vcmlnaW5hbC10aXRsZV0nKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVkUm93cy5zZXQobnRyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShudHIsIHRyLm5leHRTaWJsaW5nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50c1RvKG50cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGJvZHkuY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB2YWx1ZXMgZm9yIGxhc3QgZWxlbWVudCAoIzY4OSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JykuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QudmFsdWUgPSBzZWxlY3QuY2hpbGRyZW5bMF0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VuYWJsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBidC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHNhdmVTY3JvbGxPZmZzZXRFdmVudCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYnggPSBidC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNieC5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNieC5jaGVja2VkID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2J4LmNoZWNrZWQgPSAnY2hlY2tlZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0LmNsYXNzTGlzdC5jb250YWlucygnZHJhZy1oYW5kbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd1VwJyB8fCBldmVudC5rZXlDb2RlID09PSAzOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dEb3duJyB8fCBldmVudC5rZXlDb2RlID09PSA0MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLm5leHRFbGVtZW50U2libGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLm5leHRFbGVtZW50U2libGluZy5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ID0gdHIucXVlcnlTZWxlY3RvcigndGQ6Zmlyc3QtY2hpbGQgc2VsZWN0Jyk7XG5cbiAgICAgICAgICAgIGlmICghc2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gdHIucXVlcnlTZWxlY3RvcignYS5tb2R1bGVfbGluaycpO1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VzID0gdHIucXVlcnlTZWxlY3RvckFsbCgnaW1nLm1vZHVsZV9pbWFnZScpO1xuXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVMaW5rID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IGxpbmsuaHJlZi5yZXBsYWNlKC9pZD1bMC05XSsvLCAnaWQ9JyArIHNlbGVjdC52YWx1ZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0LnZhbHVlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgICAgIGltYWdlcy5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VzLmZvckVhY2goKGltYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHVwZGF0ZUxpbmspO1xuICAgICAgICB9O1xuXG4gICAgICAgIG1ha2VTb3J0YWJsZSh0Ym9keSk7XG4gICAgICAgIGFkZEV2ZW50c1RvKHJvdyk7XG4gICAgfTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50bF9tb2R1bGV3aXphcmQgdHInKS5mb3JFYWNoKGluaXQpO1xuXG4gICAgbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24obXV0YXRpb25zTGlzdCkge1xuICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9uc0xpc3QpIHtcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lm1hdGNoZXMgJiYgZWxlbWVudC5tYXRjaGVzKCcudGxfbW9kdWxld2l6YXJkIHRyLCAudGxfbW9kdWxld2l6YXJkIHRyIConKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdChlbGVtZW50LmNsb3Nlc3QoJ3RyJykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pLm9ic2VydmUoZG9jdW1lbnQsIHtcbiAgICAgICAgYXR0cmlidXRlczogZmFsc2UsXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgc3VidHJlZTogdHJ1ZVxuICAgIH0pO1xufSkoKTtcbiIsIi8qXG4tLS1cblxubmFtZTogUmVxdWVzdC5Db250YW9cblxuZGVzY3JpcHRpb246IEV4dGVuZHMgdGhlIE1vb1Rvb2xzIFJlcXVlc3QuSlNPTiBjbGFzcyB3aXRoIENvbnRhby1zcGVjaWZpYyByb3V0aW5lcy5cblxubGljZW5zZTogTEdQTHYzXG5cbmF1dGhvcnM6XG4gLSBMZW8gRmV5ZXJcblxucmVxdWlyZXM6IFtSZXF1ZXN0LCBKU09OXVxuXG5wcm92aWRlczogUmVxdWVzdC5Db250YW9cblxuLi4uXG4qL1xuXG5SZXF1ZXN0LkNvbnRhbyA9IG5ldyBDbGFzcyhcbntcblx0RXh0ZW5kczogUmVxdWVzdC5KU09OLFxuXG5cdG9wdGlvbnM6IHtcblx0XHRmb2xsb3dSZWRpcmVjdHM6IHRydWUsXG5cdFx0dXJsOiB3aW5kb3cubG9jYXRpb24uaHJlZlxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRpZiAob3B0aW9ucyAmJiAhb3B0aW9ucy51cmwgJiYgb3B0aW9ucy5maWVsZCAmJiBvcHRpb25zLmZpZWxkLmZvcm0gJiYgb3B0aW9ucy5maWVsZC5mb3JtLmFjdGlvbikge1xuXHRcdFx0dGhpcy5vcHRpb25zLnVybCA9IG9wdGlvbnMuZmllbGQuZm9ybS5hY3Rpb247XG5cdFx0fVxuXHRcdHRoaXMucGFyZW50KG9wdGlvbnMpO1xuXHR9LFxuXG5cdHN1Y2Nlc3M6IGZ1bmN0aW9uKHRleHQpIHtcblx0XHR2YXIgdXJsID0gdGhpcy5nZXRIZWFkZXIoJ1gtQWpheC1Mb2NhdGlvbicpLFxuXHRcdFx0anNvbjtcblxuXHRcdGlmICh1cmwgJiYgdGhpcy5vcHRpb25zLmZvbGxvd1JlZGlyZWN0cykge1xuXHRcdFx0bG9jYXRpb24ucmVwbGFjZSh1cmwpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFN1cHBvcnQgYm90aCBwbGFpbiB0ZXh0IGFuZCBKU09OIHJlc3BvbnNlc1xuXHRcdHRyeSB7XG5cdFx0XHRqc29uID0gdGhpcy5yZXNwb25zZS5qc29uID0gSlNPTi5kZWNvZGUodGV4dCwgdGhpcy5vcHRpb25zLnNlY3VyZSk7XG5cdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRqc29uID0geydjb250ZW50Jzp0ZXh0fTtcblx0XHR9XG5cblx0XHQvLyBFbXB0eSByZXNwb25zZVxuXHRcdGlmIChqc29uID09PSBudWxsKSB7XG5cdFx0XHRqc29uID0geydjb250ZW50JzonJ307XG5cdFx0fSBlbHNlIGlmICh0eXBlb2YoanNvbikgIT0gJ29iamVjdCcpIHtcblx0XHRcdGpzb24gPSB7J2NvbnRlbnQnOnRleHR9O1xuXHRcdH1cblxuXHRcdC8vIElzb2xhdGUgc2NyaXB0cyBhbmQgZXhlY3V0ZSB0aGVtXG5cdFx0aWYgKGpzb24uY29udGVudCAhPSAnJykge1xuXHRcdFx0anNvbi5jb250ZW50ID0ganNvbi5jb250ZW50LnN0cmlwU2NyaXB0cyhmdW5jdGlvbihzY3JpcHQpIHtcblx0XHRcdFx0anNvbi5qYXZhc2NyaXB0ID0gc2NyaXB0LnJlcGxhY2UoLzwhLS18XFwvXFwvLS0+fDwhXFxbQ0RBVEFcXFtcXC9cXC8+fDwhXV0+L2csICcnKTtcblx0XHRcdH0pO1xuXHRcdFx0aWYgKGpzb24uamF2YXNjcmlwdCAmJiB0aGlzLm9wdGlvbnMuZXZhbFNjcmlwdHMpIHtcblx0XHRcdFx0QnJvd3Nlci5leGVjKGpzb24uamF2YXNjcmlwdCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5vblN1Y2Nlc3MoanNvbi5jb250ZW50LCBqc29uKTtcblx0fSxcblxuXHRmYWlsdXJlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdXJsID0gdGhpcy5nZXRIZWFkZXIoJ1gtQWpheC1Mb2NhdGlvbicpO1xuXG5cdFx0aWYgKHVybCAmJiA0MDEgPT09IHRoaXMuc3RhdHVzKSB7XG5cdFx0XHRsb2NhdGlvbi5yZXBsYWNlKHVybCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKHVybCAmJiB0aGlzLm9wdGlvbnMuZm9sbG93UmVkaXJlY3RzICYmIHRoaXMuc3RhdHVzID49IDMwMCAmJiB0aGlzLnN0YXR1cyA8IDQwMCkge1xuXHRcdFx0bG9jYXRpb24ucmVwbGFjZSh1cmwpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMub25GYWlsdXJlKCk7XG5cdH1cbn0pO1xuXG5cbi8qXG4tLS1cblxubmFtZTogRHJhZ1xuXG5kZXNjcmlwdGlvbjogRXh0ZW5kcyB0aGUgYmFzZSBEcmFnIGNsYXNzIHdpdGggdG91Y2ggc3VwcG9ydC5cblxubGljZW5zZTogTEdQTHYzXG5cbmF1dGhvcnM6XG4gLSBBbmRyZWFzIFNjaGVtcHBcblxucmVxdWlyZXM6IFtEcmFnXVxuXG5wcm92aWRlczogRHJhZ1xuXG4uLi5cbiovXG5cbkNsYXNzLnJlZmFjdG9yKERyYWcsXG57XG5cdGF0dGFjaDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5oYW5kbGVzLmFkZEV2ZW50KCd0b3VjaHN0YXJ0JywgdGhpcy5ib3VuZC5zdGFydCk7XG5cdFx0cmV0dXJuIHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRkZXRhY2g6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaGFuZGxlcy5yZW1vdmVFdmVudCgndG91Y2hzdGFydCcsIHRoaXMuYm91bmQuc3RhcnQpO1xuXHRcdHJldHVybiB0aGlzLnByZXZpb3VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0c3RhcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdGRvY3VtZW50LmFkZEV2ZW50cyh7XG5cdFx0XHR0b3VjaG1vdmU6IHRoaXMuYm91bmQuY2hlY2ssXG5cdFx0XHR0b3VjaGVuZDogdGhpcy5ib3VuZC5jYW5jZWxcblx0XHR9KTtcblx0XHR0aGlzLnByZXZpb3VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0Y2hlY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0aWYgKHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdCkgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHR2YXIgZGlzdGFuY2UgPSBNYXRoLnJvdW5kKE1hdGguc3FydChNYXRoLnBvdyhldmVudC5wYWdlLnggLSB0aGlzLm1vdXNlLnN0YXJ0LngsIDIpICsgTWF0aC5wb3coZXZlbnQucGFnZS55IC0gdGhpcy5tb3VzZS5zdGFydC55LCAyKSkpO1xuXHRcdGlmIChkaXN0YW5jZSA+IHRoaXMub3B0aW9ucy5zbmFwKSB7XG5cdFx0XHR0aGlzLmNhbmNlbCgpO1xuXHRcdFx0dGhpcy5kb2N1bWVudC5hZGRFdmVudHMoe1xuXHRcdFx0XHRtb3VzZW1vdmU6IHRoaXMuYm91bmQuZHJhZyxcblx0XHRcdFx0bW91c2V1cDogdGhpcy5ib3VuZC5zdG9wXG5cdFx0XHR9KTtcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50cyh7XG5cdFx0XHRcdHRvdWNobW92ZTogdGhpcy5ib3VuZC5kcmFnLFxuXHRcdFx0XHR0b3VjaGVuZDogdGhpcy5ib3VuZC5zdG9wXG5cdFx0XHR9KTtcblx0XHRcdHRoaXMuZmlyZUV2ZW50KCdzdGFydCcsIFt0aGlzLmVsZW1lbnQsIGV2ZW50XSkuZmlyZUV2ZW50KCdzbmFwJywgdGhpcy5lbGVtZW50KTtcblx0XHR9XG5cdH0sXG5cblx0Y2FuY2VsOiBmdW5jdGlvbigpIHtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudHMoe1xuXHRcdFx0dG91Y2htb3ZlOiB0aGlzLmJvdW5kLmNoZWNrLFxuXHRcdFx0dG91Y2hlbmQ6IHRoaXMuYm91bmQuY2FuY2VsXG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRzdG9wOiBmdW5jdGlvbigpIHtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudHMoe1xuXHRcdFx0dG91Y2htb3ZlOiB0aGlzLmJvdW5kLmRyYWcsXG5cdFx0XHR0b3VjaGVuZDogdGhpcy5ib3VuZC5zdG9wXG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXMucHJldmlvdXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fVxufSk7XG5cbi8qXG4tLS1cblxubmFtZTogU29ydGFibGVzXG5cbmRlc2NyaXB0aW9uOiBFeHRlbmRzIHRoZSBiYXNlIFNvcnRhYmxlcyBjbGFzcyB3aXRoIHRvdWNoIHN1cHBvcnQuXG5cbmxpY2Vuc2U6IExHUEx2M1xuXG5hdXRob3JzOlxuIC0gQW5kcmVhcyBTY2hlbXBwXG5cbnJlcXVpcmVzOiBbU29ydGFibGVzXVxuXG5wcm92aWRlczogU29ydGFibGVzXG5cbi4uLlxuKi9cblxuQ2xhc3MucmVmYWN0b3IoU29ydGFibGVzLFxue1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihsaXN0cywgb3B0aW9ucykge1xuXHRcdG9wdGlvbnMuZHJhZ09wdGlvbnMgPSBPYmplY3QubWVyZ2Uob3B0aW9ucy5kcmFnT3B0aW9ucyB8fCB7fSwgeyBwcmV2ZW50RGVmYXVsdDogKG9wdGlvbnMuZHJhZ09wdGlvbnMgJiYgb3B0aW9ucy5kcmFnT3B0aW9ucy5wcmV2ZW50RGVmYXVsdCkgfHwgQnJvd3Nlci5GZWF0dXJlcy5Ub3VjaCB9KTtcblx0XHRpZiAob3B0aW9ucy5kcmFnT3B0aW9ucy51bkRyYWdnYWJsZVRhZ3MgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0b3B0aW9ucy5kcmFnT3B0aW9ucy51bkRyYWdnYWJsZVRhZ3MgPSB0aGlzLm9wdGlvbnMudW5EcmFnZ2FibGVUYWdzLmZpbHRlcihmdW5jdGlvbih0YWcpIHtcblx0XHRcdFx0cmV0dXJuIHRhZyAhPSAnYnV0dG9uJztcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5wcmV2aW91cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdGFkZEl0ZW1zOiBmdW5jdGlvbigpIHtcblx0XHRBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuZWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0XHR0aGlzLmVsZW1lbnRzLnB1c2goZWxlbWVudCk7XG5cdFx0XHR2YXIgc3RhcnQgPSBlbGVtZW50LnJldHJpZXZlKCdzb3J0YWJsZXM6c3RhcnQnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0XHR0aGlzLnN0YXJ0LmNhbGwodGhpcywgZXZlbnQsIGVsZW1lbnQpO1xuXHRcdFx0fS5iaW5kKHRoaXMpKTtcblx0XHRcdCh0aGlzLm9wdGlvbnMuaGFuZGxlID8gZWxlbWVudC5nZXRFbGVtZW50KHRoaXMub3B0aW9ucy5oYW5kbGUpIHx8IGVsZW1lbnQgOiBlbGVtZW50KS5hZGRFdmVudHMoe1xuXHRcdFx0XHRtb3VzZWRvd246IHN0YXJ0LFxuXHRcdFx0XHR0b3VjaHN0YXJ0OiBzdGFydFxuXHRcdFx0fSk7XG5cdFx0fSwgdGhpcyk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cmVtb3ZlSXRlbXM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiAkJChBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykubWFwKGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHRcdHRoaXMuZWxlbWVudHMuZXJhc2UoZWxlbWVudCk7XG5cdFx0XHR2YXIgc3RhcnQgPSBlbGVtZW50LnJldHJpZXZlKCdzb3J0YWJsZXM6c3RhcnQnKTtcblx0XHRcdCh0aGlzLm9wdGlvbnMuaGFuZGxlID8gZWxlbWVudC5nZXRFbGVtZW50KHRoaXMub3B0aW9ucy5oYW5kbGUpIHx8IGVsZW1lbnQgOiBlbGVtZW50KS5yZW1vdmVFdmVudHMoe1xuXHRcdFx0XHRtb3VzZWRvd246IHN0YXJ0LFxuXHRcdFx0XHR0b3VjaGVuZDogc3RhcnRcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGVsZW1lbnQ7XG5cdFx0fSwgdGhpcykpO1xuXHR9LFxuXG5cdGdldENsb25lOiBmdW5jdGlvbihldmVudCwgZWxlbWVudCkge1xuXHRcdGlmICghdGhpcy5vcHRpb25zLmNsb25lKSByZXR1cm4gbmV3IEVsZW1lbnQoZWxlbWVudC50YWdOYW1lKS5pbmplY3QoZG9jdW1lbnQuYm9keSk7XG5cdFx0aWYgKHR5cGVPZih0aGlzLm9wdGlvbnMuY2xvbmUpID09ICdmdW5jdGlvbicpIHJldHVybiB0aGlzLm9wdGlvbnMuY2xvbmUuY2FsbCh0aGlzLCBldmVudCwgZWxlbWVudCwgdGhpcy5saXN0KTtcblx0XHR2YXIgY2xvbmUgPSB0aGlzLnByZXZpb3VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0Y2xvbmUuYWRkRXZlbnQoJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0ZWxlbWVudC5maXJlRXZlbnQoJ3RvdWNoc3RhcnQnLCBldmVudCk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGNsb25lO1xuXHR9XG59KTtcblxuLypcbi0tLVxuXG5zY3JpcHQ6IFJlcXVlc3QuUXVldWUuanNcblxubmFtZTogUmVxdWVzdC5RdWV1ZVxuXG5kZXNjcmlwdGlvbjogRXh0ZW5kcyB0aGUgYmFzZSBSZXF1ZXN0LlF1ZXVlIGNsYXNzIGFuZCBhdHRlbXB0cyB0byBmaXggc29tZSBpc3N1ZXMuXG5cbmxpY2Vuc2U6IE1JVC1zdHlsZSBsaWNlbnNlXG5cbmF1dGhvcnM6XG4gLSBMZW8gRmV5ZXJcblxucmVxdWlyZXM6XG5cdC0gQ29yZS9FbGVtZW50XG5cdC0gQ29yZS9SZXF1ZXN0XG5cdC0gQ2xhc3MuQmluZHNcblxucHJvdmlkZXM6IFtSZXF1ZXN0LlF1ZXVlXVxuXG4uLi5cbiovXG5cbkNsYXNzLnJlZmFjdG9yKFJlcXVlc3QuUXVldWUsXG57XG5cdC8vIERvIG5vdCBmaXJlIHRoZSBcImVuZFwiIGV2ZW50IGhlcmVcblx0b25Db21wbGV0ZTogZnVuY3Rpb24oKXtcblx0XHR0aGlzLmZpcmVFdmVudCgnY29tcGxldGUnLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdC8vIENhbGwgcmVzdW1lKCkgaW5zdGVhZCBvZiBydW5OZXh0KClcblx0b25DYW5jZWw6IGZ1bmN0aW9uKCl7XG5cdFx0aWYgKHRoaXMub3B0aW9ucy5hdXRvQWR2YW5jZSAmJiAhdGhpcy5lcnJvcikgdGhpcy5yZXN1bWUoKTtcblx0XHR0aGlzLmZpcmVFdmVudCgnY2FuY2VsJywgYXJndW1lbnRzKTtcblx0fSxcblxuXHQvLyBDYWxsIHJlc3VtZSgpIGluc3RlYWQgb2YgcnVuTmV4dCgpIGFuZCBmaXJlIHRoZSBcImVuZFwiIGV2ZW50XG5cdG9uU3VjY2VzczogZnVuY3Rpb24oKXtcblx0XHRpZiAodGhpcy5vcHRpb25zLmF1dG9BZHZhbmNlICYmICF0aGlzLmVycm9yKSB0aGlzLnJlc3VtZSgpO1xuXHRcdHRoaXMuZmlyZUV2ZW50KCdzdWNjZXNzJywgYXJndW1lbnRzKTtcblx0XHRpZiAoIXRoaXMucXVldWUubGVuZ3RoICYmICF0aGlzLmlzUnVubmluZygpKSB0aGlzLmZpcmVFdmVudCgnZW5kJyk7XG5cdH0sXG5cblx0Ly8gQ2FsbCByZXN1bWUoKSBpbnN0ZWFkIG9mIHJ1bk5leHQoKSBhbmQgZmlyZSB0aGUgXCJlbmRcIiBldmVudFxuXHRvbkZhaWx1cmU6IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5lcnJvciA9IHRydWU7XG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuc3RvcE9uRmFpbHVyZSAmJiB0aGlzLm9wdGlvbnMuYXV0b0FkdmFuY2UpIHRoaXMucmVzdW1lKCk7XG5cdFx0dGhpcy5maXJlRXZlbnQoJ2ZhaWx1cmUnLCBhcmd1bWVudHMpO1xuXHRcdGlmICghdGhpcy5xdWV1ZS5sZW5ndGggJiYgIXRoaXMuaXNSdW5uaW5nKCkpIHRoaXMuZmlyZUV2ZW50KCdlbmQnKTtcblx0fSxcblxuXHQvLyBDYWxsIHJlc3VtZSgpIGluc3RlYWQgb2YgcnVuTmV4dCgpXG5cdG9uRXhjZXB0aW9uOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMuZXJyb3IgPSB0cnVlO1xuXHRcdGlmICghdGhpcy5vcHRpb25zLnN0b3BPbkZhaWx1cmUgJiYgdGhpcy5vcHRpb25zLmF1dG9BZHZhbmNlKSB0aGlzLnJlc3VtZSgpO1xuXHRcdHRoaXMuZmlyZUV2ZW50KCdleGNlcHRpb24nLCBhcmd1bWVudHMpO1xuXHR9XG59KTtcblxuLypcbi0tLVxuXG5uYW1lOiBDb250YW8uU2VycFByZXZpZXdcblxuZGVzY3JpcHRpb246IEdlbmVyYXRlcyBhIFNFUlAgcHJldmlld1xuXG5saWNlbnNlOiBMR1BMdjNcblxuYXV0aG9yczpcbiAtIExlbyBGZXllclxuXG5yZXF1aXJlczogW1JlcXVlc3QsIEpTT05dXG5cbnByb3ZpZGVzOiBDb250YW8uU2VycFByZXZpZXdcblxuLi4uXG4qL1xuXG5Db250YW8uU2VycFByZXZpZXcgPSBuZXcgQ2xhc3MoXG57XG5cdG9wdGlvbnM6IHtcblx0XHRpZDogMCxcblx0XHR0cmFpbDogbnVsbCxcblx0XHR0aXRsZUZpZWxkOiBudWxsLFxuXHRcdHRpdGxlRmFsbGJhY2tGaWVsZDogbnVsbCxcblx0XHRhbGlhc0ZpZWxkOiBudWxsLFxuXHRcdGRlc2NyaXB0aW9uRmllbGQ6IG51bGwsXG5cdFx0ZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkOiBudWxsLFxuXHRcdHRpdGxlVGFnOiBudWxsXG5cdH0sXG5cblx0c2hvcnRlbjogZnVuY3Rpb24oc3RyLCBtYXgpIHtcblx0XHRpZiAoc3RyLmxlbmd0aCA8PSBtYXgpIHtcblx0XHRcdHJldHVybiBzdHI7XG5cdFx0fVxuXHRcdHJldHVybiBzdHIuc3Vic3RyKDAsIHN0ci5sYXN0SW5kZXhPZignICcsIG1heCkpICsgJyDigKYnO1xuXHR9LFxuXG5cdGh0bWwyc3RyaW5nOiBmdW5jdGlvbihodG1sKSB7XG5cdFx0cmV0dXJuIG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoaHRtbCwgJ3RleHQvaHRtbCcpLmJvZHkudGV4dENvbnRlbnQucmVwbGFjZSgvXFxbLV0vZywgJ1xceEFEJykucmVwbGFjZSgvXFxbbmJzcF0vZywgJ1xceEEwJyk7XG5cdH0sXG5cblx0Z2V0VGlueW1jZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHdpbmRvdy50aW55TUNFICYmIHRoaXMub3B0aW9ucy5kZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQpIHtcblx0XHRcdHJldHVybiB3aW5kb3cudGlueU1DRS5nZXQodGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCk7XG5cdFx0fVxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdFR1cmJvLmNhY2hlLmV4ZW1wdFBhZ2VGcm9tQ2FjaGUoKTtcblxuXHRcdHRoaXMub3B0aW9ucyA9IE9iamVjdC5tZXJnZS5hcHBseShudWxsLCBbe30sIHRoaXMub3B0aW9uc10uYXBwZW5kKGFyZ3VtZW50cykpO1xuXG5cdFx0dmFyIHNlcnBUaXRsZSA9ICQoJ3NlcnBfdGl0bGVfJyArIHRoaXMub3B0aW9ucy5pZCksXG5cdFx0XHRzZXJwVXJsID0gJCgnc2VycF91cmxfJyArIHRoaXMub3B0aW9ucy5pZCksXG5cdFx0XHRzZXJwRGVzY3JpcHRpb24gPSAkKCdzZXJwX2Rlc2NyaXB0aW9uXycgKyB0aGlzLm9wdGlvbnMuaWQpLFxuXHRcdFx0dGl0bGVGaWVsZCA9ICQodGhpcy5vcHRpb25zLnRpdGxlRmllbGQpLFxuXHRcdFx0dGl0bGVGYWxsYmFja0ZpZWxkID0gJCh0aGlzLm9wdGlvbnMudGl0bGVGYWxsYmFja0ZpZWxkKSxcblx0XHRcdGFsaWFzRmllbGQgPSAkKHRoaXMub3B0aW9ucy5hbGlhc0ZpZWxkKSxcblx0XHRcdGRlc2NyaXB0aW9uRmllbGQgPSAkKHRoaXMub3B0aW9ucy5kZXNjcmlwdGlvbkZpZWxkKSxcblx0XHRcdGRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCA9ICQodGhpcy5vcHRpb25zLmRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZCksXG5cdFx0XHRpbmRleEVtcHR5ID0gdGhpcy5vcHRpb25zLnRyYWlsLmluZGV4T2YoJ+KAuicpID09PSAtMSxcblx0XHRcdHRpdGxlVGFnID0gdGhpcy5vcHRpb25zLnRpdGxlVGFnIHx8ICclcyc7XG5cblx0XHR0aXRsZUZpZWxkICYmIHRpdGxlRmllbGQuYWRkRXZlbnQoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodGl0bGVGaWVsZC52YWx1ZSkge1xuXHRcdFx0XHRzZXJwVGl0bGUuc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcodGl0bGVUYWcucmVwbGFjZSgvJXMvLCB0aXRsZUZpZWxkLnZhbHVlKSkucmVwbGFjZSgvJSUvZywgJyUnKSwgNjQpKTtcblx0XHRcdH0gZWxzZSBpZiAodGl0bGVGYWxsYmFja0ZpZWxkICYmIHRpdGxlRmFsbGJhY2tGaWVsZC52YWx1ZSkge1xuXHRcdFx0XHRzZXJwVGl0bGUuc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcodGl0bGVUYWcucmVwbGFjZSgvJXMvLCB0aXRsZUZhbGxiYWNrRmllbGQudmFsdWUpKS5yZXBsYWNlKC8lJS9nLCAnJScpLCA2NCkpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2VycFRpdGxlLnNldCgndGV4dCcsICcnKTtcblx0XHRcdH1cblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0dGl0bGVGYWxsYmFja0ZpZWxkICYmIHRpdGxlRmFsbGJhY2tGaWVsZC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aXRsZUZpZWxkICYmIHRpdGxlRmllbGQudmFsdWUpIHJldHVybjtcblx0XHRcdHNlcnBUaXRsZS5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4odGhpcy5odG1sMnN0cmluZyh0aXRsZVRhZy5yZXBsYWNlKC8lcy8sIHRpdGxlRmFsbGJhY2tGaWVsZC52YWx1ZSkpLnJlcGxhY2UoLyUlL2csICclJyksIDY0KSk7XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdGFsaWFzRmllbGQgJiYgYWxpYXNGaWVsZC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmIChhbGlhc0ZpZWxkLnZhbHVlID09ICdpbmRleCcgJiYgaW5kZXhFbXB0eSkge1xuXHRcdFx0XHRzZXJwVXJsLnNldCgndGV4dCcsIHRoaXMub3B0aW9ucy50cmFpbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXJwVXJsLnNldCgndGV4dCcsIHRoaXMub3B0aW9ucy50cmFpbCArICcg4oC6ICcgKyAoYWxpYXNGaWVsZC52YWx1ZSB8fCB0aGlzLm9wdGlvbnMuaWQpLnJlcGxhY2UoL1xcLy9nLCAnIOKAuiAnKSk7XG5cdFx0XHR9XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdGRlc2NyaXB0aW9uRmllbGQgJiYgZGVzY3JpcHRpb25GaWVsZC5hZGRFdmVudCgnaW5wdXQnLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmIChkZXNjcmlwdGlvbkZpZWxkLnZhbHVlKSB7XG5cdFx0XHRcdHNlcnBEZXNjcmlwdGlvbi5zZXQoJ3RleHQnLCB0aGlzLnNob3J0ZW4oZGVzY3JpcHRpb25GaWVsZC52YWx1ZSwgMTYwKSk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHZhciBlZGl0b3IgPSB0aGlzLmdldFRpbnltY2UoKTtcblx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0c2VycERlc2NyaXB0aW9uLnNldCgndGV4dCcsIHRoaXMuc2hvcnRlbih0aGlzLmh0bWwyc3RyaW5nKGVkaXRvci5nZXRDb250ZW50KCkpLCAxNjApKTtcblx0XHRcdH0gZWxzZSBpZiAoZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkICYmIGRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZC52YWx1ZSkge1xuXHRcdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcoZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkLnZhbHVlKSwgMTYwKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgJycpO1xuXHRcdFx0fVxuXHRcdH0uYmluZCh0aGlzKSk7XG5cblx0XHRkZXNjcmlwdGlvbkZhbGxiYWNrRmllbGQgJiYgZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkLmFkZEV2ZW50KCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGRlc2NyaXB0aW9uRmllbGQgJiYgZGVzY3JpcHRpb25GaWVsZC52YWx1ZSkgcmV0dXJuO1xuXHRcdFx0c2VycERlc2NyaXB0aW9uLnNldCgndGV4dCcsIHRoaXMuc2hvcnRlbih0aGlzLmh0bWwyc3RyaW5nKGRlc2NyaXB0aW9uRmFsbGJhY2tGaWVsZC52YWx1ZSksIDE2MCkpO1xuXHRcdH0uYmluZCh0aGlzKSk7XG5cblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGVkaXRvciA9IHRoaXMuZ2V0VGlueW1jZSgpO1xuXHRcdFx0ZWRpdG9yICYmIGVkaXRvci5vbigna2V5dXAnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKGRlc2NyaXB0aW9uRmllbGQgJiYgZGVzY3JpcHRpb25GaWVsZC52YWx1ZSkgcmV0dXJuO1xuXHRcdFx0XHRzZXJwRGVzY3JpcHRpb24uc2V0KCd0ZXh0JywgdGhpcy5zaG9ydGVuKHRoaXMuaHRtbDJzdHJpbmcod2luZG93LnRpbnlNQ0UuYWN0aXZlRWRpdG9yLmdldENvbnRlbnQoKSksIDE2MCkpO1xuXHRcdFx0fS5iaW5kKHRoaXMpKTtcblx0XHR9LmJpbmQodGhpcyksIDQpO1xuXHR9XG59KTtcbiIsIihmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGNvbnN0IGluaXRpYWxpemVkUm93cyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgY29uc3Qgc2F2ZVNjcm9sbE9mZnNldEV2ZW50ID0gbmV3IEV2ZW50KCdzdG9yZS1zY3JvbGwtb2Zmc2V0Jyk7XG5cbiAgICBjb25zdCBpbml0ID0gKHJvdykgPT4ge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIHJvdyBoYXMgYWxyZWFkeSBiZWVuIGluaXRpYWxpemVkXG4gICAgICAgIGlmIChpbml0aWFsaXplZFJvd3MuaGFzKHJvdykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSByb3cgaGFzIGFsbCBuZWNlc3NhcnkgZWxlbWVudHMgdG8gcHJldmVudCB0aGUgbXV0YXRpb24gb2JzZXJ2ZXJcbiAgICAgICAgLy8gZnJvbSBpbml0aWFsaXppbmcgdGhlIGluY29tcGxldGUgd2lkZ2V0LlxuICAgICAgICBpZiAoIXJvdy5xdWVyeVNlbGVjdG9yKCdidXR0b24uZHJhZy1oYW5kbGUnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5pdGlhbGl6ZWRSb3dzLnNldChyb3csIHRydWUpO1xuXG4gICAgICAgIGNvbnN0IHRib2R5ID0gcm93LmNsb3Nlc3QoJ3Rib2R5Jyk7XG5cbiAgICAgICAgY29uc3QgbWFrZVNvcnRhYmxlID0gKHRib2R5KSA9PiB7XG4gICAgICAgICAgICBBcnJheS5mcm9tKHRib2R5LmNoaWxkcmVuKS5mb3JFYWNoKCh0ciwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0LCBzZWxlY3QnKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBlbC5uYW1lID0gZWwubmFtZS5yZXBsYWNlKC9cXFtbMC05XStdL2csICdbJyArIGkgKyAnXScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFRPRE86IHJlcGxhY2UgdGhpcyB3aXRoIGEgdmFuaWxsYSBKUyBzb2x1dGlvblxuICAgICAgICAgICAgbmV3IFNvcnRhYmxlcyh0Ym9keSwge1xuICAgICAgICAgICAgICAgIGNvbnN0cmFpbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjYsXG4gICAgICAgICAgICAgICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICAgICAgICAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBhZGRFdmVudHNUbyA9ICh0cikgPT4ge1xuICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uJykuZm9yRWFjaCgoYnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21tYW5kID0gYnQuZGF0YXNldC5jb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvcHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgYnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQoc2F2ZVNjcm9sbE9mZnNldEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBudHIgPSB0ci5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0cyA9IHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5zZWxlY3RzID0gbnRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGo9MDsgajxzZWxlY3RzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5zZWxlY3RzW2pdLnZhbHVlID0gc2VsZWN0c1tqXS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobnRyLCB0ci5uZXh0U2libGluZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRzVG8obnRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgYnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQoc2F2ZVNjcm9sbE9mZnNldEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGJvZHkuY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB2YWx1ZXMgZm9yIGxhc3QgZWxlbWVudCAoIzY4OSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JykuZm9yRWFjaCgoc2VsZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QudmFsdWUgPSBzZWxlY3QuY2hpbGRyZW5bMF0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0LmNsYXNzTGlzdC5jb250YWlucygnZHJhZy1oYW5kbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd1VwJyB8fCBldmVudC5rZXlDb2RlID09PSAzOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIucHJldmlvdXNFbGVtZW50U2libGluZy5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWJlZ2luJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIHRyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU29ydGFibGUodGJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd0Rvd24nIHx8IGV2ZW50LmtleUNvZGUgPT09IDQwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyLm5leHRFbGVtZW50U2libGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLm5leHRFbGVtZW50U2libGluZy5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCB0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgbWFrZVNvcnRhYmxlKHRib2R5KTtcbiAgICAgICAgYWRkRXZlbnRzVG8ocm93KTtcbiAgICB9O1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRsX3NlY3Rpb253aXphcmQgdHInKS5mb3JFYWNoKGluaXQpO1xuXG4gICAgbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24obXV0YXRpb25zTGlzdCkge1xuICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9uc0xpc3QpIHtcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lm1hdGNoZXMgJiYgZWxlbWVudC5tYXRjaGVzKCcudGxfc2VjdGlvbndpemFyZCB0ciwgLnRsX3NlY3Rpb253aXphcmQgdHIgKicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0KGVsZW1lbnQuY2xvc2VzdCgndHInKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSkub2JzZXJ2ZShkb2N1bWVudCwge1xuICAgICAgICBhdHRyaWJ1dGVzOiBmYWxzZSxcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgfSk7XG59KSgpO1xuIiwiaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ0Bob3R3aXJlZC9zdGltdWx1cyc7XG5pbXBvcnQgeyBicm93c2VyU3VwcG9ydHNXZWJBdXRobkF1dG9maWxsLCBicm93c2VyU3VwcG9ydHNXZWJBdXRobiwgc3RhcnRBdXRoZW50aWNhdGlvbiwgc3RhcnRSZWdpc3RyYXRpb24gfSBmcm9tICdAc2ltcGxld2ViYXV0aG4vYnJvd3Nlcic7XG5cbmNsYXNzIGRlZmF1bHRfMSBleHRlbmRzIENvbnRyb2xsZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLmNvbm5lY3QgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0UmVzdWx0VXJsOiB0aGlzLnJlcXVlc3RSZXN1bHRVcmxWYWx1ZSxcbiAgICAgICAgICAgICAgICByZXF1ZXN0T3B0aW9uc1VybDogdGhpcy5yZXF1ZXN0T3B0aW9uc1VybFZhbHVlLFxuICAgICAgICAgICAgICAgIHJlcXVlc3RTdWNjZXNzUmVkaXJlY3RVcmk6IChfYSA9IHRoaXMucmVxdWVzdFN1Y2Nlc3NSZWRpcmVjdFVyaVZhbHVlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBudWxsLFxuICAgICAgICAgICAgICAgIGNyZWF0aW9uUmVzdWx0VXJsOiB0aGlzLmNyZWF0aW9uUmVzdWx0VXJsVmFsdWUsXG4gICAgICAgICAgICAgICAgY3JlYXRpb25PcHRpb25zVXJsOiB0aGlzLmNyZWF0aW9uT3B0aW9uc1VybFZhbHVlLFxuICAgICAgICAgICAgICAgIGNyZWF0aW9uU3VjY2Vzc1JlZGlyZWN0VXJpOiAoX2IgPSB0aGlzLmNyZWF0aW9uU3VjY2Vzc1JlZGlyZWN0VXJpVmFsdWUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IG51bGwsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46Y29ubmVjdCcsIHsgb3B0aW9ucyB9KTtcbiAgICAgICAgICAgIGNvbnN0IHN1cHBvcnRBdXRvZmlsbCA9IGF3YWl0IGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwoKTtcbiAgICAgICAgICAgIGlmIChzdXBwb3J0QXV0b2ZpbGwgJiYgdGhpcy51c2VCcm93c2VyQXV0b2ZpbGxWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNSZXNwb25zZUpzb24gPSBhd2FpdCB0aGlzLl9nZXRQdWJsaWNLZXlDcmVkZW50aWFsUmVxdWVzdE9wdGlvbnMoe30pO1xuICAgICAgICAgICAgICAgIGlmICghb3B0aW9uc1Jlc3BvbnNlSnNvbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NTaWduaW4ob3B0aW9uc1Jlc3BvbnNlSnNvbiwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFzeW5jIHNpZ25pbihldmVudCkge1xuICAgICAgICBjb25zb2xlLmRlYnVnKGV2ZW50KTtcbiAgICAgICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCd1bnN1cHBvcnRlZCcpO1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46dW5zdXBwb3J0ZWQnLCB7fSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uc1Jlc3BvbnNlSnNvbiA9IGF3YWl0IHRoaXMuX2dldFB1YmxpY0tleUNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyhudWxsKTtcbiAgICAgICAgaWYgKCFvcHRpb25zUmVzcG9uc2VKc29uKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdubyBvcHRpb25zJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5kZWJ1ZygncHJvY2VzcycpO1xuICAgICAgICB0aGlzLl9wcm9jZXNzU2lnbmluKG9wdGlvbnNSZXNwb25zZUpzb24sIGZhbHNlKTtcbiAgICB9XG4gICAgYXN5bmMgX3Byb2Nlc3NTaWduaW4ob3B0aW9uc1Jlc3BvbnNlSnNvbiwgdXNlQnJvd3NlckF1dG9maWxsKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBhdXRoZW50aWNhdG9yUmVzcG9uc2UgPSBhd2FpdCBzdGFydEF1dGhlbnRpY2F0aW9uKG9wdGlvbnNSZXNwb25zZUpzb24sIHVzZUJyb3dzZXJBdXRvZmlsbCk7XG4gICAgICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCd3ZWJhdXRobjphdXRoZW50aWNhdG9yOnJlc3BvbnNlJywgeyByZXNwb25zZTogYXV0aGVudGljYXRvclJlc3BvbnNlIH0pO1xuICAgICAgICAgICAgY29uc3QgYXNzZXJ0aW9uUmVzcG9uc2UgPSBhd2FpdCB0aGlzLl9nZXRBc3NlcnRpb25SZXNwb25zZShhdXRoZW50aWNhdG9yUmVzcG9uc2UpO1xuICAgICAgICAgICAgaWYgKGFzc2VydGlvblJlc3BvbnNlICE9PSBmYWxzZSAmJiB0aGlzLnJlcXVlc3RTdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHRoaXMucmVxdWVzdFN1Y2Nlc3NSZWRpcmVjdFVyaVZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ3Byb2Nlc3NlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdmYWlsdXJlJyk7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKGUpO1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46YXNzZXJ0aW9uOmZhaWx1cmUnLCB7fSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgc2lnbnVwKGV2ZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIWJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCd3ZWJhdXRobjp1bnN1cHBvcnRlZCcsIHt9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uc1Jlc3BvbnNlSnNvbiA9IGF3YWl0IHRoaXMuX2dldFB1YmxpY0tleUNyZWRlbnRpYWxDcmVhdGlvbk9wdGlvbnMobnVsbCk7XG4gICAgICAgICAgICBpZiAoIW9wdGlvbnNSZXNwb25zZUpzb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhdXRoZW50aWNhdG9yUmVzcG9uc2UgPSBhd2FpdCBzdGFydFJlZ2lzdHJhdGlvbihvcHRpb25zUmVzcG9uc2VKc29uKTtcbiAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3dlYmF1dGhuOmF1dGhlbnRpY2F0b3I6cmVzcG9uc2UnLCB7IHJlc3BvbnNlOiBhdXRoZW50aWNhdG9yUmVzcG9uc2UgfSk7XG4gICAgICAgICAgICBjb25zdCBhdHRlc3RhdGlvblJlc3BvbnNlSlNPTiA9IGF3YWl0IHRoaXMuX2dldEF0dGVzdGF0aW9uUmVzcG9uc2UoYXV0aGVudGljYXRvclJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmIChhdHRlc3RhdGlvblJlc3BvbnNlSlNPTiAhPT0gZmFsc2UgJiYgdGhpcy5jcmVhdGlvblN1Y2Nlc3NSZWRpcmVjdFVyaVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UodGhpcy5jcmVhdGlvblN1Y2Nlc3NSZWRpcmVjdFVyaVZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46YXR0ZXN0YXRpb246ZmFpbHVyZScsIHt9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfZGlzcGF0Y2hFdmVudChuYW1lLCBwYXlsb2FkKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChuYW1lLCB7IGRldGFpbDogcGF5bG9hZCwgYnViYmxlczogdHJ1ZSB9KSk7XG4gICAgfVxuICAgIF9nZXREYXRhKCkge1xuICAgICAgICBsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlcG9ydFZhbGlkaXR5KCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZWxlbWVudC5jaGVja1ZhbGlkaXR5KCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhID0gbmV3IEZvcm1EYXRhKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZW1vdmVFbXB0eShvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhvYmopXG4gICAgICAgICAgICAgICAgLmZpbHRlcigoWywgdl0pID0+IHYgIT09IG51bGwgJiYgdiAhPT0gJycpXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoYWNjLCBbaywgdl0pID0+IChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGFjYyksIHsgW2tdOiB2ID09PSBPYmplY3QodikgPyByZW1vdmVFbXB0eSh2KSA6IHYgfSkpLCB7fSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlbW92ZUVtcHR5KHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiBkYXRhLmdldCh0aGlzLnVzZXJuYW1lRmllbGRWYWx1ZSksXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogZGF0YS5nZXQodGhpcy5kaXNwbGF5TmFtZUZpZWxkVmFsdWUpLFxuICAgICAgICAgICAgYXR0ZXN0YXRpb246IGRhdGEuZ2V0KHRoaXMuYXR0ZXN0YXRpb25GaWVsZFZhbHVlKSxcbiAgICAgICAgICAgIHVzZXJWZXJpZmljYXRpb246IGRhdGEuZ2V0KHRoaXMudXNlclZlcmlmaWNhdGlvbkZpZWxkVmFsdWUpLFxuICAgICAgICAgICAgcmVzaWRlbnRLZXk6IGRhdGEuZ2V0KHRoaXMucmVzaWRlbnRLZXlGaWVsZFZhbHVlKSxcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0b3JBdHRhY2htZW50OiBkYXRhLmdldCh0aGlzLmF1dGhlbnRpY2F0b3JBdHRhY2htZW50RmllbGRWYWx1ZSksXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0UHVibGljS2V5Q3JlZGVudGlhbFJlcXVlc3RPcHRpb25zKGZvcm1EYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRPcHRpb25zKHRoaXMucmVxdWVzdE9wdGlvbnNVcmxWYWx1ZSwgZm9ybURhdGEpO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0UHVibGljS2V5Q3JlZGVudGlhbENyZWF0aW9uT3B0aW9ucyhmb3JtRGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0T3B0aW9ucyh0aGlzLmNyZWF0aW9uT3B0aW9uc1VybFZhbHVlLCBmb3JtRGF0YSk7XG4gICAgfVxuICAgIGFzeW5jIF9nZXRPcHRpb25zKHVybCwgZm9ybURhdGEpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGZvcm1EYXRhIHx8IHRoaXMuX2dldERhdGEoKTtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46b3B0aW9uczpyZXF1ZXN0JywgeyBkYXRhIH0pO1xuICAgICAgICBjb25zdCBvcHRpb25zUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IE9iamVjdC5hc3NpZ24oe30sIHRoaXMucmVxdWVzdEhlYWRlcnNWYWx1ZSksXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIW9wdGlvbnNSZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnd2ViYXV0aG46b3B0aW9uczpmYWlsdXJlJywge30pO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBhd2FpdCBvcHRpb25zUmVzcG9uc2UuanNvbigpO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCd3ZWJhdXRobjpvcHRpb25zOnN1Y2Nlc3MnLCB7IGRhdGE6IG9wdGlvbnMgfSk7XG4gICAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0QXR0ZXN0YXRpb25SZXNwb25zZShhdXRoZW50aWNhdG9yUmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFJlc3VsdCh0aGlzLmNyZWF0aW9uUmVzdWx0VXJsVmFsdWUsICd3ZWJhdXRobjphdHRlc3RhdGlvbjonLCBhdXRoZW50aWNhdG9yUmVzcG9uc2UpO1xuICAgIH1cbiAgICBhc3luYyBfZ2V0QXNzZXJ0aW9uUmVzcG9uc2UoYXV0aGVudGljYXRvclJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRSZXN1bHQodGhpcy5yZXF1ZXN0UmVzdWx0VXJsVmFsdWUsICd3ZWJhdXRobjphc3NlcnRpb246JywgYXV0aGVudGljYXRvclJlc3BvbnNlKTtcbiAgICB9XG4gICAgYXN5bmMgX2dldFJlc3VsdCh1cmwsIGV2ZW50UHJlZml4LCBhdXRoZW50aWNhdG9yUmVzcG9uc2UpIHtcbiAgICAgICAgY29uc3QgYXR0ZXN0YXRpb25SZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5yZXF1ZXN0SGVhZGVyc1ZhbHVlKSxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYXV0aGVudGljYXRvclJlc3BvbnNlKVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFhdHRlc3RhdGlvblJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KGV2ZW50UHJlZml4ICsgJ2ZhaWx1cmUnLCB7fSk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXR0ZXN0YXRpb25SZXNwb25zZUpTT04gPSBhd2FpdCBhdHRlc3RhdGlvblJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudChldmVudFByZWZpeCArICdzdWNjZXNzJywgeyBkYXRhOiBhdHRlc3RhdGlvblJlc3BvbnNlSlNPTiB9KTtcbiAgICAgICAgcmV0dXJuIGF0dGVzdGF0aW9uUmVzcG9uc2VKU09OO1xuICAgIH1cbn1cbmRlZmF1bHRfMS52YWx1ZXMgPSB7XG4gICAgcmVxdWVzdFJlc3VsdFVybDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcvcmVxdWVzdCcgfSxcbiAgICByZXF1ZXN0T3B0aW9uc1VybDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcvcmVxdWVzdC9vcHRpb25zJyB9LFxuICAgIHJlcXVlc3RTdWNjZXNzUmVkaXJlY3RVcmk6IFN0cmluZyxcbiAgICBjcmVhdGlvblJlc3VsdFVybDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcvY3JlYXRpb24nIH0sXG4gICAgY3JlYXRpb25PcHRpb25zVXJsOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJy9jcmVhdGlvbi9vcHRpb25zJyB9LFxuICAgIGNyZWF0aW9uU3VjY2Vzc1JlZGlyZWN0VXJpOiBTdHJpbmcsXG4gICAgdXNlcm5hbWVGaWVsZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICd1c2VybmFtZScgfSxcbiAgICBkaXNwbGF5TmFtZUZpZWxkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ2Rpc3BsYXlOYW1lJyB9LFxuICAgIGF0dGVzdGF0aW9uRmllbGQ6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnYXR0ZXN0YXRpb24nIH0sXG4gICAgdXNlclZlcmlmaWNhdGlvbkZpZWxkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ3VzZXJWZXJpZmljYXRpb24nIH0sXG4gICAgcmVzaWRlbnRLZXlGaWVsZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICdyZXNpZGVudEtleScgfSxcbiAgICBhdXRoZW50aWNhdG9yQXR0YWNobWVudEZpZWxkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJ2F1dGhlbnRpY2F0b3JBdHRhY2htZW50JyB9LFxuICAgIHVzZUJyb3dzZXJBdXRvZmlsbDogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9LFxuICAgIHJlcXVlc3RIZWFkZXJzOiB7IHR5cGU6IE9iamVjdCwgZGVmYXVsdDoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnbW9kZSc6ICduby1jb3JzJyxcbiAgICAgICAgICAgICdjcmVkZW50aWFscyc6ICdpbmNsdWRlJ1xuICAgICAgICB9IH0sXG59O1xuXG5leHBvcnQgeyBkZWZhdWx0XzEgYXMgZGVmYXVsdCB9O1xuIiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXG5leHBvcnQge307IiwiLyogW0BzaW1wbGV3ZWJhdXRobi9icm93c2VyQDEwLjAuMF0gKi9cbmZ1bmN0aW9uIGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKGJ1ZmZlcikge1xuICAgIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChjb25zdCBjaGFyQ29kZSBvZiBieXRlcykge1xuICAgICAgICBzdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaGFyQ29kZSk7XG4gICAgfVxuICAgIGNvbnN0IGJhc2U2NFN0cmluZyA9IGJ0b2Eoc3RyKTtcbiAgICByZXR1cm4gYmFzZTY0U3RyaW5nLnJlcGxhY2UoL1xcKy9nLCAnLScpLnJlcGxhY2UoL1xcLy9nLCAnXycpLnJlcGxhY2UoLz0vZywgJycpO1xufVxuXG5mdW5jdGlvbiBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlcihiYXNlNjRVUkxTdHJpbmcpIHtcbiAgICBjb25zdCBiYXNlNjQgPSBiYXNlNjRVUkxTdHJpbmcucmVwbGFjZSgvLS9nLCAnKycpLnJlcGxhY2UoL18vZywgJy8nKTtcbiAgICBjb25zdCBwYWRMZW5ndGggPSAoNCAtIChiYXNlNjQubGVuZ3RoICUgNCkpICUgNDtcbiAgICBjb25zdCBwYWRkZWQgPSBiYXNlNjQucGFkRW5kKGJhc2U2NC5sZW5ndGggKyBwYWRMZW5ndGgsICc9Jyk7XG4gICAgY29uc3QgYmluYXJ5ID0gYXRvYihwYWRkZWQpO1xuICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihiaW5hcnkubGVuZ3RoKTtcbiAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5hcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYnl0ZXNbaV0gPSBiaW5hcnkuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZmZlcjtcbn1cblxuZnVuY3Rpb24gYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4oKSB7XG4gICAgcmV0dXJuICh3aW5kb3c/LlB1YmxpY0tleUNyZWRlbnRpYWwgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICB0eXBlb2Ygd2luZG93LlB1YmxpY0tleUNyZWRlbnRpYWwgPT09ICdmdW5jdGlvbicpO1xufVxuXG5mdW5jdGlvbiB0b1B1YmxpY0tleUNyZWRlbnRpYWxEZXNjcmlwdG9yKGRlc2NyaXB0b3IpIHtcbiAgICBjb25zdCB7IGlkIH0gPSBkZXNjcmlwdG9yO1xuICAgIHJldHVybiB7XG4gICAgICAgIC4uLmRlc2NyaXB0b3IsXG4gICAgICAgIGlkOiBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlcihpZCksXG4gICAgICAgIHRyYW5zcG9ydHM6IGRlc2NyaXB0b3IudHJhbnNwb3J0cyxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBpc1ZhbGlkRG9tYWluKGhvc3RuYW1lKSB7XG4gICAgcmV0dXJuIChob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcgfHxcbiAgICAgICAgL14oW2EtejAtOV0rKC1bYS16MC05XSspKlxcLikrW2Etel17Mix9JC9pLnRlc3QoaG9zdG5hbWUpKTtcbn1cblxuY2xhc3MgV2ViQXV0aG5FcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UsIGNvZGUsIGNhdXNlLCBuYW1lLCB9KSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UsIHsgY2F1c2UgfSk7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWUgPz8gY2F1c2UubmFtZTtcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGlkZW50aWZ5UmVnaXN0cmF0aW9uRXJyb3IoeyBlcnJvciwgb3B0aW9ucywgfSkge1xuICAgIGNvbnN0IHsgcHVibGljS2V5IH0gPSBvcHRpb25zO1xuICAgIGlmICghcHVibGljS2V5KSB7XG4gICAgICAgIHRocm93IEVycm9yKCdvcHRpb25zIHdhcyBtaXNzaW5nIHJlcXVpcmVkIHB1YmxpY0tleSBwcm9wZXJ0eScpO1xuICAgIH1cbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgIGlmIChvcHRpb25zLnNpZ25hbCBpbnN0YW5jZW9mIEFib3J0U2lnbmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdSZWdpc3RyYXRpb24gY2VyZW1vbnkgd2FzIHNlbnQgYW4gYWJvcnQgc2lnbmFsJyxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfQ0VSRU1PTllfQUJPUlRFRCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ0NvbnN0cmFpbnRFcnJvcicpIHtcbiAgICAgICAgaWYgKHB1YmxpY0tleS5hdXRoZW50aWNhdG9yU2VsZWN0aW9uPy5yZXF1aXJlUmVzaWRlbnRLZXkgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0Rpc2NvdmVyYWJsZSBjcmVkZW50aWFscyB3ZXJlIHJlcXVpcmVkIGJ1dCBubyBhdmFpbGFibGUgYXV0aGVudGljYXRvciBzdXBwb3J0ZWQgaXQnLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX01JU1NJTkdfRElTQ09WRVJBQkxFX0NSRURFTlRJQUxfU1VQUE9SVCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHVibGljS2V5LmF1dGhlbnRpY2F0b3JTZWxlY3Rpb24/LnVzZXJWZXJpZmljYXRpb24gPT09ICdyZXF1aXJlZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VzZXIgdmVyaWZpY2F0aW9uIHdhcyByZXF1aXJlZCBidXQgbm8gYXZhaWxhYmxlIGF1dGhlbnRpY2F0b3Igc3VwcG9ydGVkIGl0JyxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfQVVUSEVOVElDQVRPUl9NSVNTSU5HX1VTRVJfVkVSSUZJQ0FUSU9OX1NVUFBPUlQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdJbnZhbGlkU3RhdGVFcnJvcicpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUaGUgYXV0aGVudGljYXRvciB3YXMgcHJldmlvdXNseSByZWdpc3RlcmVkJyxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX1BSRVZJT1VTTFlfUkVHSVNURVJFRCcsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnTm90QWxsb3dlZEVycm9yJykge1xuICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9QQVNTVEhST1VHSF9TRUVfQ0FVU0VfUFJPUEVSVFknLFxuICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ05vdFN1cHBvcnRlZEVycm9yJykge1xuICAgICAgICBjb25zdCB2YWxpZFB1YktleUNyZWRQYXJhbXMgPSBwdWJsaWNLZXkucHViS2V5Q3JlZFBhcmFtcy5maWx0ZXIoKHBhcmFtKSA9PiBwYXJhbS50eXBlID09PSAncHVibGljLWtleScpO1xuICAgICAgICBpZiAodmFsaWRQdWJLZXlDcmVkUGFyYW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnTm8gZW50cnkgaW4gcHViS2V5Q3JlZFBhcmFtcyB3YXMgb2YgdHlwZSBcInB1YmxpYy1rZXlcIicsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX01BTEZPUk1FRF9QVUJLRVlDUkVEUEFSQU1TJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogJ05vIGF2YWlsYWJsZSBhdXRoZW50aWNhdG9yIHN1cHBvcnRlZCBhbnkgb2YgdGhlIHNwZWNpZmllZCBwdWJLZXlDcmVkUGFyYW1zIGFsZ29yaXRobXMnLFxuICAgICAgICAgICAgY29kZTogJ0VSUk9SX0FVVEhFTlRJQ0FUT1JfTk9fU1VQUE9SVEVEX1BVQktFWUNSRURQQVJBTVNfQUxHJyxcbiAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdTZWN1cml0eUVycm9yJykge1xuICAgICAgICBjb25zdCBlZmZlY3RpdmVEb21haW4gPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7XG4gICAgICAgIGlmICghaXNWYWxpZERvbWFpbihlZmZlY3RpdmVEb21haW4pKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGAke3dpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZX0gaXMgYW4gaW52YWxpZCBkb21haW5gLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9JTlZBTElEX0RPTUFJTicsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHVibGljS2V5LnJwLmlkICE9PSBlZmZlY3RpdmVEb21haW4pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYFRoZSBSUCBJRCBcIiR7cHVibGljS2V5LnJwLmlkfVwiIGlzIGludmFsaWQgZm9yIHRoaXMgZG9tYWluYCxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfSU5WQUxJRF9SUF9JRCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ1R5cGVFcnJvcicpIHtcbiAgICAgICAgaWYgKHB1YmxpY0tleS51c2VyLmlkLmJ5dGVMZW5ndGggPCAxIHx8IHB1YmxpY0tleS51c2VyLmlkLmJ5dGVMZW5ndGggPiA2NCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnVXNlciBJRCB3YXMgbm90IGJldHdlZW4gMSBhbmQgNjQgY2hhcmFjdGVycycsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0lOVkFMSURfVVNFUl9JRF9MRU5HVEgnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdVbmtub3duRXJyb3InKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnVGhlIGF1dGhlbnRpY2F0b3Igd2FzIHVuYWJsZSB0byBwcm9jZXNzIHRoZSBzcGVjaWZpZWQgb3B0aW9ucywgb3IgY291bGQgbm90IGNyZWF0ZSBhIG5ldyBjcmVkZW50aWFsJyxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX0dFTkVSQUxfRVJST1InLFxuICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGVycm9yO1xufVxuXG5jbGFzcyBCYXNlV2ViQXV0aG5BYm9ydFNlcnZpY2Uge1xuICAgIGNyZWF0ZU5ld0Fib3J0U2lnbmFsKCkge1xuICAgICAgICBpZiAodGhpcy5jb250cm9sbGVyKSB7XG4gICAgICAgICAgICBjb25zdCBhYm9ydEVycm9yID0gbmV3IEVycm9yKCdDYW5jZWxsaW5nIGV4aXN0aW5nIFdlYkF1dGhuIEFQSSBjYWxsIGZvciBuZXcgb25lJyk7XG4gICAgICAgICAgICBhYm9ydEVycm9yLm5hbWUgPSAnQWJvcnRFcnJvcic7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuYWJvcnQoYWJvcnRFcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV3Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3Q29udHJvbGxlcjtcbiAgICAgICAgcmV0dXJuIG5ld0NvbnRyb2xsZXIuc2lnbmFsO1xuICAgIH1cbiAgICBjYW5jZWxDZXJlbW9ueSgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29udHJvbGxlcikge1xuICAgICAgICAgICAgY29uc3QgYWJvcnRFcnJvciA9IG5ldyBFcnJvcignTWFudWFsbHkgY2FuY2VsbGluZyBleGlzdGluZyBXZWJBdXRobiBBUEkgY2FsbCcpO1xuICAgICAgICAgICAgYWJvcnRFcnJvci5uYW1lID0gJ0Fib3J0RXJyb3InO1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmFib3J0KGFib3J0RXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxufVxuY29uc3QgV2ViQXV0aG5BYm9ydFNlcnZpY2UgPSBuZXcgQmFzZVdlYkF1dGhuQWJvcnRTZXJ2aWNlKCk7XG5cbmNvbnN0IGF0dGFjaG1lbnRzID0gWydjcm9zcy1wbGF0Zm9ybScsICdwbGF0Zm9ybSddO1xuZnVuY3Rpb24gdG9BdXRoZW50aWNhdG9yQXR0YWNobWVudChhdHRhY2htZW50KSB7XG4gICAgaWYgKCFhdHRhY2htZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGF0dGFjaG1lbnRzLmluZGV4T2YoYXR0YWNobWVudCkgPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIGF0dGFjaG1lbnQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0UmVnaXN0cmF0aW9uKG9wdGlvbnNKU09OKSB7XG4gICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV2ViQXV0aG4gaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXInKTtcbiAgICB9XG4gICAgY29uc3QgcHVibGljS2V5ID0ge1xuICAgICAgICAuLi5vcHRpb25zSlNPTixcbiAgICAgICAgY2hhbGxlbmdlOiBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlcihvcHRpb25zSlNPTi5jaGFsbGVuZ2UpLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi5vcHRpb25zSlNPTi51c2VyLFxuICAgICAgICAgICAgaWQ6IGJhc2U2NFVSTFN0cmluZ1RvQnVmZmVyKG9wdGlvbnNKU09OLnVzZXIuaWQpLFxuICAgICAgICB9LFxuICAgICAgICBleGNsdWRlQ3JlZGVudGlhbHM6IG9wdGlvbnNKU09OLmV4Y2x1ZGVDcmVkZW50aWFscz8ubWFwKHRvUHVibGljS2V5Q3JlZGVudGlhbERlc2NyaXB0b3IpLFxuICAgIH07XG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgcHVibGljS2V5IH07XG4gICAgb3B0aW9ucy5zaWduYWwgPSBXZWJBdXRobkFib3J0U2VydmljZS5jcmVhdGVOZXdBYm9ydFNpZ25hbCgpO1xuICAgIGxldCBjcmVkZW50aWFsO1xuICAgIHRyeSB7XG4gICAgICAgIGNyZWRlbnRpYWwgPSAoYXdhaXQgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmNyZWF0ZShvcHRpb25zKSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgaWRlbnRpZnlSZWdpc3RyYXRpb25FcnJvcih7IGVycm9yOiBlcnIsIG9wdGlvbnMgfSk7XG4gICAgfVxuICAgIGlmICghY3JlZGVudGlhbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlZ2lzdHJhdGlvbiB3YXMgbm90IGNvbXBsZXRlZCcpO1xuICAgIH1cbiAgICBjb25zdCB7IGlkLCByYXdJZCwgcmVzcG9uc2UsIHR5cGUgfSA9IGNyZWRlbnRpYWw7XG4gICAgbGV0IHRyYW5zcG9ydHMgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGVvZiByZXNwb25zZS5nZXRUcmFuc3BvcnRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRyYW5zcG9ydHMgPSByZXNwb25zZS5nZXRUcmFuc3BvcnRzKCk7XG4gICAgfVxuICAgIGxldCByZXNwb25zZVB1YmxpY0tleUFsZ29yaXRobSA9IHVuZGVmaW5lZDtcbiAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmdldFB1YmxpY0tleUFsZ29yaXRobSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzcG9uc2VQdWJsaWNLZXlBbGdvcml0aG0gPSByZXNwb25zZS5nZXRQdWJsaWNLZXlBbGdvcml0aG0oKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHdhcm5PbkJyb2tlbkltcGxlbWVudGF0aW9uKCdnZXRQdWJsaWNLZXlBbGdvcml0aG0oKScsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgcmVzcG9uc2VQdWJsaWNLZXkgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGVvZiByZXNwb25zZS5nZXRQdWJsaWNLZXkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IF9wdWJsaWNLZXkgPSByZXNwb25zZS5nZXRQdWJsaWNLZXkoKTtcbiAgICAgICAgICAgIGlmIChfcHVibGljS2V5ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VQdWJsaWNLZXkgPSBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhfcHVibGljS2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHdhcm5PbkJyb2tlbkltcGxlbWVudGF0aW9uKCdnZXRQdWJsaWNLZXkoKScsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgcmVzcG9uc2VBdXRoZW50aWNhdG9yRGF0YTtcbiAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmdldEF1dGhlbnRpY2F0b3JEYXRhID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXNwb25zZUF1dGhlbnRpY2F0b3JEYXRhID0gYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UuZ2V0QXV0aGVudGljYXRvckRhdGEoKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB3YXJuT25Ccm9rZW5JbXBsZW1lbnRhdGlvbignZ2V0QXV0aGVudGljYXRvckRhdGEoKScsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBpZCxcbiAgICAgICAgcmF3SWQ6IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJhd0lkKSxcbiAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICAgIGF0dGVzdGF0aW9uT2JqZWN0OiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyZXNwb25zZS5hdHRlc3RhdGlvbk9iamVjdCksXG4gICAgICAgICAgICBjbGllbnREYXRhSlNPTjogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UuY2xpZW50RGF0YUpTT04pLFxuICAgICAgICAgICAgdHJhbnNwb3J0cyxcbiAgICAgICAgICAgIHB1YmxpY0tleUFsZ29yaXRobTogcmVzcG9uc2VQdWJsaWNLZXlBbGdvcml0aG0sXG4gICAgICAgICAgICBwdWJsaWNLZXk6IHJlc3BvbnNlUHVibGljS2V5LFxuICAgICAgICAgICAgYXV0aGVudGljYXRvckRhdGE6IHJlc3BvbnNlQXV0aGVudGljYXRvckRhdGEsXG4gICAgICAgIH0sXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGNsaWVudEV4dGVuc2lvblJlc3VsdHM6IGNyZWRlbnRpYWwuZ2V0Q2xpZW50RXh0ZW5zaW9uUmVzdWx0cygpLFxuICAgICAgICBhdXRoZW50aWNhdG9yQXR0YWNobWVudDogdG9BdXRoZW50aWNhdG9yQXR0YWNobWVudChjcmVkZW50aWFsLmF1dGhlbnRpY2F0b3JBdHRhY2htZW50KSxcbiAgICB9O1xufVxuZnVuY3Rpb24gd2Fybk9uQnJva2VuSW1wbGVtZW50YXRpb24obWV0aG9kTmFtZSwgY2F1c2UpIHtcbiAgICBjb25zb2xlLndhcm4oYFRoZSBicm93c2VyIGV4dGVuc2lvbiB0aGF0IGludGVyY2VwdGVkIHRoaXMgV2ViQXV0aG4gQVBJIGNhbGwgaW5jb3JyZWN0bHkgaW1wbGVtZW50ZWQgJHttZXRob2ROYW1lfS4gWW91IHNob3VsZCByZXBvcnQgdGhpcyBlcnJvciB0byB0aGVtLlxcbmAsIGNhdXNlKTtcbn1cblxuZnVuY3Rpb24gYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbCgpIHtcbiAgICBpZiAoIWJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXNvbHZlKGZhbHNlKSk7XG4gICAgfVxuICAgIGNvbnN0IGdsb2JhbFB1YmxpY0tleUNyZWRlbnRpYWwgPSB3aW5kb3dcbiAgICAgICAgLlB1YmxpY0tleUNyZWRlbnRpYWw7XG4gICAgaWYgKGdsb2JhbFB1YmxpY0tleUNyZWRlbnRpYWwuaXNDb25kaXRpb25hbE1lZGlhdGlvbkF2YWlsYWJsZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVzb2x2ZShmYWxzZSkpO1xuICAgIH1cbiAgICByZXR1cm4gZ2xvYmFsUHVibGljS2V5Q3JlZGVudGlhbC5pc0NvbmRpdGlvbmFsTWVkaWF0aW9uQXZhaWxhYmxlKCk7XG59XG5cbmZ1bmN0aW9uIGlkZW50aWZ5QXV0aGVudGljYXRpb25FcnJvcih7IGVycm9yLCBvcHRpb25zLCB9KSB7XG4gICAgY29uc3QgeyBwdWJsaWNLZXkgfSA9IG9wdGlvbnM7XG4gICAgaWYgKCFwdWJsaWNLZXkpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoJ29wdGlvbnMgd2FzIG1pc3NpbmcgcmVxdWlyZWQgcHVibGljS2V5IHByb3BlcnR5Jyk7XG4gICAgfVxuICAgIGlmIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuc2lnbmFsIGluc3RhbmNlb2YgQWJvcnRTaWduYWwpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIGNlcmVtb255IHdhcyBzZW50IGFuIGFib3J0IHNpZ25hbCcsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0NFUkVNT05ZX0FCT1JURUQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdOb3RBbGxvd2VkRXJyb3InKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgY29kZTogJ0VSUk9SX1BBU1NUSFJPVUdIX1NFRV9DQVVTRV9QUk9QRVJUWScsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnU2VjdXJpdHlFcnJvcicpIHtcbiAgICAgICAgY29uc3QgZWZmZWN0aXZlRG9tYWluID0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lO1xuICAgICAgICBpZiAoIWlzVmFsaWREb21haW4oZWZmZWN0aXZlRG9tYWluKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgJHt3aW5kb3cubG9jYXRpb24uaG9zdG5hbWV9IGlzIGFuIGludmFsaWQgZG9tYWluYCxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfSU5WQUxJRF9ET01BSU4nLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHB1YmxpY0tleS5ycElkICE9PSBlZmZlY3RpdmVEb21haW4pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYFRoZSBSUCBJRCBcIiR7cHVibGljS2V5LnJwSWR9XCIgaXMgaW52YWxpZCBmb3IgdGhpcyBkb21haW5gLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9JTlZBTElEX1JQX0lEJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnVW5rbm93bkVycm9yJykge1xuICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSBhdXRoZW50aWNhdG9yIHdhcyB1bmFibGUgdG8gcHJvY2VzcyB0aGUgc3BlY2lmaWVkIG9wdGlvbnMsIG9yIGNvdWxkIG5vdCBjcmVhdGUgYSBuZXcgYXNzZXJ0aW9uIHNpZ25hdHVyZScsXG4gICAgICAgICAgICBjb2RlOiAnRVJST1JfQVVUSEVOVElDQVRPUl9HRU5FUkFMX0VSUk9SJyxcbiAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBlcnJvcjtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc3RhcnRBdXRoZW50aWNhdGlvbihvcHRpb25zSlNPTiwgdXNlQnJvd3NlckF1dG9maWxsID0gZmFsc2UpIHtcbiAgICBpZiAoIWJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXZWJBdXRobiBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlcicpO1xuICAgIH1cbiAgICBsZXQgYWxsb3dDcmVkZW50aWFscztcbiAgICBpZiAob3B0aW9uc0pTT04uYWxsb3dDcmVkZW50aWFscz8ubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgIGFsbG93Q3JlZGVudGlhbHMgPSBvcHRpb25zSlNPTi5hbGxvd0NyZWRlbnRpYWxzPy5tYXAodG9QdWJsaWNLZXlDcmVkZW50aWFsRGVzY3JpcHRvcik7XG4gICAgfVxuICAgIGNvbnN0IHB1YmxpY0tleSA9IHtcbiAgICAgICAgLi4ub3B0aW9uc0pTT04sXG4gICAgICAgIGNoYWxsZW5nZTogYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIob3B0aW9uc0pTT04uY2hhbGxlbmdlKSxcbiAgICAgICAgYWxsb3dDcmVkZW50aWFscyxcbiAgICB9O1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7fTtcbiAgICBpZiAodXNlQnJvd3NlckF1dG9maWxsKSB7XG4gICAgICAgIGlmICghKGF3YWl0IGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwoKSkpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgV2ViQXV0aG4gYXV0b2ZpbGwnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbGlnaWJsZUlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFthdXRvY29tcGxldGUkPSd3ZWJhdXRobiddXCIpO1xuICAgICAgICBpZiAoZWxpZ2libGVJbnB1dHMubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ05vIDxpbnB1dD4gd2l0aCBcIndlYmF1dGhuXCIgYXMgdGhlIG9ubHkgb3IgbGFzdCB2YWx1ZSBpbiBpdHMgYGF1dG9jb21wbGV0ZWAgYXR0cmlidXRlIHdhcyBkZXRlY3RlZCcpO1xuICAgICAgICB9XG4gICAgICAgIG9wdGlvbnMubWVkaWF0aW9uID0gJ2NvbmRpdGlvbmFsJztcbiAgICAgICAgcHVibGljS2V5LmFsbG93Q3JlZGVudGlhbHMgPSBbXTtcbiAgICB9XG4gICAgb3B0aW9ucy5wdWJsaWNLZXkgPSBwdWJsaWNLZXk7XG4gICAgb3B0aW9ucy5zaWduYWwgPSBXZWJBdXRobkFib3J0U2VydmljZS5jcmVhdGVOZXdBYm9ydFNpZ25hbCgpO1xuICAgIGxldCBjcmVkZW50aWFsO1xuICAgIHRyeSB7XG4gICAgICAgIGNyZWRlbnRpYWwgPSAoYXdhaXQgbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmdldChvcHRpb25zKSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgaWRlbnRpZnlBdXRoZW50aWNhdGlvbkVycm9yKHsgZXJyb3I6IGVyciwgb3B0aW9ucyB9KTtcbiAgICB9XG4gICAgaWYgKCFjcmVkZW50aWFsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gd2FzIG5vdCBjb21wbGV0ZWQnKTtcbiAgICB9XG4gICAgY29uc3QgeyBpZCwgcmF3SWQsIHJlc3BvbnNlLCB0eXBlIH0gPSBjcmVkZW50aWFsO1xuICAgIGxldCB1c2VySGFuZGxlID0gdW5kZWZpbmVkO1xuICAgIGlmIChyZXNwb25zZS51c2VySGFuZGxlKSB7XG4gICAgICAgIHVzZXJIYW5kbGUgPSBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyZXNwb25zZS51c2VySGFuZGxlKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQsXG4gICAgICAgIHJhd0lkOiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyYXdJZCksXG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICBhdXRoZW50aWNhdG9yRGF0YTogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UuYXV0aGVudGljYXRvckRhdGEpLFxuICAgICAgICAgICAgY2xpZW50RGF0YUpTT046IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLmNsaWVudERhdGFKU09OKSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2Uuc2lnbmF0dXJlKSxcbiAgICAgICAgICAgIHVzZXJIYW5kbGUsXG4gICAgICAgIH0sXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGNsaWVudEV4dGVuc2lvblJlc3VsdHM6IGNyZWRlbnRpYWwuZ2V0Q2xpZW50RXh0ZW5zaW9uUmVzdWx0cygpLFxuICAgICAgICBhdXRoZW50aWNhdG9yQXR0YWNobWVudDogdG9BdXRoZW50aWNhdG9yQXR0YWNobWVudChjcmVkZW50aWFsLmF1dGhlbnRpY2F0b3JBdHRhY2htZW50KSxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBwbGF0Zm9ybUF1dGhlbnRpY2F0b3JJc0F2YWlsYWJsZSgpIHtcbiAgICBpZiAoIWJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXNvbHZlKGZhbHNlKSk7XG4gICAgfVxuICAgIHJldHVybiBQdWJsaWNLZXlDcmVkZW50aWFsLmlzVXNlclZlcmlmeWluZ1BsYXRmb3JtQXV0aGVudGljYXRvckF2YWlsYWJsZSgpO1xufVxuXG5leHBvcnQgeyBXZWJBdXRobkFib3J0U2VydmljZSwgV2ViQXV0aG5FcnJvciwgYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIsIGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuLCBicm93c2VyU3VwcG9ydHNXZWJBdXRobkF1dG9maWxsLCBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZywgcGxhdGZvcm1BdXRoZW50aWNhdG9ySXNBdmFpbGFibGUsIHN0YXJ0QXV0aGVudGljYXRpb24sIHN0YXJ0UmVnaXN0cmF0aW9uIH07XG4iLCJpbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSBcIkBob3R3aXJlZC9zdGltdWx1c1wiO1xuaW1wb3J0IFBpY2tyIGZyb20gXCJAc2ltb253ZXAvcGlja3JcIjtcbmNvbnN0IF9Db2xvclBpY2tlciA9IGNsYXNzIF9Db2xvclBpY2tlciBleHRlbmRzIENvbnRyb2xsZXIge1xuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMub25TYXZlID0gdGhpcy5vblNhdmUuYmluZCh0aGlzKTtcbiAgfVxuICBjb25uZWN0KCkge1xuICAgIHRoaXMucGlja2VyID0gUGlja3IuY3JlYXRlKHtcbiAgICAgIGVsOiB0aGlzLmJ1dHRvblRhcmdldCxcbiAgICAgIHRoZW1lOiB0aGlzLnRoZW1lVmFsdWUsXG4gICAgICBkZWZhdWx0OiB0aGlzLmlucHV0VGFyZ2V0LnZhbHVlLFxuICAgICAgc3dhdGNoZXM6IHRoaXMuc3dhdGNoZXMsXG4gICAgICBjb21wb25lbnRzOiB0aGlzLmNvbXBvbmVudE9wdGlvbnNcbiAgICB9KSwgdGhpcy5waWNrZXIub24oXCJzYXZlXCIsIHRoaXMub25TYXZlKTtcbiAgfVxuICBkaXNjb25uZWN0KCkge1xuICAgIHRoaXMucGlja2VyLmRlc3Ryb3koKTtcbiAgfVxuICBvblNhdmUoY29sb3IpIHtcbiAgICB0aGlzLmlucHV0VGFyZ2V0LnZhbHVlID0gbnVsbCwgY29sb3IgJiYgKHRoaXMuaW5wdXRUYXJnZXQudmFsdWUgPSBjb2xvci50b0hFWEEoKS50b1N0cmluZygpKSwgdGhpcy5waWNrZXIuaGlkZSgpO1xuICB9XG4gIGdldCBjb21wb25lbnRPcHRpb25zKCkge1xuICAgIHJldHVybiB7XG4gICAgICBwcmV2aWV3OiAhMCxcbiAgICAgIGh1ZTogITAsXG4gICAgICBpbnRlcmFjdGlvbjoge1xuICAgICAgICBpbnB1dDogITAsXG4gICAgICAgIGNsZWFyOiAhMCxcbiAgICAgICAgc2F2ZTogITBcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGdldCBzd2F0Y2hlcygpIHtcbiAgICByZXR1cm4gW1xuICAgICAgXCIjQTBBRUMwXCIsXG4gICAgICBcIiNGNTY1NjVcIixcbiAgICAgIFwiI0VEODkzNlwiLFxuICAgICAgXCIjRUNDOTRCXCIsXG4gICAgICBcIiM0OEJCNzhcIixcbiAgICAgIFwiIzM4QjJBQ1wiLFxuICAgICAgXCIjNDI5OUUxXCIsXG4gICAgICBcIiM2NjdFRUFcIixcbiAgICAgIFwiIzlGN0FFQVwiLFxuICAgICAgXCIjRUQ2NEE2XCJcbiAgICBdO1xuICB9XG59O1xuX0NvbG9yUGlja2VyLnRhcmdldHMgPSBbXCJidXR0b25cIiwgXCJpbnB1dFwiXSwgX0NvbG9yUGlja2VyLnZhbHVlcyA9IHtcbiAgdGhlbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogXCJjbGFzc2ljXCJcbiAgfVxufTtcbmxldCBDb2xvclBpY2tlciA9IF9Db2xvclBpY2tlcjtcbmV4cG9ydCB7XG4gIENvbG9yUGlja2VyIGFzIGRlZmF1bHRcbn07XG4iLCJ2YXIgTiA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbnZhciBqID0gKHIsIHQsIGUpID0+IHQgaW4gciA/IE4ociwgdCwgeyBlbnVtZXJhYmxlOiAhMCwgY29uZmlndXJhYmxlOiAhMCwgd3JpdGFibGU6ICEwLCB2YWx1ZTogZSB9KSA6IHJbdF0gPSBlO1xudmFyIHUgPSAociwgdCwgZSkgPT4gaihyLCB0eXBlb2YgdCAhPSBcInN5bWJvbFwiID8gdCArIFwiXCIgOiB0LCBlKTtcbmZ1bmN0aW9uIHYociwgdCkge1xuICB0eXBlb2YgciA9PSBcInN0cmluZ1wiID8gdC5jbGFzc0xpc3QuYWRkKHIpIDogdC5jbGFzc0xpc3QuYWRkKC4uLnIpO1xufVxuZnVuY3Rpb24gdyhyLCB0KSB7XG4gIHR5cGVvZiByID09IFwic3RyaW5nXCIgPyB0LmNsYXNzTGlzdC5yZW1vdmUocikgOiB0LmNsYXNzTGlzdC5yZW1vdmUoLi4ucik7XG59XG5mdW5jdGlvbiBrKHIsIHQpIHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHQgIT0gXCJvYmplY3RcIikge1xuICAgICAgY29uc3QgZSA9IHR5cGVvZiB0O1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgYEVsZW1lbnRzIGdpdmVuIHRvIGlzVmFsaWRJbnN0YW5jZSgpIG11c3QgYmUgaW5zaWRlIG9mIGFuIG9iamVjdC4gXCIke2V9XCIgZ2l2ZW4uYFxuICAgICAgKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBlIGluIHQpXG4gICAgICBpZiAoISh0W2VdIGluc3RhbmNlb2YgcikpIHtcbiAgICAgICAgY29uc3QgcyA9IHR5cGVvZiB0W2VdO1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgIGAke2V9IG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgJHtyLm5hbWV9LiBcIiR7c31cIiBnaXZlbi5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITAsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMSxcbiAgICAgIGVycm9yOiBlXG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gcChyLCB0KSB7XG4gIHRyeSB7XG4gICAgaWYgKHR5cGVvZiB0ICE9IFwib2JqZWN0XCIpIHtcbiAgICAgIGNvbnN0IGUgPSB0eXBlb2YgdDtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIGBWYWx1ZXMgZ2l2ZW4gdG8gaXNWYWxpZFR5cGUoKSBtdXN0IGJlIGluc2lkZSBvZiBhbiBvYmplY3QuIFwiJHtlfVwiIGdpdmVuLmBcbiAgICAgICk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgZSBpbiB0KSB7XG4gICAgICBjb25zdCBzID0gdHlwZW9mIHRbZV07XG4gICAgICBpZiAocyAhPT0gcilcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgJHtlfSBtdXN0IGJlIGEgJHtyfS4gXCIke3N9XCIgZ2l2ZW4uYCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICEwLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITEsXG4gICAgICBlcnJvcjogZVxuICAgIH07XG4gIH1cbn1cbmZ1bmN0aW9uIEQocikge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgciAhPSBcIm9iamVjdFwiKSB7XG4gICAgICBjb25zdCB0ID0gdHlwZW9mIHI7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICBgVmFsdWVzIGdpdmVuIHRvIGlzUXVlcnlTZWxlY3RvcigpIG11c3QgYmUgaW5zaWRlIG9mIGFuIG9iamVjdC4gXCIke3R9XCIgZ2l2ZW4uYFxuICAgICAgKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB0IGluIHIpXG4gICAgICB0cnkge1xuICAgICAgICBpZiAoclt0XSA9PT0gbnVsbClcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihyW3RdKTtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgIGAke3R9IG11c3QgYmUgYSB2YWxpZCBxdWVyeSBzZWxlY3Rvci4gXCIke3JbdF19XCIgZ2l2ZW4uYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICEwLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9O1xuICB9IGNhdGNoICh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITEsXG4gICAgICBlcnJvcjogdFxuICAgIH07XG4gIH1cbn1cbmZ1bmN0aW9uIFMocikge1xuICB0cnkge1xuICAgIGlmICh0eXBlb2YgciAhPSBcIm9iamVjdFwiIHx8IEFycmF5LmlzQXJyYXkocikpIHtcbiAgICAgIGNvbnN0IHQgPSB0eXBlb2YgcjtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIGBWYWx1ZXMgZ2l2ZW4gdG8gaXNWYWxpZENsYXNzTGlzdCgpIG11c3QgYmUgaW5zaWRlIG9mIGFuIG9iamVjdC4gXCIke3R9XCIgZ2l2ZW4uYFxuICAgICAgKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCB0IGluIHIpIHtcbiAgICAgIGNvbnN0IGUgPSB0eXBlb2Ygclt0XTtcbiAgICAgIGlmIChlICE9PSBcInN0cmluZ1wiKVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyW3RdKSlcbiAgICAgICAgICByW3RdLmZvckVhY2goKHMpID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcyAhPSBcInN0cmluZ1wiKVxuICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgICAgIGAke3R9IG11c3QgYmUgYSBzdHJpbmcgb3IgYW4gYXJyYXkgb2Ygc3RyaW5ncy4gQW4gYXJyYXkgY29udGFpbmluZyBub24tc3RyaW5ncyBnaXZlbi5gXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgYCR7dH0gbXVzdCBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzLiBcIiR7ZX1cIiBnaXZlbi5gXG4gICAgICAgICAgKTtcbiAgICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBzID0ge307XG4gICAgICAgIHNbdF0gPSByW3RdLCBEKHMpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMCxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAodCkge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICExLFxuICAgICAgZXJyb3I6IHRcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBWKHIpIHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHIgIT0gXCJvYmplY3RcIikge1xuICAgICAgY29uc3QgZSA9IHR5cGVvZiByO1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgYFZhbHVlcyBnaXZlbiB0byBpc1ZhbGlkU3RhdGUoKSBtdXN0IGJlIGluc2lkZSBvZiBhbiBvYmplY3QuIFwiJHtlfVwiIGdpdmVuLmBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHQgPSBbXCJub25lXCIsIFwic2VsZlwiLCBcImNoaWxkXCJdO1xuICAgIGZvciAoY29uc3QgZSBpbiByKVxuICAgICAgaWYgKCF0LmluY2x1ZGVzKHJbZV0pKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgIGAke2V9IG11c3QgYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOiAke3Quam9pbihcbiAgICAgICAgICAgIFwiLCBcIlxuICAgICAgICAgICl9LiBcIiR7cltlXX1cIiBnaXZlbi5gXG4gICAgICAgICk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITAsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH07XG4gIH0gY2F0Y2ggKHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMSxcbiAgICAgIGVycm9yOiB0XG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gUihyKSB7XG4gIHRyeSB7XG4gICAgaWYgKHR5cGVvZiByICE9IFwib2JqZWN0XCIpIHtcbiAgICAgIGNvbnN0IGUgPSB0eXBlb2YgcjtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIGBWYWx1ZXMgZ2l2ZW4gdG8gaXNWYWxpZEV2ZW50KCkgbXVzdCBiZSBpbnNpZGUgb2YgYW4gb2JqZWN0LiBcIiR7ZX1cIiBnaXZlbi5gXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB0ID0gW1wibm9uZVwiLCBcIm1vdXNlXCIsIFwia2V5Ym9hcmRcIiwgXCJjaGFyYWN0ZXJcIl07XG4gICAgZm9yIChjb25zdCBlIGluIHIpXG4gICAgICBpZiAoIXQuaW5jbHVkZXMocltlXSkpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgYCR7ZX0gbXVzdCBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZXM6ICR7dC5qb2luKFxuICAgICAgICAgICAgXCIsIFwiXG4gICAgICAgICAgKX0uIFwiJHtyW2VdfVwiIGdpdmVuLmBcbiAgICAgICAgKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMCxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAodCkge1xuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6ICExLFxuICAgICAgZXJyb3I6IHRcbiAgICB9O1xuICB9XG59XG5mdW5jdGlvbiBIKHIpIHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHIgIT0gXCJvYmplY3RcIikge1xuICAgICAgY29uc3QgZSA9IHR5cGVvZiByO1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgYFZhbHVlcyBnaXZlbiB0byBpc1ZhbGlkSG92ZXJUeXBlKCkgbXVzdCBiZSBpbnNpZGUgb2YgYW4gb2JqZWN0LiBcIiR7ZX1cIiBnaXZlbi5gXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCB0ID0gW1wib2ZmXCIsIFwib25cIiwgXCJkeW5hbWljXCJdO1xuICAgIGZvciAoY29uc3QgZSBpbiByKVxuICAgICAgaWYgKCF0LmluY2x1ZGVzKHJbZV0pKVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgIGAke2V9IG11c3QgYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOiAke3Quam9pbihcbiAgICAgICAgICAgIFwiLCBcIlxuICAgICAgICAgICl9LiBcIiR7cltlXX1cIiBnaXZlbi5gXG4gICAgICAgICk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogITAsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH07XG4gIH0gY2F0Y2ggKHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiAhMSxcbiAgICAgIGVycm9yOiB0XG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24geChyLCB0KSB7XG4gIGlmIChwKFwic3RyaW5nXCIsIHsgdGFnTmFtZTogciB9KS5zdGF0dXMgJiYgayhIVE1MRWxlbWVudCwgdCkuc3RhdHVzKSB7XG4gICAgY29uc3QgZSA9IHIudG9Mb3dlckNhc2UoKTtcbiAgICBsZXQgcyA9ICEwO1xuICAgIGZvciAoY29uc3QgbiBpbiB0KVxuICAgICAgdFtuXS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09IGUgJiYgKHMgPSAhMSk7XG4gICAgcmV0dXJuIHM7XG4gIH0gZWxzZVxuICAgIHJldHVybiAhMTtcbn1cbmNsYXNzIEEge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgQmFzZU1lbnVUb2dnbGVgLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudSB0b2dnbGUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG9wdGlvbnMubWVudVRvZ2dsZUVsZW1lbnQgICAtIFRoZSB0b2dnbGUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBvcHRpb25zLnBhcmVudEVsZW1lbnQgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqIEBwYXJhbSB7QmFzZU1lbnV9ICAgIG9wdGlvbnMuY29udHJvbGxlZE1lbnUgICAgICAtIFRoZSBtZW51IGNvbnRyb2xsZWQgYnkgdGhpcyB0b2dnbGUuXG4gICAqIEBwYXJhbSB7P0Jhc2VNZW51fSAgIFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAtIFRoZSBtZW51IGNvbnRhaW5pbmcgdGhpcyB0b2dnbGUuXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVudVRvZ2dsZUVsZW1lbnQ6IHQsXG4gICAgcGFyZW50RWxlbWVudDogZSxcbiAgICBjb250cm9sbGVkTWVudTogcyxcbiAgICBwYXJlbnRNZW51OiBuID0gbnVsbFxuICB9KSB7XG4gICAgLyoqXG4gICAgICogVGhlIERPTSBlbGVtZW50cyB3aXRoaW4gdGhlIG1lbnUgdG9nZ2xlLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxIVE1MRWxlbWVudD59XG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSB0b2dnbGUgLSBUaGUgbWVudSB0b2dnbGUuXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudH0gcGFyZW50IC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIHRvZ2dsZS5cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX2RvbVwiLCB7XG4gICAgICB0b2dnbGU6IG51bGwsXG4gICAgICBwYXJlbnQ6IG51bGxcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgZGVjbGFyZWQgYWNjZXNzaWJsZS1tZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSB0b2dnbGUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7T2JqZWN0PEJhc2VNZW51Pn1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnV9IGNvbnRyb2xsZWRNZW51IC0gVGhlIG1lbnUgY29udHJvbGxlZCBieSB0aGlzIHRvZ2dsZS5cbiAgICAgKiBAcHJvcGVydHkge0Jhc2VNZW51fSBwYXJlbnRNZW51ICAgICAtIFRoZSBtZW51IGNvbnRhaW5pbmcgdGhpcyB0b2dnbGUuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9lbGVtZW50c1wiLCB7XG4gICAgICBjb250cm9sbGVkTWVudTogbnVsbCxcbiAgICAgIHBhcmVudE1lbnU6IG51bGxcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgb3BlbiBzdGF0ZSBvZiB0aGUgbWVudSB0b2dnbGUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX29wZW5cIiwgITEpO1xuICAgIC8qKlxuICAgICAqIFRoZSBldmVudCB0aGF0IGlzIHRyaWdnZXJlZCB3aGVuIHRoZSBtZW51IHRvZ2dsZSBleHBhbmRzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQGV2ZW50IGFjY2Vzc2libGVNZW51RXhwYW5kXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Q3VzdG9tRXZlbnR9XG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge2Jvb2xlYW59ICAgICAgICAgICAgICAgIGJ1YmJsZXMgLSBBIGZsYWcgdG8gYnViYmxlIHRoZSBldmVudC5cbiAgICAgKiBAcHJvcGVydHkge09iamVjdDxCYXNlTWVudVRvZ2dsZT59IGRldGFpbHMgLSBUaGUgZGV0YWlscyBvYmplY3QgY29udGFpbmluZyB0aGUgQmFzZU1lbnVUb2dnbGUgaXRzZWxmLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZXhwYW5kRXZlbnRcIiwgbmV3IEN1c3RvbUV2ZW50KFwiYWNjZXNzaWJsZU1lbnVFeHBhbmRcIiwge1xuICAgICAgYnViYmxlczogITAsXG4gICAgICBkZXRhaWw6IHsgdG9nZ2xlOiB0aGlzIH1cbiAgICB9KSk7XG4gICAgLyoqXG4gICAgICogVGhlIGV2ZW50IHRoYXQgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIG1lbnUgdG9nZ2xlIGNvbGxhcHNlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEBldmVudCBhY2Nlc3NpYmxlTWVudUNvbGxhcHNlXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Q3VzdG9tRXZlbnR9XG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge2Jvb2xlYW59ICAgICAgICAgICAgICAgIGJ1YmJsZXMgLSBBIGZsYWcgdG8gYnViYmxlIHRoZSBldmVudC5cbiAgICAgKiBAcHJvcGVydHkge09iamVjdDxCYXNlTWVudVRvZ2dsZT59IGRldGFpbHMgLSBUaGUgZGV0YWlscyBvYmplY3QgY29udGFpbmluZyB0aGUgQmFzZU1lbnVUb2dnbGUgaXRzZWxmLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfY29sbGFwc2VFdmVudFwiLCBuZXcgQ3VzdG9tRXZlbnQoXCJhY2Nlc3NpYmxlTWVudUNvbGxhcHNlXCIsIHtcbiAgICAgIGJ1YmJsZXM6ICEwLFxuICAgICAgZGV0YWlsOiB7IHRvZ2dsZTogdGhpcyB9XG4gICAgfSkpO1xuICAgIHRoaXMuX2RvbS50b2dnbGUgPSB0LCB0aGlzLl9kb20ucGFyZW50ID0gZSwgdGhpcy5fZWxlbWVudHMuY29udHJvbGxlZE1lbnUgPSBzLCB0aGlzLl9lbGVtZW50cy5wYXJlbnRNZW51ID0gbjtcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIG1lbnUgdG9nZ2xlLlxuICAgKlxuICAgKiBUaGUgZmlyc3Qgc3RlcHMgYXJlIHRvIGVuc3VyZSB0aGF0IHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudSBoYXZlIElEc1xuICAgKiB1c2luZyB0aGUgc2V0SWRzIG1ldGhvZCwgYW5kIHRvIHNldCB0aGUgQVJJQSBhdHRyaWJ1dGVzIG9uIHRoZSB0b2dnbGVcbiAgICogYW5kIGNvbnRyb2xsZWQgbWVudSB1c2luZyB0aGUgc2V0QXJpYUF0dHJpYnV0ZXMgbWV0aG9kLlxuICAgKlxuICAgKiBUaGVuIHRoZSBjb2xsYXBzZSBtZXRob2QgaXMgY2FsbGVkIHRvIG1ha2Ugc3VyZSB0aGUgc3VibWVudSBpcyBjbG9zZWQuXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuX3NldElkcygpLCB0aGlzLl9zZXRBcmlhQXR0cmlidXRlcygpLCB0aGlzLl9jb2xsYXBzZSghMSk7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBET00gZWxlbWVudHMgd2l0aGluIHRoZSB0b2dnbGUuXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0PEhUTUxFbGVtZW50Pn1cbiAgICpcbiAgICogQHNlZSBfZG9tXG4gICAqL1xuICBnZXQgZG9tKCkge1xuICAgIHJldHVybiB0aGlzLl9kb207XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBkZWNsYXJlZCBhY2Nlc3NpYmxlLW1lbnUgZWxlbWVudHMgd2l0aGluIHRoZSB0b2dnbGUuXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0PEJhc2VNZW51Pn1cbiAgICpcbiAgICogQHNlZSBfZWxlbWVudHNcbiAgICovXG4gIGdldCBlbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudHM7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBvcGVuIHN0YXRlIG9uIHRoZSB0b2dnbGUuXG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKlxuICAgKiBAc2VlIF9vcGVuXG4gICAqL1xuICBnZXQgaXNPcGVuKCkge1xuICAgIHJldHVybiB0aGlzLl9vcGVuO1xuICB9XG4gIHNldCBpc09wZW4odCkge1xuICAgIHAoXCJib29sZWFuXCIsIHsgdmFsdWU6IHQgfSksIHRoaXMuX29wZW4gPSB0O1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIHVuaXF1ZSBJRHMgZm9yIHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogSWYgdGhlIHRvZ2dsZSBhbmQgY29udHJvbGxlZCBtZW51IGRvIG5vdCBoYXZlIElEcywgdGhlIGZvbGxvd2luZyBzdGVwcyB0YWtlIHBsYWNlOlxuICAgKiAtIEdlbmVyYXRlIGEgcmFuZG9tIHN0cmluZyAxLTEwIGNoYXJhY3RlcnMgbG9uZyxcbiAgICogLSBHZXQgdGhlIGlubmVyVGV4dCBvZiB0aGUgdG9nZ2xlLFxuICAgKiAtIFNldCB0aGUgdG9nZ2xlJ3MgSUQgdG86IGBtZW51LWJ1dHRvbi0ke3RvZ2dsZS1pbm5lci10ZXh0fS0ke3RoZS1yYW5kb20tc3RyaW5nfWBcbiAgICogLSBTZXQgdGhlIG1lbnUncyBJRCB0bzogYG1lbnUtJHt0b2dnbGUtaW5uZXItdGV4dH0tJHt0aGUtcmFuZG9tLXN0cmluZ31gXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9zZXRJZHMoKSB7XG4gICAgdmFyIHQ7XG4gICAgaWYgKHRoaXMuZG9tLnRvZ2dsZS5pZCA9PT0gXCJcIiB8fCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LmlkID09PSBcIlwiKSB7XG4gICAgICBjb25zdCBlID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikucmVwbGFjZSgvW15hLXpdKy9nLCBcIlwiKS5zdWJzdHJpbmcoMCwgMTApO1xuICAgICAgbGV0IHMgPSAoKHQgPSB0aGlzLmRvbS50b2dnbGUuaW5uZXJUZXh0KSA9PSBudWxsID8gdm9pZCAwIDogdC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcc10vZywgXCJcIikpIHx8IFwiXCIsIG4gPSBlO1xuICAgICAgIXMucmVwbGFjZSgvXFxzL2csIFwiXCIpLmxlbmd0aCAmJiB0aGlzLmRvbS50b2dnbGUuZ2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiKSAmJiAocyA9IHRoaXMuZG9tLnRvZ2dsZS5nZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIpLnJlcGxhY2UoL1teYS16QS1aMC05XFxzXS9nLCBcIlwiKSksIHMucmVwbGFjZSgvXFxzL2csIFwiXCIpLmxlbmd0aCA+IDAgJiYgKHMgPSBzLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCBcIi1cIiksIHMuc3RhcnRzV2l0aChcIi1cIikgJiYgKHMgPSBzLnN1YnN0cmluZygxKSksIHMuZW5kc1dpdGgoXCItXCIpICYmIChzID0gcy5zbGljZSgwLCAtMSkpLCBuID0gYCR7c30tJHtufWApLCB0aGlzLmRvbS50b2dnbGUuaWQgPSB0aGlzLmRvbS50b2dnbGUuaWQgfHwgYG1lbnUtYnV0dG9uLSR7bn1gLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LmlkID0gdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudS5pZCB8fCBgbWVudS0ke259YDtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIEFSSUEgYXR0cmlidXRlcyBvbiB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIFRoZSBmaXJzdCBzdGVwcyBhcmUgdG8gZW5zdXJlIHRoYXQgdGhlIHRvZ2dsZSBoYXMgYGFyaWEtZXhwYW5kZWRgXG4gICAqIGlzIGluaXRpYWxseSBzZXQgdG8gXCJmYWxzZVwiLlxuICAgKlxuICAgKiBUaGVuIHVzaW5nIHRoZSB0b2dnbGUgYW5kIG1lbnUncyBJRHMsIHRoZSBtZW51J3MgYGFyaWEtbGFiZWxsZWRieWAgaXMgc2V0IHRvXG4gICAqIHRoZSB0b2dnbGUncyBJRC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldEFyaWFBdHRyaWJ1dGVzKCkge1xuICAgIHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIsIFwiZmFsc2VcIiksIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUuc2V0QXR0cmlidXRlKFxuICAgICAgXCJhcmlhLWxhYmVsbGVkYnlcIixcbiAgICAgIHRoaXMuZG9tLnRvZ2dsZS5pZFxuICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIEV4cGFuZHMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogU2V0cyB0aGUgdG9nZ2xlJ3MgYGFyaWEtZXhwYW5kZWRgIHRvIFwidHJ1ZVwiLCBhZGRzIHRoZVxuICAgKiBvcGVuIGNsYXNzIHRvIHRoZSB0b2dnbGUncyBwYXJlbnQgbWVudSBpdGVtXG4gICAqIGFuZCBjb250cm9sbGVkIG1lbnUsIGFuZCByZW1vdmVzIHRoZSBjbG9zZWQgY2xhc3NcbiAgICogZnJvbSB0aGUgdG9nZ2xlJ3MgcGFyZW50IG1lbnUgaXRlbSBhbmQgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBJZiBgZW1pdGAgaXMgc2V0IHRvIGB0cnVlYCwgdGhpcyB3aWxsIGFsc28gZW1pdCBhIGN1c3RvbSBldmVudFxuICAgKiBjYWxsZWQgYWNjZXNzaWJsZU1lbnVFeHBhbmRcbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAZmlyZXMgYWNjZXNzaWJsZU1lbnVFeHBhbmRcbiAgICpcbiAgICogQHBhcmFtIHtib29sZWFufSBbZW1pdCA9IHRydWVdIC0gQSB0b2dnbGUgdG8gZW1pdCB0aGUgZXhwYW5kIGV2ZW50IG9uY2UgZXhwYW5kZWQuXG4gICAqL1xuICBfZXhwYW5kKHQgPSAhMCkge1xuICAgIGNvbnN0IHsgY2xvc2VDbGFzczogZSwgb3BlbkNsYXNzOiBzLCB0cmFuc2l0aW9uQ2xhc3M6IG4gfSA9IHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnU7XG4gICAgdGhpcy5kb20udG9nZ2xlLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgXCJ0cnVlXCIpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmVsZW1lbnRzLnJvb3RNZW51Lmhhc09wZW5lZCA9ICEwLCBuICE9PSBcIlwiID8gKHYobiwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICBlICE9PSBcIlwiICYmIHcoZSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgIHMgIT09IFwiXCIgJiYgdihzLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICB3KG4sIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pKSA6IChzICE9PSBcIlwiICYmIHYocywgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSksIGUgIT09IFwiXCIgJiYgdyhlLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSksIHQgJiYgdGhpcy5kb20udG9nZ2xlLmRpc3BhdGNoRXZlbnQodGhpcy5fZXhwYW5kRXZlbnQpO1xuICB9XG4gIC8qKlxuICAgKiBDb2xsYXBzZXMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogU2V0cyB0aGUgdG9nZ2xlJ3MgYGFyaWEtZXhwYW5kZWRgIHRvIFwiZmFsc2VcIiwgYWRkcyB0aGVcbiAgICogY2xvc2VkIGNsYXNzIHRvIHRoZSB0b2dnbGUncyBwYXJlbnQgbWVudSBpdGVtXG4gICAqIGFuZCBjb250cm9sbGVkIG1lbnUsIGFuZCByZW1vdmVzIHRoZSBvcGVuIGNsYXNzXG4gICAqIGZyb20gdGhlIHRvZ2dsZSdzIHBhcmVudCBtZW51IGl0ZW0gYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogSWYgYGVtaXRgIGlzIHNldCB0byBgdHJ1ZWAsIHRoaXMgd2lsbCBhbHNvIGVtaXQgYSBjdXN0b20gZXZlbnRcbiAgICogY2FsbGVkIGFjY2Vzc2libGVNZW51Q29sbGFwc2VcbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAZmlyZXMgYWNjZXNzaWJsZU1lbnVDb2xsYXBzZVxuICAgKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtlbWl0ID0gdHJ1ZV0gLSBBIHRvZ2dsZSB0byBlbWl0IHRoZSBjb2xsYXBzZSBldmVudCBvbmNlIGNvbGxhcHNlZC5cbiAgICovXG4gIF9jb2xsYXBzZSh0ID0gITApIHtcbiAgICBjb25zdCB7IGNsb3NlQ2xhc3M6IGUsIG9wZW5DbGFzczogcywgdHJhbnNpdGlvbkNsYXNzOiBuIH0gPSB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51O1xuICAgIHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIsIFwiZmFsc2VcIiksIG4gIT09IFwiXCIgPyAodihuLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgIHMgIT09IFwiXCIgJiYgdyhzLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgZSAhPT0gXCJcIiAmJiB2KGUsIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgIHcobiwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVkTWVudS5kb20ubWVudSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSkpIDogKGUgIT09IFwiXCIgJiYgdihlLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51KSwgcyAhPT0gXCJcIiAmJiB3KHMsIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUpKSwgdCAmJiB0aGlzLmRvbS50b2dnbGUuZGlzcGF0Y2hFdmVudCh0aGlzLl9jb2xsYXBzZUV2ZW50KTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogU2V0cyB0aGUgY29udHJvbGxlZCBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJzZWxmXCJcbiAgICogYW5kIHRoZSBwYXJlbnQgbWVudSdzIGZvY3VzIHN0YXRlIHRvIFwiY2hpbGRcIiwgY2FsbHMgZXhwYW5kLFxuICAgKiBhbmQgc2V0cyB0aGUgaXNPcGVuIHZhbHVlIHRvIGB0cnVlYC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgb3BlbigpIHtcbiAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmZvY3VzU3RhdGUgPSBcInNlbGZcIiwgdGhpcy5pc09wZW4gfHwgKHRoaXMuX2V4cGFuZCgpLCB0aGlzLmlzT3BlbiA9ICEwKTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudSB3aXRob3V0IHRoZSBjdXJyZW50IGZvY3VzIGVudGVyaW5nIGl0LlxuICAgKlxuICAgKiBTZXRzIHRoZSBjb250cm9sbGVkIG1lbnUncyBmb2N1cyBzdGF0ZSB0byBcInNlbGZcIlxuICAgKiBhbmQgdGhlIHBhcmVudCBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJjaGlsZFwiLFxuICAgKiBhbmQgY2FsbHMgZXhwYW5kLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBwcmV2aWV3KCkge1xuICAgIHRoaXMuZWxlbWVudHMucGFyZW50TWVudSAmJiAodGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzU3RhdGUgPSBcInNlbGZcIiksIHRoaXMuaXNPcGVuIHx8ICh0aGlzLl9leHBhbmQoKSwgdGhpcy5pc09wZW4gPSAhMCk7XG4gIH1cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBTZXRzIHRoZSBjb250cm9sbGVkIG1lbnUncyBmb2N1cyBzdGF0ZSB0byBcIm5vbmVcIlxuICAgKiBhbmQgdGhlIHBhcmVudCBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJzZWxmXCIsIGJsdXJzIHRoZSBjb250cm9sbGVkIG1lbnVcbiAgICogYW5kIHNldHMgaXQncyBjdXJyZW50IGNoaWxkIGluZGV4IHRvIDAsXG4gICAqIGNhbGxzIGNvbGxhcHNlLCBhbmQgc2V0c1xuICAgKiB0aGUgaXNPcGVuIHZhbHVlIHRvIGBmYWxzZWAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuaXNPcGVuICYmICh0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmJsdXIoKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51ICYmICh0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNTdGF0ZSA9IFwic2VsZlwiKSwgdGhpcy5fY29sbGFwc2UoKSwgdGhpcy5pc09wZW4gPSAhMSk7XG4gIH1cbiAgLyoqXG4gICAqIFRvZ2dsZXMgdGhlIG9wZW4gc3RhdGUgb2YgdGhlIGNvbnRyb2xsZWQgbWVudSBiZXR3ZWVuIGB0cnVlYCBhbmQgYGZhbHNlYC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgdG9nZ2xlKCkge1xuICAgIHRoaXMuaXNPcGVuID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7XG4gIH1cbiAgLyoqXG4gICAqIENsb3NlcyBhbGwgc2libGluZyBtZW51cy5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgY2xvc2VTaWJsaW5ncygpIHtcbiAgICB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLmZvckVhY2goKHQpID0+IHtcbiAgICAgIHQgIT09IHRoaXMgJiYgdC5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZXMgYWxsIGNoaWxkIG1lbnVzLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBjbG9zZUNoaWxkcmVuKCkge1xuICAgIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuZm9yRWFjaChcbiAgICAgICh0KSA9PiB0LmNsb3NlKClcbiAgICApO1xuICB9XG59XG5jbGFzcyBMIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYEJhc2VNZW51SXRlbWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgaXRlbS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgIG9wdGlvbnMubWVudUl0ZW1FbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICBvcHRpb25zLm1lbnVMaW5rRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSdzIGxpbmsgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtCYXNlTWVudX0gICAgICAgIG9wdGlvbnMucGFyZW50TWVudSAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICBbb3B0aW9ucy5pc1N1Ym1lbnVJdGVtID0gZmFsc2VdIC0gQSBmbGFnIHRvIG1hcmsgaWYgdGhlIG1lbnUgaXRlbSBpcyBjb250cm9sbGluZyBhIHN1Ym1lbnUuXG4gICAqIEBwYXJhbSB7P0Jhc2VNZW51fSAgICAgICBbb3B0aW9ucy5jaGlsZE1lbnUgPSBudWxsXSAgICAgIC0gVGhlIGNoaWxkIG1lbnUuXG4gICAqIEBwYXJhbSB7P0Jhc2VNZW51VG9nZ2xlfSBbb3B0aW9ucy50b2dnbGUgPSBudWxsXSAgICAgICAgIC0gVGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjaGlsZCBtZW51LlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVJdGVtRWxlbWVudDogdCxcbiAgICBtZW51TGlua0VsZW1lbnQ6IGUsXG4gICAgcGFyZW50TWVudTogcyxcbiAgICBpc1N1Ym1lbnVJdGVtOiBuID0gITEsXG4gICAgY2hpbGRNZW51OiBpID0gbnVsbCxcbiAgICB0b2dnbGU6IG8gPSBudWxsXG4gIH0pIHtcbiAgICAvKipcbiAgICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSBpdGVtLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxIVE1MRWxlbWVudD59XG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSBpdGVtIC0gVGhlIG1lbnUgaXRlbS5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSBsaW5rIC0gVGhlIG1lbnUgaXRlbSdzIGxpbmsuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9kb21cIiwge1xuICAgICAgaXRlbTogbnVsbCxcbiAgICAgIGxpbms6IG51bGxcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgZGVjbGFyZWQgYWNjZXNzaWJsZS1tZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudSBpdGVtLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxCYXNlTWVudSwgQmFzZU1lbnVUb2dnbGU+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtCYXNlTWVudX0gICAgICAgIHBhcmVudE1lbnUgLSBUaGUgbWVudSBjb250YWluaW5nIHRoaXMgbWVudSBpdGVtLlxuICAgICAqIEBwcm9wZXJ0eSB7P0Jhc2VNZW51fSAgICAgICBjaGlsZE1lbnUgIC0gVGhlIG1lbnUgY29udGFpbmVkIHdpdGhpbiB0aGlzIG1lbnUgaXRlbS5cbiAgICAgKiBAcHJvcGVydHkgez9CYXNlTWVudVRvZ2dsZX0gdG9nZ2xlICAgICAtIFRoZSBtZW51IHRvZ2dsZSB3aXRoaW4gdGhpcyBtZW51IGl0ZW0gdGhhdCBjb250cm9scyB0aGUgYGNoaWxkTWVudWAuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9lbGVtZW50c1wiLCB7XG4gICAgICBwYXJlbnRNZW51OiBudWxsLFxuICAgICAgY2hpbGRNZW51OiBudWxsLFxuICAgICAgdG9nZ2xlOiBudWxsXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQSBmbGFnIG1hcmtpbmcgYSBzdWJtZW51IGl0ZW0uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX3N1Ym1lbnVcIiwgITEpO1xuICAgIHRoaXMuX2RvbS5pdGVtID0gdCwgdGhpcy5fZG9tLmxpbmsgPSBlLCB0aGlzLl9lbGVtZW50cy5wYXJlbnRNZW51ID0gcywgdGhpcy5fZWxlbWVudHMuY2hpbGRNZW51ID0gaSwgdGhpcy5fZWxlbWVudHMudG9nZ2xlID0gbywgdGhpcy5fc3VibWVudSA9IG47XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIG1lbnUgaXRlbS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBET00gZWxlbWVudHMgd2l0aGluIHRoZSBtZW51IGl0ZW0uXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0PEhUTUxFbGVtZW50Pn1cbiAgICpcbiAgICogQHNlZSBfZG9tXG4gICAqL1xuICBnZXQgZG9tKCkge1xuICAgIHJldHVybiB0aGlzLl9kb207XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBkZWNsYXJlZCBhY2Nlc3NpYmxlLW1lbnUgZWxlbWVudHMgd2l0aGluIHRoZSBtZW51IGl0ZW0uXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0PEJhc2VNZW51LCBCYXNlTWVudVRvZ2dsZT59XG4gICAqXG4gICAqIEBzZWUgX2VsZW1lbnRzXG4gICAqL1xuICBnZXQgZWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzO1xuICB9XG4gIC8qKlxuICAgKiBBIGZsYWcgbWFya2luZyBhIHN1Ym1lbnUgaXRlbS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKlxuICAgKiBAc2VlIF9zdWJtZW51XG4gICAqL1xuICBnZXQgaXNTdWJtZW51SXRlbSgpIHtcbiAgICByZXR1cm4gdGhpcy5fc3VibWVudTtcbiAgfVxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgbWVudSBpdGVtJ3MgbGluayBpZiB0aGUgcGFyZW50IG1lbnUnc1xuICAgKiBzaG91bGRGb2N1cyB2YWx1ZSBpcyBgdHJ1ZWAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzKCkge1xuICAgIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5zaG91bGRGb2N1cyAmJiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5kb20ubGluay5mb2N1cygpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBCbHVycyB0aGUgbWVudSBpdGVtJ3MgbGluayBpZiB0aGUgcGFyZW50IG1lbnUnc1xuICAgKiBzaG91bGRGb2N1cyB2YWx1ZSBpcyBgdHJ1ZWAuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGJsdXIoKSB7XG4gICAgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LnNob3VsZEZvY3VzICYmIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLmRvbS5saW5rLmJsdXIoKTtcbiAgICB9KTtcbiAgfVxufVxuZnVuY3Rpb24gZyhyKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdCA9IHIua2V5IHx8IHIua2V5Q29kZSwgZSA9IHtcbiAgICAgIEVudGVyOiB0ID09PSBcIkVudGVyXCIgfHwgdCA9PT0gMTMsXG4gICAgICBTcGFjZTogdCA9PT0gXCIgXCIgfHwgdCA9PT0gXCJTcGFjZWJhclwiIHx8IHQgPT09IDMyLFxuICAgICAgRXNjYXBlOiB0ID09PSBcIkVzY2FwZVwiIHx8IHQgPT09IFwiRXNjXCIgfHwgdCA9PT0gMjcsXG4gICAgICBBcnJvd1VwOiB0ID09PSBcIkFycm93VXBcIiB8fCB0ID09PSBcIlVwXCIgfHwgdCA9PT0gMzgsXG4gICAgICBBcnJvd1JpZ2h0OiB0ID09PSBcIkFycm93UmlnaHRcIiB8fCB0ID09PSBcIlJpZ2h0XCIgfHwgdCA9PT0gMzksXG4gICAgICBBcnJvd0Rvd246IHQgPT09IFwiQXJyb3dEb3duXCIgfHwgdCA9PT0gXCJEb3duXCIgfHwgdCA9PT0gNDAsXG4gICAgICBBcnJvd0xlZnQ6IHQgPT09IFwiQXJyb3dMZWZ0XCIgfHwgdCA9PT0gXCJMZWZ0XCIgfHwgdCA9PT0gMzcsXG4gICAgICBIb21lOiB0ID09PSBcIkhvbWVcIiB8fCB0ID09PSAzNixcbiAgICAgIEVuZDogdCA9PT0gXCJFbmRcIiB8fCB0ID09PSAzNSxcbiAgICAgIENoYXJhY3RlcjogaXNOYU4odCkgJiYgISF0Lm1hdGNoKC9eW2EtekEtWl17MX0kLyksXG4gICAgICBUYWI6IHQgPT09IFwiVGFiXCIgfHwgdCA9PT0gOSxcbiAgICAgIEFzdGVyaXNrOiB0ID09PSBcIipcIiB8fCB0ID09PSA1NlxuICAgIH07XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGUpLmZpbmQoKHMpID0+IGVbc10gPT09ICEwKSB8fCBcIlwiO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxufVxuZnVuY3Rpb24gbChyKSB7XG4gIHIucHJldmVudERlZmF1bHQoKSwgci5zdG9wUHJvcGFnYXRpb24oKTtcbn1cbmNsYXNzIEkge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgQmFzZU1lbnVgLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICBvcHRpb25zLm1lbnVFbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgbWVudSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5tZW51SXRlbVNlbGVjdG9yID0gbGldICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGl0ZW1zLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMubWVudUxpbmtTZWxlY3RvciA9IGFdICAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBsaW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVJdGVtU2VsZWN0b3IgPSBsaTpoYXModWwpXSAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMgY29udGFpbmluZyBzdWJtZW51cy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVUb2dnbGVTZWxlY3RvciA9IGFdICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnUgdG9nZ2xlIGJ1dHRvbnMvbGlua3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51U2VsZWN0b3IgPSB1bF0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51cy5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgIFtvcHRpb25zLmNvbnRyb2xsZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRyb2xsaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7P0hUTUxFbGVtZW50fSAgICAgICBbb3B0aW9ucy5jb250YWluZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy5vcGVuQ2xhc3MgPSBzaG93XSAgICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJvcGVuXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy5jbG9zZUNsYXNzID0gaGlkZV0gICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJjbG9zZWRcIi5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLnRyYW5zaXRpb25DbGFzcyA9IHRyYW5zaXRpb25pbmddICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyB0cmFuc2l0aW9uaW5nIGJldHdlZW4gXCJvcGVuXCIgYW5kIFwiY2xvc2VkXCIgc3RhdGVzLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuaXNUb3BMZXZlbCA9IGZhbHNlXSAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIG1hcmsgdGhlIHJvb3QgbWVudS5cbiAgICogQHBhcmFtIHs/QmFzZU1lbnV9ICAgICAgICAgIFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAgICAgICAgICAgICAgICAtIFRoZSBwYXJlbnQgbWVudSB0byB0aGlzIG1lbnUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5ob3ZlclR5cGUgPSBvZmZdICAgICAgICAgICAgICAgICAgLSBUaGUgdHlwZSBvZiBob3ZlcmFiaWxpdHkgYSBtZW51IGhhcy5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyRGVsYXkgPSAyNTBdICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhbmQgY2xvc2luZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmVudGVyRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmxlYXZlRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3IgY2xvc2luZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51RWxlbWVudDogdCxcbiAgICBtZW51SXRlbVNlbGVjdG9yOiBlID0gXCJsaVwiLFxuICAgIG1lbnVMaW5rU2VsZWN0b3I6IHMgPSBcImFcIixcbiAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiBuID0gXCJsaTpoYXModWwpXCIsXG4gICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiBpID0gXCJhXCIsXG4gICAgc3VibWVudVNlbGVjdG9yOiBvID0gXCJ1bFwiLFxuICAgIGNvbnRyb2xsZXJFbGVtZW50OiBoID0gbnVsbCxcbiAgICBjb250YWluZXJFbGVtZW50OiBtID0gbnVsbCxcbiAgICBvcGVuQ2xhc3M6IGMgPSBcInNob3dcIixcbiAgICBjbG9zZUNsYXNzOiBhID0gXCJoaWRlXCIsXG4gICAgdHJhbnNpdGlvbkNsYXNzOiBkID0gXCJ0cmFuc2l0aW9uaW5nXCIsXG4gICAgaXNUb3BMZXZlbDogZiA9ICEwLFxuICAgIHBhcmVudE1lbnU6IHkgPSBudWxsLFxuICAgIGhvdmVyVHlwZTogTSA9IFwib2ZmXCIsXG4gICAgaG92ZXJEZWxheTogYiA9IDI1MCxcbiAgICBlbnRlckRlbGF5OiBfID0gLTEsXG4gICAgbGVhdmVEZWxheTogQyA9IC0xXG4gIH0pIHtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBzdWJtZW51cy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgQmFzZU1lbnV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VHlwZVwiLCBJKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVzZS1iZWZvcmUtZGVmaW5lXG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgbWVudSBpdGVtcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgQmFzZU1lbnVJdGVtfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudUl0ZW1UeXBlXCIsIEwpO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgQmFzZU1lbnVUb2dnbGV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VG9nZ2xlVHlwZVwiLCBBKTtcbiAgICAvKipcbiAgICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3Q8SFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50W10+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudH0gICBtZW51ICAgICAgICAgICAtIFRoZSBtZW51IGVsZW1lbnQuXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudFtdfSBtZW51SXRlbXMgICAgICAtIEFuIGFycmF5IG9mIG1lbnUgaXRlbXMuXG4gICAgICogQHByb3BlcnR5IHtIVE1MRWxlbWVudFtdfSBzdWJtZW51SXRlbXMgICAtIEFuIGFycmF5IG9mIG1lbnUgaXRlbXMgdGhhdCBhbHNvIGNvbnRhaW4gc3VibWVudSBlbGVtZW50cy5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50W119IHN1Ym1lbnVUb2dnbGVzIC0gQW4gYXJyYXkgb2YgbWVudSBsaW5rcyB0aGF0IGZ1bmN0aW9uIGFzIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50W119IHN1Ym1lbnVzICAgICAgIC0gQW4gYXJyYXkgb2Ygc3VibWVudSBlbGVtZW50cy5cbiAgICAgKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSAgIGNvbnRyb2xsZXIgICAgIC0gVGhlIHRvZ2dsZSBmb3IgdGhpcyBtZW51LlxuICAgICAqIEBwcm9wZXJ0eSB7SFRNTEVsZW1lbnR9ICAgY29udGFpbmVyICAgICAgLSBUaGUgY29udGFpbmVyIGZvciB0aGlzIG1lbnUuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9kb21cIiwge1xuICAgICAgbWVudTogbnVsbCxcbiAgICAgIG1lbnVJdGVtczogW10sXG4gICAgICBzdWJtZW51SXRlbXM6IFtdLFxuICAgICAgc3VibWVudVRvZ2dsZXM6IFtdLFxuICAgICAgc3VibWVudXM6IFtdLFxuICAgICAgY29udHJvbGxlcjogbnVsbCxcbiAgICAgIGNvbnRhaW5lcjogbnVsbFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBzZWxlY3RvcnMgdXNlZCBieSB0aGUgbWVudSB0byBwb3B1bGF0ZSB0aGUgZG9tLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxzdHJpbmc+fVxuICAgICAqXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IG1lbnVJdGVtcyAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIGZvciBtZW51IGl0ZW1zLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBtZW51TGlua3MgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBmb3IgbWVudSBsaW5rcy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudUl0ZW1zICAgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgaXRlbXMgY29udGFpbmluZyBzdWJtZW51cy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudVRvZ2dsZXMgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgbGlua3MgdGhhdCBmdW5jdGlvbiBhcyBzdWJtZW51IHRvZ2dsZXMuXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IHN1Ym1lbnVzICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIGZvciBmb3Igc3VibWVudXMuXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9zZWxlY3RvcnNcIiwge1xuICAgICAgbWVudUl0ZW1zOiBcIlwiLFxuICAgICAgbWVudUxpbmtzOiBcIlwiLFxuICAgICAgc3VibWVudUl0ZW1zOiBcIlwiLFxuICAgICAgc3VibWVudVRvZ2dsZXM6IFwiXCIsXG4gICAgICBzdWJtZW51czogXCJcIlxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWNsYXJlZCBhY2Nlc3NpYmxlLW1lbnUgZWxlbWVudHMgd2l0aGluIHRoZSBtZW51LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdDxCYXNlTWVudSwgQmFzZU1lbnVUb2dnbGUsIEJhc2VNZW51SXRlbVtdLCBCYXNlTWVudVRvZ2dsZVtdPn1cbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnVJdGVtW119ICAgbWVudUl0ZW1zICAgICAgLSBBbiBhcnJheSBvZiBtZW51IGl0ZW1zLlxuICAgICAqIEBwcm9wZXJ0eSB7QmFzZU1lbnVUb2dnbGVbXX0gc3VibWVudVRvZ2dsZXMgLSBBbiBhcnJheSBvZiBtZW51IHRvZ2dsZXMuXG4gICAgICogQHByb3BlcnR5IHs/QmFzZU1lbnVUb2dnbGV9ICBjb250cm9sbGVyICAgICAtIEEgbWVudSB0b2dnbGUgdGhhdCBjb250cm9scyB0aGlzIG1lbnUuXG4gICAgICogQHByb3BlcnR5IHs/QmFzZU1lbnV9ICAgICAgICBwYXJlbnRNZW51ICAgICAtIFRoZSBwYXJlbnQgbWVudS5cbiAgICAgKiBAcHJvcGVydHkgez9CYXNlTWVudX0gICAgICAgIHJvb3RNZW51ICAgICAgIC0gVGhlIHJvb3QgbWVudSBvZiB0aGUgbWVudSB0cmVlLlxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZWxlbWVudHNcIiwge1xuICAgICAgbWVudUl0ZW1zOiBbXSxcbiAgICAgIHN1Ym1lbnVUb2dnbGVzOiBbXSxcbiAgICAgIGNvbnRyb2xsZXI6IG51bGwsXG4gICAgICBwYXJlbnRNZW51OiBudWxsLFxuICAgICAgcm9vdE1lbnU6IG51bGxcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MoZXMpIHRvIGFwcGx5IHdoZW4gdGhlIG1lbnUgaXMgb3Blbi5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd8c3RyaW5nW119XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9vcGVuQ2xhc3NcIiwgXCJzaG93XCIpO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyhlcykgdG8gYXBwbHkgd2hlbiB0aGUgbWVudSBpcyBjbG9zZWQuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfHN0cmluZ1tdfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfY2xvc2VDbGFzc1wiLCBcImhpZGVcIik7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzKGVzKSB0byBhcHBseSB3aGVuIHRoZSBtZW51IGlzIHRyYW5zaXRpb25pbmcgYmV0d2VlbiBzdGF0ZXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfHN0cmluZ1tdfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfdHJhbnNpdGlvbkNsYXNzXCIsIFwidHJhbnNpdGlvbmluZ1wiKTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgbWFya2luZyB0aGUgcm9vdCBtZW51LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9yb290XCIsICEwKTtcbiAgICAvKipcbiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtZW51IGl0ZW0gaW4gdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfY3VycmVudENoaWxkXCIsIDApO1xuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBtZW51J3MgZm9jdXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZm9jdXNTdGF0ZVwiLCBcIm5vbmVcIik7XG4gICAgLyoqXG4gICAgICogVGhpcyBsYXN0IGV2ZW50IHRyaWdnZXJlZCBvbiB0aGUgbWVudS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtzdHJpbmd9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9jdXJyZW50RXZlbnRcIiwgXCJub25lXCIpO1xuICAgIC8qKlxuICAgICAqIFRoZSB0eXBlIG9mIGhvdmVyYWJpbGl0eSBmb3IgdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfaG92ZXJUeXBlXCIsIFwib2ZmXCIpO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxpc2Vjb25kcykgdXNlZCBmb3IgcG9pbnRlcmVudGVyL3BvaW50ZXJsZWF2ZSBldmVudHMgdG8gdGFrZSBwbGFjZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9ob3ZlckRlbGF5XCIsIDI1MCk7XG4gICAgLyoqXG4gICAgICogVGhlIGRlbGF5IHRpbWUgKGluIG1pbGlzZWNvbmRzKSB1c2VkIGZvciBwb2ludGVyZW50ZXIgZXZlbnRzIHRvIHRha2UgcGxhY2UuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfZW50ZXJEZWxheVwiLCAtMSk7XG4gICAgLyoqXG4gICAgICogVGhlIGRlbGF5IHRpbWUgKGluIG1pbGlzZWNvbmRzKSB1c2VkIGZvciBwb2ludGVybGVhdmUgZXZlbnRzIHRvIHRha2UgcGxhY2UuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfbGVhdmVEZWxheVwiLCAtMSk7XG4gICAgLyoqXG4gICAgICogQSB2YXJpYWJsZSB0byBob2xkIHRoZSBob3ZlciB0aW1lb3V0IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUgez9GdW5jdGlvbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX2hvdmVyVGltZW91dFwiLCBudWxsKTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgdG8gY2hlY2sgaWYgdGhlIG1lbnUgY2FuIGR5bmFtaWNhbGx5IGhvdmVyIGJhc2VkIG9uIGlmIGEgbWVudSBoYXMgYmVlbiBvcGVuZWQgYWxyZWFkeS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfaGFzT3BlbmVkXCIsICExKTtcbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSBvZiBlcnJvciBtZXNzYWdlcyBnZW5lcmF0ZWQgYnkgdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9lcnJvcnNcIiwgW10pO1xuICAgIHRoaXMuX2RvbS5tZW51ID0gdCwgdGhpcy5fZG9tLmNvbnRyb2xsZXIgPSBoLCB0aGlzLl9kb20uY29udGFpbmVyID0gbSwgdGhpcy5fc2VsZWN0b3JzLm1lbnVJdGVtcyA9IGUsIHRoaXMuX3NlbGVjdG9ycy5tZW51TGlua3MgPSBzLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudUl0ZW1zID0gbiwgdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVUb2dnbGVzID0gaSwgdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVzID0gbywgdGhpcy5fZWxlbWVudHMubWVudUl0ZW1zID0gW10sIHRoaXMuX2VsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzID0gW10sIHRoaXMuX2VsZW1lbnRzLmNvbnRyb2xsZXIgPSBudWxsLCB0aGlzLl9lbGVtZW50cy5wYXJlbnRNZW51ID0geSwgdGhpcy5fZWxlbWVudHMucm9vdE1lbnUgPSBmID8gdGhpcyA6IG51bGwsIHRoaXMuX29wZW5DbGFzcyA9IGMgfHwgXCJcIiwgdGhpcy5fY2xvc2VDbGFzcyA9IGEgfHwgXCJcIiwgdGhpcy5fdHJhbnNpdGlvbkNsYXNzID0gZCB8fCBcIlwiLCB0aGlzLl9yb290ID0gZiwgdGhpcy5faG92ZXJUeXBlID0gTSwgdGhpcy5faG92ZXJEZWxheSA9IGIsIHRoaXMuX2VudGVyRGVsYXkgPSBfLCB0aGlzLl9sZWF2ZURlbGF5ID0gQztcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIG1lbnUuXG4gICAqXG4gICAqIFRoZSBmb2xsb3dpbmcgc3RlcHMgd2lsbCBiZSB0YWtlbiB0byBpbml0aWFsaXplIHRoZSBtZW51OlxuICAgKiAtIFZhbGlkYXRlIHRoYXQgdGhlIG1lbnUgY2FuIGluaXRpYWxpemUuXG4gICAqIC0gRmluZCB0aGUgcm9vdCBtZW51IG9mIHRoZSBtZW51IHRyZWUgaWYgaXQgaXNuJ3QgYWxyZWFkeSBzZXQuXG4gICAqIC0gUG9wdWxhdGUgYWxsIERPTSBlbGVtZW50cyB3aXRoaW4gdGhlIGRvbS5cbiAgICogLSBJZiB0aGUgY3VycmVudCBtZW51IGlzIHRoZSByb290IG1lbnUgX2FuZF8gaGFzIGEgY29udHJvbGxlciwgaW5pdGlhbGl6ZVxuICAgKiAgIHRoZSBjb250cm9sbGVyLlxuICAgKiAtIFBvcHVsYXRlIHRoZSBtZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgZWxlbWVudHMuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IFdpbGwgdGhyb3cgYW4gRXJyb3IgaWYgdmFsaWRhdGUgcmV0dXJucyBgZmFsc2VgLlxuICAgKi9cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICBpZiAoIXRoaXMuX3ZhbGlkYXRlKCkpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBBY2Nlc2libGVNZW51OiBjYW5ub3QgaW5pdGlhbGl6ZSBtZW51LiBUaGUgZm9sbG93aW5nIGVycm9ycyBoYXZlIGJlZW4gZm91bmQ6XG4gLSAke3RoaXMuZXJyb3JzLmpvaW4oXG4gICAgICAgICAgYFxuIC0gYFxuICAgICAgICApfWBcbiAgICAgICk7XG4gICAgaWYgKHRoaXMuZWxlbWVudHMucm9vdE1lbnUgPT09IG51bGwgJiYgdGhpcy5fZmluZFJvb3RNZW51KHRoaXMpLCB0aGlzLl9zZXRET01FbGVtZW50cygpLCB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5kb20uY29udHJvbGxlciAmJiB0aGlzLmRvbS5jb250YWluZXIpIHtcbiAgICAgIGNvbnN0IHQgPSBuZXcgdGhpcy5fTWVudVRvZ2dsZVR5cGUoe1xuICAgICAgICBtZW51VG9nZ2xlRWxlbWVudDogdGhpcy5kb20uY29udHJvbGxlcixcbiAgICAgICAgcGFyZW50RWxlbWVudDogdGhpcy5kb20uY29udGFpbmVyLFxuICAgICAgICBjb250cm9sbGVkTWVudTogdGhpc1xuICAgICAgfSk7XG4gICAgICB4KFwiYnV0dG9uXCIsIHsgdG9nZ2xlOiB0LmRvbS50b2dnbGUgfSkgfHwgdC5kb20udG9nZ2xlLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJidXR0b25cIiksIHQuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNvbnRyb2xzXCIsIHRoaXMuZG9tLm1lbnUuaWQpLCB0aGlzLl9lbGVtZW50cy5jb250cm9sbGVyID0gdDtcbiAgICB9XG4gICAgdGhpcy5fY3JlYXRlQ2hpbGRFbGVtZW50cygpO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3Q8SFRNTEVsZW1lbnQsIEhUTUxFbGVtZW50W10+fVxuICAgKlxuICAgKiBAc2VlIF9kb21cbiAgICovXG4gIGdldCBkb20oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RvbTtcbiAgfVxuICAvKipcbiAgICogVGhlIHF1ZXJ5IHNlbGVjdG9ycyB1c2VkIGJ5IHRoZSBtZW51IHRvIHBvcHVsYXRlIHRoZSBkb20uXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7T2JqZWN0PHN0cmluZz59XG4gICAqXG4gICAqIEBzZWUgX3NlbGVjdG9yc1xuICAgKi9cbiAgZ2V0IHNlbGVjdG9ycygpIHtcbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3JzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZGVjbGFyZWQgYWNjZXNzaWJsZS1tZW51IGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHJlYWRvbmx5XG4gICAqXG4gICAqIEB0eXBlIHtPYmplY3Q8QmFzZU1lbnUsIEJhc2VNZW51VG9nZ2xlLCBCYXNlTWVudUl0ZW1bXSwgQmFzZU1lbnVUb2dnbGVbXT59XG4gICAqXG4gICAqIEBzZWUgX2VsZW1lbnRzXG4gICAqL1xuICBnZXQgZWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgZmxhZyBtYXJraW5nIHRoZSByb290IG1lbnUuXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICpcbiAgICogQHNlZSBfcm9vdFxuICAgKi9cbiAgZ2V0IGlzVG9wTGV2ZWwoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Jvb3Q7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBjbGFzcyhlcykgdG8gYXBwbHkgd2hlbiB0aGUgbWVudSBpcyBvcGVuLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3Mgb3BlbiBjbGFzcyhlcykuXG4gICAqXG4gICAqIEB0eXBlIHtzdHJpbmd8c3RyaW5nW119XG4gICAqXG4gICAqIEBzZWUgX29wZW5DbGFzc1xuICAgKi9cbiAgZ2V0IG9wZW5DbGFzcygpIHtcbiAgICByZXR1cm4gdGhpcy5pc1RvcExldmVsID8gdGhpcy5fb3BlbkNsYXNzIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5vcGVuQ2xhc3M7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBjbGFzcyhlcykgdG8gYXBwbHkgd2hlbiB0aGUgbWVudSBpcyBjbG9zZWQuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBjbG9zZSBjbGFzcyhlcykuXG4gICAqXG4gICAqIEB0eXBlIHtzdHJpbmd8c3RyaW5nW119XG4gICAqXG4gICAqIEBzZWUgX2Nsb3NlQ2xhc3NcbiAgICovXG4gIGdldCBjbG9zZUNsYXNzKCkge1xuICAgIHJldHVybiB0aGlzLmlzVG9wTGV2ZWwgPyB0aGlzLl9jbG9zZUNsYXNzIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5jbG9zZUNsYXNzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgY2xhc3MoZXMpIHRvIGFwcGx5IHdoZW4gdGhlIG1lbnUgaXMgdHJhbnNpdGlvbmluZyBiZXR3ZWVuIG9wZW4gYW5kIGNsb3NlZC5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgZGlmZmVyZW50bHkgZm9yIHJvb3QgdnMuIHN1Ym1lbnVzLlxuICAgKiBTdWJtZW51cyB3aWxsIGFsd2F5cyBpbmhlcml0IHRoZWlyIHJvb3QgbWVudSdzIHRyYW5zaXRpb24gY2xhc3MoZXMpLlxuICAgKlxuICAgKiBAdHlwZSB7c3RyaW5nfHN0cmluZ1tdfVxuICAgKlxuICAgKiBAc2VlIF90cmFuc2l0aW9uQ2xhc3NcbiAgICovXG4gIGdldCB0cmFuc2l0aW9uQ2xhc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX3RyYW5zaXRpb25DbGFzcyA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUudHJhbnNpdGlvbkNsYXNzO1xuICB9XG4gIC8qKlxuICAgKiBUaGUgaW5kZXggb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtZW51IGl0ZW0gaW4gdGhlIG1lbnUuXG4gICAqXG4gICAqIC0gQXR0ZW1wdGluZyB0byBzZXQgYSB2YWx1ZSBsZXNzIHRoYW4gLTEgd2lsbCBzZXQgdGhlIGN1cnJlbnQgY2hpbGQgdG8gLTEuXG4gICAqIC0gQXR0ZW1wdGluZyB0byBzZXQgYSB2YWx1ZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBtZW51IGl0ZW1zXG4gICAqICAgd2lsbCBzZXQgdGhlIGN1cnJlbnQgY2hpbGQgdG8gdGhlIGluZGV4IG9mIHRoZSBsYXN0IG1lbnUgaXRlbSBpbiB0aGUgbWVudS5cbiAgICpcbiAgICogSWYgdGhlIGN1cnJlbnQgbWVudSBoYXMgYSBwYXJlbnQgbWVudSBfYW5kXyB0aGUgbWVudSdzXG4gICAqIGN1cnJlbnQgZXZlbnQgaXMgXCJtb3VzZVwiLCBUaGUgcGFyZW50IG1lbnVcbiAgICogd2lsbCBoYXZlIGl0J3MgY3VycmVudCBjaGlsZCB1cGRhdGVkIGFzIHdlbGwgdG8gaGVscCB3aXRoIHRyYW5zaXRpb25pbmdcbiAgICogYmV0d2VlbiBtb3VzZSBhbmQga2V5Ym9hcmQgbmF2aWF0aW9uLlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF9jdXJyZW50Q2hpbGRcbiAgICovXG4gIGdldCBjdXJyZW50Q2hpbGQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRDaGlsZDtcbiAgfVxuICAvKipcbiAgICogVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIG1lbnUncyBmb2N1cy5cbiAgICpcbiAgICogLSBJZiB0aGUgbWVudSBoYXMgc3VibWVudXMsIHNldHRpbmcgdGhlIGZvY3VzIHN0YXRlIHRvIFwibm9uZVwiIG9yIFwic2VsZlwiIHdpbGxcbiAgICogICB1cGRhdGUgYWxsIGNoaWxkIG1lbnVzIHRvIGhhdmUgdGhlIGZvY3VzIHN0YXRlIG9mIFwibm9uZVwiLlxuICAgKiAtIElmIHRoZSBtZW51IGhhcyBhIHBhcmVudCBtZW51LCBzZXR0aW5nIHRoZSBmb2N1cyBzdGF0ZSB0byBcInNlbGZcIiBvciBcImNoaWxkXCJcbiAgICogICB3aWxsIHVwZGF0ZSBhbGwgcGFyZW50IG1lbnVzIHRvIGhhdmUgdGhlIGZvY3VzIHN0YXRlIG9mIFwiY2hpbGRcIi5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICpcbiAgICogQHNlZSBfZm9jdXNTdGF0ZVxuICAgKi9cbiAgZ2V0IGZvY3VzU3RhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZvY3VzU3RhdGU7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBsYXN0IGV2ZW50IHRyaWdnZXJlZCBvbiB0aGUgbWVudS5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICpcbiAgICogQHNlZSBfY3VycmVudEV2ZW50XG4gICAqL1xuICBnZXQgY3VycmVudEV2ZW50KCkge1xuICAgIHJldHVybiB0aGlzLl9jdXJyZW50RXZlbnQ7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbWVudSBpdGVtLlxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHR5cGUge0Jhc2VNZW51SXRlbX1cbiAgICovXG4gIGdldCBjdXJyZW50TWVudUl0ZW0oKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zW3RoaXMuY3VycmVudENoaWxkXTtcbiAgfVxuICAvKipcbiAgICogVGhlIHR5cGUgb2YgaG92ZXJhYmlsaXR5IGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgZGlmZmVyZW50bHkgZm9yIHJvb3QgdnMuIHN1Ym1lbnVzLlxuICAgKiBTdWJtZW51cyB3aWxsIGFsd2F5cyBpbmhlcml0IHRoZWlyIHJvb3QgbWVudSdzIGhvdmVyYWJpbGl0eS5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICpcbiAgICogQHNlZSBfaG92ZXJUeXBlXG4gICAqL1xuICBnZXQgaG92ZXJUeXBlKCkge1xuICAgIHJldHVybiB0aGlzLl9yb290ID8gdGhpcy5faG92ZXJUeXBlIDogdGhpcy5lbGVtZW50cy5yb290TWVudS5ob3ZlclR5cGU7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxpc2Vjb25kcykgdXNlZCBmb3IgcG9pbnRlcmVudGVyL3BvaW50ZXJsZWF2ZSBldmVudHMgdG8gdGFrZSBwbGFjZS5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgZGlmZmVyZW50bHkgZm9yIHJvb3QgdnMuIHN1Ym1lbnVzLlxuICAgKiBTdWJtZW51cyB3aWxsIGFsd2F5cyBpbmhlcml0IHRoZWlyIHJvb3QgbWVudSdzIGhvdmVyIGRlbGF5LlxuICAgKlxuICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgKlxuICAgKiBAc2VlIF9ob3ZlckRlbGF5XG4gICAqL1xuICBnZXQgaG92ZXJEZWxheSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcm9vdCA/IHRoaXMuX2hvdmVyRGVsYXkgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmhvdmVyRGVsYXk7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxpc2Vjb25kcykgdXNlZCBmb3IgcG9pbnRlcmVudGVyIGV2ZW50cyB0byB0YWtlIHBsYWNlLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3MgZW50ZXIgZGVsYXkuXG4gICAqXG4gICAqIElmIGVudGVyRGVsYXkgaXMgc2V0IHRvIC0xLCB0aGUgaG92ZXJEZWxheSB2YWx1ZSB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAgICpcbiAgICogQHR5cGUge251bWJlcn1cbiAgICpcbiAgICogQHNlZSBfZW50ZXJEZWxheVxuICAgKi9cbiAgZ2V0IGVudGVyRGVsYXkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2VudGVyRGVsYXkgPT09IC0xID8gdGhpcy5ob3ZlckRlbGF5IDogdGhpcy5fcm9vdCA/IHRoaXMuX2VudGVyRGVsYXkgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmVudGVyRGVsYXk7XG4gIH1cbiAgLyoqXG4gICAqIFRoZSBkZWxheSB0aW1lIChpbiBtaWxpc2Vjb25kcykgdXNlZCBmb3IgcG9pbnRlcmxlYXZlIGV2ZW50cyB0byB0YWtlIHBsYWNlLlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3MgbGVhdmUgZGVsYXkuXG4gICAqXG4gICAqIElmIGxlYXZlRGVsYXkgaXMgc2V0IHRvIC0xLCB0aGUgaG92ZXJEZWxheSB2YWx1ZSB3aWxsIGJlIHVzZWQgaW5zdGVhZC5cbiAgICpcbiAgICogQHR5cGUge251bWJlcn1cbiAgICpcbiAgICogQHNlZSBfbGVhdmVEZWxheVxuICAgKi9cbiAgZ2V0IGxlYXZlRGVsYXkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xlYXZlRGVsYXkgPT09IC0xID8gdGhpcy5ob3ZlckRlbGF5IDogdGhpcy5fcm9vdCA/IHRoaXMuX2xlYXZlRGVsYXkgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmxlYXZlRGVsYXk7XG4gIH1cbiAgLyoqXG4gICAqIEEgZmxhZyB0byBjaGVjayBpZiB0aGUgbWVudSdzIGZvY3VzIG1ldGhvZHMgc2hvdWxkIF9hY3R1YWxseV8gbW92ZSB0aGUgZm9jdXMgaW4gdGhlIERPTS5cbiAgICpcbiAgICogVGhpcyB3aWxsIGJlIGBmYWxzZWAgdW5sZXNzIGFueSBvZiB0aGUgZm9sbG93aW5nIGNyaXRlcmlhIGFyZSBtZXQ6XG4gICAqIC0gVGhlIG1lbnUncyBjdXJyZW50IGV2ZW50IGlzIFwia2V5Ym9hcmRcIi5cbiAgICogLSBUaGUgbWVudSdzIGN1cnJlbnQgZXZlbnQgaXMgXCJjaGFyYWN0ZXJcIi5cbiAgICogLSBUaGUgbWVudSdzIGN1cnJlbnQgZXZlbnQgaXMgXCJtb3VzZVwiIF9hbmRfIHRoZSBtZW51J3NcbiAgICogICBob3ZlciB0eXBlIGlzIFwiZHluYW1pY1wiLlxuICAgKlxuICAgKiBAcmVhZG9ubHlcbiAgICpcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqL1xuICBnZXQgc2hvdWxkRm9jdXMoKSB7XG4gICAgbGV0IHQgPSAhMTtcbiAgICByZXR1cm4gKHRoaXMuY3VycmVudEV2ZW50ID09PSBcImtleWJvYXJkXCIgfHwgdGhpcy5jdXJyZW50RXZlbnQgPT09IFwiY2hhcmFjdGVyXCIpICYmICh0ID0gITApLCB0aGlzLmN1cnJlbnRFdmVudCA9PT0gXCJtb3VzZVwiICYmIHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIiAmJiAodCA9ICEwKSwgdDtcbiAgfVxuICAvKipcbiAgICogQSBmbGFnIHRvIGNoZWNrIGlmIHRoZSBtZW51IGNhbiBkeW5hbWljYWxseSBob3Zlci5cbiAgICpcbiAgICogVGhpcyBmdW5jdGlvbnMgZGlmZmVyZW50bHkgZm9yIHJvb3QgdnMuIHN1Ym1lbnVzLlxuICAgKiBTdWJtZW51cyB3aWxsIGFsd2F5cyBpbmhlcml0IHRoZWlyIHJvb3QgbWVudSdzIGhhc09wZW5lZC5cbiAgICpcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqXG4gICAqIEBzZWUgX2hhc09wZW5lZFxuICAgKi9cbiAgZ2V0IGhhc09wZW5lZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fcm9vdCA/IHRoaXMuX2hhc09wZW5lZCA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUuaGFzT3BlbmVkO1xuICB9XG4gIC8qKlxuICAgKiBBbiBhcnJheSBvZiBlcnJvciBtZXNzYWdlcyBnZW5lcmF0ZWQgYnkgdGhlIG1lbnUuXG4gICAqXG4gICAqIEByZWFkb25seVxuICAgKlxuICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAqXG4gICAqIEBzZWUgX2Vycm9yc1xuICAgKi9cbiAgZ2V0IGVycm9ycygpIHtcbiAgICByZXR1cm4gdGhpcy5fZXJyb3JzO1xuICB9XG4gIHNldCBvcGVuQ2xhc3ModCkge1xuICAgIFMoeyBvcGVuQ2xhc3M6IHQgfSksIHRoaXMuX29wZW5DbGFzcyAhPT0gdCAmJiAodGhpcy5fb3BlbkNsYXNzID0gdCk7XG4gIH1cbiAgc2V0IGNsb3NlQ2xhc3ModCkge1xuICAgIFMoeyBjbG9zZUNsYXNzOiB0IH0pLCB0aGlzLl9jbG9zZUNsYXNzICE9PSB0ICYmICh0aGlzLl9jbG9zZUNsYXNzID0gdCk7XG4gIH1cbiAgc2V0IHRyYW5zaXRpb25DbGFzcyh0KSB7XG4gICAgUyh7IHRyYW5zaXRpb25DbGFzczogdCB9KSwgdGhpcy5fdHJhbnNpdGlvbkNsYXNzICE9PSB0ICYmICh0aGlzLl90cmFuc2l0aW9uQ2xhc3MgPSB0KTtcbiAgfVxuICBzZXQgY3VycmVudENoaWxkKHQpIHtcbiAgICBwKFwibnVtYmVyXCIsIHsgdmFsdWU6IHQgfSk7XG4gICAgZnVuY3Rpb24gZShzKSB7XG4gICAgICBpZiAoW1wibW91c2VcIiwgXCJjaGFyYWN0ZXJcIl0uaW5jbHVkZXMocy5jdXJyZW50RXZlbnQpICYmIHMuZWxlbWVudHMucGFyZW50TWVudSkge1xuICAgICAgICBsZXQgaSA9IDAsIG8gPSAhMTtcbiAgICAgICAgZm9yICg7ICFvICYmIGkgPCBzLmVsZW1lbnRzLnBhcmVudE1lbnUuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aDsgKSB7XG4gICAgICAgICAgY29uc3QgaCA9IHMuZWxlbWVudHMucGFyZW50TWVudS5lbGVtZW50cy5tZW51SXRlbXNbaV07XG4gICAgICAgICAgaC5pc1N1Ym1lbnVJdGVtICYmIGguZWxlbWVudHMudG9nZ2xlLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51ID09PSBzICYmIChvID0gITAsIHMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50RXZlbnQgPSBzLmN1cnJlbnRFdmVudCwgcy5lbGVtZW50cy5wYXJlbnRNZW51LmN1cnJlbnRDaGlsZCA9IGkpLCBpKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdCA8IC0xID8gKHRoaXMuX2N1cnJlbnRDaGlsZCA9IC0xLCBlKHRoaXMpKSA6IHQgPj0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXMubGVuZ3RoID8gKHRoaXMuX2N1cnJlbnRDaGlsZCA9IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCAtIDEsIGUodGhpcykpIDogdGhpcy5mb2N1c0NoaWxkICE9PSB0ICYmICh0aGlzLl9jdXJyZW50Q2hpbGQgPSB0LCBlKHRoaXMpKTtcbiAgfVxuICBzZXQgZm9jdXNTdGF0ZSh0KSB7XG4gICAgVih7IHZhbHVlOiB0IH0pLCB0aGlzLl9mb2N1c1N0YXRlICE9PSB0ICYmICh0aGlzLl9mb2N1c1N0YXRlID0gdCksIHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMubGVuZ3RoID4gMCAmJiAodCA9PT0gXCJzZWxmXCIgfHwgdCA9PT0gXCJub25lXCIpICYmIHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgZS5lbGVtZW50cy5jb250cm9sbGVkTWVudS5mb2N1c1N0YXRlID0gXCJub25lXCI7XG4gICAgfSksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudSAmJiAodCA9PT0gXCJzZWxmXCIgfHwgdCA9PT0gXCJjaGlsZFwiKSAmJiAodGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzU3RhdGUgPSBcImNoaWxkXCIpO1xuICB9XG4gIHNldCBjdXJyZW50RXZlbnQodCkge1xuICAgIFIoeyB2YWx1ZTogdCB9KSwgdGhpcy5fY3VycmVudEV2ZW50ICE9PSB0ICYmICh0aGlzLl9jdXJyZW50RXZlbnQgPSB0LCB0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLmxlbmd0aCA+IDAgJiYgdGhpcy5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBlLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmN1cnJlbnRFdmVudCA9IHQ7XG4gICAgfSkpO1xuICB9XG4gIHNldCBob3ZlclR5cGUodCkge1xuICAgIEgoeyB2YWx1ZTogdCB9KSwgdGhpcy5faG92ZXJUeXBlICE9PSB0ICYmICh0aGlzLl9ob3ZlclR5cGUgPSB0KTtcbiAgfVxuICBzZXQgaG92ZXJEZWxheSh0KSB7XG4gICAgcChcIm51bWJlclwiLCB7IHZhbHVlOiB0IH0pLCB0aGlzLl9ob3ZlckRlbGF5ICE9PSB0ICYmICh0aGlzLl9ob3ZlckRlbGF5ID0gdCk7XG4gIH1cbiAgc2V0IGVudGVyRGVsYXkodCkge1xuICAgIHAoXCJudW1iZXJcIiwgeyB2YWx1ZTogdCB9KSwgdGhpcy5fZW50ZXJEZWxheSAhPT0gdCAmJiAodGhpcy5fZW50ZXJEZWxheSA9IHQpO1xuICB9XG4gIHNldCBsZWF2ZURlbGF5KHQpIHtcbiAgICBwKFwibnVtYmVyXCIsIHsgdmFsdWU6IHQgfSksIHRoaXMuX2xlYXZlRGVsYXkgIT09IHQgJiYgKHRoaXMuX2xlYXZlRGVsYXkgPSB0KTtcbiAgfVxuICBzZXQgaGFzT3BlbmVkKHQpIHtcbiAgICBwKFwiYm9vbGVhblwiLCB7IHZhbHVlOiB0IH0pLCB0aGlzLl9oYXNPcGVuZWQgIT09IHQgJiYgKHRoaXMuX2hhc09wZW5lZCA9IHQpO1xuICB9XG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgYWxsIGFzcGVjdHMgb2YgdGhlIG1lbnUgdG8gZW5zdXJlIHByb3BlciBmdW5jdGlvbmFsaXR5LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IC0gVGhlIHJlc3VsdCBvZiB0aGUgdmFsaWRhdGlvbi5cbiAgICovXG4gIF92YWxpZGF0ZSgpIHtcbiAgICBsZXQgdCA9ICEwLCBlO1xuICAgIHRoaXMuX2RvbS5jb250YWluZXIgIT09IG51bGwgfHwgdGhpcy5fZG9tLmNvbnRyb2xsZXIgIT09IG51bGwgPyBlID0gayhIVE1MRWxlbWVudCwge1xuICAgICAgbWVudUVsZW1lbnQ6IHRoaXMuX2RvbS5tZW51LFxuICAgICAgY29udHJvbGxlckVsZW1lbnQ6IHRoaXMuX2RvbS5jb250cm9sbGVyLFxuICAgICAgY29udGFpbmVyRWxlbWVudDogdGhpcy5fZG9tLmNvbnRhaW5lclxuICAgIH0pIDogZSA9IGsoSFRNTEVsZW1lbnQsIHtcbiAgICAgIG1lbnVFbGVtZW50OiB0aGlzLl9kb20ubWVudVxuICAgIH0pLCBlLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goZS5lcnJvci5tZXNzYWdlKSwgdCA9ICExKTtcbiAgICBsZXQgcztcbiAgICBpZiAodGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVJdGVtcyAhPT0gXCJcIiA/IHMgPSBEKHtcbiAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHRoaXMuX3NlbGVjdG9ycy5tZW51SXRlbXMsXG4gICAgICBtZW51TGlua1NlbGVjdG9yOiB0aGlzLl9zZWxlY3RvcnMubWVudUxpbmtzLFxuICAgICAgc3VibWVudUl0ZW1TZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVJdGVtcyxcbiAgICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVUb2dnbGVzLFxuICAgICAgc3VibWVudVNlbGVjdG9yOiB0aGlzLl9zZWxlY3RvcnMuc3VibWVudXNcbiAgICB9KSA6IHMgPSBEKHtcbiAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHRoaXMuX3NlbGVjdG9ycy5tZW51SXRlbXMsXG4gICAgICBtZW51TGlua1NlbGVjdG9yOiB0aGlzLl9zZWxlY3RvcnMubWVudUxpbmtzXG4gICAgfSksIHMuc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChzLmVycm9yLm1lc3NhZ2UpLCB0ID0gITEpLCB0aGlzLl9vcGVuQ2xhc3MgIT09IFwiXCIpIHtcbiAgICAgIGNvbnN0IGMgPSBTKHsgb3BlbkNsYXNzOiB0aGlzLl9vcGVuQ2xhc3MgfSk7XG4gICAgICBjLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goYy5lcnJvci5tZXNzYWdlKSwgdCA9ICExKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX2Nsb3NlQ2xhc3MgIT09IFwiXCIpIHtcbiAgICAgIGNvbnN0IGMgPSBTKHtcbiAgICAgICAgY2xvc2VDbGFzczogdGhpcy5fY2xvc2VDbGFzc1xuICAgICAgfSk7XG4gICAgICBjLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goYy5lcnJvci5tZXNzYWdlKSwgdCA9ICExKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX3RyYW5zaXRpb25DbGFzcyAhPT0gXCJcIikge1xuICAgICAgY29uc3QgYyA9IFMoe1xuICAgICAgICB0cmFuc2l0aW9uQ2xhc3M6IHRoaXMuX3RyYW5zaXRpb25DbGFzc1xuICAgICAgfSk7XG4gICAgICBjLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goYy5lcnJvci5tZXNzYWdlKSwgdCA9ICExKTtcbiAgICB9XG4gICAgY29uc3QgbiA9IHAoXCJib29sZWFuXCIsIHsgaXNUb3BMZXZlbDogdGhpcy5fcm9vdCB9KTtcbiAgICBpZiAobi5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKG4uZXJyb3IubWVzc2FnZSksIHQgPSAhMSksIHRoaXMuX2VsZW1lbnRzLnBhcmVudE1lbnUgIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IGMgPSBrKEksIHtcbiAgICAgICAgcGFyZW50TWVudTogdGhpcy5fZWxlbWVudHMucGFyZW50TWVudVxuICAgICAgfSk7XG4gICAgICBjLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goYy5lcnJvci5tZXNzYWdlKSwgdCA9ICExKTtcbiAgICB9XG4gICAgY29uc3QgaSA9IEgoeyBob3ZlclR5cGU6IHRoaXMuX2hvdmVyVHlwZSB9KTtcbiAgICBpLnN0YXR1cyB8fCAodGhpcy5fZXJyb3JzLnB1c2goaS5lcnJvci5tZXNzYWdlKSwgdCA9ICExKTtcbiAgICBjb25zdCBvID0gcChcIm51bWJlclwiLCB7XG4gICAgICBob3ZlckRlbGF5OiB0aGlzLl9ob3ZlckRlbGF5XG4gICAgfSk7XG4gICAgby5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKG8uZXJyb3IubWVzc2FnZSksIHQgPSAhMSk7XG4gICAgY29uc3QgaCA9IHAoXCJudW1iZXJcIiwge1xuICAgICAgZW50ZXJEZWxheTogdGhpcy5fZW50ZXJEZWxheVxuICAgIH0pO1xuICAgIGguc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChoLmVycm9yLm1lc3NhZ2UpLCB0ID0gITEpO1xuICAgIGNvbnN0IG0gPSBwKFwibnVtYmVyXCIsIHtcbiAgICAgIGxlYXZlRGVsYXk6IHRoaXMuX2xlYXZlRGVsYXlcbiAgICB9KTtcbiAgICByZXR1cm4gbS5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKG0uZXJyb3IubWVzc2FnZSksIHQgPSAhMSksIHQ7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgRE9NIGVsZW1lbnRzIHdpdGhpbiB0aGUgbWVudS5cbiAgICpcbiAgICogRWxlbWVudHMgdGhhdCBhcmUgbm90IHN0b3JlZCBpbnNpZGUgYW4gYXJyYXkgY2Fubm90IGJlIHNldCB0aHJvdWdoIHRoaXMgbWV0aG9kLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgIGVsZW1lbnRUeXBlICAgICAgICAgICAgLSBUaGUgdHlwZSBvZiBlbGVtZW50IHRvIHBvcHVsYXRlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBbYmFzZSA9IHRoaXMuZG9tLm1lbnVdIC0gVGhlIGVsZW1lbnQgdXNlZCBhcyB0aGUgYmFzZSBmb3IgdGhlIHF1ZXJ5U2VsZWN0LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICBbb3ZlcndyaXRlID0gdHJ1ZV0gICAgIC0gQSBmbGFnIHRvIHNldCBpZiB0aGUgZXhpc3RpbmcgZWxlbWVudHMgd2lsbCBiZSBvdmVyd3JpdHRlbi5cbiAgICovXG4gIF9zZXRET01FbGVtZW50VHlwZSh0LCBlID0gdGhpcy5kb20ubWVudSwgcyA9ICEwKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLnNlbGVjdG9yc1t0XSA9PSBcInN0cmluZ1wiKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5kb21bdF0pKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYEFjY2Vzc2libGVNZW51OiBUaGUgXCIke3R9XCIgZWxlbWVudCBjYW5ub3QgYmUgc2V0IHRocm91Z2ggX3NldERPTUVsZW1lbnRUeXBlLmBcbiAgICAgICAgKTtcbiAgICAgIGUgIT09IHRoaXMuZG9tLm1lbnUgJiYgayhIVE1MRWxlbWVudCwgeyBiYXNlOiBlIH0pO1xuICAgICAgY29uc3QgaSA9IEFycmF5LmZyb20oXG4gICAgICAgIGUucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNlbGVjdG9yc1t0XSlcbiAgICAgICkuZmlsdGVyKFxuICAgICAgICAobykgPT4gby5wYXJlbnRFbGVtZW50ID09PSBlXG4gICAgICApO1xuICAgICAgcyA/IHRoaXMuX2RvbVt0XSA9IGkgOiB0aGlzLl9kb21bdF0gPSBbXG4gICAgICAgIC4uLnRoaXMuX2RvbVt0XSxcbiAgICAgICAgLi4uaVxuICAgICAgXTtcbiAgICB9IGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEFjY2Vzc2libGVNZW51OiBcIiR7dH1cIiBpcyBub3QgYSB2YWxpZCBlbGVtZW50IHR5cGUgd2l0aGluIHRoZSBtZW51LmBcbiAgICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIFJlc2V0cyBET00gZWxlbWVudHMgd2l0aGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBFbGVtZW50cyB0aGF0IGFyZSBub3Qgc3RvcmVkIGluc2lkZSBhbiBhcnJheSBjYW5ub3QgYmUgcmVzZXQgdGhyb3VnaCB0aGlzIG1ldGhvZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudFR5cGUgLSBUaGUgdHlwZSBvZiBlbGVtZW50IHRvIGNsZWFyLlxuICAgKi9cbiAgX3Jlc2V0RE9NRWxlbWVudFR5cGUodCkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5kb21bdF0gPCBcInVcIikge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRoaXMuZG9tW3RdKSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgIGBBY2Nlc3NpYmxlTWVudTogVGhlIFwiJHt0fVwiIGVsZW1lbnQgY2Fubm90IGJlIHJlc2V0IHRocm91Z2ggX3Jlc2V0RE9NRWxlbWVudFR5cGUuYFxuICAgICAgICApO1xuICAgICAgdGhpcy5fZG9tW3RdID0gW107XG4gICAgfSBlbHNlXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBBY2Nlc3NpYmxlTWVudTogXCIke3R9XCIgaXMgbm90IGEgdmFsaWQgZWxlbWVudCB0eXBlIHdpdGhpbiB0aGUgbWVudS5gXG4gICAgICApO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIGFsbCBET00gZWxlbWVudHMgd2l0aGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBVdGlsaWl6ZXMgX3NldERPTUVsZW1lbnRUeXBlIGFuZFxuICAgKiBfcmVzZXRET01FbGVtZW50VHlwZS5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldERPTUVsZW1lbnRzKCkge1xuICAgIHRoaXMuX3NldERPTUVsZW1lbnRUeXBlKFwibWVudUl0ZW1zXCIpLCB0aGlzLnNlbGVjdG9ycy5zdWJtZW51SXRlbXMgIT09IFwiXCIgJiYgKHRoaXMuX3NldERPTUVsZW1lbnRUeXBlKFwic3VibWVudUl0ZW1zXCIpLCB0aGlzLl9yZXNldERPTUVsZW1lbnRUeXBlKFwic3VibWVudVRvZ2dsZXNcIiksIHRoaXMuX3Jlc2V0RE9NRWxlbWVudFR5cGUoXCJzdWJtZW51c1wiKSwgdGhpcy5kb20uc3VibWVudUl0ZW1zLmZvckVhY2goKHQpID0+IHtcbiAgICAgIHRoaXMuX3NldERPTUVsZW1lbnRUeXBlKFwic3VibWVudVRvZ2dsZXNcIiwgdCwgITEpLCB0aGlzLl9zZXRET01FbGVtZW50VHlwZShcInN1Ym1lbnVzXCIsIHQsICExKTtcbiAgICB9KSk7XG4gIH1cbiAgLyoqXG4gICAqIEZpbmRzIHRoZSByb290IG1lbnUgZWxlbWVudC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAcGFyYW0ge0Jhc2VNZW51fSBtZW51IC0gVGhlIG1lbnUgdG8gY2hlY2suXG4gICAqL1xuICBfZmluZFJvb3RNZW51KHQpIHtcbiAgICBpZiAodC5pc1RvcExldmVsKVxuICAgICAgdGhpcy5fZWxlbWVudHMucm9vdE1lbnUgPSB0O1xuICAgIGVsc2UgaWYgKHQuZWxlbWVudHMucGFyZW50TWVudSAhPT0gbnVsbClcbiAgICAgIHRoaXMuX2ZpbmRSb290TWVudSh0LmVsZW1lbnRzLnBhcmVudE1lbnUpO1xuICAgIGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIHJvb3QgbWVudS5cIik7XG4gIH1cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFsbCBtZW51IGl0ZW1zIGFuZCBzdWJtZW51cy5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2NyZWF0ZUNoaWxkRWxlbWVudHMoKSB7XG4gICAgdGhpcy5kb20ubWVudUl0ZW1zLmZvckVhY2goKHQpID0+IHtcbiAgICAgIGxldCBlO1xuICAgICAgaWYgKHRoaXMuZG9tLnN1Ym1lbnVJdGVtcy5pbmNsdWRlcyh0KSkge1xuICAgICAgICBjb25zdCBzID0gdC5xdWVyeVNlbGVjdG9yKHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVUb2dnbGVzKSwgbiA9IHQucXVlcnlTZWxlY3Rvcih0aGlzLnNlbGVjdG9ycy5zdWJtZW51cyksIGkgPSBuZXcgdGhpcy5fTWVudVR5cGUoe1xuICAgICAgICAgIG1lbnVFbGVtZW50OiBuLFxuICAgICAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLm1lbnVJdGVtcyxcbiAgICAgICAgICBtZW51TGlua1NlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5tZW51TGlua3MsXG4gICAgICAgICAgc3VibWVudUl0ZW1TZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMuc3VibWVudUl0ZW1zLFxuICAgICAgICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMuc3VibWVudVRvZ2dsZXMsXG4gICAgICAgICAgc3VibWVudVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5zdWJtZW51cyxcbiAgICAgICAgICBvcGVuQ2xhc3M6IHRoaXMub3BlbkNsYXNzLFxuICAgICAgICAgIGNsb3NlQ2xhc3M6IHRoaXMuY2xvc2VDbGFzcyxcbiAgICAgICAgICB0cmFuc2l0aW9uQ2xhc3M6IHRoaXMudHJhbnNpdGlvbkNsYXNzLFxuICAgICAgICAgIGlzVG9wTGV2ZWw6ICExLFxuICAgICAgICAgIHBhcmVudE1lbnU6IHRoaXMsXG4gICAgICAgICAgaG92ZXJUeXBlOiB0aGlzLmhvdmVyVHlwZSxcbiAgICAgICAgICBob3ZlckRlbGF5OiB0aGlzLmhvdmVyRGVsYXksXG4gICAgICAgICAgZW50ZXJEZWxheTogdGhpcy5lbnRlckRlbGF5LFxuICAgICAgICAgIGxlYXZlRGVsYXk6IHRoaXMubGVhdmVEZWxheVxuICAgICAgICB9KSwgbyA9IG5ldyB0aGlzLl9NZW51VG9nZ2xlVHlwZSh7XG4gICAgICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IHMsXG4gICAgICAgICAgcGFyZW50RWxlbWVudDogdCxcbiAgICAgICAgICBjb250cm9sbGVkTWVudTogaSxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5wdXNoKG8pLCBlID0gbmV3IHRoaXMuX01lbnVJdGVtVHlwZSh7XG4gICAgICAgICAgbWVudUl0ZW1FbGVtZW50OiB0LFxuICAgICAgICAgIG1lbnVMaW5rRWxlbWVudDogcyxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzLFxuICAgICAgICAgIGlzU3VibWVudUl0ZW06ICEwLFxuICAgICAgICAgIGNoaWxkTWVudTogaSxcbiAgICAgICAgICB0b2dnbGU6IG9cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzID0gdC5xdWVyeVNlbGVjdG9yKHRoaXMuc2VsZWN0b3JzLm1lbnVMaW5rcyk7XG4gICAgICAgIGUgPSBuZXcgdGhpcy5fTWVudUl0ZW1UeXBlKHtcbiAgICAgICAgICBtZW51SXRlbUVsZW1lbnQ6IHQsXG4gICAgICAgICAgbWVudUxpbmtFbGVtZW50OiBzLFxuICAgICAgICAgIHBhcmVudE1lbnU6IHRoaXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9lbGVtZW50cy5tZW51SXRlbXMucHVzaChlKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogQ2xlYXJzIHRoZSBob3ZlciB0aW1lb3V0LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfY2xlYXJUaW1lb3V0KCkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9ob3ZlclRpbWVvdXQpO1xuICB9XG4gIC8qKlxuICAgKiBTZXRzIHRoZSBob3ZlciB0aW1lb3V0LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGV4ZWN1dGUuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgIGRlbGF5ICAgIC0gVGhlIGRlbGF5IHRpbWUgaW4gbWlsbGlzZWNvbmRzLlxuICAgKi9cbiAgX3NldFRpbWVvdXQodCwgZSkge1xuICAgIHAoXCJmdW5jdGlvblwiLCB7IGNhbGxiYWNrOiB0IH0pLCBwKFwibnVtYmVyXCIsIHsgZGVsYXk6IGUgfSksIHRoaXMuX2hvdmVyVGltZW91dCA9IHNldFRpbWVvdXQodCwgZSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMgZm9jdXMgZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciBtZW51IHVzZS5cbiAgICpcbiAgICogLSBBZGRzIGEgYGZvY3VzYCBsaXN0ZW5lciB0byBldmVyeSBtZW51IGl0ZW0gc28gd2hlbiBpdCBnYWlucyBmb2N1cyxcbiAgICogICBpdCB3aWxsIHNldCB0aGUgaXRlbSdzIGNvbnRhaW5pbmcgbWVudSdzIGZvY3VzIHN0YXRlXG4gICAqICAgdG8gXCJzZWxmXCIuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVGb2N1cygpIHtcbiAgICB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5mb3JFYWNoKCh0LCBlKSA9PiB7XG4gICAgICB0LmRvbS5saW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuZm9jdXNTdGF0ZSA9IFwic2VsZlwiLCB0aGlzLmN1cnJlbnRDaGlsZCA9IGU7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBjbGljayBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIHVzZS5cbiAgICpcbiAgICogLSBBZGRzIGEgYHBvaW50ZXJkb3duYCBsaXN0ZW5lciB0byBldmVyeSBtZW51IGl0ZW0gdGhhdCB3aWxsIGJsdXJcbiAgICogICBhbGwgbWVudSBpdGVtcyBpbiB0aGUgZW50aXJlIG1lbnUgc3RydWN0dXJlIChzdGFydGluZyBhdCB0aGUgcm9vdCBtZW51KSBhbmRcbiAgICogICB0aGVuIHByb3Blcmx5IGZvY3VzIHRoZSBjbGlja2VkIGl0ZW0uXG4gICAqIC0gQWRkcyBhIGBwb2ludGVydXBgIGxpc3RlbmVyIHRvIGV2ZXJ5IHN1Ym1lbnUgaXRlbSB0aGF0IHdpbGwgcHJvcGVybHlcbiAgICogICB0b2dnbGUgdGhlIHN1Ym1lbnUgb3Blbi9jbG9zZWQuXG4gICAqIC0gQWRkcyBhIGBwb2ludGVydXBgIGxpc3RlbmVyIHRvIHRoZSBtZW51J3MgY29udHJvbGxlclxuICAgKiAgIChpZiB0aGUgbWVudSBpcyB0aGUgcm9vdCBtZW51KSBzbyB3aGVuIGl0IGlzIGNsaWNrZWQgaXQgd2lsbCBwcm9wZXJseVxuICAgKiAgIHRvZ2dsZSBvcGVuL2Nsb3NlZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUNsaWNrKCkge1xuICAgIGZ1bmN0aW9uIHQoZSwgcywgbikge1xuICAgICAgbChuKSwgcy50b2dnbGUoKSwgcy5pc09wZW4gJiYgKGUuZm9jdXNTdGF0ZSA9IFwic2VsZlwiLCBzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmZvY3VzU3RhdGUgPSBcIm5vbmVcIik7XG4gICAgfVxuICAgIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmZvckVhY2goKGUsIHMpID0+IHtcbiAgICAgIGUuZG9tLmxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJwb2ludGVyZG93blwiLFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLmZvY3VzQ2hpbGQocyk7XG4gICAgICAgIH0sXG4gICAgICAgIHsgcGFzc2l2ZTogITAgfVxuICAgICAgKSwgZS5pc1N1Ym1lbnVJdGVtICYmIGUuZWxlbWVudHMudG9nZ2xlLmRvbS50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJwb2ludGVydXBcIixcbiAgICAgICAgKG4pID0+IHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdCh0aGlzLCBlLmVsZW1lbnRzLnRvZ2dsZSwgbik7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSksIHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmRvbS50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwicG9pbnRlcnVwXCIsXG4gICAgICAoZSkgPT4ge1xuICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIsIGUpO1xuICAgICAgfVxuICAgICksIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuZm9jdXNTdGF0ZSAhPT0gXCJub25lXCIgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCAhdGhpcy5kb20ubWVudS5jb250YWlucyhlLnRhcmdldCkgJiYgIXRoaXMuZG9tLm1lbnUgIT09IGUudGFyZ2V0ICYmICh0aGlzLmVsZW1lbnRzLnJvb3RNZW51Lmhhc09wZW5lZCA9IHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuc29tZShcbiAgICAgICAgKHMpID0+IHMuaXNPcGVuXG4gICAgICApKSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMgaG92ZXIgZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciB1c2UuXG4gICAqXG4gICAqIEFkZHMgYHBvaW50ZXJlbnRlcmAgbGlzdGVuZXJzIHRvIGFsbCBtZW51IGl0ZW1zIGFuZCBgcG9pbnRlcmxlYXZlYCBsaXN0ZW5lcnNcbiAgICogdG8gYWxsIHN1Ym1lbnUgaXRlbXMgd2hpY2ggZnVuY3Rpb24gZGlmZmVyZW50bHkgZGVwZW5kaW5nIG9uXG4gICAqIHRoZSBtZW51J3MgaG92ZXIgdHlwZS5cbiAgICpcbiAgICogQmVmb3JlIGV4ZWN1dGluZyBhbnl0aGluZywgdGhlIGV2ZW50IGlzIGNoZWNrZWQgdG8gbWFrZSBzdXJlIHRoZSBldmVudCB3YXNuJ3RcbiAgICogdHJpZ2dlcmVkIGJ5IGEgcGVuIG9yIHRvdWNoLlxuICAgKlxuICAgKiA8c3Ryb25nPkhvdmVyIFR5cGUgXCJvblwiPC9zdHJvbmc+XG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0gdGhlIG1lbnUnc1xuICAgKiAgICBjdXJyZW50IGNoaWxkIHZhbHVlIHdpbGwgY2hhbmdlIHRvIHRoYXRcbiAgICogICBtZW51IGl0ZW0uXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgc3VibWVudSBpdGVtIHRoZVxuICAgKiAgIHByZXZpZXcgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3NcbiAgICogICB0b2dnbGUgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVybGVhdmVgIGV2ZW50IHRyaWdnZXJzIG9uIGFuIG9wZW4gc3VibWVudSBpdGVtIHRoZVxuICAgKiAgIGNsb3NlIG1ldGhvZCBmb3IgdGhlIHN1Ym1lbnUgaXRlbSdzIHRvZ2dsZVxuICAgKiAgIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGEgZGVsYXkgc2V0IGJ5IHRoZSBtZW51J3MgaG92ZXIgZGVsYXkuXG4gICAqXG4gICAqIDxzdHJvbmc+SG92ZXIgVHlwZSBcImR5bmFtaWNcIjwvc3Ryb25nPlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhbnkgbWVudSBpdGVtIHRoZSBtZW51J3NcbiAgICogICBjdXJyZW50IGNoaWxkIHZhbHVlIHdpbGwgY2hhbmdlIHRvIHRoYXQgbWVudSBpdGVtLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhbnkgbWVudSBpdGVtLCBhbmQgdGhlIG1lbnUnc1xuICAgKiAgIGZvY3VzIHN0YXRlIGlzIG5vdCBcIm5vbmVcIiwgdGhlIG1lbnUgaXRlbVxuICAgKiAgIHdpbGwgYmUgZm9jdXNlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBzdWJtZW51IGl0ZW0sIGFuZCBhIHN1Ym1lbnUgaXNcbiAgICogICBhbHJlYWR5IG9wZW4sIHRoZSBwcmV2aWV3IG1ldGhvZCBmb3IgdGhlIHN1Ym1lbnUgaXRlbSdzIHRvZ2dsZSB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBub24tc3VibWVudSBpdGVtLCBhbmQgYSBzdWJtZW51XG4gICAqICAgaXMgYWxyZWFkeSBvcGVuLCB0aGUgY2xvc2VDaGlsZHJlbiBtZXRob2QgZm9yIHRoZSBtZW51IHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIHN1Ym1lbnUgaXRlbSwgYW5kIG5vIHN1Ym1lbnUgaXNcbiAgICogICBvcGVuLCBubyBzdWJtZW51LXNwZWNpZmljIG1ldGhvZHMgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVybGVhdmVgIGV2ZW50IHRyaWdnZXJzIG9uIGFuIG9wZW4gc3VibWVudSBpdGVtIHRoYXQgaXMgbm90IGFcbiAgICogICByb290LWxldmVsIHN1Ym1lbnUgaXRlbSB0aGUgY2xvc2UgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3MgdG9nZ2xlXG4gICAqICAgd2lsbCBiZSBjYWxsZWQgYW5kIHRoZSBzdWJtZW51IGl0ZW0gd2lsbCBiZSBmb2N1c2VkIGFmdGVyIGEgZGVsYXkgc2V0IGJ5XG4gICAqICAgdGhlIG1lbnUncyBob3ZlciBkZWxheS5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJsZWF2ZWAgZXZlbnQgdHJpZ2dlcnMgb24gYW4gb3BlbiBzdWJtZW51IGl0ZW0gdGhhdCBpcyBhXG4gICAqICAgcm9vdC1sZXZlbCBzdWJtZW51IGl0ZW0gbm8gc3VibWVudS1zcGVjaWZpYyBtZXRob2RzIHdpbGwgYmUgY2FsbGVkLlxuICAgKlxuICAgKiA8c3Ryb25nPkhvdmVyIFR5cGUgXCJvZmZcIjwvc3Ryb25nPlxuICAgKiBBbGwgYHBvaW50ZXJlbnRlcmAgYW5kIGBwb2ludGVybGVhdmVgIGV2ZW50cyBhcmUgaWdub3JlZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUhvdmVyKCkge1xuICAgIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmZvckVhY2goKHQsIGUpID0+IHtcbiAgICAgIHQuZG9tLmxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJlbnRlclwiLCAocykgPT4ge1xuICAgICAgICBzLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IHMucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiA/ICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyQ2hpbGRyZW4oKSwgdGhpcy5mb2N1c0NoaWxkKGUpLCB0LmlzU3VibWVudUl0ZW0gJiYgKHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHQuZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKTtcbiAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiB0LmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpKSA6IHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIiAmJiAodGhpcy5jdXJyZW50Q2hpbGQgPSBlLCAoIXRoaXMuaXNUb3BMZXZlbCB8fCB0aGlzLmZvY3VzU3RhdGUgIT09IFwibm9uZVwiKSAmJiAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKSksICghdGhpcy5pc1RvcExldmVsIHx8IHRoaXMuaGFzT3BlbmVkKSAmJiAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKSwgdC5pc1N1Ym1lbnVJdGVtID8gdGhpcy5lbnRlckRlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdC5lbGVtZW50cy50b2dnbGUucHJldmlldygpO1xuICAgICAgICB9LCB0aGlzLmVudGVyRGVsYXkpKSA6IHQuZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKSA6IHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY2xvc2VDaGlsZHJlbigpO1xuICAgICAgICB9LCB0aGlzLmVudGVyRGVsYXkpKSA6IHRoaXMuY2xvc2VDaGlsZHJlbigpKSkpO1xuICAgICAgfSksIHQuaXNTdWJtZW51SXRlbSAmJiAodC5kb20uaXRlbS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmxlYXZlXCIsIChzKSA9PiB7XG4gICAgICAgIHMucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgcy5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiIHx8ICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiID8gdGhpcy5sZWF2ZURlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHQuZWxlbWVudHMudG9nZ2xlLmNsb3NlKCk7XG4gICAgICAgIH0sIHRoaXMubGVhdmVEZWxheSkpIDogKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0LmVsZW1lbnRzLnRvZ2dsZS5jbG9zZSgpKSA6IHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIiAmJiAodGhpcy5sZWF2ZURlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCI7XG4gICAgICAgIH0sIHRoaXMubGVhdmVEZWxheSkpIDogdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIpKTtcbiAgICAgIH0pLCB0LmRvbS5pdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZW50ZXJcIiwgKHMpID0+IHtcbiAgICAgICAgcy5wb2ludGVyVHlwZSA9PT0gXCJwZW5cIiB8fCBzLnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIgfHwgdC5pc1N1Ym1lbnVJdGVtICYmICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiIHx8IHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIikgJiYgdGhpcy5sZWF2ZURlbGF5ID4gMCAmJiB0aGlzLl9jbGVhclRpbWVvdXQoKTtcbiAgICAgIH0pKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXlkb3duIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIFRoaXMgbWV0aG9kIGV4aXN0cyB0byBhc3NpdCB0aGUgX2hhbmRsZUtleXVwIG1ldGhvZC5cbiAgICpcbiAgICogLSBBZGRzIGEgYGtleWRvd25gIGxpc3RlbmVyIHRvIHRoZSBtZW51J3MgY29udHJvbGxlciAoaWYgdGhlIG1lbnUgaXMgdGhlIHJvb3QgbWVudSkuXG4gICAqICAgLSBCbG9ja3MgcHJvcGFnYXRpb24gb24gXCJTcGFjZVwiLCBcIkVudGVyXCIsIGFuZCBcIkVzY2FwZVwiIGtleXMuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXlkb3duKCkge1xuICAgIHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmRvbS50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwia2V5ZG93blwiLFxuICAgICAgKHQpID0+IHtcbiAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICAgIGNvbnN0IGUgPSBnKHQpO1xuICAgICAgICAoZSA9PT0gXCJTcGFjZVwiIHx8IGUgPT09IFwiRW50ZXJcIikgJiYgbCh0KTtcbiAgICAgIH1cbiAgICApO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGtleXVwIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIC0gQWRkcyBhIGBrZXl1cGAgbGlzdGVuZXIgdG8gdGhlIG1lbnUncyBjb250cm9sbGVyIChpZiB0aGUgbWVudSBpcyB0aGUgcm9vdCBtZW51KS5cbiAgICogICAtIFRvZ2dsZXMgdGhlIG1lbnUgd2hlbiB0aGUgdXNlciBoaXRzIFwiU3BhY2VcIiBvciBcIkVudGVyXCIuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXl1cCgpIHtcbiAgICB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5kb20udG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAodCkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBlID0gZyh0KTtcbiAgICAgIChlID09PSBcIlNwYWNlXCIgfHwgZSA9PT0gXCJFbnRlclwiKSAmJiAobCh0KSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLnRvZ2dsZSgpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuaXNPcGVuICYmIHRoaXMuZm9jdXNGaXJzdENoaWxkKCkpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudS5cbiAgICpcbiAgICogU2V0cyB0aGUgbWVudSdzIGZvY3VzIHN0YXRlIHRvIFwic2VsZlwiIGFuZFxuICAgKiBmb2N1c3NlcyB0aGUgbWVudSBpZiB0aGUgbWVudSdzIHNob3VsZEZvY3VzXG4gICAqIHZhbHVlIGlzIGB0cnVlYC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXMoKSB7XG4gICAgdGhpcy5mb2N1c1N0YXRlID0gXCJzZWxmXCIsIHRoaXMuc2hvdWxkRm9jdXMgJiYgdGhpcy5kb20ubWVudS5mb2N1cygpO1xuICB9XG4gIC8qKlxuICAgKiBVbmZvY3VzIHRoZSBtZW51LlxuICAgKlxuICAgKiBTZXRzIHRoZSBtZW51J3MgZm9jdXMgc3RhdGUgdG8gXCJub25lXCJcbiAgICogYW5kIGJsdXJzIHRoZSBtZW51IGlmIHRoZSBtZW51J3Mgc2hvdWxkRm9jdXNcbiAgICogdmFsbHVlIGlzIGB0cnVlYC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgYmx1cigpIHtcbiAgICB0aGlzLmZvY3VzU3RhdGUgPSBcIm5vbmVcIiwgdGhpcy5zaG91bGRGb2N1cyAmJiB0aGlzLmRvbS5tZW51LmJsdXIoKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBjdXJyZW50IGNoaWxkLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c0N1cnJlbnRDaGlsZCgpIHtcbiAgICB0aGlzLmZvY3VzU3RhdGUgPSBcInNlbGZcIiwgdGhpcy5jdXJyZW50Q2hpbGQgIT09IC0xICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmZvY3VzKCk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIG1lbnUncyBjaGlsZCBhdCBhIGdpdmVuIGluZGV4LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBpbmRleCBvZiB0aGUgY2hpbGQgdG8gZm9jdXMuXG4gICAqL1xuICBmb2N1c0NoaWxkKHQpIHtcbiAgICB0aGlzLmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5jdXJyZW50Q2hpbGQgPSB0LCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VlcyB0aGUgbWVudSdzIGZpcnN0IGNoaWxkLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c0ZpcnN0Q2hpbGQoKSB7XG4gICAgdGhpcy5mb2N1c0NoaWxkKDApO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIGxhc3QgY2hpbGQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzTGFzdENoaWxkKCkge1xuICAgIHRoaXMuZm9jdXNDaGlsZCh0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5sZW5ndGggLSAxKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBuZXh0IGNoaWxkLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c05leHRDaGlsZCgpIHtcbiAgICB0aGlzLmN1cnJlbnRDaGlsZCA8IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aCAtIDEgPyB0aGlzLmZvY3VzQ2hpbGQodGhpcy5jdXJyZW50Q2hpbGQgKyAxKSA6IHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBwcmV2aW91cyBjaGlsZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNQcmV2aW91c0NoaWxkKCkge1xuICAgIHRoaXMuY3VycmVudENoaWxkID4gMCA/IHRoaXMuZm9jdXNDaGlsZCh0aGlzLmN1cnJlbnRDaGlsZCAtIDEpIDogdGhpcy5mb2N1c0N1cnJlbnRDaGlsZCgpO1xuICB9XG4gIC8qKlxuICAgKiBCbHVycyB0aGUgbWVudSdzIGN1cnJlbnQgY2hpbGQuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGJsdXJDdXJyZW50Q2hpbGQoKSB7XG4gICAgdGhpcy5mb2N1c1N0YXRlID0gXCJub25lXCIsIHRoaXMuY3VycmVudENoaWxkICE9PSAtMSAmJiB0aGlzLmN1cnJlbnRNZW51SXRlbS5ibHVyKCk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51J3MgY29udHJvbGxlci5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNDb250cm9sbGVyKCkge1xuICAgIHRoaXMuZG9tLmNvbnRyb2xsZXIgJiYgKHRoaXMuc2hvdWxkRm9jdXMgJiYgdGhpcy5kb20uY29udHJvbGxlci5mb2N1cygpLCB0aGlzLmZvY3VzU3RhdGUgPSBcIm5vbmVcIik7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51J3MgY29udGFpbmVyLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c0NvbnRhaW5lcigpIHtcbiAgICB0aGlzLmRvbS5jb250YWluZXIgJiYgKHRoaXMuc2hvdWxkRm9jdXMgJiYgdGhpcy5kb20uY29udGFpbmVyLmZvY3VzKCksIHRoaXMuZm9jdXNTdGF0ZSA9IFwibm9uZVwiKTtcbiAgfVxuICAvKipcbiAgICogQ2xvc2UgYWxsIHN1Ym1lbnUgY2hpbGRyZW4uXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGNsb3NlQ2hpbGRyZW4oKSB7XG4gICAgdGhpcy5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5mb3JFYWNoKCh0KSA9PiB0LmNsb3NlKCkpO1xuICB9XG4gIC8qKlxuICAgKiBCbHVycyBhbGwgY2hpbGRyZW4gYW5kIHN1Ym1lbnUncyBjaGlsZHJlbi5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgYmx1ckNoaWxkcmVuKCkge1xuICAgIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmZvckVhY2goKHQpID0+IHtcbiAgICAgIHQuYmx1cigpLCB0LmlzU3VibWVudUl0ZW0gJiYgdC5lbGVtZW50cy5jaGlsZE1lbnUuYmx1ckNoaWxkcmVuKCk7XG4gICAgfSk7XG4gIH1cbn1cbmNsYXNzIFAgZXh0ZW5kcyBMIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYERpc2Nsb3N1cmVNZW51SXRlbWAuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgaXRlbS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgICAgIG9wdGlvbnMubWVudUl0ZW1FbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICAgICBvcHRpb25zLm1lbnVMaW5rRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSdzIGxpbmsgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtEaXNjbG9zdXJlTWVudX0gICAgICAgIG9wdGlvbnMucGFyZW50TWVudSAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICBbb3B0aW9ucy5pc1N1Ym1lbnVJdGVtID0gZmFsc2VdIC0gQSBmbGFnIHRvIG1hcmsgaWYgdGhlIG1lbnUgaXRlbSBpcyBjb250cm9sbGluZyBhIHN1Ym1lbnUuXG4gICAqIEBwYXJhbSB7P0Rpc2Nsb3N1cmVNZW51fSAgICAgICBbb3B0aW9ucy5jaGlsZE1lbnUgPSBudWxsXSAgICAgIC0gVGhlIGNoaWxkIG1lbnUuXG4gICAqIEBwYXJhbSB7P0Rpc2Nsb3N1cmVNZW51VG9nZ2xlfSBbb3B0aW9ucy50b2dnbGUgPSBudWxsXSAgICAgICAgIC0gVGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdICAgICAtIEEgZmxhZyB0byBpbml0aWFsaXplIHRoZSBtZW51IGl0ZW0gaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51SXRlbUVsZW1lbnQ6IHQsXG4gICAgbWVudUxpbmtFbGVtZW50OiBlLFxuICAgIHBhcmVudE1lbnU6IHMsXG4gICAgaXNTdWJtZW51SXRlbTogbiA9ICExLFxuICAgIGNoaWxkTWVudTogaSA9IG51bGwsXG4gICAgdG9nZ2xlOiBvID0gbnVsbCxcbiAgICBpbml0aWFsaXplOiBoID0gITBcbiAgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG1lbnVJdGVtRWxlbWVudDogdCxcbiAgICAgIG1lbnVMaW5rRWxlbWVudDogZSxcbiAgICAgIHBhcmVudE1lbnU6IHMsXG4gICAgICBpc1N1Ym1lbnVJdGVtOiBuLFxuICAgICAgY2hpbGRNZW51OiBpLFxuICAgICAgdG9nZ2xlOiBvXG4gICAgfSksIGggJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbn1cbmNsYXNzIFUgZXh0ZW5kcyBBIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYERpc2Nsb3N1cmVNZW51VG9nZ2xlYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgIG9wdGlvbnMgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51IHRvZ2dsZS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgIG9wdGlvbnMubWVudVRvZ2dsZUVsZW1lbnQgICAtIFRoZSB0b2dnbGUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgb3B0aW9ucy5wYXJlbnRFbGVtZW50ICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKiBAcGFyYW0ge0Rpc2Nsb3N1cmVNZW51fSAgb3B0aW9ucy5jb250cm9sbGVkTWVudSAgICAgIC0gVGhlIG1lbnUgY29udHJvbGxlZCBieSB0aGlzIHRvZ2dsZS5cbiAgICogQHBhcmFtIHs/RGlzY2xvc3VyZU1lbnV9IFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAtIFRoZSBtZW51IGNvbnRhaW5pbmcgdGhpcyB0b2dnbGUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSB0b2dnbGUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51VG9nZ2xlRWxlbWVudDogdCxcbiAgICBwYXJlbnRFbGVtZW50OiBlLFxuICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgIHBhcmVudE1lbnU6IG4gPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGkgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IHQsXG4gICAgICBwYXJlbnRFbGVtZW50OiBlLFxuICAgICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgICBwYXJlbnRNZW51OiBuXG4gICAgfSksIGkgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIEFSSUEgYXR0cmlidXRlcyBvbiB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIENhbGxzIHRoZSBCYXNlTWVudVRvZ2dsZSdzIF9zZXRBcmlhQXR0cmlidXRlcyBtZXRob2QuXG4gICAqXG4gICAqIEVuc3VyZXMgdGhlIHRvZ2dsZSBlbGVtZW50IGhhcyBhIGByb2xlYCBvZiBcImJ1dHRvblwiIGlmIGl0IGlzIG5vdFxuICAgKiBhbHJlYWR5IGEgYnV0dG9uLlxuICAgKlxuICAgKiBUaGVuIHVzaW5nIHRoZSB0b2dnbGUgYW5kIG1lbnUncyBJRHMsIHRoZSB0b2dnbGUncyBgYXJpYS1jb250cm9sc2BcbiAgICogaXMgc2V0IHRvIHRoZSBtZW51J3MgSUQuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9zZXRBcmlhQXR0cmlidXRlcygpIHtcbiAgICBzdXBlci5fc2V0QXJpYUF0dHJpYnV0ZXMoKSwgeChcImJ1dHRvblwiLCB7IHRvZ2dsZTogdGhpcy5kb20udG9nZ2xlIH0pIHx8IHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiYnV0dG9uXCIpLCB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFxuICAgICAgXCJhcmlhLWNvbnRyb2xzXCIsXG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LmlkXG4gICAgKTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZVNpYmxpbmdzIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3Mgb3BlbiBtZXRob2QuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5jbG9zZVNpYmxpbmdzKCksIHN1cGVyLm9wZW4oKTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudSB3aXRob3V0IHRoZSBjdXJyZW50IGZvY3VzIGVudGVyaW5nIGl0LlxuICAgKlxuICAgKiBDYWxscyB0aGUgIGNsb3NlU2libGluZ3MgbWV0aG9kXG4gICAqIGFuZCBfdGhlbl8gQmFzZU1lbnVUb2dnbGUncyBwcmV2aWV3IG1ldGhvZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgcHJldmlldygpIHtcbiAgICB0aGlzLmNsb3NlU2libGluZ3MoKSwgc3VwZXIucHJldmlldygpO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZUNoaWxkcmVuIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3MgY2xvc2UgbWV0aG9kLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBjbG9zZSgpIHtcbiAgICB0aGlzLmlzT3BlbiAmJiB0aGlzLmNsb3NlQ2hpbGRyZW4oKSwgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuY2xhc3MgSyBleHRlbmRzIEkge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgRGlzY2xvc3VyZU1lbnVgLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICBvcHRpb25zLm1lbnVFbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgbWVudSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5tZW51SXRlbVNlbGVjdG9yID0gbGldICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGl0ZW1zLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMubWVudUxpbmtTZWxlY3RvciA9IGFdICAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBsaW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVJdGVtU2VsZWN0b3IgPSBsaTpoYXModWwpXSAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMgY29udGFpbmluZyBzdWJtZW51cy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVUb2dnbGVTZWxlY3RvciA9IGJ1dHRvbl0gICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnUgdG9nZ2xlIGJ1dHRvbnMvbGlua3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51U2VsZWN0b3IgPSB1bF0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51cy5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgIFtvcHRpb25zLmNvbnRyb2xsZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRyb2xsaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7P0hUTUxFbGVtZW50fSAgICAgICBbb3B0aW9ucy5jb250YWluZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy5vcGVuQ2xhc3MgPSBzaG93XSAgICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJvcGVuXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy5jbG9zZUNsYXNzID0gaGlkZV0gICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJjbG9zZWRcIi5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLnRyYW5zaXRpb25DbGFzcyA9IHRyYW5zaXRpb25pbmddICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyB0cmFuc2l0aW9uaW5nIGJldHdlZW4gXCJvcGVuXCIgYW5kIFwiY2xvc2VkXCIgc3RhdGVzLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuaXNUb3BMZXZlbCA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIG1hcmsgdGhlIHJvb3QgbWVudS5cbiAgICogQHBhcmFtIHs/RGlzY2xvc3VyZU1lbnV9ICAgIFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAgICAgICAgICAgICAgICAtIFRoZSBwYXJlbnQgbWVudSB0byB0aGlzIG1lbnUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5ob3ZlclR5cGUgPSBvZmZdICAgICAgICAgICAgICAgICAgLSBUaGUgdHlwZSBvZiBob3ZlcmFiaWxpdHkgYSBtZW51IGhhcy5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyRGVsYXkgPSAyNTBdICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhbmQgY2xvc2luZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmVudGVyRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhIG1lbnUgaWYgdGhlIG1lbnUgaXMgZm9jdXNhYmxlIChpbiBtaWxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy5sZWF2ZURlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIGNsb3NpbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMub3B0aW9uYWxLZXlTdXBwb3J0ID0gZmFsc2VdICAgICAgIC0gQSBmbGFnIHRvIGFkZCBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0IChBcnJvdyBrZXlzLCBIb21lLCBhbmQgRW5kKSB0byB0aGUgbWVudS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgIFtvcHRpb25zLmluaXRpYWxpemUgPSB0cnVlXSAgICAgICAgICAgICAgICAtIEEgZmxhZyB0byBpbml0aWFsaXplIHRoZSBtZW51IGltbWVkaWF0ZWx5IHVwb24gY3JlYXRpb24uXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVudUVsZW1lbnQ6IGUsXG4gICAgbWVudUl0ZW1TZWxlY3RvcjogcyA9IFwibGlcIixcbiAgICBtZW51TGlua1NlbGVjdG9yOiBuID0gXCJhXCIsXG4gICAgc3VibWVudUl0ZW1TZWxlY3RvcjogaSA9IFwibGk6aGFzKHVsKVwiLFxuICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogbyA9IFwiYnV0dG9uXCIsXG4gICAgc3VibWVudVNlbGVjdG9yOiBoID0gXCJ1bFwiLFxuICAgIGNvbnRyb2xsZXJFbGVtZW50OiBtID0gbnVsbCxcbiAgICBjb250YWluZXJFbGVtZW50OiBjID0gbnVsbCxcbiAgICBvcGVuQ2xhc3M6IGEgPSBcInNob3dcIixcbiAgICBjbG9zZUNsYXNzOiBkID0gXCJoaWRlXCIsXG4gICAgdHJhbnNpdGlvbkNsYXNzOiBmID0gXCJ0cmFuc2l0aW9uaW5nXCIsXG4gICAgaXNUb3BMZXZlbDogeSA9ICEwLFxuICAgIHBhcmVudE1lbnU6IE0gPSBudWxsLFxuICAgIGhvdmVyVHlwZTogYiA9IFwib2ZmXCIsXG4gICAgaG92ZXJEZWxheTogXyA9IDI1MCxcbiAgICBlbnRlckRlbGF5OiBDID0gLTEsXG4gICAgbGVhdmVEZWxheTogRSA9IC0xLFxuICAgIG9wdGlvbmFsS2V5U3VwcG9ydDogVCA9ICExLFxuICAgIGluaXRpYWxpemU6IE8gPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudUVsZW1lbnQ6IGUsXG4gICAgICBtZW51SXRlbVNlbGVjdG9yOiBzLFxuICAgICAgbWVudUxpbmtTZWxlY3RvcjogbixcbiAgICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGksXG4gICAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IG8sXG4gICAgICBzdWJtZW51U2VsZWN0b3I6IGgsXG4gICAgICBjb250cm9sbGVyRWxlbWVudDogbSxcbiAgICAgIGNvbnRhaW5lckVsZW1lbnQ6IGMsXG4gICAgICBvcGVuQ2xhc3M6IGEsXG4gICAgICBjbG9zZUNsYXNzOiBkLFxuICAgICAgdHJhbnNpdGlvbkNsYXNzOiBmLFxuICAgICAgaXNUb3BMZXZlbDogeSxcbiAgICAgIHBhcmVudE1lbnU6IE0sXG4gICAgICBob3ZlclR5cGU6IGIsXG4gICAgICBob3ZlckRlbGF5OiBfLFxuICAgICAgZW50ZXJEZWxheTogQyxcbiAgICAgIGxlYXZlRGVsYXk6IEVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBzdWJtZW51cy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgRGlzY2xvc3VyZU1lbnV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VHlwZVwiLCBLKTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVzZS1iZWZvcmUtZGVmaW5lXG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgbWVudSBpdGVtcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgRGlzY2xvc3VyZU1lbnVJdGVtfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudUl0ZW1UeXBlXCIsIFApO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgRGlzY2xvc3VyZU1lbnVUb2dnbGV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VG9nZ2xlVHlwZVwiLCBVKTtcbiAgICAvKipcbiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBtZW51IGl0ZW0gaW4gdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfY3VycmVudENoaWxkXCIsIC0xKTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIikgdG8gdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX29wdGlvbmFsU3VwcG9ydFwiLCAhMSk7XG4gICAgdGhpcy5fb3B0aW9uYWxTdXBwb3J0ID0gVCwgTyAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIG1lbnUuXG4gICAqXG4gICAqIEluaXRpYWxpemUgd2lsbCBjYWxsIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2RcbiAgICogYXMgd2VsbCBhcyBzZXQgdXAgZm9jdXMsXG4gICAqIGNsaWNrLFxuICAgKiBob3ZlcixcbiAgICoga2V5ZG93biwgYW5kXG4gICAqIGtleXVwIGV2ZW50cyBmb3IgdGhlIG1lbnUuXG4gICAqXG4gICAqIElmIHRoZSBCYXNlTWVudSdzIGluaXRpYWxpemUgbWV0aG9kIHRocm93cyBhbiBlcnJvcixcbiAgICogdGhpcyB3aWxsIGNhdGNoIGl0IGFuZCBsb2cgaXQgdG8gdGhlIGNvbnNvbGUuXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHRyeSB7XG4gICAgICBzdXBlci5pbml0aWFsaXplKCksIHRoaXMuX2hhbmRsZUZvY3VzKCksIHRoaXMuX2hhbmRsZUNsaWNrKCksIHRoaXMuX2hhbmRsZUhvdmVyKCksIHRoaXMuX2hhbmRsZUtleWRvd24oKSwgdGhpcy5faGFuZGxlS2V5dXAoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQSBmbGFnIHRvIGFkZCBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0IChBcnJvdyBrZXlzLCBcIkhvbWVcIiwgYW5kIFwiRW5kXCIpIHRvIHRoZSBtZW51LlxuICAgKlxuICAgKiBUaGlzIGZ1bmN0aW9ucyBkaWZmZXJlbnRseSBmb3Igcm9vdCB2cy4gc3VibWVudXMuXG4gICAqIFN1Ym1lbnVzIHdpbGwgYWx3YXlzIGluaGVyaXQgdGhlaXIgcm9vdCBtZW51J3Mgb3B0aW9uYWxLZXlTdXBwb3J0LlxuICAgKlxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICpcbiAgICogQHNlZSBfb3B0aW9uYWxTdXBwb3J0XG4gICAqL1xuICBnZXQgb3B0aW9uYWxLZXlTdXBwb3J0KCkge1xuICAgIHJldHVybiB0aGlzLmlzVG9wTGV2ZWwgPyB0aGlzLl9vcHRpb25hbFN1cHBvcnQgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51Lm9wdGlvbmFsS2V5U3VwcG9ydDtcbiAgfVxuICBzZXQgb3B0aW9uYWxLZXlTdXBwb3J0KGUpIHtcbiAgICBwKFwiYm9vbGVhblwiLCB7IG9wdGlvbmFsS2V5U3VwcG9ydDogZSB9KSwgdGhpcy5fb3B0aW9uYWxTdXBwb3J0ID0gZTtcbiAgfVxuICAvKipcbiAgICogVmFsaWRhdGVzIGFsbCBhc3BlY3RzIG9mIHRoZSBtZW51IHRvIGVuc3VyZSBwcm9wZXIgZnVuY3Rpb25hbGl0eS5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKlxuICAgKiBAcmV0dXJuIHtib29sZWFufSAtIFRoZSByZXN1bHQgb2YgdGhlIHZhbGlkYXRpb24uXG4gICAqL1xuICBfdmFsaWRhdGUoKSB7XG4gICAgbGV0IGUgPSBzdXBlci5fdmFsaWRhdGUoKTtcbiAgICBjb25zdCBzID0gcChcImJvb2xlYW5cIiwge1xuICAgICAgb3B0aW9uYWxLZXlTdXBwb3J0OiB0aGlzLl9vcHRpb25hbFN1cHBvcnRcbiAgICB9KTtcbiAgICByZXR1cm4gcy5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKHMuZXJyb3IubWVzc2FnZSksIGUgPSAhMSksIGU7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2sgZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciB1c2UuXG4gICAqXG4gICAqIC0gQWRkcyBhbGwgZXZlbnQgbGlzdGVuZXJzIGxpc3RlZCBpblxuICAgKiAgIEJhc2VNZW51J3MgX2hhbmRsZUNsaWNrIG1ldGhvZC5cbiAgICogLSBBZGRzIGEgYHBvaW50ZXJ1cGAgbGlzdGVuZXIgdG8gdGhlIGBkb2N1bWVudGAgc28gaWYgdGhlIHVzZXJcbiAgICogICBjbGlja3Mgb3V0c2lkZSBvZiB0aGUgbWVudSBpdCB3aWxsIGNsb3NlIGlmIGl0IGlzIG9wZW4uXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVDbGljaygpIHtcbiAgICBzdXBlci5faGFuZGxlQ2xpY2soKSwgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIiAmJiAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsICF0aGlzLmRvbS5tZW51LmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhdGhpcy5kb20ubWVudSAhPT0gZS50YXJnZXQgJiYgKHRoaXMuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmJsdXIoKSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5jbG9zZSgpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51Lmhhc09wZW5lZCA9ICExKSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5ZG93biBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHRoZSBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKiAtIEFkZHMgYWxsIGBrZXlkb3duYCBsaXN0ZW5lcnMgZnJvbSBCYXNlTWVudSdzIF9oYW5kbGVLZXlkb3duIG1ldGhvZFxuICAgKiAtIEFkZHMgYSBga2V5ZG93bmAgbGlzdGVuZXIgdG8gdGhlIG1lbnUvYWxsIHN1Ym1lbnVzLlxuICAgKiAgIC0gQmxvY2tzIHByb3BhZ2F0aW9uIG9uIHRoZSBmb2xsb3dpbmcga2V5czogXCJTcGFjZVwiLCBcIkVudGVyXCIsIGFuZCBcIkVzY2FwZVwiLlxuICAgKiAgIC0gX0lmXyBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0XG4gICAqICAgICBpcyBlbmFibGVkLCBibG9ja3MgcHJvcGFnYXRpb24gb24gdGhlIGZvbGxvd2luZyBrZXlzOlxuICAgKiAgICAgXCJBcnJvd1VwXCIsIFwiQXJyb3dSaWdodFwiLCBcIkFycm93RG93blwiLCBcIkFycm93TGVmdFwiLCBcIkhvbWVcIiwgYW5kIFwiRW5kXCIuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXlkb3duKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXlkb3duKCksIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IGcoZSk7XG4gICAgICBpZiAodGhpcy5mb2N1c1N0YXRlID09PSBcInNlbGZcIikge1xuICAgICAgICBjb25zdCBuID0gW1wiU3BhY2VcIiwgXCJFbnRlclwiXSwgaSA9IFtcIkVzY2FwZVwiXSwgbyA9IFtcIkVzY2FwZVwiXTtcbiAgICAgICAgdGhpcy5vcHRpb25hbEtleVN1cHBvcnQgPyBbXG4gICAgICAgICAgXCJBcnJvd1VwXCIsXG4gICAgICAgICAgXCJBcnJvd1JpZ2h0XCIsXG4gICAgICAgICAgXCJBcnJvd0Rvd25cIixcbiAgICAgICAgICBcIkFycm93TGVmdFwiLFxuICAgICAgICAgIFwiSG9tZVwiLFxuICAgICAgICAgIFwiRW5kXCJcbiAgICAgICAgXS5pbmNsdWRlcyhzKSAmJiBsKGUpIDogKHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgbi5pbmNsdWRlcyhzKSB8fCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgaS5pbmNsdWRlcyhzKSB8fCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgby5pbmNsdWRlcyhzKSkgJiYgbChlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXl1cCBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBBZGRzIGFsbCBga2V5dXBgIGxpc3RlbmVycyBmcm9tIEJhc2VNZW51J3MgX2hhbmRsZUtleXVwIG1ldGhvZC5cbiAgICpcbiAgICogQWRkcyB0aGUgZm9sbG93aW5nIGtleWJpbmRpbmdzIChleHBsYW5hdGlvbnMgYXJlIHRha2VuIGZyb20gdGhlXG4gICAqIFdBSSBBUklBIFByYWNpdGljZXMgRXhhbXBsZSBEaXNjbG9zdXJlIGZvciBOYXZpZ2F0aW9uIE1lbnVzKTpcbiAgICpcbiAgICogfCBLZXkgfCBGdW5jdGlvbiB8XG4gICAqIHwgLS0tIHwgLS0tIHxcbiAgICogfCBfVGFiXyBvciBfU2hpZnQgKyBUYWJfIHwgTW92ZSBrZXlib2FyZCBmb2N1cyBhbW9uZyB0b3AtbGV2ZWwgYnV0dG9ucywgYW5kIGlmIGEgZHJvcGRvd24gaXMgb3BlbiwgaW50byBhbmQgdGhyb3VnaCBsaW5rcyBpbiB0aGUgZHJvcGRvd24uIHxcbiAgICogfCBfU3BhY2VfIG9yIF9FbnRlcl8gfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgZGlzY2xvc3VyZSBidXR0b24sIGFjdGl2YXRlcyB0aGUgYnV0dG9uLCB3aGljaCB0b2dnbGVzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBkcm9wZG93bi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbms6PHVsPjxsaT5JZiBhbnkgbGluayBoYXMgYXJpYS1jdXJyZW50IHNldCwgcmVtb3ZlcyBpdC48L2xpPjxsaT5TZXRzIGFyaWEtY3VycmVudD1cInBhZ2VcIiBvbiB0aGUgZm9jdXNlZCBsaW5rLjwvbGk+PGxpPkFjdGl2YXRlcyB0aGUgZm9jdXNlZCBsaW5rLjwvbGk+PC91bD48L2xpPjwvdWw+IHxcbiAgICogfCBfRXNjYXBlXyB8IElmIGEgZHJvcGRvd24gaXMgb3BlbiwgY2xvc2VzIGl0IGFuZCBzZXRzIGZvY3VzIG9uIHRoZSBidXR0b24gdGhhdCBjb250cm9scyB0aGF0IGRyb3Bkb3duLiB8XG4gICAqIHwgX0Rvd24gQXJyb3dfIG9yIF9SaWdodCBBcnJvd18gKE9wdGlvbmFsfSkgfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgYnV0dG9uIGFuZCBpdHMgZHJvcGRvd24gaXMgY29sbGFwc2VkLCBhbmQgaXQgaXMgbm90IHRoZSBsYXN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgYnV0dG9uLjwvbGk+PGxpPmlmIGZvY3VzIGlzIG9uIGEgYnV0dG9uIGFuZCBpdHMgZHJvcGRvd24gaXMgZXhwYW5kZWQsIG1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBsaW5rIGluIHRoZSBkcm9wZG93bi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGxhc3QgbGluaywgbW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgbGluay48L2xpPjwvdWw+IHxcbiAgICogfCBfVXAgQXJyb3dfIG9yIF9MZWZ0IEFycm93XyAoT3B0aW9uYWx9KSB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBidXR0b24sIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIHByZXZpb3VzIGJ1dHRvbi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGxpbmssIG1vdmVzIGZvY3VzIHRvIHRoZSBwcmV2aW91cyBsaW5rLjwvbGk+PC91bD4gfFxuICAgKiB8IF9Ib21lXyAoT3B0aW9uYWwpIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGJ1dHRvbiwgYW5kIGl0IGlzIG5vdCB0aGUgZmlyc3QgYnV0dG9uLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgYnV0dG9uLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGEgbGluaywgYW5kIGl0IGlzIG5vdCB0aGUgZmlyc3QgbGluaywgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGxpbmsuPC9saT48L3VsPiB8XG4gICAqIHwgX0VuZF8gKE9wdGlvbmFsKSB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBidXR0b24sIGFuZCBpdCBpcyBub3QgdGhlIGxhc3QgYnV0dG9uLCBtb3ZlcyBmb2N1cyB0byB0aGUgbGFzdCBidXR0b24uPC9saT48bGk+SWYgZm9jdXMgaXMgb24gYSBsaW5rLCBhbmQgaXQgaXMgbm90IHRoZSBsYXN0IGxpbmssIG1vdmVzIGZvY3VzIHRvIHRoZSBsYXN0IGxpbmsuPC9saT48L3VsPiB8XG4gICAqXG4gICAqIFRoZSBvcHRpb25hbCBrZXliaW5kaW5ncyBhcmUgY29udHJvbGxlZCBieSB0aGUgbWVudSdzIG9wdGlvbmFsS2V5U3VwcG9ydCB2YWx1ZS5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleXVwKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXl1cCgpLCB0aGlzLmRvbS5tZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBzID0gZyhlKTtcbiAgICAgIHRoaXMuZm9jdXNTdGF0ZSA9PT0gXCJzZWxmXCIgJiYgKHMgPT09IFwiU3BhY2VcIiB8fCBzID09PSBcIkVudGVyXCIgPyB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtID8gKGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSA6IHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpIDogdGhpcy5jdXJyZW50TWVudUl0ZW0uZG9tLmxpbmsuY2xpY2soKSA6IHMgPT09IFwiRXNjYXBlXCIgPyB0aGlzLmVsZW1lbnRzLnN1Ym1lbnVUb2dnbGVzLnNvbWUoXG4gICAgICAgIChpKSA9PiBpLmlzT3BlblxuICAgICAgKSA/IChsKGUpLCB0aGlzLmNsb3NlQ2hpbGRyZW4oKSkgOiB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgPyAobChlKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNDdXJyZW50Q2hpbGQoKSkgOiB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5pc09wZW4gJiYgKHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5jbG9zZSgpLCB0aGlzLmZvY3VzQ29udHJvbGxlcigpKSA6IHRoaXMub3B0aW9uYWxLZXlTdXBwb3J0ICYmIChzID09PSBcIkFycm93RG93blwiIHx8IHMgPT09IFwiQXJyb3dSaWdodFwiID8gKGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbiA/ICh0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNGaXJzdENoaWxkKCkpIDogdGhpcy5mb2N1c05leHRDaGlsZCgpKSA6IHMgPT09IFwiQXJyb3dVcFwiIHx8IHMgPT09IFwiQXJyb3dMZWZ0XCIgPyAobChlKSwgdGhpcy5mb2N1c1ByZXZpb3VzQ2hpbGQoKSkgOiBzID09PSBcIkhvbWVcIiA/IChsKGUpLCB0aGlzLmZvY3VzRmlyc3RDaGlsZCgpKSA6IHMgPT09IFwiRW5kXCIgJiYgKGwoZSksIHRoaXMuZm9jdXNMYXN0Q2hpbGQoKSkpKTtcbiAgICB9KTtcbiAgfVxufVxuY2xhc3MgVyBleHRlbmRzIEwge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgTWVudWJhckl0ZW1gLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgaXRlbS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgb3B0aW9ucy5tZW51SXRlbUVsZW1lbnQgICAgICAgICAtIFRoZSBtZW51IGl0ZW0gaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgb3B0aW9ucy5tZW51TGlua0VsZW1lbnQgICAgICAgICAtIFRoZSBtZW51IGl0ZW0ncyBsaW5rIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7TWVudWJhcn0gICAgICAgIG9wdGlvbnMucGFyZW50TWVudSAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgIFtvcHRpb25zLmlzU3VibWVudUl0ZW0gPSBmYWxzZV0gLSBBIGZsYWcgdG8gbWFyayBpZiB0aGUgbWVudSBpdGVtIGlzIGNvbnRyb2xsaW5nIGEgc3VibWVudS5cbiAgICogQHBhcmFtIHs/TWVudWJhcn0gICAgICAgW29wdGlvbnMuY2hpbGRNZW51ID0gbnVsbF0gICAgICAtIFRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0gez9NZW51YmFyVG9nZ2xlfSBbb3B0aW9ucy50b2dnbGUgPSBudWxsXSAgICAgICAgIC0gVGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgaXRlbSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVJdGVtRWxlbWVudDogdCxcbiAgICBtZW51TGlua0VsZW1lbnQ6IGUsXG4gICAgcGFyZW50TWVudTogcyxcbiAgICBpc1N1Ym1lbnVJdGVtOiBuID0gITEsXG4gICAgY2hpbGRNZW51OiBpID0gbnVsbCxcbiAgICB0b2dnbGU6IG8gPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGggPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudUl0ZW1FbGVtZW50OiB0LFxuICAgICAgbWVudUxpbmtFbGVtZW50OiBlLFxuICAgICAgcGFyZW50TWVudTogcyxcbiAgICAgIGlzU3VibWVudUl0ZW06IG4sXG4gICAgICBjaGlsZE1lbnU6IGksXG4gICAgICB0b2dnbGU6IG9cbiAgICB9KSwgaCAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB0aGUgbWVudSBpdGVtLlxuICAgKlxuICAgKiBJbml0aWFsaXplIHdpbGwgY2FsbCB0aGUgQmFzZU1lbnVJdGVtJ3MgaW5pdGlhbGl6ZSBtZXRob2RcbiAgICogYXMgd2VsbCBhcyBzZXQgdGhlIG1lbnUgaXRlbSdzIGByb2xlYCB0byBcIm5vbmVcIixcbiAgICogdGhlIG1lbnUgbGluaydzIGByb2xlYCB0byBcIm1lbnVpdGVtXCIsIGFuZFxuICAgKiB0aGUgbWVudSBsaW5rJ3MgYHRhYkluZGV4YCB0byAtMSBpbiB0aGUgRE9NLlxuICAgKi9cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICBzdXBlci5pbml0aWFsaXplKCksIHRoaXMuZG9tLml0ZW0uc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcIm5vbmVcIiksIHRoaXMuZG9tLmxpbmsuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcIm1lbnVpdGVtXCIpLCB0aGlzLmRvbS5saW5rLnRhYkluZGV4ID0gLTE7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzZXMgdGhlIG1lbnUgaXRlbSdzIGxpbmsgaWYgdGhlIHBhcmVudCBtZW51J3NcbiAgICogc2hvdWxkRm9jdXMgdmFsdWUgaXMgYHRydWVgLlxuICAgKlxuICAgKiBUaGlzIHdpbGwgY2FsbCB0aGUgQmFzZU1lbnVJdGVtJ3MgZm9jdXMgbWV0aG9kXG4gICAqIGFzIHdlbGwgYXMgc2V0IHRoZSBtZW51IGxpbmsncyBgdGFiSW5kZXhgIHRvIDAgaWYgdGhlIHBhcmVudCBtZW51XG4gICAqIGlzIHRoZSByb290IG1lbnUuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzKCkge1xuICAgIHN1cGVyLmZvY3VzKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5pc1RvcExldmVsICYmICh0aGlzLmRvbS5saW5rLnRhYkluZGV4ID0gMCk7XG4gIH1cbiAgLyoqXG4gICAqIEJsdXJzIHRoZSBtZW51IGl0ZW0ncyBsaW5rIGlmIHRoZSBwYXJlbnQgbWVudSdzXG4gICAqIHNob3VsZEZvY3VzIHZhbHVlIGlzIGB0cnVlYC5cbiAgICpcbiAgICogVGhpcyB3aWxsIGNhbGwgdGhlIEJhc2VNZW51SXRlbSdzIGJsdXIgbWV0aG9kXG4gICAqIGFzIHdlbGwgYXMgc2V0IHRoZSBtZW51IGxpbmsncyBgdGFiSW5kZXhgIHRvIC0xIGlmIHRoZSBwYXJlbnQgbWVudVxuICAgKiBpcyB0aGUgcm9vdCBtZW51LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBibHVyKCkge1xuICAgIHN1cGVyLmJsdXIoKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmlzVG9wTGV2ZWwgJiYgKHRoaXMuZG9tLmxpbmsudGFiSW5kZXggPSAtMSk7XG4gIH1cbn1cbmNsYXNzIFogZXh0ZW5kcyBBIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYE1lbnViYXJUb2dnbGVgLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudSB0b2dnbGUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG9wdGlvbnMubWVudVRvZ2dsZUVsZW1lbnQgICAtIFRoZSB0b2dnbGUgZWxlbWVudCBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBvcHRpb25zLnBhcmVudEVsZW1lbnQgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBjb250cm9sbGVkIG1lbnUuXG4gICAqIEBwYXJhbSB7TWVudWJhcn0gICAgIG9wdGlvbnMuY29udHJvbGxlZE1lbnUgICAgICAtIFRoZSBtZW51IGNvbnRyb2xsZWQgYnkgdGhpcyB0b2dnbGUuXG4gICAqIEBwYXJhbSB7P01lbnViYXJ9ICAgIFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAtIFRoZSBtZW51IGNvbnRhaW5pbmcgdGhpcyB0b2dnbGUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgIFtvcHRpb25zLmluaXRpYWxpemUgPSB0cnVlXSAtIEEgZmxhZyB0byBpbml0aWFsaXplIHRoZSBtZW51IHRvZ2dsZSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVUb2dnbGVFbGVtZW50OiB0LFxuICAgIHBhcmVudEVsZW1lbnQ6IGUsXG4gICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgcGFyZW50TWVudTogbiA9IG51bGwsXG4gICAgaW5pdGlhbGl6ZTogaSA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51VG9nZ2xlRWxlbWVudDogdCxcbiAgICAgIHBhcmVudEVsZW1lbnQ6IGUsXG4gICAgICBjb250cm9sbGVkTWVudTogcyxcbiAgICAgIHBhcmVudE1lbnU6IG5cbiAgICB9KSwgaSAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgQVJJQSBhdHRyaWJ1dGVzIG9uIHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlIEJhc2VNZW51VG9nZ2xlJ3MgX3NldEFyaWFBdHRyaWJ1dGVzIG1ldGhvZC5cbiAgICpcbiAgICogVGhlbiBzZXRzIHRoZSB0b2dnbGUncyBgYXJpYS1oYXNwb3B1cGAgYXR0cmlidXRlIHRvIFwidHJ1ZVwiLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfc2V0QXJpYUF0dHJpYnV0ZXMoKSB7XG4gICAgc3VwZXIuX3NldEFyaWFBdHRyaWJ1dGVzKCksIHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhhc3BvcHVwXCIsIFwidHJ1ZVwiKTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZVNpYmxpbmdzIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3Mgb3BlbiBtZXRob2QuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5jbG9zZVNpYmxpbmdzKCksIHN1cGVyLm9wZW4oKTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudSB3aXRob3V0IHRoZSBjdXJyZW50IGZvY3VzIGVudGVyaW5nIGl0LlxuICAgKlxuICAgKiBDYWxscyB0aGUgIGNsb3NlU2libGluZ3MgbWV0aG9kXG4gICAqIGFuZCBfdGhlbl8gQmFzZU1lbnVUb2dnbGUncyBwcmV2aWV3IG1ldGhvZC5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgcHJldmlldygpIHtcbiAgICB0aGlzLmNsb3NlU2libGluZ3MoKSwgc3VwZXIucHJldmlldygpO1xuICB9XG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZUNoaWxkcmVuIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3MgY2xvc2UgbWV0aG9kLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBjbG9zZSgpIHtcbiAgICB0aGlzLmlzT3BlbiAmJiAodGhpcy5jbG9zZUNoaWxkcmVuKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudSAmJiB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNDdXJyZW50Q2hpbGQoKSksIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cbmNsYXNzIEYgZXh0ZW5kcyBJIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYE1lbnViYXJgLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICBvcHRpb25zLm1lbnVFbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgbWVudSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5tZW51SXRlbVNlbGVjdG9yID0gbGldICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGl0ZW1zLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMubWVudUxpbmtTZWxlY3RvciA9IGFdICAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBsaW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVJdGVtU2VsZWN0b3IgPSBsaTpoYXModWwpXSAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMgY29udGFpbmluZyBzdWJtZW51cy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVUb2dnbGVTZWxlY3RvciA9IGFdICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnUgdG9nZ2xlIGJ1dHRvbnMvbGlua3MuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51U2VsZWN0b3IgPSB1bF0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51cy5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgIFtvcHRpb25zLmNvbnRyb2xsZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRyb2xsaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7P0hUTUxFbGVtZW50fSAgICAgICBbb3B0aW9ucy5jb250YWluZXJFbGVtZW50ID0gbnVsbF0gICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250YWluaW5nIHRoZSBtZW51IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy5vcGVuQ2xhc3MgPSBzaG93XSAgICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJvcGVuXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSBbb3B0aW9ucy5jbG9zZUNsYXNzID0gaGlkZV0gICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJjbG9zZWRcIi5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLnRyYW5zaXRpb25DbGFzcyA9IHRyYW5zaXRpb25pbmddICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyB0cmFuc2l0aW9uaW5nIGJldHdlZW4gXCJvcGVuXCIgYW5kIFwiY2xvc2VkXCIgc3RhdGVzLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuaXNUb3BMZXZlbCA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIG1hcmsgdGhlIHJvb3QgbWVudS5cbiAgICogQHBhcmFtIHs/TWVudWJhcn0gICAgICAgICAgIFtvcHRpb25zLnBhcmVudE1lbnUgPSBudWxsXSAgICAgICAgICAgICAgICAtIFRoZSBwYXJlbnQgbWVudSB0byB0aGlzIG1lbnUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5ob3ZlclR5cGUgPSBvZmZdICAgICAgICAgICAgICAgICAgLSBUaGUgdHlwZSBvZiBob3ZlcmFiaWxpdHkgYSBtZW51IGhhcy5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyRGVsYXkgPSAyNTBdICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhbmQgY2xvc2luZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmVudGVyRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhIG1lbnUgaWYgdGhlIG1lbnUgaXMgZm9jdXNhYmxlIChpbiBtaWxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSAgICAgICAgICAgICBbb3B0aW9ucy5sZWF2ZURlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIGNsb3NpbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgW29wdGlvbnMuaW5pdGlhbGl6ZSA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIGluaXRpYWxpemUgdGhlIG1lbnUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51RWxlbWVudDogZSxcbiAgICBtZW51SXRlbVNlbGVjdG9yOiBzID0gXCJsaVwiLFxuICAgIG1lbnVMaW5rU2VsZWN0b3I6IG4gPSBcImFcIixcbiAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiBpID0gXCJsaTpoYXModWwpXCIsXG4gICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiBvID0gXCJhXCIsXG4gICAgc3VibWVudVNlbGVjdG9yOiBoID0gXCJ1bFwiLFxuICAgIGNvbnRyb2xsZXJFbGVtZW50OiBtID0gbnVsbCxcbiAgICBjb250YWluZXJFbGVtZW50OiBjID0gbnVsbCxcbiAgICBvcGVuQ2xhc3M6IGEgPSBcInNob3dcIixcbiAgICBjbG9zZUNsYXNzOiBkID0gXCJoaWRlXCIsXG4gICAgdHJhbnNpdGlvbkNsYXNzOiBmID0gXCJ0cmFuc2l0aW9uaW5nXCIsXG4gICAgaXNUb3BMZXZlbDogeSA9ICEwLFxuICAgIHBhcmVudE1lbnU6IE0gPSBudWxsLFxuICAgIGhvdmVyVHlwZTogYiA9IFwib2ZmXCIsXG4gICAgaG92ZXJEZWxheTogXyA9IDI1MCxcbiAgICBlbnRlckRlbGF5OiBDID0gLTEsXG4gICAgbGVhdmVEZWxheTogRSA9IC0xLFxuICAgIGluaXRpYWxpemU6IFQgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudUVsZW1lbnQ6IGUsXG4gICAgICBtZW51SXRlbVNlbGVjdG9yOiBzLFxuICAgICAgbWVudUxpbmtTZWxlY3RvcjogbixcbiAgICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGksXG4gICAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IG8sXG4gICAgICBzdWJtZW51U2VsZWN0b3I6IGgsXG4gICAgICBjb250cm9sbGVyRWxlbWVudDogbSxcbiAgICAgIGNvbnRhaW5lckVsZW1lbnQ6IGMsXG4gICAgICBvcGVuQ2xhc3M6IGEsXG4gICAgICBjbG9zZUNsYXNzOiBkLFxuICAgICAgdHJhbnNpdGlvbkNsYXNzOiBmLFxuICAgICAgaXNUb3BMZXZlbDogeSxcbiAgICAgIHBhcmVudE1lbnU6IE0sXG4gICAgICBob3ZlclR5cGU6IGIsXG4gICAgICBob3ZlckRlbGF5OiBfLFxuICAgICAgZW50ZXJEZWxheTogQyxcbiAgICAgIGxlYXZlRGVsYXk6IEVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBzdWJtZW51cy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgTWVudWJhcn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVUeXBlXCIsIEYpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdXNlLWJlZm9yZS1kZWZpbmVcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBtZW51IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBNZW51YmFySXRlbX1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVJdGVtVHlwZVwiLCBXKTtcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBzdWJtZW51IHRvZ2dsZXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7dHlwZW9mIE1lbnViYXJUb2dnbGV9XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51VG9nZ2xlVHlwZVwiLCBaKTtcbiAgICBUICYmIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICB9XG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgbWVudS5cbiAgICpcbiAgICogSW5pdGlhbGl6ZSB3aWxsIGNhbGwgdGhlIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2RcbiAgICogYXMgd2VsbCBhcyBzZXQgdXAgZm9jdXMsXG4gICAqIGNsaWNrLFxuICAgKiBob3ZlcixcbiAgICoga2V5ZG93biwgYW5kXG4gICAqIGtleXVwIGV2ZW50cyBmb3IgdGhlIG1lbnUuXG4gICAqXG4gICAqIFRoaXMgd2lsbCBhbHNvIHNldCB0aGUgbWVudSdzIGByb2xlYCB0byBcIm1lbnViYXJcIiBpbiB0aGUgRE9NLlxuICAgKlxuICAgKiBJZiB0aGUgbWVudSBpcyBhIHJvb3QgbWVudSB0aGUgZmlyc3QgbWVudSBpdGVtJ3MgYHRhYkluZGV4YCB3aWxsIGJlIHNldCB0b1xuICAgKiAwIGluIHRoZSBET00uXG4gICAqXG4gICAqIElmIHRoZSBCYXNlTWVudSdzIGluaXRpYWxpemUgbWV0aG9kIHRocm93cyBhbiBlcnJvcixcbiAgICogdGhpcyB3aWxsIGNhdGNoIGl0IGFuZCBsb2cgaXQgdG8gdGhlIGNvbnNvbGUuXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHRyeSB7XG4gICAgICBzdXBlci5pbml0aWFsaXplKCksIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuZG9tLm1lbnUuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcIm1lbnViYXJcIikgOiB0aGlzLmRvbS5tZW51LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJtZW51XCIpLCB0aGlzLl9oYW5kbGVGb2N1cygpLCB0aGlzLl9oYW5kbGVDbGljaygpLCB0aGlzLl9oYW5kbGVIb3ZlcigpLCB0aGlzLl9oYW5kbGVLZXlkb3duKCksIHRoaXMuX2hhbmRsZUtleXVwKCksIHRoaXMuaXNUb3BMZXZlbCAmJiAodGhpcy5lbGVtZW50cy5tZW51SXRlbXNbMF0uZG9tLmxpbmsudGFiSW5kZXggPSAwLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmRvbS50b2dnbGUucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1oYXNwb3B1cFwiKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2xpY2sgZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciB1c2UuXG4gICAqXG4gICAqIC0gQWRkcyBhbGwgZXZlbnQgbGlzdGVuZXJzIGxpc3RlZCBpblxuICAgKiAgIEJhc2VNZW51J3MgX2hhbmRsZUNsaWNrIG1ldGhvZC5cbiAgICogLSBBZGRzIGEgYHBvaW50ZXJ1cGAgbGlzdGVuZXIgdG8gdGhlIGBkb2N1bWVudGAgc28gaWYgdGhlIHVzZXJcbiAgICogICBjbGlja3Mgb3V0c2lkZSBvZiB0aGUgbWVudSBpdCB3aWxsIGNsb3NlIGlmIGl0IGlzIG9wZW4uXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVDbGljaygpIHtcbiAgICBzdXBlci5faGFuZGxlQ2xpY2soKSwgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIiAmJiAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsICF0aGlzLmRvbS5tZW51LmNvbnRhaW5zKGUudGFyZ2V0KSAmJiAhdGhpcy5kb20ubWVudSAhPT0gZS50YXJnZXQgJiYgKHRoaXMuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmJsdXIoKSwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlci5jbG9zZSgpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51Lmhhc09wZW5lZCA9ICExKSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5ZG93biBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHRoZSBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKiAtIEFkZHMgYWxsIGBrZXlkb3duYCBsaXN0ZW5lcnMgZnJvbSBCYXNlTWVudSdzIF9oYW5kbGVLZXlkb3duIG1ldGhvZFxuICAgKiAtIEFkZHMgYSBga2V5ZG93bmAgbGlzdGVuZXIgdG8gdGhlIG1lbnUvYWxsIHN1Ym1lbnVzLlxuICAgKiAgIC0gQmxvY2tzIHByb3BhZ2F0aW9uIG9uIHRoZSBmb2xsb3dpbmcga2V5czogXCJBcnJvd1VwXCIsIFwiQXJyb3dSaWdodFwiLFxuICAgKiAgICAgXCJBcnJvd0Rvd25cIiwgXCJBcnJvd0xlZnRcIiwgXCJIb21lXCIsIFwiRW5kXCIsIFwiU3BhY2VcIiwgXCJFbnRlclwiLCBcIkVzY2FwZVwiLFxuICAgKiAgICAgYW5kIFwiQVwiIHRocm91Z2ggXCJaXCIuXG4gICAqICAgLSBDb21wbGV0ZWx5IGNsb3NlcyB0aGUgbWVudSBhbmQgbW92ZXMgZm9jdXMgb3V0IGlmIHRoZSBcIlRhYlwiIGtleSBpcyBwcmVzc2VkLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlS2V5ZG93bigpIHtcbiAgICBzdXBlci5faGFuZGxlS2V5ZG93bigpLCB0aGlzLmRvbS5tZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIjtcbiAgICAgIGNvbnN0IHMgPSBnKGUpO1xuICAgICAgaWYgKHMgPT09IFwiVGFiXCIgJiYgKHRoaXMuZWxlbWVudHMucm9vdE1lbnUuZm9jdXNTdGF0ZSAhPT0gXCJub25lXCIgPyAodGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY2xvc2VDaGlsZHJlbigpKSA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUuZm9jdXMoKSksIHMgPT09IFwiQ2hhcmFjdGVyXCIpXG4gICAgICAgIGwoZSk7XG4gICAgICBlbHNlIGlmICh0aGlzLmlzVG9wTGV2ZWwpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNTdGF0ZSA9PT0gXCJzZWxmXCIpIHtcbiAgICAgICAgICBjb25zdCBuID0gW1wiQXJyb3dSaWdodFwiLCBcIkFycm93TGVmdFwiLCBcIkhvbWVcIiwgXCJFbmRcIl0sIGkgPSBbXCJTcGFjZVwiLCBcIkVudGVyXCIsIFwiQXJyb3dEb3duXCIsIFwiQXJyb3dVcFwiXSwgbyA9IFtcIkVzY2FwZVwiXTtcbiAgICAgICAgICAobi5pbmNsdWRlcyhzKSB8fCB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIGkuaW5jbHVkZXMocykgfHwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIG8uaW5jbHVkZXMocykpICYmIGwoZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXG4gICAgICAgICAgXCJFc2NhcGVcIixcbiAgICAgICAgICBcIkFycm93UmlnaHRcIixcbiAgICAgICAgICBcIkFycm93TGVmdFwiLFxuICAgICAgICAgIFwiQXJyb3dEb3duXCIsXG4gICAgICAgICAgXCJBcnJvd1VwXCIsXG4gICAgICAgICAgXCJIb21lXCIsXG4gICAgICAgICAgXCJFbmRcIlxuICAgICAgICBdLCBpID0gW1wiU3BhY2VcIiwgXCJFbnRlclwiXTtcbiAgICAgICAgKG4uaW5jbHVkZXMocykgfHwgdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiBpLmluY2x1ZGVzKHMpKSAmJiBsKGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGtleXVwIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIEFkZHMgYWxsIGBrZXl1cGAgbGlzdGVuZXJzIGZyb20gQmFzZU1lbnUncyBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKlxuICAgKiBBZGRzIHRoZSBmb2xsb3dpbmcga2V5YmluZGluZ3MgKGV4cGxhbmF0aW9ucyBhcmUgdGFrZW4gZnJvbSB0aGVcbiAgICogTmF2aWdhdGlvbiBNZW51YmFyIEV4YW1wbGUpOlxuICAgKlxuICAgKiA8c3Ryb25nPk1lbnViYXI8L3N0cm9uZz5cbiAgICpcbiAgICogfCBLZXkgfCBGdW5jdGlvbiB8XG4gICAqIHwgLS0tIHwgLS0tIHxcbiAgICogfCBfU3BhY2VfIG9yIF9FbnRlcl8gfCBPcGVucyBzdWJtZW51IGFuZCBtb3ZlcyBmb2N1cyB0byBmaXJzdCBpdGVtIGluIHRoZSBzdWJtZW51LiB8XG4gICAqIHwgX1JpZ2h0IEFycm93XyB8IDx1bD48bGk+TW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgaXRlbSBpbiB0aGUgbWVudWJhci48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiB0aGUgbGFzdCBpdGVtLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgaXRlbS48L2xpPjwvdWw+IHxcbiAgICogfCBfTGVmdCBBcnJvd18gfCA8dWw+PGxpPk1vdmVzIGZvY3VzIHRvIHRoZSBwcmV2aW91cyBpdGVtIGluIHRoZSBtZW51YmFyLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIHRoZSBmaXJzdCBpdGVtLCBtb3ZlcyBmb2N1cyB0byB0aGUgbGFzdCBpdGVtLjwvbGk+PC91bD4gfFxuICAgKiB8IF9Eb3duIEFycm93XyB8IE9wZW5zIHN1Ym1lbnUgYW5kIG1vdmVzIGZvY3VzIHRvIGZpcnN0IGl0ZW0gaW4gdGhlIHN1Ym1lbnUuIHxcbiAgICogfCBfVXAgQXJyb3dfIHwgT3BlbnMgc3VibWVudSBhbmQgbW92ZXMgZm9jdXMgdG8gbGFzdCBpdGVtIGluIHRoZSBzdWJtZW51LiB8XG4gICAqIHwgX0hvbWVfIHwgTW92ZXMgZm9jdXMgdG8gZmlyc3QgaXRlbSBpbiB0aGUgbWVudWJhci4gfFxuICAgKiB8IF9FbmRfIHwgTW92ZXMgZm9jdXMgdG8gbGFzdCBpdGVtIGluIHRoZSBtZW51YmFyLiB8XG4gICAqIHwgX0NoYXJhY3Rlcl8gfCA8dWw+PGxpPk1vdmVzIGZvY3VzIHRvIG5leHQgaXRlbSBpbiB0aGUgbWVudWJhciBoYXZpbmcgYSBuYW1lIHRoYXQgc3RhcnRzIHdpdGggdGhlIHR5cGVkIGNoYXJhY3Rlci48L2xpPjxsaT5JZiBub25lIG9mIHRoZSBpdGVtcyBoYXZlIGEgbmFtZSBzdGFydGluZyB3aXRoIHRoZSB0eXBlZCBjaGFyYWN0ZXIsIGZvY3VzIGRvZXMgbm90IG1vdmUuPC9saT48L3VsPiB8XG4gICAqXG4gICAqIDxzdHJvbmc+U3VibWVudTwvc3Ryb25nPlxuICAgKlxuICAgKiB8IEtleSB8IEZ1bmN0aW9uIHxcbiAgICogfCAtLS0gfCAtLS0gfFxuICAgKiB8IF9TcGFjZV8gb3IgX0VudGVyXyB8IDx1bD48bGk+QWN0aXZhdGVzIG1lbnUgaXRlbSwgY2F1c2luZyB0aGUgbGluayB0byBiZSBhY3RpdmF0ZWQuPC9saT48bGk+Tk9URTogdGhlIGxpbmtzIGdvIHRvIGR1bW15IHBhZ2VzOyB1c2UgdGhlIGJyb3dzZXIgZ28tYmFjayBmdW5jdGlvbiB0byByZXR1cm4gdG8gdGhpcyBtZW51YmFyIGV4YW1wbGUgcGFnZS48L2xpPjwvdWw+IHxcbiAgICogfCBfRXNjYXBlXyB8IDx1bD48bGk+Q2xvc2VzIHN1Ym1lbnUuPC9saT48bGk+TW92ZXMgZm9jdXMgdG8gcGFyZW50IG1lbnViYXIgaXRlbS48L2xpPjwvdWw+IHxcbiAgICogfCBfUmlnaHQgQXJyb3dfIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhbiBpdGVtIHdpdGggYSBzdWJtZW51LCBvcGVucyB0aGUgc3VibWVudSBhbmQgcGxhY2VzIGZvY3VzIG9uIHRoZSBmaXJzdCBpdGVtLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIGFuIGl0ZW0gdGhhdCBkb2VzIG5vdCBoYXZlIGEgc3VibWVudTo8dWw+PGxpPkNsb3NlcyBzdWJtZW51LjwvbGk+PGxpPk1vdmVzIGZvY3VzIHRvIG5leHQgaXRlbSBpbiB0aGUgbWVudWJhci48L2xpPjxsaT5PcGVucyBzdWJtZW51IG9mIG5ld2x5IGZvY3VzZWQgbWVudWJhciBpdGVtLCBrZWVwaW5nIGZvY3VzIG9uIHRoYXQgcGFyZW50IG1lbnViYXIgaXRlbS48L2xpPjwvdWw+PC9saT48L3VsPiB8XG4gICAqIHwgX0xlZnQgQXJyb3dfIHwgPHVsPjxsaT5DbG9zZXMgc3VibWVudSBhbmQgbW92ZXMgZm9jdXMgdG8gcGFyZW50IG1lbnUgaXRlbS48L2xpPjxsaT5JZiBwYXJlbnQgbWVudSBpdGVtIGlzIGluIHRoZSBtZW51YmFyLCBhbHNvOjx1bD48bGk+bW92ZXMgZm9jdXMgdG8gcHJldmlvdXMgaXRlbSBpbiB0aGUgbWVudWJhci48L2xpPjxsaT5PcGVucyBzdWJtZW51IG9mIG5ld2x5IGZvY3VzZWQgbWVudWJhciBpdGVtLCBrZWVwaW5nIGZvY3VzIG9uIHRoYXQgcGFyZW50IG1lbnViYXIgaXRlbS48L2xpPjwvdWw+PC9saT48L3VsPiB8XG4gICAqIHwgX0Rvd24gQXJyb3dfIHwgPHVsPjxsaT5Nb3ZlcyBmb2N1cyB0byB0aGUgbmV4dCBpdGVtIGluIHRoZSBzdWJtZW51LjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIHRoZSBsYXN0IGl0ZW0sIG1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBpdGVtLjwvbGk+PC91bD4gfFxuICAgKiB8IF9VcCBBcnJvd18gfCA8dWw+PGxpPk1vdmVzIGZvY3VzIHRvIHByZXZpb3VzIGl0ZW0gaW4gdGhlIHN1Ym1lbnUuPC9saT48bGk+SWYgZm9jdXMgaXMgb24gdGhlIGZpcnN0IGl0ZW0sIG1vdmVzIGZvY3VzIHRvIHRoZSBsYXN0IGl0ZW0uPC9saT48L3VsPiB8XG4gICAqIHwgSG9tZSB8IE1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBpdGVtIGluIHRoZSBzdWJtZW51LiB8XG4gICAqIHwgRW5kIHwgTW92ZXMgZm9jdXMgdG8gdGhlIGxhc3QgaXRlbSBpbiB0aGUgc3VibWVudS4gfFxuICAgKiB8IF9DaGFyYWN0ZXJfIHwgPHVsPjxsaT5Nb3ZlcyBmb2N1cyB0byB0aGUgbmV4dCBpdGVtIGhhdmluZyBhIG5hbWUgdGhhdCBzdGFydHMgd2l0aCB0aGUgdHlwZWQgY2hhcmFjdGVyLjwvbGk+PGxpPklmIG5vbmUgb2YgdGhlIGl0ZW1zIGhhdmUgYSBuYW1lIHN0YXJ0aW5nIHdpdGggdGhlIHR5cGVkIGNoYXJhY3RlciwgZm9jdXMgZG9lcyBub3QgbW92ZS48L2xpPjwvdWw+IHxcbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleXVwKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXl1cCgpLCB0aGlzLmRvbS5tZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBzID0gZyhlKSwgeyBhbHRLZXk6IG4sIGNydGxLZXk6IGksIG1ldGFLZXk6IG8gfSA9IGU7XG4gICAgICBpZiAocyA9PT0gXCJDaGFyYWN0ZXJcIiAmJiAhKG4gfHwgaSB8fCBvKSlcbiAgICAgICAgbChlKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5jdXJyZW50RXZlbnQgPSBcImNoYXJhY3RlclwiLCB0aGlzLmZvY3VzTmV4dENoaWxkV2l0aENoYXJhY3RlcihlLmtleSk7XG4gICAgICBlbHNlIGlmICh0aGlzLmlzVG9wTGV2ZWwpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9jdXNTdGF0ZSA9PT0gXCJzZWxmXCIpXG4gICAgICAgICAgaWYgKHMgPT09IFwiU3BhY2VcIiB8fCBzID09PSBcIkVudGVyXCIpXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtID8gKGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5vcGVuKCksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0ZpcnN0Q2hpbGQoKTtcbiAgICAgICAgICAgIH0pKSA6IHRoaXMuY3VycmVudE1lbnVJdGVtLmRvbS5saW5rLmNsaWNrKCk7XG4gICAgICAgICAgZWxzZSBpZiAocyA9PT0gXCJBcnJvd1JpZ2h0XCIpIHtcbiAgICAgICAgICAgIGwoZSk7XG4gICAgICAgICAgICBjb25zdCBtID0gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuO1xuICAgICAgICAgICAgdGhpcy5mb2N1c05leHRDaGlsZCgpLCBtICYmICh0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtID8gKHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpIDogdGhpcy5jbG9zZUNoaWxkcmVuKCkpO1xuICAgICAgICAgIH0gZWxzZSBpZiAocyA9PT0gXCJBcnJvd0xlZnRcIikge1xuICAgICAgICAgICAgbChlKTtcbiAgICAgICAgICAgIGNvbnN0IG0gPSB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW47XG4gICAgICAgICAgICB0aGlzLmZvY3VzUHJldmlvdXNDaGlsZCgpLCBtICYmICh0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtID8gKHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpIDogdGhpcy5jbG9zZUNoaWxkcmVuKCkpO1xuICAgICAgICAgIH0gZWxzZSBzID09PSBcIkFycm93RG93blwiID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiAobChlKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIiwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLm9wZW4oKSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0ZpcnN0Q2hpbGQoKTtcbiAgICAgICAgICB9KSkgOiBzID09PSBcIkFycm93VXBcIiA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgKGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5vcGVuKCksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNMYXN0Q2hpbGQoKTtcbiAgICAgICAgICB9KSkgOiBzID09PSBcIkhvbWVcIiA/IChsKGUpLCB0aGlzLmZvY3VzRmlyc3RDaGlsZCgpKSA6IHMgPT09IFwiRW5kXCIgPyAobChlKSwgdGhpcy5mb2N1c0xhc3RDaGlsZCgpKSA6IHMgPT09IFwiRXNjYXBlXCIgJiYgKHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuc29tZShcbiAgICAgICAgICAgIChjKSA9PiBjLmlzT3BlblxuICAgICAgICAgICkgPyAobChlKSwgdGhpcy5jbG9zZUNoaWxkcmVuKCkpIDogdGhpcy5pc1RvcExldmVsICYmIHRoaXMuZWxlbWVudHMuY29udHJvbGxlciAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuaXNPcGVuICYmIChsKGUpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIuY2xvc2UoKSwgdGhpcy5mb2N1c0NvbnRyb2xsZXIoKSkpO1xuICAgICAgfSBlbHNlXG4gICAgICAgIHMgPT09IFwiU3BhY2VcIiB8fCBzID09PSBcIkVudGVyXCIgPyB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtID8gKGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5vcGVuKCksIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmZvY3VzRmlyc3RDaGlsZCgpO1xuICAgICAgICB9KSkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5kb20ubGluay5jbGljaygpIDogcyA9PT0gXCJFc2NhcGVcIiA/IChsKGUpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1c0N1cnJlbnRDaGlsZCgpKSA6IHMgPT09IFwiQXJyb3dSaWdodFwiID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/IChsKGUpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUub3BlbigpLCByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0ZpcnN0Q2hpbGQoKTtcbiAgICAgICAgfSkpIDogKGwoZSksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmZvY3VzTmV4dENoaWxkKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgdGhpcy5lbGVtZW50cy5yb290TWVudS5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKSkgOiBzID09PSBcIkFycm93TGVmdFwiID8gdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIChsKGUpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5jbG9zZSgpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNDdXJyZW50Q2hpbGQoKSwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51ID09PSB0aGlzLmVsZW1lbnRzLnJvb3RNZW51ICYmICh0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmNsb3NlQ2hpbGRyZW4oKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1c1ByZXZpb3VzQ2hpbGQoKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiAodGhpcy5lbGVtZW50cy5yb290TWVudS5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIiwgdGhpcy5lbGVtZW50cy5yb290TWVudS5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKSkpKSA6IHMgPT09IFwiQXJyb3dEb3duXCIgPyAobChlKSwgdGhpcy5mb2N1c05leHRDaGlsZCgpKSA6IHMgPT09IFwiQXJyb3dVcFwiID8gKGwoZSksIHRoaXMuZm9jdXNQcmV2aW91c0NoaWxkKCkpIDogcyA9PT0gXCJIb21lXCIgPyAobChlKSwgdGhpcy5mb2N1c0ZpcnN0Q2hpbGQoKSkgOiBzID09PSBcIkVuZFwiICYmIChsKGUpLCB0aGlzLmZvY3VzTGFzdENoaWxkKCkpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIG5leHQgY2hpbGQuXG4gICAqXG4gICAqIElmIHRoZSBjdXJyZW50bHkgZm9jdXNzZWQgY2hpbGQgaW4gdGhlIG1lbnUgaXMgdGhlIGxhc3QgY2hpbGQgdGhlbiB0aGlzIHdpbGxcbiAgICogZm9jdXMgdGhlIGZpcnN0IGNoaWxkIGluIHRoZSBtZW51LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c05leHRDaGlsZCgpIHtcbiAgICB0aGlzLmN1cnJlbnRDaGlsZCA9PT0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXMubGVuZ3RoIC0gMSA/IHRoaXMuZm9jdXNGaXJzdENoaWxkKCkgOiB0aGlzLmZvY3VzQ2hpbGQodGhpcy5jdXJyZW50Q2hpbGQgKyAxKTtcbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIG1lbnUncyBwcmV2aW91cyBjaGlsZC5cbiAgICpcbiAgICogSWYgdGhlIGN1cnJlbnRseSBmb2N1c3NlZCBjaGlsZCBpbiB0aGUgbWVudSBpcyB0aGUgZmlyc3QgY2hpbGQgdGhlbiB0aGlzIHdpbGxcbiAgICogZm9jdXMgdGhlIGxhc3QgY2hpbGQgaW4gdGhlIG1lbnUuXG4gICAqXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIGZvY3VzUHJldmlvdXNDaGlsZCgpIHtcbiAgICB0aGlzLmN1cnJlbnRDaGlsZCA9PT0gMCA/IHRoaXMuZm9jdXNMYXN0Q2hpbGQoKSA6IHRoaXMuZm9jdXNDaGlsZCh0aGlzLmN1cnJlbnRDaGlsZCAtIDEpO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIG5leHQgY2hpbGQgc3RhcnRpbmcgd2l0aCBhIHNwZWNpZmljIGxldHRlci5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2hhciAtIFRoZSBjaGFyYWN0ZXIgdG8gbG9vayBmb3IuXG4gICAqL1xuICBmb2N1c05leHRDaGlsZFdpdGhDaGFyYWN0ZXIoZSkge1xuICAgIGNvbnN0IHMgPSBlLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IG4gPSB0aGlzLmN1cnJlbnRDaGlsZCArIDEsIGkgPSAhMTtcbiAgICBmb3IgKDsgIWkgJiYgbiA8IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmxlbmd0aDsgKSB7XG4gICAgICBsZXQgbyA9IFwiXCI7XG4gICAgICB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtc1tuXS5kb20uaXRlbS5pbm5lclRleHQgPyBvID0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXNbbl0uZG9tLml0ZW0uaW5uZXJUZXh0IDogbyA9IHRoaXMuZWxlbWVudHMubWVudUl0ZW1zW25dLmRvbS5pdGVtLnRleHRDb250ZW50LCBvID0gby5yZXBsYWNlKC9bXFxzXS9nLCBcIlwiKS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKSwgbyA9PT0gcyAmJiAoaSA9ICEwLCB0aGlzLmZvY3VzQ2hpbGQobikpLCBuKys7XG4gICAgfVxuICB9XG59XG5jbGFzcyBRIGV4dGVuZHMgTCB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBUb3BMaW5rRGlzY2xvc3VyZU1lbnVJdGVtYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgaXRlbS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgICAgICAgICAgICBvcHRpb25zLm1lbnVJdGVtRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgICAgICAgICAgICAgIG9wdGlvbnMubWVudUxpbmtFbGVtZW50ICAgICAgICAgLSBUaGUgbWVudSBpdGVtJ3MgbGluayBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge1RvcExpbmtEaXNjbG9zdXJlTWVudX0gICAgICAgIG9wdGlvbnMucGFyZW50TWVudSAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgICAgICAgW29wdGlvbnMuaXNTdWJtZW51SXRlbSA9IGZhbHNlXSAtIEEgZmxhZyB0byBtYXJrIGlmIHRoZSBtZW51IGl0ZW0gaXMgY29udHJvbGxpbmcgYSBzdWJtZW51LlxuICAgKiBAcGFyYW0gez9Ub3BMaW5rRGlzY2xvc3VyZU1lbnV9ICAgICAgIFtvcHRpb25zLmNoaWxkTWVudSA9IG51bGxdICAgICAgLSBUaGUgY2hpbGQgbWVudS5cbiAgICogQHBhcmFtIHs/VG9wTGlua0Rpc2Nsb3N1cmVNZW51VG9nZ2xlfSBbb3B0aW9ucy50b2dnbGUgPSBudWxsXSAgICAgICAgIC0gVGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgICAgICAgICAgICAgIFtvcHRpb25zLmluaXRpYWxpemUgPSB0cnVlXSAgICAgLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSBpdGVtIGltbWVkaWF0ZWx5IHVwb24gY3JlYXRpb24uXG4gICAqIEBwYXJhbSB7P1RvcExpbmtEaXNjbG9zdXJlTWVudUl0ZW19ICAgW29wdGlvbnMuc3VibWVudVNpYmxpbmcgPSBudWxsXSAtIFRoZSBzaWJsaW5nIG1lbnUgaXRlbSB0aGF0IGNvbnRyb2xzIGEgc3VibWVudS5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51SXRlbUVsZW1lbnQ6IGUsXG4gICAgbWVudUxpbmtFbGVtZW50OiBzLFxuICAgIHBhcmVudE1lbnU6IG4sXG4gICAgaXNTdWJtZW51SXRlbTogaSA9ICExLFxuICAgIGNoaWxkTWVudTogbyA9IG51bGwsXG4gICAgdG9nZ2xlOiBoID0gbnVsbCxcbiAgICBpbml0aWFsaXplOiBtID0gITAsXG4gICAgc3VibWVudVNpYmxpbmc6IGMgPSBudWxsXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51SXRlbUVsZW1lbnQ6IGUsXG4gICAgICBtZW51TGlua0VsZW1lbnQ6IHMsXG4gICAgICBwYXJlbnRNZW51OiBuLFxuICAgICAgaXNTdWJtZW51SXRlbTogaSxcbiAgICAgIGNoaWxkTWVudTogbyxcbiAgICAgIHRvZ2dsZTogaFxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBkZWNsYXJlZCBhY2Nlc3NpYmxlLW1lbnUgZWxlbWVudHMgd2l0aGluIHRoZSBtZW51IGl0ZW0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7T2JqZWN0PFRvcExpbmtEaXNjbG9zdXJlTWVudSwgVG9wTGlua0Rpc2Nsb3N1cmVNZW51VG9nZ2xlPn1cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEBwcm9wZXJ0eSB7VG9wTGlua0Rpc2Nsb3N1cmVNZW51fSAgICAgICAgICAgICAgICAgICBwYXJlbnRNZW51IC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIG1lbnUgaXRlbS5cbiAgICAgKiBAcHJvcGVydHkgez9Ub3BMaW5rRGlzY2xvc3VyZU1lbnV9ICAgICAgICAgICAgICAgICAgY2hpbGRNZW51ICAtIFRoZSBtZW51IGNvbnRhaW5lZCB3aXRoaW4gdGhpcyBtZW51IGl0ZW0uXG4gICAgICogQHByb3BlcnR5IHs/VG9wTGlua0Rpc2Nsb3N1cmVNZW51VG9nZ2xlfSAgICAgICAgICAgIHRvZ2dsZSAgICAgLSBUaGUgbWVudSB0b2dnbGUgd2l0aGluIHRoaXMgbWVudSBpdGVtIHRoYXQgY29udHJvbHMgdGhlIGBjaGlsZE1lbnVgLlxuICAgICAqIEBwcm9wZXJ0eSB7P1RvcExpbmtEaXNjbG9zdXJlTWVudUl0ZW19ICAgICAgICAgICAgICBzaWJsaW5nICAgIC0gVGhlIHNpYmxpbmcgbWVudSBpdGVtIHRoYXQgaXMgYSBzdWJtZW51IGl0ZW0uXG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9lbGVtZW50c1wiLCB7XG4gICAgICBwYXJlbnRNZW51OiBudWxsLFxuICAgICAgY2hpbGRNZW51OiBudWxsLFxuICAgICAgdG9nZ2xlOiBudWxsLFxuICAgICAgc2libGluZzogbnVsbFxuICAgIH0pO1xuICAgIHRoaXMuX2VsZW1lbnRzLnBhcmVudE1lbnUgPSBuLCB0aGlzLl9lbGVtZW50cy5jaGlsZE1lbnUgPSBvLCB0aGlzLl9lbGVtZW50cy50b2dnbGUgPSBoLCB0aGlzLl9lbGVtZW50cy5zaWJsaW5nID0gYywgbSAmJiB0aGlzLmluaXRpYWxpemUoKTtcbiAgfVxufVxuY2xhc3MgQiBleHRlbmRzIEEge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgVG9wTGlua0Rpc2Nsb3N1cmVNZW51VG9nZ2xlYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudSB0b2dnbGUuXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICAgICAgb3B0aW9ucy5tZW51VG9nZ2xlRWxlbWVudCAgIC0gVGhlIHRvZ2dsZSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICAgICAgICAgb3B0aW9ucy5wYXJlbnRFbGVtZW50ICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKiBAcGFyYW0ge1RvcExpbmtEaXNjbG9zdXJlTWVudX0gIG9wdGlvbnMuY29udHJvbGxlZE1lbnUgICAgICAtIFRoZSBtZW51IGNvbnRyb2xsZWQgYnkgdGhpcyB0b2dnbGUuXG4gICAqIEBwYXJhbSB7P1RvcExpbmtEaXNjbG9zdXJlTWVudX0gW29wdGlvbnMucGFyZW50TWVudSA9IG51bGxdIC0gVGhlIG1lbnUgY29udGFpbmluZyB0aGlzIHRvZ2dsZS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSB0b2dnbGUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51VG9nZ2xlRWxlbWVudDogdCxcbiAgICBwYXJlbnRFbGVtZW50OiBlLFxuICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgIHBhcmVudE1lbnU6IG4gPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGkgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IHQsXG4gICAgICBwYXJlbnRFbGVtZW50OiBlLFxuICAgICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgICBwYXJlbnRNZW51OiBuXG4gICAgfSksIGkgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIFNldHMgdGhlIEFSSUEgYXR0cmlidXRlcyBvbiB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUuXG4gICAqXG4gICAqIENhbGxzIHRoZSBCYXNlTWVudVRvZ2dsZSdzIF9zZXRBcmlhQXR0cmlidXRlcyBtZXRob2QuXG4gICAqXG4gICAqIEVuc3VyZXMgdGhlIHRvZ2dsZSBlbGVtZW50IGhhcyBhIGByb2xlYCBvZiBcImJ1dHRvblwiIGlmIGl0IGlzIG5vdFxuICAgKiBhbHJlYWR5IGEgYnV0dG9uLlxuICAgKlxuICAgKiBUaGVuIHVzaW5nIHRoZSB0b2dnbGUgYW5kIG1lbnUncyBJRHMsIHRoZSB0b2dnbGUncyBgYXJpYS1jb250cm9sc2BcbiAgICogaXMgc2V0IHRvIHRoZSBtZW51J3MgSUQuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9zZXRBcmlhQXR0cmlidXRlcygpIHtcbiAgICBzdXBlci5fc2V0QXJpYUF0dHJpYnV0ZXMoKSwgeChcImJ1dHRvblwiLCB7IHRvZ2dsZTogdGhpcy5kb20udG9nZ2xlIH0pIHx8IHRoaXMuZG9tLnRvZ2dsZS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiYnV0dG9uXCIpLCB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFxuICAgICAgXCJhcmlhLWNvbnRyb2xzXCIsXG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LmlkXG4gICAgKTtcbiAgfVxuICAvKipcbiAgICogT3BlbnMgdGhlIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZVNpYmxpbmdzIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3Mgb3BlbiBtZXRob2QuXG4gICAqL1xuICBvcGVuKCkge1xuICAgIHRoaXMuY2xvc2VTaWJsaW5ncygpLCBzdXBlci5vcGVuKCk7XG4gIH1cbiAgLyoqXG4gICAqIE9wZW5zIHRoZSBjb250cm9sbGVkIG1lbnUgd2l0aG91dCB0aGUgY3VycmVudCBmb2N1cyBlbnRlcmluZyBpdC5cbiAgICpcbiAgICogQ2FsbHMgdGhlICBjbG9zZVNpYmxpbmdzIG1ldGhvZFxuICAgKiBhbmQgX3RoZW5fIEJhc2VNZW51VG9nZ2xlJ3MgcHJldmlldyBtZXRob2QuXG4gICAqL1xuICBwcmV2aWV3KCkge1xuICAgIHRoaXMuY2xvc2VTaWJsaW5ncygpLCBzdXBlci5wcmV2aWV3KCk7XG4gIH1cbiAgLyoqXG4gICAqIENsb3NlcyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKlxuICAgKiBDYWxscyB0aGUgIGNsb3NlQ2hpbGRyZW4gbWV0aG9kXG4gICAqIGFuZCBfdGhlbl8gQmFzZU1lbnVUb2dnbGUncyBjbG9zZSBtZXRob2QuXG4gICAqL1xuICBjbG9zZSgpIHtcbiAgICB0aGlzLmlzT3BlbiAmJiB0aGlzLmNsb3NlQ2hpbGRyZW4oKSwgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuY2xhc3MgJCBleHRlbmRzIEkge1xuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBgVG9wTGlua0Rpc2Nsb3N1cmVNZW51YC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgICAgICBvcHRpb25zLm1lbnVFbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgbWVudSBlbGVtZW50IGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICAgICAgW29wdGlvbnMubWVudUl0ZW1TZWxlY3RvciA9IGxpXSAgICAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBpdGVtcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5tZW51TGlua1NlbGVjdG9yID0gYV0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGxpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVJdGVtU2VsZWN0b3IgPSBsaTpoYXModWwpXSAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMgY29udGFpbmluZyBzdWJtZW51cy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5zdWJtZW51VG9nZ2xlU2VsZWN0b3IgPSBidXR0b25dICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBzdWJtZW51IHRvZ2dsZSBidXR0b25zL2xpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVTZWxlY3RvciA9IHVsXSAgICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVTdWJ0b2dnbGVTZWxlY3RvciA9IGFdICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnUgdG9nZ2xlIGJ1dHRvbnMvbGlua3MgYmVsb3cgdGhlIHRvcCBsZXZlbC5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgICAgICBbb3B0aW9ucy5jb250cm9sbGVyRWxlbWVudCA9IG51bGxdICAgICAgICAgLSBUaGUgZWxlbWVudCBjb250cm9sbGluZyB0aGUgbWVudSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0gez9IVE1MRWxlbWVudH0gICAgICAgICAgIFtvcHRpb25zLmNvbnRhaW5lckVsZW1lbnQgPSBudWxsXSAgICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9ICAgICBbb3B0aW9ucy5vcGVuQ2xhc3MgPSBzaG93XSAgICAgICAgICAgICAgICAgLSBUaGUgY2xhc3MgdG8gYXBwbHkgd2hlbiBhIG1lbnUgaXMgXCJvcGVuXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSAgICAgW29wdGlvbnMuY2xvc2VDbGFzcyA9IGhpZGVdICAgICAgICAgICAgICAgIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIFwiY2xvc2VkXCIuXG4gICAqIEBwYXJhbSB7PyhzdHJpbmd8c3RyaW5nW10pfSAgICAgW29wdGlvbnMudHJhbnNpdGlvbkNsYXNzID0gdHJhbnNpdGlvbmluZ10gIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIHRyYW5zaXRpb25pbmcgYmV0d2VlbiBcIm9wZW5cIiBhbmQgXCJjbG9zZWRcIiBzdGF0ZXMuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgW29wdGlvbnMuaXNUb3BMZXZlbCA9IHRydWVdICAgICAgICAgICAgICAgIC0gQSBmbGFnIHRvIG1hcmsgdGhlIHJvb3QgbWVudS5cbiAgICogQHBhcmFtIHs/VG9wTGlua0Rpc2Nsb3N1cmVNZW51fSBbb3B0aW9ucy5wYXJlbnRNZW51ID0gbnVsbF0gICAgICAgICAgICAgICAgLSBUaGUgcGFyZW50IG1lbnUgdG8gdGhpcyBtZW51LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyVHlwZSA9IG9mZl0gICAgICAgICAgICAgICAgICAtIFRoZSB0eXBlIG9mIGhvdmVyYWJpbGl0eSBhIG1lbnUgaGFzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyRGVsYXkgPSAyNTBdICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3Igb3BlbmluZyBhbmQgY2xvc2luZyBtZW51cyBpZiB0aGUgbWVudSBpcyBob3ZlcmFibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgICAgICBbb3B0aW9ucy5lbnRlckRlbGF5ID0gLTFdICAgICAgICAgICAgICAgICAgLSBUaGUgZGVsYXkgZm9yIG9wZW5pbmcgYSBtZW51IGlmIHRoZSBtZW51IGlzIGZvY3VzYWJsZSAoaW4gbWlsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgICAgIFtvcHRpb25zLmxlYXZlRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3IgY2xvc2luZyBhIG1lbnUgaWYgdGhlIG1lbnUgaXMgZm9jdXNhYmxlIChpbiBtaWxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICAgICAgW29wdGlvbnMub3B0aW9uYWxLZXlTdXBwb3J0ID0gZmFsc2VdICAgICAgIC0gQSBmbGFnIHRvIGFkZCBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0IChBcnJvdyBrZXlzLCBIb21lLCBhbmQgRW5kKSB0byB0aGUgbWVudS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVFbGVtZW50OiBlLFxuICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMgPSBcImxpXCIsXG4gICAgbWVudUxpbmtTZWxlY3RvcjogbiA9IFwiYVwiLFxuICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGkgPSBcImxpOmhhcyh1bClcIixcbiAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IG8gPSBcImJ1dHRvblwiLFxuICAgIHN1Ym1lbnVTZWxlY3RvcjogaCA9IFwidWxcIixcbiAgICBzdWJtZW51U3VidG9nZ2xlU2VsZWN0b3I6IG0gPSBcImFcIixcbiAgICBjb250cm9sbGVyRWxlbWVudDogYyA9IG51bGwsXG4gICAgY29udGFpbmVyRWxlbWVudDogYSA9IG51bGwsXG4gICAgb3BlbkNsYXNzOiBkID0gXCJzaG93XCIsXG4gICAgY2xvc2VDbGFzczogZiA9IFwiaGlkZVwiLFxuICAgIHRyYW5zaXRpb25DbGFzczogeSA9IFwidHJhbnNpdGlvbmluZ1wiLFxuICAgIGlzVG9wTGV2ZWw6IE0gPSAhMCxcbiAgICBwYXJlbnRNZW51OiBiID0gbnVsbCxcbiAgICBob3ZlclR5cGU6IF8gPSBcIm9mZlwiLFxuICAgIGhvdmVyRGVsYXk6IEMgPSAyNTAsXG4gICAgZW50ZXJEZWxheTogRSA9IC0xLFxuICAgIGxlYXZlRGVsYXk6IFQgPSAtMSxcbiAgICBvcHRpb25hbEtleVN1cHBvcnQ6IE8gPSAhMSxcbiAgICBpbml0aWFsaXplOiBxID0gITBcbiAgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG1lbnVFbGVtZW50OiBlLFxuICAgICAgbWVudUl0ZW1TZWxlY3RvcjogcyxcbiAgICAgIG1lbnVMaW5rU2VsZWN0b3I6IG4sXG4gICAgICBzdWJtZW51SXRlbVNlbGVjdG9yOiBpLFxuICAgICAgc3VibWVudVNlbGVjdG9yOiBoLFxuICAgICAgc3VibWVudVRvZ2dsZVNlbGVjdG9yOiBvLFxuICAgICAgY29udHJvbGxlckVsZW1lbnQ6IGMsXG4gICAgICBjb250YWluZXJFbGVtZW50OiBhLFxuICAgICAgb3BlbkNsYXNzOiBkLFxuICAgICAgY2xvc2VDbGFzczogZixcbiAgICAgIHRyYW5zaXRpb25DbGFzczogeSxcbiAgICAgIGlzVG9wTGV2ZWw6IE0sXG4gICAgICBwYXJlbnRNZW51OiBiLFxuICAgICAgaG92ZXJUeXBlOiBfLFxuICAgICAgaG92ZXJEZWxheTogQyxcbiAgICAgIGVudGVyRGVsYXk6IEUsXG4gICAgICBsZWF2ZURlbGF5OiBUXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgc3VibWVudXMuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7dHlwZW9mIFRvcExpbmtEaXNjbG9zdXJlTWVudX1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVUeXBlXCIsICQpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdXNlLWJlZm9yZS1kZWZpbmVcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBtZW51IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUb3BMaW5rRGlzY2xvc3VyZU1lbnVJdGVtfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudUl0ZW1UeXBlXCIsIFEpO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKlxuICAgICAqIEB0eXBlIHt0eXBlb2YgVG9wTGlua0Rpc2Nsb3N1cmVNZW51VG9nZ2xlfVxuICAgICAqL1xuICAgIHUodGhpcywgXCJfTWVudVRvZ2dsZVR5cGVcIiwgQik7XG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IG9mIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbWVudSBpdGVtIGluIHRoZSBtZW51LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX2N1cnJlbnRDaGlsZFwiLCAtMSk7XG4gICAgLyoqXG4gICAgICogVGhlIHF1ZXJ5IHNlbGVjdG9ycyB1c2VkIGJ5IHRoZSBtZW51IHRvIHBvcHVsYXRlIHRoZSBkb20uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7T2JqZWN0PHN0cmluZz59XG4gICAgICpcbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gbWVudUl0ZW1zICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgaXRlbXMuXG4gICAgICogQHByb3BlcnR5IHtzdHJpbmd9IG1lbnVMaW5rcyAgICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIGZvciBtZW51IGxpbmtzLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdWJtZW51SXRlbXMgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBmb3IgbWVudSBpdGVtcyBjb250YWluaW5nIHN1Ym1lbnVzLlxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzdWJtZW51VG9nZ2xlcyAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBmb3IgbWVudSBsaW5rcyB0aGF0IGZ1bmN0aW9uIGFzIHN1Ym1lbnUgdG9nZ2xlcy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudXMgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIGZvciBzdWJtZW51cy5cbiAgICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3VibWVudVN1YnRvZ2dsZXMgLSBUaGUgcXVlcnkgc2VsZWN0b3IgZm9yIG1lbnUgbGlua3MgdGhhdCBmdW5jdGlvbiBhcyBzdWJtZW51IHRvZ2dsZXMgYmVsb3cgdGhlIHRvcCBsZXZlbC5cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX3NlbGVjdG9yc1wiLCB7XG4gICAgICBtZW51SXRlbXM6IFwiXCIsXG4gICAgICBtZW51TGlua3M6IFwiXCIsXG4gICAgICBzdWJtZW51SXRlbXM6IFwiXCIsXG4gICAgICBzdWJtZW51VG9nZ2xlczogXCJcIixcbiAgICAgIHN1Ym1lbnVzOiBcIlwiLFxuICAgICAgc3VibWVudVN1YnRvZ2dsZXM6IFwiXCJcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIikgdG8gdGhlIG1lbnUuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX29wdGlvbmFsU3VwcG9ydFwiLCAhMSk7XG4gICAgdGhpcy5fb3B0aW9uYWxTdXBwb3J0ID0gTywgdGhpcy5fc2VsZWN0b3JzLm1lbnVJdGVtcyA9IHMsIHRoaXMuX3NlbGVjdG9ycy5zdWJtZW51SXRlbXMgPSBpLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudVRvZ2dsZXMgPSBvLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudXMgPSBoLCB0aGlzLl9zZWxlY3RvcnMuc3VibWVudVN1YnRvZ2dsZXMgPSBtLCB0aGlzLl9zZWxlY3RvcnMubWVudUxpbmtzID0gW1xuICAgICAgLi4uLyogQF9fUFVSRV9fICovIG5ldyBTZXQoW24sIG9dKVxuICAgIF0uam9pbihcIixcIiksIHEgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBtZW51LlxuICAgKlxuICAgKiBJbml0aWFsaXplIHdpbGwgY2FsbCB0aGUgQmFzZU1lbnUncyBpbml0aWFsaXplIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB1cCBmb2N1cyxcbiAgICogY2xpY2ssXG4gICAqIGhvdmVyLFxuICAgKiBrZXlkb3duLCBhbmRcbiAgICoga2V5dXAgZXZlbnRzIGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogSWYgdGhlIEJhc2VNZW51J3MgaW5pdGlhbGl6ZSBtZXRob2QgdGhyb3dzIGFuIGVycm9yLFxuICAgKiB0aGlzIHdpbGwgY2F0Y2ggaXQgYW5kIGxvZyBpdCB0byB0aGUgY29uc29sZS5cbiAgICovXG4gIGluaXRpYWxpemUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHN1cGVyLmluaXRpYWxpemUoKSwgdGhpcy5faGFuZGxlRm9jdXMoKSwgdGhpcy5faGFuZGxlQ2xpY2soKSwgdGhpcy5faGFuZGxlSG92ZXIoKSwgdGhpcy5faGFuZGxlS2V5ZG93bigpLCB0aGlzLl9oYW5kbGVLZXl1cCgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBBIGZsYWcgdG8gYWRkIG9wdGlvbmFsIGtleWJvYXJkIHN1cHBvcnQgKEFycm93IGtleXMsIFwiSG9tZVwiLCBhbmQgXCJFbmRcIikgdG8gdGhlIG1lbnUuXG4gICAqXG4gICAqIFRoaXMgZnVuY3Rpb25zIGRpZmZlcmVudGx5IGZvciByb290IHZzLiBzdWJtZW51cy5cbiAgICogU3VibWVudXMgd2lsbCBhbHdheXMgaW5oZXJpdCB0aGVpciByb290IG1lbnUncyBvcHRpb25hbEtleVN1cHBvcnQuXG4gICAqXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKlxuICAgKiBAc2VlIF9vcHRpb25hbFN1cHBvcnRcbiAgICovXG4gIGdldCBvcHRpb25hbEtleVN1cHBvcnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNUb3BMZXZlbCA/IHRoaXMuX29wdGlvbmFsU3VwcG9ydCA6IHRoaXMuZWxlbWVudHMucm9vdE1lbnUub3B0aW9uYWxLZXlTdXBwb3J0O1xuICB9XG4gIHNldCBvcHRpb25hbEtleVN1cHBvcnQoZSkge1xuICAgIHAoXCJib29sZWFuXCIsIHsgb3B0aW9uYWxLZXlTdXBwb3J0OiBlIH0pLCB0aGlzLl9vcHRpb25hbFN1cHBvcnQgPSBlO1xuICB9XG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbGwgbWVudSBpdGVtcyBhbmQgc3VibWVudXMuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9jcmVhdGVDaGlsZEVsZW1lbnRzKCkge1xuICAgIHRoaXMuZG9tLm1lbnVJdGVtcy5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBsZXQgcywgbjtcbiAgICAgIGNvbnN0IGkgPSBlLnF1ZXJ5U2VsZWN0b3IodGhpcy5zZWxlY3RvcnMubWVudUxpbmtzKTtcbiAgICAgIGlmICh0aGlzLmRvbS5zdWJtZW51SXRlbXMuaW5jbHVkZXMoZSkpIHtcbiAgICAgICAgY29uc3QgbyA9IGUucXVlcnlTZWxlY3Rvcih0aGlzLnNlbGVjdG9ycy5zdWJtZW51VG9nZ2xlcyksIGggPSBlLnF1ZXJ5U2VsZWN0b3IodGhpcy5zZWxlY3RvcnMuc3VibWVudXMpLCBtID0gbmV3IHRoaXMuX01lbnVUeXBlKHtcbiAgICAgICAgICBtZW51RWxlbWVudDogaCxcbiAgICAgICAgICBtZW51SXRlbVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5tZW51SXRlbXMsXG4gICAgICAgICAgbWVudUxpbmtTZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMubWVudUxpbmtzLFxuICAgICAgICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVJdGVtcyxcbiAgICAgICAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IHRoaXMuc2VsZWN0b3JzLnN1Ym1lbnVTdWJ0b2dnbGVzLFxuICAgICAgICAgIHN1Ym1lbnVTZWxlY3RvcjogdGhpcy5zZWxlY3RvcnMuc3VibWVudXMsXG4gICAgICAgICAgc3VibWVudVN1YnRvZ2dsZVNlbGVjdG9yOiB0aGlzLnNlbGVjdG9ycy5zdWJtZW51U3VidG9nZ2xlcyxcbiAgICAgICAgICBvcGVuQ2xhc3M6IHRoaXMub3BlbkNsYXNzLFxuICAgICAgICAgIGNsb3NlQ2xhc3M6IHRoaXMuY2xvc2VDbGFzcyxcbiAgICAgICAgICB0cmFuc2l0aW9uQ2xhc3M6IHRoaXMudHJhbnNpdGlvbkNsYXNzLFxuICAgICAgICAgIGlzVG9wTGV2ZWw6ICExLFxuICAgICAgICAgIHBhcmVudE1lbnU6IHRoaXMsXG4gICAgICAgICAgaG92ZXJUeXBlOiB0aGlzLmhvdmVyVHlwZSxcbiAgICAgICAgICBob3ZlckRlbGF5OiB0aGlzLmhvdmVyRGVsYXksXG4gICAgICAgICAgZW50ZXJEZWxheTogdGhpcy5lbnRlckRlbGF5LFxuICAgICAgICAgIGxlYXZlRGVsYXk6IHRoaXMubGVhdmVEZWxheVxuICAgICAgICB9KSwgYyA9IG5ldyB0aGlzLl9NZW51VG9nZ2xlVHlwZSh7XG4gICAgICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IG8sXG4gICAgICAgICAgcGFyZW50RWxlbWVudDogZSxcbiAgICAgICAgICBjb250cm9sbGVkTWVudTogbSxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5wdXNoKGMpLCBvICE9PSBpID8gKG4gPSBuZXcgdGhpcy5fTWVudUl0ZW1UeXBlKHtcbiAgICAgICAgICBtZW51SXRlbUVsZW1lbnQ6IGUsXG4gICAgICAgICAgbWVudUxpbmtFbGVtZW50OiBvLFxuICAgICAgICAgIHBhcmVudE1lbnU6IHRoaXMsXG4gICAgICAgICAgaXNTdWJtZW51SXRlbTogITAsXG4gICAgICAgICAgY2hpbGRNZW51OiBtLFxuICAgICAgICAgIHRvZ2dsZTogY1xuICAgICAgICB9KSwgcyA9IG5ldyB0aGlzLl9NZW51SXRlbVR5cGUoe1xuICAgICAgICAgIG1lbnVJdGVtRWxlbWVudDogZSxcbiAgICAgICAgICBtZW51TGlua0VsZW1lbnQ6IGksXG4gICAgICAgICAgcGFyZW50TWVudTogdGhpcyxcbiAgICAgICAgICBzdWJtZW51U2libGluZzogblxuICAgICAgICB9KSkgOiBzID0gbmV3IHRoaXMuX01lbnVJdGVtVHlwZSh7XG4gICAgICAgICAgbWVudUl0ZW1FbGVtZW50OiBlLFxuICAgICAgICAgIG1lbnVMaW5rRWxlbWVudDogaSxcbiAgICAgICAgICBwYXJlbnRNZW51OiB0aGlzLFxuICAgICAgICAgIGlzU3VibWVudUl0ZW06ICEwLFxuICAgICAgICAgIGNoaWxkTWVudTogbSxcbiAgICAgICAgICB0b2dnbGU6IGNcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2VcbiAgICAgICAgcyA9IG5ldyB0aGlzLl9NZW51SXRlbVR5cGUoe1xuICAgICAgICAgIG1lbnVJdGVtRWxlbWVudDogZSxcbiAgICAgICAgICBtZW51TGlua0VsZW1lbnQ6IGksXG4gICAgICAgICAgcGFyZW50TWVudTogdGhpc1xuICAgICAgICB9KTtcbiAgICAgIHRoaXMuX2VsZW1lbnRzLm1lbnVJdGVtcy5wdXNoKHMpLCB0eXBlb2YgbiA8IFwidVwiICYmIHRoaXMuX2VsZW1lbnRzLm1lbnVJdGVtcy5wdXNoKG4pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgYWxsIGFzcGVjdHMgb2YgdGhlIG1lbnUgdG8gZW5zdXJlIHByb3BlciBmdW5jdGlvbmFsaXR5LlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IC0gVGhlIHJlc3VsdCBvZiB0aGUgdmFsaWRhdGlvbi5cbiAgICovXG4gIF92YWxpZGF0ZSgpIHtcbiAgICBsZXQgZSA9IHN1cGVyLl92YWxpZGF0ZSgpO1xuICAgIGNvbnN0IHMgPSBEKHtcbiAgICAgIHN1Ym1lbnVTdWJ0b2dnbGVTZWxlY3RvcjogdGhpcy5fc2VsZWN0b3JzLnN1Ym1lbnVTdWJ0b2dnbGVzXG4gICAgfSk7XG4gICAgcy5zdGF0dXMgfHwgKHRoaXMuX2Vycm9ycy5wdXNoKHMuZXJyb3IubWVzc2FnZSksIGUgPSAhMSk7XG4gICAgY29uc3QgbiA9IHAoXCJib29sZWFuXCIsIHtcbiAgICAgIG9wdGlvbmFsS2V5U3VwcG9ydDogdGhpcy5fb3B0aW9uYWxTdXBwb3J0XG4gICAgfSk7XG4gICAgcmV0dXJuIG4uc3RhdHVzIHx8ICh0aGlzLl9lcnJvcnMucHVzaChuLmVycm9yLm1lc3NhZ2UpLCBlID0gITEpLCBlO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGNsaWNrIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgdXNlLlxuICAgKlxuICAgKiAtIEFkZHMgYWxsIGV2ZW50IGxpc3RlbmVycyBsaXN0ZWQgaW5cbiAgICogICBCYXNlTWVudSdzIF9oYW5kbGVDbGljayBtZXRob2QsIGFuZFxuICAgKiAtIGFkZHMgYSBgcG9pbnRlcnVwYCBsaXN0ZW5lciB0byB0aGUgYGRvY3VtZW50YCBzbyBpZiB0aGUgdXNlclxuICAgKiAgIGNsaWNrcyBvdXRzaWRlIG9mIHRoZSBtZW51IGl0IHdpbGwgY2xvc2UgaWYgaXQgaXMgb3Blbi5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUNsaWNrKCkge1xuICAgIHN1cGVyLl9oYW5kbGVDbGljaygpLCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIChlKSA9PiB7XG4gICAgICB0aGlzLmZvY3VzU3RhdGUgIT09IFwibm9uZVwiICYmICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgIXRoaXMuZG9tLm1lbnUuY29udGFpbnMoZS50YXJnZXQpICYmICF0aGlzLmRvbS5tZW51ICE9PSBlLnRhcmdldCAmJiAodGhpcy5jbG9zZUNoaWxkcmVuKCksIHRoaXMuYmx1cigpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmNsb3NlKCksIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuaGFzT3BlbmVkID0gITEpKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBob3ZlciBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIHVzZS5cbiAgICpcbiAgICogQWRkcyBgcG9pbnRlcmVudGVyYCBsaXN0ZW5lcnMgdG8gYWxsIG1lbnUgaXRlbXMgYW5kIGBwb2ludGVybGVhdmVgIGxpc3RlbmVyc1xuICAgKiB0byBhbGwgc3VibWVudSBpdGVtcyB3aGljaCBmdW5jdGlvbiBkaWZmZXJlbnRseSBkZXBlbmRpbmcgb25cbiAgICogdGhlIG1lbnUncyBob3ZlciB0eXBlLlxuICAgKlxuICAgKiBCZWZvcmUgZXhlY3V0aW5nIGFueXRoaW5nLCB0aGUgZXZlbnQgaXMgY2hlY2tlZCB0byBtYWtlIHN1cmUgdGhlIGV2ZW50IHdhc24ndFxuICAgKiB0cmlnZ2VyZWQgYnkgYSBwZW4gb3IgdG91Y2guXG4gICAqXG4gICAqIDxzdHJvbmc+SG92ZXIgVHlwZSBcIm9uXCI8L3N0cm9uZz5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSB0aGUgbWVudSdzXG4gICAqICAgIGN1cnJlbnQgY2hpbGQgdmFsdWUgd2lsbCBjaGFuZ2UgdG8gdGhhdFxuICAgKiAgIG1lbnUgaXRlbS5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBzdWJtZW51IGl0ZW0gdGhlXG4gICAqICAgcHJldmlldyBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0nc1xuICAgKiAgIHRvZ2dsZSB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJsZWF2ZWAgZXZlbnQgdHJpZ2dlcnMgb24gYW4gb3BlbiBzdWJtZW51IGl0ZW0gdGhlXG4gICAqICAgY2xvc2UgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3MgdG9nZ2xlXG4gICAqICAgd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgYSBkZWxheSBzZXQgYnkgdGhlIG1lbnUncyBob3ZlciBkZWxheS5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwiZHluYW1pY1wiPC9zdHJvbmc+XG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0gdGhlIG1lbnUnc1xuICAgKiAgIGN1cnJlbnQgY2hpbGQgdmFsdWUgd2lsbCBjaGFuZ2UgdG8gdGhhdCBtZW51IGl0ZW0uXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGFueSBtZW51IGl0ZW0sIGFuZCB0aGUgbWVudSdzXG4gICAqICAgZm9jdXMgc3RhdGUgaXMgbm90IFwibm9uZVwiLCB0aGUgbWVudSBpdGVtXG4gICAqICAgd2lsbCBiZSBmb2N1c2VkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIHN1Ym1lbnUgaXRlbSwgYW5kIGEgc3VibWVudSBpc1xuICAgKiAgIGFscmVhZHkgb3BlbiwgdGhlIHByZXZpZXcgbWV0aG9kIGZvciB0aGUgc3VibWVudSBpdGVtJ3MgdG9nZ2xlIHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIG5vbi1zdWJtZW51IGl0ZW0sIGFuZCBhIHN1Ym1lbnVcbiAgICogICBpcyBhbHJlYWR5IG9wZW4sIHRoZSBjbG9zZUNoaWxkcmVuIG1ldGhvZCBmb3IgdGhlIG1lbnUgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgc3VibWVudSBpdGVtLCBhbmQgbm8gc3VibWVudSBpc1xuICAgKiAgIG9wZW4sIG5vIHN1Ym1lbnUtc3BlY2lmaWMgbWV0aG9kcyB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJsZWF2ZWAgZXZlbnQgdHJpZ2dlcnMgb24gYW4gb3BlbiBzdWJtZW51IGl0ZW0gdGhhdCBpcyBub3QgYVxuICAgKiAgIHJvb3QtbGV2ZWwgc3VibWVudSBpdGVtIHRoZSBjbG9zZSBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0ncyB0b2dnbGVcbiAgICogICB3aWxsIGJlIGNhbGxlZCBhbmQgdGhlIHN1Ym1lbnUgaXRlbSB3aWxsIGJlIGZvY3VzZWQgYWZ0ZXIgYSBkZWxheSBzZXQgYnlcbiAgICogICB0aGUgbWVudSdzIGhvdmVyIGRlbGF5LlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmxlYXZlYCBldmVudCB0cmlnZ2VycyBvbiBhbiBvcGVuIHN1Ym1lbnUgaXRlbSB0aGF0IGlzIGFcbiAgICogICByb290LWxldmVsIHN1Ym1lbnUgaXRlbSBubyBzdWJtZW51LXNwZWNpZmljIG1ldGhvZHMgd2lsbCBiZSBjYWxsZWQuXG4gICAqXG4gICAqIDxzdHJvbmc+SG92ZXIgVHlwZSBcIm9mZlwiPC9zdHJvbmc+XG4gICAqIEFsbCBgcG9pbnRlcmVudGVyYCBhbmQgYHBvaW50ZXJsZWF2ZWAgZXZlbnRzIGFyZSBpZ25vcmVkLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlSG92ZXIoKSB7XG4gICAgdGhpcy5lbGVtZW50cy5tZW51SXRlbXMuZm9yRWFjaCgoZSwgcykgPT4ge1xuICAgICAgZS5kb20ubGluay5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmVudGVyXCIsIChuKSA9PiB7XG4gICAgICAgIGlmICghKG4ucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgbi5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiKSkge1xuICAgICAgICAgIGlmICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJvblwiKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyQ2hpbGRyZW4oKSwgdGhpcy5mb2N1c0NoaWxkKHMpO1xuICAgICAgICAgICAgbGV0IGkgPSBlLmlzU3VibWVudUl0ZW0gPyBlLmVsZW1lbnRzLnRvZ2dsZSA6IG51bGw7XG4gICAgICAgICAgICBpZiAoZS5lbGVtZW50cy5zaWJsaW5nICE9PSBudWxsICYmIChpID0gZS5lbGVtZW50cy5zaWJsaW5nLmVsZW1lbnRzLnRvZ2dsZSksIGkgPT09IG51bGwpIHJldHVybjtcbiAgICAgICAgICAgIHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBpLnByZXZpZXcoKTtcbiAgICAgICAgICAgIH0sIHRoaXMuZW50ZXJEZWxheSkpIDogaS5wcmV2aWV3KCk7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMuY3VycmVudENoaWxkID0gcywgKCF0aGlzLmlzVG9wTGV2ZWwgfHwgdGhpcy5mb2N1c1N0YXRlICE9PSBcIm5vbmVcIikgJiYgKHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmJsdXJDaGlsZHJlbigpLCB0aGlzLmZvY3VzQ3VycmVudENoaWxkKCkpLCAhdGhpcy5pc1RvcExldmVsIHx8IHRoaXMuaGFzT3BlbmVkKSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKTtcbiAgICAgICAgICAgIGxldCBpID0gZS5pc1N1Ym1lbnVJdGVtID8gZS5lbGVtZW50cy50b2dnbGUgOiBudWxsO1xuICAgICAgICAgICAgZS5lbGVtZW50cy5zaWJsaW5nICE9PSBudWxsICYmIChpID0gZS5lbGVtZW50cy5zaWJsaW5nLmVsZW1lbnRzLnRvZ2dsZSksIGkgIT09IG51bGwgPyB0aGlzLmVudGVyRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgaS5wcmV2aWV3KCk7XG4gICAgICAgICAgICB9LCB0aGlzLmVudGVyRGVsYXkpKSA6IGkucHJldmlldygpIDogdGhpcy5lbnRlckRlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMuY2xvc2VDaGlsZHJlbigpO1xuICAgICAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiB0aGlzLmNsb3NlQ2hpbGRyZW4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLCBlLmlzU3VibWVudUl0ZW0gJiYgKGUuZG9tLml0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJsZWF2ZVwiLCAobikgPT4ge1xuICAgICAgICBuLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IG4ucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiA/IHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiLCBlLmVsZW1lbnRzLnRvZ2dsZS5jbG9zZSgpO1xuICAgICAgICB9LCB0aGlzLmxlYXZlRGVsYXkpKSA6ICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgZS5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSkgOiB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIgJiYgKHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiO1xuICAgICAgICB9LCB0aGlzLmxlYXZlRGVsYXkpKSA6IHRoaXMuY3VycmVudEV2ZW50ID0gXCJtb3VzZVwiKSk7XG4gICAgICB9KSwgZS5kb20uaXRlbS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmVudGVyXCIsIChuKSA9PiB7XG4gICAgICAgIG4ucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgbi5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiIHx8IGUuaXNTdWJtZW51SXRlbSAmJiAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiB8fCB0aGlzLmhvdmVyVHlwZSA9PT0gXCJkeW5hbWljXCIpICYmIHRoaXMubGVhdmVEZWxheSA+IDAgJiYgdGhpcy5fY2xlYXJUaW1lb3V0KCk7XG4gICAgICB9KSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5ZG93biBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYXNzaXN0IHRoZSBfaGFuZGxlS2V5dXAgbWV0aG9kLlxuICAgKiAtIEFkZHMgYWxsIGBrZXlkb3duYCBsaXN0ZW5lcnMgZnJvbSBCYXNlTWVudSdzIF9oYW5kbGVLZXlkb3duIG1ldGhvZFxuICAgKiAtIEFkZHMgYSBga2V5ZG93bmAgbGlzdGVuZXIgdG8gdGhlIG1lbnUvYWxsIHN1Ym1lbnVzLlxuICAgKiAgIC0gQmxvY2tzIHByb3BhZ2F0aW9uIG9uIHRoZSBmb2xsb3dpbmcga2V5czogXCJTcGFjZVwiLCBcIkVudGVyXCIsIGFuZCBcIkVzY2FwZVwiLlxuICAgKiAgIC0gX0lmXyBvcHRpb25hbCBrZXlib2FyZCBzdXBwb3J0XG4gICAqICAgICBpcyBlbmFibGVkLCBibG9ja3MgcHJvcGFnYXRpb24gb24gdGhlIGZvbGxvd2luZyBrZXlzOlxuICAgKiAgICAgXCJBcnJvd1VwXCIsIFwiQXJyb3dSaWdodFwiLCBcIkFycm93RG93blwiLCBcIkFycm93TGVmdFwiLCBcIkhvbWVcIiwgYW5kIFwiRW5kXCIuXG4gICAqXG4gICAqIEBwcm90ZWN0ZWRcbiAgICovXG4gIF9oYW5kbGVLZXlkb3duKCkge1xuICAgIHN1cGVyLl9oYW5kbGVLZXlkb3duKCksIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gXCJrZXlib2FyZFwiO1xuICAgICAgY29uc3QgcyA9IGcoZSk7XG4gICAgICBpZiAodGhpcy5mb2N1c1N0YXRlID09PSBcInNlbGZcIikge1xuICAgICAgICBjb25zdCBuID0gW1wiU3BhY2VcIiwgXCJFbnRlclwiXSwgaSA9IFtcIkVzY2FwZVwiXSwgbyA9IFtcIkVzY2FwZVwiXTtcbiAgICAgICAgdGhpcy5vcHRpb25hbEtleVN1cHBvcnQgPyBbXG4gICAgICAgICAgXCJBcnJvd1VwXCIsXG4gICAgICAgICAgXCJBcnJvd1JpZ2h0XCIsXG4gICAgICAgICAgXCJBcnJvd0Rvd25cIixcbiAgICAgICAgICBcIkFycm93TGVmdFwiLFxuICAgICAgICAgIFwiSG9tZVwiLFxuICAgICAgICAgIFwiRW5kXCJcbiAgICAgICAgXS5pbmNsdWRlcyhzKSAmJiBsKGUpIDogKHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgbi5pbmNsdWRlcyhzKSB8fCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgaS5pbmNsdWRlcyhzKSB8fCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUgJiYgby5pbmNsdWRlcyhzKSkgJiYgbChlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXl1cCBldmVudHMgdGhyb3VnaG91dCB0aGUgbWVudSBmb3IgcHJvcGVyIG1lbnUgdXNlLlxuICAgKlxuICAgKiBBZGRzIGFsbCBga2V5dXBgIGxpc3RlbmVycyBmcm9tIEJhc2VNZW51J3MgX2hhbmRsZUtleXVwIG1ldGhvZC5cbiAgICpcbiAgICogQWRkcyB0aGUgZm9sbG93aW5nIGtleWJpbmRpbmdzIChleHBsYW5hdGlvbnMgYXJlIHRha2VuIGZyb20gdGhlXG4gICAqIFdBSSBBUklBIFByYWNpdGljZXMgRXhhbXBsZSBEaXNjbG9zdXJlIGZvciBOYXZpZ2F0aW9uIE1lbnVzKTpcbiAgICpcbiAgICogfCBLZXkgfCBGdW5jdGlvbiB8XG4gICAqIHwgLS0tIHwgLS0tIHxcbiAgICogfCBfVGFiXyBvciBfU2hpZnQgKyBUYWJfIHwgTW92ZSBrZXlib2FyZCBmb2N1cyBhbW9uZyB0b3AtbGV2ZWwgYnV0dG9ucywgYW5kIGlmIGEgZHJvcGRvd24gaXMgb3BlbiwgaW50byBhbmQgdGhyb3VnaCBsaW5rcyBpbiB0aGUgZHJvcGRvd24uIHxcbiAgICogfCBfU3BhY2VfIG9yIF9FbnRlcl8gfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgZGlzY2xvc3VyZSBidXR0b24sIGFjdGl2YXRlcyB0aGUgYnV0dG9uLCB3aGljaCB0b2dnbGVzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBkcm9wZG93bi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbms6PHVsPjxsaT5JZiBhbnkgbGluayBoYXMgYXJpYS1jdXJyZW50IHNldCwgcmVtb3ZlcyBpdC48L2xpPjxsaT5TZXRzIGFyaWEtY3VycmVudD1cInBhZ2VcIiBvbiB0aGUgZm9jdXNlZCBsaW5rLjwvbGk+PGxpPkFjdGl2YXRlcyB0aGUgZm9jdXNlZCBsaW5rLjwvbGk+PC91bD48L2xpPjwvdWw+IHxcbiAgICogfCBfRXNjYXBlXyB8IElmIGEgZHJvcGRvd24gaXMgb3BlbiwgY2xvc2VzIGl0IGFuZCBzZXRzIGZvY3VzIG9uIHRoZSBidXR0b24gdGhhdCBjb250cm9scyB0aGF0IGRyb3Bkb3duLiB8XG4gICAqIHwgX0Rvd24gQXJyb3dfIG9yIF9SaWdodCBBcnJvd18gKE9wdGlvbmFsfSkgfCA8dWw+PGxpPklmIGZvY3VzIGlzIG9uIGEgYnV0dG9uIGFuZCBpdHMgZHJvcGRvd24gaXMgY29sbGFwc2VkLCBhbmQgaXQgaXMgbm90IHRoZSBsYXN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgYnV0dG9uLjwvbGk+PGxpPmlmIGZvY3VzIGlzIG9uIGEgYnV0dG9uIGFuZCBpdHMgZHJvcGRvd24gaXMgZXhwYW5kZWQsIG1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBsaW5rIGluIHRoZSBkcm9wZG93bi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGxhc3QgbGluaywgbW92ZXMgZm9jdXMgdG8gdGhlIG5leHQgbGluay48L2xpPjwvdWw+IHxcbiAgICogfCBfVXAgQXJyb3dfIG9yIF9MZWZ0IEFycm93XyAoT3B0aW9uYWx9KSB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBidXR0b24sIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIHByZXZpb3VzIGJ1dHRvbi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGxpbmssIG1vdmVzIGZvY3VzIHRvIHRoZSBwcmV2aW91cyBsaW5rLjwvbGk+PC91bD4gfFxuICAgKiB8IF9Ib21lXyAoT3B0aW9uYWx9KSB8IDx1bD48bGk+SWYgZm9jdXMgaXMgb24gYSBidXR0b24sIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGJ1dHRvbiwgbW92ZXMgZm9jdXMgdG8gdGhlIGZpcnN0IGJ1dHRvbi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGZpcnN0IGxpbmssIG1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBsaW5rLjwvbGk+PC91bD4gfFxuICAgKiB8IF9FbmRfIChPcHRpb25hbH0pIHwgPHVsPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGJ1dHRvbiwgYW5kIGl0IGlzIG5vdCB0aGUgbGFzdCBidXR0b24sIG1vdmVzIGZvY3VzIHRvIHRoZSBsYXN0IGJ1dHRvbi48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiBhIGxpbmssIGFuZCBpdCBpcyBub3QgdGhlIGxhc3QgbGluaywgbW92ZXMgZm9jdXMgdG8gdGhlIGxhc3QgbGluay48L2xpPjwvdWw+IHxcbiAgICpcbiAgICogVGhlIG9wdGlvbmFsIGtleWJpbmRpbmdzIGFyZSBjb250cm9sbGVkIGJ5IHRoZSBtZW51J3Mgb3B0aW9uYWxLZXlTdXBwb3J0IHZhbHVlLlxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlS2V5dXAoKSB7XG4gICAgc3VwZXIuX2hhbmRsZUtleXVwKCksIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChlKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIjtcbiAgICAgIGNvbnN0IHMgPSBnKGUpO1xuICAgICAgdGhpcy5mb2N1c1N0YXRlID09PSBcInNlbGZcIiAmJiAocyA9PT0gXCJTcGFjZVwiIHx8IHMgPT09IFwiRW50ZXJcIiA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gPyAobChlKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbiA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5jbG9zZSgpIDogdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKSkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5kb20ubGluay5jbGljaygpIDogcyA9PT0gXCJFc2NhcGVcIiA/IHRoaXMuZWxlbWVudHMuc3VibWVudVRvZ2dsZXMuc29tZShcbiAgICAgICAgKGkpID0+IGkuaXNPcGVuXG4gICAgICApID8gKGwoZSksIHRoaXMuY2xvc2VDaGlsZHJlbigpKSA6IHRoaXMuZWxlbWVudHMucGFyZW50TWVudSA/IChsKGUpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudEV2ZW50ID0gdGhpcy5jdXJyZW50RXZlbnQsIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5jbG9zZUNoaWxkcmVuKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5mb2N1c0N1cnJlbnRDaGlsZCgpKSA6IHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmlzT3BlbiAmJiAodGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmNsb3NlKCksIHRoaXMuZm9jdXNDb250cm9sbGVyKCkpIDogdGhpcy5vcHRpb25hbEtleVN1cHBvcnQgJiYgKHMgPT09IFwiQXJyb3dEb3duXCIgfHwgcyA9PT0gXCJBcnJvd1JpZ2h0XCIgPyAobChlKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuID8gKHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCIsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0ZpcnN0Q2hpbGQoKSkgOiB0aGlzLmZvY3VzTmV4dENoaWxkKCkpIDogcyA9PT0gXCJBcnJvd1VwXCIgfHwgcyA9PT0gXCJBcnJvd0xlZnRcIiA/IChsKGUpLCB0aGlzLmZvY3VzUHJldmlvdXNDaGlsZCgpKSA6IHMgPT09IFwiSG9tZVwiID8gKGwoZSksIHRoaXMuZm9jdXNGaXJzdENoaWxkKCkpIDogcyA9PT0gXCJFbmRcIiAmJiAobChlKSwgdGhpcy5mb2N1c0xhc3RDaGlsZCgpKSkpO1xuICAgIH0pO1xuICB9XG59XG5jbGFzcyBHIGV4dGVuZHMgTCB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBUcmVldmlld0l0ZW1gLlxuICAgKlxuICAgKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBvcHRpb25zIGZvciBnZW5lcmF0aW5nIHRoZSBtZW51IGl0ZW0uXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICAgICBvcHRpb25zLm1lbnVJdGVtRWxlbWVudCAgICAgICAgIC0gVGhlIG1lbnUgaXRlbSBpbiB0aGUgRE9NLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAgICAgb3B0aW9ucy5tZW51TGlua0VsZW1lbnQgICAgICAgICAtIFRoZSBtZW51IGl0ZW0ncyBsaW5rIGluIHRoZSBET00uXG4gICAqIEBwYXJhbSB7VHJlZXZpZXd9ICAgICAgICBvcHRpb25zLnBhcmVudE1lbnUgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICAgICAgW29wdGlvbnMuaXNTdWJtZW51SXRlbSA9IGZhbHNlXSAtIEEgZmxhZyB0byBtYXJrIGlmIHRoZSBtZW51IGl0ZW0gaXMgY29udHJvbGxpbmcgYSBzdWJtZW51LlxuICAgKiBAcGFyYW0gez9UcmVldmlld30gICAgICAgW29wdGlvbnMuY2hpbGRNZW51ID0gbnVsbF0gICAgICAtIFRoZSBjaGlsZCBtZW51LlxuICAgKiBAcGFyYW0gez9UcmVldmlld1RvZ2dsZX0gW29wdGlvbnMudG9nZ2xlID0gbnVsbF0gICAgICAgICAtIFRoZSBjb250cm9sbGVyIGZvciB0aGUgY2hpbGQgbWVudS5cbiAgICogQHBhcmFtIHtib29sZWFufSAgICAgICAgIFtvcHRpb25zLmluaXRpYWxpemUgPSB0cnVlXSAgICAgLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSBpdGVtIGltbWVkaWF0ZWx5IHVwb24gY3JlYXRpb24uXG4gICAqL1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVudUl0ZW1FbGVtZW50OiB0LFxuICAgIG1lbnVMaW5rRWxlbWVudDogZSxcbiAgICBwYXJlbnRNZW51OiBzLFxuICAgIGlzU3VibWVudUl0ZW06IG4gPSAhMSxcbiAgICBjaGlsZE1lbnU6IGkgPSBudWxsLFxuICAgIHRvZ2dsZTogbyA9IG51bGwsXG4gICAgaW5pdGlhbGl6ZTogaCA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51SXRlbUVsZW1lbnQ6IHQsXG4gICAgICBtZW51TGlua0VsZW1lbnQ6IGUsXG4gICAgICBwYXJlbnRNZW51OiBzLFxuICAgICAgaXNTdWJtZW51SXRlbTogbixcbiAgICAgIGNoaWxkTWVudTogaSxcbiAgICAgIHRvZ2dsZTogb1xuICAgIH0pLCBoICYmIHRoaXMuaW5pdGlhbGl6ZSgpO1xuICB9XG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBtZW51IGl0ZW0uXG4gICAqXG4gICAqIEluaXRpYWxpemUgd2lsbCBjYWxsIHRoZSBCYXNlTWVudUl0ZW0ncyBpbml0aWFsaXplIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB0aGUgbWVudSBpdGVtJ3MgYHJvbGVgIHRvIFwibm9uZVwiLFxuICAgKiB0aGUgbWVudSBsaW5rJ3MgYHJvbGVgIHRvIFwidHJlZWl0ZW1cIiwgYW5kXG4gICAqIHRoZSBtZW51IGxpbmsncyBgdGFiSW5kZXhgIHRvIC0xIGluIHRoZSBET00uXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHN1cGVyLmluaXRpYWxpemUoKSwgdGhpcy5kb20uaXRlbS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwibm9uZVwiKSwgdGhpcy5kb20ubGluay5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwidHJlZWl0ZW1cIiksIHRoaXMuZG9tLmxpbmsudGFiSW5kZXggPSAtMTtcbiAgfVxuICAvKipcbiAgICogRm9jdXNlcyB0aGUgbWVudSBpdGVtJ3MgbGluayBpZiB0aGUgcGFyZW50IG1lbnUnc1xuICAgKiBzaG91bGRGb2N1cyB2YWx1ZSBpcyBgdHJ1ZWAuXG4gICAqXG4gICAqIFRoaXMgd2lsbCBjYWxsIHRoZSBCYXNlTWVudUl0ZW0ncyBmb2N1cyBtZXRob2RcbiAgICogYXMgd2VsbCBhcyBzZXQgdGhlIG1lbnUgbGluaydzIGB0YWJJbmRleGAgdG8gMC5cbiAgICovXG4gIGZvY3VzKCkge1xuICAgIHN1cGVyLmZvY3VzKCksIHRoaXMuZG9tLmxpbmsudGFiSW5kZXggPSAwO1xuICB9XG4gIC8qKlxuICAgKiBCbHVycyB0aGUgbWVudSBpdGVtJ3MgbGluayBpZiB0aGUgcGFyZW50IG1lbnUnc1xuICAgKiBzaG91bGRGb2N1cyB2YWx1ZSBpcyBgdHJ1ZWAuXG4gICAqXG4gICAqIFRoaXMgd2lsbCBjYWxsIHRoZSBCYXNlTWVudUl0ZW0ncyBibHVyIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB0aGUgbWVudSBsaW5rJ3MgYHRhYkluZGV4YCB0byAtMS5cbiAgICovXG4gIGJsdXIoKSB7XG4gICAgc3VwZXIuYmx1cigpLCB0aGlzLmRvbS5saW5rLnRhYkluZGV4ID0gLTE7XG4gIH1cbn1cbmNsYXNzIEogZXh0ZW5kcyBBIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgYFRyZWV2aWV3VG9nZ2xlYC5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9ICAgICAgb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgIC0gVGhlIG9wdGlvbnMgZm9yIGdlbmVyYXRpbmcgdGhlIG1lbnUgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBvcHRpb25zLm1lbnVUb2dnbGVFbGVtZW50ICAgLSBUaGUgdG9nZ2xlIGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gb3B0aW9ucy5wYXJlbnRFbGVtZW50ICAgICAgIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgY29udHJvbGxlZCBtZW51LlxuICAgKiBAcGFyYW0ge1RyZWV2aWV3fSAgICBvcHRpb25zLmNvbnRyb2xsZWRNZW51ICAgICAgLSBUaGUgbWVudSBjb250cm9sbGVkIGJ5IHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0gez9UcmVldmlld30gICBbb3B0aW9ucy5wYXJlbnRNZW51ID0gbnVsbF0gLSBUaGUgbWVudSBjb250YWluaW5nIHRoaXMgdG9nZ2xlLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59ICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSB0b2dnbGUgaW1tZWRpYXRlbHkgdXBvbiBjcmVhdGlvbi5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZW51VG9nZ2xlRWxlbWVudDogdCxcbiAgICBwYXJlbnRFbGVtZW50OiBlLFxuICAgIGNvbnRyb2xsZWRNZW51OiBzLFxuICAgIHBhcmVudE1lbnU6IG4gPSBudWxsLFxuICAgIGluaXRpYWxpemU6IGkgPSAhMFxuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbWVudVRvZ2dsZUVsZW1lbnQ6IHQsXG4gICAgICBwYXJlbnRFbGVtZW50OiBlLFxuICAgICAgY29udHJvbGxlZE1lbnU6IHMsXG4gICAgICBwYXJlbnRNZW51OiBuXG4gICAgfSksIGkgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBtZW51IHRvZ2dsZS5cbiAgICpcbiAgICogVGhlIGZpcnN0IHN0ZXBzIGFyZSB0byBlbnN1cmUgdGhhdCB0aGUgdG9nZ2xlIGFuZCBjb250cm9sbGVkIG1lbnUgaGF2ZSBJRHNcbiAgICogdXNpbmcgdGhlIHNldElkcyBtZXRob2QsIGFuZCB0byBzZXQgdGhlIEFSSUEgYXR0cmlidXRlcyBvbiB0aGUgdG9nZ2xlXG4gICAqIGFuZCBjb250cm9sbGVkIG1lbnUgdXNpbmcgdGhlIHNldEFyaWFBdHRyaWJ1dGVzIG1ldGhvZC5cbiAgICpcbiAgICogVGhlbiB0aGUgb3BlbiBvciBjb2xsYXBzZSBtZXRob2QgaXMgY2FsbGVkIGJhc2VkIG9uIHRoZSBzdGF0ZSBvZiB0aGVcbiAgICogdG9nZ2xlJ3MgYXJpYS1leHBhbmRlZCBhdHRyaWJ1dGUuXG4gICAqL1xuICBpbml0aWFsaXplKCkge1xuICAgIHRoaXMuX3NldElkcygpLCB0aGlzLl9zZXRBcmlhQXR0cmlidXRlcygpLCB0aGlzLmRvbS50b2dnbGUuZ2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiKSA9PT0gXCJ0cnVlXCIgPyB0aGlzLm9wZW4oKSA6IHRoaXMuX2NvbGxhcHNlKCExKTtcbiAgfVxuICAvKipcbiAgICogU2V0cyB0aGUgQVJJQSBhdHRyaWJ1dGVzIG9uIHRoZSB0b2dnbGUgYW5kIGNvbnRyb2xsZWQgbWVudS5cbiAgICpcbiAgICogVGhlIGZpcnN0IHN0ZXBzIGFyZSB0byBlbnN1cmUgdGhhdCB0aGUgdG9nZ2xlIGhhcyBgYXJpYS1leHBhbmRlZGBcbiAgICogc2V0IHRvIFwiZmFsc2VcIiBpZiBpdCdzIG5vdCBhbHJlYWR5IHNldCBleHBsaWNpdGx5IHRvIFwidHJ1ZVwiLlxuICAgKlxuICAgKiBUaGVuIHVzaW5nIHRoZSB0b2dnbGUgYW5kIG1lbnUncyBJRHMsIHRoZSBtZW51J3MgYGFyaWEtbGFiZWxsZWRieWAgaXMgc2V0IHRvXG4gICAqIHRoZSB0b2dnbGUncyBJRCwgYW5kIHRoZSB0b2dnbGUncyBgYXJpYS1vd25zYCBpcyBzZXQgdG8gdGhlIG1lbnUncyBJRC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX3NldEFyaWFBdHRyaWJ1dGVzKCkge1xuICAgIHRoaXMuZG9tLnRvZ2dsZS5nZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIpICE9PSBcInRydWVcIiAmJiB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCBcImZhbHNlXCIpLCB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZWRNZW51LmRvbS5tZW51LnNldEF0dHJpYnV0ZShcbiAgICAgIFwiYXJpYS1sYWJlbGxlZGJ5XCIsXG4gICAgICB0aGlzLmRvbS50b2dnbGUuaWRcbiAgICApLCB0aGlzLmRvbS50b2dnbGUuc2V0QXR0cmlidXRlKFxuICAgICAgXCJhcmlhLW93bnNcIixcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbGxlZE1lbnUuZG9tLm1lbnUuaWRcbiAgICApO1xuICB9XG59XG5jbGFzcyB6IGV4dGVuZHMgSSB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIGEgbmV3IGBUcmVldmlld2AuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBUaGUgb3B0aW9ucyBmb3IgZ2VuZXJhdGluZyB0aGUgbWVudS5cbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gICAgICAgIG9wdGlvbnMubWVudUVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAtIFRoZSBtZW51IGVsZW1lbnQgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLm1lbnVJdGVtU2VsZWN0b3IgPSBsaV0gICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIG1lbnUgaXRlbXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICBbb3B0aW9ucy5tZW51TGlua1NlbGVjdG9yID0gYV0gICAgICAgICAgICAgLSBUaGUgcXVlcnkgc2VsZWN0b3Igc3RyaW5nIGZvciBtZW51IGxpbmtzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudUl0ZW1TZWxlY3RvciA9IGxpOmhhcyh1bCldIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3IgbWVudSBpdGVtcyBjb250YWluaW5nIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgW29wdGlvbnMuc3VibWVudVRvZ2dsZVNlbGVjdG9yID0gYV0gICAgICAgIC0gVGhlIHF1ZXJ5IHNlbGVjdG9yIHN0cmluZyBmb3Igc3VibWVudSB0b2dnbGUgYnV0dG9ucy9saW5rcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLnN1Ym1lbnVTZWxlY3RvciA9IHVsXSAgICAgICAgICAgICAtIFRoZSBxdWVyeSBzZWxlY3RvciBzdHJpbmcgZm9yIHN1Ym1lbnVzLlxuICAgKiBAcGFyYW0gez9IVE1MRWxlbWVudH0gICAgICAgW29wdGlvbnMuY29udHJvbGxlckVsZW1lbnQgPSBudWxsXSAgICAgICAgIC0gVGhlIGVsZW1lbnQgY29udHJvbGxpbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/SFRNTEVsZW1lbnR9ICAgICAgIFtvcHRpb25zLmNvbnRhaW5lckVsZW1lbnQgPSBudWxsXSAgICAgICAgICAtIFRoZSBlbGVtZW50IGNvbnRhaW5pbmcgdGhlIG1lbnUgaW4gdGhlIERPTS5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLm9wZW5DbGFzcyA9IHNob3ddICAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcIm9wZW5cIi5cbiAgICogQHBhcmFtIHs/KHN0cmluZ3xzdHJpbmdbXSl9IFtvcHRpb25zLmNsb3NlQ2xhc3MgPSBoaWRlXSAgICAgICAgICAgICAgICAtIFRoZSBjbGFzcyB0byBhcHBseSB3aGVuIGEgbWVudSBpcyBcImNsb3NlZFwiLlxuICAgKiBAcGFyYW0gez8oc3RyaW5nfHN0cmluZ1tdKX0gW29wdGlvbnMudHJhbnNpdGlvbkNsYXNzID0gdHJhbnNpdGlvbmluZ10gIC0gVGhlIGNsYXNzIHRvIGFwcGx5IHdoZW4gYSBtZW51IGlzIHRyYW5zaXRpb25pbmcgYmV0d2VlbiBcIm9wZW5cIiBhbmQgXCJjbG9zZWRcIiBzdGF0ZXMuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5pc1RvcExldmVsID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gbWFyayB0aGUgcm9vdCBtZW51LlxuICAgKiBAcGFyYW0gez9UcmVldmlld30gICAgICAgICAgW29wdGlvbnMucGFyZW50TWVudSA9IG51bGxdICAgICAgICAgICAgICAgIC0gVGhlIHBhcmVudCBtZW51IHRvIHRoaXMgbWVudS5cbiAgICogQHBhcmFtIHtzdHJpbmd9ICAgICAgICAgICAgIFtvcHRpb25zLmhvdmVyVHlwZSA9IG9mZl0gICAgICAgICAgICAgICAgICAtIFRoZSB0eXBlIG9mIGhvdmVyYWJpbGl0eSBhIG1lbnUgaGFzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgW29wdGlvbnMuaG92ZXJEZWxheSA9IDI1MF0gICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBvcGVuaW5nIGFuZCBjbG9zaW5nIG1lbnVzIGlmIHRoZSBtZW51IGlzIGhvdmVyYWJsZSAoaW4gbWlsaXNlY29uZHMpLlxuICAgKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgW29wdGlvbnMuZW50ZXJEZWxheSA9IC0xXSAgICAgICAgICAgICAgICAgIC0gVGhlIGRlbGF5IGZvciBvcGVuaW5nIGEgbWVudSBpZiB0aGUgbWVudSBpcyBmb2N1c2FibGUgKGluIG1pbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgIFtvcHRpb25zLmxlYXZlRGVsYXkgPSAtMV0gICAgICAgICAgICAgICAgICAtIFRoZSBkZWxheSBmb3IgY2xvc2luZyBhIG1lbnUgaWYgdGhlIG1lbnUgaXMgZm9jdXNhYmxlIChpbiBtaWxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gICAgICAgICAgICBbb3B0aW9ucy5pbml0aWFsaXplID0gdHJ1ZV0gICAgICAgICAgICAgICAgLSBBIGZsYWcgdG8gaW5pdGlhbGl6ZSB0aGUgbWVudSBpbW1lZGlhdGVseSB1cG9uIGNyZWF0aW9uLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lbnVFbGVtZW50OiBlLFxuICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMgPSBcImxpXCIsXG4gICAgbWVudUxpbmtTZWxlY3RvcjogbiA9IFwiYVwiLFxuICAgIHN1Ym1lbnVJdGVtU2VsZWN0b3I6IGkgPSBcImxpOmhhcyh1bClcIixcbiAgICBzdWJtZW51VG9nZ2xlU2VsZWN0b3I6IG8gPSBcImFcIixcbiAgICBzdWJtZW51U2VsZWN0b3I6IGggPSBcInVsXCIsXG4gICAgY29udHJvbGxlckVsZW1lbnQ6IG0gPSBudWxsLFxuICAgIGNvbnRhaW5lckVsZW1lbnQ6IGMgPSBudWxsLFxuICAgIG9wZW5DbGFzczogYSA9IFwic2hvd1wiLFxuICAgIGNsb3NlQ2xhc3M6IGQgPSBcImhpZGVcIixcbiAgICB0cmFuc2l0aW9uQ2xhc3M6IGYgPSBcInRyYW5zaXRpb25pbmdcIixcbiAgICBpc1RvcExldmVsOiB5ID0gITAsXG4gICAgcGFyZW50TWVudTogTSA9IG51bGwsXG4gICAgaG92ZXJUeXBlOiBiID0gXCJvZmZcIixcbiAgICBob3ZlckRlbGF5OiBfID0gMjUwLFxuICAgIGVudGVyRGVsYXk6IEMgPSAtMSxcbiAgICBsZWF2ZURlbGF5OiBFID0gLTEsXG4gICAgaW5pdGlhbGl6ZTogVCA9ICEwXG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBtZW51RWxlbWVudDogZSxcbiAgICAgIG1lbnVJdGVtU2VsZWN0b3I6IHMsXG4gICAgICBtZW51TGlua1NlbGVjdG9yOiBuLFxuICAgICAgc3VibWVudUl0ZW1TZWxlY3RvcjogaSxcbiAgICAgIHN1Ym1lbnVUb2dnbGVTZWxlY3RvcjogbyxcbiAgICAgIHN1Ym1lbnVTZWxlY3RvcjogaCxcbiAgICAgIGNvbnRyb2xsZXJFbGVtZW50OiBtLFxuICAgICAgY29udGFpbmVyRWxlbWVudDogYyxcbiAgICAgIG9wZW5DbGFzczogYSxcbiAgICAgIGNsb3NlQ2xhc3M6IGQsXG4gICAgICB0cmFuc2l0aW9uQ2xhc3M6IGYsXG4gICAgICBpc1RvcExldmVsOiB5LFxuICAgICAgcGFyZW50TWVudTogTSxcbiAgICAgIGhvdmVyVHlwZTogYixcbiAgICAgIGhvdmVyRGVsYXk6IF8sXG4gICAgICBlbnRlckRlbGF5OiBDLFxuICAgICAgbGVhdmVEZWxheTogRVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyB0byB1c2Ugd2hlbiBnZW5lcmF0aW5nIHN1Ym1lbnVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUcmVldmlld31cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVUeXBlXCIsIHopO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdXNlLWJlZm9yZS1kZWZpbmVcbiAgICAvKipcbiAgICAgKiBUaGUgY2xhc3MgdG8gdXNlIHdoZW4gZ2VuZXJhdGluZyBtZW51IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUcmVldmlld0l0ZW19XG4gICAgICovXG4gICAgdSh0aGlzLCBcIl9NZW51SXRlbVR5cGVcIiwgRyk7XG4gICAgLyoqXG4gICAgICogVGhlIGNsYXNzIHRvIHVzZSB3aGVuIGdlbmVyYXRpbmcgc3VibWVudSB0b2dnbGVzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqXG4gICAgICogQHR5cGUge3R5cGVvZiBUcmVldmlld1RvZ2dsZX1cbiAgICAgKi9cbiAgICB1KHRoaXMsIFwiX01lbnVUb2dnbGVUeXBlXCIsIEopO1xuICAgIFQgJiYgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBtZW51LlxuICAgKlxuICAgKiBJbml0aWFsaXplIHdpbGwgY2FsbCB0aGUgQmFzZU1lbnUncyBpbml0aWFsaXplIG1ldGhvZFxuICAgKiBhcyB3ZWxsIGFzIHNldCB1cCBmb2N1cyxcbiAgICogY2xpY2ssXG4gICAqIGhvdmVyLFxuICAgKiBrZXlkb3duLCBhbmRcbiAgICoga2V5dXAgZXZlbnRzIGZvciB0aGUgbWVudS5cbiAgICpcbiAgICogSWYgdGhlIG1lbnUgaXMgYSByb290IG1lbnUgaXQncyBgcm9sZWAgd2lsbCBiZSBzZXQgdG8gXCJ0cmVlXCIgYW5kIHRoZSBmaXJzdFxuICAgKiBtZW51IGl0ZW0ncyBgdGFiSW5kZXhgIHdpbGwgYmUgc2V0IHRvIDAgaW4gdGhlIERPTS5cbiAgICpcbiAgICogSWYgdGhlIG1lbnUgaXMgX25vdF8gYSByb290IG1lbnUgaXQncyBgcm9sZWAgd2lsbCBiZSBzZXQgdG8gXCJncm91cFwiLlxuICAgKlxuICAgKiBJZiB0aGUgQmFzZU1lbnUncyBpbml0aWFsaXplIG1ldGhvZCB0aHJvd3MgYW4gZXJyb3IsXG4gICAqIHRoaXMgd2lsbCBjYXRjaCBpdCBhbmQgbG9nIGl0IHRvIHRoZSBjb25zb2xlLlxuICAgKi9cbiAgaW5pdGlhbGl6ZSgpIHtcbiAgICB0cnkge1xuICAgICAgc3VwZXIuaW5pdGlhbGl6ZSgpLCB0aGlzLmlzVG9wTGV2ZWwgPyAodGhpcy5kb20ubWVudS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwidHJlZVwiKSwgdGhpcy5lbGVtZW50cy5tZW51SXRlbXNbMF0uZG9tLmxpbmsudGFiSW5kZXggPSAwKSA6IHRoaXMuZG9tLm1lbnUuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImdyb3VwXCIpLCB0aGlzLl9oYW5kbGVGb2N1cygpLCB0aGlzLl9oYW5kbGVDbGljaygpLCB0aGlzLl9oYW5kbGVIb3ZlcigpLCB0aGlzLl9oYW5kbGVLZXlkb3duKCksIHRoaXMuX2hhbmRsZUtleXVwKCksIHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmRvbS50b2dnbGUucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1vd25zXCIpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIGhvdmVyIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgdXNlLlxuICAgKlxuICAgKiBBZGRzIGBwb2ludGVyZW50ZXJgIGxpc3RlbmVycyB0byBhbGwgbWVudSBpdGVtcyBhbmQgYHBvaW50ZXJsZWF2ZWAgbGlzdGVuZXJzXG4gICAqIHRvIGFsbCBzdWJtZW51IGl0ZW1zIHdoaWNoIGZ1bmN0aW9uIGRpZmZlcmVudGx5IGRlcGVuZGluZyBvblxuICAgKiB0aGUgbWVudSdzIGhvdmVyIHR5cGUuXG4gICAqXG4gICAqIEJlZm9yZSBleGVjdXRpbmcgYW55dGhpbmcsIHRoZSBldmVudCBpcyBjaGVja2VkIHRvIG1ha2Ugc3VyZSB0aGUgZXZlbnQgd2Fzbid0XG4gICAqIHRyaWdnZXJlZCBieSBhIHBlbiBvciB0b3VjaC5cbiAgICpcbiAgICogPHN0cm9uZz5Ib3ZlciBUeXBlIFwib25cIjwvc3Ryb25nPlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhbnkgbWVudSBpdGVtIHRoZSBtZW51J3NcbiAgICogICAgY3VycmVudCBjaGlsZCB2YWx1ZSB3aWxsIGNoYW5nZSB0byB0aGF0XG4gICAqICAgbWVudSBpdGVtLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmVudGVyYCBldmVudCB0cmlnZ2VycyBvbiBhIHN1Ym1lbnUgaXRlbSB0aGVcbiAgICogICBwcmV2aWV3IG1ldGhvZCBmb3IgdGhlIHN1Ym1lbnUgaXRlbSdzXG4gICAqICAgdG9nZ2xlIHdpbGwgYmUgY2FsbGVkLlxuICAgKiAtIFdoZW4gYSBgcG9pbnRlcmxlYXZlYCBldmVudCB0cmlnZ2VycyBvbiB0aGUgbWVudSBpdHNlbGYgdGhlXG4gICAqICAgY2xvc2VDaGlsZHJlbiBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgYSBkZWxheVxuICAgKiAgIHNldCBieSB0aGUgbWVudSdzIGhvdmVyIGRlbGF5LlxuICAgKlxuICAgKiA8c3Ryb25nPkhvdmVyIFR5cGUgXCJkeW5hbWljXCI8L3N0cm9uZz5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSB0aGUgbWVudSdzXG4gICAqICAgY3VycmVudCBjaGlsZCB2YWx1ZSB3aWxsIGNoYW5nZSB0byB0aGF0IG1lbnUgaXRlbS5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYW55IG1lbnUgaXRlbSwgYW5kIHRoZSBtZW51J3NcbiAgICogICBmb2N1cyBzdGF0ZSBpcyBub3QgXCJub25lXCIsIHRoZSBtZW51IGl0ZW1cbiAgICogICB3aWxsIGJlIGZvY3VzZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgc3VibWVudSBpdGVtLCBhbmQgYSBzdWJtZW51IGlzXG4gICAqICAgYWxyZWFkeSBvcGVuLCB0aGUgcHJldmlldyBtZXRob2QgZm9yIHRoZSBzdWJtZW51IGl0ZW0ncyB0b2dnbGUgd2lsbCBiZSBjYWxsZWQuXG4gICAqIC0gV2hlbiBhIGBwb2ludGVyZW50ZXJgIGV2ZW50IHRyaWdnZXJzIG9uIGEgbm9uLXN1Ym1lbnUgaXRlbSwgYW5kIGEgc3VibWVudVxuICAgKiAgIGlzIGFscmVhZHkgb3BlbiwgdGhlIGNsb3NlQ2hpbGRyZW4gbWV0aG9kIGZvciB0aGUgbWVudSB3aWxsIGJlIGNhbGxlZC5cbiAgICogLSBXaGVuIGEgYHBvaW50ZXJlbnRlcmAgZXZlbnQgdHJpZ2dlcnMgb24gYSBzdWJtZW51IGl0ZW0sIGFuZCBubyBzdWJtZW51IGlzXG4gICAqICAgb3Blbiwgbm8gc3VibWVudS1zcGVjaWZpYyBtZXRob2RzIHdpbGwgYmUgY2FsbGVkLlxuICAgKlxuICAgKiA8c3Ryb25nPkhvdmVyIFR5cGUgXCJvZmZcIjwvc3Ryb25nPlxuICAgKiBBbGwgYHBvaW50ZXJlbnRlcmAgYW5kIGBwb2ludGVybGVhdmVgIGV2ZW50cyBhcmUgaWdub3JlZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUhvdmVyKCkge1xuICAgIHRoaXMuZWxlbWVudHMubWVudUl0ZW1zLmZvckVhY2goKGUsIHMpID0+IHtcbiAgICAgIGUuZG9tLmxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJlbnRlclwiLCAobikgPT4ge1xuICAgICAgICBuLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IG4ucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCAodGhpcy5ob3ZlclR5cGUgPT09IFwib25cIiA/ICh0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIiwgdGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyQ2hpbGRyZW4oKSwgdGhpcy5mb2N1c0NoaWxkKHMpLCBlLmlzU3VibWVudUl0ZW0gJiYgKHRoaXMuZW50ZXJEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGUuZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKTtcbiAgICAgICAgfSwgdGhpcy5lbnRlckRlbGF5KSkgOiBlLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkpKSA6IHRoaXMuaG92ZXJUeXBlID09PSBcImR5bmFtaWNcIiAmJiAodGhpcy5jdXJyZW50Q2hpbGQgPSBzLCAoIXRoaXMuaXNUb3BMZXZlbCB8fCB0aGlzLmZvY3VzU3RhdGUgIT09IFwibm9uZVwiKSAmJiAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKSksICghdGhpcy5pc1RvcExldmVsIHx8IHRoaXMuaGFzT3BlbmVkKSAmJiAodGhpcy5jdXJyZW50RXZlbnQgPSBcIm1vdXNlXCIsIHRoaXMuZWxlbWVudHMucm9vdE1lbnUuYmx1ckNoaWxkcmVuKCksIHRoaXMuZm9jdXNDdXJyZW50Q2hpbGQoKSwgZS5pc1N1Ym1lbnVJdGVtID8gdGhpcy5lbnRlckRlbGF5ID4gMCA/ICh0aGlzLl9jbGVhclRpbWVvdXQoKSwgdGhpcy5fc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgZS5lbGVtZW50cy50b2dnbGUucHJldmlldygpO1xuICAgICAgICB9LCB0aGlzLmVudGVyRGVsYXkpKSA6IGUuZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKSA6IHRoaXMuZW50ZXJEZWxheSA+IDAgJiYgdGhpcy5fY2xlYXJUaW1lb3V0KCkpKSk7XG4gICAgICB9KSwgZS5pc1N1Ym1lbnVJdGVtICYmIChlLmRvbS5pdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybGVhdmVcIiwgKG4pID0+IHtcbiAgICAgICAgbi5wb2ludGVyVHlwZSA9PT0gXCJwZW5cIiB8fCBuLnBvaW50ZXJUeXBlID09PSBcInRvdWNoXCIgfHwgKHRoaXMuaG92ZXJUeXBlID09PSBcIm9uXCIgPyB0aGlzLmxlYXZlRGVsYXkgPiAwICYmIHRoaXMuX2NsZWFyVGltZW91dCgpIDogdGhpcy5ob3ZlclR5cGUgPT09IFwiZHluYW1pY1wiICYmICh0aGlzLmxlYXZlRGVsYXkgPiAwID8gKHRoaXMuX2NsZWFyVGltZW91dCgpLCB0aGlzLl9zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIjtcbiAgICAgICAgfSwgdGhpcy5sZWF2ZURlbGF5KSkgOiB0aGlzLmN1cnJlbnRFdmVudCA9IFwibW91c2VcIikpO1xuICAgICAgfSksIGUuZG9tLml0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJlbnRlclwiLCAobikgPT4ge1xuICAgICAgICBuLnBvaW50ZXJUeXBlID09PSBcInBlblwiIHx8IG4ucG9pbnRlclR5cGUgPT09IFwidG91Y2hcIiB8fCBlLmlzU3VibWVudUl0ZW0gJiYgKHRoaXMuaG92ZXJUeXBlID09PSBcIm9uXCIgfHwgdGhpcy5ob3ZlclR5cGUgPT09IFwiZHluYW1pY1wiKSAmJiB0aGlzLmxlYXZlRGVsYXkgPiAwICYmIHRoaXMuX2NsZWFyVGltZW91dCgpO1xuICAgICAgfSkpLCB0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmxlYXZlXCIsIChuKSA9PiB7XG4gICAgICAgIG4ucG9pbnRlclR5cGUgPT09IFwicGVuXCIgfHwgbi5wb2ludGVyVHlwZSA9PT0gXCJ0b3VjaFwiIHx8IHRoaXMuaG92ZXJUeXBlID09PSBcIm9uXCIgJiYgKHRoaXMubGVhdmVEZWxheSA+IDAgPyAodGhpcy5fY2xlYXJUaW1lb3V0KCksIHRoaXMuX3NldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY2xvc2VDaGlsZHJlbigpLCB0aGlzLmJsdXIoKTtcbiAgICAgICAgfSwgdGhpcy5sZWF2ZURlbGF5KSkgOiAodGhpcy5jbG9zZUNoaWxkcmVuKCksIHRoaXMuYmx1cigpKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogSGFuZGxlcyBrZXlkb3duIGV2ZW50cyB0aHJvdWdob3V0IHRoZSBtZW51IGZvciBwcm9wZXIgbWVudSB1c2UuXG4gICAqXG4gICAqIFRoaXMgbWV0aG9kIGV4aXN0cyB0byBhc3Npc3QgdGhlIF9oYW5kbGVLZXl1cCBtZXRob2QuXG4gICAqIC0gQWRkcyBhbGwgYGtleWRvd25gIGxpc3RlbmVycyBmcm9tIEJhc2VNZW51J3MgX2hhbmRsZUtleWRvd24gbWV0aG9kXG4gICAqIC0gQWRkcyBhIGBrZXlkb3duYCBsaXN0ZW5lciB0byB0aGUgbWVudS9hbGwgc3VibWVudXMuXG4gICAqICAgLSBCbG9ja3MgcHJvcGFnYXRpb24gb24gdGhlIGZvbGxvd2luZyBrZXlzOiBcIkFycm93VXBcIiwgXCJBcnJvd1JpZ2h0XCIsXG4gICAqICAgICBcIkFycm93RG93blwiLCBcIkFycm93TGVmdFwiLCBcIkhvbWVcIiwgXCJFbmRcIiwgXCJTcGFjZVwiLCBcIkVudGVyXCIsIFwiRXNjYXBlXCIsXG4gICAqICAgICBcIipcIiAoYXN0ZXJpc2spLCBhbmQgXCJBXCIgdGhyb3VnaCBcIlpcIi5cbiAgICogICAtIE1vdmVzIGZvY3VzIG91dCBpZiB0aGUgXCJUYWJcIiBrZXkgaXMgcHJlc3NlZC5cbiAgICpcbiAgICogQHByb3RlY3RlZFxuICAgKi9cbiAgX2hhbmRsZUtleWRvd24oKSB7XG4gICAgc3VwZXIuX2hhbmRsZUtleWRvd24oKSwgdGhpcy5kb20ubWVudS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50RXZlbnQgPSBcImtleWJvYXJkXCI7XG4gICAgICBjb25zdCBzID0gZyhlKTtcbiAgICAgIGlmIChzID09PSBcIlRhYlwiICYmICh0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmZvY3VzU3RhdGUgIT09IFwibm9uZVwiID8gdGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyKCkgOiB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmZvY3VzKCkpLCB0aGlzLmZvY3VzU3RhdGUgPT09IFwic2VsZlwiKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXG4gICAgICAgICAgXCJTcGFjZVwiLFxuICAgICAgICAgIFwiQXJyb3dVcFwiLFxuICAgICAgICAgIFwiQXJyb3dEb3duXCIsXG4gICAgICAgICAgXCJBcnJvd0xlZnRcIixcbiAgICAgICAgICBcIkFzdGVyaXNrXCIsXG4gICAgICAgICAgXCJIb21lXCIsXG4gICAgICAgICAgXCJFbmRcIlxuICAgICAgICBdLCBpID0gW1wiRW50ZXJcIiwgXCJBcnJvd1JpZ2h0XCJdLCBvID0gW1wiRXNjYXBlXCJdO1xuICAgICAgICAobi5pbmNsdWRlcyhzKSB8fCB0aGlzLmN1cnJlbnRNZW51SXRlbS5pc1N1Ym1lbnVJdGVtICYmIGkuaW5jbHVkZXMocykgfHwgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyICYmIG8uaW5jbHVkZXMocykpICYmIGwoZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMga2V5dXAgZXZlbnRzIHRocm91Z2hvdXQgdGhlIG1lbnUgZm9yIHByb3BlciBtZW51IHVzZS5cbiAgICpcbiAgICogQWRkcyBhbGwgYGtleXVwYCBsaXN0ZW5lcnMgZnJvbSBCYXNlTWVudSdzIF9oYW5kbGVLZXl1cCBtZXRob2QuXG4gICAqXG4gICAqIEFkZHMgdGhlIGZvbGxvd2luZyBrZXliaW5kaW5ncyAoZXhwbGFuYXRpb25zIGFyZSB0YWtlbiBmcm9tIHRoZVxuICAgKiBOYXZpZ2F0aW9uIFRyZWV2aWV3IEV4YW1wbGUgVXNpbmcgQ29tcHV0ZWQgUHJvcGVydGllcyk6XG4gICAqXG4gICAqIHwgS2V5IHwgRnVuY3Rpb24gfFxuICAgKiB8IC0tLSB8IC0tLSB8XG4gICAqIHwgX0VudGVyXyBvciBfU3BhY2VfIHwgUGVyZm9ybXMgdGhlIGRlZmF1bHQgYWN0aW9uIChlLmcuIG9uY2xpY2sgZXZlbnQpIGZvciB0aGUgZm9jdXNlZCBub2RlLiB8XG4gICAqIHwgX0Rvd24gYXJyb3dfIHwgPHVsPjxsaT5Nb3ZlcyBmb2N1cyB0byB0aGUgbmV4dCBub2RlIHRoYXQgaXMgZm9jdXNhYmxlIHdpdGhvdXQgb3BlbmluZyBvciBjbG9zaW5nIGEgbm9kZS48L2xpPjxsaT5JZiBmb2N1cyBpcyBvbiB0aGUgbGFzdCBub2RlLCBkb2VzIG5vdGhpbmcuPC9saT48L3VsPiB8XG4gICAqIHwgX1VwIGFycm93XyB8IDx1bD48bGk+TW92ZXMgZm9jdXMgdG8gdGhlIHByZXZpb3VzIG5vZGUgdGhhdCBpcyBmb2N1c2FibGUgd2l0aG91dCBvcGVuaW5nIG9yIGNsb3NpbmcgYSBub2RlLjwvbGk+PGxpPklmIGZvY3VzIGlzIG9uIHRoZSBmaXJzdCBub2RlLCBkb2VzIG5vdGhpbmcuPC9saT48L3VsPiB8XG4gICAqIHwgX1JpZ2h0IGFycm93XyB8IDx1bD48bGk+V2hlbiBmb2N1cyBpcyBvbiBhIGNsb3NlZCBub2RlLCBvcGVucyB0aGUgbm9kZTsgZm9jdXMgZG9lcyBub3QgbW92ZS48L2xpPjxsaT5XaGVuIGZvY3VzIGlzIG9uIGEgb3BlbiBub2RlLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgY2hpbGQgbm9kZS48L2xpPjxsaT5XaGVuIGZvY3VzIGlzIG9uIGFuIGVuZCBub2RlLCBkb2VzIG5vdGhpbmcuPC9saT48L3VsPiB8XG4gICAqIHwgX0xlZnQgYXJyb3dfIHwgPHVsPjxsaT5XaGVuIGZvY3VzIGlzIG9uIGFuIG9wZW4gbm9kZSwgY2xvc2VzIHRoZSBub2RlLjwvbGk+PGxpPldoZW4gZm9jdXMgaXMgb24gYSBjaGlsZCBub2RlIHRoYXQgaXMgYWxzbyBlaXRoZXIgYW4gZW5kIG5vZGUgb3IgYSBjbG9zZWQgbm9kZSwgbW92ZXMgZm9jdXMgdG8gaXRzIHBhcmVudCBub2RlLjwvbGk+PGxpPldoZW4gZm9jdXMgaXMgb24gYSByb290IG5vZGUgdGhhdCBpcyBhbHNvIGVpdGhlciBhbiBlbmQgbm9kZSBvciBhIGNsb3NlZCBub2RlLCBkb2VzIG5vdGhpbmcuPC9saT48L3VsPiB8XG4gICAqIHwgX0hvbWVfIHwgTW92ZXMgZm9jdXMgdG8gZmlyc3Qgbm9kZSB3aXRob3V0IG9wZW5pbmcgb3IgY2xvc2luZyBhIG5vZGUuIHxcbiAgICogfCBfRW5kXyB8IE1vdmVzIGZvY3VzIHRvIHRoZSBsYXN0IG5vZGUgdGhhdCBjYW4gYmUgZm9jdXNlZCB3aXRob3V0IGV4cGFuZGluZyBhbnkgbm9kZXMgdGhhdCBhcmUgY2xvc2VkLiB8XG4gICAqIHwgX2Etel8sIF9BLVpfIHwgPHVsPjxsaT5Gb2N1cyBtb3ZlcyB0byB0aGUgbmV4dCBub2RlIHdpdGggYSBuYW1lIHRoYXQgc3RhcnRzIHdpdGggdGhlIHR5cGVkIGNoYXJhY3Rlci48L2xpPjxsaT5TZWFyY2ggd3JhcHMgdG8gZmlyc3Qgbm9kZSBpZiBhIG1hdGNoaW5nIG5hbWUgaXMgbm90IGZvdW5kIGFtb25nIHRoZSBub2RlcyB0aGF0IGZvbGxvdyB0aGUgZm9jdXNlZCBub2RlLjwvbGk+PGxpPlNlYXJjaCBpZ25vcmVzIG5vZGVzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIGNsb3NlZCBub2Rlcy48L2xpPjwvdWw+IHxcbiAgICogfCBfKiAoYXN0ZXJpc2spXyB8IDx1bD48bGk+RXhwYW5kcyBhbGwgY2xvc2VkIHNpYmxpbmcgbm9kZXMgdGhhdCBhcmUgYXQgdGhlIHNhbWUgbGV2ZWwgYXMgdGhlIGZvY3VzZWQgbm9kZS48L2xpPjxsaT5Gb2N1cyBkb2VzIG5vdCBtb3ZlLjwvbGk+PC91bD4gfFxuICAgKiB8IF9Fc2NhcGVfIHwgSWYgdGhlIHJvb3QgbWVudSBpcyBjb2xsYXBzaWJsZSwgY29sbGFwc2VzIHRoZSBtZW51IGFuZCBmb2N1c2VzIHRoZSBtZW51J3MgY29udHJvbGxpbmcgZWxlbWVudC4gfFxuICAgKlxuICAgKiBAcHJvdGVjdGVkXG4gICAqL1xuICBfaGFuZGxlS2V5dXAoKSB7XG4gICAgc3VwZXIuX2hhbmRsZUtleXVwKCksIHRoaXMuZG9tLm1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChlKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRFdmVudCA9IFwia2V5Ym9hcmRcIjtcbiAgICAgIGNvbnN0IHMgPSBnKGUpLCB7IGFsdEtleTogbiwgY3J0bEtleTogaSwgbWV0YUtleTogbyB9ID0gZTtcbiAgICAgIGlmIChzID09PSBcIkNoYXJhY3RlclwiICYmICEobiB8fCBpIHx8IG8pKVxuICAgICAgICBsKGUpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmN1cnJlbnRFdmVudCA9IFwiY2hhcmFjdGVyXCIsIHRoaXMuZm9jdXNOZXh0Tm9kZVdpdGhDaGFyYWN0ZXIoZS5rZXkpO1xuICAgICAgZWxzZSBpZiAodGhpcy5mb2N1c1N0YXRlID09PSBcInNlbGZcIilcbiAgICAgICAgaWYgKHMgPT09IFwiRW50ZXJcIiB8fCBzID09PSBcIlNwYWNlXCIpXG4gICAgICAgICAgbChlKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSA/IHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSA6IHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLnRvZ2dsZS5wcmV2aWV3KCkgOiB0aGlzLmN1cnJlbnRNZW51SXRlbS5kb20ubGluay5jbGljaygpO1xuICAgICAgICBlbHNlIGlmIChzID09PSBcIkVzY2FwZVwiKVxuICAgICAgICAgIHRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmVsZW1lbnRzLmNvbnRyb2xsZXIgJiYgdGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmlzT3BlbiAmJiAodGhpcy5lbGVtZW50cy5jb250cm9sbGVyLmNsb3NlKCksIHRoaXMuZm9jdXNDb250cm9sbGVyKCkpO1xuICAgICAgICBlbHNlIGlmIChzID09PSBcIkFycm93RG93blwiKVxuICAgICAgICAgIGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbiA/ICh0aGlzLmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNGaXJzdENoaWxkKCkpIDogIXRoaXMuaXNUb3BMZXZlbCAmJiB0aGlzLmN1cnJlbnRDaGlsZCA9PT0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXMubGVuZ3RoIC0gMSA/IHRoaXMuZm9jdXNQYXJlbnRzTmV4dENoaWxkKCkgOiB0aGlzLmZvY3VzTmV4dENoaWxkKCk7XG4gICAgICAgIGVsc2UgaWYgKHMgPT09IFwiQXJyb3dVcFwiKSB7XG4gICAgICAgICAgbChlKTtcbiAgICAgICAgICBjb25zdCBtID0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXNbdGhpcy5jdXJyZW50Q2hpbGQgLSAxXTtcbiAgICAgICAgICBtICYmIG0uaXNTdWJtZW51SXRlbSAmJiBtLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gPyAodGhpcy5ibHVyQ3VycmVudENoaWxkKCksIHRoaXMuY3VycmVudENoaWxkID0gdGhpcy5jdXJyZW50Q2hpbGQgLSAxLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gdGhpcy5jdXJyZW50RXZlbnQsIHRoaXMuZm9jdXNDaGlsZHNMYXN0Tm9kZSgpKSA6ICF0aGlzLmlzVG9wTGV2ZWwgJiYgdGhpcy5jdXJyZW50Q2hpbGQgPT09IDAgPyAodGhpcy5ibHVyQ3VycmVudENoaWxkKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50RXZlbnQgPSB0aGlzLmN1cnJlbnRFdmVudCwgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51LmZvY3VzQ3VycmVudENoaWxkKCkpIDogdGhpcy5mb2N1c1ByZXZpb3VzQ2hpbGQoKTtcbiAgICAgICAgfSBlbHNlIHMgPT09IFwiQXJyb3dSaWdodFwiID8gdGhpcy5jdXJyZW50TWVudUl0ZW0uaXNTdWJtZW51SXRlbSAmJiAobChlKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbiA/ICh0aGlzLmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNGaXJzdENoaWxkKCkpIDogdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLnByZXZpZXcoKSkgOiBzID09PSBcIkFycm93TGVmdFwiID8gKGwoZSksIHRoaXMuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMudG9nZ2xlLmlzT3BlbiA/ICh0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuY2xvc2UoKSkgOiB0aGlzLmlzVG9wTGV2ZWwgfHwgKHRoaXMuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudEV2ZW50ID0gdGhpcy5jdXJyZW50RXZlbnQsIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5mb2N1c0N1cnJlbnRDaGlsZCgpKSkgOiBzID09PSBcIkhvbWVcIiA/IChsKGUpLCB0aGlzLmJsdXJDdXJyZW50Q2hpbGQoKSwgdGhpcy5lbGVtZW50cy5yb290TWVudS5mb2N1c0ZpcnN0Q2hpbGQoKSkgOiBzID09PSBcIkVuZFwiID8gKGwoZSksIHRoaXMuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmVsZW1lbnRzLnJvb3RNZW51LmZvY3VzTGFzdE5vZGUoKSkgOiBzID09PSBcIkFzdGVyaXNrXCIgJiYgKGwoZSksIHRoaXMub3BlbkNoaWxkcmVuKCkpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBGb2N1cyB0aGUgbWVudSdzIGxhc3Qgbm9kZSBvZiB0aGUgZW50aXJlIGV4cGFuZGVkIG1lbnUuXG4gICAqXG4gICAqIFRoaXMgaW5jbHVkZXMgYWxsIF9vcGVuXyBjaGlsZCBtZW51IGl0ZW1zLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c0xhc3ROb2RlKCkge1xuICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzLm1lbnVJdGVtcy5sZW5ndGggLSAxLCBzID0gdGhpcy5lbGVtZW50cy5tZW51SXRlbXNbZV07XG4gICAgcy5pc1N1Ym1lbnVJdGVtICYmIHMuZWxlbWVudHMudG9nZ2xlLmlzT3BlbiA/ICh0aGlzLmN1cnJlbnRDaGlsZCA9IGUsIHMuZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRFdmVudCA9IHRoaXMuY3VycmVudEV2ZW50LCBzLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0xhc3ROb2RlKCkpIDogdGhpcy5mb2N1c0xhc3RDaGlsZCgpO1xuICB9XG4gIC8qKlxuICAgKiBPcGVuIGFsbCBzdWJtZW51IGNoaWxkcmVuLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBvcGVuQ2hpbGRyZW4oKSB7XG4gICAgdGhpcy5lbGVtZW50cy5zdWJtZW51VG9nZ2xlcy5mb3JFYWNoKChlKSA9PiBlLnByZXZpZXcoKSk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBtZW51J3MgbmV4dCBub2RlIHN0YXJ0aW5nIHdpdGggYSBzcGVjaWZpYyBsZXR0ZXIuXG4gICAqXG4gICAqIFRoaXMgaW5jbHVkZXMgYWxsIF9vcGVuXyBjaGlsZCBtZW51IGl0ZW1zLlxuICAgKlxuICAgKiBXcmFwcyB0byB0aGUgZmlyc3Qgbm9kZSBpZiBubyBtYXRjaCBpcyBmb3VuZCBhZnRlciB0aGUgY3VycmVudCBub2RlLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFyIC0gVGhlIGNoYXJhY3RlciB0byBsb29rIGZvci5cbiAgICovXG4gIGZvY3VzTmV4dE5vZGVXaXRoQ2hhcmFjdGVyKGUpIHtcbiAgICBmdW5jdGlvbiBzKGEpIHtcbiAgICAgIGxldCBkID0gW107XG4gICAgICByZXR1cm4gYS5lbGVtZW50cy5tZW51SXRlbXMuZm9yRWFjaCgoZikgPT4ge1xuICAgICAgICBkLnB1c2goZiksIGYuaXNTdWJtZW51SXRlbSAmJiBmLmVsZW1lbnRzLnRvZ2dsZS5pc09wZW4gJiYgKGQgPSBbXG4gICAgICAgICAgLi4uZCxcbiAgICAgICAgICAuLi5zKFxuICAgICAgICAgICAgZi5lbGVtZW50cy50b2dnbGUuZWxlbWVudHMuY29udHJvbGxlZE1lbnVcbiAgICAgICAgICApXG4gICAgICAgIF0pO1xuICAgICAgfSksIGQ7XG4gICAgfVxuICAgIGNvbnN0IG4gPSBlLnRvTG93ZXJDYXNlKCksIGkgPSBzKHRoaXMuZWxlbWVudHMucm9vdE1lbnUpLCBvID0gaS5pbmRleE9mKHRoaXMuY3VycmVudE1lbnVJdGVtKSArIDEsIGggPSBbXG4gICAgICAuLi5pLnNsaWNlKG8pLFxuICAgICAgLi4uaS5zbGljZSgwLCBvKVxuICAgIF07XG4gICAgbGV0IG0gPSAwLCBjID0gITE7XG4gICAgZm9yICg7ICFjICYmIG0gPCBoLmxlbmd0aDsgKSB7XG4gICAgICBsZXQgYSA9IFwiXCI7XG4gICAgICBpZiAoaFttXS5kb20uaXRlbS5pbm5lclRleHQgPyBhID0gaFttXS5kb20uaXRlbS5pbm5lclRleHQgOiBhID0gaFttXS5kb20uaXRlbS50ZXh0Q29udGVudCwgYSA9IGEucmVwbGFjZSgvW1xcc10vZywgXCJcIikudG9Mb3dlckNhc2UoKS5jaGFyQXQoMCksIGEgPT09IG4pIHtcbiAgICAgICAgYyA9ICEwO1xuICAgICAgICBjb25zdCBkID0gaFttXS5lbGVtZW50cy5wYXJlbnRNZW51LCBmID0gZC5lbGVtZW50cy5tZW51SXRlbXMuaW5kZXhPZihoW21dKTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5yb290TWVudS5ibHVyQ2hpbGRyZW4oKSwgZC5mb2N1c0NoaWxkKGYpO1xuICAgICAgfVxuICAgICAgbSsrO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogRm9jdXMgdGhlIHBhcmVudCBtZW51J3MgbmV4dCBjaGlsZC5cbiAgICpcbiAgICogVGhpcyB3aWxsIGNhc2NhZGUgdXAgdGhyb3VnaCB0byB0aGUgcm9vdCBtZW51LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBmb2N1c1BhcmVudHNOZXh0Q2hpbGQoKSB7XG4gICAgdGhpcy5lbGVtZW50cy5wYXJlbnRNZW51ICYmICh0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuY3VycmVudEV2ZW50ID0gdGhpcy5jdXJyZW50RXZlbnQsIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5jdXJyZW50Q2hpbGQgPT09IHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5lbGVtZW50cy5tZW51SXRlbXMubGVuZ3RoIC0gMSA/ICh0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmVsZW1lbnRzLnBhcmVudE1lbnUuZm9jdXNQYXJlbnRzTmV4dENoaWxkKCkpIDogKHRoaXMuYmx1ckNoaWxkcmVuKCksIHRoaXMuZWxlbWVudHMucGFyZW50TWVudS5mb2N1c05leHRDaGlsZCgpKSk7XG4gIH1cbiAgLyoqXG4gICAqIEZvY3VzIHRoZSBsYXN0IGNoaWxkIG9mIHRoZSBjdXJyZW50IGNoaWxkJ3Mgc3VibWVudS5cbiAgICpcbiAgICogVGhpcyB3aWxsIGNhc2NhZGUgZG93biB0aHJvdWdoIHRvIHRoZSBsYXN0IG9wZW4gbWVudS5cbiAgICpcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgZm9jdXNDaGlsZHNMYXN0Tm9kZSgpIHtcbiAgICB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudEV2ZW50ID0gdGhpcy5jdXJyZW50RXZlbnQsIHRoaXMuY3VycmVudE1lbnVJdGVtLmVsZW1lbnRzLmNoaWxkTWVudS5mb2N1c0xhc3RDaGlsZCgpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuY3VycmVudE1lbnVJdGVtLmlzU3VibWVudUl0ZW0gJiYgdGhpcy5jdXJyZW50TWVudUl0ZW0uZWxlbWVudHMuY2hpbGRNZW51LmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy50b2dnbGUuaXNPcGVuICYmICh0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuYmx1ckN1cnJlbnRDaGlsZCgpLCB0aGlzLmN1cnJlbnRNZW51SXRlbS5lbGVtZW50cy5jaGlsZE1lbnUuZm9jdXNDaGlsZHNMYXN0Tm9kZSgpKTtcbiAgfVxufVxuY29uc3QgWSA9IHtcbiAgRGlzY2xvc3VyZU1lbnU6IEssXG4gIE1lbnViYXI6IEYsXG4gIFRvcExpbmtEaXNjbG9zdXJlTWVudTogJCxcbiAgVHJlZXZpZXc6IHpcbn07XG5leHBvcnQge1xuICBZIGFzIGRlZmF1bHRcbn07XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZTsgfTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0IHsgQXBwbGljYXRpb24gfSBmcm9tICdAaG90d2lyZWQvc3RpbXVsdXMnO1xuaW1wb3J0IHsgZGVmaW5pdGlvbkZvck1vZHVsZUFuZElkZW50aWZpZXIsIGlkZW50aWZpZXJGb3JDb250ZXh0S2V5IH0gZnJvbSAnQGhvdHdpcmVkL3N0aW11bHVzLXdlYnBhY2staGVscGVycyc7XG5pbXBvcnQgJ0Bob3R3aXJlZC90dXJibyc7XG5pbXBvcnQgV2ViQXV0aG4gZnJvbSAnQHdlYi1hdXRoL3dlYmF1dGhuLXN0aW11bHVzJztcblxuaW1wb3J0ICcuL3NjcmlwdHMvbW9vdGFvLmpzJztcbmltcG9ydCAnLi9zY3JpcHRzL2NvcmUuanMnO1xuaW1wb3J0ICcuL3NjcmlwdHMvbGltaXQtaGVpZ2h0LmpzJztcbmltcG9ydCAnLi9zY3JpcHRzL21vZHVsZXdpemFyZC5qcyc7XG5pbXBvcnQgJy4vc2NyaXB0cy9zZWN0aW9ud2l6YXJkLmpzJztcblxuaW1wb3J0ICcuL3N0eWxlcy9iYWNrZW5kLnBjc3MnO1xuXG4vLyBTdGFydCB0aGUgU3RpbXVsdXMgYXBwbGljYXRpb25cbmNvbnN0IGFwcGxpY2F0aW9uID0gQXBwbGljYXRpb24uc3RhcnQoKTtcbmFwcGxpY2F0aW9uLmRlYnVnID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCc7XG5cbi8vIFJlZ2lzdGVyIGFsbCBjb250cm9sbGVycyB3aXRoIGBjb250YW8tLWAgcHJlZml4XG5jb25zdCBjb250ZXh0ID0gcmVxdWlyZS5jb250ZXh0KCcuL2NvbnRyb2xsZXJzJywgdHJ1ZSwgL1xcLmpzJC8pO1xuYXBwbGljYXRpb24ubG9hZChjb250ZXh0LmtleXMoKVxuICAgIC5tYXAoKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBpZGVudGlmaWVyID0gaWRlbnRpZmllckZvckNvbnRleHRLZXkoa2V5KTtcbiAgICAgICAgaWYgKGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllcihjb250ZXh0KGtleSksIGBjb250YW8tLSR7IGlkZW50aWZpZXIgfWApO1xuICAgICAgICB9XG4gICAgfSkuZmlsdGVyKCh2YWx1ZSkgPT4gdmFsdWUpXG4pO1xuXG5hcHBsaWNhdGlvbi5yZWdpc3RlcignY29udGFvLS13ZWJhdXRobicsIFdlYkF1dGhuKTtcblxuLy8gQ2FuY2VsIGFsbCBwcmVmZXRjaCByZXF1ZXN0cyB0aGF0IGNvbnRhaW4gYSByZXF1ZXN0IHRva2VuXG5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndHVyYm86YmVmb3JlLXByZWZldGNoJywgZSA9PiB7XG4gICAgaWYgKChuZXcgVVJMU2VhcmNoUGFyYW1zKGUudGFyZ2V0LmhyZWYpKS5oYXMoJ3J0JykgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdoZWFkZXJfYmFjaycpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy5zZi10b29sYmFyJykgIT09IG51bGwpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbn0pO1xuXG4vLyBNYWtlIHRoZSBNb29Ub29scyBzY3JpcHRzIHJlaW5pdGlhbGl6ZSB0aGVtc2VsdmVzXG5jb25zdCBtb29Eb21yZWFkeSA9ICgpID0+IHtcbiAgICBpZiAoIWRvY3VtZW50LmJvZHkubW9vRG9tcmVhZHlGaXJlZCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5Lm1vb0RvbXJlYWR5RmlyZWQgPSB0cnVlO1xuICAgICAgICB3aW5kb3cuZmlyZUV2ZW50KCdkb21yZWFkeScpO1xuICAgIH1cbn1cblxuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3R1cmJvOnJlbmRlcicsIG1vb0RvbXJlYWR5KTtcbmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0dXJibzpmcmFtZS1yZW5kZXInLCBtb29Eb21yZWFkeSk7XG5cbi8vIEFsd2F5cyBicmVhayBvdXQgb2YgYSBtaXNzaW5nIGZyYW1lICgjNzUwMSlcbmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0dXJibzpmcmFtZS1taXNzaW5nJywgKGUpID0+IHtcbiAgICBpZiAod2luZG93LmNvbnNvbGUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdUdXJibyBmcmFtZSAjJytlLnRhcmdldC5pZCsnIGlzIG1pc3NpbmcuJyk7XG4gICAgfVxuXG4gICAgLy8gRG8gbm90IGJyZWFrIG91dCBvZiBmcmFtZXMgdGhhdCBsb2FkIHRoZWlyIGNvbnRlbnQgdmlhIHNyY1xuICAgIGlmIChlLnRhcmdldC5oYXNBdHRyaWJ1dGUoJ3NyYycpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5kZXRhaWwudmlzaXQoZS5kZXRhaWwucmVzcG9uc2UpO1xufSk7XG4iXSwibmFtZXMiOlsiQ29udHJvbGxlciIsInZhbHVlcyIsInR5cGUiLCJTdHJpbmciLCJyZWFkT25seSIsIkJvb2xlYW4iLCJjb25uZWN0IiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJlbGVtZW50IiwiY2xhc3NOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsIm5leHRTaWJsaW5nIiwic3R5bGUiLCJlZGl0b3IiLCJhY2UiLCJlZGl0IiwiZ2V0U2Vzc2lvbiIsInNldFZhbHVlIiwidmFsdWUiLCJvbiIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsImdldFZhbHVlIiwiY29tbWFuZHMiLCJiaW5kS2V5IiwiY29uZmlnQ2FsbGJhY2siLCJzZXRNYXhMaW5lcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJiaW5kIiwiZGlzY29ubmVjdCIsImRlc3Ryb3kiLCJyZW1vdmUiLCJzZXRPcHRpb24iLCJNYXRoIiwiZmxvb3IiLCJpbm5lckhlaWdodCIsImxpbmVIZWlnaHQiLCJCYWNrZW5kU2VhcmNoQ29udHJvbGxlciIsInRhcmdldHMiLCJyb3V0ZSIsIm1pbkNoYXJhY3RlcnMiLCJOdW1iZXIiLCJkZWZhdWx0IiwiZGVsYXkiLCJjbGFzc2VzIiwiYWN0aXZlIiwidGltZW91dCIsInNldFN0YXRlIiwicGVyZm9ybVNlYXJjaCIsImlucHV0VGFyZ2V0IiwibGVuZ3RoIiwibWluQ2hhcmFjdGVyc1ZhbHVlIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsImxvYWRSZXN1bHRzIiwiZGVsYXlWYWx1ZSIsImZldGNoIiwic2VhcmNoUm91dGUiLCJ0aGVuIiwicmVzIiwib2siLCJFcnJvciIsInN0YXR1c1RleHQiLCJ0ZXh0IiwiaHRtbCIsInJlc3VsdHNUYXJnZXQiLCJpbm5lckhUTUwiLCJjYXRjaCIsImUiLCJvcGVuIiwiY2xvc2UiLCJibHVyIiwiZG9jdW1lbnRDbGljayIsImV2ZW50IiwiY29udGFpbnMiLCJ0YXJnZXQiLCJzdGF0ZSIsImZvckVhY2giLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyb3V0ZVZhbHVlIiwiQ2hvaWNlc0NvbnRyb2xsZXIiLCJpbml0R3VhcmQiLCJzZWxlY3QiLCJjaG9pY2VzIiwiQ2hvaWNlcyIsInNob3VsZFNvcnQiLCJkdXBsaWNhdGVJdGVtc0FsbG93ZWQiLCJhbGxvd0hUTUwiLCJyZW1vdmVJdGVtQnV0dG9uIiwic2VhcmNoRW5hYmxlZCIsIm9wdGlvbnMiLCJjbGFzc05hbWVzIiwiY29udGFpbmVyT3V0ZXIiLCJBcnJheSIsImZyb20iLCJmbGlwcGVkU3RhdGUiLCJmdXNlT3B0aW9ucyIsImluY2x1ZGVTY29yZSIsInRocmVzaG9sZCIsImNhbGxiYWNrT25Jbml0IiwiY2xvc2VzdCIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhc2V0IiwicGxhY2Vob2xkZXIiLCJsb2FkaW5nVGV4dCIsIkNvbnRhbyIsImxhbmciLCJsb2FkaW5nIiwibm9SZXN1bHRzVGV4dCIsIm5vUmVzdWx0cyIsIm5vQ2hvaWNlc1RleHQiLCJub09wdGlvbnMiLCJyZW1vdmVJdGVtTGFiZWxUZXh0IiwicmVtb3ZlSXRlbSIsImNvbmNhdCIsImNvbnRlbnQiLCJ3cml0ZSIsIm5hdmlnYXRvciIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsImNvbnRlbnRWYWx1ZSIsImNsaXBib2FyZEZhbGxiYWNrIiwiaW5wdXQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJzZXRTZWxlY3Rpb25SYW5nZSIsImV4ZWNDb21tYW5kIiwicmVtb3ZlQ2hpbGQiLCJDb2xvclBpY2tlciIsIm9uU2F2ZSIsImNvbG9yIiwidG9IRVhBIiwidG9TdHJpbmciLCJjaGFyQXQiLCJzdWJzdHJpbmciLCJ0b0xvd2VyQ2FzZSIsInBpY2tlciIsImhpZGUiLCJwcmVmZXJzRGFyayIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsInNldENvbG9yU2NoZW1lIiwiZG9jdW1lbnRFbGVtZW50IiwiY29sb3JTY2hlbWUiLCJpMThuIiwiT2JqZWN0IiwibGlnaHQiLCJkYXJrIiwiaW5pdGlhbGl6ZSIsInNldExhYmVsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInByZXZlbnREZWZhdWx0IiwiaXNEYXJrIiwic2V0SXRlbSIsImRpc3BhdGNoIiwiZGV0YWlsIiwibW9kZSIsImhhc0xhYmVsVGFyZ2V0IiwibGFiZWwiLCJpMThuVmFsdWUiLCJsYWJlbFRhcmdldCIsInRpdGxlIiwiaW5uZXJUZXh0IiwiVHVyYm8iLCJhZnRlckxvYWQiLCJpZGVudGlmaWVyIiwic2V0dXBDb250cm9sbGVyIiwicXVlcnlTZWxlY3RvckFsbCIsImVsIiwicHJpbWFyeSIsInNlY29uZGFyeSIsInNldEF0dHJpYnV0ZSIsImNvbnRyb2xsZXIiLCJUaGVtZSIsInNldHVwQ3RybENsaWNrIiwiY29uc29sZSIsIndhcm4iLCJoYW5kbGUiLCJpc1ZhbGlkIiwicHJpbWFyeUtleSIsInBsYXRmb3JtIiwic3RhcnRzV2l0aCIsInNoaWZ0S2V5IiwiaGFzUHJpbWFyeVRhcmdldCIsInByaW1hcnlUYXJnZXQiLCJocmVmIiwidmlzaXQiLCJoYXNTZWNvbmRhcnlUYXJnZXQiLCJzZWNvbmRhcnlUYXJnZXQiLCJwb2ludGVyVHlwZSIsIiR0aW1lciIsImdldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInZpc2l0UHJpbWFyeSIsInZpc2l0U2Vjb25kYXJ5IiwidGFnTmFtZSIsImNvbmZpZyIsInVwZGF0ZVdpemFyZCIsIm9wZW5Nb2RhbCIsImJ1dHRvbiIsImJ1dHRvbkltYWdlIiwiYXBwZW5kIiwiYWRkIiwiYWZ0ZXIiLCJjYW5FZGl0IiwiY29uZmlnVmFsdWUiLCJkaXNhYmxlZCIsInNyYyIsImljb24iLCJpY29uRGlzYWJsZWQiLCJCYWNrZW5kIiwib3Blbk1vZGFsSWZyYW1lIiwidXJsIiwiaWRzIiwiaW5jbHVkZXMiLCJyZWJ1aWxkTmF2aWdhdGlvbiIsImNvbm5lY3RlZCIsInNlY3Rpb25UYXJnZXRDb25uZWN0ZWQiLCJoYXNOYXZpZ2F0aW9uVGFyZ2V0IiwibGlua3MiLCJzZWN0aW9uVGFyZ2V0cyIsImFjdGlvbiIsInNjcm9sbEludG9WaWV3IiwibGkiLCJuYXZpZ2F0aW9uVGFyZ2V0IiwicmVwbGFjZUNoaWxkcmVuIiwibWF4IiwiZXhwYW5kIiwiY29sbGFwc2UiLCJleHBhbmRBbGwiLCJleHBhbmRBbGxUaXRsZSIsImNvbGxhcHNlQWxsIiwiY29sbGFwc2VBbGxUaXRsZSIsInRvZ2dsZXJNYXAiLCJXZWFrTWFwIiwibmV4dElkIiwib3BlcmF0aW9uVGFyZ2V0Q29ubmVjdGVkIiwidXBkYXRlT3BlcmF0aW9uIiwibm9kZVRhcmdldENvbm5lY3RlZCIsIm5vZGUiLCJnZXRDb21wdXRlZFN0eWxlIiwicGFkZGluZyIsInBhcnNlRmxvYXQiLCJwYWRkaW5nVG9wIiwicGFkZGluZ0JvdHRvbSIsImhlaWdodCIsImNsaWVudEhlaWdodCIsIm1heFZhbHVlIiwib3ZlcmZsb3ciLCJtYXhIZWlnaHQiLCJleHBhbmRWYWx1ZSIsInRvZ2dsZXIiLCJzZXQiLCJub2RlVGFyZ2V0RGlzY29ubmVjdGVkIiwiaGFzIiwiZ2V0IiwiZGVsZXRlIiwiY29sbGFwc2VWYWx1ZSIsInRvZ2dsZUFsbCIsImlzRXhwYW5kZWQiLCJoYXNFeHBhbmRlZCIsImFsdEtleSIsIm5vZGVUYXJnZXRzIiwia2V5cHJlc3MiLCJoYXNPcGVyYXRpb25UYXJnZXQiLCJoYXNUb2dnbGVycyIsImZpbmQiLCJleHBhbmRlZCIsIm9wZXJhdGlvblRhcmdldCIsImRpc3BsYXkiLCJtYXAiLCJqb2luIiwiY29sbGFwc2VBbGxWYWx1ZSIsImNvbGxhcHNlQWxsVGl0bGVWYWx1ZSIsImV4cGFuZEFsbFZhbHVlIiwiZXhwYW5kQWxsVGl0bGVWYWx1ZSIsImlucHV0VGFyZ2V0cyIsIkFjY2Vzc2libGVNZW51IiwiaGFzTWVudVRhcmdldCIsImNvbnRyb2xsZXJUYXJnZXQiLCJzZXRGaXhlZFBvc2l0aW9uIiwiJG1lbnUiLCJEaXNjbG9zdXJlTWVudSIsIm1lbnVFbGVtZW50IiwibWVudVRhcmdldCIsImNvbnRhaW5lckVsZW1lbnQiLCJjb250cm9sbGVyRWxlbWVudCIsImRvbSIsImlzSW50ZXJhY3RpdmUiLCJzdG9wUHJvcGFnYXRpb24iLCJlbGVtZW50cyIsInByZXZpZXciLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsInkiLCJvZmZzZXQiLCJjbGllbnRYIiwiY2xpZW50WSIsInIiLCJwb3NpdGlvbiIsInJpZ2h0IiwidG9wIiwiaW5uZXJXaWR0aCIsIndpZHRoIiwibGVmdCIsIm5vZGVOYW1lIiwicGFyZW50RWxlbWVudCIsIm5hbWVJbnB1dFRhcmdldENvbm5lY3RlZCIsImZvY3VzIiwiY2FuY2VsRWRpdCIsIm5hbWVJbnB1dFRhcmdldCIsImZvcm1UYXJnZXQiLCJyZXF1ZXN0U3VibWl0IiwibmFtZSIsImJ1dHRvblRhcmdldENvbm5lY3RlZCIsIm5hbWVWYWx1ZSIsIm1lbnVUYXJnZXRDb25uZWN0ZWQiLCJtZW51IiwiYnV0dG9uVGFyZ2V0Iiwic2Vzc2lvbktleSIsImJlaGF2aW9yIiwiYmxvY2siLCJhcHBsaWNhdGlvbiIsImxvYWRGYWxsYmFjayIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZ2V0Q29udHJvbGxlckZvckVsZW1lbnRBbmRJZGVudGlmaWVyIiwiY29udHJvbGxlckF0dHJpYnV0ZSIsInNjaGVtYSIsImluaXRTY3JvbGxPZmZzZXQiLCJnZXRTY3JvbGxPZmZzZXQiLCJkaXNjYXJkIiwic3RvcmUiLCJzY3JvbGxUbyIsImJlaGF2aW9yVmFsdWUiLCJibG9ja1ZhbHVlIiwic2Nyb2xsVG9UYXJnZXRDb25uZWN0ZWQiLCJzY3JvbGxUb1RhcmdldCIsImF1dG9Gb2N1c1RhcmdldENvbm5lY3RlZCIsImF1dG9Gb2N1cyIsImF1dG9Gb2N1c1RhcmdldCIsInJlYWRvbmx5Iiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRIZWlnaHQiLCJhdXRvY29tcGxldGUiLCJ3aWRnZXRFcnJvclRhcmdldENvbm5lY3RlZCIsIndpZGdldEVycm9yVGFyZ2V0Iiwic2Nyb2xsVG9wIiwic2Nyb2xsVG9XaWRnZXRFcnJvciIsImhhc1dpZGdldEVycm9yVGFyZ2V0Iiwic2Vzc2lvblN0b3JhZ2UiLCJzZXNzaW9uS2V5VmFsdWUiLCJwYXJzZUludCIsInVuZGVmaW5lZCIsIlRhYnNDb250cm9sbGVyIiwiY2xvc2VMYWJlbCIsImluc3RhbmNlQ291bnQiLCJpbnN0YW5jZUlkIiwibGFzdFRhYklkIiwiYWN0aXZlVGFiIiwicGFuZWxUYXJnZXRDb25uZWN0ZWQiLCJwYW5lbCIsImNvbnRyb2xfcmVmZXJlbmNlIiwicGFuZWxfcmVmZXJlbmNlIiwic2VsZWN0QnV0dG9uIiwic2VsZWN0VGFiIiwiY2xvc2VCdXR0b24iLCJjbG9zZUxhYmVsVmFsdWUiLCJwYW5lbFRhcmdldERpc2Nvbm5lY3RlZCIsImdldEVsZW1lbnRCeUlkIiwiaGFzUGFuZWxUYXJnZXQiLCJwYW5lbFRhcmdldCIsInBhbmVsVGFyZ2V0cyIsImlzVGFyZ2V0IiwidG9nZ2xlQXR0cmlidXRlIiwiZ2V0QWN0aXZlVGFiIiwiZ2V0VGFicyIsInJlZHVjZSIsInJlc3VsdCIsIlR3aWdFZGl0b3IiLCJlZGl0b3JzIiwiTWFwIiwiZm9sbG93VXJsIiwiYmxvY2tJbmZvVXJsIiwiX3Zpc2l0IiwiZm9sbG93VXJsVmFsdWUiLCJibG9ja0luZm9VcmxWYWx1ZSIsInRoZW1lU2VsZWN0b3JUYXJnZXQiLCJfYWRkT3BlbkVkaXRvclRhYnNUb1JlcXVlc3QiLCJmb3JtU3VibWlzc2lvbiIsInN1Ym1pdHRlciIsIm9wZXJhdGlvbiIsIl9hZGRFZGl0b3JDb250ZW50VG9SZXF1ZXN0IiwiX2dldEFjdGl2ZU11dGFibGVFZGl0b3IiLCJlZGl0b3JUYXJnZXRDb25uZWN0ZWQiLCJlZGl0b3JUYXJnZXREaXNjb25uZWN0ZWQiLCJlZGl0b3JBbm5vdGF0aW9uc1RhcmdldENvbm5lY3RlZCIsInNldEFubm90YXRpb25zRGF0YSIsIkpTT04iLCJwYXJzZSIsImRpYWxvZ1RhcmdldENvbm5lY3RlZCIsInNob3dNb2RhbCIsImNvbG9yQ2hhbmdlIiwic2VhcmNoUGFyYW1zIiwibG9jYXRpb24iLCJ0YWJzIiwidGFic1RhcmdldCIsImtleXMiLCJ0YWJJZCIsImZldGNoUmVxdWVzdCIsImdldENvbnRlbnQiLCJlZGl0b3JFbGVtZW50c09uQWN0aXZlVGFiIiwiaXNFZGl0YWJsZSIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInJlc3BvbnNlIiwibWV0aG9kIiwiaGVhZGVycyIsInJlZGlyZWN0ZWQiLCJzdGF0dXMiLCJlcnJvciIsInJlbmRlclN0cmVhbU1lc3NhZ2UiLCJjYWNoZSIsImV4ZW1wdFBhZ2VGcm9tQ2FjaGUiLCJ0aW55bWNlQ29uZmlnIiwiZWxlbWVudElkIiwidGlueW1jZSIsImluaXQiLCJlZGl0b3JJZCIsImxlYXZlIiwicGx1Z2lucyIsImhhc093blByb3BlcnR5IiwiaXNOb3REaXJ0eSIsImRlbGVnYXRlIiwiY3JlYXRlRXZlbnQiLCJpbml0RXZlbnQiLCJjb25maXJtIiwicmV0dXJuVmFsdWUiLCJ0YWJsZSIsImFkZENvbnRyb2xsZXIiLCJmcyIsIm1pZ3JhdGVMZWdhY3kiLCJBamF4UmVxdWVzdCIsInRvZ2dsZUZpZWxkc2V0IiwicmVhZHlTdGF0ZSIsImNvbGxhcHNlZENsYXNzIiwic2V0QXJpYUV4cGFuZGVkIiwic3RvcmVTdGF0ZSIsImZvcm0iLCJpIiwiY2hlY2tWYWxpZGl0eSIsImNsaWNrIiwiaGFzSWRWYWx1ZSIsImhhc1RhYmxlVmFsdWUiLCJpZFZhbHVlIiwidGFibGVWYWx1ZSIsImFyaWFFeHBhbmRlZCIsInJlcXVlc3RUb2tlbiIsImV4cGFuZFRpdGxlIiwiY29sbGFwc2VUaXRsZSIsIl9yZWYiLCJjdXJyZW50VGFyZ2V0IiwiY2F0ZWdvcnkiLCJjb2xsYXBzZWQiLCJleHBhbmRUaXRsZVZhbHVlIiwiY29sbGFwc2VUaXRsZVZhbHVlIiwic2VuZFJlcXVlc3QiLCJ1cmxWYWx1ZSIsIlJFUVVFU1RfVE9LRU4iLCJyZXF1ZXN0VG9rZW5WYWx1ZSIsInRvZ2dsZUFjdGlvbiIsImxvYWRBY3Rpb24iLCJyZWZlcmVySWQiLCJjaGlsZFRhcmdldENvbm5lY3RlZCIsInRvZ2dsZVRvZ2dsZXIiLCJsZXZlbCIsImZvbGRlciIsIml0ZW0iLCJzaG93Q2hpbGQiLCJleHBhbmRUb2dnbGVyIiwidXBkYXRlU3RhdGUiLCJoaWRlQ2hpbGQiLCJjb2xsYXBzZVRvZ2dsZXIiLCJmZXRjaENoaWxkIiwiaGFzQXR0cmlidXRlIiwiZ2V0RWxlbWVudHMiLCJpbWFnZSIsImFsdCIsImxvYWRUb2dnbGVyIiwiZW5hYmxlZCIsIlVSTCIsInNlYXJjaCIsInJlZmVyZXJJZFZhbHVlIiwibG9hZEFjdGlvblZhbHVlIiwidHh0IiwidWwiLCJtb2RlVmFsdWUiLCJpc0ZvbGRlciIsInBhcmVudCIsIm5leHQiLCJ0eXBlT2YiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJiZWZvcmUiLCJDdXN0b21FdmVudCIsImZpcmVFdmVudCIsImhhc0V4cGFuZGVkUm9vdCIsInVwZGF0ZUFsbFN0YXRlIiwidG9nZ2xlVGFyZ2V0cyIsImNoaWxkVGFyZ2V0cyIsInByb21pc2VzIiwicHVzaCIsImFsbCIsInRvZ2dsZUFjdGlvblZhbHVlIiwicm9vdENoaWxkVGFyZ2V0cyIsIlRvb2x0aXBzQ29udHJvbGxlciIsImRlZmF1bHRPcHRpb25zTWFwIiwidXNlQ29udGVudCIsImFjdGl2ZVRhcmdldHMiLCJTZXQiLCJyZW1vdmVDbGlja1RhcmdldEhhbmRsZXJEZWxlZ2F0ZXMiLCJ0b29sdGlwIiwiX2NyZWF0ZVRpcENvbnRhaW5lciIsIl90b3VjaFN0YXJ0RGVsZWdhdGUiLCJ0b29sdGlwVGFyZ2V0Q29ubmVjdGVkIiwiX3Nob3dUb29sdGlwIiwiX2hpZGVUb29sdGlwIiwiY2xpY2tUYXJnZXQiLCJoYW5kbGVyIiwidG9vbHRpcFRhcmdldERpc2Nvbm5lY3RlZCIsImZpbHRlciIsImFyZ3VtZW50cyIsIl9nZXRPcHRpb25zRm9yRWxlbWVudCIsInJlcGxhY2UiLCJ0aW1lciIsIndpbGxDaGFuZ2UiLCJydGwiLCJkaXJlY3Rpb24iLCJjbGllbnRXaWR0aCIsInNjcm9sbFgiLCJzY3JvbGxZIiwiY3JpdGVyaWEiLCJkZWZhdWx0T3B0aW9ucyIsImVudHJpZXMiLCJtYXRjaCIsInRhcmdldFNlbGVjdG9ycyIsIm1pZ3JhdGVUYXJnZXQiLCJNdXRhdGlvbk9ic2VydmVyIiwibXV0YXRpb25zTGlzdCIsIm11dGF0aW9uIiwiYWRkZWROb2RlcyIsIkhUTUxFbGVtZW50Iiwib2JzZXJ2ZSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJ1bnN1cHBvcnRlZE1lc3NhZ2UiLCJhc3NlcnRpb25GYWlsdXJlTWVzc2FnZSIsImF0dGVzdGF0aW9uRmFpbHVyZU1lc3NhZ2UiLCJoYW5kbGVVbnN1cHBvcnRlZCIsIm1lc3NhZ2VUYXJnZXQiLCJyZW5kZXJNZXNzYWdlIiwidW5zdXBwb3J0ZWRNZXNzYWdlVmFsdWUiLCJoYW5kbGVBc3NlcnRpb25GYWlsdXJlIiwiYXNzZXJ0aW9uRmFpbHVyZU1lc3NhZ2VWYWx1ZSIsImhhbmRsZUF0dGVzdGF0aW9uRmFpbHVyZSIsImF0dGVzdGF0aW9uRmFpbHVyZU1lc3NhZ2VWYWx1ZSIsIm1lc3NhZ2UiLCJjb25zdHJ1Y3RvciIsInJlc291cmNlVXJsIiwibWF4TGluZXMiLCJ3cmFwIiwidXNlU29mdFRhYnMiLCJhdXRvU2Nyb2xsRWRpdG9ySW50b1ZpZXciLCJlbmFibGVMaXZlQXV0b2NvbXBsZXRpb24iLCJ3aGl0ZXNwYWNlIiwicmVxdWlyZSIsImRldGVjdEluZGVudGF0aW9uIiwiYWRkQ29tbWFuZCIsImV4ZWMiLCJhcmdzIiwiYnViYmxlcyIsIm9uY2UiLCJyZWdpc3RlckNvZGVMZW5zUHJvdmlkZXIiLCJjb2RlTGVucyIsInByb3ZpZGVDb2RlTGVuc2VzIiwic2Vzc2lvbiIsImNhbGxiYWNrIiwicGF5bG9hZCIsImFuYWx5emVSZWZlcmVuY2VzIiwicmVmZXJlbmNlIiwic3RhcnQiLCJyb3ciLCJjb2x1bW4iLCJjb21tYW5kIiwiYW5hbHl6ZUJsb2NrcyIsInJlZmVyZW5jZXMiLCJnZXRMZW5ndGgiLCJ0b2tlbnMiLCJnZXRUb2tlbnMiLCJ0ZXN0IiwiYmxvY2tzIiwiZGF0YSIsImNvbXBsZXRlcnMiLCJnZXRDb21wbGV0aW9ucyIsInBvcyIsInByZWZpeCIsInNldEFubm90YXRpb25zIiwibGluZSIsInNldFRoZW1lIiwiZ2V0UmVhZE9ubHkiLCJ0b2dnbGVOYXZpZ2F0aW9uIiwiJCIsImdldFBhcmVudCIsImhhc0NsYXNzIiwicmVtb3ZlQ2xhc3MiLCJSZXF1ZXN0IiwicG9zdCIsInJlcXVlc3RfdG9rZW4iLCJhZGRDbGFzcyIsInRvZ2dsZVN0cnVjdHVyZSIsImdldFN0eWxlIiwic2V0U3R5bGUiLCJmaWVsZCIsImV2YWxTY3JpcHRzIiwib25SZXF1ZXN0IiwiZGlzcGxheUJveCIsIm9uU3VjY2VzcyIsIkVsZW1lbnQiLCJpbmplY3QiLCJnZXROZXh0IiwiZWFjaCIsInJlZmVyZXJfaWQiLCJoaWRlQm94IiwidG9nZ2xlRmlsZU1hbmFnZXIiLCJ0b2dnbGVTdWJwYWxldHRlIiwiY2hlY2tlZCIsInVwZGF0ZVZlcnNpb25OdW1iZXIiLCJqc29uIiwiZGl2IiwiamF2YXNjcmlwdCIsInN0ciIsIkFzc2V0Iiwib25Mb2FkIiwiQnJvd3NlciIsImZpZWxkcyIsIlZFUlNJT05fTlVNQkVSIiwidG9nZ2xlRmllbGQiLCJyb3dJY29uIiwiaW1nIiwiaW1hZ2VzIiwicHVibGlzaGVkIiwicGEiLCJnZXRQcmV2aW91cyIsImdldEZpcnN0IiwiZ2V0RWxlbWVudCIsImluZGV4T2YiLCJuZXdTcmMiLCJzbGljZSIsImxhc3RJbmRleE9mIiwidG9nZ2xlQ2hlY2tib3hHcm91cCIsImJveCIsIm92ZXJsYXkiLCJzY3JvbGwiLCJnZXRTY3JvbGwiLCJjdXJyZW50SWQiLCJwb3B1cFdpbmRvdyIsInRoZW1lUGF0aCIsInNjcmlwdF91cmwiLCJ0aGVtZSIsIm9wZW5Nb2RhbFdpbmRvdyIsIlNpbXBsZU1vZGFsIiwib25TaG93Iiwib25IaWRlIiwic2hvdyIsIm9wZW5Nb2RhbEltYWdlIiwib3B0IiwibWF4V2lkdGgiLCJnZXRTaXplIiwidG9JbnQiLCJtaW4iLCJNIiwib3Blbk1vZGFsU2VsZWN0b3IiLCJhZGRCdXR0b24iLCJjYW5jZWwiLCJidXR0b25zIiwiYXBwbHkiLCJmcm0iLCJmcmFtZXMiLCJ2YWwiLCJpbnAiLCJwaWNrZXJWYWx1ZSIsInNJbmRleCIsImFsZXJ0IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzcGxpY2UiLCJvcGVuTW9kYWxCcm93c2VyIiwiZmllbGRfbmFtZSIsIndpbiIsInNvdXJjZSIsInJvdXRlcyIsImJhY2tlbmRfcGlja2VyIiwiYXV0b1N1Ym1pdCIsImhpZGRlbiIsInN1Ym1pdCIsInZTY3JvbGxUbyIsImFkZEV2ZW50IiwidG9nZ2xlQ2hlY2tib3hlcyIsIml0ZW1zIiwiJCQiLCJzdWJzdHIiLCJjbHMiLCJjYngiLCJjaGVja2JveCIsInRvZ2dsZUNoZWNrYm94RWxlbWVudHMiLCJtYWtlUGFyZW50Vmlld1NvcnRhYmxlIiwiZHMiLCJTY3JvbGxlciIsIm9uQ2hhbmdlIiwibGlzdCIsIlNvcnRhYmxlcyIsImNvbnN0cmFpbiIsIm9wYWNpdHkiLCJvblN0YXJ0Iiwib25Db21wbGV0ZSIsInN0b3AiLCJvblNvcnQiLCJ3cmFwTGV2ZWwiLCJkaXZzIiwiZ2V0Q2hpbGRyZW4iLCJwaWQiLCJyZXEiLCJtYWtlTXVsdGlTcmNTb3J0YWJsZSIsIm9pZCIsImVscyIsImxpcyIsInNwbGl0IiwiaiIsImRpZCIsImRpc3Bvc2UiLCJlbmFibGVGaWxlVHJlZURyYWdBbmREcm9wIiwiZHJhZ0hhbmRsZSIsImRyYWdFbGVtZW50IiwicmlnaHRDbGljayIsImNsb25lQmFzZSIsImNsb25lIiwiY3VycmVudEhvdmVyIiwiY3VycmVudEhvdmVyVGltZSIsImV4cGFuZExpbmsiLCJzZXRQb3NpdGlvbiIsInBhZ2UiLCJnZXRPZmZzZXRQYXJlbnQiLCJnZXRQb3NpdGlvbiIsIm1vdmUiLCJEcmFnIiwiTW92ZSIsImRyb3BwYWJsZXMiLCJ1bkRyYWdnYWJsZVRhZ3MiLCJtb2RpZmllcnMiLCJvbkVudGVyIiwiZHJvcHBhYmxlIiwiZml4RHJvcHBhYmxlIiwiRGF0ZSIsImdldFRpbWUiLCJvbkFqYXgiLCJyZW1vdmVFdmVudCIsIm9uQ2FuY2VsIiwib25LZXl1cCIsIm9uRHJvcCIsImRlY29kZVVSSUNvbXBvbmVudCIsImVuY29kZVVSSUNvbXBvbmVudCIsIm9uTGVhdmUiLCJrZXkiLCJsaXN0V2l6YXJkIiwibWFrZVNvcnRhYmxlIiwiYWRkRXZlbnRzVG8iLCJwcmV2aW91cyIsImJ0IiwiaGFzRXZlbnQiLCJnZXRQcm9wZXJ0eSIsImtleUNvZGUiLCJ0YWJsZVdpemFyZCIsInRoZWFkIiwidGJvZHkiLCJyb3dzIiwidGV4dGFyZWEiLCJjaGlsZHJlbiIsInRyIiwiaGVhZCIsImN1cnJlbnQiLCJudHIiLCJpbmRleCIsImdldEluZGV4IiwiaGVhZEZpcnN0IiwiZ2V0TGFzdCIsInRkIiwiY29scyIsInRhYmxlV2l6YXJkUmVzaXplIiwiZmFjdG9yIiwic2l6ZSIsInJvdW5kIiwibGltaXQiLCJjaHVua3MiLCJ0YWJsZVdpemFyZFNldFdpZHRoIiwiZ2V0Q29tcHV0ZWRTaXplIiwib3B0aW9uc1dpemFyZCIsImtleVZhbHVlV2l6YXJkIiwiY2hlY2tib3hXaXphcmQiLCJzcGFuIiwibnNwYW4iLCJlbmFibGVJbWFnZVNpemVXaWRnZXRzIiwid2lkdGhJbnB1dCIsImhlaWdodElucHV0IiwidXBkYXRlIiwiZGltZW5zaW9ucyIsImdldFNlbGVjdGVkIiwiZW5hYmxlVG9nZ2xlU2VsZWN0Iiwic2hpZnRUb2dnbGUiLCJ0aGlzSW5kZXgiLCJjaGVja2JveGVzIiwic3RhcnRJbmRleCIsInRvIiwiY2xpY2tFdmVudCIsImxpbWl0VG9nZ2xlciIsInNoaWZ0IiwiYm91bmRFdmVudCIsInJldHJpZXZlIiwiZWRpdFByZXZpZXdXaXphcmQiLCJpbWFnZUVsZW1lbnQiLCJpbnB1dEVsZW1lbnRzIiwiaXNEcmF3aW5nIiwicGFydEVsZW1lbnQiLCJzdGFydFBvcyIsImdldFNjYWxlIiwidXBkYXRlSW1hZ2UiLCJzY2FsZSIsImltYWdlU2l6ZSIsInNldFN0eWxlcyIsImNvbXB1dGVkVG9wIiwiY29tcHV0ZWRMZWZ0IiwidG9GbG9hdCIsInVwZGF0ZVZhbHVlcyIsInN0eWxlcyIsImdldFN0eWxlcyIsInRvRml4ZWQiLCJhYnMiLCJjYXBpdGFsaXplIiwiYWRkRXZlbnRzIiwibW91c2Vkb3duIiwidG91Y2hzdGFydCIsIm1vdXNlbW92ZSIsInRvdWNobW92ZSIsIm1vdXNldXAiLCJ0b3VjaGVuZCIsInRvdWNoY2FuY2VsIiwicmVzaXplIiwiZW5hYmxlRmlsZVRyZWVVcGxvYWQiLCJmYWxsYmFja1VybCIsImR6RWxlbWVudCIsInByZXZpZXdzQ29udGFpbmVyIiwiY2xpY2thYmxlIiwiZHoiLCJEcm9wem9uZSIsInJlbG9hZCIsImRhdGFUcmFuc2ZlciIsInR5cGVzIiwibGluayIsImNyYXdsIiwicHJvZ3Jlc3NCYXIiLCJwcm9ncmVzc0NvdW50IiwicmVzdWx0cyIsImRlYnVnTG9nIiwidXBkYXRlRGF0YSIsInRvdGFsIiwiZG9uZSIsInBlbmRpbmciLCJwZXJjZW50YWdlIiwiaGFzRGVidWdMb2ciLCJmaW5pc2hlZCIsInN1bW1hcnkiLCJ3YXJuaW5nIiwibG9nIiwic3Vic2NyaWJlclJlc3VsdHMiLCJzdWJzY3JpYmVyU3VtbWFyeSIsImhhc0xvZyIsIndhc1N1Y2Nlc3NmdWwiLCJleGVjUmVxdWVzdCIsIm9ubHlTdGF0dXNVcGRhdGUiLCJyZXNwb25zZVRleHQiLCJkZWNvZGUiLCJzZW5kIiwiaXNXZWJraXQiLCJjaHJvbWUiLCJzYWZhcmkiLCJ1c2VyQWdlbnQiLCJzdG9wQ2xpY2tQcm9wYWdhdGlvbiIsInNldHVwVGV4dGFyZWFSZXNpemluZyIsImllNiIsImllNyIsImllOCIsImR1bW15IiwidHdlZW4iLCJzZXR1cE1lbnVUb2dnbGUiLCJidXJnZXIiLCJ0b2dnbGVDbGFzcyIsInNldEFyaWFDb250cm9scyIsInNldHVwUHJvZmlsZVRvZ2dsZSIsInRtZW51Iiwic2V0dXBTcGxpdEJ1dHRvblRvZ2dsZSIsInRhYiIsIkZlYXR1cmVzIiwiVG91Y2giLCJoZ3QiLCJpbml0aWFsaXplZFJvd3MiLCJzYXZlU2Nyb2xsT2Zmc2V0RXZlbnQiLCJjbG9uZU5vZGUiLCJzZWxlY3RzIiwibnNlbGVjdHMiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiY29kZSIsImluc2VydEFkamFjZW50RWxlbWVudCIsInVwZGF0ZUxpbmsiLCJhdHRyaWJ1dGVzIiwiQ2xhc3MiLCJFeHRlbmRzIiwiZm9sbG93UmVkaXJlY3RzIiwic3VjY2VzcyIsImdldEhlYWRlciIsInNlY3VyZSIsInN0cmlwU2NyaXB0cyIsInNjcmlwdCIsImZhaWx1cmUiLCJvbkZhaWx1cmUiLCJyZWZhY3RvciIsImF0dGFjaCIsImhhbmRsZXMiLCJib3VuZCIsImRldGFjaCIsImNoZWNrIiwiZGlzdGFuY2UiLCJzcXJ0IiwicG93IiwibW91c2UiLCJzbmFwIiwiZHJhZyIsInJlbW92ZUV2ZW50cyIsImxpc3RzIiwiZHJhZ09wdGlvbnMiLCJtZXJnZSIsInRhZyIsImFkZEl0ZW1zIiwiZmxhdHRlbiIsImNhbGwiLCJyZW1vdmVJdGVtcyIsImVyYXNlIiwiZ2V0Q2xvbmUiLCJRdWV1ZSIsImF1dG9BZHZhbmNlIiwicmVzdW1lIiwicXVldWUiLCJpc1J1bm5pbmciLCJzdG9wT25GYWlsdXJlIiwib25FeGNlcHRpb24iLCJTZXJwUHJldmlldyIsInRyYWlsIiwidGl0bGVGaWVsZCIsInRpdGxlRmFsbGJhY2tGaWVsZCIsImFsaWFzRmllbGQiLCJkZXNjcmlwdGlvbkZpZWxkIiwiZGVzY3JpcHRpb25GYWxsYmFja0ZpZWxkIiwidGl0bGVUYWciLCJzaG9ydGVuIiwiaHRtbDJzdHJpbmciLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJ0ZXh0Q29udGVudCIsImdldFRpbnltY2UiLCJ0aW55TUNFIiwic2VycFRpdGxlIiwic2VycFVybCIsInNlcnBEZXNjcmlwdGlvbiIsImluZGV4RW1wdHkiLCJhY3RpdmVFZGl0b3IiLCJicm93c2VyU3VwcG9ydHNXZWJBdXRobkF1dG9maWxsIiwiYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4iLCJzdGFydEF1dGhlbnRpY2F0aW9uIiwic3RhcnRSZWdpc3RyYXRpb24iLCJkZWZhdWx0XzEiLCJfYSIsIl9iIiwicmVxdWVzdFJlc3VsdFVybCIsInJlcXVlc3RSZXN1bHRVcmxWYWx1ZSIsInJlcXVlc3RPcHRpb25zVXJsIiwicmVxdWVzdE9wdGlvbnNVcmxWYWx1ZSIsInJlcXVlc3RTdWNjZXNzUmVkaXJlY3RVcmkiLCJyZXF1ZXN0U3VjY2Vzc1JlZGlyZWN0VXJpVmFsdWUiLCJjcmVhdGlvblJlc3VsdFVybCIsImNyZWF0aW9uUmVzdWx0VXJsVmFsdWUiLCJjcmVhdGlvbk9wdGlvbnNVcmwiLCJjcmVhdGlvbk9wdGlvbnNVcmxWYWx1ZSIsImNyZWF0aW9uU3VjY2Vzc1JlZGlyZWN0VXJpIiwiY3JlYXRpb25TdWNjZXNzUmVkaXJlY3RVcmlWYWx1ZSIsIl9kaXNwYXRjaEV2ZW50Iiwic3VwcG9ydEF1dG9maWxsIiwidXNlQnJvd3NlckF1dG9maWxsVmFsdWUiLCJvcHRpb25zUmVzcG9uc2VKc29uIiwiX2dldFB1YmxpY0tleUNyZWRlbnRpYWxSZXF1ZXN0T3B0aW9ucyIsIl9wcm9jZXNzU2lnbmluIiwic2lnbmluIiwiZGVidWciLCJ1c2VCcm93c2VyQXV0b2ZpbGwiLCJhdXRoZW50aWNhdG9yUmVzcG9uc2UiLCJhc3NlcnRpb25SZXNwb25zZSIsIl9nZXRBc3NlcnRpb25SZXNwb25zZSIsInNpZ251cCIsIl9nZXRQdWJsaWNLZXlDcmVkZW50aWFsQ3JlYXRpb25PcHRpb25zIiwiYXR0ZXN0YXRpb25SZXNwb25zZUpTT04iLCJfZ2V0QXR0ZXN0YXRpb25SZXNwb25zZSIsIl9nZXREYXRhIiwiRm9ybURhdGEiLCJyZXBvcnRWYWxpZGl0eSIsInJlbW92ZUVtcHR5Iiwib2JqIiwidiIsImFjYyIsIl9yZWYyIiwiayIsImFzc2lnbiIsInVzZXJuYW1lIiwidXNlcm5hbWVGaWVsZFZhbHVlIiwiZGlzcGxheU5hbWUiLCJkaXNwbGF5TmFtZUZpZWxkVmFsdWUiLCJhdHRlc3RhdGlvbiIsImF0dGVzdGF0aW9uRmllbGRWYWx1ZSIsInVzZXJWZXJpZmljYXRpb24iLCJ1c2VyVmVyaWZpY2F0aW9uRmllbGRWYWx1ZSIsInJlc2lkZW50S2V5IiwicmVzaWRlbnRLZXlGaWVsZFZhbHVlIiwiYXV0aGVudGljYXRvckF0dGFjaG1lbnQiLCJhdXRoZW50aWNhdG9yQXR0YWNobWVudEZpZWxkVmFsdWUiLCJmb3JtRGF0YSIsIl9nZXRPcHRpb25zIiwib3B0aW9uc1Jlc3BvbnNlIiwicmVxdWVzdEhlYWRlcnNWYWx1ZSIsInN0cmluZ2lmeSIsIl9nZXRSZXN1bHQiLCJldmVudFByZWZpeCIsImF0dGVzdGF0aW9uUmVzcG9uc2UiLCJ1c2VybmFtZUZpZWxkIiwiZGlzcGxheU5hbWVGaWVsZCIsImF0dGVzdGF0aW9uRmllbGQiLCJ1c2VyVmVyaWZpY2F0aW9uRmllbGQiLCJyZXNpZGVudEtleUZpZWxkIiwiYXV0aGVudGljYXRvckF0dGFjaG1lbnRGaWVsZCIsInJlcXVlc3RIZWFkZXJzIiwiQXBwbGljYXRpb24iLCJkZWZpbml0aW9uRm9yTW9kdWxlQW5kSWRlbnRpZmllciIsImlkZW50aWZpZXJGb3JDb250ZXh0S2V5IiwiV2ViQXV0aG4iLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJjb250ZXh0IiwibG9hZCIsInJlZ2lzdGVyIiwibW9vRG9tcmVhZHkiLCJtb29Eb21yZWFkeUZpcmVkIl0sInNvdXJjZVJvb3QiOiIifQ==